(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Rh(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const Yt={},ql=[],Us=()=>{},dD=()=>!1,Nd=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Wv=t=>t.startsWith("onUpdate:"),gr=Object.assign,zv=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},fD=Object.prototype.hasOwnProperty,or=(t,e)=>fD.call(t,e),dt=Array.isArray,Xl=t=>Pc(t)==="[object Map]",il=t=>Pc(t)==="[object Set]",qy=t=>Pc(t)==="[object Date]",hD=t=>Pc(t)==="[object RegExp]",At=t=>typeof t=="function",_r=t=>typeof t=="string",da=t=>typeof t=="symbol",hr=t=>t!==null&&typeof t=="object",Kv=t=>(hr(t)||At(t))&&At(t.then)&&At(t.catch),I2=Object.prototype.toString,Pc=t=>I2.call(t),pD=t=>Pc(t).slice(8,-1),Fh=t=>Pc(t)==="[object Object]",qv=t=>_r(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Yl=Rh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Nh=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},mD=/-(\w)/g,Tn=Nh(t=>t.replace(mD,(e,r)=>r?r.toUpperCase():"")),gD=/\B([A-Z])/g,xs=Nh(t=>t.replace(gD,"-$1").toLowerCase()),Od=Nh(t=>t.charAt(0).toUpperCase()+t.slice(1)),Iu=Nh(t=>t?`on${Od(t)}`:""),ss=(t,e)=>!Object.is(t,e),Ql=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},kg=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},P0=t=>{const e=parseFloat(t);return isNaN(e)?t:e},R0=t=>{const e=_r(t)?Number(t):NaN;return isNaN(e)?t:e};let Xy;const Oh=()=>Xy||(Xy=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),vD="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",xD=Rh(vD);function as(t){if(dt(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],s=_r(n)?bD(n):as(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(_r(t)||hr(t))return t}const yD=/;(?![^(]*\))/g,ED=/:([^]+)/,_D=/\/\*[^]*?\*\//g;function bD(t){const e={};return t.replace(_D,"").split(yD).forEach(r=>{if(r){const n=r.split(ED);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Qe(t){let e="";if(_r(t))e=t;else if(dt(t))for(let r=0;r<t.length;r++){const n=Qe(t[r]);n&&(e+=n+" ")}else if(hr(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function SD(t){if(!t)return null;let{class:e,style:r}=t;return e&&!_r(e)&&(t.class=Qe(e)),r&&(t.style=as(r)),t}const AD="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",TD=Rh(AD);function k2(t){return!!t||t===""}function wD(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=ao(t[n],e[n]);return r}function ao(t,e){if(t===e)return!0;let r=qy(t),n=qy(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=da(t),n=da(e),r||n)return t===e;if(r=dt(t),n=dt(e),r||n)return r&&n?wD(t,e):!1;if(r=hr(t),n=hr(e),r||n){if(!r||!n)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const a in t){const o=t.hasOwnProperty(a),l=e.hasOwnProperty(a);if(o&&!l||!o&&l||!ao(t[a],e[a]))return!1}}return String(t)===String(e)}function Mh(t,e){return t.findIndex(r=>ao(r,e))}const D2=t=>!!(t&&t.__v_isRef===!0),J=t=>_r(t)?t:t==null?"":dt(t)||hr(t)&&(t.toString===I2||!At(t.toString))?D2(t)?J(t.value):JSON.stringify(t,P2,2):String(t),P2=(t,e)=>D2(e)?P2(t,e.value):Xl(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,s],i)=>(r[Gp(n,i)+" =>"]=s,r),{})}:il(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>Gp(r))}:da(e)?Gp(e):hr(e)&&!dt(e)&&!Fh(e)?String(e):e,Gp=(t,e="")=>{var r;return da(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ln;class Xv{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ln,!e&&Ln&&(this.index=(Ln.scopes||(Ln.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=Ln;try{return Ln=this,e()}finally{Ln=r}}}on(){++this._on===1&&(this.prevScope=Ln,Ln=this)}off(){this._on>0&&--this._on===0&&(Ln=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function Yv(t){return new Xv(t)}function Qv(){return Ln}function R2(t,e=!1){Ln&&Ln.cleanups.push(t)}let xr;const Wp=new WeakSet;class ad{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ln&&Ln.active&&Ln.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Wp.has(this)&&(Wp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||N2(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Yy(this),O2(this);const e=xr,r=la;xr=this,la=!0;try{return this.fn()}finally{M2(this),xr=e,la=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)e1(e);this.deps=this.depsTail=void 0,Yy(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Wp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Dg(this)&&this.run()}get dirty(){return Dg(this)}}let F2=0,ku,Du;function N2(t,e=!1){if(t.flags|=8,e){t.next=Du,Du=t;return}t.next=ku,ku=t}function Jv(){F2++}function Zv(){if(--F2>0)return;if(Du){let e=Du;for(Du=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;ku;){let e=ku;for(ku=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=r}}if(t)throw t}function O2(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function M2(t){let e,r=t.depsTail,n=r;for(;n;){const s=n.prevDep;n.version===-1?(n===r&&(r=s),e1(n),CD(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}t.deps=e,t.depsTail=r}function Dg(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(L2(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function L2(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===id)||(t.globalVersion=id,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Dg(t))))return;t.flags|=2;const e=t.dep,r=xr,n=la;xr=t,la=!0;try{O2(t);const s=t.fn(t._value);(e.version===0||ss(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{xr=r,la=n,M2(t),t.flags&=-3}}function e1(t,e=!1){const{dep:r,prevSub:n,nextSub:s}=t;if(n&&(n.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=n,t.nextSub=void 0),r.subs===t&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)e1(i,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function CD(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}function ID(t,e){t.effect instanceof ad&&(t=t.effect.fn);const r=new ad(t);e&&gr(r,e);try{r.run()}catch(s){throw r.stop(),s}const n=r.run.bind(r);return n.effect=r,n}function kD(t){t.effect.stop()}let la=!0;const B2=[];function pi(){B2.push(la),la=!1}function mi(){const t=B2.pop();la=t===void 0?!0:t}function Yy(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=xr;xr=void 0;try{e()}finally{xr=r}}}let id=0;class DD{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Lh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!xr||!la||xr===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==xr)r=this.activeLink=new DD(xr,this),xr.deps?(r.prevDep=xr.depsTail,xr.depsTail.nextDep=r,xr.depsTail=r):xr.deps=xr.depsTail=r,U2(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=xr.depsTail,r.nextDep=void 0,xr.depsTail.nextDep=r,xr.depsTail=r,xr.deps===r&&(xr.deps=n)}return r}trigger(e){this.version++,id++,this.notify(e)}notify(e){Jv();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{Zv()}}}function U2(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)U2(n)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const F0=new WeakMap,Bo=Symbol(""),Pg=Symbol(""),od=Symbol("");function $n(t,e,r){if(la&&xr){let n=F0.get(t);n||F0.set(t,n=new Map);let s=n.get(r);s||(n.set(r,s=new Lh),s.map=n,s.key=r),s.track()}}function Qa(t,e,r,n,s,i){const a=F0.get(t);if(!a){id++;return}const o=l=>{l&&l.trigger()};if(Jv(),e==="clear")a.forEach(o);else{const l=dt(t),c=l&&qv(r);if(l&&r==="length"){const u=Number(n);a.forEach((f,h)=>{(h==="length"||h===od||!da(h)&&h>=u)&&o(f)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),c&&o(a.get(od)),e){case"add":l?c&&o(a.get("length")):(o(a.get(Bo)),Xl(t)&&o(a.get(Pg)));break;case"delete":l||(o(a.get(Bo)),Xl(t)&&o(a.get(Pg)));break;case"set":Xl(t)&&o(a.get(Bo));break}}Zv()}function PD(t,e){const r=F0.get(t);return r&&r.get(e)}function Cl(t){const e=qt(t);return e===t?e:($n(e,"iterate",od),ks(t)?e:e.map(An))}function Bh(t){return $n(t=qt(t),"iterate",od),t}const RD={__proto__:null,[Symbol.iterator](){return zp(this,Symbol.iterator,An)},concat(...t){return Cl(this).concat(...t.map(e=>dt(e)?Cl(e):e))},entries(){return zp(this,"entries",t=>(t[1]=An(t[1]),t))},every(t,e){return Ka(this,"every",t,e,void 0,arguments)},filter(t,e){return Ka(this,"filter",t,e,r=>r.map(An),arguments)},find(t,e){return Ka(this,"find",t,e,An,arguments)},findIndex(t,e){return Ka(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ka(this,"findLast",t,e,An,arguments)},findLastIndex(t,e){return Ka(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ka(this,"forEach",t,e,void 0,arguments)},includes(...t){return Kp(this,"includes",t)},indexOf(...t){return Kp(this,"indexOf",t)},join(t){return Cl(this).join(t)},lastIndexOf(...t){return Kp(this,"lastIndexOf",t)},map(t,e){return Ka(this,"map",t,e,void 0,arguments)},pop(){return Zc(this,"pop")},push(...t){return Zc(this,"push",t)},reduce(t,...e){return Qy(this,"reduce",t,e)},reduceRight(t,...e){return Qy(this,"reduceRight",t,e)},shift(){return Zc(this,"shift")},some(t,e){return Ka(this,"some",t,e,void 0,arguments)},splice(...t){return Zc(this,"splice",t)},toReversed(){return Cl(this).toReversed()},toSorted(t){return Cl(this).toSorted(t)},toSpliced(...t){return Cl(this).toSpliced(...t)},unshift(...t){return Zc(this,"unshift",t)},values(){return zp(this,"values",An)}};function zp(t,e,r){const n=Bh(t),s=n[e]();return n!==t&&!ks(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=r(i.value)),i}),s}const FD=Array.prototype;function Ka(t,e,r,n,s,i){const a=Bh(t),o=a!==t&&!ks(t),l=a[e];if(l!==FD[e]){const f=l.apply(t,i);return o?An(f):f}let c=r;a!==t&&(o?c=function(f,h){return r.call(this,An(f),h,t)}:r.length>2&&(c=function(f,h){return r.call(this,f,h,t)}));const u=l.call(a,c,n);return o&&s?s(u):u}function Qy(t,e,r,n){const s=Bh(t);let i=r;return s!==t&&(ks(t)?r.length>3&&(i=function(a,o,l){return r.call(this,a,o,l,t)}):i=function(a,o,l){return r.call(this,a,An(o),l,t)}),s[e](i,...n)}function Kp(t,e,r){const n=qt(t);$n(n,"iterate",od);const s=n[e](...r);return(s===-1||s===!1)&&Vh(r[0])?(r[0]=qt(r[0]),n[e](...r)):s}function Zc(t,e,r=[]){pi(),Jv();const n=qt(t)[e].apply(t,r);return Zv(),mi(),n}const ND=Rh("__proto__,__v_isRef,__isVue"),$2=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(da));function OD(t){da(t)||(t=String(t));const e=qt(this);return $n(e,"has",t),e.hasOwnProperty(t)}class V2{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){if(r==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(s?i?K2:z2:i?W2:G2).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=dt(e);if(!s){let l;if(a&&(l=RD[r]))return l;if(r==="hasOwnProperty")return OD}const o=Reflect.get(e,r,Tr(e)?e:n);return(da(r)?$2.has(r):ND(r))||(s||$n(e,"get",r),i)?o:Tr(o)?a&&qv(r)?o:o.value:hr(o)?s?r1(o):Rs(o):o}}class H2 extends V2{constructor(e=!1){super(!1,e)}set(e,r,n,s){let i=e[r];if(!this._isShallow){const l=gi(i);if(!ks(n)&&!gi(n)&&(i=qt(i),n=qt(n)),!dt(e)&&Tr(i)&&!Tr(n))return l?!1:(i.value=n,!0)}const a=dt(e)&&qv(r)?Number(r)<e.length:or(e,r),o=Reflect.set(e,r,n,Tr(e)?e:s);return e===qt(s)&&(a?ss(n,i)&&Qa(e,"set",r,n):Qa(e,"add",r,n)),o}deleteProperty(e,r){const n=or(e,r);e[r];const s=Reflect.deleteProperty(e,r);return s&&n&&Qa(e,"delete",r,void 0),s}has(e,r){const n=Reflect.has(e,r);return(!da(r)||!$2.has(r))&&$n(e,"has",r),n}ownKeys(e){return $n(e,"iterate",dt(e)?"length":Bo),Reflect.ownKeys(e)}}class j2 extends V2{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const MD=new H2,LD=new j2,BD=new H2(!0),UD=new j2(!0),Rg=t=>t,Af=t=>Reflect.getPrototypeOf(t);function $D(t,e,r){return function(...n){const s=this.__v_raw,i=qt(s),a=Xl(i),o=t==="entries"||t===Symbol.iterator&&a,l=t==="keys"&&a,c=s[t](...n),u=r?Rg:e?N0:An;return!e&&$n(i,"iterate",l?Pg:Bo),{next(){const{value:f,done:h}=c.next();return h?{value:f,done:h}:{value:o?[u(f[0]),u(f[1])]:u(f),done:h}},[Symbol.iterator](){return this}}}}function Tf(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function VD(t,e){const r={get(s){const i=this.__v_raw,a=qt(i),o=qt(s);t||(ss(s,o)&&$n(a,"get",s),$n(a,"get",o));const{has:l}=Af(a),c=e?Rg:t?N0:An;if(l.call(a,s))return c(i.get(s));if(l.call(a,o))return c(i.get(o));i!==a&&i.get(s)},get size(){const s=this.__v_raw;return!t&&$n(qt(s),"iterate",Bo),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,a=qt(i),o=qt(s);return t||(ss(s,o)&&$n(a,"has",s),$n(a,"has",o)),s===o?i.has(s):i.has(s)||i.has(o)},forEach(s,i){const a=this,o=a.__v_raw,l=qt(o),c=e?Rg:t?N0:An;return!t&&$n(l,"iterate",Bo),o.forEach((u,f)=>s.call(i,c(u),c(f),a))}};return gr(r,t?{add:Tf("add"),set:Tf("set"),delete:Tf("delete"),clear:Tf("clear")}:{add(s){!e&&!ks(s)&&!gi(s)&&(s=qt(s));const i=qt(this);return Af(i).has.call(i,s)||(i.add(s),Qa(i,"add",s,s)),this},set(s,i){!e&&!ks(i)&&!gi(i)&&(i=qt(i));const a=qt(this),{has:o,get:l}=Af(a);let c=o.call(a,s);c||(s=qt(s),c=o.call(a,s));const u=l.call(a,s);return a.set(s,i),c?ss(i,u)&&Qa(a,"set",s,i):Qa(a,"add",s,i),this},delete(s){const i=qt(this),{has:a,get:o}=Af(i);let l=a.call(i,s);l||(s=qt(s),l=a.call(i,s)),o&&o.call(i,s);const c=i.delete(s);return l&&Qa(i,"delete",s,void 0),c},clear(){const s=qt(this),i=s.size!==0,a=s.clear();return i&&Qa(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=$D(s,t,e)}),r}function Uh(t,e){const r=VD(t,e);return(n,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?n:Reflect.get(or(r,s)&&s in n?r:n,s,i)}const HD={get:Uh(!1,!1)},jD={get:Uh(!1,!0)},GD={get:Uh(!0,!1)},WD={get:Uh(!0,!0)},G2=new WeakMap,W2=new WeakMap,z2=new WeakMap,K2=new WeakMap;function zD(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function KD(t){return t.__v_skip||!Object.isExtensible(t)?0:zD(pD(t))}function Rs(t){return gi(t)?t:$h(t,!1,MD,HD,G2)}function t1(t){return $h(t,!1,BD,jD,W2)}function r1(t){return $h(t,!0,LD,GD,z2)}function qD(t){return $h(t,!0,UD,WD,K2)}function $h(t,e,r,n,s){if(!hr(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=KD(t);if(i===0)return t;const a=s.get(t);if(a)return a;const o=new Proxy(t,i===2?n:r);return s.set(t,o),o}function Ia(t){return gi(t)?Ia(t.__v_raw):!!(t&&t.__v_isReactive)}function gi(t){return!!(t&&t.__v_isReadonly)}function ks(t){return!!(t&&t.__v_isShallow)}function Vh(t){return t?!!t.__v_raw:!1}function qt(t){const e=t&&t.__v_raw;return e?qt(e):t}function Hh(t){return!or(t,"__v_skip")&&Object.isExtensible(t)&&kg(t,"__v_skip",!0),t}const An=t=>hr(t)?Rs(t):t,N0=t=>hr(t)?r1(t):t;function Tr(t){return t?t.__v_isRef===!0:!1}function se(t){return q2(t,!1)}function n1(t){return q2(t,!0)}function q2(t,e){return Tr(t)?t:new XD(t,e)}class XD{constructor(e,r){this.dep=new Lh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:qt(e),this._value=r?e:An(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,n=this.__v_isShallow||ks(e)||gi(e);e=n?e:qt(e),ss(e,r)&&(this._rawValue=e,this._value=n?e:An(e),this.dep.trigger())}}function YD(t){t.dep&&t.dep.trigger()}function ee(t){return Tr(t)?t.value:t}function QD(t){return At(t)?t():ee(t)}const JD={get:(t,e,r)=>e==="__v_raw"?t:ee(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const s=t[e];return Tr(s)&&!Tr(r)?(s.value=r,!0):Reflect.set(t,e,r,n)}};function s1(t){return Ia(t)?t:new Proxy(t,JD)}class ZD{constructor(e){this.__v_isRef=!0,this._value=void 0;const r=this.dep=new Lh,{get:n,set:s}=e(r.track.bind(r),r.trigger.bind(r));this._get=n,this._set=s}get value(){return this._value=this._get()}set value(e){this._set(e)}}function X2(t){return new ZD(t)}function Y2(t){const e=dt(t)?new Array(t.length):{};for(const r in t)e[r]=Q2(t,r);return e}class e3{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return PD(qt(this._object),this._key)}}class t3{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function r3(t,e,r){return Tr(t)?t:At(t)?new t3(t):hr(t)&&arguments.length>1?Q2(t,e,r):se(t)}function Q2(t,e,r){const n=t[e];return Tr(n)?n:new e3(t,e,r)}class n3{constructor(e,r,n){this.fn=e,this.setter=r,this._value=void 0,this.dep=new Lh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=id-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&xr!==this)return N2(this,!0),!0}get value(){const e=this.dep.track();return L2(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function s3(t,e,r=!1){let n,s;return At(t)?n=t:(n=t.get,s=t.set),new n3(n,s,r)}const a3={GET:"get",HAS:"has",ITERATE:"iterate"},i3={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},wf={},O0=new WeakMap;let $i;function o3(){return $i}function J2(t,e=!1,r=$i){if(r){let n=O0.get(r);n||O0.set(r,n=[]),n.push(t)}}function l3(t,e,r=Yt){const{immediate:n,deep:s,once:i,scheduler:a,augmentJob:o,call:l}=r,c=k=>s?k:ks(k)||s===!1||s===0?Ja(k,1):Ja(k);let u,f,h,p,m=!1,v=!1;if(Tr(t)?(f=()=>t.value,m=ks(t)):Ia(t)?(f=()=>c(t),m=!0):dt(t)?(v=!0,m=t.some(k=>Ia(k)||ks(k)),f=()=>t.map(k=>{if(Tr(k))return k.value;if(Ia(k))return c(k);if(At(k))return l?l(k,2):k()})):At(t)?e?f=l?()=>l(t,2):t:f=()=>{if(h){pi();try{h()}finally{mi()}}const k=$i;$i=u;try{return l?l(t,3,[p]):t(p)}finally{$i=k}}:f=Us,e&&s){const k=f,P=s===!0?1/0:s;f=()=>Ja(k(),P)}const g=Qv(),y=()=>{u.stop(),g&&g.active&&zv(g.effects,u)};if(i&&e){const k=e;e=(...P)=>{k(...P),y()}}let E=v?new Array(t.length).fill(wf):wf;const b=k=>{if(!(!(u.flags&1)||!u.dirty&&!k))if(e){const P=u.run();if(s||m||(v?P.some((w,x)=>ss(w,E[x])):ss(P,E))){h&&h();const w=$i;$i=u;try{const x=[P,E===wf?void 0:v&&E[0]===wf?[]:E,p];E=P,l?l(e,3,x):e(...x)}finally{$i=w}}}else u.run()};return o&&o(b),u=new ad(f),u.scheduler=a?()=>a(b,!1):b,p=k=>J2(k,!1,u),h=u.onStop=()=>{const k=O0.get(u);if(k){if(l)l(k,4);else for(const P of k)P();O0.delete(u)}},e?n?b(!0):E=u.run():a?a(b.bind(null,!0),!0):u.run(),y.pause=u.pause.bind(u),y.resume=u.resume.bind(u),y.stop=y,y}function Ja(t,e=1/0,r){if(e<=0||!hr(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,Tr(t))Ja(t.value,e,r);else if(dt(t))for(let n=0;n<t.length;n++)Ja(t[n],e,r);else if(il(t)||Xl(t))t.forEach(n=>{Ja(n,e,r)});else if(Fh(t)){for(const n in t)Ja(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&Ja(t[n],e,r)}return t}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Z2=[];function c3(t){Z2.push(t)}function u3(){Z2.pop()}function d3(t,e){}const f3={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},h3={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function Rc(t,e,r,n){try{return n?t(...n):t()}catch(s){ol(s,e,r)}}function Hs(t,e,r,n){if(At(t)){const s=Rc(t,e,r,n);return s&&Kv(s)&&s.catch(i=>{ol(i,e,r)}),s}if(dt(t)){const s=[];for(let i=0;i<t.length;i++)s.push(Hs(t[i],e,r,n));return s}}function ol(t,e,r,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||Yt;if(e){let o=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](t,l,c)===!1)return}o=o.parent}if(i){pi(),Rc(i,null,10,[t,l,c]),mi();return}}p3(t,r,s,n,a)}function p3(t,e,r,n=!0,s=!1){if(s)throw t;console.error(t)}const is=[];let Ta=-1;const Jl=[];let Vi=null,Ml=0;const eA=Promise.resolve();let M0=null;function ll(t){const e=M0||eA;return t?e.then(this?t.bind(this):t):e}function m3(t){let e=Ta+1,r=is.length;for(;e<r;){const n=e+r>>>1,s=is[n],i=cd(s);i<t||i===t&&s.flags&2?e=n+1:r=n}return e}function a1(t){if(!(t.flags&1)){const e=cd(t),r=is[is.length-1];!r||!(t.flags&2)&&e>=cd(r)?is.push(t):is.splice(m3(e),0,t),t.flags|=1,tA()}}function tA(){M0||(M0=eA.then(rA))}function ld(t){dt(t)?Jl.push(...t):Vi&&t.id===-1?Vi.splice(Ml+1,0,t):t.flags&1||(Jl.push(t),t.flags|=1),tA()}function Jy(t,e,r=Ta+1){for(;r<is.length;r++){const n=is[r];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;is.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function L0(t){if(Jl.length){const e=[...new Set(Jl)].sort((r,n)=>cd(r)-cd(n));if(Jl.length=0,Vi){Vi.push(...e);return}for(Vi=e,Ml=0;Ml<Vi.length;Ml++){const r=Vi[Ml];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}Vi=null,Ml=0}}const cd=t=>t.id==null?t.flags&2?-1:1/0:t.id;function rA(t){try{for(Ta=0;Ta<is.length;Ta++){const e=is[Ta];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Rc(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ta<is.length;Ta++){const e=is[Ta];e&&(e.flags&=-2)}Ta=-1,is.length=0,L0(),M0=null,(is.length||Jl.length)&&rA()}}let Ll,Cf=[];function nA(t,e){var r,n;Ll=t,Ll?(Ll.enabled=!0,Cf.forEach(({event:s,args:i})=>Ll.emit(s,...i)),Cf=[]):typeof window<"u"&&window.HTMLElement&&!((n=(r=window.navigator)==null?void 0:r.userAgent)!=null&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{nA(i,e)}),setTimeout(()=>{Ll||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Cf=[])},3e3)):Cf=[]}let ln=null,jh=null;function ud(t){const e=ln;return ln=t,jh=t&&t.type.__scopeId||null,e}function g3(t){jh=t}function v3(){jh=null}const x3=t=>Gh;function Gh(t,e=ln,r){if(!e||t._n)return t;const n=(...s)=>{n._d&&$g(-1);const i=ud(e);let a;try{a=t(...s)}finally{ud(i),n._d&&$g(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function we(t,e){if(ln===null)return t;const r=Ud(ln),n=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,a,o,l=Yt]=e[s];i&&(At(i)&&(i={mounted:i,updated:i}),i.deep&&Ja(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:o,modifiers:l}))}return t}function wa(t,e,r,n){const s=t.dirs,i=e&&e.dirs;for(let a=0;a<s.length;a++){const o=s[a];i&&(o.oldValue=i[a].value);let l=o.dir[n];l&&(pi(),Hs(l,r,8,[t.el,o,t,e]),mi())}}const sA=Symbol("_vte"),aA=t=>t.__isTeleport,Pu=t=>t&&(t.disabled||t.disabled===""),Zy=t=>t&&(t.defer||t.defer===""),eE=t=>typeof SVGElement<"u"&&t instanceof SVGElement,tE=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,Fg=(t,e)=>{const r=t&&t.to;return _r(r)?e?e(r):null:r},iA={name:"Teleport",__isTeleport:!0,process(t,e,r,n,s,i,a,o,l,c){const{mc:u,pc:f,pbc:h,o:{insert:p,querySelector:m,createText:v,createComment:g}}=c,y=Pu(e.props);let{shapeFlag:E,children:b,dynamicChildren:k}=e;if(t==null){const P=e.el=v(""),w=e.anchor=v("");p(P,r,n),p(w,r,n);const x=(_,A)=>{E&16&&(s&&s.isCE&&(s.ce._teleportTarget=_),u(b,_,A,s,i,a,o,l))},S=()=>{const _=e.target=Fg(e.props,m),A=oA(_,e,v,p);_&&(a!=="svg"&&eE(_)?a="svg":a!=="mathml"&&tE(_)&&(a="mathml"),y||(x(_,A),u0(e,!1)))};y&&(x(r,w),u0(e,!0)),Zy(e.props)?(e.el.__isMounted=!1,sn(()=>{S(),delete e.el.__isMounted},i)):S()}else{if(Zy(e.props)&&t.el.__isMounted===!1){sn(()=>{iA.process(t,e,r,n,s,i,a,o,l,c)},i);return}e.el=t.el,e.targetStart=t.targetStart;const P=e.anchor=t.anchor,w=e.target=t.target,x=e.targetAnchor=t.targetAnchor,S=Pu(t.props),_=S?r:w,A=S?P:x;if(a==="svg"||eE(w)?a="svg":(a==="mathml"||tE(w))&&(a="mathml"),k?(h(t.dynamicChildren,k,_,s,i,a,o),g1(t,e,!0)):l||f(t,e,_,A,s,i,a,o,!1),y)S?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):If(e,r,P,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const C=e.target=Fg(e.props,m);C&&If(e,C,null,c,0)}else S&&If(e,w,x,c,1);u0(e,y)}},remove(t,e,r,{um:n,o:{remove:s}},i){const{shapeFlag:a,children:o,anchor:l,targetStart:c,targetAnchor:u,target:f,props:h}=t;if(f&&(s(c),s(u)),i&&s(l),a&16){const p=i||!Pu(h);for(let m=0;m<o.length;m++){const v=o[m];n(v,e,r,p,!!v.dynamicChildren)}}},move:If,hydrate:y3};function If(t,e,r,{o:{insert:n},m:s},i=2){i===0&&n(t.targetAnchor,e,r);const{el:a,anchor:o,shapeFlag:l,children:c,props:u}=t,f=i===2;if(f&&n(a,e,r),(!f||Pu(u))&&l&16)for(let h=0;h<c.length;h++)s(c[h],e,r,2);f&&n(o,e,r)}function y3(t,e,r,n,s,i,{o:{nextSibling:a,parentNode:o,querySelector:l,insert:c,createText:u}},f){const h=e.target=Fg(e.props,l);if(h){const p=Pu(e.props),m=h._lpa||h.firstChild;if(e.shapeFlag&16)if(p)e.anchor=f(a(t),e,o(t),r,n,s,i),e.targetStart=m,e.targetAnchor=m&&a(m);else{e.anchor=a(t);let v=m;for(;v;){if(v&&v.nodeType===8){if(v.data==="teleport start anchor")e.targetStart=v;else if(v.data==="teleport anchor"){e.targetAnchor=v,h._lpa=e.targetAnchor&&a(e.targetAnchor);break}}v=a(v)}e.targetAnchor||oA(h,e,u,c),f(m&&a(m),e,h,r,n,s,i)}u0(e,p)}return e.anchor&&a(e.anchor)}const E3=iA;function u0(t,e){const r=t.ctx;if(r&&r.ut){let n,s;for(e?(n=t.el,s=t.anchor):(n=t.targetStart,s=t.targetAnchor);n&&n!==s;)n.nodeType===1&&n.setAttribute("data-v-owner",r.uid),n=n.nextSibling;r.ut()}}function oA(t,e,r,n){const s=e.targetStart=r(""),i=e.targetAnchor=r("");return s[sA]=i,t&&(n(s,t),n(i,t)),i}const Hi=Symbol("_leaveCb"),kf=Symbol("_enterCb");function i1(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ut(()=>{t.isMounted=!0}),qh(()=>{t.isUnmounting=!0}),t}const Fs=[Function,Array],o1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fs,onEnter:Fs,onAfterEnter:Fs,onEnterCancelled:Fs,onBeforeLeave:Fs,onLeave:Fs,onAfterLeave:Fs,onLeaveCancelled:Fs,onBeforeAppear:Fs,onAppear:Fs,onAfterAppear:Fs,onAppearCancelled:Fs},lA=t=>{const e=t.subTree;return e.component?lA(e.component):e},_3={name:"BaseTransition",props:o1,setup(t,{slots:e}){const r=Ws(),n=i1();return()=>{const s=e.default&&Wh(e.default(),!0);if(!s||!s.length)return;const i=cA(s),a=qt(t),{mode:o}=a;if(n.isLeaving)return qp(i);const l=rE(i);if(!l)return qp(i);let c=fc(l,a,n,r,f=>c=f);l.type!==zr&&vi(l,c);let u=r.subTree&&rE(r.subTree);if(u&&u.type!==zr&&!ra(l,u)&&lA(r).type!==zr){let f=fc(u,a,n,r);if(vi(u,f),o==="out-in"&&l.type!==zr)return n.isLeaving=!0,f.afterLeave=()=>{n.isLeaving=!1,r.job.flags&8||r.update(),delete f.afterLeave,u=void 0},qp(i);o==="in-out"&&l.type!==zr?f.delayLeave=(h,p,m)=>{const v=dA(n,u);v[String(u.key)]=u,h[Hi]=()=>{p(),h[Hi]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{m(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function cA(t){let e=t[0];if(t.length>1){for(const r of t)if(r.type!==zr){e=r;break}}return e}const uA=_3;function dA(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function fc(t,e,r,n,s){const{appear:i,mode:a,persisted:o=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:f,onBeforeLeave:h,onLeave:p,onAfterLeave:m,onLeaveCancelled:v,onBeforeAppear:g,onAppear:y,onAfterAppear:E,onAppearCancelled:b}=e,k=String(t.key),P=dA(r,t),w=(_,A)=>{_&&Hs(_,n,9,A)},x=(_,A)=>{const C=A[1];w(_,A),dt(_)?_.every(T=>T.length<=1)&&C():_.length<=1&&C()},S={mode:a,persisted:o,beforeEnter(_){let A=l;if(!r.isMounted)if(i)A=g||l;else return;_[Hi]&&_[Hi](!0);const C=P[k];C&&ra(t,C)&&C.el[Hi]&&C.el[Hi](),w(A,[_])},enter(_){let A=c,C=u,T=f;if(!r.isMounted)if(i)A=y||c,C=E||u,T=b||f;else return;let D=!1;const V=_[kf]=B=>{D||(D=!0,B?w(T,[_]):w(C,[_]),S.delayedLeave&&S.delayedLeave(),_[kf]=void 0)};A?x(A,[_,V]):V()},leave(_,A){const C=String(t.key);if(_[kf]&&_[kf](!0),r.isUnmounting)return A();w(h,[_]);let T=!1;const D=_[Hi]=V=>{T||(T=!0,A(),V?w(v,[_]):w(m,[_]),_[Hi]=void 0,P[C]===t&&delete P[C])};P[C]=t,p?x(p,[_,D]):D()},clone(_){const A=fc(_,e,r,n,s);return s&&s(A),A}};return S}function qp(t){if(Ld(t))return t=Fa(t),t.children=null,t}function rE(t){if(!Ld(t))return aA(t.type)&&t.children?cA(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:r}=t;if(r){if(e&16)return r[0];if(e&32&&At(r.default))return r.default()}}function vi(t,e){t.shapeFlag&6&&t.component?(t.transition=e,vi(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Wh(t,e=!1,r){let n=[],s=0;for(let i=0;i<t.length;i++){let a=t[i];const o=r==null?a.key:String(r)+String(a.key!=null?a.key:i);a.type===Re?(a.patchFlag&128&&s++,n=n.concat(Wh(a.children,e,o))):(e||a.type!==zr)&&n.push(o!=null?Fa(a,{key:o}):a)}if(s>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function Md(t,e){return At(t)?gr({name:t.name},e,{setup:t}):t}function b3(){const t=Ws();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function l1(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function S3(t){const e=Ws(),r=n1(null);if(e){const s=e.refs===Yt?e.refs={}:e.refs;Object.defineProperty(s,t,{enumerable:!0,get:()=>r.value,set:i=>r.value=i})}return r}function Zl(t,e,r,n,s=!1){if(dt(t)){t.forEach((m,v)=>Zl(m,e&&(dt(e)?e[v]:e),r,n,s));return}if(eo(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Zl(t,e,r,n.component.subTree);return}const i=n.shapeFlag&4?Ud(n.component):n.el,a=s?null:i,{i:o,r:l}=t,c=e&&e.r,u=o.refs===Yt?o.refs={}:o.refs,f=o.setupState,h=qt(f),p=f===Yt?()=>!1:m=>or(h,m);if(c!=null&&c!==l&&(_r(c)?(u[c]=null,p(c)&&(f[c]=null)):Tr(c)&&(c.value=null)),At(l))Rc(l,o,12,[a,u]);else{const m=_r(l),v=Tr(l);if(m||v){const g=()=>{if(t.f){const y=m?p(l)?f[l]:u[l]:l.value;s?dt(y)&&zv(y,i):dt(y)?y.includes(i)||y.push(i):m?(u[l]=[i],p(l)&&(f[l]=u[l])):(l.value=[i],t.k&&(u[t.k]=l.value))}else m?(u[l]=a,p(l)&&(f[l]=a)):v&&(l.value=a,t.k&&(u[t.k]=a))};a?(g.id=-1,sn(g,r)):g()}}}let nE=!1;const Il=()=>{nE||(console.error("Hydration completed but contains mismatches."),nE=!0)},A3=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",T3=t=>t.namespaceURI.includes("MathML"),Df=t=>{if(t.nodeType===1){if(A3(t))return"svg";if(T3(t))return"mathml"}},Gl=t=>t.nodeType===8;function w3(t){const{mt:e,p:r,o:{patchProp:n,createText:s,nextSibling:i,parentNode:a,remove:o,insert:l,createComment:c}}=t,u=(b,k)=>{if(!k.hasChildNodes()){r(null,b,k),L0(),k._vnode=b;return}f(k.firstChild,b,null,null,null),L0(),k._vnode=b},f=(b,k,P,w,x,S=!1)=>{S=S||!!k.dynamicChildren;const _=Gl(b)&&b.data==="[",A=()=>v(b,k,P,w,x,_),{type:C,ref:T,shapeFlag:D,patchFlag:V}=k;let B=b.nodeType;k.el=b,V===-2&&(S=!1,k.dynamicChildren=null);let R=null;switch(C){case to:B!==3?k.children===""?(l(k.el=s(""),a(b),b),R=b):R=A():(b.data!==k.children&&(Il(),b.data=k.children),R=i(b));break;case zr:E(b)?(R=i(b),y(k.el=b.content.firstChild,b,P)):B!==8||_?R=A():R=i(b);break;case $o:if(_&&(b=i(b),B=b.nodeType),B===1||B===3){R=b;const F=!k.children.length;for(let M=0;M<k.staticCount;M++)F&&(k.children+=R.nodeType===1?R.outerHTML:R.data),M===k.staticCount-1&&(k.anchor=R),R=i(R);return _?i(R):R}else A();break;case Re:_?R=m(b,k,P,w,x,S):R=A();break;default:if(D&1)(B!==1||k.type.toLowerCase()!==b.tagName.toLowerCase())&&!E(b)?R=A():R=h(b,k,P,w,x,S);else if(D&6){k.slotScopeIds=x;const F=a(b);if(_?R=g(b):Gl(b)&&b.data==="teleport start"?R=g(b,b.data,"teleport end"):R=i(b),e(k,F,null,P,w,Df(F),S),eo(k)&&!k.type.__asyncResolved){let M;_?(M=nt(Re),M.anchor=R?R.previousSibling:F.lastChild):M=b.nodeType===3?Ne(""):nt("div"),M.el=b,k.component.subTree=M}}else D&64?B!==8?R=A():R=k.type.hydrate(b,k,P,w,x,S,t,p):D&128&&(R=k.type.hydrate(b,k,P,w,Df(a(b)),x,S,t,f))}return T!=null&&Zl(T,null,w,k),R},h=(b,k,P,w,x,S)=>{S=S||!!k.dynamicChildren;const{type:_,props:A,patchFlag:C,shapeFlag:T,dirs:D,transition:V}=k,B=_==="input"||_==="option";if(B||C!==-1){D&&wa(k,null,P,"created");let R=!1;if(E(b)){R=BA(null,V)&&P&&P.vnode.props&&P.vnode.props.appear;const M=b.content.firstChild;if(R){const O=M.getAttribute("class");O&&(M.$cls=O),V.beforeEnter(M)}y(M,b,P),k.el=b=M}if(T&16&&!(A&&(A.innerHTML||A.textContent))){let M=p(b.firstChild,k,b,P,w,x,S);for(;M;){Pf(b,1)||Il();const O=M;M=M.nextSibling,o(O)}}else if(T&8){let M=k.children;M[0]===`
`&&(b.tagName==="PRE"||b.tagName==="TEXTAREA")&&(M=M.slice(1)),b.textContent!==M&&(Pf(b,0)||Il(),b.textContent=k.children)}if(A){if(B||!S||C&48){const M=b.tagName.includes("-");for(const O in A)(B&&(O.endsWith("value")||O==="indeterminate")||Nd(O)&&!Yl(O)||O[0]==="."||M)&&n(b,O,null,A[O],void 0,P)}else if(A.onClick)n(b,"onClick",null,A.onClick,void 0,P);else if(C&4&&Ia(A.style))for(const M in A.style)A.style[M]}let F;(F=A&&A.onVnodeBeforeMount)&&ms(F,P,k),D&&wa(k,null,P,"beforeMount"),((F=A&&A.onVnodeMounted)||D||R)&&KA(()=>{F&&ms(F,P,k),R&&V.enter(b),D&&wa(k,null,P,"mounted")},w)}return b.nextSibling},p=(b,k,P,w,x,S,_)=>{_=_||!!k.dynamicChildren;const A=k.children,C=A.length;for(let T=0;T<C;T++){const D=_?A[T]:A[T]=vs(A[T]),V=D.type===to;b?(V&&!_&&T+1<C&&vs(A[T+1]).type===to&&(l(s(b.data.slice(D.children.length)),P,i(b)),b.data=D.children),b=f(b,D,w,x,S,_)):V&&!D.children?l(D.el=s(""),P):(Pf(P,1)||Il(),r(null,D,P,null,w,x,Df(P),S))}return b},m=(b,k,P,w,x,S)=>{const{slotScopeIds:_}=k;_&&(x=x?x.concat(_):_);const A=a(b),C=p(i(b),k,A,P,w,x,S);return C&&Gl(C)&&C.data==="]"?i(k.anchor=C):(Il(),l(k.anchor=c("]"),A,C),C)},v=(b,k,P,w,x,S)=>{if(Pf(b.parentElement,1)||Il(),k.el=null,S){const C=g(b);for(;;){const T=i(b);if(T&&T!==C)o(T);else break}}const _=i(b),A=a(b);return o(b),r(null,k,A,_,P,w,Df(A),x),P&&(P.vnode.el=k.el,Yh(P,k.el)),_},g=(b,k="[",P="]")=>{let w=0;for(;b;)if(b=i(b),b&&Gl(b)&&(b.data===k&&w++,b.data===P)){if(w===0)return i(b);w--}return b},y=(b,k,P)=>{const w=k.parentNode;w&&w.replaceChild(b,k);let x=P;for(;x;)x.vnode.el===k&&(x.vnode.el=x.subTree.el=b),x=x.parent},E=b=>b.nodeType===1&&b.tagName==="TEMPLATE";return[u,f]}const sE="data-allow-mismatch",C3={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function Pf(t,e){if(e===0||e===1)for(;t&&!t.hasAttribute(sE);)t=t.parentElement;const r=t&&t.getAttribute(sE);if(r==null)return!1;if(r==="")return!0;{const n=r.split(",");return e===0&&n.includes("children")?!0:n.includes(C3[e])}}const I3=Oh().requestIdleCallback||(t=>setTimeout(t,1)),k3=Oh().cancelIdleCallback||(t=>clearTimeout(t)),D3=(t=1e4)=>e=>{const r=I3(e,{timeout:t});return()=>k3(r)};function P3(t){const{top:e,left:r,bottom:n,right:s}=t.getBoundingClientRect(),{innerHeight:i,innerWidth:a}=window;return(e>0&&e<i||n>0&&n<i)&&(r>0&&r<a||s>0&&s<a)}const R3=t=>(e,r)=>{const n=new IntersectionObserver(s=>{for(const i of s)if(i.isIntersecting){n.disconnect(),e();break}},t);return r(s=>{if(s instanceof Element){if(P3(s))return e(),n.disconnect(),!1;n.observe(s)}}),()=>n.disconnect()},F3=t=>e=>{if(t){const r=matchMedia(t);if(r.matches)e();else return r.addEventListener("change",e,{once:!0}),()=>r.removeEventListener("change",e)}},N3=(t=[])=>(e,r)=>{_r(t)&&(t=[t]);let n=!1;const s=a=>{n||(n=!0,i(),e(),a.target.dispatchEvent(new a.constructor(a.type,a)))},i=()=>{r(a=>{for(const o of t)a.removeEventListener(o,s)})};return r(a=>{for(const o of t)a.addEventListener(o,s,{once:!0})}),i};function O3(t,e){if(Gl(t)&&t.data==="["){let r=1,n=t.nextSibling;for(;n;){if(n.nodeType===1){if(e(n)===!1)break}else if(Gl(n))if(n.data==="]"){if(--r===0)break}else n.data==="["&&r++;n=n.nextSibling}}else e(t)}const eo=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function M3(t){At(t)&&(t={loader:t});const{loader:e,loadingComponent:r,errorComponent:n,delay:s=200,hydrate:i,timeout:a,suspensible:o=!0,onError:l}=t;let c=null,u,f=0;const h=()=>(f++,c=null,p()),p=()=>{let m;return c||(m=c=e().catch(v=>{if(v=v instanceof Error?v:new Error(String(v)),l)return new Promise((g,y)=>{l(v,()=>g(h()),()=>y(v),f+1)});throw v}).then(v=>m!==c&&c?c:(v&&(v.__esModule||v[Symbol.toStringTag]==="Module")&&(v=v.default),u=v,v)))};return Md({name:"AsyncComponentWrapper",__asyncLoader:p,__asyncHydrate(m,v,g){const y=i?()=>{const b=i(()=>{g()},k=>O3(m,k));b&&(v.bum||(v.bum=[])).push(b),(v.u||(v.u=[])).push(()=>!0)}:g;u?y():p().then(()=>!v.isUnmounted&&y())},get __asyncResolved(){return u},setup(){const m=on;if(l1(m),u)return()=>Xp(u,m);const v=b=>{c=null,ol(b,m,13,!n)};if(o&&m.suspense||hc)return p().then(b=>()=>Xp(b,m)).catch(b=>(v(b),()=>n?nt(n,{error:b}):null));const g=se(!1),y=se(),E=se(!!s);return s&&setTimeout(()=>{E.value=!1},s),a!=null&&setTimeout(()=>{if(!g.value&&!y.value){const b=new Error(`Async component timed out after ${a}ms.`);v(b),y.value=b}},a),p().then(()=>{g.value=!0,m.parent&&Ld(m.parent.vnode)&&m.parent.update()}).catch(b=>{v(b),y.value=b}),()=>{if(g.value&&u)return Xp(u,m);if(y.value&&n)return nt(n,{error:y.value});if(r&&!E.value)return nt(r)}}})}function Xp(t,e){const{ref:r,props:n,children:s,ce:i}=e.vnode,a=nt(t,n,s);return a.ref=r,a.ce=i,delete e.vnode.ce,a}const Ld=t=>t.type.__isKeepAlive,L3={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const r=Ws(),n=r.ctx;if(!n.renderer)return()=>{const E=e.default&&e.default();return E&&E.length===1?E[0]:E};const s=new Map,i=new Set;let a=null;const o=r.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:f}}}=n,h=f("div");n.activate=(E,b,k,P,w)=>{const x=E.component;c(E,b,k,0,o),l(x.vnode,E,b,k,x,o,P,E.slotScopeIds,w),sn(()=>{x.isDeactivated=!1,x.a&&Ql(x.a);const S=E.props&&E.props.onVnodeMounted;S&&ms(S,x.parent,E)},o)},n.deactivate=E=>{const b=E.component;U0(b.m),U0(b.a),c(E,h,null,1,o),sn(()=>{b.da&&Ql(b.da);const k=E.props&&E.props.onVnodeUnmounted;k&&ms(k,b.parent,E),b.isDeactivated=!0},o)};function p(E){Yp(E),u(E,r,o,!0)}function m(E){s.forEach((b,k)=>{const P=Wg(b.type);P&&!E(P)&&v(k)})}function v(E){const b=s.get(E);b&&(!a||!ra(b,a))?p(b):a&&Yp(a),s.delete(E),i.delete(E)}Vt(()=>[t.include,t.exclude],([E,b])=>{E&&m(k=>pu(E,k)),b&&m(k=>!pu(b,k))},{flush:"post",deep:!0});let g=null;const y=()=>{g!=null&&($0(r.subTree.type)?sn(()=>{s.set(g,Rf(r.subTree))},r.subTree.suspense):s.set(g,Rf(r.subTree)))};return Ut(y),Kh(y),qh(()=>{s.forEach(E=>{const{subTree:b,suspense:k}=r,P=Rf(b);if(E.type===P.type&&E.key===P.key){Yp(P);const w=P.component.da;w&&sn(w,k);return}p(E)})}),()=>{if(g=null,!e.default)return a=null;const E=e.default(),b=E[0];if(E.length>1)return a=null,E;if(!xi(b)||!(b.shapeFlag&4)&&!(b.shapeFlag&128))return a=null,b;let k=Rf(b);if(k.type===zr)return a=null,k;const P=k.type,w=Wg(eo(k)?k.type.__asyncResolved||{}:P),{include:x,exclude:S,max:_}=t;if(x&&(!w||!pu(x,w))||S&&w&&pu(S,w))return k.shapeFlag&=-257,a=k,b;const A=k.key==null?P:k.key,C=s.get(A);return k.el&&(k=Fa(k),b.shapeFlag&128&&(b.ssContent=k)),g=A,C?(k.el=C.el,k.component=C.component,k.transition&&vi(k,k.transition),k.shapeFlag|=512,i.delete(A),i.add(A)):(i.add(A),_&&i.size>parseInt(_,10)&&v(i.values().next().value)),k.shapeFlag|=256,a=k,$0(b.type)?b:k}}},B3=L3;function pu(t,e){return dt(t)?t.some(r=>pu(r,e)):_r(t)?t.split(",").includes(e):hD(t)?(t.lastIndex=0,t.test(e)):!1}function fA(t,e){pA(t,"a",e)}function hA(t,e){pA(t,"da",e)}function pA(t,e,r=on){const n=t.__wdc||(t.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(zh(e,n,r),r){let s=r.parent;for(;s&&s.parent;)Ld(s.parent.vnode)&&U3(n,e,r,s),s=s.parent}}function U3(t,e,r,n){const s=zh(e,t,n,!0);Ba(()=>{zv(n[e],s)},r)}function Yp(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Rf(t){return t.shapeFlag&128?t.ssContent:t}function zh(t,e,r=on,n=!1){if(r){const s=r[t]||(r[t]=[]),i=e.__weh||(e.__weh=(...a)=>{pi();const o=qo(r),l=Hs(e,r,t,a);return o(),mi(),l});return n?s.unshift(i):s.push(i),i}}const Ti=t=>(e,r=on)=>{(!hc||t==="sp")&&zh(t,(...n)=>e(...n),r)},mA=Ti("bm"),Ut=Ti("m"),c1=Ti("bu"),Kh=Ti("u"),qh=Ti("bum"),Ba=Ti("um"),gA=Ti("sp"),vA=Ti("rtg"),xA=Ti("rtc");function yA(t,e=on){zh("ec",t,e)}const u1="components",$3="directives";function Ar(t,e){return d1(u1,t,!0,e)||t}const EA=Symbol.for("v-ndc");function _A(t){return _r(t)?d1(u1,t,!1)||t:t||EA}function V3(t){return d1($3,t)}function d1(t,e,r=!0,n=!1){const s=ln||on;if(s){const i=s.type;if(t===u1){const o=Wg(i,!1);if(o&&(o===e||o===Tn(e)||o===Od(Tn(e))))return i}const a=aE(s[t]||i[t],e)||aE(s.appContext[t],e);return!a&&n?i:a}}function aE(t,e){return t&&(t[e]||t[Tn(e)]||t[Od(Tn(e))])}function Ve(t,e,r,n){let s;const i=r&&r[n],a=dt(t);if(a||_r(t)){const o=a&&Ia(t);let l=!1,c=!1;o&&(l=!ks(t),c=gi(t),t=Bh(t)),s=new Array(t.length);for(let u=0,f=t.length;u<f;u++)s[u]=e(l?c?N0(An(t[u])):An(t[u]):t[u],u,void 0,i&&i[u])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(hr(t))if(t[Symbol.iterator])s=Array.from(t,(o,l)=>e(o,l,void 0,i&&i[l]));else{const o=Object.keys(t);s=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const u=o[l];s[l]=e(t[u],u,l,i&&i[l])}}else s=[];return r&&(r[n]=s),s}function H3(t,e){for(let r=0;r<e.length;r++){const n=e[r];if(dt(n))for(let s=0;s<n.length;s++)t[n[s].name]=n[s].fn;else n&&(t[n.name]=n.key?(...s)=>{const i=n.fn(...s);return i&&(i.key=n.key),i}:n.fn)}return t}function bA(t,e,r={},n,s){if(ln.ce||ln.parent&&eo(ln.parent)&&ln.parent.ce)return e!=="default"&&(r.name=e),N(),Kr(Re,null,[nt("slot",r,n&&n())],64);let i=t[e];i&&i._c&&(i._d=!1),N();const a=i&&f1(i(r)),o=r.key||a&&a.key,l=Kr(Re,{key:(o&&!da(o)?o:`_${e}`)+(!a&&n?"_fb":"")},a||(n?n():[]),a&&t._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function f1(t){return t.some(e=>xi(e)?!(e.type===zr||e.type===Re&&!f1(e.children)):!0)?t:null}function j3(t,e){const r={};for(const n in t)r[e&&/[A-Z]/.test(n)?`on:${n}`:Iu(n)]=t[n];return r}const Ng=t=>t?eT(t)?Ud(t):Ng(t.parent):null,Ru=gr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ng(t.parent),$root:t=>Ng(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>h1(t),$forceUpdate:t=>t.f||(t.f=()=>{a1(t.update)}),$nextTick:t=>t.n||(t.n=ll.bind(t.proxy)),$watch:t=>EP.bind(t)}),Qp=(t,e)=>t!==Yt&&!t.__isScriptSetup&&or(t,e),Og={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:o,appContext:l}=t;let c;if(e[0]!=="$"){const p=a[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return s[e];case 4:return r[e];case 3:return i[e]}else{if(Qp(n,e))return a[e]=1,n[e];if(s!==Yt&&or(s,e))return a[e]=2,s[e];if((c=t.propsOptions[0])&&or(c,e))return a[e]=3,i[e];if(r!==Yt&&or(r,e))return a[e]=4,r[e];Mg&&(a[e]=0)}}const u=Ru[e];let f,h;if(u)return e==="$attrs"&&$n(t.attrs,"get",""),u(t);if((f=o.__cssModules)&&(f=f[e]))return f;if(r!==Yt&&or(r,e))return a[e]=4,r[e];if(h=l.config.globalProperties,or(h,e))return h[e]},set({_:t},e,r){const{data:n,setupState:s,ctx:i}=t;return Qp(s,e)?(s[e]=r,!0):n!==Yt&&or(n,e)?(n[e]=r,!0):or(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:s,propsOptions:i}},a){let o;return!!r[a]||t!==Yt&&or(t,a)||Qp(e,a)||(o=i[0])&&or(o,a)||or(n,a)||or(Ru,a)||or(s.config.globalProperties,a)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:or(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}},G3=gr({},Og,{get(t,e){if(e!==Symbol.unscopables)return Og.get(t,e,t)},has(t,e){return e[0]!=="_"&&!xD(e)}});function W3(){return null}function z3(){return null}function K3(t){}function q3(t){}function X3(){return null}function Y3(){}function Q3(t,e){return null}function J3(){return SA().slots}function Z3(){return SA().attrs}function SA(){const t=Ws();return t.setupContext||(t.setupContext=nT(t))}function dd(t){return dt(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}function eP(t,e){const r=dd(t);for(const n in e){if(n.startsWith("__skip"))continue;let s=r[n];s?dt(s)||At(s)?s=r[n]={type:s,default:e[n]}:s.default=e[n]:s===null&&(s=r[n]={default:e[n]}),s&&e[`__skip_${n}`]&&(s.skipFactory=!0)}return r}function tP(t,e){return!t||!e?t||e:dt(t)&&dt(e)?t.concat(e):gr({},dd(t),dd(e))}function rP(t,e){const r={};for(const n in t)e.includes(n)||Object.defineProperty(r,n,{enumerable:!0,get:()=>t[n]});return r}function nP(t){const e=Ws();let r=t();return Hg(),Kv(r)&&(r=r.catch(n=>{throw qo(e),n})),[r,()=>qo(e)]}let Mg=!0;function sP(t){const e=h1(t),r=t.proxy,n=t.ctx;Mg=!1,e.beforeCreate&&iE(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:f,mounted:h,beforeUpdate:p,updated:m,activated:v,deactivated:g,beforeDestroy:y,beforeUnmount:E,destroyed:b,unmounted:k,render:P,renderTracked:w,renderTriggered:x,errorCaptured:S,serverPrefetch:_,expose:A,inheritAttrs:C,components:T,directives:D,filters:V}=e;if(c&&aP(c,n,null),a)for(const F in a){const M=a[F];At(M)&&(n[F]=M.bind(r))}if(s){const F=s.call(r,r);hr(F)&&(t.data=Rs(F))}if(Mg=!0,i)for(const F in i){const M=i[F],O=At(M)?M.bind(r,r):At(M.get)?M.get.bind(r,r):Us,K=!At(M)&&At(M.set)?M.set.bind(r):Us,j=Se({get:O,set:K});Object.defineProperty(n,F,{enumerable:!0,configurable:!0,get:()=>j.value,set:H=>j.value=H})}if(o)for(const F in o)AA(o[F],n,r,F);if(l){const F=At(l)?l.call(r):l;Reflect.ownKeys(F).forEach(M=>{Fu(M,F[M])})}u&&iE(u,t,"c");function R(F,M){dt(M)?M.forEach(O=>F(O.bind(r))):M&&F(M.bind(r))}if(R(mA,f),R(Ut,h),R(c1,p),R(Kh,m),R(fA,v),R(hA,g),R(yA,S),R(xA,w),R(vA,x),R(qh,E),R(Ba,k),R(gA,_),dt(A))if(A.length){const F=t.exposed||(t.exposed={});A.forEach(M=>{Object.defineProperty(F,M,{get:()=>r[M],set:O=>r[M]=O})})}else t.exposed||(t.exposed={});P&&t.render===Us&&(t.render=P),C!=null&&(t.inheritAttrs=C),T&&(t.components=T),D&&(t.directives=D),_&&l1(t)}function aP(t,e,r=Us){dt(t)&&(t=Lg(t));for(const n in t){const s=t[n];let i;hr(s)?"default"in s?i=Ds(s.from||n,s.default,!0):i=Ds(s.from||n):i=Ds(s),Tr(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):e[n]=i}}function iE(t,e,r){Hs(dt(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function AA(t,e,r,n){let s=n.includes(".")?jA(r,n):()=>r[n];if(_r(t)){const i=e[t];At(i)&&Vt(s,i)}else if(At(t))Vt(s,t.bind(r));else if(hr(t))if(dt(t))t.forEach(i=>AA(i,e,r,n));else{const i=At(t.handler)?t.handler.bind(r):e[t.handler];At(i)&&Vt(s,i,t)}}function h1(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=t.appContext,o=i.get(e);let l;return o?l=o:!s.length&&!r&&!n?l=e:(l={},s.length&&s.forEach(c=>B0(l,c,a,!0)),B0(l,e,a)),hr(e)&&i.set(e,l),l}function B0(t,e,r,n=!1){const{mixins:s,extends:i}=e;i&&B0(t,i,r,!0),s&&s.forEach(a=>B0(t,a,r,!0));for(const a in e)if(!(n&&a==="expose")){const o=iP[a]||r&&r[a];t[a]=o?o(t[a],e[a]):e[a]}return t}const iP={data:oE,props:lE,emits:lE,methods:mu,computed:mu,beforeCreate:ts,created:ts,beforeMount:ts,mounted:ts,beforeUpdate:ts,updated:ts,beforeDestroy:ts,beforeUnmount:ts,destroyed:ts,unmounted:ts,activated:ts,deactivated:ts,errorCaptured:ts,serverPrefetch:ts,components:mu,directives:mu,watch:lP,provide:oE,inject:oP};function oE(t,e){return e?t?function(){return gr(At(t)?t.call(this,this):t,At(e)?e.call(this,this):e)}:e:t}function oP(t,e){return mu(Lg(t),Lg(e))}function Lg(t){if(dt(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function ts(t,e){return t?[...new Set([].concat(t,e))]:e}function mu(t,e){return t?gr(Object.create(null),t,e):e}function lE(t,e){return t?dt(t)&&dt(e)?[...new Set([...t,...e])]:gr(Object.create(null),dd(t),dd(e??{})):e}function lP(t,e){if(!t)return e;if(!e)return t;const r=gr(Object.create(null),t);for(const n in e)r[n]=ts(t[n],e[n]);return r}function TA(){return{app:null,config:{isNativeTag:dD,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let cP=0;function uP(t,e){return function(n,s=null){At(n)||(n=gr({},n)),s!=null&&!hr(s)&&(s=null);const i=TA(),a=new WeakSet,o=[];let l=!1;const c=i.app={_uid:cP++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:aT,get config(){return i.config},set config(u){},use(u,...f){return a.has(u)||(u&&At(u.install)?(a.add(u),u.install(c,...f)):At(u)&&(a.add(u),u(c,...f))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,f){return f?(i.components[u]=f,c):i.components[u]},directive(u,f){return f?(i.directives[u]=f,c):i.directives[u]},mount(u,f,h){if(!l){const p=c._ceVNode||nt(n,s);return p.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),f&&e?e(p,u):t(p,u,h),l=!0,c._container=u,u.__vue_app__=c,Ud(p.component)}},onUnmount(u){o.push(u)},unmount(){l&&(Hs(o,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,f){return i.provides[u]=f,c},runWithContext(u){const f=Uo;Uo=c;try{return u()}finally{Uo=f}}};return c}}let Uo=null;function Fu(t,e){if(on){let r=on.provides;const n=on.parent&&on.parent.provides;n===r&&(r=on.provides=Object.create(n)),r[t]=e}}function Ds(t,e,r=!1){const n=on||ln;if(n||Uo){let s=Uo?Uo._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return r&&At(e)?e.call(n&&n.proxy):e}}function wA(){return!!(on||ln||Uo)}const CA={},IA=()=>Object.create(CA),kA=t=>Object.getPrototypeOf(t)===CA;function dP(t,e,r,n=!1){const s={},i=IA();t.propsDefaults=Object.create(null),DA(t,e,s,i);for(const a in t.propsOptions[0])a in s||(s[a]=void 0);r?t.props=n?s:t1(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function fP(t,e,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=t,o=qt(s),[l]=t.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=t.vnode.dynamicProps;for(let f=0;f<u.length;f++){let h=u[f];if(Xh(t.emitsOptions,h))continue;const p=e[h];if(l)if(or(i,h))p!==i[h]&&(i[h]=p,c=!0);else{const m=Tn(h);s[m]=Bg(l,o,m,p,t,!1)}else p!==i[h]&&(i[h]=p,c=!0)}}}else{DA(t,e,s,i)&&(c=!0);let u;for(const f in o)(!e||!or(e,f)&&((u=xs(f))===f||!or(e,u)))&&(l?r&&(r[f]!==void 0||r[u]!==void 0)&&(s[f]=Bg(l,o,f,void 0,t,!0)):delete s[f]);if(i!==o)for(const f in i)(!e||!or(e,f))&&(delete i[f],c=!0)}c&&Qa(t.attrs,"set","")}function DA(t,e,r,n){const[s,i]=t.propsOptions;let a=!1,o;if(e)for(let l in e){if(Yl(l))continue;const c=e[l];let u;s&&or(s,u=Tn(l))?!i||!i.includes(u)?r[u]=c:(o||(o={}))[u]=c:Xh(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(i){const l=qt(r),c=o||Yt;for(let u=0;u<i.length;u++){const f=i[u];r[f]=Bg(s,l,f,c[f],t,!or(c,f))}}return a}function Bg(t,e,r,n,s,i){const a=t[r];if(a!=null){const o=or(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&At(l)){const{propsDefaults:c}=s;if(r in c)n=c[r];else{const u=qo(s);n=c[r]=l.call(null,e),u()}}else n=l;s.ce&&s.ce._setProp(r,n)}a[0]&&(i&&!o?n=!1:a[1]&&(n===""||n===xs(r))&&(n=!0))}return n}const hP=new WeakMap;function PA(t,e,r=!1){const n=r?hP:e.propsCache,s=n.get(t);if(s)return s;const i=t.props,a={},o=[];let l=!1;if(!At(t)){const u=f=>{l=!0;const[h,p]=PA(f,e,!0);gr(a,h),p&&o.push(...p)};!r&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!l)return hr(t)&&n.set(t,ql),ql;if(dt(i))for(let u=0;u<i.length;u++){const f=Tn(i[u]);cE(f)&&(a[f]=Yt)}else if(i)for(const u in i){const f=Tn(u);if(cE(f)){const h=i[u],p=a[f]=dt(h)||At(h)?{type:h}:gr({},h),m=p.type;let v=!1,g=!0;if(dt(m))for(let y=0;y<m.length;++y){const E=m[y],b=At(E)&&E.name;if(b==="Boolean"){v=!0;break}else b==="String"&&(g=!1)}else v=At(m)&&m.name==="Boolean";p[0]=v,p[1]=g,(v||or(p,"default"))&&o.push(f)}}const c=[a,o];return hr(t)&&n.set(t,c),c}function cE(t){return t[0]!=="$"&&!Yl(t)}const p1=t=>t[0]==="_"||t==="$stable",m1=t=>dt(t)?t.map(vs):[vs(t)],pP=(t,e,r)=>{if(e._n)return e;const n=Gh((...s)=>m1(e(...s)),r);return n._c=!1,n},RA=(t,e,r)=>{const n=t._ctx;for(const s in t){if(p1(s))continue;const i=t[s];if(At(i))e[s]=pP(s,i,n);else if(i!=null){const a=m1(i);e[s]=()=>a}}},FA=(t,e)=>{const r=m1(e);t.slots.default=()=>r},NA=(t,e,r)=>{for(const n in e)(r||!p1(n))&&(t[n]=e[n])},mP=(t,e,r)=>{const n=t.slots=IA();if(t.vnode.shapeFlag&32){const s=e.__;s&&kg(n,"__",s,!0);const i=e._;i?(NA(n,e,r),r&&kg(n,"_",i,!0)):RA(e,n)}else e&&FA(t,e)},gP=(t,e,r)=>{const{vnode:n,slots:s}=t;let i=!0,a=Yt;if(n.shapeFlag&32){const o=e._;o?r&&o===1?i=!1:NA(s,e,r):(i=!e.$stable,RA(e,s)),a=e}else e&&(FA(t,e),a={default:1});if(i)for(const o in s)!p1(o)&&a[o]==null&&delete s[o]},sn=KA;function OA(t){return LA(t)}function MA(t){return LA(t,w3)}function LA(t,e){const r=Oh();r.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:h,setScopeId:p=Us,insertStaticContent:m}=t,v=(Y,Z,ne,ge=null,ae=null,ce=null,fe=void 0,Ae=null,Ie=!!Z.dynamicChildren)=>{if(Y===Z)return;Y&&!ra(Y,Z)&&(ge=ue(Y),H(Y,ae,ce,!0),Y=null),Z.patchFlag===-2&&(Ie=!1,Z.dynamicChildren=null);const{type:Te,ref:Ge,shapeFlag:ke}=Z;switch(Te){case to:g(Y,Z,ne,ge);break;case zr:y(Y,Z,ne,ge);break;case $o:Y==null&&E(Z,ne,ge,fe);break;case Re:T(Y,Z,ne,ge,ae,ce,fe,Ae,Ie);break;default:ke&1?P(Y,Z,ne,ge,ae,ce,fe,Ae,Ie):ke&6?D(Y,Z,ne,ge,ae,ce,fe,Ae,Ie):(ke&64||ke&128)&&Te.process(Y,Z,ne,ge,ae,ce,fe,Ae,Ie,G)}Ge!=null&&ae?Zl(Ge,Y&&Y.ref,ce,Z||Y,!Z):Ge==null&&Y&&Y.ref!=null&&Zl(Y.ref,null,ce,Y,!0)},g=(Y,Z,ne,ge)=>{if(Y==null)n(Z.el=o(Z.children),ne,ge);else{const ae=Z.el=Y.el;Z.children!==Y.children&&c(ae,Z.children)}},y=(Y,Z,ne,ge)=>{Y==null?n(Z.el=l(Z.children||""),ne,ge):Z.el=Y.el},E=(Y,Z,ne,ge)=>{[Y.el,Y.anchor]=m(Y.children,Z,ne,ge,Y.el,Y.anchor)},b=({el:Y,anchor:Z},ne,ge)=>{let ae;for(;Y&&Y!==Z;)ae=h(Y),n(Y,ne,ge),Y=ae;n(Z,ne,ge)},k=({el:Y,anchor:Z})=>{let ne;for(;Y&&Y!==Z;)ne=h(Y),s(Y),Y=ne;s(Z)},P=(Y,Z,ne,ge,ae,ce,fe,Ae,Ie)=>{Z.type==="svg"?fe="svg":Z.type==="math"&&(fe="mathml"),Y==null?w(Z,ne,ge,ae,ce,fe,Ae,Ie):_(Y,Z,ae,ce,fe,Ae,Ie)},w=(Y,Z,ne,ge,ae,ce,fe,Ae)=>{let Ie,Te;const{props:Ge,shapeFlag:ke,transition:$e,dirs:Be}=Y;if(Ie=Y.el=a(Y.type,ce,Ge&&Ge.is,Ge),ke&8?u(Ie,Y.children):ke&16&&S(Y.children,Ie,null,ge,ae,Jp(Y,ce),fe,Ae),Be&&wa(Y,null,ge,"created"),x(Ie,Y,Y.scopeId,fe,ge),Ge){for(const Ke in Ge)Ke!=="value"&&!Yl(Ke)&&i(Ie,Ke,null,Ge[Ke],ce,ge);"value"in Ge&&i(Ie,"value",null,Ge.value,ce),(Te=Ge.onVnodeBeforeMount)&&ms(Te,ge,Y)}Be&&wa(Y,null,ge,"beforeMount");const We=BA(ae,$e);We&&$e.beforeEnter(Ie),n(Ie,Z,ne),((Te=Ge&&Ge.onVnodeMounted)||We||Be)&&sn(()=>{Te&&ms(Te,ge,Y),We&&$e.enter(Ie),Be&&wa(Y,null,ge,"mounted")},ae)},x=(Y,Z,ne,ge,ae)=>{if(ne&&p(Y,ne),ge)for(let ce=0;ce<ge.length;ce++)p(Y,ge[ce]);if(ae){let ce=ae.subTree;if(Z===ce||$0(ce.type)&&(ce.ssContent===Z||ce.ssFallback===Z)){const fe=ae.vnode;x(Y,fe,fe.scopeId,fe.slotScopeIds,ae.parent)}}},S=(Y,Z,ne,ge,ae,ce,fe,Ae,Ie=0)=>{for(let Te=Ie;Te<Y.length;Te++){const Ge=Y[Te]=Ae?ji(Y[Te]):vs(Y[Te]);v(null,Ge,Z,ne,ge,ae,ce,fe,Ae)}},_=(Y,Z,ne,ge,ae,ce,fe)=>{const Ae=Z.el=Y.el;let{patchFlag:Ie,dynamicChildren:Te,dirs:Ge}=Z;Ie|=Y.patchFlag&16;const ke=Y.props||Yt,$e=Z.props||Yt;let Be;if(ne&&wo(ne,!1),(Be=$e.onVnodeBeforeUpdate)&&ms(Be,ne,Z,Y),Ge&&wa(Z,Y,ne,"beforeUpdate"),ne&&wo(ne,!0),(ke.innerHTML&&$e.innerHTML==null||ke.textContent&&$e.textContent==null)&&u(Ae,""),Te?A(Y.dynamicChildren,Te,Ae,ne,ge,Jp(Z,ae),ce):fe||M(Y,Z,Ae,null,ne,ge,Jp(Z,ae),ce,!1),Ie>0){if(Ie&16)C(Ae,ke,$e,ne,ae);else if(Ie&2&&ke.class!==$e.class&&i(Ae,"class",null,$e.class,ae),Ie&4&&i(Ae,"style",ke.style,$e.style,ae),Ie&8){const We=Z.dynamicProps;for(let Ke=0;Ke<We.length;Ke++){const Ee=We[Ke],ye=ke[Ee],be=$e[Ee];(be!==ye||Ee==="value")&&i(Ae,Ee,ye,be,ae,ne)}}Ie&1&&Y.children!==Z.children&&u(Ae,Z.children)}else!fe&&Te==null&&C(Ae,ke,$e,ne,ae);((Be=$e.onVnodeUpdated)||Ge)&&sn(()=>{Be&&ms(Be,ne,Z,Y),Ge&&wa(Z,Y,ne,"updated")},ge)},A=(Y,Z,ne,ge,ae,ce,fe)=>{for(let Ae=0;Ae<Z.length;Ae++){const Ie=Y[Ae],Te=Z[Ae],Ge=Ie.el&&(Ie.type===Re||!ra(Ie,Te)||Ie.shapeFlag&198)?f(Ie.el):ne;v(Ie,Te,Ge,null,ge,ae,ce,fe,!0)}},C=(Y,Z,ne,ge,ae)=>{if(Z!==ne){if(Z!==Yt)for(const ce in Z)!Yl(ce)&&!(ce in ne)&&i(Y,ce,Z[ce],null,ae,ge);for(const ce in ne){if(Yl(ce))continue;const fe=ne[ce],Ae=Z[ce];fe!==Ae&&ce!=="value"&&i(Y,ce,Ae,fe,ae,ge)}"value"in ne&&i(Y,"value",Z.value,ne.value,ae)}},T=(Y,Z,ne,ge,ae,ce,fe,Ae,Ie)=>{const Te=Z.el=Y?Y.el:o(""),Ge=Z.anchor=Y?Y.anchor:o("");let{patchFlag:ke,dynamicChildren:$e,slotScopeIds:Be}=Z;Be&&(Ae=Ae?Ae.concat(Be):Be),Y==null?(n(Te,ne,ge),n(Ge,ne,ge),S(Z.children||[],ne,Ge,ae,ce,fe,Ae,Ie)):ke>0&&ke&64&&$e&&Y.dynamicChildren?(A(Y.dynamicChildren,$e,ne,ae,ce,fe,Ae),(Z.key!=null||ae&&Z===ae.subTree)&&g1(Y,Z,!0)):M(Y,Z,ne,Ge,ae,ce,fe,Ae,Ie)},D=(Y,Z,ne,ge,ae,ce,fe,Ae,Ie)=>{Z.slotScopeIds=Ae,Y==null?Z.shapeFlag&512?ae.ctx.activate(Z,ne,ge,fe,Ie):V(Z,ne,ge,ae,ce,fe,Ie):B(Y,Z,Ie)},V=(Y,Z,ne,ge,ae,ce,fe)=>{const Ae=Y.component=ZA(Y,ge,ae);if(Ld(Y)&&(Ae.ctx.renderer=G),tT(Ae,!1,fe),Ae.asyncDep){if(ae&&ae.registerDep(Ae,R,fe),!Y.el){const Ie=Ae.subTree=nt(zr);y(null,Ie,Z,ne)}}else R(Ae,Y,Z,ne,ae,ce,fe)},B=(Y,Z,ne)=>{const ge=Z.component=Y.component;if(wP(Y,Z,ne))if(ge.asyncDep&&!ge.asyncResolved){F(ge,Z,ne);return}else ge.next=Z,ge.update();else Z.el=Y.el,ge.vnode=Z},R=(Y,Z,ne,ge,ae,ce,fe)=>{const Ae=()=>{if(Y.isMounted){let{next:ke,bu:$e,u:Be,parent:We,vnode:Ke}=Y;{const je=UA(Y);if(je){ke&&(ke.el=Ke.el,F(Y,ke,fe)),je.asyncDep.then(()=>{Y.isUnmounted||Ae()});return}}let Ee=ke,ye;wo(Y,!1),ke?(ke.el=Ke.el,F(Y,ke,fe)):ke=Ke,$e&&Ql($e),(ye=ke.props&&ke.props.onVnodeBeforeUpdate)&&ms(ye,We,ke,Ke),wo(Y,!0);const be=d0(Y),Oe=Y.subTree;Y.subTree=be,v(Oe,be,f(Oe.el),ue(Oe),Y,ae,ce),ke.el=be.el,Ee===null&&Yh(Y,be.el),Be&&sn(Be,ae),(ye=ke.props&&ke.props.onVnodeUpdated)&&sn(()=>ms(ye,We,ke,Ke),ae)}else{let ke;const{el:$e,props:Be}=Z,{bm:We,m:Ke,parent:Ee,root:ye,type:be}=Y,Oe=eo(Z);if(wo(Y,!1),We&&Ql(We),!Oe&&(ke=Be&&Be.onVnodeBeforeMount)&&ms(ke,Ee,Z),wo(Y,!0),$e&&Q){const je=()=>{Y.subTree=d0(Y),Q($e,Y.subTree,Y,ae,null)};Oe&&be.__asyncHydrate?be.__asyncHydrate($e,Y,je):je()}else{ye.ce&&ye.ce._def.shadowRoot!==!1&&ye.ce._injectChildStyle(be);const je=Y.subTree=d0(Y);v(null,je,ne,ge,Y,ae,ce),Z.el=je.el}if(Ke&&sn(Ke,ae),!Oe&&(ke=Be&&Be.onVnodeMounted)){const je=Z;sn(()=>ms(ke,Ee,je),ae)}(Z.shapeFlag&256||Ee&&eo(Ee.vnode)&&Ee.vnode.shapeFlag&256)&&Y.a&&sn(Y.a,ae),Y.isMounted=!0,Z=ne=ge=null}};Y.scope.on();const Ie=Y.effect=new ad(Ae);Y.scope.off();const Te=Y.update=Ie.run.bind(Ie),Ge=Y.job=Ie.runIfDirty.bind(Ie);Ge.i=Y,Ge.id=Y.uid,Ie.scheduler=()=>a1(Ge),wo(Y,!0),Te()},F=(Y,Z,ne)=>{Z.component=Y;const ge=Y.vnode.props;Y.vnode=Z,Y.next=null,fP(Y,Z.props,ge,ne),gP(Y,Z.children,ne),pi(),Jy(Y),mi()},M=(Y,Z,ne,ge,ae,ce,fe,Ae,Ie=!1)=>{const Te=Y&&Y.children,Ge=Y?Y.shapeFlag:0,ke=Z.children,{patchFlag:$e,shapeFlag:Be}=Z;if($e>0){if($e&128){K(Te,ke,ne,ge,ae,ce,fe,Ae,Ie);return}else if($e&256){O(Te,ke,ne,ge,ae,ce,fe,Ae,Ie);return}}Be&8?(Ge&16&&he(Te,ae,ce),ke!==Te&&u(ne,ke)):Ge&16?Be&16?K(Te,ke,ne,ge,ae,ce,fe,Ae,Ie):he(Te,ae,ce,!0):(Ge&8&&u(ne,""),Be&16&&S(ke,ne,ge,ae,ce,fe,Ae,Ie))},O=(Y,Z,ne,ge,ae,ce,fe,Ae,Ie)=>{Y=Y||ql,Z=Z||ql;const Te=Y.length,Ge=Z.length,ke=Math.min(Te,Ge);let $e;for($e=0;$e<ke;$e++){const Be=Z[$e]=Ie?ji(Z[$e]):vs(Z[$e]);v(Y[$e],Be,ne,null,ae,ce,fe,Ae,Ie)}Te>Ge?he(Y,ae,ce,!0,!1,ke):S(Z,ne,ge,ae,ce,fe,Ae,Ie,ke)},K=(Y,Z,ne,ge,ae,ce,fe,Ae,Ie)=>{let Te=0;const Ge=Z.length;let ke=Y.length-1,$e=Ge-1;for(;Te<=ke&&Te<=$e;){const Be=Y[Te],We=Z[Te]=Ie?ji(Z[Te]):vs(Z[Te]);if(ra(Be,We))v(Be,We,ne,null,ae,ce,fe,Ae,Ie);else break;Te++}for(;Te<=ke&&Te<=$e;){const Be=Y[ke],We=Z[$e]=Ie?ji(Z[$e]):vs(Z[$e]);if(ra(Be,We))v(Be,We,ne,null,ae,ce,fe,Ae,Ie);else break;ke--,$e--}if(Te>ke){if(Te<=$e){const Be=$e+1,We=Be<Ge?Z[Be].el:ge;for(;Te<=$e;)v(null,Z[Te]=Ie?ji(Z[Te]):vs(Z[Te]),ne,We,ae,ce,fe,Ae,Ie),Te++}}else if(Te>$e)for(;Te<=ke;)H(Y[Te],ae,ce,!0),Te++;else{const Be=Te,We=Te,Ke=new Map;for(Te=We;Te<=$e;Te++){const Et=Z[Te]=Ie?ji(Z[Te]):vs(Z[Te]);Et.key!=null&&Ke.set(Et.key,Te)}let Ee,ye=0;const be=$e-We+1;let Oe=!1,je=0;const lt=new Array(be);for(Te=0;Te<be;Te++)lt[Te]=0;for(Te=Be;Te<=ke;Te++){const Et=Y[Te];if(ye>=be){H(Et,ae,ce,!0);continue}let jt;if(Et.key!=null)jt=Ke.get(Et.key);else for(Ee=We;Ee<=$e;Ee++)if(lt[Ee-We]===0&&ra(Et,Z[Ee])){jt=Ee;break}jt===void 0?H(Et,ae,ce,!0):(lt[jt-We]=Te+1,jt>=je?je=jt:Oe=!0,v(Et,Z[jt],ne,null,ae,ce,fe,Ae,Ie),ye++)}const gt=Oe?vP(lt):ql;for(Ee=gt.length-1,Te=be-1;Te>=0;Te--){const Et=We+Te,jt=Z[Et],pt=Et+1<Ge?Z[Et+1].el:ge;lt[Te]===0?v(null,jt,ne,pt,ae,ce,fe,Ae,Ie):Oe&&(Ee<0||Te!==gt[Ee]?j(jt,ne,pt,2):Ee--)}}},j=(Y,Z,ne,ge,ae=null)=>{const{el:ce,type:fe,transition:Ae,children:Ie,shapeFlag:Te}=Y;if(Te&6){j(Y.component.subTree,Z,ne,ge);return}if(Te&128){Y.suspense.move(Z,ne,ge);return}if(Te&64){fe.move(Y,Z,ne,G);return}if(fe===Re){n(ce,Z,ne);for(let ke=0;ke<Ie.length;ke++)j(Ie[ke],Z,ne,ge);n(Y.anchor,Z,ne);return}if(fe===$o){b(Y,Z,ne);return}if(ge!==2&&Te&1&&Ae)if(ge===0)Ae.beforeEnter(ce),n(ce,Z,ne),sn(()=>Ae.enter(ce),ae);else{const{leave:ke,delayLeave:$e,afterLeave:Be}=Ae,We=()=>{Y.ctx.isUnmounted?s(ce):n(ce,Z,ne)},Ke=()=>{ke(ce,()=>{We(),Be&&Be()})};$e?$e(ce,We,Ke):Ke()}else n(ce,Z,ne)},H=(Y,Z,ne,ge=!1,ae=!1)=>{const{type:ce,props:fe,ref:Ae,children:Ie,dynamicChildren:Te,shapeFlag:Ge,patchFlag:ke,dirs:$e,cacheIndex:Be}=Y;if(ke===-2&&(ae=!1),Ae!=null&&(pi(),Zl(Ae,null,ne,Y,!0),mi()),Be!=null&&(Z.renderCache[Be]=void 0),Ge&256){Z.ctx.deactivate(Y);return}const We=Ge&1&&$e,Ke=!eo(Y);let Ee;if(Ke&&(Ee=fe&&fe.onVnodeBeforeUnmount)&&ms(Ee,Z,Y),Ge&6)re(Y.component,ne,ge);else{if(Ge&128){Y.suspense.unmount(ne,ge);return}We&&wa(Y,null,Z,"beforeUnmount"),Ge&64?Y.type.remove(Y,Z,ne,G,ge):Te&&!Te.hasOnce&&(ce!==Re||ke>0&&ke&64)?he(Te,Z,ne,!1,!0):(ce===Re&&ke&384||!ae&&Ge&16)&&he(Ie,Z,ne),ge&&W(Y)}(Ke&&(Ee=fe&&fe.onVnodeUnmounted)||We)&&sn(()=>{Ee&&ms(Ee,Z,Y),We&&wa(Y,null,Z,"unmounted")},ne)},W=Y=>{const{type:Z,el:ne,anchor:ge,transition:ae}=Y;if(Z===Re){X(ne,ge);return}if(Z===$o){k(Y);return}const ce=()=>{s(ne),ae&&!ae.persisted&&ae.afterLeave&&ae.afterLeave()};if(Y.shapeFlag&1&&ae&&!ae.persisted){const{leave:fe,delayLeave:Ae}=ae,Ie=()=>fe(ne,ce);Ae?Ae(Y.el,ce,Ie):Ie()}else ce()},X=(Y,Z)=>{let ne;for(;Y!==Z;)ne=h(Y),s(Y),Y=ne;s(Z)},re=(Y,Z,ne)=>{const{bum:ge,scope:ae,job:ce,subTree:fe,um:Ae,m:Ie,a:Te,parent:Ge,slots:{__:ke}}=Y;U0(Ie),U0(Te),ge&&Ql(ge),Ge&&dt(ke)&&ke.forEach($e=>{Ge.renderCache[$e]=void 0}),ae.stop(),ce&&(ce.flags|=8,H(fe,Y,Z,ne)),Ae&&sn(Ae,Z),sn(()=>{Y.isUnmounted=!0},Z),Z&&Z.pendingBranch&&!Z.isUnmounted&&Y.asyncDep&&!Y.asyncResolved&&Y.suspenseId===Z.pendingId&&(Z.deps--,Z.deps===0&&Z.resolve())},he=(Y,Z,ne,ge=!1,ae=!1,ce=0)=>{for(let fe=ce;fe<Y.length;fe++)H(Y[fe],Z,ne,ge,ae)},ue=Y=>{if(Y.shapeFlag&6)return ue(Y.component.subTree);if(Y.shapeFlag&128)return Y.suspense.next();const Z=h(Y.anchor||Y.el),ne=Z&&Z[sA];return ne?h(ne):Z};let pe=!1;const q=(Y,Z,ne)=>{Y==null?Z._vnode&&H(Z._vnode,null,null,!0):v(Z._vnode||null,Y,Z,null,null,null,ne),Z._vnode=Y,pe||(pe=!0,Jy(),L0(),pe=!1)},G={p:v,um:H,m:j,r:W,mt:V,mc:S,pc:M,pbc:A,n:ue,o:t};let oe,Q;return e&&([oe,Q]=e(G)),{render:q,hydrate:oe,createApp:uP(q,oe)}}function Jp({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function wo({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function BA(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function g1(t,e,r=!1){const n=t.children,s=e.children;if(dt(n)&&dt(s))for(let i=0;i<n.length;i++){const a=n[i];let o=s[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[i]=ji(s[i]),o.el=a.el),!r&&o.patchFlag!==-2&&g1(a,o)),o.type===to&&(o.el=a.el),o.type===zr&&!o.el&&(o.el=a.el)}}function vP(t){const e=t.slice(),r=[0];let n,s,i,a,o;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(s=r[r.length-1],t[s]<c){e[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)o=i+a>>1,t[r[o]]<c?i=o+1:a=o;c<t[r[i]]&&(i>0&&(e[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=e[a];return r}function UA(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:UA(e)}function U0(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const $A=Symbol.for("v-scx"),VA=()=>Ds($A);function xP(t,e){return Bd(t,null,e)}function yP(t,e){return Bd(t,null,{flush:"post"})}function HA(t,e){return Bd(t,null,{flush:"sync"})}function Vt(t,e,r){return Bd(t,e,r)}function Bd(t,e,r=Yt){const{immediate:n,deep:s,flush:i,once:a}=r,o=gr({},r),l=e&&n||!e&&i!=="post";let c;if(hc){if(i==="sync"){const p=VA();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=Us,p.resume=Us,p.pause=Us,p}}const u=on;o.call=(p,m,v)=>Hs(p,u,m,v);let f=!1;i==="post"?o.scheduler=p=>{sn(p,u&&u.suspense)}:i!=="sync"&&(f=!0,o.scheduler=(p,m)=>{m?p():a1(p)}),o.augmentJob=p=>{e&&(p.flags|=4),f&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const h=l3(t,e,o);return hc&&(c?c.push(h):l&&h()),h}function EP(t,e,r){const n=this.proxy,s=_r(t)?t.includes(".")?jA(n,t):()=>n[t]:t.bind(n,n);let i;At(e)?i=e:(i=e.handler,r=e);const a=qo(this),o=Bd(s,i.bind(n),r);return a(),o}function jA(t,e){const r=e.split(".");return()=>{let n=t;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}function _P(t,e,r=Yt){const n=Ws(),s=Tn(e),i=xs(e),a=GA(t,s),o=X2((l,c)=>{let u,f=Yt,h;return HA(()=>{const p=t[s];ss(u,p)&&(u=p,c())}),{get(){return l(),r.get?r.get(u):u},set(p){const m=r.set?r.set(p):p;if(!ss(m,u)&&!(f!==Yt&&ss(p,f)))return;const v=n.vnode.props;v&&(e in v||s in v||i in v)&&(`onUpdate:${e}`in v||`onUpdate:${s}`in v||`onUpdate:${i}`in v)||(u=p,c()),n.emit(`update:${e}`,m),ss(p,m)&&ss(p,f)&&!ss(m,h)&&c(),f=p,h=m}}});return o[Symbol.iterator]=()=>{let l=0;return{next(){return l<2?{value:l++?a||Yt:o,done:!1}:{done:!0}}}},o}const GA=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Tn(e)}Modifiers`]||t[`${xs(e)}Modifiers`];function bP(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||Yt;let s=r;const i=e.startsWith("update:"),a=i&&GA(n,e.slice(7));a&&(a.trim&&(s=r.map(u=>_r(u)?u.trim():u)),a.number&&(s=r.map(P0)));let o,l=n[o=Iu(e)]||n[o=Iu(Tn(e))];!l&&i&&(l=n[o=Iu(xs(e))]),l&&Hs(l,t,6,s);const c=n[o+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,Hs(c,t,6,s)}}function WA(t,e,r=!1){const n=e.emitsCache,s=n.get(t);if(s!==void 0)return s;const i=t.emits;let a={},o=!1;if(!At(t)){const l=c=>{const u=WA(c,e,!0);u&&(o=!0,gr(a,u))};!r&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!o?(hr(t)&&n.set(t,null),null):(dt(i)?i.forEach(l=>a[l]=null):gr(a,i),hr(t)&&n.set(t,a),a)}function Xh(t,e){return!t||!Nd(e)?!1:(e=e.slice(2).replace(/Once$/,""),or(t,e[0].toLowerCase()+e.slice(1))||or(t,xs(e))||or(t,e))}function d0(t){const{type:e,vnode:r,proxy:n,withProxy:s,propsOptions:[i],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:f,data:h,setupState:p,ctx:m,inheritAttrs:v}=t,g=ud(t);let y,E;try{if(r.shapeFlag&4){const k=s||n,P=k;y=vs(c.call(P,k,u,f,p,h,m)),E=o}else{const k=e;y=vs(k.length>1?k(f,{attrs:o,slots:a,emit:l}):k(f,null)),E=e.props?o:AP(o)}}catch(k){Nu.length=0,ol(k,t,1),y=nt(zr)}let b=y;if(E&&v!==!1){const k=Object.keys(E),{shapeFlag:P}=b;k.length&&P&7&&(i&&k.some(Wv)&&(E=TP(E,i)),b=Fa(b,E,!1,!0))}return r.dirs&&(b=Fa(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(r.dirs):r.dirs),r.transition&&vi(b,r.transition),y=b,ud(g),y}function SP(t,e=!0){let r;for(let n=0;n<t.length;n++){const s=t[n];if(xi(s)){if(s.type!==zr||s.children==="v-if"){if(r)return;r=s}}else return}return r}const AP=t=>{let e;for(const r in t)(r==="class"||r==="style"||Nd(r))&&((e||(e={}))[r]=t[r]);return e},TP=(t,e)=>{const r={};for(const n in t)(!Wv(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function wP(t,e,r){const{props:n,children:s,component:i}=t,{props:a,children:o,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?uE(n,a,c):!!a;if(l&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const h=u[f];if(a[h]!==n[h]&&!Xh(c,h))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?uE(n,a,c):!0:!!a;return!1}function uE(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==t[i]&&!Xh(r,i))return!0}return!1}function Yh({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const $0=t=>t.__isSuspense;let Ug=0;const CP={name:"Suspense",__isSuspense:!0,process(t,e,r,n,s,i,a,o,l,c){if(t==null)kP(e,r,n,s,i,a,o,l,c);else{if(i&&i.deps>0&&!t.suspense.isInFallback){e.suspense=t.suspense,e.suspense.vnode=e,e.el=t.el;return}DP(t,e,r,n,s,a,o,l,c)}},hydrate:PP,normalize:RP},IP=CP;function fd(t,e){const r=t.props&&t.props[e];At(r)&&r()}function kP(t,e,r,n,s,i,a,o,l){const{p:c,o:{createElement:u}}=l,f=u("div"),h=t.suspense=zA(t,s,n,e,f,r,i,a,o,l);c(null,h.pendingBranch=t.ssContent,f,null,n,h,i,a),h.deps>0?(fd(t,"onPending"),fd(t,"onFallback"),c(null,t.ssFallback,e,r,n,null,i,a),ec(h,t.ssFallback)):h.resolve(!1,!0)}function DP(t,e,r,n,s,i,a,o,{p:l,um:c,o:{createElement:u}}){const f=e.suspense=t.suspense;f.vnode=e,e.el=t.el;const h=e.ssContent,p=e.ssFallback,{activeBranch:m,pendingBranch:v,isInFallback:g,isHydrating:y}=f;if(v)f.pendingBranch=h,ra(h,v)?(l(v,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():g&&(y||(l(m,p,r,n,s,null,i,a,o),ec(f,p)))):(f.pendingId=Ug++,y?(f.isHydrating=!1,f.activeBranch=v):c(v,s,f),f.deps=0,f.effects.length=0,f.hiddenContainer=u("div"),g?(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():(l(m,p,r,n,s,null,i,a,o),ec(f,p))):m&&ra(h,m)?(l(m,h,r,n,s,f,i,a,o),f.resolve(!0)):(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0&&f.resolve()));else if(m&&ra(h,m))l(m,h,r,n,s,f,i,a,o),ec(f,h);else if(fd(e,"onPending"),f.pendingBranch=h,h.shapeFlag&512?f.pendingId=h.component.suspenseId:f.pendingId=Ug++,l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0)f.resolve();else{const{timeout:E,pendingId:b}=f;E>0?setTimeout(()=>{f.pendingId===b&&f.fallback(p)},E):E===0&&f.fallback(p)}}function zA(t,e,r,n,s,i,a,o,l,c,u=!1){const{p:f,m:h,um:p,n:m,o:{parentNode:v,remove:g}}=c;let y;const E=FP(t);E&&e&&e.pendingBranch&&(y=e.pendingId,e.deps++);const b=t.props?R0(t.props.timeout):void 0,k=i,P={vnode:t,parent:e,parentComponent:r,namespace:a,container:n,hiddenContainer:s,deps:0,pendingId:Ug++,timeout:typeof b=="number"?b:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(w=!1,x=!1){const{vnode:S,activeBranch:_,pendingBranch:A,pendingId:C,effects:T,parentComponent:D,container:V}=P;let B=!1;P.isHydrating?P.isHydrating=!1:w||(B=_&&A.transition&&A.transition.mode==="out-in",B&&(_.transition.afterLeave=()=>{C===P.pendingId&&(h(A,V,i===k?m(_):i,0),ld(T))}),_&&(v(_.el)===V&&(i=m(_)),p(_,D,P,!0)),B||h(A,V,i,0)),ec(P,A),P.pendingBranch=null,P.isInFallback=!1;let R=P.parent,F=!1;for(;R;){if(R.pendingBranch){R.effects.push(...T),F=!0;break}R=R.parent}!F&&!B&&ld(T),P.effects=[],E&&e&&e.pendingBranch&&y===e.pendingId&&(e.deps--,e.deps===0&&!x&&e.resolve()),fd(S,"onResolve")},fallback(w){if(!P.pendingBranch)return;const{vnode:x,activeBranch:S,parentComponent:_,container:A,namespace:C}=P;fd(x,"onFallback");const T=m(S),D=()=>{P.isInFallback&&(f(null,w,A,T,_,null,C,o,l),ec(P,w))},V=w.transition&&w.transition.mode==="out-in";V&&(S.transition.afterLeave=D),P.isInFallback=!0,p(S,_,null,!0),V||D()},move(w,x,S){P.activeBranch&&h(P.activeBranch,w,x,S),P.container=w},next(){return P.activeBranch&&m(P.activeBranch)},registerDep(w,x,S){const _=!!P.pendingBranch;_&&P.deps++;const A=w.vnode.el;w.asyncDep.catch(C=>{ol(C,w,0)}).then(C=>{if(w.isUnmounted||P.isUnmounted||P.pendingId!==w.suspenseId)return;w.asyncResolved=!0;const{vnode:T}=w;jg(w,C,!1),A&&(T.el=A);const D=!A&&w.subTree.el;x(w,T,v(A||w.subTree.el),A?null:m(w.subTree),P,a,S),D&&g(D),Yh(w,T.el),_&&--P.deps===0&&P.resolve()})},unmount(w,x){P.isUnmounted=!0,P.activeBranch&&p(P.activeBranch,r,w,x),P.pendingBranch&&p(P.pendingBranch,r,w,x)}};return P}function PP(t,e,r,n,s,i,a,o,l){const c=e.suspense=zA(e,n,r,t.parentNode,document.createElement("div"),null,s,i,a,o,!0),u=l(t,c.pendingBranch=e.ssContent,r,c,i,a);return c.deps===0&&c.resolve(!1,!0),u}function RP(t){const{shapeFlag:e,children:r}=t,n=e&32;t.ssContent=dE(n?r.default:r),t.ssFallback=n?dE(r.fallback):nt(zr)}function dE(t){let e;if(At(t)){const r=Ko&&t._c;r&&(t._d=!1,N()),t=t(),r&&(t._d=!0,e=Gn,qA())}return dt(t)&&(t=SP(t)),t=vs(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(r=>r!==t)),t}function KA(t,e){e&&e.pendingBranch?dt(t)?e.effects.push(...t):e.effects.push(t):ld(t)}function ec(t,e){t.activeBranch=e;const{vnode:r,parentComponent:n}=t;let s=e.el;for(;!s&&e.component;)e=e.component.subTree,s=e.el;r.el=s,n&&n.subTree===r&&(n.vnode.el=s,Yh(n,s))}function FP(t){const e=t.props&&t.props.suspensible;return e!=null&&e!==!1}const Re=Symbol.for("v-fgt"),to=Symbol.for("v-txt"),zr=Symbol.for("v-cmt"),$o=Symbol.for("v-stc"),Nu=[];let Gn=null;function N(t=!1){Nu.push(Gn=t?null:[])}function qA(){Nu.pop(),Gn=Nu[Nu.length-1]||null}let Ko=1;function $g(t,e=!1){Ko+=t,t<0&&Gn&&e&&(Gn.hasOnce=!0)}function XA(t){return t.dynamicChildren=Ko>0?Gn||ql:null,qA(),Ko>0&&Gn&&Gn.push(t),t}function L(t,e,r,n,s,i){return XA(d(t,e,r,n,s,i,!0))}function Kr(t,e,r,n,s){return XA(nt(t,e,r,n,s,!0))}function xi(t){return t?t.__v_isVNode===!0:!1}function ra(t,e){return t.type===e.type&&t.key===e.key}function NP(t){}const YA=({key:t})=>t??null,f0=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?_r(t)||Tr(t)||At(t)?{i:ln,r:t,k:e,f:!!r}:t:null);function d(t,e=null,r=null,n=0,s=null,i=t===Re?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&YA(e),ref:e&&f0(e),scopeId:jh,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ln};return o?(v1(l,r),i&128&&t.normalize(l)):r&&(l.shapeFlag|=_r(r)?8:16),Ko>0&&!a&&Gn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Gn.push(l),l}const nt=OP;function OP(t,e=null,r=null,n=0,s=null,i=!1){if((!t||t===EA)&&(t=zr),xi(t)){const o=Fa(t,e,!0);return r&&v1(o,r),Ko>0&&!i&&Gn&&(o.shapeFlag&6?Gn[Gn.indexOf(t)]=o:Gn.push(o)),o.patchFlag=-2,o}if(HP(t)&&(t=t.__vccOpts),e){e=QA(e);let{class:o,style:l}=e;o&&!_r(o)&&(e.class=Qe(o)),hr(l)&&(Vh(l)&&!dt(l)&&(l=gr({},l)),e.style=as(l))}const a=_r(t)?1:$0(t)?128:aA(t)?64:hr(t)?4:At(t)?2:0;return d(t,e,r,n,s,a,i,!0)}function QA(t){return t?Vh(t)||kA(t)?gr({},t):t:null}function Fa(t,e,r=!1,n=!1){const{props:s,ref:i,patchFlag:a,children:o,transition:l}=t,c=e?JA(s||{},e):s,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&YA(c),ref:e&&e.ref?r&&i?dt(i)?i.concat(f0(e)):[i,f0(e)]:f0(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Re?a===-1?16:a|16:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Fa(t.ssContent),ssFallback:t.ssFallback&&Fa(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&vi(u,l.clone(u)),u}function Ne(t=" ",e=0){return nt(to,null,t,e)}function Fr(t,e){const r=nt($o,null,t);return r.staticCount=e,r}function _e(t="",e=!1){return e?(N(),Kr(zr,null,t)):nt(zr,null,t)}function vs(t){return t==null||typeof t=="boolean"?nt(zr):dt(t)?nt(Re,null,t.slice()):xi(t)?ji(t):nt(to,null,String(t))}function ji(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Fa(t)}function v1(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(dt(e))r=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),v1(t,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!kA(e)?e._ctx=ln:s===3&&ln&&(ln.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else At(e)?(e={default:e,_ctx:ln},r=32):(e=String(e),n&64?(r=16,e=[Ne(e)]):r=8);t.children=e,t.shapeFlag|=r}function JA(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=Qe([e.class,n.class]));else if(s==="style")e.style=as([e.style,n.style]);else if(Nd(s)){const i=e[s],a=n[s];a&&i!==a&&!(dt(i)&&i.includes(a))&&(e[s]=i?[].concat(i,a):a)}else s!==""&&(e[s]=n[s])}return e}function ms(t,e,r,n=null){Hs(t,e,7,[r,n])}const MP=TA();let LP=0;function ZA(t,e,r){const n=t.type,s=(e?e.appContext:t.appContext)||MP,i={uid:LP++,vnode:t,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Xv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:PA(n,s),emitsOptions:WA(n,s),emit:null,emitted:null,propsDefaults:Yt,inheritAttrs:n.inheritAttrs,ctx:Yt,data:Yt,props:Yt,attrs:Yt,slots:Yt,refs:Yt,setupState:Yt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=bP.bind(null,i),t.ce&&t.ce(i),i}let on=null;const Ws=()=>on||ln;let V0,Vg;{const t=Oh(),e=(r,n)=>{let s;return(s=t[r])||(s=t[r]=[]),s.push(n),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};V0=e("__VUE_INSTANCE_SETTERS__",r=>on=r),Vg=e("__VUE_SSR_SETTERS__",r=>hc=r)}const qo=t=>{const e=on;return V0(t),t.scope.on(),()=>{t.scope.off(),V0(e)}},Hg=()=>{on&&on.scope.off(),V0(null)};function eT(t){return t.vnode.shapeFlag&4}let hc=!1;function tT(t,e=!1,r=!1){e&&Vg(e);const{props:n,children:s}=t.vnode,i=eT(t);dP(t,n,i,e),mP(t,s,r||e);const a=i?BP(t,e):void 0;return e&&Vg(!1),a}function BP(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Og);const{setup:n}=r;if(n){pi();const s=t.setupContext=n.length>1?nT(t):null,i=qo(t),a=Rc(n,t,0,[t.props,s]),o=Kv(a);if(mi(),i(),(o||t.sp)&&!eo(t)&&l1(t),o){if(a.then(Hg,Hg),e)return a.then(l=>{jg(t,l,e)}).catch(l=>{ol(l,t,0)});t.asyncDep=a}else jg(t,a,e)}else rT(t,e)}function jg(t,e,r){At(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:hr(e)&&(t.setupState=s1(e)),rT(t,r)}let H0,Gg;function UP(t){H0=t,Gg=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,G3))}}const $P=()=>!H0;function rT(t,e,r){const n=t.type;if(!t.render){if(!e&&H0&&!n.render){const s=n.template||h1(t).template;if(s){const{isCustomElement:i,compilerOptions:a}=t.appContext.config,{delimiters:o,compilerOptions:l}=n,c=gr(gr({isCustomElement:i,delimiters:o},a),l);n.render=H0(s,c)}}t.render=n.render||Us,Gg&&Gg(t)}{const s=qo(t);pi();try{sP(t)}finally{mi(),s()}}}const VP={get(t,e){return $n(t,"get",""),t[e]}};function nT(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,VP),slots:t.slots,emit:t.emit,expose:e}}function Ud(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(s1(Hh(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in Ru)return Ru[r](t)},has(e,r){return r in e||r in Ru}})):t.proxy}function Wg(t,e=!0){return At(t)?t.displayName||t.name:t.name||e&&t.__name}function HP(t){return At(t)&&"__vccOpts"in t}const Se=(t,e)=>s3(t,e,hc);function Xo(t,e,r){const n=arguments.length;return n===2?hr(e)&&!dt(e)?xi(e)?nt(t,null,[e]):nt(t,e):nt(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&xi(r)&&(r=[r]),nt(t,e,r))}function jP(){}function GP(t,e,r,n){const s=r[n];if(s&&sT(s,t))return s;const i=e();return i.memo=t.slice(),i.cacheIndex=n,r[n]=i}function sT(t,e){const r=t.memo;if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(ss(r[n],e[n]))return!1;return Ko>0&&Gn&&Gn.push(t),!0}const aT="3.5.17",WP=Us,zP=h3,KP=Ll,qP=nA,XP={createComponentInstance:ZA,setupComponent:tT,renderComponentRoot:d0,setCurrentRenderingInstance:ud,isVNode:xi,normalizeVNode:vs,getComponentPublicInstance:Ud,ensureValidVNode:f1,pushWarningContext:c3,popWarningContext:u3},YP=XP,QP=null,JP=null,ZP=null;/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let zg;const fE=typeof window<"u"&&window.trustedTypes;if(fE)try{zg=fE.createPolicy("vue",{createHTML:t=>t})}catch{}const iT=zg?t=>zg.createHTML(t):t=>t,eR="http://www.w3.org/2000/svg",tR="http://www.w3.org/1998/Math/MathML",Ya=typeof document<"u"?document:null,hE=Ya&&Ya.createElement("template"),rR={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const s=e==="svg"?Ya.createElementNS(eR,t):e==="mathml"?Ya.createElementNS(tR,t):r?Ya.createElement(t,{is:r}):Ya.createElement(t);return t==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:t=>Ya.createTextNode(t),createComment:t=>Ya.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ya.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,s,i){const a=r?r.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{hE.innerHTML=iT(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const o=hE.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},Fi="transition",eu="animation",pc=Symbol("_vtc"),oT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},lT=gr({},o1,oT),nR=t=>(t.displayName="Transition",t.props=lT,t),sR=nR((t,{slots:e})=>Xo(uA,cT(t),e)),Co=(t,e=[])=>{dt(t)?t.forEach(r=>r(...e)):t&&t(...e)},pE=t=>t?dt(t)?t.some(e=>e.length>1):t.length>1:!1;function cT(t){const e={};for(const T in t)T in oT||(e[T]=t[T]);if(t.css===!1)return e;const{name:r="v",type:n,duration:s,enterFromClass:i=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:o=`${r}-enter-to`,appearFromClass:l=i,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:f=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:p=`${r}-leave-to`}=t,m=aR(s),v=m&&m[0],g=m&&m[1],{onBeforeEnter:y,onEnter:E,onEnterCancelled:b,onLeave:k,onLeaveCancelled:P,onBeforeAppear:w=y,onAppear:x=E,onAppearCancelled:S=b}=e,_=(T,D,V,B)=>{T._enterCancelled=B,Bi(T,D?u:o),Bi(T,D?c:a),V&&V()},A=(T,D)=>{T._isLeaving=!1,Bi(T,f),Bi(T,p),Bi(T,h),D&&D()},C=T=>(D,V)=>{const B=T?x:E,R=()=>_(D,T,V);Co(B,[D,R]),mE(()=>{Bi(D,T?l:i),Sa(D,T?u:o),pE(B)||gE(D,n,v,R)})};return gr(e,{onBeforeEnter(T){Co(y,[T]),Sa(T,i),Sa(T,a)},onBeforeAppear(T){Co(w,[T]),Sa(T,l),Sa(T,c)},onEnter:C(!1),onAppear:C(!0),onLeave(T,D){T._isLeaving=!0;const V=()=>A(T,D);Sa(T,f),T._enterCancelled?(Sa(T,h),Kg()):(Kg(),Sa(T,h)),mE(()=>{T._isLeaving&&(Bi(T,f),Sa(T,p),pE(k)||gE(T,n,g,V))}),Co(k,[T,V])},onEnterCancelled(T){_(T,!1,void 0,!0),Co(b,[T])},onAppearCancelled(T){_(T,!0,void 0,!0),Co(S,[T])},onLeaveCancelled(T){A(T),Co(P,[T])}})}function aR(t){if(t==null)return null;if(hr(t))return[Zp(t.enter),Zp(t.leave)];{const e=Zp(t);return[e,e]}}function Zp(t){return R0(t)}function Sa(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t[pc]||(t[pc]=new Set)).add(e)}function Bi(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const r=t[pc];r&&(r.delete(e),r.size||(t[pc]=void 0))}function mE(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let iR=0;function gE(t,e,r,n){const s=t._endId=++iR,i=()=>{s===t._endId&&n()};if(r!=null)return setTimeout(i,r);const{type:a,timeout:o,propCount:l}=uT(t,e);if(!a)return n();const c=a+"end";let u=0;const f=()=>{t.removeEventListener(c,h),i()},h=p=>{p.target===t&&++u>=l&&f()};setTimeout(()=>{u<l&&f()},o+1),t.addEventListener(c,h)}function uT(t,e){const r=window.getComputedStyle(t),n=m=>(r[m]||"").split(", "),s=n(`${Fi}Delay`),i=n(`${Fi}Duration`),a=vE(s,i),o=n(`${eu}Delay`),l=n(`${eu}Duration`),c=vE(o,l);let u=null,f=0,h=0;e===Fi?a>0&&(u=Fi,f=a,h=i.length):e===eu?c>0&&(u=eu,f=c,h=l.length):(f=Math.max(a,c),u=f>0?a>c?Fi:eu:null,h=u?u===Fi?i.length:l.length:0);const p=u===Fi&&/\b(transform|all)(,|$)/.test(n(`${Fi}Property`).toString());return{type:u,timeout:f,propCount:h,hasTransform:p}}function vE(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>xE(r)+xE(t[n])))}function xE(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Kg(){return document.body.offsetHeight}function oR(t,e,r){const n=t[pc];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const j0=Symbol("_vod"),dT=Symbol("_vsh"),fT={beforeMount(t,{value:e},{transition:r}){t[j0]=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):tu(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:n}){!e!=!r&&(n?e?(n.beforeEnter(t),tu(t,!0),n.enter(t)):n.leave(t,()=>{tu(t,!1)}):tu(t,e))},beforeUnmount(t,{value:e}){tu(t,e)}};function tu(t,e){t.style.display=e?t[j0]:"none",t[dT]=!e}function lR(){fT.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const hT=Symbol("");function cR(t){const e=Ws();if(!e)return;const r=e.ut=(s=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(i=>G0(i,s))},n=()=>{const s=t(e.proxy);e.ce?G0(e.ce,s):qg(e.subTree,s),r(s)};c1(()=>{ld(n)}),Ut(()=>{Vt(n,Us,{flush:"post"});const s=new MutationObserver(n);s.observe(e.subTree.el.parentNode,{childList:!0}),Ba(()=>s.disconnect())})}function qg(t,e){if(t.shapeFlag&128){const r=t.suspense;t=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{qg(r.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)G0(t.el,e);else if(t.type===Re)t.children.forEach(r=>qg(r,e));else if(t.type===$o){let{el:r,anchor:n}=t;for(;r&&(G0(r,e),r!==n);)r=r.nextSibling}}function G0(t,e){if(t.nodeType===1){const r=t.style;let n="";for(const s in e)r.setProperty(`--${s}`,e[s]),n+=`--${s}: ${e[s]};`;r[hT]=n}}const uR=/(^|;)\s*display\s*:/;function dR(t,e,r){const n=t.style,s=_r(r);let i=!1;if(r&&!s){if(e)if(_r(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&h0(n,o,"")}else for(const a in e)r[a]==null&&h0(n,a,"");for(const a in r)a==="display"&&(i=!0),h0(n,a,r[a])}else if(s){if(e!==r){const a=n[hT];a&&(r+=";"+a),n.cssText=r,i=uR.test(r)}}else e&&t.removeAttribute("style");j0 in t&&(t[j0]=i?n.display:"",t[dT]&&(n.display="none"))}const yE=/\s*!important$/;function h0(t,e,r){if(dt(r))r.forEach(n=>h0(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=fR(t,e);yE.test(r)?t.setProperty(xs(n),r.replace(yE,""),"important"):t[n]=r}}const EE=["Webkit","Moz","ms"],em={};function fR(t,e){const r=em[e];if(r)return r;let n=Tn(e);if(n!=="filter"&&n in t)return em[e]=n;n=Od(n);for(let s=0;s<EE.length;s++){const i=EE[s]+n;if(i in t)return em[e]=i}return e}const _E="http://www.w3.org/1999/xlink";function bE(t,e,r,n,s,i=TD(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(_E,e.slice(6,e.length)):t.setAttributeNS(_E,e,r):r==null||i&&!k2(r)?t.removeAttribute(e):t.setAttribute(e,i?"":da(r)?String(r):r)}function SE(t,e,r,n,s){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?iT(r):r);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const o=i==="OPTION"?t.getAttribute("value")||"":t.value,l=r==null?t.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in t))&&(t.value=l),r==null&&t.removeAttribute(e),t._value=r;return}let a=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=k2(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{t[e]=r}catch{}a&&t.removeAttribute(s||e)}function Za(t,e,r,n){t.addEventListener(e,r,n)}function hR(t,e,r,n){t.removeEventListener(e,r,n)}const AE=Symbol("_vei");function pR(t,e,r,n,s=null){const i=t[AE]||(t[AE]={}),a=i[e];if(n&&a)a.value=n;else{const[o,l]=mR(e);if(n){const c=i[e]=xR(n,s);Za(t,o,c,l)}else a&&(hR(t,o,a,l),i[e]=void 0)}}const TE=/(?:Once|Passive|Capture)$/;function mR(t){let e;if(TE.test(t)){e={};let n;for(;n=t.match(TE);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):xs(t.slice(2)),e]}let tm=0;const gR=Promise.resolve(),vR=()=>tm||(gR.then(()=>tm=0),tm=Date.now());function xR(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Hs(yR(n,r.value),e,5,[n])};return r.value=t,r.attached=vR(),r}function yR(t,e){if(dt(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const wE=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,ER=(t,e,r,n,s,i)=>{const a=s==="svg";e==="class"?oR(t,n,a):e==="style"?dR(t,r,n):Nd(e)?Wv(e)||pR(t,e,r,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):_R(t,e,n,a))?(SE(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&bE(t,e,n,a,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!_r(n))?SE(t,Tn(e),n,i,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),bE(t,e,n,a))};function _R(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&wE(e)&&At(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return wE(e)&&_r(r)?!1:e in t}const CE={};/*! #__NO_SIDE_EFFECTS__ */function pT(t,e,r){const n=Md(t,e);Fh(n)&&gr(n,e);class s extends Qh{constructor(a){super(n,a,r)}}return s.def=n,s}/*! #__NO_SIDE_EFFECTS__ */const bR=(t,e)=>pT(t,e,wT),SR=typeof HTMLElement<"u"?HTMLElement:class{};class Qh extends SR{constructor(e,r={},n=z0){super(),this._def=e,this._props=r,this._createApp=n,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&n!==z0?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this}connectedCallback(){if(!this.isConnected)return;!this.shadowRoot&&!this._resolved&&this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof Qh){this._parent=e;break}this._instance||(this._resolved?this._mount(this._def):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._inheritParentContext(e))}_inheritParentContext(e=this._parent){e&&this._app&&Object.setPrototypeOf(this._app._context.provides,e._instance.provides)}disconnectedCallback(){this._connected=!1,ll(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);this._ob=new MutationObserver(n=>{for(const s of n)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(n,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:i,styles:a}=n;let o;if(i&&!dt(i))for(const l in i){const c=i[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=R0(this._props[l])),(o||(o=Object.create(null)))[Tn(l)]=!0)}this._numberProps=o,this._resolveProps(n),this.shadowRoot&&this._applyStyles(a),this._mount(n)},r=this._def.__asyncLoader;r?this._pendingResolve=r().then(n=>{n.configureApp=this._def.configureApp,e(this._def=n,!0)}):e(this._def)}_mount(e){this._app=this._createApp(e),this._inheritParentContext(),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const r=this._instance&&this._instance.exposed;if(r)for(const n in r)or(this,n)||Object.defineProperty(this,n,{get:()=>ee(r[n])})}_resolveProps(e){const{props:r}=e,n=dt(r)?r:Object.keys(r||{});for(const s of Object.keys(this))s[0]!=="_"&&n.includes(s)&&this._setProp(s,this[s]);for(const s of n.map(Tn))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(i){this._setProp(s,i,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const r=this.hasAttribute(e);let n=r?this.getAttribute(e):CE;const s=Tn(e);r&&this._numberProps&&this._numberProps[s]&&(n=R0(n)),this._setProp(s,n,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,r,n=!0,s=!1){if(r!==this._props[e]&&(r===CE?delete this._props[e]:(this._props[e]=r,e==="key"&&this._app&&(this._app._ceVNode.key=r)),s&&this._instance&&this._update(),n)){const i=this._ob;i&&i.disconnect(),r===!0?this.setAttribute(xs(e),""):typeof r=="string"||typeof r=="number"?this.setAttribute(xs(e),r+""):r||this.removeAttribute(xs(e)),i&&i.observe(this,{attributes:!0})}}_update(){const e=this._createVNode();this._app&&(e.appContext=this._app._context),TT(e,this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const r=nt(this._def,gr(e,this._props));return this._instance||(r.ce=n=>{this._instance=n,n.ce=this,n.isCE=!0;const s=(i,a)=>{this.dispatchEvent(new CustomEvent(i,Fh(a[0])?gr({detail:a},a[0]):{detail:a}))};n.emit=(i,...a)=>{s(i,a),xs(i)!==i&&s(xs(i),a)},this._setParent()}),r}_applyStyles(e,r){if(!e)return;if(r){if(r===this._def||this._styleChildren.has(r))return;this._styleChildren.add(r)}const n=this._nonce;for(let s=e.length-1;s>=0;s--){const i=document.createElement("style");n&&i.setAttribute("nonce",n),i.textContent=e[s],this.shadowRoot.prepend(i)}}_parseSlots(){const e=this._slots={};let r;for(;r=this.firstChild;){const n=r.nodeType===1&&r.getAttribute("slot")||"default";(e[n]||(e[n]=[])).push(r),this.removeChild(r)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),r=this._instance.type.__scopeId;for(let n=0;n<e.length;n++){const s=e[n],i=s.getAttribute("name")||"default",a=this._slots[i],o=s.parentNode;if(a)for(const l of a){if(r&&l.nodeType===1){const c=r+"-s",u=document.createTreeWalker(l,1);l.setAttribute(c,"");let f;for(;f=u.nextNode();)f.setAttribute(c,"")}o.insertBefore(l,s)}else for(;s.firstChild;)o.insertBefore(s.firstChild,s);o.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}function mT(t){const e=Ws(),r=e&&e.ce;return r||null}function AR(){const t=mT();return t&&t.shadowRoot}function TR(t="$style"){{const e=Ws();if(!e)return Yt;const r=e.type.__cssModules;if(!r)return Yt;const n=r[t];return n||Yt}}const gT=new WeakMap,vT=new WeakMap,W0=Symbol("_moveCb"),IE=Symbol("_enterCb"),wR=t=>(delete t.props.mode,t),CR=wR({name:"TransitionGroup",props:gr({},lT,{tag:String,moveClass:String}),setup(t,{slots:e}){const r=Ws(),n=i1();let s,i;return Kh(()=>{if(!s.length)return;const a=t.moveClass||`${t.name||"v"}-move`;if(!RR(s[0].el,r.vnode.el,a)){s=[];return}s.forEach(kR),s.forEach(DR);const o=s.filter(PR);Kg(),o.forEach(l=>{const c=l.el,u=c.style;Sa(c,a),u.transform=u.webkitTransform=u.transitionDuration="";const f=c[W0]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",f),c[W0]=null,Bi(c,a))};c.addEventListener("transitionend",f)}),s=[]}),()=>{const a=qt(t),o=cT(a);let l=a.tag||Re;if(s=[],i)for(let c=0;c<i.length;c++){const u=i[c];u.el&&u.el instanceof Element&&(s.push(u),vi(u,fc(u,o,n,r)),gT.set(u,u.el.getBoundingClientRect()))}i=e.default?Wh(e.default()):[];for(let c=0;c<i.length;c++){const u=i[c];u.key!=null&&vi(u,fc(u,o,n,r))}return nt(l,null,i)}}}),IR=CR;function kR(t){const e=t.el;e[W0]&&e[W0](),e[IE]&&e[IE]()}function DR(t){vT.set(t,t.el.getBoundingClientRect())}function PR(t){const e=gT.get(t),r=vT.get(t),n=e.left-r.left,s=e.top-r.top;if(n||s){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${n}px,${s}px)`,i.transitionDuration="0s",t}}function RR(t,e,r){const n=t.cloneNode(),s=t[pc];s&&s.forEach(o=>{o.split(/\s+/).forEach(l=>l&&n.classList.remove(l))}),r.split(/\s+/).forEach(o=>o&&n.classList.add(o)),n.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(n);const{hasTransform:a}=uT(n);return i.removeChild(n),a}const io=t=>{const e=t.props["onUpdate:modelValue"]||!1;return dt(e)?r=>Ql(e,r):e};function FR(t){t.target.composing=!0}function kE(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const $s=Symbol("_assign"),Ye={created(t,{modifiers:{lazy:e,trim:r,number:n}},s){t[$s]=io(s);const i=n||s.props&&s.props.type==="number";Za(t,e?"change":"input",a=>{if(a.target.composing)return;let o=t.value;r&&(o=o.trim()),i&&(o=P0(o)),t[$s](o)}),r&&Za(t,"change",()=>{t.value=t.value.trim()}),e||(Za(t,"compositionstart",FR),Za(t,"compositionend",kE),Za(t,"change",kE))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:n,trim:s,number:i}},a){if(t[$s]=io(a),t.composing)return;const o=(i||t.type==="number")&&!/^0\d/.test(t.value)?P0(t.value):t.value,l=e??"";o!==l&&(document.activeElement===t&&t.type!=="range"&&(n&&e===r||s&&t.value.trim()===l)||(t.value=l))}},_t={deep:!0,created(t,e,r){t[$s]=io(r),Za(t,"change",()=>{const n=t._modelValue,s=mc(t),i=t.checked,a=t[$s];if(dt(n)){const o=Mh(n,s),l=o!==-1;if(i&&!l)a(n.concat(s));else if(!i&&l){const c=[...n];c.splice(o,1),a(c)}}else if(il(n)){const o=new Set(n);i?o.add(s):o.delete(s),a(o)}else a(xT(t,i))})},mounted:DE,beforeUpdate(t,e,r){t[$s]=io(r),DE(t,e,r)}};function DE(t,{value:e,oldValue:r},n){t._modelValue=e;let s;if(dt(e))s=Mh(e,n.props.value)>-1;else if(il(e))s=e.has(n.props.value);else{if(e===r)return;s=ao(e,xT(t,!0))}t.checked!==s&&(t.checked=s)}const fa={created(t,{value:e},r){t.checked=ao(e,r.props.value),t[$s]=io(r),Za(t,"change",()=>{t[$s](mc(t))})},beforeUpdate(t,{value:e,oldValue:r},n){t[$s]=io(n),e!==r&&(t.checked=ao(e,n.props.value))}},ur={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const s=il(e);Za(t,"change",()=>{const i=Array.prototype.filter.call(t.options,a=>a.selected).map(a=>r?P0(mc(a)):mc(a));t[$s](t.multiple?s?new Set(i):i:i[0]),t._assigning=!0,ll(()=>{t._assigning=!1})}),t[$s]=io(n)},mounted(t,{value:e}){PE(t,e)},beforeUpdate(t,e,r){t[$s]=io(r)},updated(t,{value:e}){t._assigning||PE(t,e)}};function PE(t,e){const r=t.multiple,n=dt(e);if(!(r&&!n&&!il(e))){for(let s=0,i=t.options.length;s<i;s++){const a=t.options[s],o=mc(a);if(r)if(n){const l=typeof o;l==="string"||l==="number"?a.selected=e.some(c=>String(c)===String(o)):a.selected=Mh(e,o)>-1}else a.selected=e.has(o);else if(ao(mc(a),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function mc(t){return"_value"in t?t._value:t.value}function xT(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const yT={created(t,e,r){Ff(t,e,r,null,"created")},mounted(t,e,r){Ff(t,e,r,null,"mounted")},beforeUpdate(t,e,r,n){Ff(t,e,r,n,"beforeUpdate")},updated(t,e,r,n){Ff(t,e,r,n,"updated")}};function ET(t,e){switch(t){case"SELECT":return ur;case"TEXTAREA":return Ye;default:switch(e){case"checkbox":return _t;case"radio":return fa;default:return Ye}}}function Ff(t,e,r,n,s){const a=ET(t.tagName,r.props&&r.props.type)[s];a&&a(t,e,r,n)}function NR(){Ye.getSSRProps=({value:t})=>({value:t}),fa.getSSRProps=({value:t},e)=>{if(e.props&&ao(e.props.value,t))return{checked:!0}},_t.getSSRProps=({value:t},e)=>{if(dt(t)){if(e.props&&Mh(t,e.props.value)>-1)return{checked:!0}}else if(il(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},yT.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const r=ET(e.type.toUpperCase(),e.props&&e.props.type);if(r.getSSRProps)return r.getSSRProps(t,e)}}const OR=["ctrl","shift","alt","meta"],MR={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>OR.some(r=>t[`${r}Key`]&&!e.includes(r))},dn=(t,e)=>{const r=t._withMods||(t._withMods={}),n=e.join(".");return r[n]||(r[n]=(s,...i)=>{for(let a=0;a<e.length;a++){const o=MR[e[a]];if(o&&o(s,e))return}return t(s,...i)})},LR={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},_T=(t,e)=>{const r=t._withKeys||(t._withKeys={}),n=e.join(".");return r[n]||(r[n]=s=>{if(!("key"in s))return;const i=xs(s.key);if(e.some(a=>a===i||LR[a]===i))return t(s)})},bT=gr({patchProp:ER},rR);let Ou,RE=!1;function ST(){return Ou||(Ou=OA(bT))}function AT(){return Ou=RE?Ou:MA(bT),RE=!0,Ou}const TT=(...t)=>{ST().render(...t)},BR=(...t)=>{AT().hydrate(...t)},z0=(...t)=>{const e=ST().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=IT(n);if(!s)return;const i=e._component;!At(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=r(s,!1,CT(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},e},wT=(...t)=>{const e=AT().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=IT(n);if(s)return r(s,!0,CT(s))},e};function CT(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function IT(t){return _r(t)?document.querySelector(t):t}let FE=!1;const UR=()=>{FE||(FE=!0,NR(),lR())};/**
* vue v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const $R=()=>{},VR=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:uA,BaseTransitionPropsValidators:o1,Comment:zr,DeprecationTypes:ZP,EffectScope:Xv,ErrorCodes:f3,ErrorTypeStrings:zP,Fragment:Re,KeepAlive:B3,ReactiveEffect:ad,Static:$o,Suspense:IP,Teleport:E3,Text:to,TrackOpTypes:a3,Transition:sR,TransitionGroup:IR,TriggerOpTypes:i3,VueElement:Qh,assertNumber:d3,callWithAsyncErrorHandling:Hs,callWithErrorHandling:Rc,camelize:Tn,capitalize:Od,cloneVNode:Fa,compatUtils:JP,compile:$R,computed:Se,createApp:z0,createBlock:Kr,createCommentVNode:_e,createElementBlock:L,createElementVNode:d,createHydrationRenderer:MA,createPropsRestProxy:rP,createRenderer:OA,createSSRApp:wT,createSlots:H3,createStaticVNode:Fr,createTextVNode:Ne,createVNode:nt,customRef:X2,defineAsyncComponent:M3,defineComponent:Md,defineCustomElement:pT,defineEmits:z3,defineExpose:K3,defineModel:Y3,defineOptions:q3,defineProps:W3,defineSSRCustomElement:bR,defineSlots:X3,devtools:KP,effect:ID,effectScope:Yv,getCurrentInstance:Ws,getCurrentScope:Qv,getCurrentWatcher:o3,getTransitionRawChildren:Wh,guardReactiveProps:QA,h:Xo,handleError:ol,hasInjectionContext:wA,hydrate:BR,hydrateOnIdle:D3,hydrateOnInteraction:N3,hydrateOnMediaQuery:F3,hydrateOnVisible:R3,initCustomFormatter:jP,initDirectivesForSSR:UR,inject:Ds,isMemoSame:sT,isProxy:Vh,isReactive:Ia,isReadonly:gi,isRef:Tr,isRuntimeOnly:$P,isShallow:ks,isVNode:xi,markRaw:Hh,mergeDefaults:eP,mergeModels:tP,mergeProps:JA,nextTick:ll,normalizeClass:Qe,normalizeProps:SD,normalizeStyle:as,onActivated:fA,onBeforeMount:mA,onBeforeUnmount:qh,onBeforeUpdate:c1,onDeactivated:hA,onErrorCaptured:yA,onMounted:Ut,onRenderTracked:xA,onRenderTriggered:vA,onScopeDispose:R2,onServerPrefetch:gA,onUnmounted:Ba,onUpdated:Kh,onWatcherCleanup:J2,openBlock:N,popScopeId:v3,provide:Fu,proxyRefs:s1,pushScopeId:g3,queuePostFlushCb:ld,reactive:Rs,readonly:r1,ref:se,registerRuntimeCompiler:UP,render:TT,renderList:Ve,renderSlot:bA,resolveComponent:Ar,resolveDirective:V3,resolveDynamicComponent:_A,resolveFilter:QP,resolveTransitionHooks:fc,setBlockTracking:$g,setDevtoolsHook:qP,setTransitionHooks:vi,shallowReactive:t1,shallowReadonly:qD,shallowRef:n1,ssrContextKey:$A,ssrUtils:YP,stop:kD,toDisplayString:J,toHandlerKey:Iu,toHandlers:j3,toRaw:qt,toRef:r3,toRefs:Y2,toValue:QD,transformVNodeArgs:NP,triggerRef:YD,unref:ee,useAttrs:Z3,useCssModule:TR,useCssVars:cR,useHost:mT,useId:b3,useModel:_P,useSSRContext:VA,useShadowRoot:AR,useSlots:J3,useTemplateRef:S3,useTransitionState:i1,vModelCheckbox:_t,vModelDynamic:yT,vModelRadio:fa,vModelSelect:ur,vModelText:Ye,vShow:fT,version:aT,warn:WP,watch:Vt,watchEffect:xP,watchPostEffect:yP,watchSyncEffect:HA,withAsyncContext:nP,withCtx:Gh,withDefaults:Q3,withDirectives:we,withKeys:_T,withMemo:GP,withModifiers:dn,withScopeId:x3},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let kT;const Jh=t=>kT=t,DT=Symbol();function Xg(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Mu;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Mu||(Mu={}));function HR(){const t=Yv(!0),e=t.run(()=>se({}));let r=[],n=[];const s=Hh({install(i){Jh(s),s._a=i,i.provide(DT,s),i.config.globalProperties.$pinia=s,n.forEach(a=>r.push(a)),n=[]},use(i){return this._a?r.push(i):n.push(i),this},_p:r,_a:null,_e:t,_s:new Map,state:e});return s}const PT=()=>{};function NE(t,e,r,n=PT){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),n())};return!r&&Qv()&&R2(s),s}function kl(t,...e){t.slice().forEach(r=>{r(...e)})}const jR=t=>t(),OE=Symbol(),rm=Symbol();function Yg(t,e){t instanceof Map&&e instanceof Map?e.forEach((r,n)=>t.set(n,r)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const r in e){if(!e.hasOwnProperty(r))continue;const n=e[r],s=t[r];Xg(s)&&Xg(n)&&t.hasOwnProperty(r)&&!Tr(n)&&!Ia(n)?t[r]=Yg(s,n):t[r]=n}return t}const GR=Symbol();function WR(t){return!Xg(t)||!t.hasOwnProperty(GR)}const{assign:Ui}=Object;function zR(t){return!!(Tr(t)&&t.effect)}function KR(t,e,r,n){const{state:s,actions:i,getters:a}=e,o=r.state.value[t];let l;function c(){o||(r.state.value[t]=s?s():{});const u=Y2(r.state.value[t]);return Ui(u,i,Object.keys(a||{}).reduce((f,h)=>(f[h]=Hh(Se(()=>{Jh(r);const p=r._s.get(t);return a[h].call(p,p)})),f),{}))}return l=RT(t,c,e,r,n,!0),l}function RT(t,e,r={},n,s,i){let a;const o=Ui({actions:{}},r),l={deep:!0};let c,u,f=[],h=[],p;const m=n.state.value[t];!i&&!m&&(n.state.value[t]={}),se({});let v;function g(S){let _;c=u=!1,typeof S=="function"?(S(n.state.value[t]),_={type:Mu.patchFunction,storeId:t,events:p}):(Yg(n.state.value[t],S),_={type:Mu.patchObject,payload:S,storeId:t,events:p});const A=v=Symbol();ll().then(()=>{v===A&&(c=!0)}),u=!0,kl(f,_,n.state.value[t])}const y=i?function(){const{state:_}=r,A=_?_():{};this.$patch(C=>{Ui(C,A)})}:PT;function E(){a.stop(),f=[],h=[],n._s.delete(t)}const b=(S,_="")=>{if(OE in S)return S[rm]=_,S;const A=function(){Jh(n);const C=Array.from(arguments),T=[],D=[];function V(F){T.push(F)}function B(F){D.push(F)}kl(h,{args:C,name:A[rm],store:P,after:V,onError:B});let R;try{R=S.apply(this&&this.$id===t?this:P,C)}catch(F){throw kl(D,F),F}return R instanceof Promise?R.then(F=>(kl(T,F),F)).catch(F=>(kl(D,F),Promise.reject(F))):(kl(T,R),R)};return A[OE]=!0,A[rm]=_,A},k={_p:n,$id:t,$onAction:NE.bind(null,h),$patch:g,$reset:y,$subscribe(S,_={}){const A=NE(f,S,_.detached,()=>C()),C=a.run(()=>Vt(()=>n.state.value[t],T=>{(_.flush==="sync"?u:c)&&S({storeId:t,type:Mu.direct,events:p},T)},Ui({},l,_)));return A},$dispose:E},P=Rs(k);n._s.set(t,P);const x=(n._a&&n._a.runWithContext||jR)(()=>n._e.run(()=>(a=Yv()).run(()=>e({action:b}))));for(const S in x){const _=x[S];if(Tr(_)&&!zR(_)||Ia(_))i||(m&&WR(_)&&(Tr(_)?_.value=m[S]:Yg(_,m[S])),n.state.value[t][S]=_);else if(typeof _=="function"){const A=b(_,S);x[S]=A,o.actions[S]=_}}return Ui(P,x),Ui(qt(P),x),Object.defineProperty(P,"$state",{get:()=>n.state.value[t],set:S=>{g(_=>{Ui(_,S)})}}),n._p.forEach(S=>{Ui(P,a.run(()=>S({store:P,app:n._a,pinia:n,options:o})))}),m&&i&&r.hydrate&&r.hydrate(P.$state,m),c=!0,u=!0,P}/*! #__NO_SIDE_EFFECTS__ */function FT(t,e,r){let n,s;const i=typeof e=="function";typeof t=="string"?(n=t,s=i?r:e):(s=t,n=t.id);function a(o,l){const c=wA();return o=o||(c?Ds(DT,null):null),o&&Jh(o),o=kT,o._s.has(n)||(i?RT(n,e,s,o):KR(n,s,o)),o._s.get(n)}return a.$id=n,a}var ME={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},qR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},OT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,f=(i&3)<<4|o>>4;let h=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(h=64)),n.push(r[u],r[f],r[h],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(NT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):qR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const f=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||f==null)throw new XR;const h=i<<2|o>>4;if(n.push(h),c!==64){const p=o<<4&240|c>>2;if(n.push(p),f!==64){const m=c<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const YR=function(t){const e=NT(t);return OT.encodeByteArray(e,!0)},K0=function(t){return YR(t).replace(/\./g,"")},MT=function(t){try{return OT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=()=>QR().__FIREBASE_DEFAULTS__,ZR=()=>{if(typeof process>"u"||typeof ME>"u")return;const t=ME.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},e8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&MT(t[1]);return e&&JSON.parse(e)},Zh=()=>{try{return JR()||ZR()||e8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},LT=t=>{var e,r;return(r=(e=Zh())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},x1=t=>{const e=LT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},BT=()=>{var t;return(t=Zh())===null||t===void 0?void 0:t.config},UT=t=>{var e;return(e=Zh())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[K0(JSON.stringify(r)),K0(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function r8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yn())}function n8(){var t;const e=(t=Zh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function s8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function a8(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function i8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function o8(){const t=Yn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function l8(){return!n8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function c8(){try{return typeof indexedDB=="object"}catch{return!1}}function u8(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d8="FirebaseError";class ga extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=d8,Object.setPrototypeOf(this,ga.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$d.prototype.create)}}class $d{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?f8(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new ga(s,o,n)}}function f8(t,e){return t.replace(h8,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const h8=/\{\$([^}]+)}/g;function p8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function q0(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(LE(i)&&LE(a)){if(!q0(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function LE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function m8(t,e){const r=new g8(t,e);return r.subscribe.bind(r)}class g8{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");v8(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=nm),s.error===void 0&&(s.error=nm),s.complete===void 0&&(s.complete=nm);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function v8(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function nm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(t){return t&&t._delegate?t._delegate:t}class yi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x8{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new t8;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(E8(e))try{this.getOrInitializeService({instanceIdentifier:Po})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Po){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Po){return this.instances.has(e)}getOptions(e=Po){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:y8(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Po){return this.component?this.component.multipleInstances?e:Po:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function y8(t){return t===Po?void 0:t}function E8(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new x8(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Xt||(Xt={}));const b8={debug:Xt.DEBUG,verbose:Xt.VERBOSE,info:Xt.INFO,warn:Xt.WARN,error:Xt.ERROR,silent:Xt.SILENT},S8=Xt.INFO,A8={[Xt.DEBUG]:"log",[Xt.VERBOSE]:"log",[Xt.INFO]:"info",[Xt.WARN]:"warn",[Xt.ERROR]:"error"},T8=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=A8[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class y1{constructor(e){this.name=e,this._logLevel=S8,this._logHandler=T8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?b8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xt.DEBUG,...e),this._logHandler(this,Xt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xt.VERBOSE,...e),this._logHandler(this,Xt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xt.INFO,...e),this._logHandler(this,Xt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xt.WARN,...e),this._logHandler(this,Xt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xt.ERROR,...e),this._logHandler(this,Xt.ERROR,...e)}}const w8=(t,e)=>e.some(r=>t instanceof r);let BE,UE;function C8(){return BE||(BE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function I8(){return UE||(UE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VT=new WeakMap,Qg=new WeakMap,HT=new WeakMap,sm=new WeakMap,E1=new WeakMap;function k8(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(ro(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&VT.set(r,t)}).catch(()=>{}),E1.set(e,t),e}function D8(t){if(Qg.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Qg.set(t,e)}let Jg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Qg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||HT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ro(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function P8(t){Jg=t(Jg)}function R8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(am(this),e,...r);return HT.set(n,e.sort?e.sort():[e]),ro(n)}:I8().includes(t)?function(...e){return t.apply(am(this),e),ro(VT.get(this))}:function(...e){return ro(t.apply(am(this),e))}}function F8(t){return typeof t=="function"?R8(t):(t instanceof IDBTransaction&&D8(t),w8(t,C8())?new Proxy(t,Jg):t)}function ro(t){if(t instanceof IDBRequest)return k8(t);if(sm.has(t))return sm.get(t);const e=F8(t);return e!==t&&(sm.set(t,e),E1.set(e,t)),e}const am=t=>E1.get(t);function N8(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=ro(a);return n&&a.addEventListener("upgradeneeded",l=>{n(ro(a.result),l.oldVersion,l.newVersion,ro(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const O8=["get","getKey","getAll","getAllKeys","count"],M8=["put","add","delete","clear"],im=new Map;function $E(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(im.get(e))return im.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=M8.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||O8.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return im.set(e,i),i}P8(t=>({...t,get:(e,r,n)=>$E(e,r)||t.get(e,r,n),has:(e,r)=>!!$E(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(B8(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function B8(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zg="@firebase/app",VE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=new y1("@firebase/app"),U8="@firebase/app-compat",$8="@firebase/analytics-compat",V8="@firebase/analytics",H8="@firebase/app-check-compat",j8="@firebase/app-check",G8="@firebase/auth",W8="@firebase/auth-compat",z8="@firebase/database",K8="@firebase/data-connect",q8="@firebase/database-compat",X8="@firebase/functions",Y8="@firebase/functions-compat",Q8="@firebase/installations",J8="@firebase/installations-compat",Z8="@firebase/messaging",eF="@firebase/messaging-compat",tF="@firebase/performance",rF="@firebase/performance-compat",nF="@firebase/remote-config",sF="@firebase/remote-config-compat",aF="@firebase/storage",iF="@firebase/storage-compat",oF="@firebase/firestore",lF="@firebase/vertexai-preview",cF="@firebase/firestore-compat",uF="firebase",dF="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev="[DEFAULT]",fF={[Zg]:"fire-core",[U8]:"fire-core-compat",[V8]:"fire-analytics",[$8]:"fire-analytics-compat",[j8]:"fire-app-check",[H8]:"fire-app-check-compat",[G8]:"fire-auth",[W8]:"fire-auth-compat",[z8]:"fire-rtdb",[K8]:"fire-data-connect",[q8]:"fire-rtdb-compat",[X8]:"fire-fn",[Y8]:"fire-fn-compat",[Q8]:"fire-iid",[J8]:"fire-iid-compat",[Z8]:"fire-fcm",[eF]:"fire-fcm-compat",[tF]:"fire-perf",[rF]:"fire-perf-compat",[nF]:"fire-rc",[sF]:"fire-rc-compat",[aF]:"fire-gcs",[iF]:"fire-gcs-compat",[oF]:"fire-fst",[cF]:"fire-fst-compat",[lF]:"fire-vertex","fire-js":"fire-js",[uF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0=new Map,hF=new Map,tv=new Map;function HE(t,e){try{t.container.addComponent(e)}catch(r){Ei.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function oo(t){const e=t.name;if(tv.has(e))return Ei.debug(`There were multiple attempts to register component ${e}.`),!1;tv.set(e,t);for(const r of X0.values())HE(r,t);for(const r of hF.values())HE(r,t);return!0}function Hd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function si(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new $d("app","Firebase",pF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new yi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=dF;function jT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ev,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw no.create("bad-app-name",{appName:String(s)});if(r||(r=BT()),!r)throw no.create("no-options");const i=X0.get(s);if(i){if(q0(r,i.options)&&q0(n,i.config))return i;throw no.create("duplicate-app",{appName:s})}const a=new _8(s);for(const l of tv.values())a.addComponent(l);const o=new mF(r,n,a);return X0.set(s,o),o}function jd(t=ev){const e=X0.get(t);if(!e&&t===ev&&BT())return jT();if(!e)throw no.create("no-app",{appName:t});return e}function Vs(t,e,r){var n;let s=(n=fF[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ei.warn(o.join(" "));return}oo(new yi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF="firebase-heartbeat-database",vF=1,hd="firebase-heartbeat-store";let om=null;function GT(){return om||(om=N8(gF,vF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(hd)}catch(r){console.warn(r)}}}}).catch(t=>{throw no.create("idb-open",{originalErrorMessage:t.message})})),om}async function xF(t){try{const r=(await GT()).transaction(hd),n=await r.objectStore(hd).get(WT(t));return await r.done,n}catch(e){if(e instanceof ga)Ei.warn(e.message);else{const r=no.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ei.warn(r.message)}}}async function jE(t,e){try{const n=(await GT()).transaction(hd,"readwrite");await n.objectStore(hd).put(e,WT(t)),await n.done}catch(r){if(r instanceof ga)Ei.warn(r.message);else{const n=no.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ei.warn(n.message)}}}function WT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=1024,EF=30*24*60*60*1e3;class _F{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new SF(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=GE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=EF}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Ei.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=GE(),{heartbeatsToSend:n,unsentEntries:s}=bF(this._heartbeatsCache.heartbeats),i=K0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Ei.warn(r),""}}}function GE(){return new Date().toISOString().substring(0,10)}function bF(t,e=yF){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),WE(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),WE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class SF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return c8()?u8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await xF(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return jE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return jE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function WE(t){return K0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AF(t){oo(new yi("platform-logger",e=>new L8(e),"PRIVATE")),oo(new yi("heartbeat",e=>new _F(e),"PRIVATE")),Vs(Zg,VE,t),Vs(Zg,VE,"esm2017"),Vs("fire-js","")}AF("");function _1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function zT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const KT=zT,qT=new $d("auth","Firebase",zT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=new y1("@firebase/auth");function TF(t,...e){Y0.logLevel<=Xt.WARN&&Y0.warn(`Auth (${cl}): ${t}`,...e)}function p0(t,...e){Y0.logLevel<=Xt.ERROR&&Y0.error(`Auth (${cl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(t,...e){throw S1(t,...e)}function ca(t,...e){return S1(t,...e)}function b1(t,e,r){const n=Object.assign(Object.assign({},KT()),{[e]:r});return new $d("auth","Firebase",n).create(e,{appName:t.name})}function Vo(t){return b1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wF(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Na(t,"argument-error"),b1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function S1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return qT.create(t,...e)}function It(t,e,...r){if(!t)throw S1(e,...r)}function ai(t){const e="INTERNAL ASSERTION FAILED: "+t;throw p0(e),new Error(e)}function _i(t,e){t||ai(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function CF(){return zE()==="http:"||zE()==="https:"}function zE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CF()||a8()||"connection"in navigator)?navigator.onLine:!0}function kF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,r){this.shortDelay=e,this.longDelay=r,_i(r>e,"Short delay should be less than long delay!"),this.isMobile=r8()||i8()}get(){return IF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(t,e){_i(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ai("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ai("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ai("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF=new Gd(3e4,6e4);function T1(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Fc(t,e,r,n,s={}){return YT(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=Vd(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return s8()||(c.referrerPolicy="no-referrer"),XT.fetch()(QT(t,t.config.apiHost,r,o),c)})}async function YT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},DF),e);try{const s=new FF(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Nf(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nf(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Nf(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Nf(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw b1(t,u,c);Na(t,u)}}catch(s){if(s instanceof ga)throw s;Na(t,"network-request-failed",{message:String(s)})}}async function RF(t,e,r,n,s={}){const i=await Fc(t,e,r,n,s);return"mfaPendingCredential"in i&&Na(t,"multi-factor-auth-required",{_serverResponse:i}),i}function QT(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?A1(t.config,s):`${t.config.apiScheme}://${s}`}class FF{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ca(this.auth,"network-request-failed")),PF.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Nf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ca(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NF(t,e){return Fc(t,"POST","/v1/accounts:delete",e)}async function JT(t,e){return Fc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t,e=!1){return lr(t).getIdToken(e)}async function ew(t,e=!1){const r=lr(t),n=await r.getIdToken(e),s=w1(n);It(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Lu(lm(s.auth_time)),issuedAtTime:Lu(lm(s.iat)),expirationTime:Lu(lm(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function lm(t){return Number(t)*1e3}function w1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return p0("JWT malformed, contained fewer than 3 sections"),null;try{const s=MT(r);return s?JSON.parse(s):(p0("Failed to decode base64 JWT payload"),null)}catch(s){return p0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function KE(t){const e=w1(t);return It(e,"internal-error"),It(typeof e.exp<"u","internal-error"),It(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pd(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof ga&&OF(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function OF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lu(this.lastLoginAt),this.creationTime=Lu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q0(t){var e;const r=t.auth,n=await t.getIdToken(),s=await pd(t,JT(r,{idToken:n}));It(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?rw(i.providerUserInfo):[],o=LF(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new nv(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function tw(t){const e=lr(t);await Q0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function LF(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function rw(t){return t.map(e=>{var{providerId:r}=e,n=_1(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BF(t,e){const r=await YT(t,{},async()=>{const n=Vd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=QT(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",XT.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function UF(t,e){return Fc(t,"POST","/v2/accounts:revokeToken",T1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){It(e.idToken,"internal-error"),It(typeof e.idToken<"u","internal-error"),It(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):KE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){It(e.length!==0,"internal-error");const r=KE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(It(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await BF(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new tc;return n&&(It(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(It(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(It(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tc,this.toJSON())}_performRefresh(){return ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ni(t,e){It(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ii{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=_1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new MF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new nv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await pd(this,this.stsTokenManager.getToken(this.auth,e));return It(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return ew(this,e)}reload(){return tw(this)}_assign(e){this!==e&&(It(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ii(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){It(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Q0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(si(this.auth.app))return Promise.reject(Vo(this.auth));const e=await this.getIdToken();return await pd(this,NF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(s=r.email)!==null&&s!==void 0?s:void 0,p=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,m=(a=r.photoURL)!==null&&a!==void 0?a:void 0,v=(o=r.tenantId)!==null&&o!==void 0?o:void 0,g=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=r.createdAt)!==null&&c!==void 0?c:void 0,E=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:k,isAnonymous:P,providerData:w,stsTokenManager:x}=r;It(b&&x,e,"internal-error");const S=tc.fromJSON(this.name,x);It(typeof b=="string",e,"internal-error"),Ni(f,e.name),Ni(h,e.name),It(typeof k=="boolean",e,"internal-error"),It(typeof P=="boolean",e,"internal-error"),Ni(p,e.name),Ni(m,e.name),Ni(v,e.name),Ni(g,e.name),Ni(y,e.name),Ni(E,e.name);const _=new ii({uid:b,auth:e,email:h,emailVerified:k,displayName:f,isAnonymous:P,photoURL:m,phoneNumber:p,tenantId:v,stsTokenManager:S,createdAt:y,lastLoginAt:E});return w&&Array.isArray(w)&&(_.providerData=w.map(A=>Object.assign({},A))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(e,r,n=!1){const s=new tc;s.updateFromServerResponse(r);const i=new ii({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Q0(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];It(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?rw(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new tc;o.updateFromIdToken(n);const l=new ii({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new nv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE=new Map;function oi(t){_i(t instanceof Function,"Expected a class definition");let e=qE.get(t);return e?(_i(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,qE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}nw.type="NONE";const sv=nw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(t,e,r){return`firebase:${t}:${e}:${r}`}class rc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=m0(this.userKey,s.apiKey,i),this.fullPersistenceKey=m0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ii._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new rc(oi(sv),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||oi(sv);const a=m0(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=ii._fromJSON(e,u);c!==i&&(o=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new rc(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new rc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ow(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cw(e))return"Blackberry";if(uw(e))return"Webos";if(aw(e))return"Safari";if((e.includes("chrome/")||iw(e))&&!e.includes("edge/"))return"Chrome";if(lw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function sw(t=Yn()){return/firefox\//i.test(t)}function aw(t=Yn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iw(t=Yn()){return/crios\//i.test(t)}function ow(t=Yn()){return/iemobile/i.test(t)}function lw(t=Yn()){return/android/i.test(t)}function cw(t=Yn()){return/blackberry/i.test(t)}function uw(t=Yn()){return/webos/i.test(t)}function C1(t=Yn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function $F(t=Yn()){var e;return C1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function VF(){return o8()&&document.documentMode===10}function dw(t=Yn()){return C1(t)||lw(t)||uw(t)||cw(t)||/windows phone/i.test(t)||ow(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t,e=[]){let r;switch(t){case"Browser":r=XE(Yn());break;case"Worker":r=`${XE(Yn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${cl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jF(t,e={}){return Fc(t,"GET","/v2/passwordPolicy",T1(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF=6;class WF{constructor(e){var r,n,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:GF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new YE(this),this.idTokenSubscription=new YE(this),this.beforeStateQueue=new HF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=oi(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await rc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await JT(this,{idToken:e}),n=await ii._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(si(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return It(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Q0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(si(this.app))return Promise.reject(Vo(this));const r=e?lr(e):null;return r&&It(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&It(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return si(this.app)?Promise.reject(Vo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return si(this.app)?Promise.reject(Vo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(oi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jF(this),r=new WF(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new $d("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await UF(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&oi(e)||this._popupRedirectResolver;It(r,this,"argument-error"),this.redirectPersistenceManager=await rc.create(this,[oi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(It(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return It(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&TF(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ep(t){return lr(t)}class YE{constructor(e){this.auth=e,this.observer=null,this.addObserver=m8(r=>this.observer=r)}get next(){return It(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function KF(t){I1=t}function qF(t){return I1.loadJS(t)}function XF(){return I1.gapiScript}function YF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(t,e){const r=Hd(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(q0(i,e??{}))return s;Na(s,"already-initialized")}return r.initialize({options:e})}function QF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(oi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function pw(t,e,r){const n=ep(t);It(n._canInitEmulator,n,"emulator-config-failed"),It(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=mw(e),{host:a,port:o}=JF(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${i}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),ZF()}function mw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function JF(t){const e=mw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:QE(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:QE(a)}}}function QE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ZF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ai("not implemented")}_getIdTokenResponse(e){return ai("not implemented")}_linkToIdToken(e,r){return ai("not implemented")}_getReauthenticationResolver(e){return ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nc(t,e){return RF(t,"POST","/v1/accounts:signInWithIdp",T1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e6="http://localhost";class lo extends k1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new lo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Na("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=_1(r,["providerId","signInMethod"]);if(!n||!s)return null;const a=new lo(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return nc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,nc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,nc(e,r)}buildRequest(){const e={requestUri:e6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Vd(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd extends D1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei extends Wd{constructor(){super("facebook.com")}static credential(e){return lo._fromParams({providerId:ei.PROVIDER_ID,signInMethod:ei.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ei.credentialFromTaggedObject(e)}static credentialFromError(e){return ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ei.credential(e.oauthAccessToken)}catch{return null}}}ei.FACEBOOK_SIGN_IN_METHOD="facebook.com";ei.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na extends Wd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return lo._fromParams({providerId:na.PROVIDER_ID,signInMethod:na.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return na.credentialFromTaggedObject(e)}static credentialFromError(e){return na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return na.credential(r,n)}catch{return null}}}na.GOOGLE_SIGN_IN_METHOD="google.com";na.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti extends Wd{constructor(){super("github.com")}static credential(e){return lo._fromParams({providerId:ti.PROVIDER_ID,signInMethod:ti.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ti.credentialFromTaggedObject(e)}static credentialFromError(e){return ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ti.credential(e.oauthAccessToken)}catch{return null}}}ti.GITHUB_SIGN_IN_METHOD="github.com";ti.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri extends Wd{constructor(){super("twitter.com")}static credential(e,r){return lo._fromParams({providerId:ri.PROVIDER_ID,signInMethod:ri.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ri.credentialFromTaggedObject(e)}static credentialFromError(e){return ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ri.credential(r,n)}catch{return null}}}ri.TWITTER_SIGN_IN_METHOD="twitter.com";ri.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await ii._fromIdTokenResponse(e,n,s),a=JE(n);return new gc({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=JE(n);return new gc({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function JE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0 extends ga{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,J0.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new J0(e,r,n,s)}}function gw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?J0._fromErrorAndOperation(t,i,e,n):i})}async function t6(t,e,r=!1){const n=await pd(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return gc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r6(t,e,r=!1){const{auth:n}=t;if(si(n.app))return Promise.reject(Vo(n));const s="reauthenticate";try{const i=await pd(t,gw(n,s,e,t),r);It(i.idToken,n,"internal-error");const a=w1(i.idToken);It(a,n,"internal-error");const{sub:o}=a;return It(t.uid===o,n,"user-mismatch"),gc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Na(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n6(t,e,r=!1){if(si(t.app))return Promise.reject(Vo(t));const n="signIn",s=await gw(t,n,e),i=await gc._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function vw(t,e,r,n){return lr(t).onIdTokenChanged(e,r,n)}function xw(t,e,r){return lr(t).beforeAuthStateChanged(e,r)}function tp(t,e,r,n){return lr(t).onAuthStateChanged(e,r,n)}function rp(t){return lr(t).signOut()}const Z0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Z0,"1"),this.storage.removeItem(Z0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=1e3,a6=10;class Ew extends yw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);VF()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,a6):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},s6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ew.type="LOCAL";const _w=Ew;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw extends yw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}bw.type="SESSION";const P1=bw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new np(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await i6(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}np.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=R1("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(h.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ka(){return window}function l6(t){ka().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(){return typeof ka().WorkerGlobalScope<"u"&&typeof ka().importScripts=="function"}async function c6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function u6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function d6(){return Sw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="firebaseLocalStorageDb",f6=1,eh="firebaseLocalStorage",Tw="fbase_key";class zd{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function sp(t,e){return t.transaction([eh],e?"readwrite":"readonly").objectStore(eh)}function h6(){const t=indexedDB.deleteDatabase(Aw);return new zd(t).toPromise()}function av(){const t=indexedDB.open(Aw,f6);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(eh,{keyPath:Tw})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(eh)?e(n):(n.close(),await h6(),e(await av()))})})}async function ZE(t,e,r){const n=sp(t,!0).put({[Tw]:e,value:r});return new zd(n).toPromise()}async function p6(t,e){const r=sp(t,!1).get(e),n=await new zd(r).toPromise();return n===void 0?null:n.value}function e_(t,e){const r=sp(t,!0).delete(e);return new zd(r).toPromise()}const m6=800,g6=3;class ww{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await av(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>g6)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Sw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=np._getInstance(d6()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await c6(),!this.activeServiceWorker)return;this.sender=new o6(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||u6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await av();return await ZE(e,Z0,"1"),await e_(e,Z0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>ZE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>p6(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>e_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=sp(s,!1).getAll();return new zd(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),m6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ww.type="LOCAL";const Cw=ww;new Gd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t,e){return e?oi(e):(It(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1 extends k1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return nc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return nc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return nc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function v6(t){return n6(t.auth,new F1(t),t.bypassAuthState)}function x6(t){const{auth:e,user:r}=t;return It(r,e,"internal-error"),r6(r,new F1(t),t.bypassAuthState)}async function y6(t){const{auth:e,user:r}=t;return It(r,e,"internal-error"),t6(r,new F1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return v6;case"linkViaPopup":case"linkViaRedirect":return y6;case"reauthViaPopup":case"reauthViaRedirect":return x6;default:Na(this.auth,"internal-error")}}resolve(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=new Gd(2e3,1e4);async function N1(t,e,r){if(si(t.app))return Promise.reject(ca(t,"operation-not-supported-in-this-environment"));const n=ep(t);wF(t,e,D1);const s=Iw(n,r);return new No(n,"signInViaPopup",e,s).executeNotNull()}class No extends kw{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,No.currentPopupAction&&No.currentPopupAction.cancel(),No.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return It(e,this.auth,"internal-error"),e}async onExecution(){_i(this.filter.length===1,"Popup operations only handle one event");const e=R1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ca(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ca(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,No.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ca(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,E6.get())};e()}}No.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6="pendingRedirect",g0=new Map;class b6 extends kw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=g0.get(this.auth._key());if(!e){try{const n=await S6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}g0.set(this.auth._key(),e)}return this.bypassAuthState||g0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function S6(t,e){const r=w6(e),n=T6(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function A6(t,e){g0.set(t._key(),e)}function T6(t){return oi(t._redirectPersistence)}function w6(t){return m0(_6,t.config.apiKey,t.name)}async function C6(t,e,r=!1){if(si(t.app))return Promise.reject(Vo(t));const n=ep(t),s=Iw(n,e),a=await new b6(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I6=10*60*1e3;class k6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!D6(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!Dw(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ca(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=I6&&this.cachedEventUids.clear(),this.cachedEventUids.has(t_(e))}saveEventToCache(e){this.cachedEventUids.add(t_(e)),this.lastProcessedEventTime=Date.now()}}function t_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Dw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function D6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Dw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P6(t,e={}){return Fc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,F6=/^https?/;async function N6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await P6(t);for(const r of e)try{if(O6(r))return}catch{}Na(t,"unauthorized-domain")}function O6(t){const e=rv(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!F6.test(r))return!1;if(R6.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M6=new Gd(3e4,6e4);function r_(){const t=ka().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function L6(t){return new Promise((e,r)=>{var n,s,i;function a(){r_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{r_(),r(ca(t,"network-request-failed"))},timeout:M6.get()})}if(!((s=(n=ka().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ka().gapi)===null||i===void 0)&&i.load)a();else{const o=YF("iframefcb");return ka()[o]=()=>{gapi.load?a():r(ca(t,"network-request-failed"))},qF(`${XF()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw v0=null,e})}let v0=null;function B6(t){return v0=v0||L6(t),v0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=new Gd(5e3,15e3),$6="__/auth/iframe",V6="emulator/auth/iframe",H6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},j6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function G6(t){const e=t.config;It(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?A1(e,V6):`https://${t.config.authDomain}/${$6}`,n={apiKey:e.apiKey,appName:t.name,v:cl},s=j6.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Vd(n).slice(1)}`}async function W6(t){const e=await B6(t),r=ka().gapi;return It(r,t,"internal-error"),e.open({where:document.body,url:G6(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:H6,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=ca(t,"network-request-failed"),o=ka().setTimeout(()=>{i(a)},U6.get());function l(){ka().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},K6=500,q6=600,X6="_blank",Y6="http://localhost";class n_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Q6(t,e,r,n=K6,s=q6){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},z6),{width:n.toString(),height:s.toString(),top:i,left:a}),c=Yn().toLowerCase();r&&(o=iw(c)?X6:r),sw(c)&&(e=e||Y6,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[p,m])=>`${h}${p}=${m},`,"");if($F(c)&&o!=="_self")return J6(e||"",o),new n_(null);const f=window.open(e||"",o,u);It(f,t,"popup-blocked");try{f.focus()}catch{}return new n_(f)}function J6(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z6="__/auth/handler",e5="emulator/auth/handler",t5=encodeURIComponent("fac");async function s_(t,e,r,n,s,i){It(t.config.authDomain,t,"auth-domain-config-required"),It(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:cl,eventId:s};if(e instanceof D1){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",p8(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries({}))a[u]=f}if(e instanceof Wd){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${t5}=${encodeURIComponent(l)}`:"";return`${r5(t)}?${Vd(o).slice(1)}${c}`}function r5({config:t}){return t.emulator?A1(t,e5):`https://${t.authDomain}/${Z6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="webStorageSupport";class n5{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=P1,this._completeRedirectFn=C6,this._overrideRedirectResult=A6}async _openPopup(e,r,n,s){var i;_i((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await s_(e,r,n,rv(),s);return Q6(e,a,R1())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await s_(e,r,n,rv(),s);return l6(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(_i(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await W6(e),n=new k6(e);return r.register("authEvent",s=>(It(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(cm,{type:cm},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[cm];a!==void 0&&r(!!a),Na(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=N6(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return dw()||aw()||C1()}}const Pw=n5;var a_="@firebase/auth",i_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){It(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a5(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function i5(t){oo(new yi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;It(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fw(t)},c=new zF(n,s,i,l);return QF(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),oo(new yi("auth-internal",e=>{const r=ep(e.getProvider("auth").getImmediate());return(n=>new s5(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vs(a_,i_,a5(t)),Vs(a_,i_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5=5*60,l5=UT("authIdTokenMaxAge")||o5;let o_=null;const c5=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>l5)return;const s=r==null?void 0:r.token;o_!==s&&(o_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Yo(t=jd()){const e=Hd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=hw(t,{popupRedirectResolver:Pw,persistence:[Cw,_w,P1]}),n=UT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=c5(i.toString());xw(r,a,()=>a(r.currentUser)),vw(r,o=>a(o))}}const s=LT("auth");return s&&pw(r,`http://${s}`),r}function u5(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}KF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=ca("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",u5().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});i5("Browser");const d5=Object.freeze(Object.defineProperty({__proto__:null,AuthCredential:k1,FacebookAuthProvider:ei,GithubAuthProvider:ti,GoogleAuthProvider:na,OAuthCredential:lo,TwitterAuthProvider:ri,beforeAuthStateChanged:xw,browserLocalPersistence:_w,browserPopupRedirectResolver:Pw,browserSessionPersistence:P1,connectAuthEmulator:pw,getAuth:Yo,getIdToken:ZT,getIdTokenResult:ew,inMemoryPersistence:sv,indexedDBLocalPersistence:Cw,initializeAuth:hw,onAuthStateChanged:tp,onIdTokenChanged:vw,prodErrorMap:KT,reload:tw,signInWithPopup:N1,signOut:rp},Symbol.toStringTag,{value:"Module"}));var l_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ho,Rw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,S){function _(){}_.prototype=S.prototype,x.D=S.prototype,x.prototype=new _,x.prototype.constructor=x,x.C=function(A,C,T){for(var D=Array(arguments.length-2),V=2;V<arguments.length;V++)D[V-2]=arguments[V];return S.prototype[C].apply(A,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,S,_){_||(_=0);var A=Array(16);if(typeof S=="string")for(var C=0;16>C;++C)A[C]=S.charCodeAt(_++)|S.charCodeAt(_++)<<8|S.charCodeAt(_++)<<16|S.charCodeAt(_++)<<24;else for(C=0;16>C;++C)A[C]=S[_++]|S[_++]<<8|S[_++]<<16|S[_++]<<24;S=x.g[0],_=x.g[1],C=x.g[2];var T=x.g[3],D=S+(T^_&(C^T))+A[0]+3614090360&4294967295;S=_+(D<<7&4294967295|D>>>25),D=T+(C^S&(_^C))+A[1]+3905402710&4294967295,T=S+(D<<12&4294967295|D>>>20),D=C+(_^T&(S^_))+A[2]+606105819&4294967295,C=T+(D<<17&4294967295|D>>>15),D=_+(S^C&(T^S))+A[3]+3250441966&4294967295,_=C+(D<<22&4294967295|D>>>10),D=S+(T^_&(C^T))+A[4]+4118548399&4294967295,S=_+(D<<7&4294967295|D>>>25),D=T+(C^S&(_^C))+A[5]+1200080426&4294967295,T=S+(D<<12&4294967295|D>>>20),D=C+(_^T&(S^_))+A[6]+2821735955&4294967295,C=T+(D<<17&4294967295|D>>>15),D=_+(S^C&(T^S))+A[7]+4249261313&4294967295,_=C+(D<<22&4294967295|D>>>10),D=S+(T^_&(C^T))+A[8]+1770035416&4294967295,S=_+(D<<7&4294967295|D>>>25),D=T+(C^S&(_^C))+A[9]+2336552879&4294967295,T=S+(D<<12&4294967295|D>>>20),D=C+(_^T&(S^_))+A[10]+4294925233&4294967295,C=T+(D<<17&4294967295|D>>>15),D=_+(S^C&(T^S))+A[11]+2304563134&4294967295,_=C+(D<<22&4294967295|D>>>10),D=S+(T^_&(C^T))+A[12]+1804603682&4294967295,S=_+(D<<7&4294967295|D>>>25),D=T+(C^S&(_^C))+A[13]+4254626195&4294967295,T=S+(D<<12&4294967295|D>>>20),D=C+(_^T&(S^_))+A[14]+2792965006&4294967295,C=T+(D<<17&4294967295|D>>>15),D=_+(S^C&(T^S))+A[15]+1236535329&4294967295,_=C+(D<<22&4294967295|D>>>10),D=S+(C^T&(_^C))+A[1]+4129170786&4294967295,S=_+(D<<5&4294967295|D>>>27),D=T+(_^C&(S^_))+A[6]+3225465664&4294967295,T=S+(D<<9&4294967295|D>>>23),D=C+(S^_&(T^S))+A[11]+643717713&4294967295,C=T+(D<<14&4294967295|D>>>18),D=_+(T^S&(C^T))+A[0]+3921069994&4294967295,_=C+(D<<20&4294967295|D>>>12),D=S+(C^T&(_^C))+A[5]+3593408605&4294967295,S=_+(D<<5&4294967295|D>>>27),D=T+(_^C&(S^_))+A[10]+38016083&4294967295,T=S+(D<<9&4294967295|D>>>23),D=C+(S^_&(T^S))+A[15]+3634488961&4294967295,C=T+(D<<14&4294967295|D>>>18),D=_+(T^S&(C^T))+A[4]+3889429448&4294967295,_=C+(D<<20&4294967295|D>>>12),D=S+(C^T&(_^C))+A[9]+568446438&4294967295,S=_+(D<<5&4294967295|D>>>27),D=T+(_^C&(S^_))+A[14]+3275163606&4294967295,T=S+(D<<9&4294967295|D>>>23),D=C+(S^_&(T^S))+A[3]+4107603335&4294967295,C=T+(D<<14&4294967295|D>>>18),D=_+(T^S&(C^T))+A[8]+1163531501&4294967295,_=C+(D<<20&4294967295|D>>>12),D=S+(C^T&(_^C))+A[13]+2850285829&4294967295,S=_+(D<<5&4294967295|D>>>27),D=T+(_^C&(S^_))+A[2]+4243563512&4294967295,T=S+(D<<9&4294967295|D>>>23),D=C+(S^_&(T^S))+A[7]+1735328473&4294967295,C=T+(D<<14&4294967295|D>>>18),D=_+(T^S&(C^T))+A[12]+2368359562&4294967295,_=C+(D<<20&4294967295|D>>>12),D=S+(_^C^T)+A[5]+4294588738&4294967295,S=_+(D<<4&4294967295|D>>>28),D=T+(S^_^C)+A[8]+2272392833&4294967295,T=S+(D<<11&4294967295|D>>>21),D=C+(T^S^_)+A[11]+1839030562&4294967295,C=T+(D<<16&4294967295|D>>>16),D=_+(C^T^S)+A[14]+4259657740&4294967295,_=C+(D<<23&4294967295|D>>>9),D=S+(_^C^T)+A[1]+2763975236&4294967295,S=_+(D<<4&4294967295|D>>>28),D=T+(S^_^C)+A[4]+1272893353&4294967295,T=S+(D<<11&4294967295|D>>>21),D=C+(T^S^_)+A[7]+4139469664&4294967295,C=T+(D<<16&4294967295|D>>>16),D=_+(C^T^S)+A[10]+3200236656&4294967295,_=C+(D<<23&4294967295|D>>>9),D=S+(_^C^T)+A[13]+681279174&4294967295,S=_+(D<<4&4294967295|D>>>28),D=T+(S^_^C)+A[0]+3936430074&4294967295,T=S+(D<<11&4294967295|D>>>21),D=C+(T^S^_)+A[3]+3572445317&4294967295,C=T+(D<<16&4294967295|D>>>16),D=_+(C^T^S)+A[6]+76029189&4294967295,_=C+(D<<23&4294967295|D>>>9),D=S+(_^C^T)+A[9]+3654602809&4294967295,S=_+(D<<4&4294967295|D>>>28),D=T+(S^_^C)+A[12]+3873151461&4294967295,T=S+(D<<11&4294967295|D>>>21),D=C+(T^S^_)+A[15]+530742520&4294967295,C=T+(D<<16&4294967295|D>>>16),D=_+(C^T^S)+A[2]+3299628645&4294967295,_=C+(D<<23&4294967295|D>>>9),D=S+(C^(_|~T))+A[0]+4096336452&4294967295,S=_+(D<<6&4294967295|D>>>26),D=T+(_^(S|~C))+A[7]+1126891415&4294967295,T=S+(D<<10&4294967295|D>>>22),D=C+(S^(T|~_))+A[14]+2878612391&4294967295,C=T+(D<<15&4294967295|D>>>17),D=_+(T^(C|~S))+A[5]+4237533241&4294967295,_=C+(D<<21&4294967295|D>>>11),D=S+(C^(_|~T))+A[12]+1700485571&4294967295,S=_+(D<<6&4294967295|D>>>26),D=T+(_^(S|~C))+A[3]+2399980690&4294967295,T=S+(D<<10&4294967295|D>>>22),D=C+(S^(T|~_))+A[10]+4293915773&4294967295,C=T+(D<<15&4294967295|D>>>17),D=_+(T^(C|~S))+A[1]+2240044497&4294967295,_=C+(D<<21&4294967295|D>>>11),D=S+(C^(_|~T))+A[8]+1873313359&4294967295,S=_+(D<<6&4294967295|D>>>26),D=T+(_^(S|~C))+A[15]+4264355552&4294967295,T=S+(D<<10&4294967295|D>>>22),D=C+(S^(T|~_))+A[6]+2734768916&4294967295,C=T+(D<<15&4294967295|D>>>17),D=_+(T^(C|~S))+A[13]+1309151649&4294967295,_=C+(D<<21&4294967295|D>>>11),D=S+(C^(_|~T))+A[4]+4149444226&4294967295,S=_+(D<<6&4294967295|D>>>26),D=T+(_^(S|~C))+A[11]+3174756917&4294967295,T=S+(D<<10&4294967295|D>>>22),D=C+(S^(T|~_))+A[2]+718787259&4294967295,C=T+(D<<15&4294967295|D>>>17),D=_+(T^(C|~S))+A[9]+3951481745&4294967295,x.g[0]=x.g[0]+S&4294967295,x.g[1]=x.g[1]+(C+(D<<21&4294967295|D>>>11))&4294967295,x.g[2]=x.g[2]+C&4294967295,x.g[3]=x.g[3]+T&4294967295}n.prototype.u=function(x,S){S===void 0&&(S=x.length);for(var _=S-this.blockSize,A=this.B,C=this.h,T=0;T<S;){if(C==0)for(;T<=_;)s(this,x,T),T+=this.blockSize;if(typeof x=="string"){for(;T<S;)if(A[C++]=x.charCodeAt(T++),C==this.blockSize){s(this,A),C=0;break}}else for(;T<S;)if(A[C++]=x[T++],C==this.blockSize){s(this,A),C=0;break}}this.h=C,this.o+=S},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var S=1;S<x.length-8;++S)x[S]=0;var _=8*this.o;for(S=x.length-8;S<x.length;++S)x[S]=_&255,_/=256;for(this.u(x),x=Array(16),S=_=0;4>S;++S)for(var A=0;32>A;A+=8)x[_++]=this.g[S]>>>A&255;return x};function i(x,S){var _=o;return Object.prototype.hasOwnProperty.call(_,x)?_[x]:_[x]=S(x)}function a(x,S){this.h=S;for(var _=[],A=!0,C=x.length-1;0<=C;C--){var T=x[C]|0;A&&T==S||(_[C]=T,A=!1)}this.g=_}var o={};function l(x){return-128<=x&&128>x?i(x,function(S){return new a([S|0],0>S?-1:0)}):new a([x|0],0>x?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return g(c(-x));for(var S=[],_=1,A=0;x>=_;A++)S[A]=x/_|0,_*=4294967296;return new a(S,0)}function u(x,S){if(x.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(x.charAt(0)=="-")return g(u(x.substring(1),S));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=c(Math.pow(S,8)),A=f,C=0;C<x.length;C+=8){var T=Math.min(8,x.length-C),D=parseInt(x.substring(C,C+T),S);8>T?(T=c(Math.pow(S,T)),A=A.j(T).add(c(D))):(A=A.j(_),A=A.add(c(D)))}return A}var f=l(0),h=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(v(this))return-g(this).m();for(var x=0,S=1,_=0;_<this.g.length;_++){var A=this.i(_);x+=(0<=A?A:4294967296+A)*S,S*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(m(this))return"0";if(v(this))return"-"+g(this).toString(x);for(var S=c(Math.pow(x,6)),_=this,A="";;){var C=k(_,S).g;_=y(_,C.j(S));var T=((0<_.g.length?_.g[0]:_.h)>>>0).toString(x);if(_=C,m(_))return T+A;for(;6>T.length;)T="0"+T;A=T+A}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function m(x){if(x.h!=0)return!1;for(var S=0;S<x.g.length;S++)if(x.g[S]!=0)return!1;return!0}function v(x){return x.h==-1}t.l=function(x){return x=y(this,x),v(x)?-1:m(x)?0:1};function g(x){for(var S=x.g.length,_=[],A=0;A<S;A++)_[A]=~x.g[A];return new a(_,~x.h).add(h)}t.abs=function(){return v(this)?g(this):this},t.add=function(x){for(var S=Math.max(this.g.length,x.g.length),_=[],A=0,C=0;C<=S;C++){var T=A+(this.i(C)&65535)+(x.i(C)&65535),D=(T>>>16)+(this.i(C)>>>16)+(x.i(C)>>>16);A=D>>>16,T&=65535,D&=65535,_[C]=D<<16|T}return new a(_,_[_.length-1]&-2147483648?-1:0)};function y(x,S){return x.add(g(S))}t.j=function(x){if(m(this)||m(x))return f;if(v(this))return v(x)?g(this).j(g(x)):g(g(this).j(x));if(v(x))return g(this.j(g(x)));if(0>this.l(p)&&0>x.l(p))return c(this.m()*x.m());for(var S=this.g.length+x.g.length,_=[],A=0;A<2*S;A++)_[A]=0;for(A=0;A<this.g.length;A++)for(var C=0;C<x.g.length;C++){var T=this.i(A)>>>16,D=this.i(A)&65535,V=x.i(C)>>>16,B=x.i(C)&65535;_[2*A+2*C]+=D*B,E(_,2*A+2*C),_[2*A+2*C+1]+=T*B,E(_,2*A+2*C+1),_[2*A+2*C+1]+=D*V,E(_,2*A+2*C+1),_[2*A+2*C+2]+=T*V,E(_,2*A+2*C+2)}for(A=0;A<S;A++)_[A]=_[2*A+1]<<16|_[2*A];for(A=S;A<2*S;A++)_[A]=0;return new a(_,0)};function E(x,S){for(;(x[S]&65535)!=x[S];)x[S+1]+=x[S]>>>16,x[S]&=65535,S++}function b(x,S){this.g=x,this.h=S}function k(x,S){if(m(S))throw Error("division by zero");if(m(x))return new b(f,f);if(v(x))return S=k(g(x),S),new b(g(S.g),g(S.h));if(v(S))return S=k(x,g(S)),new b(g(S.g),S.h);if(30<x.g.length){if(v(x)||v(S))throw Error("slowDivide_ only works with positive integers.");for(var _=h,A=S;0>=A.l(x);)_=P(_),A=P(A);var C=w(_,1),T=w(A,1);for(A=w(A,2),_=w(_,2);!m(A);){var D=T.add(A);0>=D.l(x)&&(C=C.add(_),T=D),A=w(A,1),_=w(_,1)}return S=y(x,C.j(S)),new b(C,S)}for(C=f;0<=x.l(S);){for(_=Math.max(1,Math.floor(x.m()/S.m())),A=Math.ceil(Math.log(_)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),T=c(_),D=T.j(S);v(D)||0<D.l(x);)_-=A,T=c(_),D=T.j(S);m(T)&&(T=h),C=C.add(T),x=y(x,D)}return new b(C,x)}t.A=function(x){return k(this,x).h},t.and=function(x){for(var S=Math.max(this.g.length,x.g.length),_=[],A=0;A<S;A++)_[A]=this.i(A)&x.i(A);return new a(_,this.h&x.h)},t.or=function(x){for(var S=Math.max(this.g.length,x.g.length),_=[],A=0;A<S;A++)_[A]=this.i(A)|x.i(A);return new a(_,this.h|x.h)},t.xor=function(x){for(var S=Math.max(this.g.length,x.g.length),_=[],A=0;A<S;A++)_[A]=this.i(A)^x.i(A);return new a(_,this.h^x.h)};function P(x){for(var S=x.g.length+1,_=[],A=0;A<S;A++)_[A]=x.i(A)<<1|x.i(A-1)>>>31;return new a(_,x.h)}function w(x,S){var _=S>>5;S%=32;for(var A=x.g.length-_,C=[],T=0;T<A;T++)C[T]=0<S?x.i(T+_)>>>S|x.i(T+_+1)<<32-S:x.i(T+_);return new a(C,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Rw=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Ho=a}).apply(typeof l_<"u"?l_:typeof self<"u"?self:typeof window<"u"?window:{});var Of=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fw,gu,Nw,x0,iv,Ow,Mw,Lw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(I,U,z){return I==Array.prototype||I==Object.prototype||(I[U]=z.value),I};function r(I){I=[typeof globalThis=="object"&&globalThis,I,typeof window=="object"&&window,typeof self=="object"&&self,typeof Of=="object"&&Of];for(var U=0;U<I.length;++U){var z=I[U];if(z&&z.Math==Math)return z}throw Error("Cannot find global object")}var n=r(this);function s(I,U){if(U)e:{var z=n;I=I.split(".");for(var ie=0;ie<I.length-1;ie++){var Ce=I[ie];if(!(Ce in z))break e;z=z[Ce]}I=I[I.length-1],ie=z[I],U=U(ie),U!=ie&&U!=null&&e(z,I,{configurable:!0,writable:!0,value:U})}}function i(I,U){I instanceof String&&(I+="");var z=0,ie=!1,Ce={next:function(){if(!ie&&z<I.length){var Le=z++;return{value:U(Le,I[Le]),done:!1}}return ie=!0,{done:!0,value:void 0}}};return Ce[Symbol.iterator]=function(){return Ce},Ce}s("Array.prototype.values",function(I){return I||function(){return i(this,function(U,z){return z})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(I){var U=typeof I;return U=U!="object"?U:I?Array.isArray(I)?"array":U:"null",U=="array"||U=="object"&&typeof I.length=="number"}function c(I){var U=typeof I;return U=="object"&&I!=null||U=="function"}function u(I,U,z){return I.call.apply(I.bind,arguments)}function f(I,U,z){if(!I)throw Error();if(2<arguments.length){var ie=Array.prototype.slice.call(arguments,2);return function(){var Ce=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ce,ie),I.apply(U,Ce)}}return function(){return I.apply(U,arguments)}}function h(I,U,z){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,h.apply(null,arguments)}function p(I,U){var z=Array.prototype.slice.call(arguments,1);return function(){var ie=z.slice();return ie.push.apply(ie,arguments),I.apply(this,ie)}}function m(I,U){function z(){}z.prototype=U.prototype,I.aa=U.prototype,I.prototype=new z,I.prototype.constructor=I,I.Qb=function(ie,Ce,Le){for(var tt=Array(arguments.length-2),mr=2;mr<arguments.length;mr++)tt[mr-2]=arguments[mr];return U.prototype[Ce].apply(ie,tt)}}function v(I){const U=I.length;if(0<U){const z=Array(U);for(let ie=0;ie<U;ie++)z[ie]=I[ie];return z}return[]}function g(I,U){for(let z=1;z<arguments.length;z++){const ie=arguments[z];if(l(ie)){const Ce=I.length||0,Le=ie.length||0;I.length=Ce+Le;for(let tt=0;tt<Le;tt++)I[Ce+tt]=ie[tt]}else I.push(ie)}}class y{constructor(U,z){this.i=U,this.j=z,this.h=0,this.g=null}get(){let U;return 0<this.h?(this.h--,U=this.g,this.g=U.next,U.next=null):U=this.i(),U}}function E(I){return/^[\s\xa0]*$/.test(I)}function b(){var I=o.navigator;return I&&(I=I.userAgent)?I:""}function k(I){return k[" "](I),I}k[" "]=function(){};var P=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function w(I,U,z){for(const ie in I)U.call(z,I[ie],ie,I)}function x(I,U){for(const z in I)U.call(void 0,I[z],z,I)}function S(I){const U={};for(const z in I)U[z]=I[z];return U}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(I,U){let z,ie;for(let Ce=1;Ce<arguments.length;Ce++){ie=arguments[Ce];for(z in ie)I[z]=ie[z];for(let Le=0;Le<_.length;Le++)z=_[Le],Object.prototype.hasOwnProperty.call(ie,z)&&(I[z]=ie[z])}}function C(I){var U=1;I=I.split(":");const z=[];for(;0<U&&I.length;)z.push(I.shift()),U--;return I.length&&z.push(I.join(":")),z}function T(I){o.setTimeout(()=>{throw I},0)}function D(){var I=O;let U=null;return I.g&&(U=I.g,I.g=I.g.next,I.g||(I.h=null),U.next=null),U}class V{constructor(){this.h=this.g=null}add(U,z){const ie=B.get();ie.set(U,z),this.h?this.h.next=ie:this.g=ie,this.h=ie}}var B=new y(()=>new R,I=>I.reset());class R{constructor(){this.next=this.g=this.h=null}set(U,z){this.h=U,this.g=z,this.next=null}reset(){this.next=this.g=this.h=null}}let F,M=!1,O=new V,K=()=>{const I=o.Promise.resolve(void 0);F=()=>{I.then(j)}};var j=()=>{for(var I;I=D();){try{I.h.call(I.g)}catch(z){T(z)}var U=B;U.j(I),100>U.h&&(U.h++,I.next=U.g,U.g=I)}M=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(I,U){this.type=I,this.g=this.target=U,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var I=!1,U=Object.defineProperty({},"passive",{get:function(){I=!0}});try{const z=()=>{};o.addEventListener("test",z,U),o.removeEventListener("test",z,U)}catch{}return I}();function re(I,U){if(W.call(this,I?I.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,I){var z=this.type=I.type,ie=I.changedTouches&&I.changedTouches.length?I.changedTouches[0]:null;if(this.target=I.target||I.srcElement,this.g=U,U=I.relatedTarget){if(P){e:{try{k(U.nodeName);var Ce=!0;break e}catch{}Ce=!1}Ce||(U=null)}}else z=="mouseover"?U=I.fromElement:z=="mouseout"&&(U=I.toElement);this.relatedTarget=U,ie?(this.clientX=ie.clientX!==void 0?ie.clientX:ie.pageX,this.clientY=ie.clientY!==void 0?ie.clientY:ie.pageY,this.screenX=ie.screenX||0,this.screenY=ie.screenY||0):(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0),this.button=I.button,this.key=I.key||"",this.ctrlKey=I.ctrlKey,this.altKey=I.altKey,this.shiftKey=I.shiftKey,this.metaKey=I.metaKey,this.pointerId=I.pointerId||0,this.pointerType=typeof I.pointerType=="string"?I.pointerType:he[I.pointerType]||"",this.state=I.state,this.i=I,I.defaultPrevented&&re.aa.h.call(this)}}m(re,W);var he={2:"touch",3:"pen",4:"mouse"};re.prototype.h=function(){re.aa.h.call(this);var I=this.i;I.preventDefault?I.preventDefault():I.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),pe=0;function q(I,U,z,ie,Ce){this.listener=I,this.proxy=null,this.src=U,this.type=z,this.capture=!!ie,this.ha=Ce,this.key=++pe,this.da=this.fa=!1}function G(I){I.da=!0,I.listener=null,I.proxy=null,I.src=null,I.ha=null}function oe(I){this.src=I,this.g={},this.h=0}oe.prototype.add=function(I,U,z,ie,Ce){var Le=I.toString();I=this.g[Le],I||(I=this.g[Le]=[],this.h++);var tt=Y(I,U,ie,Ce);return-1<tt?(U=I[tt],z||(U.fa=!1)):(U=new q(U,this.src,Le,!!ie,Ce),U.fa=z,I.push(U)),U};function Q(I,U){var z=U.type;if(z in I.g){var ie=I.g[z],Ce=Array.prototype.indexOf.call(ie,U,void 0),Le;(Le=0<=Ce)&&Array.prototype.splice.call(ie,Ce,1),Le&&(G(U),I.g[z].length==0&&(delete I.g[z],I.h--))}}function Y(I,U,z,ie){for(var Ce=0;Ce<I.length;++Ce){var Le=I[Ce];if(!Le.da&&Le.listener==U&&Le.capture==!!z&&Le.ha==ie)return Ce}return-1}var Z="closure_lm_"+(1e6*Math.random()|0),ne={};function ge(I,U,z,ie,Ce){if(Array.isArray(U)){for(var Le=0;Le<U.length;Le++)ge(I,U[Le],z,ie,Ce);return null}return z=$e(z),I&&I[ue]?I.K(U,z,c(ie)?!!ie.capture:!1,Ce):ae(I,U,z,!1,ie,Ce)}function ae(I,U,z,ie,Ce,Le){if(!U)throw Error("Invalid event type");var tt=c(Ce)?!!Ce.capture:!!Ce,mr=Ge(I);if(mr||(I[Z]=mr=new oe(I)),z=mr.add(U,z,ie,tt,Le),z.proxy)return z;if(ie=ce(),z.proxy=ie,ie.src=I,ie.listener=z,I.addEventListener)X||(Ce=tt),Ce===void 0&&(Ce=!1),I.addEventListener(U.toString(),ie,Ce);else if(I.attachEvent)I.attachEvent(Ie(U.toString()),ie);else if(I.addListener&&I.removeListener)I.addListener(ie);else throw Error("addEventListener and attachEvent are unavailable.");return z}function ce(){function I(z){return U.call(I.src,I.listener,z)}const U=Te;return I}function fe(I,U,z,ie,Ce){if(Array.isArray(U))for(var Le=0;Le<U.length;Le++)fe(I,U[Le],z,ie,Ce);else ie=c(ie)?!!ie.capture:!!ie,z=$e(z),I&&I[ue]?(I=I.i,U=String(U).toString(),U in I.g&&(Le=I.g[U],z=Y(Le,z,ie,Ce),-1<z&&(G(Le[z]),Array.prototype.splice.call(Le,z,1),Le.length==0&&(delete I.g[U],I.h--)))):I&&(I=Ge(I))&&(U=I.g[U.toString()],I=-1,U&&(I=Y(U,z,ie,Ce)),(z=-1<I?U[I]:null)&&Ae(z))}function Ae(I){if(typeof I!="number"&&I&&!I.da){var U=I.src;if(U&&U[ue])Q(U.i,I);else{var z=I.type,ie=I.proxy;U.removeEventListener?U.removeEventListener(z,ie,I.capture):U.detachEvent?U.detachEvent(Ie(z),ie):U.addListener&&U.removeListener&&U.removeListener(ie),(z=Ge(U))?(Q(z,I),z.h==0&&(z.src=null,U[Z]=null)):G(I)}}}function Ie(I){return I in ne?ne[I]:ne[I]="on"+I}function Te(I,U){if(I.da)I=!0;else{U=new re(U,this);var z=I.listener,ie=I.ha||I.src;I.fa&&Ae(I),I=z.call(ie,U)}return I}function Ge(I){return I=I[Z],I instanceof oe?I:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function $e(I){return typeof I=="function"?I:(I[ke]||(I[ke]=function(U){return I.handleEvent(U)}),I[ke])}function Be(){H.call(this),this.i=new oe(this),this.M=this,this.F=null}m(Be,H),Be.prototype[ue]=!0,Be.prototype.removeEventListener=function(I,U,z,ie){fe(this,I,U,z,ie)};function We(I,U){var z,ie=I.F;if(ie)for(z=[];ie;ie=ie.F)z.push(ie);if(I=I.M,ie=U.type||U,typeof U=="string")U=new W(U,I);else if(U instanceof W)U.target=U.target||I;else{var Ce=U;U=new W(ie,I),A(U,Ce)}if(Ce=!0,z)for(var Le=z.length-1;0<=Le;Le--){var tt=U.g=z[Le];Ce=Ke(tt,ie,!0,U)&&Ce}if(tt=U.g=I,Ce=Ke(tt,ie,!0,U)&&Ce,Ce=Ke(tt,ie,!1,U)&&Ce,z)for(Le=0;Le<z.length;Le++)tt=U.g=z[Le],Ce=Ke(tt,ie,!1,U)&&Ce}Be.prototype.N=function(){if(Be.aa.N.call(this),this.i){var I=this.i,U;for(U in I.g){for(var z=I.g[U],ie=0;ie<z.length;ie++)G(z[ie]);delete I.g[U],I.h--}}this.F=null},Be.prototype.K=function(I,U,z,ie){return this.i.add(String(I),U,!1,z,ie)},Be.prototype.L=function(I,U,z,ie){return this.i.add(String(I),U,!0,z,ie)};function Ke(I,U,z,ie){if(U=I.i.g[String(U)],!U)return!0;U=U.concat();for(var Ce=!0,Le=0;Le<U.length;++Le){var tt=U[Le];if(tt&&!tt.da&&tt.capture==z){var mr=tt.listener,yn=tt.ha||tt.src;tt.fa&&Q(I.i,tt),Ce=mr.call(yn,ie)!==!1&&Ce}}return Ce&&!ie.defaultPrevented}function Ee(I,U,z){if(typeof I=="function")z&&(I=h(I,z));else if(I&&typeof I.handleEvent=="function")I=h(I.handleEvent,I);else throw Error("Invalid listener argument");return 2147483647<Number(U)?-1:o.setTimeout(I,U||0)}function ye(I){I.g=Ee(()=>{I.g=null,I.i&&(I.i=!1,ye(I))},I.l);const U=I.h;I.h=null,I.m.apply(null,U)}class be extends H{constructor(U,z){super(),this.m=U,this.l=z,this.h=null,this.i=!1,this.g=null}j(U){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oe(I){H.call(this),this.h=I,this.g={}}m(Oe,H);var je=[];function lt(I){w(I.g,function(U,z){this.g.hasOwnProperty(z)&&Ae(U)},I),I.g={}}Oe.prototype.N=function(){Oe.aa.N.call(this),lt(this)},Oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gt=o.JSON.stringify,Et=o.JSON.parse,jt=class{stringify(I){return o.JSON.stringify(I,void 0)}parse(I){return o.JSON.parse(I,void 0)}};function pt(){}pt.prototype.h=null;function ut(I){return I.h||(I.h=I.i())}function mt(){}var Dt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ot(){W.call(this,"d")}m(Ot,W);function br(){W.call(this,"c")}m(br,W);var Zn={},ki=null;function fs(){return ki=ki||new Be}Zn.La="serverreachability";function _l(I){W.call(this,Zn.La,I)}m(_l,W);function ja(I){const U=fs();We(U,new _l(U))}Zn.STAT_EVENT="statevent";function _o(I,U){W.call(this,Zn.STAT_EVENT,I),this.stat=U}m(_o,W);function nn(I){const U=fs();We(U,new _o(U,I))}Zn.Ma="timingevent";function bo(I,U){W.call(this,Zn.Ma,I),this.size=U}m(bo,W);function Dr(I,U){if(typeof I!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){I()},U)}function Dn(){this.g=!0}Dn.prototype.xa=function(){this.g=!1};function bl(I,U,z,ie,Ce,Le){I.info(function(){if(I.g)if(Le)for(var tt="",mr=Le.split("&"),yn=0;yn<mr.length;yn++){var ar=mr[yn].split("=");if(1<ar.length){var Pn=ar[0];ar=ar[1];var Rn=Pn.split("_");tt=2<=Rn.length&&Rn[1]=="type"?tt+(Pn+"="+ar+"&"):tt+(Pn+"=redacted&")}}else tt=null;else tt=Le;return"XMLHTTP REQ ("+ie+") [attempt "+Ce+"]: "+U+`
`+z+`
`+tt})}function Wc(I,U,z,ie,Ce,Le,tt){I.info(function(){return"XMLHTTP RESP ("+ie+") [ attempt "+Ce+"]: "+U+`
`+z+`
`+Le+" "+tt})}function te(I,U,z,ie){I.info(function(){return"XMLHTTP TEXT ("+U+"): "+le(I,z)+(ie?" "+ie:"")})}function me(I,U){I.info(function(){return"TIMEOUT: "+U})}Dn.prototype.info=function(){};function le(I,U){if(!I.g)return U;if(!U)return null;try{var z=JSON.parse(U);if(z){for(I=0;I<z.length;I++)if(Array.isArray(z[I])){var ie=z[I];if(!(2>ie.length)){var Ce=ie[1];if(Array.isArray(Ce)&&!(1>Ce.length)){var Le=Ce[0];if(Le!="noop"&&Le!="stop"&&Le!="close")for(var tt=1;tt<Ce.length;tt++)Ce[tt]=""}}}}return gt(z)}catch{return U}}var de={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ve={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xe;function De(){}m(De,pt),De.prototype.g=function(){return new XMLHttpRequest},De.prototype.i=function(){return{}},xe=new De;function Ue(I,U,z,ie){this.j=I,this.i=U,this.l=z,this.R=ie||1,this.U=new Oe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Pe}function Pe(){this.i=null,this.g="",this.h=!1}var Fe={},Me={};function Xe(I,U,z){I.L=1,I.v=mf(Wa(U)),I.m=z,I.P=!0,et(I,null)}function et(I,U){I.F=Date.now(),at(I),I.A=Wa(I.v);var z=I.A,ie=I.R;Array.isArray(ie)||(ie=[String(ie)]),wy(z.i,"t",ie),I.C=0,z=I.j.J,I.h=new Pe,I.g=Gy(I.j,z?U:null,!I.m),0<I.O&&(I.M=new be(h(I.Y,I,I.g),I.O)),U=I.U,z=I.g,ie=I.ca;var Ce="readystatechange";Array.isArray(Ce)||(Ce&&(je[0]=Ce.toString()),Ce=je);for(var Le=0;Le<Ce.length;Le++){var tt=ge(z,Ce[Le],ie||U.handleEvent,!1,U.h||U);if(!tt)break;U.g[tt.key]=tt}U=I.H?S(I.H):{},I.m?(I.u||(I.u="POST"),U["Content-Type"]="application/x-www-form-urlencoded",I.g.ea(I.A,I.u,I.m,U)):(I.u="GET",I.g.ea(I.A,I.u,null,U)),ja(),bl(I.i,I.u,I.A,I.l,I.R,I.m)}Ue.prototype.ca=function(I){I=I.target;const U=this.M;U&&za(I)==3?U.j():this.Y(I)},Ue.prototype.Y=function(I){try{if(I==this.g)e:{const Rn=za(this.g);var U=this.g.Ba();const wl=this.g.Z();if(!(3>Rn)&&(Rn!=3||this.g&&(this.h.h||this.g.oa()||Fy(this.g)))){this.J||Rn!=4||U==7||(U==8||0>=wl?ja(3):ja(2)),pr(this);var z=this.g.Z();this.X=z;t:if(ct(this)){var ie=Fy(this.g);I="";var Ce=ie.length,Le=za(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){wr(this),dr(this);var tt="";break t}this.h.i=new o.TextDecoder}for(U=0;U<Ce;U++)this.h.h=!0,I+=this.h.i.decode(ie[U],{stream:!(Le&&U==Ce-1)});ie.length=0,this.h.g+=I,this.C=0,tt=this.h.g}else tt=this.g.oa();if(this.o=z==200,Wc(this.i,this.u,this.A,this.l,this.R,Rn,z),this.o){if(this.T&&!this.K){t:{if(this.g){var mr,yn=this.g;if((mr=yn.g?yn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(mr)){var ar=mr;break t}}ar=null}if(z=ar)te(this.i,this.l,z,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ga(this,z);else{this.o=!1,this.s=3,nn(12),wr(this),dr(this);break e}}if(this.P){z=!0;let qs;for(;!this.J&&this.C<tt.length;)if(qs=Je(this,tt),qs==Me){Rn==4&&(this.s=4,nn(14),z=!1),te(this.i,this.l,null,"[Incomplete Response]");break}else if(qs==Fe){this.s=4,nn(15),te(this.i,this.l,tt,"[Invalid Chunk]"),z=!1;break}else te(this.i,this.l,qs,null),Ga(this,qs);if(ct(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rn!=4||tt.length!=0||this.h.h||(this.s=1,nn(16),z=!1),this.o=this.o&&z,!z)te(this.i,this.l,tt,"[Invalid Chunked Response]"),wr(this),dr(this);else if(0<tt.length&&!this.W){this.W=!0;var Pn=this.j;Pn.g==this&&Pn.ba&&!Pn.M&&(Pn.j.info("Great, no buffering proxy detected. Bytes received: "+tt.length),Hp(Pn),Pn.M=!0,nn(11))}}else te(this.i,this.l,tt,null),Ga(this,tt);Rn==4&&wr(this),this.o&&!this.J&&(Rn==4?$y(this.j,this):(this.o=!1,at(this)))}else cD(this.g),z==400&&0<tt.indexOf("Unknown SID")?(this.s=3,nn(12)):(this.s=0,nn(13)),wr(this),dr(this)}}}catch{}finally{}};function ct(I){return I.g?I.u=="GET"&&I.L!=2&&I.j.Ca:!1}function Je(I,U){var z=I.C,ie=U.indexOf(`
`,z);return ie==-1?Me:(z=Number(U.substring(z,ie)),isNaN(z)?Fe:(ie+=1,ie+z>U.length?Me:(U=U.slice(ie,ie+z),I.C=ie+z,U)))}Ue.prototype.cancel=function(){this.J=!0,wr(this)};function at(I){I.S=Date.now()+I.I,Ct(I,I.I)}function Ct(I,U){if(I.B!=null)throw Error("WatchDog timer not null");I.B=Dr(h(I.ba,I),U)}function pr(I){I.B&&(o.clearTimeout(I.B),I.B=null)}Ue.prototype.ba=function(){this.B=null;const I=Date.now();0<=I-this.S?(me(this.i,this.A),this.L!=2&&(ja(),nn(17)),wr(this),this.s=2,dr(this)):Ct(this,this.S-I)};function dr(I){I.j.G==0||I.J||$y(I.j,I)}function wr(I){pr(I);var U=I.M;U&&typeof U.ma=="function"&&U.ma(),I.M=null,lt(I.U),I.g&&(U=I.g,I.g=null,U.abort(),U.ma())}function Ga(I,U){try{var z=I.j;if(z.G!=0&&(z.g==I||Es(z.h,I))){if(!I.K&&Es(z.h,I)&&z.G==3){try{var ie=z.Da.g.parse(U)}catch{ie=null}if(Array.isArray(ie)&&ie.length==3){var Ce=ie;if(Ce[0]==0){e:if(!z.u){if(z.g)if(z.g.F+3e3<I.F)_f(z),yf(z);else break e;Vp(z),nn(18)}}else z.za=Ce[1],0<z.za-z.T&&37500>Ce[2]&&z.F&&z.v==0&&!z.C&&(z.C=Dr(h(z.Za,z),6e3));if(1>=Sl(z.h)&&z.ca){try{z.ca()}catch{}z.ca=void 0}}else To(z,11)}else if((I.K||z.g==I)&&_f(z),!E(U))for(Ce=z.Da.g.parse(U),U=0;U<Ce.length;U++){let ar=Ce[U];if(z.T=ar[0],ar=ar[1],z.G==2)if(ar[0]=="c"){z.K=ar[1],z.ia=ar[2];const Pn=ar[3];Pn!=null&&(z.la=Pn,z.j.info("VER="+z.la));const Rn=ar[4];Rn!=null&&(z.Aa=Rn,z.j.info("SVER="+z.Aa));const wl=ar[5];wl!=null&&typeof wl=="number"&&0<wl&&(ie=1.5*wl,z.L=ie,z.j.info("backChannelRequestTimeoutMs_="+ie)),ie=z;const qs=I.g;if(qs){const Sf=qs.g?qs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sf){var Le=ie.h;Le.g||Sf.indexOf("spdy")==-1&&Sf.indexOf("quic")==-1&&Sf.indexOf("h2")==-1||(Le.j=Le.l,Le.g=new Set,Le.h&&(Bp(Le,Le.h),Le.h=null))}if(ie.D){const jp=qs.g?qs.g.getResponseHeader("X-HTTP-Session-Id"):null;jp&&(ie.ya=jp,Sr(ie.I,ie.D,jp))}}z.G=3,z.l&&z.l.ua(),z.ba&&(z.R=Date.now()-I.F,z.j.info("Handshake RTT: "+z.R+"ms")),ie=z;var tt=I;if(ie.qa=jy(ie,ie.J?ie.ia:null,ie.W),tt.K){xy(ie.h,tt);var mr=tt,yn=ie.L;yn&&(mr.I=yn),mr.B&&(pr(mr),at(mr)),ie.g=tt}else By(ie);0<z.i.length&&Ef(z)}else ar[0]!="stop"&&ar[0]!="close"||To(z,7);else z.G==3&&(ar[0]=="stop"||ar[0]=="close"?ar[0]=="stop"?To(z,7):$p(z):ar[0]!="noop"&&z.l&&z.l.ta(ar),z.v=0)}}ja(4)}catch{}}var So=class{constructor(I,U){this.g=I,this.map=U}};function Di(I){this.l=I||10,o.PerformanceNavigationTiming?(I=o.performance.getEntriesByType("navigation"),I=0<I.length&&(I[0].nextHopProtocol=="hq"||I[0].nextHopProtocol=="h2")):I=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=I?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ea(I){return I.h?!0:I.g?I.g.size>=I.j:!1}function Sl(I){return I.h?1:I.g?I.g.size:0}function Es(I,U){return I.h?I.h==U:I.g?I.g.has(U):!1}function Bp(I,U){I.g?I.g.add(U):I.h=U}function xy(I,U){I.h&&I.h==U?I.h=null:I.g&&I.g.has(U)&&I.g.delete(U)}Di.prototype.cancel=function(){if(this.i=yy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const I of this.g.values())I.cancel();this.g.clear()}};function yy(I){if(I.h!=null)return I.i.concat(I.h.D);if(I.g!=null&&I.g.size!==0){let U=I.i;for(const z of I.g.values())U=U.concat(z.D);return U}return v(I.i)}function qk(I){if(I.V&&typeof I.V=="function")return I.V();if(typeof Map<"u"&&I instanceof Map||typeof Set<"u"&&I instanceof Set)return Array.from(I.values());if(typeof I=="string")return I.split("");if(l(I)){for(var U=[],z=I.length,ie=0;ie<z;ie++)U.push(I[ie]);return U}U=[],z=0;for(ie in I)U[z++]=I[ie];return U}function Xk(I){if(I.na&&typeof I.na=="function")return I.na();if(!I.V||typeof I.V!="function"){if(typeof Map<"u"&&I instanceof Map)return Array.from(I.keys());if(!(typeof Set<"u"&&I instanceof Set)){if(l(I)||typeof I=="string"){var U=[];I=I.length;for(var z=0;z<I;z++)U.push(z);return U}U=[],z=0;for(const ie in I)U[z++]=ie;return U}}}function Ey(I,U){if(I.forEach&&typeof I.forEach=="function")I.forEach(U,void 0);else if(l(I)||typeof I=="string")Array.prototype.forEach.call(I,U,void 0);else for(var z=Xk(I),ie=qk(I),Ce=ie.length,Le=0;Le<Ce;Le++)U.call(void 0,ie[Le],z&&z[Le],I)}var _y=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yk(I,U){if(I){I=I.split("&");for(var z=0;z<I.length;z++){var ie=I[z].indexOf("="),Ce=null;if(0<=ie){var Le=I[z].substring(0,ie);Ce=I[z].substring(ie+1)}else Le=I[z];U(Le,Ce?decodeURIComponent(Ce.replace(/\+/g," ")):"")}}}function Ao(I){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,I instanceof Ao){this.h=I.h,hf(this,I.j),this.o=I.o,this.g=I.g,pf(this,I.s),this.l=I.l;var U=I.i,z=new qc;z.i=U.i,U.g&&(z.g=new Map(U.g),z.h=U.h),by(this,z),this.m=I.m}else I&&(U=String(I).match(_y))?(this.h=!1,hf(this,U[1]||"",!0),this.o=zc(U[2]||""),this.g=zc(U[3]||"",!0),pf(this,U[4]),this.l=zc(U[5]||"",!0),by(this,U[6]||"",!0),this.m=zc(U[7]||"")):(this.h=!1,this.i=new qc(null,this.h))}Ao.prototype.toString=function(){var I=[],U=this.j;U&&I.push(Kc(U,Sy,!0),":");var z=this.g;return(z||U=="file")&&(I.push("//"),(U=this.o)&&I.push(Kc(U,Sy,!0),"@"),I.push(encodeURIComponent(String(z)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),z=this.s,z!=null&&I.push(":",String(z))),(z=this.l)&&(this.g&&z.charAt(0)!="/"&&I.push("/"),I.push(Kc(z,z.charAt(0)=="/"?Zk:Jk,!0))),(z=this.i.toString())&&I.push("?",z),(z=this.m)&&I.push("#",Kc(z,tD)),I.join("")};function Wa(I){return new Ao(I)}function hf(I,U,z){I.j=z?zc(U,!0):U,I.j&&(I.j=I.j.replace(/:$/,""))}function pf(I,U){if(U){if(U=Number(U),isNaN(U)||0>U)throw Error("Bad port number "+U);I.s=U}else I.s=null}function by(I,U,z){U instanceof qc?(I.i=U,rD(I.i,I.h)):(z||(U=Kc(U,eD)),I.i=new qc(U,I.h))}function Sr(I,U,z){I.i.set(U,z)}function mf(I){return Sr(I,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),I}function zc(I,U){return I?U?decodeURI(I.replace(/%25/g,"%2525")):decodeURIComponent(I):""}function Kc(I,U,z){return typeof I=="string"?(I=encodeURI(I).replace(U,Qk),z&&(I=I.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I):null}function Qk(I){return I=I.charCodeAt(0),"%"+(I>>4&15).toString(16)+(I&15).toString(16)}var Sy=/[#\/\?@]/g,Jk=/[#\?:]/g,Zk=/[#\?]/g,eD=/[#\?@]/g,tD=/#/g;function qc(I,U){this.h=this.g=null,this.i=I||null,this.j=!!U}function Pi(I){I.g||(I.g=new Map,I.h=0,I.i&&Yk(I.i,function(U,z){I.add(decodeURIComponent(U.replace(/\+/g," ")),z)}))}t=qc.prototype,t.add=function(I,U){Pi(this),this.i=null,I=Al(this,I);var z=this.g.get(I);return z||this.g.set(I,z=[]),z.push(U),this.h+=1,this};function Ay(I,U){Pi(I),U=Al(I,U),I.g.has(U)&&(I.i=null,I.h-=I.g.get(U).length,I.g.delete(U))}function Ty(I,U){return Pi(I),U=Al(I,U),I.g.has(U)}t.forEach=function(I,U){Pi(this),this.g.forEach(function(z,ie){z.forEach(function(Ce){I.call(U,Ce,ie,this)},this)},this)},t.na=function(){Pi(this);const I=Array.from(this.g.values()),U=Array.from(this.g.keys()),z=[];for(let ie=0;ie<U.length;ie++){const Ce=I[ie];for(let Le=0;Le<Ce.length;Le++)z.push(U[ie])}return z},t.V=function(I){Pi(this);let U=[];if(typeof I=="string")Ty(this,I)&&(U=U.concat(this.g.get(Al(this,I))));else{I=Array.from(this.g.values());for(let z=0;z<I.length;z++)U=U.concat(I[z])}return U},t.set=function(I,U){return Pi(this),this.i=null,I=Al(this,I),Ty(this,I)&&(this.h-=this.g.get(I).length),this.g.set(I,[U]),this.h+=1,this},t.get=function(I,U){return I?(I=this.V(I),0<I.length?String(I[0]):U):U};function wy(I,U,z){Ay(I,U),0<z.length&&(I.i=null,I.g.set(Al(I,U),v(z)),I.h+=z.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const I=[],U=Array.from(this.g.keys());for(var z=0;z<U.length;z++){var ie=U[z];const Le=encodeURIComponent(String(ie)),tt=this.V(ie);for(ie=0;ie<tt.length;ie++){var Ce=Le;tt[ie]!==""&&(Ce+="="+encodeURIComponent(String(tt[ie]))),I.push(Ce)}}return this.i=I.join("&")};function Al(I,U){return U=String(U),I.j&&(U=U.toLowerCase()),U}function rD(I,U){U&&!I.j&&(Pi(I),I.i=null,I.g.forEach(function(z,ie){var Ce=ie.toLowerCase();ie!=Ce&&(Ay(this,ie),wy(this,Ce,z))},I)),I.j=U}function nD(I,U){const z=new Dn;if(o.Image){const ie=new Image;ie.onload=p(Ri,z,"TestLoadImage: loaded",!0,U,ie),ie.onerror=p(Ri,z,"TestLoadImage: error",!1,U,ie),ie.onabort=p(Ri,z,"TestLoadImage: abort",!1,U,ie),ie.ontimeout=p(Ri,z,"TestLoadImage: timeout",!1,U,ie),o.setTimeout(function(){ie.ontimeout&&ie.ontimeout()},1e4),ie.src=I}else U(!1)}function sD(I,U){const z=new Dn,ie=new AbortController,Ce=setTimeout(()=>{ie.abort(),Ri(z,"TestPingServer: timeout",!1,U)},1e4);fetch(I,{signal:ie.signal}).then(Le=>{clearTimeout(Ce),Le.ok?Ri(z,"TestPingServer: ok",!0,U):Ri(z,"TestPingServer: server error",!1,U)}).catch(()=>{clearTimeout(Ce),Ri(z,"TestPingServer: error",!1,U)})}function Ri(I,U,z,ie,Ce){try{Ce&&(Ce.onload=null,Ce.onerror=null,Ce.onabort=null,Ce.ontimeout=null),ie(z)}catch{}}function aD(){this.g=new jt}function iD(I,U,z){const ie=z||"";try{Ey(I,function(Ce,Le){let tt=Ce;c(Ce)&&(tt=gt(Ce)),U.push(ie+Le+"="+encodeURIComponent(tt))})}catch(Ce){throw U.push(ie+"type="+encodeURIComponent("_badmap")),Ce}}function gf(I){this.l=I.Ub||null,this.j=I.eb||!1}m(gf,pt),gf.prototype.g=function(){return new vf(this.l,this.j)},gf.prototype.i=function(I){return function(){return I}}({});function vf(I,U){Be.call(this),this.D=I,this.o=U,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(vf,Be),t=vf.prototype,t.open=function(I,U){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=I,this.A=U,this.readyState=1,Yc(this)},t.send=function(I){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const U={headers:this.u,method:this.B,credentials:this.m,cache:void 0};I&&(U.body=I),(this.D||o).fetch(new Request(this.A,U)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xc(this)),this.readyState=0},t.Sa=function(I){if(this.g&&(this.l=I,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=I.headers,this.readyState=2,Yc(this)),this.g&&(this.readyState=3,Yc(this),this.g)))if(this.responseType==="arraybuffer")I.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in I){if(this.j=I.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cy(this)}else I.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cy(I){I.j.read().then(I.Pa.bind(I)).catch(I.ga.bind(I))}t.Pa=function(I){if(this.g){if(this.o&&I.value)this.response.push(I.value);else if(!this.o){var U=I.value?I.value:new Uint8Array(0);(U=this.v.decode(U,{stream:!I.done}))&&(this.response=this.responseText+=U)}I.done?Xc(this):Yc(this),this.readyState==3&&Cy(this)}},t.Ra=function(I){this.g&&(this.response=this.responseText=I,Xc(this))},t.Qa=function(I){this.g&&(this.response=I,Xc(this))},t.ga=function(){this.g&&Xc(this)};function Xc(I){I.readyState=4,I.l=null,I.j=null,I.v=null,Yc(I)}t.setRequestHeader=function(I,U){this.u.append(I,U)},t.getResponseHeader=function(I){return this.h&&this.h.get(I.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const I=[],U=this.h.entries();for(var z=U.next();!z.done;)z=z.value,I.push(z[0]+": "+z[1]),z=U.next();return I.join(`\r
`)};function Yc(I){I.onreadystatechange&&I.onreadystatechange.call(I)}Object.defineProperty(vf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(I){this.m=I?"include":"same-origin"}});function Iy(I){let U="";return w(I,function(z,ie){U+=ie,U+=":",U+=z,U+=`\r
`}),U}function Up(I,U,z){e:{for(ie in z){var ie=!1;break e}ie=!0}ie||(z=Iy(z),typeof I=="string"?z!=null&&encodeURIComponent(String(z)):Sr(I,U,z))}function Or(I){Be.call(this),this.headers=new Map,this.o=I||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(Or,Be);var oD=/^https?$/i,lD=["POST","PUT"];t=Or.prototype,t.Ha=function(I){this.J=I},t.ea=function(I,U,z,ie){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+I);U=U?U.toUpperCase():"GET",this.D=I,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xe.g(),this.v=this.o?ut(this.o):ut(xe),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(U,String(I),!0),this.B=!1}catch(Le){ky(this,Le);return}if(I=z||"",z=new Map(this.headers),ie)if(Object.getPrototypeOf(ie)===Object.prototype)for(var Ce in ie)z.set(Ce,ie[Ce]);else if(typeof ie.keys=="function"&&typeof ie.get=="function")for(const Le of ie.keys())z.set(Le,ie.get(Le));else throw Error("Unknown input type for opt_headers: "+String(ie));ie=Array.from(z.keys()).find(Le=>Le.toLowerCase()=="content-type"),Ce=o.FormData&&I instanceof o.FormData,!(0<=Array.prototype.indexOf.call(lD,U,void 0))||ie||Ce||z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Le,tt]of z)this.g.setRequestHeader(Le,tt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ry(this),this.u=!0,this.g.send(I),this.u=!1}catch(Le){ky(this,Le)}};function ky(I,U){I.h=!1,I.g&&(I.j=!0,I.g.abort(),I.j=!1),I.l=U,I.m=5,Dy(I),xf(I)}function Dy(I){I.A||(I.A=!0,We(I,"complete"),We(I,"error"))}t.abort=function(I){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=I||7,We(this,"complete"),We(this,"abort"),xf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xf(this,!0)),Or.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Py(this):this.bb())},t.bb=function(){Py(this)};function Py(I){if(I.h&&typeof a<"u"&&(!I.v[1]||za(I)!=4||I.Z()!=2)){if(I.u&&za(I)==4)Ee(I.Ea,0,I);else if(We(I,"readystatechange"),za(I)==4){I.h=!1;try{const tt=I.Z();e:switch(tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var U=!0;break e;default:U=!1}var z;if(!(z=U)){var ie;if(ie=tt===0){var Ce=String(I.D).match(_y)[1]||null;!Ce&&o.self&&o.self.location&&(Ce=o.self.location.protocol.slice(0,-1)),ie=!oD.test(Ce?Ce.toLowerCase():"")}z=ie}if(z)We(I,"complete"),We(I,"success");else{I.m=6;try{var Le=2<za(I)?I.g.statusText:""}catch{Le=""}I.l=Le+" ["+I.Z()+"]",Dy(I)}}finally{xf(I)}}}}function xf(I,U){if(I.g){Ry(I);const z=I.g,ie=I.v[0]?()=>{}:null;I.g=null,I.v=null,U||We(I,"ready");try{z.onreadystatechange=ie}catch{}}}function Ry(I){I.I&&(o.clearTimeout(I.I),I.I=null)}t.isActive=function(){return!!this.g};function za(I){return I.g?I.g.readyState:0}t.Z=function(){try{return 2<za(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(I){if(this.g){var U=this.g.responseText;return I&&U.indexOf(I)==0&&(U=U.substring(I.length)),Et(U)}};function Fy(I){try{if(!I.g)return null;if("response"in I.g)return I.g.response;switch(I.H){case"":case"text":return I.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in I.g)return I.g.mozResponseArrayBuffer}return null}catch{return null}}function cD(I){const U={};I=(I.g&&2<=za(I)&&I.g.getAllResponseHeaders()||"").split(`\r
`);for(let ie=0;ie<I.length;ie++){if(E(I[ie]))continue;var z=C(I[ie]);const Ce=z[0];if(z=z[1],typeof z!="string")continue;z=z.trim();const Le=U[Ce]||[];U[Ce]=Le,Le.push(z)}x(U,function(ie){return ie.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qc(I,U,z){return z&&z.internalChannelParams&&z.internalChannelParams[I]||U}function Ny(I){this.Aa=0,this.i=[],this.j=new Dn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qc("failFast",!1,I),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qc("baseRetryDelayMs",5e3,I),this.cb=Qc("retryDelaySeedMs",1e4,I),this.Wa=Qc("forwardChannelMaxRetries",2,I),this.wa=Qc("forwardChannelRequestTimeoutMs",2e4,I),this.pa=I&&I.xmlHttpFactory||void 0,this.Xa=I&&I.Tb||void 0,this.Ca=I&&I.useFetchStreams||!1,this.L=void 0,this.J=I&&I.supportsCrossDomainXhr||!1,this.K="",this.h=new Di(I&&I.concurrentRequestLimit),this.Da=new aD,this.P=I&&I.fastHandshake||!1,this.O=I&&I.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=I&&I.Rb||!1,I&&I.xa&&this.j.xa(),I&&I.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&I&&I.detectBufferingProxy||!1,this.ja=void 0,I&&I.longPollingTimeout&&0<I.longPollingTimeout&&(this.ja=I.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ny.prototype,t.la=8,t.G=1,t.connect=function(I,U,z,ie){nn(0),this.W=I,this.H=U||{},z&&ie!==void 0&&(this.H.OSID=z,this.H.OAID=ie),this.F=this.X,this.I=jy(this,null,this.W),Ef(this)};function $p(I){if(Oy(I),I.G==3){var U=I.U++,z=Wa(I.I);if(Sr(z,"SID",I.K),Sr(z,"RID",U),Sr(z,"TYPE","terminate"),Jc(I,z),U=new Ue(I,I.j,U),U.L=2,U.v=mf(Wa(z)),z=!1,o.navigator&&o.navigator.sendBeacon)try{z=o.navigator.sendBeacon(U.v.toString(),"")}catch{}!z&&o.Image&&(new Image().src=U.v,z=!0),z||(U.g=Gy(U.j,null),U.g.ea(U.v)),U.F=Date.now(),at(U)}Hy(I)}function yf(I){I.g&&(Hp(I),I.g.cancel(),I.g=null)}function Oy(I){yf(I),I.u&&(o.clearTimeout(I.u),I.u=null),_f(I),I.h.cancel(),I.s&&(typeof I.s=="number"&&o.clearTimeout(I.s),I.s=null)}function Ef(I){if(!Ea(I.h)&&!I.s){I.s=!0;var U=I.Ga;F||K(),M||(F(),M=!0),O.add(U,I),I.B=0}}function uD(I,U){return Sl(I.h)>=I.h.j-(I.s?1:0)?!1:I.s?(I.i=U.D.concat(I.i),!0):I.G==1||I.G==2||I.B>=(I.Va?0:I.Wa)?!1:(I.s=Dr(h(I.Ga,I,U),Vy(I,I.B)),I.B++,!0)}t.Ga=function(I){if(this.s)if(this.s=null,this.G==1){if(!I){this.U=Math.floor(1e5*Math.random()),I=this.U++;const Ce=new Ue(this,this.j,I);let Le=this.o;if(this.S&&(Le?(Le=S(Le),A(Le,this.S)):Le=this.S),this.m!==null||this.O||(Ce.H=Le,Le=null),this.P)e:{for(var U=0,z=0;z<this.i.length;z++){t:{var ie=this.i[z];if("__data__"in ie.map&&(ie=ie.map.__data__,typeof ie=="string")){ie=ie.length;break t}ie=void 0}if(ie===void 0)break;if(U+=ie,4096<U){U=z;break e}if(U===4096||z===this.i.length-1){U=z+1;break e}}U=1e3}else U=1e3;U=Ly(this,Ce,U),z=Wa(this.I),Sr(z,"RID",I),Sr(z,"CVER",22),this.D&&Sr(z,"X-HTTP-Session-Id",this.D),Jc(this,z),Le&&(this.O?U="headers="+encodeURIComponent(String(Iy(Le)))+"&"+U:this.m&&Up(z,this.m,Le)),Bp(this.h,Ce),this.Ua&&Sr(z,"TYPE","init"),this.P?(Sr(z,"$req",U),Sr(z,"SID","null"),Ce.T=!0,Xe(Ce,z,null)):Xe(Ce,z,U),this.G=2}}else this.G==3&&(I?My(this,I):this.i.length==0||Ea(this.h)||My(this))};function My(I,U){var z;U?z=U.l:z=I.U++;const ie=Wa(I.I);Sr(ie,"SID",I.K),Sr(ie,"RID",z),Sr(ie,"AID",I.T),Jc(I,ie),I.m&&I.o&&Up(ie,I.m,I.o),z=new Ue(I,I.j,z,I.B+1),I.m===null&&(z.H=I.o),U&&(I.i=U.D.concat(I.i)),U=Ly(I,z,1e3),z.I=Math.round(.5*I.wa)+Math.round(.5*I.wa*Math.random()),Bp(I.h,z),Xe(z,ie,U)}function Jc(I,U){I.H&&w(I.H,function(z,ie){Sr(U,ie,z)}),I.l&&Ey({},function(z,ie){Sr(U,ie,z)})}function Ly(I,U,z){z=Math.min(I.i.length,z);var ie=I.l?h(I.l.Na,I.l,I):null;e:{var Ce=I.i;let Le=-1;for(;;){const tt=["count="+z];Le==-1?0<z?(Le=Ce[0].g,tt.push("ofs="+Le)):Le=0:tt.push("ofs="+Le);let mr=!0;for(let yn=0;yn<z;yn++){let ar=Ce[yn].g;const Pn=Ce[yn].map;if(ar-=Le,0>ar)Le=Math.max(0,Ce[yn].g-100),mr=!1;else try{iD(Pn,tt,"req"+ar+"_")}catch{ie&&ie(Pn)}}if(mr){ie=tt.join("&");break e}}}return I=I.i.splice(0,z),U.D=I,ie}function By(I){if(!I.g&&!I.u){I.Y=1;var U=I.Fa;F||K(),M||(F(),M=!0),O.add(U,I),I.v=0}}function Vp(I){return I.g||I.u||3<=I.v?!1:(I.Y++,I.u=Dr(h(I.Fa,I),Vy(I,I.v)),I.v++,!0)}t.Fa=function(){if(this.u=null,Uy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var I=2*this.R;this.j.info("BP detection timer enabled: "+I),this.A=Dr(h(this.ab,this),I)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nn(10),yf(this),Uy(this))};function Hp(I){I.A!=null&&(o.clearTimeout(I.A),I.A=null)}function Uy(I){I.g=new Ue(I,I.j,"rpc",I.Y),I.m===null&&(I.g.H=I.o),I.g.O=0;var U=Wa(I.qa);Sr(U,"RID","rpc"),Sr(U,"SID",I.K),Sr(U,"AID",I.T),Sr(U,"CI",I.F?"0":"1"),!I.F&&I.ja&&Sr(U,"TO",I.ja),Sr(U,"TYPE","xmlhttp"),Jc(I,U),I.m&&I.o&&Up(U,I.m,I.o),I.L&&(I.g.I=I.L);var z=I.g;I=I.ia,z.L=1,z.v=mf(Wa(U)),z.m=null,z.P=!0,et(z,I)}t.Za=function(){this.C!=null&&(this.C=null,yf(this),Vp(this),nn(19))};function _f(I){I.C!=null&&(o.clearTimeout(I.C),I.C=null)}function $y(I,U){var z=null;if(I.g==U){_f(I),Hp(I),I.g=null;var ie=2}else if(Es(I.h,U))z=U.D,xy(I.h,U),ie=1;else return;if(I.G!=0){if(U.o)if(ie==1){z=U.m?U.m.length:0,U=Date.now()-U.F;var Ce=I.B;ie=fs(),We(ie,new bo(ie,z)),Ef(I)}else By(I);else if(Ce=U.s,Ce==3||Ce==0&&0<U.X||!(ie==1&&uD(I,U)||ie==2&&Vp(I)))switch(z&&0<z.length&&(U=I.h,U.i=U.i.concat(z)),Ce){case 1:To(I,5);break;case 4:To(I,10);break;case 3:To(I,6);break;default:To(I,2)}}}function Vy(I,U){let z=I.Ta+Math.floor(Math.random()*I.cb);return I.isActive()||(z*=2),z*U}function To(I,U){if(I.j.info("Error code "+U),U==2){var z=h(I.fb,I),ie=I.Xa;const Ce=!ie;ie=new Ao(ie||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||hf(ie,"https"),mf(ie),Ce?nD(ie.toString(),z):sD(ie.toString(),z)}else nn(2);I.G=0,I.l&&I.l.sa(U),Hy(I),Oy(I)}t.fb=function(I){I?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function Hy(I){if(I.G=0,I.ka=[],I.l){const U=yy(I.h);(U.length!=0||I.i.length!=0)&&(g(I.ka,U),g(I.ka,I.i),I.h.i.length=0,v(I.i),I.i.length=0),I.l.ra()}}function jy(I,U,z){var ie=z instanceof Ao?Wa(z):new Ao(z);if(ie.g!="")U&&(ie.g=U+"."+ie.g),pf(ie,ie.s);else{var Ce=o.location;ie=Ce.protocol,U=U?U+"."+Ce.hostname:Ce.hostname,Ce=+Ce.port;var Le=new Ao(null);ie&&hf(Le,ie),U&&(Le.g=U),Ce&&pf(Le,Ce),z&&(Le.l=z),ie=Le}return z=I.D,U=I.ya,z&&U&&Sr(ie,z,U),Sr(ie,"VER",I.la),Jc(I,ie),ie}function Gy(I,U,z){if(U&&!I.J)throw Error("Can't create secondary domain capable XhrIo object.");return U=I.Ca&&!I.pa?new Or(new gf({eb:z})):new Or(I.pa),U.Ha(I.J),U}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wy(){}t=Wy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function bf(){}bf.prototype.g=function(I,U){return new _s(I,U)};function _s(I,U){Be.call(this),this.g=new Ny(U),this.l=I,this.h=U&&U.messageUrlParams||null,I=U&&U.messageHeaders||null,U&&U.clientProtocolHeaderRequired&&(I?I["X-Client-Protocol"]="webchannel":I={"X-Client-Protocol":"webchannel"}),this.g.o=I,I=U&&U.initMessageHeaders||null,U&&U.messageContentType&&(I?I["X-WebChannel-Content-Type"]=U.messageContentType:I={"X-WebChannel-Content-Type":U.messageContentType}),U&&U.va&&(I?I["X-WebChannel-Client-Profile"]=U.va:I={"X-WebChannel-Client-Profile":U.va}),this.g.S=I,(I=U&&U.Sb)&&!E(I)&&(this.g.m=I),this.v=U&&U.supportsCrossDomainXhr||!1,this.u=U&&U.sendRawJson||!1,(U=U&&U.httpSessionIdParam)&&!E(U)&&(this.g.D=U,I=this.h,I!==null&&U in I&&(I=this.h,U in I&&delete I[U])),this.j=new Tl(this)}m(_s,Be),_s.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_s.prototype.close=function(){$p(this.g)},_s.prototype.o=function(I){var U=this.g;if(typeof I=="string"){var z={};z.__data__=I,I=z}else this.u&&(z={},z.__data__=gt(I),I=z);U.i.push(new So(U.Ya++,I)),U.G==3&&Ef(U)},_s.prototype.N=function(){this.g.l=null,delete this.j,$p(this.g),delete this.g,_s.aa.N.call(this)};function zy(I){Ot.call(this),I.__headers__&&(this.headers=I.__headers__,this.statusCode=I.__status__,delete I.__headers__,delete I.__status__);var U=I.__sm__;if(U){e:{for(const z in U){I=z;break e}I=void 0}(this.i=I)&&(I=this.i,U=U!==null&&I in U?U[I]:void 0),this.data=U}else this.data=I}m(zy,Ot);function Ky(){br.call(this),this.status=1}m(Ky,br);function Tl(I){this.g=I}m(Tl,Wy),Tl.prototype.ua=function(){We(this.g,"a")},Tl.prototype.ta=function(I){We(this.g,new zy(I))},Tl.prototype.sa=function(I){We(this.g,new Ky)},Tl.prototype.ra=function(){We(this.g,"b")},bf.prototype.createWebChannel=bf.prototype.g,_s.prototype.send=_s.prototype.o,_s.prototype.open=_s.prototype.m,_s.prototype.close=_s.prototype.close,Lw=function(){return new bf},Mw=function(){return fs()},Ow=Zn,iv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},de.NO_ERROR=0,de.TIMEOUT=8,de.HTTP_ERROR=6,x0=de,ve.COMPLETE="complete",Nw=ve,mt.EventType=Dt,Dt.OPEN="a",Dt.CLOSE="b",Dt.ERROR="c",Dt.MESSAGE="d",Be.prototype.listen=Be.prototype.K,gu=mt,Or.prototype.listenOnce=Or.prototype.L,Or.prototype.getLastError=Or.prototype.Ka,Or.prototype.getLastErrorCode=Or.prototype.Ba,Or.prototype.getStatus=Or.prototype.Z,Or.prototype.getResponseJson=Or.prototype.Oa,Or.prototype.getResponseText=Or.prototype.oa,Or.prototype.send=Or.prototype.ea,Or.prototype.setWithCredentials=Or.prototype.Ha,Fw=Or}).apply(typeof Of<"u"?Of:typeof self<"u"?self:typeof window<"u"?window:{});const c_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Bn.UNAUTHENTICATED=new Bn(null),Bn.GOOGLE_CREDENTIALS=new Bn("google-credentials-uid"),Bn.FIRST_PARTY=new Bn("first-party-uid"),Bn.MOCK_USER=new Bn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=new y1("@firebase/firestore");function ru(){return Qo.logLevel}function ft(t,...e){if(Qo.logLevel<=Xt.DEBUG){const r=e.map(O1);Qo.debug(`Firestore (${Nc}): ${t}`,...r)}}function bi(t,...e){if(Qo.logLevel<=Xt.ERROR){const r=e.map(O1);Qo.error(`Firestore (${Nc}): ${t}`,...r)}}function Jo(t,...e){if(Qo.logLevel<=Xt.WARN){const r=e.map(O1);Qo.warn(`Firestore (${Nc}): ${t}`,...r)}}function O1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t="Unexpected state"){const e=`FIRESTORE (${Nc}) INTERNAL ASSERTION FAILED: `+t;throw bi(e),new Error(e)}function fr(t,e){t||kt()}function Nt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const He={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class st extends ga{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Uw{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Bn.UNAUTHENTICATED))}shutdown(){}}class f5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class h5{constructor(e){this.t=e,this.currentUser=Bn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){fr(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new ci;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ci,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{ft("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(ft("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ci)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(ft("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(fr(typeof n.accessToken=="string"),new Bw(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fr(e===null||typeof e=="string"),new Bn(e)}}class p5{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Bn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class m5{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new p5(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Bn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class g5{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class v5{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){fr(this.o===void 0);const n=i=>{i.error!=null&&ft("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,ft("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{ft("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ft("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(fr(typeof r.token=="string"),this.R=r.token,new g5(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x5(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=x5(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function ir(t,e){return t<e?-1:t>e?1:0}function vc(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new st(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new st(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new st(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new st(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rn.fromMillis(Date.now())}static fromDate(e){return rn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new rn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ir(this.nanoseconds,e.nanoseconds):ir(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Rt(e)}static min(){return new Rt(new rn(0,0))}static max(){return new Rt(new rn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,r,n){r===void 0?r=0:r>e.length&&kt(),n===void 0?n=e.length-r:n>e.length-r&&kt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return md.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof md?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),a=r.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class yr extends md{construct(e,r,n){return new yr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new st(He.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new yr(r)}static emptyPath(){return new yr([])}}const y5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mn extends md{construct(e,r,n){return new mn(e,r,n)}static isValidIdentifier(e){return y5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new mn(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new st(He.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new st(He.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new st(He.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new st(He.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mn(r)}static emptyPath(){return new mn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.path=e}static fromPath(e){return new vt(yr.fromString(e))}static fromName(e){return new vt(yr.fromString(e).popFirst(5))}static empty(){return new vt(yr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return yr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vt(new yr(e.slice()))}}function E5(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Rt.fromTimestamp(n===1e9?new rn(r+1,0):new rn(r,n));return new co(s,vt.empty(),e)}function _5(t){return new co(t.readTime,t.key,-1)}class co{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new co(Rt.min(),vt.empty(),-1)}static max(){return new co(Rt.max(),vt.empty(),-1)}}function b5(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=vt.comparator(t.documentKey,e.documentKey),r!==0?r:ir(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class A5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kd(t){if(t.code!==He.FAILED_PRECONDITION||t.message!==S5)throw t;ft("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&kt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new qe((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof qe?r:qe.resolve(r)}catch(r){return qe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):qe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):qe.reject(r)}static resolve(e){return new qe((r,n)=>{r(e)})}static reject(e){return new qe((r,n)=>{n(e)})}static waitFor(e){return new qe((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=qe.resolve(!1);for(const n of e)r=r.next(s=>s?qe.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new qe((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===i&&n(a)},u=>s(u))}})}static doWhile(e,r){return new qe((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function T5(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function qd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}L1.oe=-1;function ap(t){return t==null}function th(t){return t===0&&1/t==-1/0}function w5(t){return typeof t=="number"&&Number.isInteger(t)&&!th(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ul(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function $w(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,r){this.comparator=e,this.root=r||bn.EMPTY}insert(e,r){return new Nr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,bn.BLACK,null,null))}remove(e){return new Nr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Mf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Mf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Mf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Mf(this.root,e,this.comparator,!0)}}class Mf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bn{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??bn.RED,this.left=s??bn.EMPTY,this.right=i??bn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new bn(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return bn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return bn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw kt();const e=this.left.check();if(e!==this.right.check())throw kt();return e+(this.isRed()?0:1)}}bn.EMPTY=null,bn.RED=!0,bn.BLACK=!1;bn.EMPTY=new class{constructor(){this.size=0}get key(){throw kt()}get value(){throw kt()}get color(){throw kt()}get left(){throw kt()}get right(){throw kt()}copy(e,r,n,s,i){return this}insert(e,r,n){return new bn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.comparator=e,this.data=new Nr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new d_(this.data.getIterator())}getIteratorFrom(e){return new d_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof wn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new wn(this.comparator);return r.data=e,r}}class d_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.fields=e,e.sort(mn.comparator)}static empty(){return new Cs([])}unionWith(e){let r=new wn(mn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Cs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return vc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Vw("Invalid base64 string: "+i):i}}(e);return new vn(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new vn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ir(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vn.EMPTY_BYTE_STRING=new vn("");const C5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(t){if(fr(!!t),typeof t=="string"){let e=0;const r=C5.exec(t);if(fr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Wr(t.seconds),nanos:Wr(t.nanos)}}function Wr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zo(t){return typeof t=="string"?vn.fromBase64String(t):vn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function B1(t){const e=t.mapValue.fields.__previous_value__;return ip(e)?B1(e):e}function gd(t){const e=uo(t.mapValue.fields.__local_write_time__.timestampValue);return new rn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(e,r,n,s,i,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class xc{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new xc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof xc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf={mapValue:{}};function el(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ip(t)?4:D5(t)?9007199254740991:k5(t)?10:11:kt()}function Oa(t,e){if(t===e)return!0;const r=el(t);if(r!==el(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gd(t).isEqual(gd(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=uo(s.timestampValue),o=uo(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Zo(s.bytesValue).isEqual(Zo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Wr(s.geoPointValue.latitude)===Wr(i.geoPointValue.latitude)&&Wr(s.geoPointValue.longitude)===Wr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Wr(s.integerValue)===Wr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Wr(s.doubleValue),o=Wr(i.doubleValue);return a===o?th(a)===th(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return vc(t.arrayValue.values||[],e.arrayValue.values||[],Oa);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(u_(a)!==u_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Oa(a[l],o[l])))return!1;return!0}(t,e);default:return kt()}}function vd(t,e){return(t.values||[]).find(r=>Oa(r,e))!==void 0}function yc(t,e){if(t===e)return 0;const r=el(t),n=el(e);if(r!==n)return ir(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ir(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=Wr(i.integerValue||i.doubleValue),l=Wr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return f_(t.timestampValue,e.timestampValue);case 4:return f_(gd(t),gd(e));case 5:return ir(t.stringValue,e.stringValue);case 6:return function(i,a){const o=Zo(i),l=Zo(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=ir(o[c],l[c]);if(u!==0)return u}return ir(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=ir(Wr(i.latitude),Wr(a.latitude));return o!==0?o:ir(Wr(i.longitude),Wr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return h_(t.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,c,u;const f=i.fields||{},h=a.fields||{},p=(o=f.value)===null||o===void 0?void 0:o.arrayValue,m=(l=h.value)===null||l===void 0?void 0:l.arrayValue,v=ir(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:h_(p,m)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Lf.mapValue&&a===Lf.mapValue)return 0;if(i===Lf.mapValue)return 1;if(a===Lf.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const h=ir(l[f],u[f]);if(h!==0)return h;const p=yc(o[l[f]],c[u[f]]);if(p!==0)return p}return ir(l.length,u.length)}(t.mapValue,e.mapValue);default:throw kt()}}function f_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ir(t,e);const r=uo(t),n=uo(e),s=ir(r.seconds,n.seconds);return s!==0?s:ir(r.nanos,n.nanos)}function h_(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=yc(r[s],n[s]);if(i)return i}return ir(r.length,n.length)}function Ec(t){return ov(t)}function ov(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=uo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Zo(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return vt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=ov(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${ov(r.fields[a])}`;return s+"}"}(t.mapValue):kt()}function rh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function lv(t){return!!t&&"integerValue"in t}function U1(t){return!!t&&"arrayValue"in t}function p_(t){return!!t&&"nullValue"in t}function m_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function y0(t){return!!t&&"mapValue"in t}function k5(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Bu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ul(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Bu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Bu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function D5(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this.value=e}static empty(){return new ys({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!y0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bu(r)}setAll(e){let r=mn.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=Bu(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());y0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Oa(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];y0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){ul(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new ys(Bu(this.value))}}function Hw(t){const e=[];return ul(t.fields,(r,n)=>{const s=new mn([r]);if(y0(n)){const i=Hw(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Cs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Vn(e,0,Rt.min(),Rt.min(),Rt.min(),ys.empty(),0)}static newFoundDocument(e,r,n,s){return new Vn(e,1,r,Rt.min(),n,s,0)}static newNoDocument(e,r){return new Vn(e,2,r,Rt.min(),Rt.min(),ys.empty(),0)}static newUnknownDocument(e,r){return new Vn(e,3,r,Rt.min(),Rt.min(),ys.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ys.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ys.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e,r){this.position=e,this.inclusive=r}}function g_(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=vt.comparator(vt.fromName(a.referenceValue),r.key):n=yc(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function v_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Oa(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r="asc"){this.field=e,this.dir=r}}function P5(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{}class en extends jw{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new F5(e,r,n):r==="array-contains"?new M5(e,n):r==="in"?new L5(e,n):r==="not-in"?new B5(e,n):r==="array-contains-any"?new U5(e,n):new en(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new N5(e,n):new O5(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(yc(r,this.value)):r!==null&&el(this.value)===el(r)&&this.matchesComparison(yc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return kt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ha extends jw{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ha(e,r)}matches(e){return Gw(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Gw(t){return t.op==="and"}function Ww(t){return R5(t)&&Gw(t)}function R5(t){for(const e of t.filters)if(e instanceof ha)return!1;return!0}function cv(t){if(t instanceof en)return t.field.canonicalString()+t.op.toString()+Ec(t.value);if(Ww(t))return t.filters.map(e=>cv(e)).join(",");{const e=t.filters.map(r=>cv(r)).join(",");return`${t.op}(${e})`}}function zw(t,e){return t instanceof en?function(n,s){return s instanceof en&&n.op===s.op&&n.field.isEqual(s.field)&&Oa(n.value,s.value)}(t,e):t instanceof ha?function(n,s){return s instanceof ha&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&zw(a,s.filters[o]),!0):!1}(t,e):void kt()}function Kw(t){return t instanceof en?function(r){return`${r.field.canonicalString()} ${r.op} ${Ec(r.value)}`}(t):t instanceof ha?function(r){return r.op.toString()+" {"+r.getFilters().map(Kw).join(" ,")+"}"}(t):"Filter"}class F5 extends en{constructor(e,r,n){super(e,r,n),this.key=vt.fromName(n.referenceValue)}matches(e){const r=vt.comparator(e.key,this.key);return this.matchesComparison(r)}}class N5 extends en{constructor(e,r){super(e,"in",r),this.keys=qw("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class O5 extends en{constructor(e,r){super(e,"not-in",r),this.keys=qw("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function qw(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>vt.fromName(n.referenceValue))}class M5 extends en{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return U1(r)&&vd(r.arrayValue,this.value)}}class L5 extends en{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&vd(this.value.arrayValue,r)}}class B5 extends en{constructor(e,r){super(e,"not-in",r)}matches(e){if(vd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!vd(this.value.arrayValue,r)}}class U5 extends en{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!U1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>vd(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function x_(t,e=null,r=[],n=[],s=null,i=null,a=null){return new $5(t,e,r,n,s,i,a)}function $1(t){const e=Nt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>cv(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),ap(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ec(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ec(n)).join(",")),e.ue=r}return e.ue}function V1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!P5(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!zw(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!v_(t.startAt,e.startAt)&&v_(t.endAt,e.endAt)}function uv(t){return vt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function V5(t,e,r,n,s,i,a,o){return new dl(t,e,r,n,s,i,a,o)}function op(t){return new dl(t)}function y_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function H1(t){return t.collectionGroup!==null}function sc(t){const e=Nt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new wn(mn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new xd(i,n))}),r.has(mn.keyField().canonicalString())||e.ce.push(new xd(mn.keyField(),n))}return e.ce}function Da(t){const e=Nt(t);return e.le||(e.le=H5(e,sc(t))),e.le}function H5(t,e){if(t.limitType==="F")return x_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new xd(s.field,i)});const r=t.endAt?new _c(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new _c(t.startAt.position,t.startAt.inclusive):null;return x_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function dv(t,e){const r=t.filters.concat([e]);return new dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function nh(t,e,r){return new dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function lp(t,e){return V1(Da(t),Da(e))&&t.limitType===e.limitType}function Xw(t){return`${$1(Da(t))}|lt:${t.limitType}`}function Bl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Kw(s)).join(", ")}]`),ap(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Ec(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Ec(s)).join(",")),`Target(${n})`}(Da(t))}; limitType=${t.limitType})`}function cp(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):vt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of sc(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=g_(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,sc(n),s)||n.endAt&&!function(a,o,l){const c=g_(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,sc(n),s))}(t,e)}function j5(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Yw(t){return(e,r)=>{let n=!1;for(const s of sc(t)){const i=G5(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function G5(t,e,r){const n=t.field.isKeyField()?vt.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?yc(l,c):kt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return kt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ul(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return $w(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W5=new Nr(vt.comparator);function Si(){return W5}const Qw=new Nr(vt.comparator);function vu(...t){let e=Qw;for(const r of t)e=e.insert(r.key,r);return e}function Jw(t){let e=Qw;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Oo(){return Uu()}function Zw(){return Uu()}function Uu(){return new Oc(t=>t.toString(),(t,e)=>t.isEqual(e))}const z5=new Nr(vt.comparator),K5=new wn(vt.comparator);function Kt(...t){let e=K5;for(const r of t)e=e.add(r);return e}const q5=new wn(ir);function X5(){return q5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:th(e)?"-0":e}}function eC(t){return{integerValue:""+t}}function Y5(t,e){return w5(e)?eC(e):j1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(){this._=void 0}}function Q5(t,e,r){return t instanceof yd?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ip(i)&&(i=B1(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(r,e):t instanceof Ed?rC(t,e):t instanceof _d?nC(t,e):function(s,i){const a=tC(s,i),o=E_(a)+E_(s.Pe);return lv(a)&&lv(s.Pe)?eC(o):j1(s.serializer,o)}(t,e)}function J5(t,e,r){return t instanceof Ed?rC(t,e):t instanceof _d?nC(t,e):r}function tC(t,e){return t instanceof sh?function(n){return lv(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class yd extends up{}class Ed extends up{constructor(e){super(),this.elements=e}}function rC(t,e){const r=sC(e);for(const n of t.elements)r.some(s=>Oa(s,n))||r.push(n);return{arrayValue:{values:r}}}class _d extends up{constructor(e){super(),this.elements=e}}function nC(t,e){let r=sC(e);for(const n of t.elements)r=r.filter(s=>!Oa(s,n));return{arrayValue:{values:r}}}class sh extends up{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function E_(t){return Wr(t.integerValue||t.doubleValue)}function sC(t){return U1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(e,r){this.field=e,this.transform=r}}function eN(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Ed&&s instanceof Ed||n instanceof _d&&s instanceof _d?vc(n.elements,s.elements,Oa):n instanceof sh&&s instanceof sh?Oa(n.Pe,s.Pe):n instanceof yd&&s instanceof yd}(t.transform,e.transform)}class tN{constructor(e,r){this.version=e,this.transformResults=r}}class cs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new cs}static exists(e){return new cs(void 0,e)}static updateTime(e){return new cs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function E0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class dp{}function aC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new fp(t.key,cs.none()):new Xd(t.key,t.data,cs.none());{const r=t.data,n=ys.empty();let s=new wn(mn.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new go(t.key,n,new Cs(s.toArray()),cs.none())}}function rN(t,e,r){t instanceof Xd?function(s,i,a){const o=s.value.clone(),l=b_(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof go?function(s,i,a){if(!E0(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=b_(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(iC(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function $u(t,e,r,n){return t instanceof Xd?function(i,a,o,l){if(!E0(i.precondition,a))return o;const c=i.value.clone(),u=S_(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof go?function(i,a,o,l){if(!E0(i.precondition,a))return o;const c=S_(i.fieldTransforms,l,a),u=a.data;return u.setAll(iC(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(i,a,o){return E0(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function nN(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=tC(n.transform,s||null);i!=null&&(r===null&&(r=ys.empty()),r.set(n.field,i))}return r||null}function __(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&vc(n,s,(i,a)=>eN(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xd extends dp{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class go extends dp{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function iC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function b_(t,e,r){const n=new Map;fr(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,J5(a,o,r[s]))}return n}function S_(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,Q5(i,a,e))}return n}class fp extends dp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sN extends dp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&rN(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=$u(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=$u(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Zw();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=aC(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Rt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Kt())}isEqual(e){return this.batchId===e.batchId&&vc(this.mutations,e.mutations,(r,n)=>__(r,n))&&vc(this.baseMutations,e.baseMutations,(r,n)=>__(r,n))}}class G1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){fr(e.mutations.length===n.length);let s=function(){return z5}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new G1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yr,er;function lN(t){switch(t){default:return kt();case He.CANCELLED:case He.UNKNOWN:case He.DEADLINE_EXCEEDED:case He.RESOURCE_EXHAUSTED:case He.INTERNAL:case He.UNAVAILABLE:case He.UNAUTHENTICATED:return!1;case He.INVALID_ARGUMENT:case He.NOT_FOUND:case He.ALREADY_EXISTS:case He.PERMISSION_DENIED:case He.FAILED_PRECONDITION:case He.ABORTED:case He.OUT_OF_RANGE:case He.UNIMPLEMENTED:case He.DATA_LOSS:return!0}}function oC(t){if(t===void 0)return bi("GRPC error has no .code"),He.UNKNOWN;switch(t){case Yr.OK:return He.OK;case Yr.CANCELLED:return He.CANCELLED;case Yr.UNKNOWN:return He.UNKNOWN;case Yr.DEADLINE_EXCEEDED:return He.DEADLINE_EXCEEDED;case Yr.RESOURCE_EXHAUSTED:return He.RESOURCE_EXHAUSTED;case Yr.INTERNAL:return He.INTERNAL;case Yr.UNAVAILABLE:return He.UNAVAILABLE;case Yr.UNAUTHENTICATED:return He.UNAUTHENTICATED;case Yr.INVALID_ARGUMENT:return He.INVALID_ARGUMENT;case Yr.NOT_FOUND:return He.NOT_FOUND;case Yr.ALREADY_EXISTS:return He.ALREADY_EXISTS;case Yr.PERMISSION_DENIED:return He.PERMISSION_DENIED;case Yr.FAILED_PRECONDITION:return He.FAILED_PRECONDITION;case Yr.ABORTED:return He.ABORTED;case Yr.OUT_OF_RANGE:return He.OUT_OF_RANGE;case Yr.UNIMPLEMENTED:return He.UNIMPLEMENTED;case Yr.DATA_LOSS:return He.DATA_LOSS;default:return kt()}}(er=Yr||(Yr={}))[er.OK=0]="OK",er[er.CANCELLED=1]="CANCELLED",er[er.UNKNOWN=2]="UNKNOWN",er[er.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",er[er.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",er[er.NOT_FOUND=5]="NOT_FOUND",er[er.ALREADY_EXISTS=6]="ALREADY_EXISTS",er[er.PERMISSION_DENIED=7]="PERMISSION_DENIED",er[er.UNAUTHENTICATED=16]="UNAUTHENTICATED",er[er.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",er[er.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",er[er.ABORTED=10]="ABORTED",er[er.OUT_OF_RANGE=11]="OUT_OF_RANGE",er[er.UNIMPLEMENTED=12]="UNIMPLEMENTED",er[er.INTERNAL=13]="INTERNAL",er[er.UNAVAILABLE=14]="UNAVAILABLE",er[er.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uN=new Ho([4294967295,4294967295],0);function A_(t){const e=cN().encode(t),r=new Rw;return r.update(e),new Uint8Array(r.digest())}function T_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ho([r,n],0),new Ho([s,i],0)]}class W1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new xu(`Invalid padding: ${r}`);if(n<0)throw new xu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new xu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new xu(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Ho.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Ho.fromNumber(n)));return s.compare(uN)===1&&(s=new Ho([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=A_(e),[n,s]=T_(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);if(!this.de(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new W1(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=A_(e),[n,s]=T_(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class xu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Yd.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new hp(Rt.min(),s,new Nr(ir),Si(),Kt())}}class Yd{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Yd(n,r,Kt(),Kt(),Kt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class lC{constructor(e,r){this.targetId=e,this.me=r}}class cC{constructor(e,r,n=vn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class w_{constructor(){this.fe=0,this.ge=I_(),this.pe=vn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Kt(),r=Kt(),n=Kt();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:kt()}}),new Yd(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=I_()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,fr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class dN{constructor(e){this.Le=e,this.Be=new Map,this.ke=Si(),this.qe=C_(),this.Qe=new Nr(ir)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:kt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(uv(i))if(n===0){const a=new vt(i.path);this.Ue(r,a,Vn.newNoDocument(a,Rt.min()))}else fr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=Zo(n).toUint8Array()}catch(l){if(l instanceof Vw)return Jo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new W1(a,s,i)}catch(l){return Jo(l instanceof xu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&uv(o.target)){const l=new vt(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Vn.newNoDocument(l,e))}i.be&&(r.set(a,i.ve()),i.Ce())}});let n=Kt();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new hp(e,r,this.Qe,this.ke,n);return this.ke=Si(),this.qe=C_(),this.Qe=new Nr(ir),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new w_,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new wn(ir),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||ft("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new w_),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function C_(){return new Nr(vt.comparator)}function I_(){return new Nr(vt.comparator)}const fN={asc:"ASCENDING",desc:"DESCENDING"},hN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pN={and:"AND",or:"OR"};class mN{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function fv(t,e){return t.useProto3Json||ap(e)?e:{value:e}}function ah(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function gN(t,e){return ah(t,e.toTimestamp())}function Pa(t){return fr(!!t),Rt.fromTimestamp(function(r){const n=uo(r);return new rn(n.seconds,n.nanos)}(t))}function z1(t,e){return hv(t,e).canonicalString()}function hv(t,e){const r=function(s){return new yr(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function dC(t){const e=yr.fromString(t);return fr(gC(e)),e}function pv(t,e){return z1(t.databaseId,e.path)}function um(t,e){const r=dC(e);if(r.get(1)!==t.databaseId.projectId)throw new st(He.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new st(He.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new vt(hC(r))}function fC(t,e){return z1(t.databaseId,e)}function vN(t){const e=dC(t);return e.length===4?yr.emptyPath():hC(e)}function mv(t){return new yr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function hC(t){return fr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function k_(t,e,r){return{name:pv(t,e),fields:r.value.mapValue.fields}}function xN(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:kt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(fr(u===void 0||typeof u=="string"),vn.fromBase64String(u||"")):(fr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),vn.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?He.UNKNOWN:oC(c.code);return new st(u,c.message||"")}(a);r=new cC(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=um(t,n.document.name),i=Pa(n.document.updateTime),a=n.document.createTime?Pa(n.document.createTime):Rt.min(),o=new ys({mapValue:{fields:n.document.fields}}),l=Vn.newFoundDocument(s,i,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new _0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=um(t,n.document),i=n.readTime?Pa(n.readTime):Rt.min(),a=Vn.newNoDocument(s,i),o=n.removedTargetIds||[];r=new _0([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=um(t,n.document),i=n.removedTargetIds||[];r=new _0([],i,s,null)}else{if(!("filter"in e))return kt();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new oN(s,i),o=n.targetId;r=new lC(o,a)}}return r}function yN(t,e){let r;if(e instanceof Xd)r={update:k_(t,e.key,e.value)};else if(e instanceof fp)r={delete:pv(t,e.key)};else if(e instanceof go)r={update:k_(t,e.key,e.data),updateMask:IN(e.fieldMask)};else{if(!(e instanceof sN))return kt();r={verify:pv(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof yd)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ed)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof _d)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof sh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw kt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:gN(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:kt()}(t,e.precondition)),r}function EN(t,e){return t&&t.length>0?(fr(e!==void 0),t.map(r=>function(s,i){let a=s.updateTime?Pa(s.updateTime):Pa(i);return a.isEqual(Rt.min())&&(a=Pa(i)),new tN(a,s.transformResults||[])}(r,e))):[]}function _N(t,e){return{documents:[fC(t,e.path)]}}function bN(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=fC(t,s);const i=function(c){if(c.length!==0)return mC(ha.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:Ul(h.field),direction:TN(h.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=fv(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:s}}function SN(t){let e=vN(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){fr(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(f){const h=pC(f);return h instanceof ha&&Ww(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(h=>function(m){return new xd($l(m.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(f){let h;return h=typeof f=="object"?f.value:f,ap(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(f){const h=!!f.before,p=f.values||[];return new _c(p,h)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const h=!f.before,p=f.values||[];return new _c(p,h)}(r.endAt)),V5(e,s,a,i,o,"F",l,c)}function AN(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return kt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function pC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=$l(r.unaryFilter.field);return en.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=$l(r.unaryFilter.field);return en.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=$l(r.unaryFilter.field);return en.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=$l(r.unaryFilter.field);return en.create(a,"!=",{nullValue:"NULL_VALUE"});default:return kt()}}(t):t.fieldFilter!==void 0?function(r){return en.create($l(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return kt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ha.create(r.compositeFilter.filters.map(n=>pC(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return kt()}}(r.compositeFilter.op))}(t):kt()}function TN(t){return fN[t]}function wN(t){return hN[t]}function CN(t){return pN[t]}function Ul(t){return{fieldPath:t.canonicalString()}}function $l(t){return mn.fromServerFormat(t.fieldPath)}function mC(t){return t instanceof en?function(r){if(r.op==="=="){if(m_(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NAN"}};if(p_(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(m_(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NOT_NAN"}};if(p_(r.value))return{unaryFilter:{field:Ul(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ul(r.field),op:wN(r.op),value:r.value}}}(t):t instanceof ha?function(r){const n=r.getFilters().map(s=>mC(s));return n.length===1?n[0]:{compositeFilter:{op:CN(r.op),filters:n}}}(t):kt()}function IN(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function gC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,r,n,s,i=Rt.min(),a=Rt.min(),o=vn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Xi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Xi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.ct=e}}function DN(t){const e=SN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?nh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(){this.un=new RN}addToCollectionParentIndex(e,r){return this.un.add(r),qe.resolve()}getCollectionParents(e,r){return qe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return qe.resolve()}deleteFieldIndex(e,r){return qe.resolve()}deleteAllFieldIndexes(e){return qe.resolve()}createTargetIndexes(e,r){return qe.resolve()}getDocumentsMatchingTarget(e,r){return qe.resolve(null)}getIndexType(e,r){return qe.resolve(0)}getFieldIndexes(e,r){return qe.resolve([])}getNextCollectionGroupToUpdate(e){return qe.resolve(null)}getMinOffset(e,r){return qe.resolve(co.min())}getMinOffsetFromCollectionGroup(e,r){return qe.resolve(co.min())}updateCollectionGroup(e,r,n){return qe.resolve()}updateIndexEntries(e,r){return qe.resolve()}}class RN{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new wn(yr.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new wn(yr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new bc(0)}static kn(){return new bc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(){this.changes=new Oc(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Vn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?qe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&$u(n.mutation,s,Cs.empty(),rn.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Kt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Kt()){const s=Oo();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=vu();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Oo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Kt()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=Si();const a=Uu(),o=function(){return Uu()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof go)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),$u(u.mutation,c,u.mutation.getFieldMask(),rn.now())):a.set(c.key,Cs.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var f;return o.set(c,new NN(u,(f=a.get(c))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Uu();let s=new Nr((a,o)=>a-o),i=Kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Cs.empty();u=o.applyToLocalView(c,u),n.set(l,u);const f=(s.get(o.batchId)||Kt()).add(l);s=s.insert(o.batchId,f)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,f=Zw();u.forEach(h=>{if(!i.has(h)){const p=aC(r.get(h),n.get(h));p!==null&&f.set(h,p),i=i.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,f))}return qe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return vt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):H1(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):qe.resolve(Oo());let o=-1,l=i;return a.next(c=>qe.forEach(c,(u,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),i.get(u)?qe.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Kt())).next(u=>({batchId:o,changes:Jw(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new vt(r)).next(n=>{let s=vu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=vu();return this.indexManager.getCollectionParents(e,i).next(o=>qe.forEach(o,l=>{const c=function(f,h){return new dl(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((f,h)=>{a=a.insert(f,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Vn.newInvalidDocument(u)))});let o=vu();return a.forEach((l,c)=>{const u=i.get(l);u!==void 0&&$u(u.mutation,c,Cs.empty(),rn.now()),cp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return qe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Pa(s.createTime)}}(r)),qe.resolve()}getNamedQuery(e,r){return qe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:DN(s.bundledQuery),readTime:Pa(s.readTime)}}(r)),qe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(){this.overlays=new Nr(vt.comparator),this.Ir=new Map}getOverlay(e,r){return qe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Oo();return qe.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),qe.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),qe.resolve()}getOverlaysForCollection(e,r,n){const s=Oo(),i=r.length+1,a=new vt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return qe.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Nr((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Oo(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Oo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return qe.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new iN(r,n));let i=this.Ir.get(r);i===void 0&&(i=Kt(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(){this.sessionToken=vn.EMPTY_BYTE_STRING}getSessionToken(e){return qe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,qe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(){this.Tr=new wn(fn.Er),this.dr=new wn(fn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new fn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new fn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new vt(new yr([])),n=new fn(r,e),s=new fn(r,e+1),i=[];return this.dr.forEachInRange([n,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new vt(new yr([])),n=new fn(r,e),s=new fn(r,e+1);let i=Kt();return this.dr.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new fn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class fn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return vt.comparator(e.key,r.key)||ir(e.wr,r.wr)}static Ar(e,r){return ir(e.wr,r.wr)||vt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new wn(fn.Er)}checkEmpty(e){return qe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new aN(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new fn(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return qe.resolve(a)}lookupMutationBatch(e,r){return qe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return qe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return qe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return qe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new fn(r,0),s=new fn(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],a=>{const o=this.Dr(a.wr);i.push(o)}),qe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new wn(ir);return r.forEach(s=>{const i=new fn(s,0),a=new fn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{n=n.add(o.wr)})}),qe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;vt.isDocumentKey(i)||(i=i.child(""));const a=new fn(new vt(i),0);let o=new wn(ir);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},a),qe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){fr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return qe.forEach(r.mutations,s=>{const i=new fn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new fn(r,0),s=this.br.firstAfterOrEqual(n);return qe.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,qe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(e){this.Mr=e,this.docs=function(){return new Nr(vt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return qe.resolve(n?n.document.mutableCopy():Vn.newInvalidDocument(r))}getEntries(e,r){let n=Si();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Vn.newInvalidDocument(s))}),qe.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Si();const a=r.path,o=new vt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||b5(_5(u),n)<=0||(s.has(u.key)||cp(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return qe.resolve(i)}getAllFromCollectionGroup(e,r,n,s){kt()}Or(e,r){return qe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new VN(this)}getSize(e){return qe.resolve(this.size)}}class VN extends FN{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),qe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.persistence=e,this.Nr=new Oc(r=>$1(r),V1),this.lastRemoteSnapshotVersion=Rt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new K1,this.targetCount=0,this.kr=bc.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),qe.resolve()}getLastRemoteSnapshotVersion(e){return qe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return qe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),qe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),qe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new bc(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,qe.resolve()}updateTargetData(e,r){return this.Kn(r),qe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,qe.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),qe.waitFor(i).next(()=>s)}getTargetCount(e){return qe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return qe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),qe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),qe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),qe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return qe.resolve(n)}containsKey(e,r){return qe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e,r){this.qr={},this.overlays={},this.Qr=new L1(0),this.Kr=!1,this.Kr=!0,this.$r=new BN,this.referenceDelegate=e(this),this.Ur=new HN(this),this.indexManager=new PN,this.remoteDocumentCache=function(s){return new $N(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new kN(r),this.Gr=new MN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new LN,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new UN(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){ft("MemoryPersistence","Starting transaction:",e);const s=new GN(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return qe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class GN extends A5{constructor(e){super(),this.currentSequenceNumber=e}}class q1{constructor(e){this.persistence=e,this.Jr=new K1,this.Yr=null}static Zr(e){return new q1(e)}get Xr(){if(this.Yr)return this.Yr;throw kt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),qe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),qe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),qe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qe.forEach(this.Xr,n=>{const s=vt.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,Rt.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return qe.or([()=>qe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Kt(),s=Kt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new X1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return l8()?8:T5(Yn())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new WN;return this.Xi(e,r,a).next(o=>{if(i.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(ru()<=Xt.DEBUG&&ft("QueryEngine","SDK will not create cache indexes for query:",Bl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),qe.resolve()):(ru()<=Xt.DEBUG&&ft("QueryEngine","Query:",Bl(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(ru()<=Xt.DEBUG&&ft("QueryEngine","The SDK decides to create cache indexes for query:",Bl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Da(r))):qe.resolve())}Yi(e,r){if(y_(r))return qe.resolve(null);let n=Da(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=nh(r,null,"F"),n=Da(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Kt(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,nh(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,s){return y_(r)||s.isEqual(Rt.min())?qe.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const a=this.ts(r,i);return this.ns(r,a,n,s)?qe.resolve(null):(ru()<=Xt.DEBUG&&ft("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Bl(r)),this.rs(e,a,r,E5(s,-1)).next(o=>o))})}ts(e,r){let n=new wn(Yw(e));return r.forEach((s,i)=>{cp(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return ru()<=Xt.DEBUG&&ft("QueryEngine","Using full collection scan to execute query:",Bl(r)),this.Ji.getDocumentsMatchingQuery(e,r,co.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Nr(ir),this._s=new Oc(i=>$1(i),V1),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ON(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function qN(t,e,r,n){return new KN(t,e,r,n)}async function vC(t,e){const r=Nt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=Kt();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function XN(t,e){const r=Nt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const f=c.batch,h=f.keys();let p=qe.resolve();return h.forEach(m=>{p=p.next(()=>u.getEntry(l,m)).next(v=>{const g=c.docVersions.get(m);fr(g!==null),v.version.compareTo(g)<0&&(f.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Kt();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function xC(t){const e=Nt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function YN(t,e){const r=Nt(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((u,f)=>{const h=s.get(f);if(!h)return;o.push(r.Ur.removeMatchingKeys(i,u.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(i,u.addedDocuments,f)));let p=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(vn.EMPTY_BYTE_STRING,Rt.min()).withLastLimboFreeSnapshotVersion(Rt.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(f,p),function(v,g,y){return v.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(h,p,u)&&o.push(r.Ur.updateTargetData(i,p))});let l=Si(),c=Kt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),o.push(QN(i,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Rt.min())){const u=r.Ur.getLastRemoteSnapshotVersion(i).next(f=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(u)}return qe.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.os=s,i))}function QN(t,e,r){let n=Kt(),s=Kt();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=Si();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Rt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):ft("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function JN(t,e){const r=Nt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function ZN(t,e){const r=Nt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,qe.resolve(s)):r.Ur.allocateTargetId(n).next(a=>(s=new Xi(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function gv(t,e,r){const n=Nt(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!qd(a))throw a;ft("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function D_(t,e,r){const n=Nt(t);let s=Rt.min(),i=Kt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const f=Nt(l),h=f._s.get(u);return h!==void 0?qe.resolve(f.os.get(h)):f.Ur.getTargetData(c,u)}(n,a,Da(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?s:Rt.min(),r?i:Kt())).next(o=>(eO(n,j5(e),o),{documents:o,Ts:i})))}function eO(t,e,r){let n=t.us.get(e)||Rt.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class P_{constructor(){this.activeTargetIds=X5()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tO{constructor(){this.so=new P_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new P_,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ft("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ft("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bf=null;function dm(){return Bf===null?Bf=function(){return 268435456+Math.round(2147483648*Math.random())}():Bf++,"0x"+Bf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn="WebChannelConnection";class aO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,a){const o=dm(),l=this.xo(r,n.toUriEncodedString());ft("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,a),this.No(r,l,c,s).then(u=>(ft("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw Jo("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,i,a,o){return this.Mo(r,n,s,i,a)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Nc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>r[a]=i),s&&s.headers.forEach((i,a)=>r[a]=i)}xo(r,n){const s=nO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=dm();return new Promise((a,o)=>{const l=new Fw;l.setWithCredentials(!0),l.listenOnce(Nw.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case x0.NO_ERROR:const u=l.getResponseJson();ft(Fn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),a(u);break;case x0.TIMEOUT:ft(Fn,`RPC '${e}' ${i} timed out`),o(new st(He.DEADLINE_EXCEEDED,"Request time out"));break;case x0.HTTP_ERROR:const f=l.getStatus();if(ft(Fn,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const m=function(g){const y=g.toLowerCase().replace(/_/g,"-");return Object.values(He).indexOf(y)>=0?y:He.UNKNOWN}(p.status);o(new st(m,p.message))}else o(new st(He.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new st(He.UNAVAILABLE,"Connection failed."));break;default:kt()}}finally{ft(Fn,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);ft(Fn,`RPC '${e}' ${i} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const s=dm(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Lw(),o=Mw(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=i.join("");ft(Fn,`Creating RPC '${e}' stream ${s}: ${u}`,l);const f=a.createWebChannel(u,l);let h=!1,p=!1;const m=new sO({Io:g=>{p?ft(Fn,`Not sending because RPC '${e}' stream ${s} is closed:`,g):(h||(ft(Fn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),h=!0),ft(Fn,`RPC '${e}' stream ${s} sending:`,g),f.send(g))},To:()=>f.close()}),v=(g,y,E)=>{g.listen(y,b=>{try{E(b)}catch(k){setTimeout(()=>{throw k},0)}})};return v(f,gu.EventType.OPEN,()=>{p||(ft(Fn,`RPC '${e}' stream ${s} transport opened.`),m.yo())}),v(f,gu.EventType.CLOSE,()=>{p||(p=!0,ft(Fn,`RPC '${e}' stream ${s} transport closed`),m.So())}),v(f,gu.EventType.ERROR,g=>{p||(p=!0,Jo(Fn,`RPC '${e}' stream ${s} transport errored:`,g),m.So(new st(He.UNAVAILABLE,"The operation could not be completed")))}),v(f,gu.EventType.MESSAGE,g=>{var y;if(!p){const E=g.data[0];fr(!!E);const b=E,k=b.error||((y=b[0])===null||y===void 0?void 0:y.error);if(k){ft(Fn,`RPC '${e}' stream ${s} received error:`,k);const P=k.status;let w=function(_){const A=Yr[_];if(A!==void 0)return oC(A)}(P),x=k.message;w===void 0&&(w=He.INTERNAL,x="Unknown error status: "+P+" with message "+k.message),p=!0,m.So(new st(w,x)),f.close()}else ft(Fn,`RPC '${e}' stream ${s} received:`,E),m.bo(E)}}),v(o,Ow.STAT_EVENT,g=>{g.stat===iv.PROXY?ft(Fn,`RPC '${e}' stream ${s} detected buffering proxy`):g.stat===iv.NOPROXY&&ft(Fn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}function fm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t){return new mN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&ft("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,r,n,s,i,a,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new yC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===He.RESOURCE_EXHAUSTED?(bi(r.toString()),bi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===He.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new st(He.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ft("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(ft("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class iO extends EC{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=xN(this.serializer,e),n=function(i){if(!("targetChange"in i))return Rt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Rt.min():a.readTime?Pa(a.readTime):Rt.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=mv(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=uv(l)?{documents:_N(i,l)}:{query:bN(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=uC(i,a.resumeToken);const c=fv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Rt.min())>0){o.readTime=ah(i,a.snapshotVersion.toTimestamp());const c=fv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=AN(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=mv(this.serializer),r.removeTarget=e,this.a_(r)}}class oO extends EC{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return fr(!!e.streamToken),this.lastStreamToken=e.streamToken,fr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){fr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=EN(e.writeResults,e.commitTime),n=Pa(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=mv(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>yN(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new st(He.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,hv(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new st(He.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,hv(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new st(He.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class cO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(bi(r),this.D_=!1):ft("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{n.enqueueAndForget(async()=>{fl(this)&&(ft("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Nt(l);c.L_.add(4),await Qd(c),c.q_.set("Unknown"),c.L_.delete(4),await mp(c)}(this))})}),this.q_=new cO(n,s)}}async function mp(t){if(fl(t))for(const e of t.B_)await e(!0)}async function Qd(t){for(const e of t.B_)await e(!1)}function _C(t,e){const r=Nt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Z1(r)?J1(r):Mc(r).r_()&&Q1(r,e))}function Y1(t,e){const r=Nt(t),n=Mc(r);r.N_.delete(e),n.r_()&&bC(r,e),r.N_.size===0&&(n.r_()?n.o_():fl(r)&&r.q_.set("Unknown"))}function Q1(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Rt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Mc(t).A_(e)}function bC(t,e){t.Q_.xe(e),Mc(t).R_(e)}function J1(t){t.Q_=new dN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Mc(t).start(),t.q_.v_()}function Z1(t){return fl(t)&&!Mc(t).n_()&&t.N_.size>0}function fl(t){return Nt(t).L_.size===0}function SC(t){t.Q_=void 0}async function dO(t){t.q_.set("Online")}async function fO(t){t.N_.forEach((e,r)=>{Q1(t,e)})}async function hO(t,e){SC(t),Z1(t)?(t.q_.M_(e),J1(t)):t.q_.set("Unknown")}async function pO(t,e,r){if(t.q_.set("Online"),e instanceof cC&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){ft("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ih(t,n)}else if(e instanceof _0?t.Q_.Ke(e):e instanceof lC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Rt.min()))try{const n=await xC(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(vn.EMPTY_BYTE_STRING,u.snapshotVersion)),bC(i,l);const f=new Xi(u.target,l,c,u.sequenceNumber);Q1(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){ft("RemoteStore","Failed to raise snapshot:",n),await ih(t,n)}}async function ih(t,e,r){if(!qd(e))throw e;t.L_.add(1),await Qd(t),t.q_.set("Offline"),r||(r=()=>xC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ft("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await mp(t)})}function AC(t,e){return e().catch(r=>ih(t,r,e))}async function gp(t){const e=Nt(t),r=fo(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;mO(e);)try{const s=await JN(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,gO(e,s)}catch(s){await ih(e,s)}TC(e)&&wC(e)}function mO(t){return fl(t)&&t.O_.length<10}function gO(t,e){t.O_.push(e);const r=fo(t);r.r_()&&r.V_&&r.m_(e.mutations)}function TC(t){return fl(t)&&!fo(t).n_()&&t.O_.length>0}function wC(t){fo(t).start()}async function vO(t){fo(t).p_()}async function xO(t){const e=fo(t);for(const r of t.O_)e.m_(r.mutations)}async function yO(t,e,r){const n=t.O_.shift(),s=G1.from(n,e,r);await AC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await gp(t)}async function EO(t,e){e&&fo(t).V_&&await async function(n,s){if(function(a){return lN(a)&&a!==He.ABORTED}(s.code)){const i=n.O_.shift();fo(n).s_(),await AC(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await gp(n)}}(t,e),TC(t)&&wC(t)}async function F_(t,e){const r=Nt(t);r.asyncQueue.verifyOperationInProgress(),ft("RemoteStore","RemoteStore received new credentials");const n=fl(r);r.L_.add(3),await Qd(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await mp(r)}async function _O(t,e){const r=Nt(t);e?(r.L_.delete(2),await mp(r)):e||(r.L_.add(2),await Qd(r),r.q_.set("Unknown"))}function Mc(t){return t.K_||(t.K_=function(r,n,s){const i=Nt(r);return i.w_(),new iO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:dO.bind(null,t),Ro:fO.bind(null,t),mo:hO.bind(null,t),d_:pO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Z1(t)?J1(t):t.q_.set("Unknown")):(await t.K_.stop(),SC(t))})),t.K_}function fo(t){return t.U_||(t.U_=function(r,n,s){const i=Nt(r);return i.w_(),new oO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:vO.bind(null,t),mo:EO.bind(null,t),f_:xO.bind(null,t),g_:yO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await gp(t)):(await t.U_.stop(),t.O_.length>0&&(ft("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new ex(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new st(He.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tx(t,e){if(bi("AsyncQueue",`${e}: ${t}`),qd(t))return new st(He.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e){this.comparator=e?(r,n)=>e(r,n)||vt.comparator(r.key,n.key):(r,n)=>vt.comparator(r.key,n.key),this.keyedMap=vu(),this.sortedSet=new Nr(this.comparator)}static emptySet(e){return new ac(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ac)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ac;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(){this.W_=new Nr(vt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):kt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Sc{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Sc(e,r,ac.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class SO{constructor(){this.queries=O_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Nt(r),i=s.queries;s.queries=O_(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new st(He.ABORTED,"Firestore shutting down"))}}function O_(){return new Oc(t=>Xw(t),lp)}async function rx(t,e){const r=Nt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new bO,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=tx(a,`Initialization of query '${Bl(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&sx(r)}async function nx(t,e){const r=Nt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function AO(t,e){const r=Nt(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(n=!0);a.z_=s}}n&&sx(r)}function TO(t,e,r){const n=Nt(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function sx(t){t.Y_.forEach(e=>{e.next()})}var vv,M_;(M_=vv||(vv={})).ea="default",M_.Cache="cache";class ax{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Sc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Sc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==vv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e){this.key=e}}class IC{constructor(e){this.key=e}}class wO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Kt(),this.mutatedKeys=Kt(),this.Aa=Yw(e),this.Ra=new ac(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new N_,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const h=s.get(u),p=cp(this.query,f)?f:null,m=!!h&&this.mutatedKeys.has(h.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;h&&p?h.data.isEqual(p.data)?m!==v&&(n.track({type:3,doc:p}),g=!0):this.ga(h,p)||(n.track({type:2,doc:p}),g=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!h&&p?(n.track({type:0,doc:p}),g=!0):h&&!p&&(n.track({type:1,doc:h}),g=!0,(l||c)&&(o=!0)),g&&(p?(a=a.add(p),i=v?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,f)=>function(p,m){const v=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kt()}};return v(p)-v(m)}(u.type,f.type)||this.Aa(u.doc,f.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new Sc(this.query,e.Ra,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new N_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Kt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new IC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new CC(n))}),r}ba(e){this.Ta=e.Ts,this.da=Kt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Sc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class CO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class IO{constructor(e){this.key=e,this.va=!1}}class kO{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Oc(o=>Xw(o),lp),this.Ma=new Map,this.xa=new Set,this.Oa=new Nr(vt.comparator),this.Na=new Map,this.La=new K1,this.Ba={},this.ka=new Map,this.qa=bc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function DO(t,e,r=!0){const n=NC(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await kC(n,e,r,!0),s}async function PO(t,e){const r=NC(t);await kC(r,e,!0,!1)}async function kC(t,e,r,n){const s=await ZN(t.localStore,Da(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await RO(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&_C(t.remoteStore,s),o}async function RO(t,e,r,n,s){t.Ka=(f,h,p)=>async function(v,g,y,E){let b=g.view.ma(y);b.ns&&(b=await D_(v.localStore,g.query,!1).then(({documents:x})=>g.view.ma(x,b)));const k=E&&E.targetChanges.get(g.targetId),P=E&&E.targetMismatches.get(g.targetId)!=null,w=g.view.applyChanges(b,v.isPrimaryClient,k,P);return B_(v,g.targetId,w.wa),w.snapshot}(t,f,h,p);const i=await D_(t.localStore,e,!0),a=new wO(e,i.Ts),o=a.ma(i.documents),l=Yd.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);B_(t,r,c.wa);const u=new CO(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function FO(t,e,r){const n=Nt(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(a=>!lp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await gv(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Y1(n.remoteStore,s.targetId),xv(n,s.targetId)}).catch(Kd)):(xv(n,s.targetId),await gv(n.localStore,s.targetId,!0))}async function NO(t,e){const r=Nt(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Y1(r.remoteStore,n.targetId))}async function OO(t,e,r){const n=HO(t);try{const s=await function(a,o){const l=Nt(a),c=rn.now(),u=o.reduce((p,m)=>p.add(m.key),Kt());let f,h;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let m=Si(),v=Kt();return l.cs.getEntries(p,u).next(g=>{m=g,m.forEach((y,E)=>{E.isValidDocument()||(v=v.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,m)).next(g=>{f=g;const y=[];for(const E of o){const b=nN(E,f.get(E.key).overlayedDocument);b!=null&&y.push(new go(E.key,b,Hw(b.value.mapValue),cs.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,y,o)}).next(g=>{h=g;const y=g.applyToLocalDocumentSet(f,v);return l.documentOverlayCache.saveOverlays(p,g.batchId,y)})}).then(()=>({batchId:h.batchId,changes:Jw(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Nr(ir)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,s.batchId,r),await Jd(n,s.changes),await gp(n.remoteStore)}catch(s){const i=tx(s,"Failed to persist write");r.reject(i)}}async function DC(t,e){const r=Nt(t);try{const n=await YN(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Na.get(i);a&&(fr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?fr(a.va):s.removedDocuments.size>0&&(fr(a.va),a.va=!1))}),await Jd(r,n,e)}catch(n){await Kd(n)}}function L_(t,e,r){const n=Nt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Nt(a);l.onlineState=o;let c=!1;l.queries.forEach((u,f)=>{for(const h of f.j_)h.Z_(o)&&(c=!0)}),c&&sx(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function MO(t,e,r){const n=Nt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let a=new Nr(vt.comparator);a=a.insert(i,Vn.newNoDocument(i,Rt.min()));const o=Kt().add(i),l=new hp(Rt.min(),new Map,new Nr(ir),a,o);await DC(n,l),n.Oa=n.Oa.remove(i),n.Na.delete(e),ix(n)}else await gv(n.localStore,e,!1).then(()=>xv(n,e,r)).catch(Kd)}async function LO(t,e){const r=Nt(t),n=e.batch.batchId;try{const s=await XN(r.localStore,e);RC(r,n,null),PC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Jd(r,s)}catch(s){await Kd(s)}}async function BO(t,e,r){const n=Nt(t);try{const s=await function(a,o){const l=Nt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(f=>(fr(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);RC(n,e,r),PC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Jd(n,s)}catch(s){await Kd(s)}}function PC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function RC(t,e,r){const n=Nt(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function xv(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||FC(t,n)})}function FC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Y1(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),ix(t))}function B_(t,e,r){for(const n of r)n instanceof CC?(t.La.addReference(n.key,e),UO(t,n)):n instanceof IC?(ft("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||FC(t,n.key)):kt()}function UO(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(ft("SyncEngine","New document in limbo: "+r),t.xa.add(n),ix(t))}function ix(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new vt(yr.fromString(e)),n=t.qa.next();t.Na.set(n,new IO(r)),t.Oa=t.Oa.insert(r,n),_C(t.remoteStore,new Xi(Da(op(r.path)),n,"TargetPurposeLimboResolution",L1.oe))}}async function Jd(t,e,r){const n=Nt(t),s=[],i=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const f=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=X1.Wi(l.targetId,c);i.push(f)}}))}),await Promise.all(a),n.Ca.d_(s),await async function(l,c){const u=Nt(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>qe.forEach(c,h=>qe.forEach(h.$i,p=>u.persistence.referenceDelegate.addReference(f,h.targetId,p)).next(()=>qe.forEach(h.Ui,p=>u.persistence.referenceDelegate.removeReference(f,h.targetId,p)))))}catch(f){if(!qd(f))throw f;ft("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const h=f.targetId;if(!f.fromCache){const p=u.os.get(h),m=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(m);u.os=u.os.insert(h,v)}}}(n.localStore,i))}async function $O(t,e){const r=Nt(t);if(!r.currentUser.isEqual(e)){ft("SyncEngine","User change. New user:",e.toKey());const n=await vC(r.localStore,e);r.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new st(He.CANCELLED,a))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Jd(r,n.hs)}}function VO(t,e){const r=Nt(t),n=r.Na.get(e);if(n&&n.va)return Kt().add(n.key);{let s=Kt();const i=r.Ma.get(e);if(!i)return s;for(const a of i){const o=r.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function NC(t){const e=Nt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=DC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MO.bind(null,e),e.Ca.d_=AO.bind(null,e.eventManager),e.Ca.$a=TO.bind(null,e.eventManager),e}function HO(t){const e=Nt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BO.bind(null,e),e}class oh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return qN(this.persistence,new zN,e.initialUser,this.serializer)}Ga(e){return new jN(q1.Zr,this.serializer)}Wa(e){return new tO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oh.provider={build:()=>new oh};class yv{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>L_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=$O.bind(null,this.syncEngine),await _O(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new SO}()}createDatastore(e){const r=pp(e.databaseInfo.databaseId),n=function(i){return new aO(i)}(e.databaseInfo);return function(i,a,o,l){return new lO(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new uO(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>L_(this.syncEngine,r,0),function(){return R_.D()?new R_:new rO}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,u){const f=new kO(s,i,a,o,l,c);return u&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Nt(s);ft("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Qd(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}yv.provider={build:()=>new yv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):bi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Bn.UNAUTHENTICATED,this.clientId=M1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{ft("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(ft("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=tx(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function hm(t,e){t.asyncQueue.verifyOperationInProgress(),ft("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await vC(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function U_(t,e){t.asyncQueue.verifyOperationInProgress();const r=await GO(t);ft("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>F_(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>F_(e.remoteStore,s)),t._onlineComponents=e}async function GO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ft("FirestoreClient","Using user provided OfflineComponentProvider");try{await hm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===He.FAILED_PRECONDITION||s.code===He.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Jo("Error using user provided cache. Falling back to memory cache: "+r),await hm(t,new oh)}}else ft("FirestoreClient","Using default OfflineComponentProvider"),await hm(t,new oh);return t._offlineComponents}async function OC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ft("FirestoreClient","Using user provided OnlineComponentProvider"),await U_(t,t._uninitializedComponentsProvider._online)):(ft("FirestoreClient","Using default OnlineComponentProvider"),await U_(t,new yv))),t._onlineComponents}function WO(t){return OC(t).then(e=>e.syncEngine)}async function lh(t){const e=await OC(t),r=e.eventManager;return r.onListen=DO.bind(null,e.syncEngine),r.onUnlisten=FO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=PO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=NO.bind(null,e.syncEngine),r}function zO(t,e,r={}){const n=new ci;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new ox({next:h=>{u.Za(),a.enqueueAndForget(()=>nx(i,f));const p=h.docs.has(o);!p&&h.fromCache?c.reject(new st(He.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&h.fromCache&&l&&l.source==="server"?c.reject(new st(He.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new ax(op(o.path),u,{includeMetadataChanges:!0,_a:!0});return rx(i,f)}(await lh(t),t.asyncQueue,e,r,n)),n.promise}function KO(t,e,r={}){const n=new ci;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new ox({next:h=>{u.Za(),a.enqueueAndForget(()=>nx(i,f)),h.fromCache&&l.source==="server"?c.reject(new st(He.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new ax(o,u,{includeMetadataChanges:!0,_a:!0});return rx(i,f)}(await lh(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(t,e,r){if(!r)throw new st(He.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function BC(t,e,r,n){if(e===!0&&n===!0)throw new st(He.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function V_(t){if(!vt.isDocumentKey(t))throw new st(He.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function H_(t){if(vt.isDocumentKey(t))throw new st(He.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function vp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":kt()}function qn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new st(He.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=vp(t);throw new st(He.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function qO(t,e){if(e<=0)throw new st(He.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new st(He.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new st(He.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=MC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new st(He.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new st(He.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new st(He.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xp{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new j_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new st(He.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new st(He.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new j_(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Uw;switch(n.type){case"firstParty":return new m5(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new st(He.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=$_.get(r);n&&(ft("ComponentProvider","Removing Datastore"),$_.delete(r),n.terminate())}(this),Promise.resolve()}}function UC(t,e,r,n={}){var s;const i=(t=qn(t,xp))._getSettings(),a=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&Jo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Bn.MOCK_USER;else{o=$T(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new st(He.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Bn(c)}t._authCredentials=new f5(new Bw(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new va(this.firestore,e,this._query)}}class Cn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ui(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Cn(this.firestore,e,this._key)}}class ui extends va{constructor(e,r,n){super(e,r,op(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Cn(this.firestore,null,new vt(e))}withConverter(e){return new ui(this.firestore,e,this._path)}}function bt(t,e,...r){if(t=lr(t),LC("collection","path",e),t instanceof xp){const n=yr.fromString(e,...r);return H_(n),new ui(t,null,n)}{if(!(t instanceof Cn||t instanceof ui))throw new st(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yr.fromString(e,...r));return H_(n),new ui(t.firestore,null,n)}}function Ze(t,e,...r){if(t=lr(t),arguments.length===1&&(e=M1.newId()),LC("doc","path",e),t instanceof xp){const n=yr.fromString(e,...r);return V_(n),new Cn(t,null,new vt(n))}{if(!(t instanceof Cn||t instanceof ui))throw new st(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yr.fromString(e,...r));return V_(n),new Cn(t.firestore,t instanceof ui?t.converter:null,new vt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new yC(this,"async_queue_retry"),this.Vu=()=>{const n=fm();n&&ft("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=fm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=fm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ci;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!qd(e))throw e;ft("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw bi("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=ex.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&kt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function W_(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class pa extends xp{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new G_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new G_(e),this._firestoreClient=void 0,await e}}}function vo(t,e){const r=typeof t=="object"?t:jd(),n=typeof t=="string"?t:"(default)",s=Hd(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=x1("firestore");i&&UC(s,...i)}return s}function Lc(t){if(t._terminated)throw new st(He.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||XO(t),t._firestoreClient}function XO(t){var e,r,n;const s=t._freezeSettings(),i=function(o,l,c,u){return new I5(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,MC(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new jO(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tl(vn.fromBase64String(e))}catch(r){throw new st(He.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new tl(vn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new st(He.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new st(He.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new st(He.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ir(this._lat,e._lat)||ir(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=/^__.*__$/;class QO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new go(e,this.data,this.fieldMask,r,this.fieldTransforms):new Xd(e,this.data,r,this.fieldTransforms)}}class $C{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new go(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function VC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kt()}}class lx{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new lx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return ch(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(VC(this.Cu)&&YO.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class JO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||pp(e)}Qu(e,r,n,s=!1){return new lx({Cu:e,methodName:r,qu:n,path:mn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uc(t){const e=t._freezeSettings(),r=pp(t._databaseId);return new JO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function cx(t,e,r,n,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);dx("Data must be an object, but it was:",a,n);const o=WC(n,a);let l,c;if(i.merge)l=new Cs(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const h=Ev(e,f,r);if(!a.contains(h))throw new st(He.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);KC(u,h)||u.push(h)}l=new Cs(u),c=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=a.fieldTransforms;return new QO(new ys(o),l,c)}class _p extends Zd{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _p}}class ux extends Zd{_toFieldTransform(e){return new Z5(e.path,new yd)}isEqual(e){return e instanceof ux}}function HC(t,e,r,n){const s=t.Qu(1,e,r);dx("Data must be an object, but it was:",s,n);const i=[],a=ys.empty();ul(n,(l,c)=>{const u=fx(e,l,r);c=lr(c);const f=s.Nu(u);if(c instanceof _p)i.push(u);else{const h=ef(c,f);h!=null&&(i.push(u),a.set(u,h))}});const o=new Cs(i);return new $C(a,o,s.fieldTransforms)}function jC(t,e,r,n,s,i){const a=t.Qu(1,e,r),o=[Ev(e,n,r)],l=[s];if(i.length%2!=0)throw new st(He.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(Ev(e,i[h])),l.push(i[h+1]);const c=[],u=ys.empty();for(let h=o.length-1;h>=0;--h)if(!KC(c,o[h])){const p=o[h];let m=l[h];m=lr(m);const v=a.Nu(p);if(m instanceof _p)c.push(p);else{const g=ef(m,v);g!=null&&(c.push(p),u.set(p,g))}}const f=new Cs(c);return new $C(u,f,a.fieldTransforms)}function GC(t,e,r,n=!1){return ef(r,t.Qu(n?4:3,e))}function ef(t,e){if(zC(t=lr(t)))return dx("Unsupported field value:",e,t),WC(t,e);if(t instanceof Zd)return function(n,s){if(!VC(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=ef(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=lr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Y5(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=rn.fromDate(n);return{timestampValue:ah(s.serializer,i)}}if(n instanceof rn){const i=new rn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ah(s.serializer,i)}}if(n instanceof yp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof tl)return{bytesValue:uC(s.serializer,n._byteString)};if(n instanceof Cn){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:z1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Ep)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return j1(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${vp(n)}`)}(t,e)}function WC(t,e){const r={};return $w(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ul(t,(n,s)=>{const i=ef(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function zC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof rn||t instanceof yp||t instanceof tl||t instanceof Cn||t instanceof Zd||t instanceof Ep)}function dx(t,e,r){if(!zC(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=vp(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Ev(t,e,r){if((e=lr(e))instanceof Bc)return e._internalPath;if(typeof e=="string")return fx(t,e);throw ch("Field path arguments must be of type string or ",t,!1,void 0,r)}const ZO=new RegExp("[~\\*/\\[\\]]");function fx(t,e,r){if(e.search(ZO)>=0)throw ch(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Bc(...e.split("."))._internalPath}catch{throw ch(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function ch(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new st(He.INVALID_ARGUMENT,o+t+l)}function KC(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Cn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new e9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(bp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class e9 extends hx{data(){return super.data()}}function bp(t,e){return typeof e=="string"?fx(t,e):e instanceof Bc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new st(He.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class px{}class tf extends px{}function nr(t,e,...r){let n=[];e instanceof px&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof Sp).length,o=i.filter(l=>l instanceof rf).length;if(a>1||a>0&&o>0)throw new st(He.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class rf extends tf{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new rf(e,r,n)}_apply(e){const r=this._parse(e);return XC(e._query,r),new va(e.firestore,e.converter,dv(e._query,r))}_parse(e){const r=Uc(e.firestore);return function(i,a,o,l,c,u,f){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new st(He.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){K_(f,u);const p=[];for(const m of f)p.push(z_(l,i,m));h={arrayValue:{values:p}}}else h=z_(l,i,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||K_(f,u),h=GC(o,a,f,u==="in"||u==="not-in");return en.create(c,u,h)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Rr(t,e,r){const n=e,s=bp("where",t);return rf._create(s,n,r)}class Sp extends px{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Sp(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ha.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)XC(a,l),a=dv(a,l)}(e._query,r),new va(e.firestore,e.converter,dv(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ap extends tf{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Ap(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new st(He.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new st(He.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xd(i,a)}(e._query,this._field,this._direction);return new va(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new dl(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Gr(t,e="asc"){const r=e,n=bp("orderBy",t);return Ap._create(n,r)}class Tp extends tf{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Tp(e,r,n)}_apply(e){return new va(e.firestore,e.converter,nh(e._query,this._limit,this._limitType))}}function Ts(t){return qO("limit",t),Tp._create("limit",t,"F")}class wp extends tf{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new wp(e,r,n)}_apply(e){const r=t9(e,this.type,this._docOrFields,this._inclusive);return new va(e.firestore,e.converter,function(s,i){return new dl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,r))}}function uh(...t){return wp._create("startAfter",t,!1)}function t9(t,e,r,n){if(r[0]=lr(r[0]),r[0]instanceof hx)return function(i,a,o,l,c){if(!l)throw new st(He.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const f of sc(i))if(f.field.isKeyField())u.push(rh(a,l.key));else{const h=l.data.field(f.field);if(ip(h))throw new st(He.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const p=f.field.canonicalString();throw new st(He.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}u.push(h)}return new _c(u,c)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const s=Uc(t.firestore);return function(a,o,l,c,u,f){const h=a.explicitOrderBy;if(u.length>h.length)throw new st(He.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let m=0;m<u.length;m++){const v=u[m];if(h[m].field.isKeyField()){if(typeof v!="string")throw new st(He.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof v}`);if(!H1(a)&&v.indexOf("/")!==-1)throw new st(He.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${v}' contains a slash.`);const g=a.path.child(yr.fromString(v));if(!vt.isDocumentKey(g))throw new st(He.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${g}' is not because it contains an odd number of segments.`);const y=new vt(g);p.push(rh(o,y))}else{const g=GC(l,c,v);p.push(g)}}return new _c(p,f)}(t._query,t.firestore._databaseId,s,e,r,n)}}function z_(t,e,r){if(typeof(r=lr(r))=="string"){if(r==="")throw new st(He.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!H1(e)&&r.indexOf("/")!==-1)throw new st(He.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(yr.fromString(r));if(!vt.isDocumentKey(n))throw new st(He.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return rh(t,new vt(n))}if(r instanceof Cn)return rh(t,r._key);throw new st(He.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vp(r)}.`)}function K_(t,e){if(!Array.isArray(t)||t.length===0)throw new st(He.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XC(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new st(He.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new st(He.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class YC{convertValue(e,r="none"){switch(el(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Zo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw kt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ul(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(a=>Wr(a.doubleValue));return new Ep(i)}convertGeoPoint(e){return new yp(Wr(e.latitude),Wr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=B1(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(gd(e));default:return null}}convertTimestamp(e){const r=uo(e);return new rn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=yr.fromString(e);fr(gC(n));const s=new xc(n.get(1),n.get(3)),i=new vt(n.popFirst(5));return s.isEqual(r)||bi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gx extends hx{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(bp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Vu extends gx{data(e={}){return super.data(e)}}class vx{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Wl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Vu(this._firestore,this._userDataWriter,n.key,n,new Wl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new st(He.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new Vu(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Wl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new Vu(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Wl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:r9(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function r9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(t){t=qn(t,Cn);const e=qn(t.firestore,pa);return zO(Lc(e),t._key).then(r=>JC(e,t,r))}class xx extends YC{constructor(e){super(),this.firestore=e}convertBytes(e){return new tl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Cn(this.firestore,null,r)}}function $t(t){t=qn(t,va);const e=qn(t.firestore,pa),r=Lc(e),n=new xx(e);return qC(t._query),KO(r,t._query).then(s=>new vx(e,n,t,s))}function Ht(t,e,r){t=qn(t,Cn);const n=qn(t.firestore,pa),s=mx(t.converter,e,r);return $c(n,[cx(Uc(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,cs.none())])}function Cp(t,e,r,...n){t=qn(t,Cn);const s=qn(t.firestore,pa),i=Uc(s);let a;return a=typeof(e=lr(e))=="string"||e instanceof Bc?jC(i,"updateDoc",t._key,e,r,n):HC(i,"updateDoc",t._key,e),$c(s,[a.toMutation(t._key,cs.exists(!0))])}function ho(t){return $c(qn(t.firestore,pa),[new fp(t._key,cs.none())])}function QC(t,e){const r=qn(t.firestore,pa),n=Ze(t),s=mx(t.converter,e);return $c(r,[cx(Uc(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,cs.exists(!1))]).then(()=>n)}function Ac(t,...e){var r,n,s;t=lr(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||W_(e[a])||(i=e[a],a++);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(W_(e[a])){const f=e[a];e[a]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[a+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[a+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,u;if(t instanceof Cn)c=qn(t.firestore,pa),u=op(t._key.path),l={next:f=>{e[a]&&e[a](JC(c,t,f))},error:e[a+1],complete:e[a+2]};else{const f=qn(t,va);c=qn(f.firestore,pa),u=f._query;const h=new xx(c);l={next:p=>{e[a]&&e[a](new vx(c,h,f,p))},error:e[a+1],complete:e[a+2]},qC(t._query)}return function(h,p,m,v){const g=new ox(v),y=new ax(p,g,m);return h.asyncQueue.enqueueAndForget(async()=>rx(await lh(h),y)),()=>{g.Za(),h.asyncQueue.enqueueAndForget(async()=>nx(await lh(h),y))}}(Lc(c),u,o,l)}function $c(t,e){return function(n,s){const i=new ci;return n.asyncQueue.enqueueAndForget(async()=>OO(await WO(n),s,i)),i.promise}(Lc(t),e)}function JC(t,e,r){const n=r.docs.get(e._key),s=new xx(t);return new gx(t,s,e._key,n,new Wl(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Uc(e)}set(e,r,n){this._verifyNotCommitted();const s=pm(e,this._firestore),i=mx(s.converter,r,n),a=cx(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,cs.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=pm(e,this._firestore);let a;return a=typeof(r=lr(r))=="string"||r instanceof Bc?jC(this._dataReader,"WriteBatch.update",i._key,r,n,s):HC(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,cs.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=pm(e,this._firestore);return this._mutations=this._mutations.concat(new fp(r._key,cs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new st(He.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function pm(t,e){if((t=lr(t)).firestore!==e)throw new st(He.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Wn(){return new ux("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(t){return Lc(t=qn(t,pa)),new ZC(t,e=>$c(t,e))}(function(e,r=!0){(function(s){Nc=s})(cl),oo(new yi("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new pa(new h5(n.getProvider("auth-internal")),new v5(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new st(He.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xc(c.options.projectId,u)}(a,s),a);return i=Object.assign({useFetchStreams:r},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Vs(c_,"4.7.3",e),Vs(c_,"4.7.3","esm2017")})();const n9=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:YC,Bytes:tl,CollectionReference:ui,DocumentReference:Cn,DocumentSnapshot:gx,FieldPath:Bc,FieldValue:Zd,Firestore:pa,FirestoreError:st,GeoPoint:yp,Query:va,QueryCompositeFilterConstraint:Sp,QueryConstraint:tf,QueryDocumentSnapshot:Vu,QueryFieldFilterConstraint:rf,QueryLimitConstraint:Tp,QueryOrderByConstraint:Ap,QuerySnapshot:vx,QueryStartAtConstraint:wp,SnapshotMetadata:Wl,Timestamp:rn,VectorValue:Ep,WriteBatch:ZC,_AutoId:M1,_ByteString:vn,_DatabaseId:xc,_DocumentKey:vt,_EmptyAuthCredentialsProvider:Uw,_FieldPath:mn,_cast:qn,_logWarn:Jo,_validateIsNotUsedTogether:BC,addDoc:QC,collection:bt,connectFirestoreEmulator:UC,deleteDoc:ho,doc:Ze,ensureFirestoreConfigured:Lc,executeWrite:$c,getDoc:Jt,getDocs:$t,getFirestore:vo,limit:Ts,onSnapshot:Ac,orderBy:Gr,query:nr,serverTimestamp:Wn,setDoc:Ht,startAfter:uh,updateDoc:Cp,where:Rr,writeBatch:yx},Symbol.toStringTag,{value:"Module"}));var s9="firebase",a9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vs(s9,a9,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4="firebasestorage.googleapis.com",t4="storageBucket",i9=2*60*1e3,o9=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr extends ga{constructor(e,r,n=0){super(mm(e),`Firebase Storage: ${r} (${mm(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Hr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var $r;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})($r||($r={}));function mm(t){return"storage/"+t}function Ex(){const t="An unknown error occurred, please check the error payload for server response.";return new Hr($r.UNKNOWN,t)}function l9(t){return new Hr($r.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function c9(t){return new Hr($r.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function u9(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Hr($r.UNAUTHENTICATED,t)}function d9(){return new Hr($r.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function f9(t){return new Hr($r.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function h9(){return new Hr($r.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function p9(){return new Hr($r.CANCELED,"User canceled the upload/download.")}function m9(t){return new Hr($r.INVALID_URL,"Invalid URL '"+t+"'.")}function g9(t){return new Hr($r.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function v9(){return new Hr($r.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+t4+"' property when initializing the app?")}function x9(){return new Hr($r.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function y9(t){return new Hr($r.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function dh(t){return new Hr($r.INVALID_ARGUMENT,t)}function r4(){return new Hr($r.APP_DELETED,"The Firebase app was deleted.")}function n4(t){return new Hr($r.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Hu(t,e){return new Hr($r.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function nu(t){throw new Hr($r.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=zn.makeFromUrl(e,r)}catch{return new zn(e,"")}if(n.path==="")return n;throw g9(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function c(k){k.path_=decodeURIComponent(k.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${u}/b/${s}/o${h}`,"i"),m={bucket:1,path:3},v=r===e4?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",y=new RegExp(`^https?://${v}/${s}/${g}`,"i"),b=[{regex:o,indices:l,postModify:i},{regex:p,indices:m,postModify:c},{regex:y,indices:{bucket:1,path:2},postModify:c}];for(let k=0;k<b.length;k++){const P=b[k],w=P.regex.exec(e);if(w){const x=w[P.indices.bucket];let S=w[P.indices.path];S||(S=""),n=new zn(x,S),P.postModify(n);break}}if(n==null)throw m9(e);return n}}class E9{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _9(t,e,r){let n=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...g){c||(c=!0,e.apply(null,g))}function f(g){s=setTimeout(()=>{s=null,t(p,l())},g)}function h(){i&&clearTimeout(i)}function p(g,...y){if(c){h();return}if(g){h(),u.call(null,g,...y);return}if(l()||a){h(),u.call(null,g,...y);return}n<64&&(n*=2);let b;o===1?(o=2,b=0):b=(n+Math.random())*1e3,f(b)}let m=!1;function v(g){m||(m=!0,h(),!c&&(s!==null?(g||(o=2),clearTimeout(s),f(0)):g||(o=1)))}return f(0),i=setTimeout(()=>{a=!0,v(!0)},r),v}function b9(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S9(t){return t!==void 0}function A9(t){return typeof t=="object"&&!Array.isArray(t)}function s4(t){return typeof t=="string"||t instanceof String}function q_(t){return _x()&&t instanceof Blob}function _x(){return typeof Blob<"u"}function _v(t,e,r,n){if(n<e)throw dh(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw dh(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function T9(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var jo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(jo||(jo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w9(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e,r,n,s,i,a,o,l,c,u,f,h=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,m)=>{this.resolve_=p,this.reject_=m,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Uf(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===jo.NO_ERROR,l=i.getStatus();if(!o||w9(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===jo.ABORT;n(!1,new Uf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Uf(c,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());S9(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=Ex();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?r4():p9();a(l)}else{const l=h9();a(l)}};this.canceled_?r(!1,new Uf(!1,null,!0)):this.backoffId_=_9(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&b9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Uf{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function I9(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function k9(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function D9(t,e){e&&(t["X-Firebase-GMPID"]=e)}function P9(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function R9(t,e,r,n,s,i,a=!0){const o=T9(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return D9(c,e),I9(c,r),k9(c,i),P9(c,n),new C9(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F9(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function N9(...t){const e=F9();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(_x())return new Blob(t);throw new Hr($r.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function O9(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M9(t){if(typeof atob>"u")throw y9("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class gm{constructor(e,r){this.data=e,this.contentType=r||null}}function Sx(t,e){switch(t){case Bs.RAW:return new gm(a4(e));case Bs.BASE64:case Bs.BASE64URL:return new gm(i4(t,e));case Bs.DATA_URL:return new gm(B9(e),U9(e))}throw Ex()}function a4(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const i=n,a=t.charCodeAt(++r);n=65536|(i&1023)<<10|a&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function L9(t){let e;try{e=decodeURIComponent(t)}catch{throw Hu(Bs.DATA_URL,"Malformed data URL.")}return a4(e)}function i4(t,e){switch(t){case Bs.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Hu(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Bs.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Hu(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=M9(e)}catch(s){throw s.message.includes("polyfill")?s:Hu(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class o4{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Hu(Bs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=$9(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function B9(t){const e=new o4(t);return e.base64?i4(Bs.BASE64,e.rest):L9(e.rest)}function U9(t){return new o4(t).contentType}function $9(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,r){let n=0,s="";q_(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,r){if(q_(this.data_)){const n=this.data_,s=O9(n,e,r);return s===null?null:new ni(s)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new ni(n,!0)}}static getBlob(...e){if(_x()){const r=e.map(n=>n instanceof ni?n.data_:n);return new ni(N9.apply(null,r))}else{const r=e.map(a=>s4(a)?Sx(Bs.RAW,a).data:a.data_);let n=0;r.forEach(a=>{n+=a.byteLength});const s=new Uint8Array(n);let i=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)s[i++]=a[o]}),new ni(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(t){let e;try{e=JSON.parse(t)}catch{return null}return A9(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V9(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function H9(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function c4(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j9(t,e){return e}class es{constructor(e,r,n,s){this.server=e,this.local=r||e,this.writable=!!n,this.xform=s||j9}}let $f=null;function G9(t){return!s4(t)||t.length<2?t:c4(t)}function W9(){if($f)return $f;const t=[];t.push(new es("bucket")),t.push(new es("generation")),t.push(new es("metageneration")),t.push(new es("name","fullPath",!0));function e(i,a){return G9(a)}const r=new es("name");r.xform=e,t.push(r);function n(i,a){return a!==void 0?Number(a):a}const s=new es("size");return s.xform=n,t.push(s),t.push(new es("timeCreated")),t.push(new es("updated")),t.push(new es("md5Hash",null,!0)),t.push(new es("cacheControl",null,!0)),t.push(new es("contentDisposition",null,!0)),t.push(new es("contentEncoding",null,!0)),t.push(new es("contentLanguage",null,!0)),t.push(new es("contentType",null,!0)),t.push(new es("metadata","customMetadata",!0)),$f=t,$f}function z9(t,e){function r(){const n=t.bucket,s=t.fullPath,i=new zn(n,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:r})}function K9(t,e,r){const n={};n.type="file";const s=r.length;for(let i=0;i<s;i++){const a=r[i];n[a.local]=a.xform(n,e[a.server])}return z9(n,t),n}function q9(t,e,r){const n=l4(e);return n===null?null:K9(t,n,r)}function X9(t,e){const r={},n=e.length;for(let s=0;s<n;s++){const i=e[s];i.writable&&(r[i.server]=t[i.local])}return JSON.stringify(r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_="prefixes",Y_="items";function Y9(t,e,r){const n={prefixes:[],items:[],nextPageToken:r.nextPageToken};if(r[X_])for(const s of r[X_]){const i=s.replace(/\/$/,""),a=t._makeStorageReference(new zn(e,i));n.prefixes.push(a)}if(r[Y_])for(const s of r[Y_]){const i=t._makeStorageReference(new zn(e,s.name));n.items.push(i)}return n}function Q9(t,e,r){const n=l4(r);return n===null?null:Y9(t,e,n)}class Ax{constructor(e,r,n,s){this.url=e,this.method=r,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u4(t){if(!t)throw Ex()}function J9(t,e){function r(n,s){const i=q9(t,s,e);return u4(i!==null),i}return r}function Z9(t,e){function r(n,s){const i=Q9(t,e,s);return u4(i!==null),i}return r}function Tx(t){function e(r,n){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=d9():s=u9():r.getStatus()===402?s=c9(t.bucket):r.getStatus()===403?s=f9(t.path):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}return e}function eM(t){const e=Tx(t);function r(n,s){let i=e(n,s);return n.getStatus()===404&&(i=l9(t.path)),i.serverResponse=s.serverResponse,i}return r}function tM(t,e,r,n,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",r.length>0&&(i.delimiter=r),n&&(i.pageToken=n),s&&(i.maxResults=s);const a=e.bucketOnlyServerUrl(),o=bx(a,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new Ax(o,l,Z9(t,e.bucket),c);return u.urlParams=i,u.errorHandler=Tx(e),u}function rM(t,e){const r=e.fullServerUrl(),n=bx(r,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(l,c){}const o=new Ax(n,s,a,i);return o.successCodes=[200,204],o.errorHandler=eM(e),o}function nM(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function sM(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=nM(null,e)),n}function aM(t,e,r,n,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let b="";for(let k=0;k<2;k++)b=b+Math.random().toString().slice(2);return b}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=sM(e,n,s),u=X9(c,r),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",p=ni.getBlob(f,n,h);if(p===null)throw x9();const m={name:c.fullPath},v=bx(i,t.host,t._protocol),g="POST",y=t.maxUploadRetryTime,E=new Ax(v,g,J9(t,r),y);return E.urlParams=m,E.headers=a,E.body=p.uploadData(),E.errorHandler=Tx(e),E}class iM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=jo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=jo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=jo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,s){if(this.sent_)throw nu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw nu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw nu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw nu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw nu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class oM extends iM{initXhr(){this.xhr_.responseType="text"}}function wx(){return new oM}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,r){this._service=e,r instanceof zn?this._location=r:this._location=zn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new rl(e,r)}get root(){const e=new zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return c4(this._location.path)}get storage(){return this._service}get parent(){const e=V9(this._location.path);if(e===null)return null;const r=new zn(this._location.bucket,e);return new rl(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw n4(e)}}function d4(t,e,r){t._throwIfRoot("uploadBytes");const n=aM(t.storage,t._location,W9(),new ni(e,!0),r);return t.storage.makeRequestWithTokens(n,wx).then(s=>({metadata:s,ref:t}))}function lM(t,e,r=Bs.RAW,n){t._throwIfRoot("uploadString");const s=Sx(r,e),i=Object.assign({},n);return i.contentType==null&&s.contentType!=null&&(i.contentType=s.contentType),d4(t,s.data,i)}function cM(t){const e={prefixes:[],items:[]};return f4(t,e).then(()=>e)}async function f4(t,e,r){const s=await uM(t,{pageToken:r});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await f4(t,e,s.nextPageToken)}function uM(t,e){e!=null&&typeof e.maxResults=="number"&&_v("options.maxResults",1,1e3,e.maxResults);const r=e||{},n=tM(t.storage,t._location,"/",r.pageToken,r.maxResults);return t.storage.makeRequestWithTokens(n,wx)}function dM(t){t._throwIfRoot("deleteObject");const e=rM(t.storage,t._location);return t.storage.makeRequestWithTokens(e,wx)}function fM(t,e){const r=H9(t._location.path,e),n=new zn(t._location.bucket,r);return new rl(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hM(t){return/^[A-Za-z]+:\/\//.test(t)}function pM(t,e){return new rl(t,e)}function h4(t,e){if(t instanceof Cx){const r=t;if(r._bucket==null)throw v9();const n=new rl(r,r._bucket);return e!=null?h4(n,e):n}else return e!==void 0?fM(t,e):t}function mM(t,e){if(e&&hM(e)){if(t instanceof Cx)return pM(t,e);throw dh("To use ref(service, url), the first argument must be a Storage instance.")}else return h4(t,e)}function Q_(t,e){const r=e==null?void 0:e[t4];return r==null?null:zn.makeFromBucketSpec(r,t)}function gM(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:$T(s,t.app.options.projectId))}class Cx{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=e4,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=i9,this._maxUploadRetryTime=o9,this._requests=new Set,s!=null?this._bucket=zn.makeFromBucketSpec(s,this._host):this._bucket=Q_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zn.makeFromBucketSpec(this._url,e):this._bucket=Q_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){_v("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){_v("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rl(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new E9(r4());{const a=R9(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const J_="@firebase/storage",Z_="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4="storage";function m4(t,e,r){return t=lr(t),d4(t,e,r)}function g4(t,e,r,n){return t=lr(t),lM(t,e,r,n)}function v4(t){return t=lr(t),cM(t)}function bv(t){return t=lr(t),dM(t)}function fh(t,e){return t=lr(t),mM(t,e)}function x4(t=jd(),e){t=lr(t);const n=Hd(t,p4).getImmediate({identifier:e}),s=x1("storage");return s&&y4(n,...s),n}function y4(t,e,r,n={}){gM(t,e,r,n)}function vM(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Cx(r,n,s,e,cl)}function xM(){oo(new yi(p4,vM,"PUBLIC").setMultipleInstances(!0)),Vs(J_,Z_,""),Vs(J_,Z_,"esm2017")}xM();const yM=Object.freeze(Object.defineProperty({__proto__:null,StorageError:Hr,get StorageErrorCode(){return $r},StringFormat:Bs,_FbsBlob:ni,_Location:zn,_dataFromString:Sx,_invalidArgument:dh,_invalidRootOperation:n4,connectStorageEmulator:y4,deleteObject:bv,getStorage:x4,listAll:v4,ref:fh,uploadBytes:m4,uploadString:g4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM="type.googleapis.com/google.protobuf.Int64Value",_M="type.googleapis.com/google.protobuf.UInt64Value";function E4(t,e){const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}function Sv(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Sv(e));if(typeof t=="function"||typeof t=="object")return E4(t,e=>Sv(e));throw new Error("Data cannot be encoded in JSON: "+t)}function hh(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case EM:case _M:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>hh(e)):typeof t=="function"||typeof t=="object"?E4(t,e=>hh(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ix="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ic extends ga{constructor(e,r,n){super(`${Ix}/${e}`,r||""),this.details=n}}function bM(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function SM(t,e){let r=bM(t),n=r,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!eb[a])return new ic("internal","internal");r=eb[a],n=a}const o=i.message;typeof o=="string"&&(n=o),s=i.details,s!==void 0&&(s=hh(s))}}catch{}return r==="ok"?null:new ic(r,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av="us-central1";function TM(t){let e=null;return{promise:new Promise((r,n)=>{e=setTimeout(()=>{n(new ic("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class wM{constructor(e,r,n,s,i=Av,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new AM(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(i);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Av}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function CM(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}function IM(t,e,r){return n=>DM(t,e,n,r||{})}async function kM(t,e,r,n){r["Content-Type"]="application/json";let s;try{s=await n(t,{method:"POST",body:JSON.stringify(e),headers:r})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function DM(t,e,r,n){const s=t._url(e);return PM(t,s,r,n)}async function PM(t,e,r,n){r=Sv(r);const s={data:r},i={},a=await t.contextProvider.getContext(n.limitedUseAppCheckTokens);a.authToken&&(i.Authorization="Bearer "+a.authToken),a.messagingToken&&(i["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=a.appCheckToken);const o=n.timeout||7e4,l=TM(o),c=await Promise.race([kM(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new ic("cancelled","Firebase Functions instance was deleted.");const u=SM(c.status,c.json);if(u)throw u;if(!c.json)throw new ic("internal","Response is not valid JSON object.");let f=c.json.data;if(typeof f>"u"&&(f=c.json.result),typeof f>"u")throw new ic("internal","Response is missing data field.");return{data:hh(f)}}const tb="@firebase/functions",rb="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM="auth-internal",FM="app-check-internal",NM="messaging-internal";function OM(t,e){const r=(n,{instanceIdentifier:s})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(RM),o=n.getProvider(NM),l=n.getProvider(FM);return new wM(i,a,o,l,s,t)};oo(new yi(Ix,r,"PUBLIC").setMultipleInstances(!0)),Vs(tb,rb,e),Vs(tb,rb,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(t=jd(),e=Av){const n=Hd(lr(t),Ix).getImmediate({identifier:e}),s=x1("functions");return s&&_4(n,...s),n}function _4(t,e,r){CM(lr(t),e,r)}function Ca(t,e,r){return IM(lr(t),e,r)}OM(fetch.bind(self));const b0=Object.freeze(Object.defineProperty({__proto__:null,connectFunctionsEmulator:_4,getFunctions:oc,httpsCallable:Ca},Symbol.toStringTag,{value:"Module"})),b4={apiKey:"AIzaSyDx1jbQT-FzgzjASFqVA2kbAHWJ_TeUzdY",authDomain:"casemangervue.firebaseapp.com",projectId:"casemangervue",storageBucket:"casemangervue.firebasestorage.app",messagingSenderId:"756483333257",appId:"1:756483333257:web:694e2ad2415b7886563a58",measurementId:"G-YBRDQX9NFR"},Ip=jT(b4),St=Yo(Ip),ze=vo(Ip),Tc=x4(Ip),S4=oc(Ip),A4=new na;console.log("🔥 Connected to Firebase project:",b4.projectId);const T4=Object.freeze(Object.defineProperty({__proto__:null,auth:St,db:ze,functions:S4,googleProvider:A4,storage:Tc},Symbol.toStringTag,{value:"Module"}));/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Vl=typeof document<"u";function w4(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function MM(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&w4(t.default)}const cr=Object.assign;function vm(t,e){const r={};for(const n in e){const s=e[n];r[n]=ma(s)?s.map(t):t(s)}return r}const ju=()=>{},ma=Array.isArray,C4=/#/g,LM=/&/g,BM=/\//g,UM=/=/g,$M=/\?/g,I4=/\+/g,VM=/%5B/g,HM=/%5D/g,k4=/%5E/g,jM=/%60/g,D4=/%7B/g,GM=/%7C/g,P4=/%7D/g,WM=/%20/g;function kx(t){return encodeURI(""+t).replace(GM,"|").replace(VM,"[").replace(HM,"]")}function zM(t){return kx(t).replace(D4,"{").replace(P4,"}").replace(k4,"^")}function Tv(t){return kx(t).replace(I4,"%2B").replace(WM,"+").replace(C4,"%23").replace(LM,"%26").replace(jM,"`").replace(D4,"{").replace(P4,"}").replace(k4,"^")}function KM(t){return Tv(t).replace(UM,"%3D")}function qM(t){return kx(t).replace(C4,"%23").replace($M,"%3F")}function XM(t){return t==null?"":qM(t).replace(BM,"%2F")}function bd(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const YM=/\/$/,QM=t=>t.replace(YM,"");function xm(t,e,r="/"){let n,s={},i="",a="";const o=e.indexOf("#");let l=e.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(n=e.slice(0,l),i=e.slice(l+1,o>-1?o:e.length),s=t(i)),o>-1&&(n=n||e.slice(0,o),a=e.slice(o,e.length)),n=tL(n??e,r),{fullPath:n+(i&&"?")+i+a,path:n,query:s,hash:bd(a)}}function JM(t,e){const r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function nb(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function ZM(t,e,r){const n=e.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&wc(e.matched[n],r.matched[s])&&R4(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function wc(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function R4(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!eL(t[r],e[r]))return!1;return!0}function eL(t,e){return ma(t)?sb(t,e):ma(e)?sb(e,t):t===e}function sb(t,e){return ma(e)?t.length===e.length&&t.every((r,n)=>r===e[n]):t.length===1&&t[0]===e}function tL(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),n=t.split("/"),s=n[n.length-1];(s===".."||s===".")&&n.push("");let i=r.length-1,a,o;for(a=0;a<n.length;a++)if(o=n[a],o!==".")if(o==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a).join("/")}const Oi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Sd;(function(t){t.pop="pop",t.push="push"})(Sd||(Sd={}));var Gu;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Gu||(Gu={}));function rL(t){if(!t)if(Vl){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),QM(t)}const nL=/^[^#]+#/;function sL(t,e){return t.replace(nL,"#")+e}function aL(t,e){const r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-r.left-(e.left||0),top:n.top-r.top-(e.top||0)}}const kp=()=>({left:window.scrollX,top:window.scrollY});function iL(t){let e;if("el"in t){const r=t.el,n=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=aL(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function ab(t,e){return(history.state?history.state.position-e:-1)+t}const wv=new Map;function oL(t,e){wv.set(t,e)}function lL(t){const e=wv.get(t);return wv.delete(t),e}let cL=()=>location.protocol+"//"+location.host;function F4(t,e){const{pathname:r,search:n,hash:s}=e,i=t.indexOf("#");if(i>-1){let o=s.includes(t.slice(i))?t.slice(i).length:1,l=s.slice(o);return l[0]!=="/"&&(l="/"+l),nb(l,"")}return nb(r,t)+n+s}function uL(t,e,r,n){let s=[],i=[],a=null;const o=({state:h})=>{const p=F4(t,location),m=r.value,v=e.value;let g=0;if(h){if(r.value=p,e.value=h,a&&a===m){a=null;return}g=v?h.position-v.position:0}else n(p);s.forEach(y=>{y(r.value,m,{delta:g,type:Sd.pop,direction:g?g>0?Gu.forward:Gu.back:Gu.unknown})})};function l(){a=r.value}function c(h){s.push(h);const p=()=>{const m=s.indexOf(h);m>-1&&s.splice(m,1)};return i.push(p),p}function u(){const{history:h}=window;h.state&&h.replaceState(cr({},h.state,{scroll:kp()}),"")}function f(){for(const h of i)h();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function ib(t,e,r,n=!1,s=!1){return{back:t,current:e,forward:r,replaced:n,position:window.history.length,scroll:s?kp():null}}function dL(t){const{history:e,location:r}=window,n={value:F4(t,r)},s={value:e.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const f=t.indexOf("#"),h=f>-1?(r.host&&document.querySelector("base")?t:t.slice(f))+l:cL()+t+l;try{e[u?"replaceState":"pushState"](c,"",h),s.value=c}catch(p){console.error(p),r[u?"replace":"assign"](h)}}function a(l,c){const u=cr({},e.state,ib(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,u,!0),n.value=l}function o(l,c){const u=cr({},s.value,e.state,{forward:l,scroll:kp()});i(u.current,u,!0);const f=cr({},ib(n.value,l,null),{position:u.position+1},c);i(l,f,!1),n.value=l}return{location:n,state:s,push:o,replace:a}}function fL(t){t=rL(t);const e=dL(t),r=uL(t,e.state,e.location,e.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const s=cr({location:"",base:t,go:n,createHref:sL.bind(null,t)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function hL(t){return typeof t=="string"||t&&typeof t=="object"}function N4(t){return typeof t=="string"||typeof t=="symbol"}const O4=Symbol("");var ob;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(ob||(ob={}));function Cc(t,e){return cr(new Error,{type:t,[O4]:!0},e)}function qa(t,e){return t instanceof Error&&O4 in t&&(e==null||!!(t.type&e))}const lb="[^/]+?",pL={sensitive:!1,strict:!1,start:!0,end:!0},mL=/[.+*?^${}()[\]/\\]/g;function gL(t,e){const r=cr({},pL,e),n=[];let s=r.start?"^":"";const i=[];for(const c of t){const u=c.length?[]:[90];r.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const h=c[f];let p=40+(r.sensitive?.25:0);if(h.type===0)f||(s+="/"),s+=h.value.replace(mL,"\\$&"),p+=40;else if(h.type===1){const{value:m,repeatable:v,optional:g,regexp:y}=h;i.push({name:m,repeatable:v,optional:g});const E=y||lb;if(E!==lb){p+=10;try{new RegExp(`(${E})`)}catch(k){throw new Error(`Invalid custom RegExp for param "${m}" (${E}): `+k.message)}}let b=v?`((?:${E})(?:/(?:${E}))*)`:`(${E})`;f||(b=g&&c.length<2?`(?:/${b})`:"/"+b),g&&(b+="?"),s+=b,p+=20,g&&(p+=-8),v&&(p+=-20),E===".*"&&(p+=-50)}u.push(p)}n.push(u)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function o(c){const u=c.match(a),f={};if(!u)return null;for(let h=1;h<u.length;h++){const p=u[h]||"",m=i[h-1];f[m.name]=p&&m.repeatable?p.split("/"):p}return f}function l(c){let u="",f=!1;for(const h of t){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const p of h)if(p.type===0)u+=p.value;else if(p.type===1){const{value:m,repeatable:v,optional:g}=p,y=m in c?c[m]:"";if(ma(y)&&!v)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const E=ma(y)?y.join("/"):y;if(!E)if(g)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${m}"`);u+=E}}return u||"/"}return{re:a,score:n,keys:i,parse:o,stringify:l}}function vL(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=e[r]-t[r];if(n)return n;r++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function M4(t,e){let r=0;const n=t.score,s=e.score;for(;r<n.length&&r<s.length;){const i=vL(n[r],s[r]);if(i)return i;r++}if(Math.abs(s.length-n.length)===1){if(cb(n))return 1;if(cb(s))return-1}return s.length-n.length}function cb(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const xL={type:0,value:""},yL=/[a-zA-Z0-9_]/;function EL(t){if(!t)return[[]];if(t==="/")return[[xL]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(p){throw new Error(`ERR (${r})/"${c}": ${p}`)}let r=0,n=r;const s=[];let i;function a(){i&&s.push(i),i=[]}let o=0,l,c="",u="";function f(){c&&(r===0?i.push({type:0,value:c}):r===1||r===2||r===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;o<t.length;){if(l=t[o++],l==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:l==="/"?(c&&f(),a()):l===":"?(f(),r=1):h();break;case 4:h(),r=n;break;case 1:l==="("?r=2:yL.test(l)?h():(f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=3:u+=l;break;case 3:f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),a(),s}function _L(t,e,r){const n=gL(EL(t.path),r),s=cr(n,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function bL(t,e){const r=[],n=new Map;e=hb({strict:!1,end:!0,sensitive:!1},e);function s(f){return n.get(f)}function i(f,h,p){const m=!p,v=db(f);v.aliasOf=p&&p.record;const g=hb(e,f),y=[v];if("alias"in f){const k=typeof f.alias=="string"?[f.alias]:f.alias;for(const P of k)y.push(db(cr({},v,{components:p?p.record.components:v.components,path:P,aliasOf:p?p.record:v})))}let E,b;for(const k of y){const{path:P}=k;if(h&&P[0]!=="/"){const w=h.record.path,x=w[w.length-1]==="/"?"":"/";k.path=h.record.path+(P&&x+P)}if(E=_L(k,h,g),p?p.alias.push(E):(b=b||E,b!==E&&b.alias.push(E),m&&f.name&&!fb(E)&&a(f.name)),L4(E)&&l(E),v.children){const w=v.children;for(let x=0;x<w.length;x++)i(w[x],E,p&&p.children[x])}p=p||E}return b?()=>{a(b)}:ju}function a(f){if(N4(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function o(){return r}function l(f){const h=TL(f,r);r.splice(h,0,f),f.record.name&&!fb(f)&&n.set(f.record.name,f)}function c(f,h){let p,m={},v,g;if("name"in f&&f.name){if(p=n.get(f.name),!p)throw Cc(1,{location:f});g=p.record.name,m=cr(ub(h.params,p.keys.filter(b=>!b.optional).concat(p.parent?p.parent.keys.filter(b=>b.optional):[]).map(b=>b.name)),f.params&&ub(f.params,p.keys.map(b=>b.name))),v=p.stringify(m)}else if(f.path!=null)v=f.path,p=r.find(b=>b.re.test(v)),p&&(m=p.parse(v),g=p.record.name);else{if(p=h.name?n.get(h.name):r.find(b=>b.re.test(h.path)),!p)throw Cc(1,{location:f,currentLocation:h});g=p.record.name,m=cr({},h.params,f.params),v=p.stringify(m)}const y=[];let E=p;for(;E;)y.unshift(E.record),E=E.parent;return{name:g,path:v,params:m,matched:y,meta:AL(y)}}t.forEach(f=>i(f));function u(){r.length=0,n.clear()}return{addRoute:i,resolve:c,removeRoute:a,clearRoutes:u,getRoutes:o,getRecordMatcher:s}}function ub(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function db(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:SL(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function SL(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(const n in t.components)e[n]=typeof r=="object"?r[n]:r;return e}function fb(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function AL(t){return t.reduce((e,r)=>cr(e,r.meta),{})}function hb(t,e){const r={};for(const n in t)r[n]=n in e?e[n]:t[n];return r}function TL(t,e){let r=0,n=e.length;for(;r!==n;){const i=r+n>>1;M4(t,e[i])<0?n=i:r=i+1}const s=wL(t);return s&&(n=e.lastIndexOf(s,n-1)),n}function wL(t){let e=t;for(;e=e.parent;)if(L4(e)&&M4(t,e)===0)return e}function L4({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function CL(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(I4," "),a=i.indexOf("="),o=bd(a<0?i:i.slice(0,a)),l=a<0?null:bd(i.slice(a+1));if(o in e){let c=e[o];ma(c)||(c=e[o]=[c]),c.push(l)}else e[o]=l}return e}function pb(t){let e="";for(let r in t){const n=t[r];if(r=KM(r),n==null){n!==void 0&&(e+=(e.length?"&":"")+r);continue}(ma(n)?n.map(i=>i&&Tv(i)):[n&&Tv(n)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+r,i!=null&&(e+="="+i))})}return e}function IL(t){const e={};for(const r in t){const n=t[r];n!==void 0&&(e[r]=ma(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return e}const kL=Symbol(""),mb=Symbol(""),Dp=Symbol(""),Dx=Symbol(""),Cv=Symbol("");function su(){let t=[];function e(n){return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}function r(){t=[]}return{add:e,list:()=>t.slice(),reset:r}}function Gi(t,e,r,n,s,i=a=>a()){const a=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((o,l)=>{const c=h=>{h===!1?l(Cc(4,{from:r,to:e})):h instanceof Error?l(h):hL(h)?l(Cc(2,{from:e,to:h})):(a&&n.enterCallbacks[s]===a&&typeof h=="function"&&a.push(h),o())},u=i(()=>t.call(n&&n.instances[s],e,r,c));let f=Promise.resolve(u);t.length<3&&(f=f.then(c)),f.catch(h=>l(h))})}function ym(t,e,r,n,s=i=>i()){const i=[];for(const a of t)for(const o in a.components){let l=a.components[o];if(!(e!=="beforeRouteEnter"&&!a.instances[o]))if(w4(l)){const u=(l.__vccOpts||l)[e];u&&i.push(Gi(u,r,n,a,o,s))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const f=MM(u)?u.default:u;a.mods[o]=u,a.components[o]=f;const p=(f.__vccOpts||f)[e];return p&&Gi(p,r,n,a,o,s)()}))}}return i}function gb(t){const e=Ds(Dp),r=Ds(Dx),n=Se(()=>{const l=ee(t.to);return e.resolve(l)}),s=Se(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],f=r.matched;if(!u||!f.length)return-1;const h=f.findIndex(wc.bind(null,u));if(h>-1)return h;const p=vb(l[c-2]);return c>1&&vb(u)===p&&f[f.length-1].path!==p?f.findIndex(wc.bind(null,l[c-2])):h}),i=Se(()=>s.value>-1&&NL(r.params,n.value.params)),a=Se(()=>s.value>-1&&s.value===r.matched.length-1&&R4(r.params,n.value.params));function o(l={}){if(FL(l)){const c=e[ee(t.replace)?"replace":"push"](ee(t.to)).catch(ju);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:Se(()=>n.value.href),isActive:i,isExactActive:a,navigate:o}}function DL(t){return t.length===1?t[0]:t}const PL=Md({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:gb,setup(t,{slots:e}){const r=Rs(gb(t)),{options:n}=Ds(Dp),s=Se(()=>({[xb(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[xb(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=e.default&&DL(e.default(r));return t.custom?i:Xo("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),RL=PL;function FL(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function NL(t,e){for(const r in e){const n=e[r],s=t[r];if(typeof n=="string"){if(n!==s)return!1}else if(!ma(s)||s.length!==n.length||n.some((i,a)=>i!==s[a]))return!1}return!0}function vb(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const xb=(t,e,r)=>t??e??r,OL=Md({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:r}){const n=Ds(Cv),s=Se(()=>t.route||n.value),i=Ds(mb,0),a=Se(()=>{let c=ee(i);const{matched:u}=s.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),o=Se(()=>s.value.matched[a.value]);Fu(mb,Se(()=>a.value+1)),Fu(kL,o),Fu(Cv,s);const l=se();return Vt(()=>[l.value,o.value,t.name],([c,u,f],[h,p,m])=>{u&&(u.instances[f]=c,p&&p!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!wc(u,p)||!h)&&(u.enterCallbacks[f]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=s.value,u=t.name,f=o.value,h=f&&f.components[u];if(!h)return yb(r.default,{Component:h,route:c});const p=f.props[u],m=p?p===!0?c.params:typeof p=="function"?p(c):p:null,g=Xo(h,cr({},m,e,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return yb(r.default,{Component:g,route:c})||g}}});function yb(t,e){if(!t)return null;const r=t(e);return r.length===1?r[0]:r}const ML=OL;function LL(t){const e=bL(t.routes,t),r=t.parseQuery||CL,n=t.stringifyQuery||pb,s=t.history,i=su(),a=su(),o=su(),l=n1(Oi);let c=Oi;Vl&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=vm.bind(null,ue=>""+ue),f=vm.bind(null,XM),h=vm.bind(null,bd);function p(ue,pe){let q,G;return N4(ue)?(q=e.getRecordMatcher(ue),G=pe):G=ue,e.addRoute(G,q)}function m(ue){const pe=e.getRecordMatcher(ue);pe&&e.removeRoute(pe)}function v(){return e.getRoutes().map(ue=>ue.record)}function g(ue){return!!e.getRecordMatcher(ue)}function y(ue,pe){if(pe=cr({},pe||l.value),typeof ue=="string"){const Z=xm(r,ue,pe.path),ne=e.resolve({path:Z.path},pe),ge=s.createHref(Z.fullPath);return cr(Z,ne,{params:h(ne.params),hash:bd(Z.hash),redirectedFrom:void 0,href:ge})}let q;if(ue.path!=null)q=cr({},ue,{path:xm(r,ue.path,pe.path).path});else{const Z=cr({},ue.params);for(const ne in Z)Z[ne]==null&&delete Z[ne];q=cr({},ue,{params:f(Z)}),pe.params=f(pe.params)}const G=e.resolve(q,pe),oe=ue.hash||"";G.params=u(h(G.params));const Q=JM(n,cr({},ue,{hash:zM(oe),path:G.path})),Y=s.createHref(Q);return cr({fullPath:Q,hash:oe,query:n===pb?IL(ue.query):ue.query||{}},G,{redirectedFrom:void 0,href:Y})}function E(ue){return typeof ue=="string"?xm(r,ue,l.value.path):cr({},ue)}function b(ue,pe){if(c!==ue)return Cc(8,{from:pe,to:ue})}function k(ue){return x(ue)}function P(ue){return k(cr(E(ue),{replace:!0}))}function w(ue){const pe=ue.matched[ue.matched.length-1];if(pe&&pe.redirect){const{redirect:q}=pe;let G=typeof q=="function"?q(ue):q;return typeof G=="string"&&(G=G.includes("?")||G.includes("#")?G=E(G):{path:G},G.params={}),cr({query:ue.query,hash:ue.hash,params:G.path!=null?{}:ue.params},G)}}function x(ue,pe){const q=c=y(ue),G=l.value,oe=ue.state,Q=ue.force,Y=ue.replace===!0,Z=w(q);if(Z)return x(cr(E(Z),{state:typeof Z=="object"?cr({},oe,Z.state):oe,force:Q,replace:Y}),pe||q);const ne=q;ne.redirectedFrom=pe;let ge;return!Q&&ZM(n,G,q)&&(ge=Cc(16,{to:ne,from:G}),j(G,G,!0,!1)),(ge?Promise.resolve(ge):A(ne,G)).catch(ae=>qa(ae)?qa(ae,2)?ae:K(ae):M(ae,ne,G)).then(ae=>{if(ae){if(qa(ae,2))return x(cr({replace:Y},E(ae.to),{state:typeof ae.to=="object"?cr({},oe,ae.to.state):oe,force:Q}),pe||ne)}else ae=T(ne,G,!0,Y,oe);return C(ne,G,ae),ae})}function S(ue,pe){const q=b(ue,pe);return q?Promise.reject(q):Promise.resolve()}function _(ue){const pe=X.values().next().value;return pe&&typeof pe.runWithContext=="function"?pe.runWithContext(ue):ue()}function A(ue,pe){let q;const[G,oe,Q]=BL(ue,pe);q=ym(G.reverse(),"beforeRouteLeave",ue,pe);for(const Z of G)Z.leaveGuards.forEach(ne=>{q.push(Gi(ne,ue,pe))});const Y=S.bind(null,ue,pe);return q.push(Y),he(q).then(()=>{q=[];for(const Z of i.list())q.push(Gi(Z,ue,pe));return q.push(Y),he(q)}).then(()=>{q=ym(oe,"beforeRouteUpdate",ue,pe);for(const Z of oe)Z.updateGuards.forEach(ne=>{q.push(Gi(ne,ue,pe))});return q.push(Y),he(q)}).then(()=>{q=[];for(const Z of Q)if(Z.beforeEnter)if(ma(Z.beforeEnter))for(const ne of Z.beforeEnter)q.push(Gi(ne,ue,pe));else q.push(Gi(Z.beforeEnter,ue,pe));return q.push(Y),he(q)}).then(()=>(ue.matched.forEach(Z=>Z.enterCallbacks={}),q=ym(Q,"beforeRouteEnter",ue,pe,_),q.push(Y),he(q))).then(()=>{q=[];for(const Z of a.list())q.push(Gi(Z,ue,pe));return q.push(Y),he(q)}).catch(Z=>qa(Z,8)?Z:Promise.reject(Z))}function C(ue,pe,q){o.list().forEach(G=>_(()=>G(ue,pe,q)))}function T(ue,pe,q,G,oe){const Q=b(ue,pe);if(Q)return Q;const Y=pe===Oi,Z=Vl?history.state:{};q&&(G||Y?s.replace(ue.fullPath,cr({scroll:Y&&Z&&Z.scroll},oe)):s.push(ue.fullPath,oe)),l.value=ue,j(ue,pe,q,Y),K()}let D;function V(){D||(D=s.listen((ue,pe,q)=>{if(!re.listening)return;const G=y(ue),oe=w(G);if(oe){x(cr(oe,{replace:!0,force:!0}),G).catch(ju);return}c=G;const Q=l.value;Vl&&oL(ab(Q.fullPath,q.delta),kp()),A(G,Q).catch(Y=>qa(Y,12)?Y:qa(Y,2)?(x(cr(E(Y.to),{force:!0}),G).then(Z=>{qa(Z,20)&&!q.delta&&q.type===Sd.pop&&s.go(-1,!1)}).catch(ju),Promise.reject()):(q.delta&&s.go(-q.delta,!1),M(Y,G,Q))).then(Y=>{Y=Y||T(G,Q,!1),Y&&(q.delta&&!qa(Y,8)?s.go(-q.delta,!1):q.type===Sd.pop&&qa(Y,20)&&s.go(-1,!1)),C(G,Q,Y)}).catch(ju)}))}let B=su(),R=su(),F;function M(ue,pe,q){K(ue);const G=R.list();return G.length?G.forEach(oe=>oe(ue,pe,q)):console.error(ue),Promise.reject(ue)}function O(){return F&&l.value!==Oi?Promise.resolve():new Promise((ue,pe)=>{B.add([ue,pe])})}function K(ue){return F||(F=!ue,V(),B.list().forEach(([pe,q])=>ue?q(ue):pe()),B.reset()),ue}function j(ue,pe,q,G){const{scrollBehavior:oe}=t;if(!Vl||!oe)return Promise.resolve();const Q=!q&&lL(ab(ue.fullPath,0))||(G||!q)&&history.state&&history.state.scroll||null;return ll().then(()=>oe(ue,pe,Q)).then(Y=>Y&&iL(Y)).catch(Y=>M(Y,ue,pe))}const H=ue=>s.go(ue);let W;const X=new Set,re={currentRoute:l,listening:!0,addRoute:p,removeRoute:m,clearRoutes:e.clearRoutes,hasRoute:g,getRoutes:v,resolve:y,options:t,push:k,replace:P,go:H,back:()=>H(-1),forward:()=>H(1),beforeEach:i.add,beforeResolve:a.add,afterEach:o.add,onError:R.add,isReady:O,install(ue){const pe=this;ue.component("RouterLink",RL),ue.component("RouterView",ML),ue.config.globalProperties.$router=pe,Object.defineProperty(ue.config.globalProperties,"$route",{enumerable:!0,get:()=>ee(l)}),Vl&&!W&&l.value===Oi&&(W=!0,k(s.location).catch(oe=>{}));const q={};for(const oe in Oi)Object.defineProperty(q,oe,{get:()=>l.value[oe],enumerable:!0});ue.provide(Dp,pe),ue.provide(Dx,t1(q)),ue.provide(Cv,l);const G=ue.unmount;X.add(ue),ue.unmount=function(){X.delete(ue),X.size<1&&(c=Oi,D&&D(),D=null,l.value=Oi,W=!1,F=!1),G()}}};function he(ue){return ue.reduce((pe,q)=>pe.then(()=>_(q)),Promise.resolve())}return re}function BL(t,e){const r=[],n=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let a=0;a<i;a++){const o=e.matched[a];o&&(t.matched.find(c=>wc(c,o))?n.push(o):r.push(o));const l=t.matched[a];l&&(e.matched.find(c=>wc(c,l))||s.push(l))}return[r,n,s]}function wi(){return Ds(Dp)}function UL(t){return Ds(Dx)}class $L{constructor(){this.enabled=!0}async logStudentAccess(e,r,n={}){if(!(!this.enabled||!St.currentUser))try{const s=Ze(bt(ze,"auditLogs"));await Ht(s,{type:"student_access",studentId:e,userId:St.currentUser.uid,userEmail:St.currentUser.email,action:r,details:n,timestamp:Wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logUserManagement(e,r,n={}){if(!(!this.enabled||!St.currentUser))try{const s=Ze(bt(ze,"auditLogs"));await Ht(s,{type:"user_management",targetUserId:e,performedBy:St.currentUser.uid,performedByEmail:St.currentUser.email,action:r,details:n,timestamp:Wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logSystemAccess(e,r={}){var n,s;if(this.enabled)try{const i=Ze(bt(ze,"auditLogs"));await Ht(i,{type:"system_access",userId:((n=St.currentUser)==null?void 0:n.uid)||"unknown",userEmail:((s=St.currentUser)==null?void 0:s.email)||"unknown",action:e,details:r,timestamp:Wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(i){console.error("Audit logging failed:",i)}}async logDataExport(e,r,n={}){if(!(!this.enabled||!St.currentUser))try{const s=Ze(bt(ze,"auditLogs"));await Ht(s,{type:"data_export",exportType:e,studentIds:Array.isArray(r)?r:[r],studentCount:Array.isArray(r)?r.length:1,userId:St.currentUser.uid,userEmail:St.currentUser.email,details:n,timestamp:Wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}getSessionId(){return sessionStorage.getItem("sessionId")||sessionStorage.setItem("sessionId",`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),sessionStorage.getItem("sessionId")}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"unknown"}}async generateAccessReport(e,r){try{const n=new Date(r.start),s=new Date(r.end);return{studentId:e,accessCount:0,uniqueUsers:[],actions:[],timeRange:r}}catch(n){return console.error("Report generation failed:",n),null}}}const tn=new $L,xa=FT("auth",()=>{const t=se(null),e=se(""),r=se(!0),n=wi(),s=()=>{tp(St,async u=>{if(r.value=!0,u)try{const f=await Jt(Ze(ze,"users",u.uid));f.exists()?(t.value={uid:u.uid,email:u.email,name:u.displayName,...f.data()},console.log("✅ User authenticated:",t.value)):(console.log("⚠️ User not found in Firestore"),t.value=null)}catch(f){console.error("❌ Error fetching user data:",f),t.value=null}else t.value=null,console.log("👤 No user authenticated");r.value=!1})},i=async()=>{e.value="";try{const u=new na,h=(await N1(St,u)).user,p=await Jt(Ze(ze,"users",h.uid));if(!p.exists()){e.value="⚠️ User not found in system.";return}t.value={uid:h.uid,email:h.email,name:h.displayName,...p.data()},n.push("/")}catch(u){console.error("❌ Login error:",u),e.value=u.message||"Authentication failed."}},a=async()=>{try{t.value&&await tn.logSystemAccess("logout",{userRole:t.value.role,success:!0}),await rp(St),t.value=null,n.push("/login")}catch(u){console.error("❌ Logout error:",u),await tn.logSystemAccess("logout_error",{error:u.message,success:!1})}},o=u=>{t.value=u},l=async()=>{if(St.currentUser)try{return await ZT(St.currentUser,!0),console.log("✅ Token refreshed successfully"),!0}catch(u){return console.error("❌ Error refreshing token:",u),!1}return!1},c=Se(()=>t.value);return s(),{currentUser:t,user:c,errorMsg:e,isLoading:r,loginWithGoogle:i,logout:a,setUser:o,refreshToken:l}}),VL=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:xa},Symbol.toStringTag,{value:"Module"})),lc=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],HL=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],au=["admin","school_admin","admin_504","sped_chair"],it={VIEW_USERS:"view_users",EDIT_USER:"edit_user",DELETE_USER:"delete_user",VIEW_STUDENTS:"view_students",EDIT_STUDENT_CM:"edit_student_CM",EDIT_STUDENT_ALL:"edit_student_All",ACCESS_ADMIN_PANEL:"access_admin_panel",MANAGE_AIDES:"manage_aides",MANAGE_SYSTEM_SETTINGS:"manage_system_settings",MANAGE_TEACHER_FEEDBACK:"manage_teacher_feedback",MANAGE_IMPORTS:"manage_imports",MANAGE_BACKUPS:"manage_backups"},yu={admin:[it.VIEW_USERS,it.EDIT_USER,it.DELETE_USER,it.VIEW_STUDENTS,it.EDIT_STUDENT_ALL,it.ACCESS_ADMIN_PANEL,it.MANAGE_AIDES,it.MANAGE_SYSTEM_SETTINGS,it.MANAGE_TEACHER_FEEDBACK,it.MANAGE_IMPORTS,it.MANAGE_BACKUPS],school_admin:[it.VIEW_USERS,it.EDIT_USER,it.DELETE_USER,it.VIEW_STUDENTS,it.EDIT_STUDENT_ALL,it.ACCESS_ADMIN_PANEL,it.MANAGE_AIDES,it.MANAGE_TEACHER_FEEDBACK,it.MANAGE_IMPORTS,it.MANAGE_BACKUPS],staff_view:[it.VIEW_USERS,it.VIEW_STUDENTS],staff_edit:[it.VIEW_USERS,it.VIEW_STUDENTS,it.EDIT_STUDENT_ALL],admin_504:[it.VIEW_USERS,it.EDIT_USER,it.DELETE_USER,it.VIEW_STUDENTS,it.EDIT_STUDENT_ALL,it.ACCESS_ADMIN_PANEL,it.MANAGE_AIDES,it.MANAGE_TEACHER_FEEDBACK],sped_chair:[it.VIEW_USERS,it.EDIT_USER,it.DELETE_USER,it.VIEW_STUDENTS,it.EDIT_STUDENT_ALL,it.ACCESS_ADMIN_PANEL,it.MANAGE_AIDES,it.MANAGE_TEACHER_FEEDBACK],case_manager:[it.VIEW_USERS,it.VIEW_STUDENTS,it.EDIT_STUDENT_CM,it.MANAGE_TEACHER_FEEDBACK],teacher:[it.VIEW_USERS,it.VIEW_STUDENTS],service_provider:[it.VIEW_USERS,it.VIEW_STUDENTS,it.EDIT_STUDENT_CM],paraeducator:[it.VIEW_USERS,it.VIEW_STUDENTS]};function Eb(t){return lc.includes(t)}const jL={admin:"System Administrator - Full access to all features and settings",school_admin:"School Administrator - Manage students, aides, and users (no system settings)",staff_view:"Staff Viewer - IEP access for counselors, nurses, intervention specialists",staff_edit:"Staff Editor - Edit all students, no admin panel access",admin_504:"504 Plan Coordinator - Manage 504 plans, students, and aides",sped_chair:"Special Education Chair - Manage special education programs",case_manager:"Case Manager - Manage assigned student caseload only",teacher:"Teacher - View students in assigned classes",service_provider:"Service Provider - Manage students receiving services",paraeducator:"Paraeducator - View assigned students only"},B4=FT("permission",()=>{const t=xa(),e=se([]),r=se({}),n=se({}),s=se(!1),i=async()=>{try{const f=Ze(ze,"config/permissions_matrix"),h=await Jt(f);h.exists()?(n.value=h.data(),console.log("Loaded permissions matrix from database:",n.value)):(n.value=yu,console.log("Using default permissions matrix:",n.value)),s.value=!0,e.value.length>0&&(r.value=l(e.value))}catch(f){console.error("Error loading permissions matrix:",f),n.value=yu,s.value=!0}};let a=null;const o=()=>{a&&a();const f=Ze(ze,"config/permissions_matrix");a=Ac(f,h=>{console.log("Permissions matrix updated:",h.exists(),h.data()),h.exists()?n.value=h.data():n.value=yu,s.value=!0,e.value.length>0&&(r.value=l(e.value),console.log("User permissions recalculated:",r.value))},h=>{console.error("Error watching permissions matrix:",h),n.value=yu,s.value=!0})};function l(f){const h={};return console.log("Deriving permissions for roles:",f),console.log("Current permissions matrix:",n.value),console.log("Matrix loaded:",s.value),f.forEach(p=>{const m=n.value[p]||[];console.log(`Role ${p} has permissions:`,m),m.forEach(v=>h[v]=!0)}),console.log("Final derived permissions:",h),h}let c=null;return Vt(()=>{var f;return(f=t.currentUser)==null?void 0:f.uid},()=>{var f;if(c&&c(),(f=t.currentUser)!=null&&f.uid){const h=Ze(ze,"users",t.currentUser.uid);c=Ac(h,p=>{const m=p.data()||{};e.value=m.role?[m.role]:[],console.log("User roles updated:",e.value),t.currentUser&&(t.currentUser.value={...t.currentUser.value,...m},console.log("🔄 Updated auth store user data:",t.currentUser.value)),s.value&&(r.value=l(e.value))})}else e.value=[],r.value={}},{immediate:!0}),o(),i(),{userRoles:e,userPermissions:r,permissionsMatrix:n,matrixLoaded:s,hasRole:f=>e.value.includes(f),can:f=>r.value[f]===!0,loadPermissionsMatrix:i}});function GL(){const t=B4(),e=Se(()=>t.hasRole("admin")),r=Se(()=>t.can("manage_users")),n=s=>t.can(s);return{isAdmin:e,canManageUsers:r,hasRole:t.hasRole,can:t.can,hasPermission:n}}const yt=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r},WL={name:"UserRoleSwitcher",setup(){const t=xa();GL();const e=se(!1),r=se(""),n=se({}),s=se(!1),i=Se(()=>t.user),a=[{value:"admin",label:"Admin"},{value:"administrator",label:"Administrator"},{value:"administrator_504_CM",label:"Administrator 504/CM"},{value:"sped_chair",label:"SPED Chair"},{value:"case_manager",label:"Case Manager"},{value:"paraeducator",label:"Paraeducator"},{value:"teacher",label:"Teacher"},{value:"service_provider",label:"Service Provider"}],o=[{uid:"test-admin",name:"Test Admin",email:"admin@test.com",role:"admin"},{uid:"test-administrator",name:"Test Administrator",email:"administrator@test.com",role:"administrator"},{uid:"test-administrator-504-cm",name:"Test Admin 504/CM",email:"admin504@test.com",role:"administrator_504_CM"},{uid:"test-sped-chair",name:"Test SPED Chair",email:"spedchair@test.com",role:"sped_chair"},{uid:"test-case-manager",name:"Test Case Manager",email:"cm@test.com",role:"case_manager"},{uid:"test-paraeducator",name:"Test Paraeducator",email:"para@test.com",role:"paraeducator"},{uid:"test-teacher",name:"Test Teacher",email:"teacher@test.com",role:"teacher"},{uid:"test-service-provider",name:"Test Service Provider",email:"service@test.com",role:"service_provider"}],l=async()=>{s.value=!0;try{const y=Ze(ze,"config","permissions_matrix"),E=await Jt(y);E.exists()?n.value=E.data():(console.warn("Permissions matrix not found in database"),n.value={})}catch(y){console.error("Error loading permissions matrix:",y),n.value={}}finally{s.value=!1}},c=Se(()=>{var k;const y=[{action:it.VIEW_USERS,label:"View Users"},{action:it.EDIT_USER,label:"Edit User"},{action:it.DELETE_USER,label:"Delete User"},{action:it.MANAGE_SUBJECTS,label:"Manage Subjects"},{action:it.MANAGE_ROLES,label:"Manage Roles"},{action:it.VIEW_STUDENTS,label:"View Students"},{action:it.EDIT_STUDENT_CM,label:"Edit Students (Own Caseload)"},{action:it.EDIT_STUDENT_ALL,label:"Edit All Students"},{action:it.TESTING,label:"Testing"}],E=(k=i.value)==null?void 0:k.role,b=n.value[E]||[];return y.map(P=>({...P,granted:b.includes(P.action)}))}),u=()=>{e.value=!e.value},f=()=>{if(!r.value)return;const y={uid:`test-${r.value}-${Date.now()}`,email:`${r.value}@test.com`,name:`Test ${r.value.charAt(0).toUpperCase()+r.value.slice(1)}`,role:r.value,lastSyncTrigger:new Date().toISOString()};t.setUser(y),localStorage.setItem("debug-user",JSON.stringify(y)),r.value=""},h=y=>{t.setUser(y),localStorage.setItem("debug-user",JSON.stringify(y))},p=()=>{localStorage.removeItem("debug-user"),window.location.reload()},m=()=>{window.location.reload()};return Ut(async()=>{await l();const y=localStorage.getItem("debug-user");if(y)try{const E=JSON.parse(y);t.setUser(E)}catch(E){console.error("Error parsing debug user:",E),localStorage.removeItem("debug-user")}return()=>{}}),{canSwitchRoles:Se(()=>{var E;const y=(E=i.value)==null?void 0:E.role;return["admin","administrator"].includes(y)}),hideRoleSwitcher:()=>{console.log("Role switcher hidden")},isExpanded:e,selectedRole:r,currentUser:i,availableRoles:a,testUsers:o,currentPermissions:c,loadingPermissions:s,toggleExpanded:u,switchRole:f,switchToUser:h,resetToRealUser:p,refreshPage:m}}},zL=["title"],KL={key:0,class:"debug-label"},qL={key:0,class:"switcher-content"},XL={class:"current-user-info"},YL={class:"role-selector"},QL=["value"],JL={class:"test-users"},ZL={class:"test-user-buttons"},eB=["onClick"],tB={class:"permission-info"},rB={key:0,class:"loading-permissions"},nB={key:1,class:"permission-list"},sB={class:"permission-icon"},aB={class:"actions"};function iB(t,e,r,n,s,i){var a,o,l,c,u;return n.canSwitchRoles?(N(),L("div",{key:0,class:Qe(["user-role-switcher",{collapsed:!n.isExpanded}])},[d("div",{class:"switcher-header",onClick:e[1]||(e[1]=(...f)=>n.toggleExpanded&&n.toggleExpanded(...f)),title:n.isExpanded?"Collapse Debug Panel":"Expand Debug Panel"},[e[6]||(e[6]=d("span",{class:"debug-icon"},"🔧",-1)),n.isExpanded?(N(),L("span",KL,"Debug Role Switcher")):_e("",!0),e[7]||(e[7]=d("span",{class:"beta-label"},"BETA",-1)),d("button",{onClick:e[0]||(e[0]=dn((...f)=>n.hideRoleSwitcher&&n.hideRoleSwitcher(...f),["stop"])),class:"close-debug-btn",title:"Close Role Switcher"},"×")],8,zL),n.isExpanded?(N(),L("div",qL,[e[18]||(e[18]=d("div",{class:"beta-warning"},[d("strong",null,"⚠️ BETA WARNING:"),Ne(" This debug tool is not working correctly and should be used with caution. It may not properly switch roles or could cause unexpected behavior. ")],-1)),d("div",XL,[e[8]||(e[8]=d("strong",null,"Current User:",-1)),Ne(" "+J(((a=n.currentUser)==null?void 0:a.name)||((o=n.currentUser)==null?void 0:o.email)||"Unknown")+" ",1),e[9]||(e[9]=d("br",null,null,-1)),e[10]||(e[10]=d("strong",null,"Role:",-1)),e[11]||(e[11]=Ne()),d("span",{class:Qe("role-"+((l=n.currentUser)==null?void 0:l.role))},J(((c=n.currentUser)==null?void 0:c.role)||"None"),3),e[12]||(e[12]=d("br",null,null,-1)),e[13]||(e[13]=d("strong",null,"UID:",-1)),Ne(" "+J(((u=n.currentUser)==null?void 0:u.uid)||"None"),1)]),d("div",YL,[e[15]||(e[15]=d("label",{for:"role-select"},"Switch to Role:",-1)),we(d("select",{id:"role-select","onUpdate:modelValue":e[2]||(e[2]=f=>n.selectedRole=f),onChange:e[3]||(e[3]=(...f)=>n.switchRole&&n.switchRole(...f))},[e[14]||(e[14]=d("option",{value:""},"-- Select Role --",-1)),(N(!0),L(Re,null,Ve(n.availableRoles,f=>(N(),L("option",{key:f.value,value:f.value},J(f.label),9,QL))),128))],544),[[ur,n.selectedRole]])]),d("div",JL,[e[16]||(e[16]=d("h5",null,"Quick Test Users:",-1)),d("div",ZL,[(N(!0),L(Re,null,Ve(n.testUsers,f=>{var h;return N(),L("button",{key:f.uid,onClick:p=>n.switchToUser(f),class:Qe(["test-user-btn",{active:((h=n.currentUser)==null?void 0:h.uid)===f.uid}])},[Ne(J(f.name)+" ",1),d("small",null,"("+J(f.role)+")",1)],10,eB)}),128))])]),d("div",tB,[e[17]||(e[17]=d("h5",null,"Current Permissions:",-1)),n.loadingPermissions?(N(),L("div",rB," Loading permissions... ")):(N(),L("div",nB,[(N(!0),L(Re,null,Ve(n.currentPermissions,f=>(N(),L("div",{key:f.action,class:Qe(["permission-item",{granted:f.granted}])},[d("span",sB,J(f.granted?"✅":"❌"),1),Ne(" "+J(f.label),1)],2))),128))]))]),e[19]||(e[19]=Fr('<div class="testing-scenarios" data-v-bae46714><h5 data-v-bae46714>🧪 Testing Scenarios:</h5><div class="scenario-list" data-v-bae46714><div class="scenario-item" data-v-bae46714><strong data-v-bae46714>Students Page:</strong><ul data-v-bae46714><li data-v-bae46714>✅ Can view students</li><li data-v-bae46714>✅ Can edit own caseload (CM)</li><li data-v-bae46714>✅ Can edit all students (Admin)</li><li data-v-bae46714>✅ Paraeducator filter works</li></ul></div><div class="scenario-item" data-v-bae46714><strong data-v-bae46714>Admin Panel:</strong><ul data-v-bae46714><li data-v-bae46714>✅ Users management</li><li data-v-bae46714>✅ Permissions matrix</li><li data-v-bae46714>✅ Aide assignments</li><li data-v-bae46714>✅ App settings</li></ul></div><div class="scenario-item" data-v-bae46714><strong data-v-bae46714>Navigation:</strong><ul data-v-bae46714><li data-v-bae46714>✅ Admin button visibility</li><li data-v-bae46714>✅ My Schedule button (Para)</li><li data-v-bae46714>✅ Role-based menu items</li></ul></div></div></div>',1)),d("div",aB,[d("button",{onClick:e[4]||(e[4]=(...f)=>n.resetToRealUser&&n.resetToRealUser(...f)),class:"reset-btn"}," 🔄 Reset to Real User "),d("button",{onClick:e[5]||(e[5]=(...f)=>n.refreshPage&&n.refreshPage(...f)),class:"refresh-btn"}," 🔄 Refresh Page ")])])):_e("",!0)],2)):_e("",!0)}const oB=yt(WL,[["render",iB],["__scopeId","data-v-bae46714"]]),lB={key:0,class:"debug-access-info"},cB={__name:"DebugAccessInfo",setup(t){const e=xa(),r=se(!1),n=Se(()=>e.currentUser),s=Se(()=>{var o;const a=(o=n.value)==null?void 0:o.role;return["admin","administrator"].includes(a)}),i=()=>{r.value=!1,localStorage.setItem("debug-info-hidden","true")};return Ut(()=>{const a=localStorage.getItem("debug-info-hidden");s.value&&!a&&setTimeout(()=>{r.value=!0},3e3)}),(a,o)=>r.value?(N(),L("div",lB,[d("div",{class:"debug-info-content"},[o[0]||(o[0]=d("span",{class:"debug-info-icon"},"🔧",-1)),o[1]||(o[1]=d("span",{class:"debug-info-text"},[Ne("Debug tools available - Press "),d("kbd",null,"Ctrl+Shift+D")],-1)),d("button",{onClick:i,class:"debug-info-close"},"×")])])):_e("",!0)}},uB=yt(cB,[["__scopeId","data-v-358a31dd"]]);class dB{constructor(){this.timeoutId=null,this.warningTimeoutId=null,this.isEnabled=se(!1),this.timeoutMinutes=se(30),this.showWarning=se(!1),this.warningCountdown=se(0),this.lastActivity=Date.now(),this.router=null,this.unsubscribeSettings=null,this.activityEvents=["mousedown","mousemove","keypress","scroll","touchstart","click","keydown"],this.init()}init(){this.loadSettings(),this.setupActivityListeners(),this.setupAuthWatcher()}setupAuthWatcher(){tp(St,e=>{e?setTimeout(()=>{this.resetTimeout()},1e3):(this.clearTimeouts(),this.hideWarning())})}async loadSettings(){try{const e=Ze(ze,"app_settings","security");this.unsubscribeSettings=Ac(e,r=>{if(r.exists()){const n=r.data(),s=this.isEnabled.value;this.isEnabled.value=n.sessionTimeoutEnabled||!1,this.timeoutMinutes.value=n.sessionTimeoutMinutes||30,St.currentUser&&this.resetTimeout()}else this.isEnabled.value=!1,this.timeoutMinutes.value=30})}catch(e){console.error("Failed to load session timeout settings:",e)}}async updateSettings(e,r){var n;try{const s=Ze(ze,"app_settings","security");await Ht(s,{sessionTimeoutEnabled:e,sessionTimeoutMinutes:r,updatedAt:new Date().toISOString(),updatedBy:(n=St.currentUser)==null?void 0:n.uid},{merge:!0})}catch(s){console.error("Failed to update session timeout settings:",s)}}setupActivityListeners(){this.activityEvents.forEach(e=>{document.addEventListener(e,this.handleActivity.bind(this),!0)})}handleActivity(){this.isEnabled.value&&(this.lastActivity=Date.now(),this.hideWarning(),this.resetTimeout())}resetTimeout(){if(!this.isEnabled.value||!St.currentUser)return;this.clearTimeouts();const e=Math.round(this.timeoutMinutes.value*60*1e3),r=Math.max(0,e-2*60*1e3);r>0&&r<e&&(this.warningTimeoutId=setTimeout(()=>{this.showSessionWarning()},r)),this.timeoutId=setTimeout(()=>{this.handleSessionTimeout()},e)}showSessionWarning(){this.showWarning.value=!0,this.warningCountdown.value=120;const e=setInterval(()=>{this.warningCountdown.value--,this.warningCountdown.value<=0&&(clearInterval(e),this.handleSessionTimeout())},1e3);this.countdownInterval=e}hideWarning(){this.showWarning.value=!1,this.warningCountdown.value=0,this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}async handleSessionTimeout(){try{if(St.currentUser){const e=Ze(ze,"auditLogs",`timeout_${Date.now()}_${St.currentUser.uid}`);await Ht(e,{type:"session_timeout",userId:St.currentUser.uid,userEmail:St.currentUser.email,timeoutMinutes:this.timeoutMinutes.value,lastActivity:new Date(this.lastActivity),timestamp:new Date,userAgent:navigator.userAgent})}this.clearTimeouts(),this.hideWarning(),await rp(St),alert(`Your session has expired after ${this.timeoutMinutes.value} minutes of inactivity. Please log in again.`),this.router?this.router.push("/login"):window.location.href="/login"}catch(e){console.error("Error during session timeout:",e)}}extendSession(){this.hideWarning(),this.resetTimeout()}clearTimeouts(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.warningTimeoutId&&(clearTimeout(this.warningTimeoutId),this.warningTimeoutId=null)}setRouter(e){this.router=e}destroy(){this.clearTimeouts(),this.hideWarning(),this.activityEvents.forEach(e=>{document.removeEventListener(e,this.handleActivity.bind(this),!0)}),this.unsubscribeSettings&&this.unsubscribeSettings()}}const Xs=new dB;function Px(){const t=wi();return Xs.setRouter(t),{isEnabled:Xs.isEnabled,timeoutMinutes:Xs.timeoutMinutes,showWarning:Xs.showWarning,warningCountdown:Xs.warningCountdown,updateSettings:Xs.updateSettings.bind(Xs),extendSession:Xs.extendSession.bind(Xs),resetTimeout:Xs.resetTimeout.bind(Xs)}}const fB={key:0,class:"session-timeout-overlay"},hB={class:"session-timeout-dialog"},pB={class:"dialog-content"},mB={class:"countdown"},gB={class:"countdown-time"},vB={class:"dialog-actions"},xB={__name:"SessionTimeoutDialog",setup(t){const e=wi(),{showWarning:r,warningCountdown:n,extendSession:s}=Px(),i=o=>{const l=Math.floor(o/60),c=o%60;return`${l}:${c.toString().padStart(2,"0")}`},a=async()=>{try{await rp(St),e.push("/login")}catch(o){console.error("Error signing out:",o)}};return(o,l)=>ee(r)?(N(),L("div",fB,[d("div",hB,[l[3]||(l[3]=d("div",{class:"dialog-header"},[d("h3",null,"⏰ Session Timeout Warning")],-1)),d("div",pB,[l[1]||(l[1]=d("p",null,"Your session will expire in:",-1)),d("div",mB,[d("span",gB,J(i(ee(n))),1)]),l[2]||(l[2]=d("p",null,"You will be automatically logged out for security purposes.",-1))]),d("div",vB,[d("button",{onClick:l[0]||(l[0]=(...c)=>ee(s)&&ee(s)(...c)),class:"btn btn-primary"}," Stay Logged In "),d("button",{onClick:a,class:"btn btn-secondary"}," Logout Now ")])])])):_e("",!0)}},yB=yt(xB,[["__scopeId","data-v-db34d9f2"]]),iu={primaryColor:"#1976d2",primaryHover:"#1565c0",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",secondaryColor:"#6c757d",secondaryHover:"#545b62",secondaryLight:"#f8f9fa",secondaryDark:"#495057",bgPrimary:"#f4f6f9",bgSecondary:"#ffffff",bgTertiary:"#f8f9fa",bgMuted:"#e9ecef",textPrimary:"#333333",textSecondary:"#666666",textMuted:"#999999",textInverse:"#ffffff",borderColor:"#dee2e6",borderLight:"#e9ecef",borderDark:"#adb5bd",borderFocus:"#1976d2",successColor:"#28a745",successHover:"#218838",successLight:"#d4edda",warningColor:"#ffc107",warningHover:"#e0a800",warningLight:"#fff3cd",errorColor:"#dc3545",errorHover:"#c82333",errorLight:"#f8d7da",infoColor:"#17a2b8",infoHover:"#138496",infoLight:"#d1ecf1",adminTabBg:"#f8f9fa",adminTabActive:"#2a79c9",adminTabHover:"#e3eaf6",tableHeaderBg:"#dfe7f3",tableStripeBg:"#f8fafd",tableBorder:"#d1d1d1",tableHover:"#f0f0f0",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",shadowSm:"0 1px 2px rgba(0, 0, 0, 0.05)",shadowMd:"0 2px 4px rgba(0, 0, 0, 0.1)",shadowLg:"0 4px 6px rgba(0, 0, 0, 0.1)",shadowXl:"0 4px 20px rgba(0, 0, 0, 0.3)",fontFamilyBase:"'Inter', 'Segoe UI', 'Arial', sans-serif",fontSizeXs:"0.75rem",fontSizeSm:"0.875rem",fontSizeBase:"1rem",fontSizeLg:"1.125rem",fontSizeXl:"1.25rem",fontSizeXxl:"1.5rem"},_b={primaryColor:"--primary-color",primaryHover:"--primary-hover",primaryLight:"--primary-light",primaryDark:"--primary-dark",secondaryColor:"--secondary-color",secondaryHover:"--secondary-hover",secondaryLight:"--secondary-light",secondaryDark:"--secondary-dark",bgPrimary:"--bg-primary",bgSecondary:"--bg-secondary",bgTertiary:"--bg-tertiary",bgMuted:"--bg-muted",textPrimary:"--text-primary",textSecondary:"--text-secondary",textMuted:"--text-muted",textInverse:"--text-inverse",borderColor:"--border-color",borderLight:"--border-light",borderDark:"--border-dark",borderFocus:"--border-focus",successColor:"--success-color",successHover:"--success-hover",successLight:"--success-light",warningColor:"--warning-color",warningHover:"--warning-hover",warningLight:"--warning-light",errorColor:"--error-color",errorHover:"--error-hover",errorLight:"--error-light",infoColor:"--info-color",infoHover:"--info-hover",infoLight:"--info-light",adminTabBg:"--admin-tab-bg",adminTabActive:"--admin-tab-active",adminTabHover:"--admin-tab-hover",tableHeaderBg:"--table-header-bg",tableStripeBg:"--table-stripe-bg",tableBorder:"--table-border",tableHover:"--table-hover",borderRadiusSm:"--border-radius-sm",borderRadiusMd:"--border-radius-md",borderRadiusLg:"--border-radius-lg",borderRadiusXl:"--border-radius-xl",shadowSm:"--shadow-sm",shadowMd:"--shadow-md",shadowLg:"--shadow-lg",shadowXl:"--shadow-xl",fontFamilyBase:"--font-family-base",fontSizeXs:"--font-size-xs",fontSizeSm:"--font-size-sm",fontSizeBase:"--font-size-base",fontSizeLg:"--font-size-lg",fontSizeXl:"--font-size-xl",fontSizeXxl:"--font-size-xxl"};function U4(){const t=se({...iu}),e=se(!1),r=se(null),n=se(!1),s=async()=>{if(e.value)return t.value;e.value=!0,r.value=null;try{const m=Ze(ze,"app_settings","theme"),v=await Jt(m);if(v.exists()){const g=v.data();t.value={...iu,...g},console.log("Theme loaded from database:",t.value)}else t.value={...iu},console.log("No saved theme found, using defaults");return n.value=!0,a(t.value),t.value}catch(m){throw r.value=m.message,console.error("Error loading theme:",m),m}finally{e.value=!1}},i=async(m=t.value)=>{e.value=!0,r.value=null;try{const v=Ze(ze,"app_settings","theme");return await Ht(v,{...m,lastUpdated:new Date().toISOString()}),t.value={...m},a(m),console.log("Theme saved successfully"),!0}catch(v){throw r.value=v.message,console.error("Error saving theme:",v),v}finally{e.value=!1}},a=m=>{const v=document.documentElement;Object.entries(_b).forEach(([g,y])=>{m[g]!==void 0&&v.style.setProperty(y,m[g])})},o=(m,v)=>{t.value[m]=v,a(t.value)},l=async()=>{t.value={...iu},a(t.value),await i(t.value)},c=m=>{a(m)},u=()=>{a(t.value)},f=m=>getComputedStyle(document.documentElement).getPropertyValue(m),h=m=>/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$|^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)$/.test(m),p=m=>({light:m,dark:m,hover:m});return Ut(()=>{n.value||s()}),{currentTheme:t,loading:e,error:r,isInitialized:n,loadTheme:s,saveTheme:i,applyTheme:a,updateThemeProperty:o,resetTheme:l,previewTheme:c,revertTheme:u,getCssVariableValue:f,validateColor:h,generateColorVariations:p,CSS_VARIABLE_MAP:_b,DEFAULT_THEME:iu}}function EB(){const{loadTheme:t,currentTheme:e,isInitialized:r}=U4();return Ut(async()=>{if(!r.value)try{await t(),console.log("Theme initialized successfully")}catch(n){console.error("Failed to initialize theme:",n)}}),{currentTheme:e,isInitialized:r}}const _B={id:"app"},bB={id:"main-content"},SB={__name:"App",setup(t){const e=se(!1);EB();const r=n=>{n.ctrlKey&&n.shiftKey&&n.key==="D"&&(n.preventDefault(),e.value=!e.value,console.log("Debug Role Switcher:",e.value?"Shown":"Hidden"))};return Ut(()=>{document.addEventListener("keydown",r)}),Ba(()=>{document.removeEventListener("keydown",r)}),(n,s)=>{const i=Ar("router-view");return N(),L("div",_B,[d("div",bB,[nt(i)]),e.value?(N(),Kr(oB,{key:0})):_e("",!0),nt(uB),nt(yB)])}}},AB="modulepreload",TB=function(t){return"/"+t},bb={},aa=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=TB(l),l in bb)return;bb[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":AB,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function pn(t,e=255){return typeof t!="string"?"":t.trim().replace(/\0/g,"").replace(/[<>'"&]/g,"").substring(0,e)}function wB(t){return typeof t!="string"?"":t.trim().toLowerCase().substring(0,255)}function Sb(t,e=0,r=999999){const n=parseFloat(t);return isNaN(n)?0:Math.max(e,Math.min(r,n))}function S0(t,e){return!t||typeof t=="string"&&t.trim()===""?{isValid:!1,error:`${e} is required`}:{isValid:!0}}function CB(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}}function Ad(t,e,r=0,n=255){return typeof t!="string"?{isValid:!1,error:`${e} must be a string`}:t.length<r?{isValid:!1,error:`${e} must be at least ${r} characters`}:t.length>n?{isValid:!1,error:`${e} must be no more than ${n} characters`}:{isValid:!0}}function IB(t){return["admin","administrator","administrator_504_CM","sped_chair","case_manager","teacher","service_provider","paraeducator"].includes(t)?{isValid:!0}:{isValid:!1,error:"Invalid role"}}function kB(t,e=[],r=10*1024*1024){return t?e.length>0&&!e.includes(t.type)?{isValid:!1,error:`Invalid file type. Allowed: ${e.join(", ")}`}:t.size>r?{isValid:!1,error:`File too large. Maximum size: ${r/(1024*1024)}MB`}:[/\.exe$/i,/\.bat$/i,/\.cmd$/i,/\.scr$/i,/\.vbs$/i,/\.js$/i,/\.jar$/i].some(s=>s.test(t.name))?{isValid:!1,error:"Suspicious file type detected"}:{isValid:!0}:{isValid:!1,error:"No file selected"}}function qr(t){if(typeof t!="string")return{isSafe:!0,threats:[]};const e=[];return/<script|javascript:|vbscript:|onload=|onerror=/i.test(t)&&e.push("Script injection attempt"),/(\bunion\b|\bselect\b|\binsert\b|\bupdate\b|\bdelete\b|\bdrop\b).*(\bfrom\b|\binto\b|\bwhere\b)/i.test(t)&&e.push("SQL injection pattern"),/\.\.\/|\.\.\\|%2e%2e%2f|%2e%2e%5c/i.test(t)&&e.push("Path traversal attempt"),/<[^>]*>/i.test(t)&&e.push("HTML injection attempt"),/\0/.test(t)&&e.push("Null byte injection"),{isSafe:e.length===0,threats:e}}const Dl={};function Is(t,e=10,r=6e4){const n=Date.now(),s=`${t}_${Math.floor(n/r)}`;return Dl[s]||(Dl[s]=0),Dl[s]++,Dl[s]>e?{allowed:!1,error:`Rate limit exceeded. Maximum ${e} requests per ${r/1e3} seconds.`}:(Object.keys(Dl).forEach(i=>{const a=parseInt(i.split("_").pop())*r;n-a>r*2&&delete Dl[i]}),{allowed:!0})}function $4(t,e={}){const r=[],{isNew:n=!1}=e;if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid student data"]};if(!t.app||!t.app.studentData)return r.push("Student data structure is invalid"),{isValid:!1,errors:r};const s=t.app.studentData;return[{field:"firstName",name:"First Name"},{field:"lastName",name:"Last Name"},{field:"caseManagerId",name:"Case Manager"}].forEach(({field:l,name:c})=>{const u=S0(s[l],c);u.isValid||r.push(u.error)}),[{field:"firstName",name:"First Name",maxLength:100},{field:"lastName",name:"Last Name",maxLength:100},{field:"studentId",name:"Student ID",maxLength:50},{field:"grade",name:"Grade",maxLength:10}].forEach(({field:l,name:c,maxLength:u})=>{if(s[l]){const f=Ad(s[l],c,1,u);f.isValid||r.push(f.error)}}),["firstName","lastName","studentId","grade"].forEach(l=>{if(s[l]){const c=qr(s[l]);c.isSafe||r.push(`Security threat detected in ${l}: ${c.threats.join(", ")}`)}}),t.app.accommodations&&typeof t.app.accommodations!="string"&&t.app.accommodations!==null&&r.push("Accommodations must be encrypted string or null"),t.app.classServices&&typeof t.app.classServices!="string"&&t.app.classServices!==null&&r.push("Class services must be encrypted string or null"),s.plan&&typeof s.plan!="string"&&s.plan!==null&&r.push("Student plan must be encrypted string or null"),{isValid:r.length===0,errors:r}}function DB(t){const e=[];if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid user data"]};const r=S0(t.name,"Name");r.isValid||e.push(r.error);const n=S0(t.email,"Email");n.isValid||e.push(n.error);const s=S0(t.role,"Role");if(s.isValid||e.push(s.error),t.email){const a=CB(t.email);a.isValid||e.push(a.error)}if(t.role){const a=IB(t.role);a.isValid||e.push(a.error)}if(t.name){const a=Ad(t.name,"Name",1,100);a.isValid||e.push(a.error)}if(t.email){const a=Ad(t.email,"Email",1,255);a.isValid||e.push(a.error)}return["name","email"].forEach(a=>{if(t[a]){const o=qr(t[a]);o.isSafe||e.push(`Security threat detected in ${a}: ${o.threats.join(", ")}`)}}),{isValid:e.length===0,errors:e}}function V4(t){const e={...t};if(e.app&&e.app.studentData){const r=e.app.studentData;["firstName","lastName","studentId","grade"].forEach(s=>{r[s]&&(r[s]=pn(r[s],100))})}else["firstName","lastName","studentId","grade"].forEach(n=>{e[n]&&(e[n]=pn(e[n],100))});return e}function PB(t){const e={...t};return e.name&&(e.name=pn(e.name,100)),e.email&&(e.email=wB(e.email)),e}const RB=async(t,e,r=100,n=1e3)=>{const s=[];for(let a=0;a<t.length;a+=r)s.push(t.slice(a,a+r));const i=[];for(let a=0;a<s.length;a++)try{const o=await e(s[a]);i.push(o),a<s.length-1&&await new Promise(l=>setTimeout(l,n))}catch(o){throw console.error(`Error in batch ${a+1}:`,o),o}return i},Vc=kB;function ph(t){if(!t||typeof t!="object")return t;if(t.toJSON&&typeof t.toJSON=="function")return t.toJSON();if(Array.isArray(t))return t.map(ph);const e={};for(const[r,n]of Object.entries(t)){if(r.toLowerCase().includes("schedule")&&typeof n=="object"&&n!==null)for(const[s,i]of Object.entries(n))i&&typeof i=="object"&&i.teacherId!==void 0&&(n[s].teacherId=String(i.teacherId));e[r]=ph(n)}return e}function Ua(){const t=se([]);let e=null;async function r(){if(!e)try{const{useGoogleSheetsRealtime:c}=await aa(async()=>{const{useGoogleSheetsRealtime:u}=await Promise.resolve().then(()=>Vce);return{useGoogleSheetsRealtime:u}},void 0);e=c()}catch(c){console.error("Failed to load Google Sheets sync:",c)}return e}async function n(){var f,h,p;const c=await $t(bt(ze,"students"));t.value=c.docs.map(m=>{const v=m.data(),g=ph(v);return{id:m.id,...g}});const u=t.value.find(m=>m.aeries);u&&(console.log("🔍 useStudents DEBUG - Student with aeries:",u),console.log("🔍 useStudents DEBUG - aeries.schedule:",(f=u.aeries)==null?void 0:f.schedule),console.log("🔍 useStudents DEBUG - aeries.schedule type:",typeof((h=u.aeries)==null?void 0:h.schedule)),(p=u.aeries)!=null&&p.schedule&&console.log("🔍 useStudents DEBUG - schedule keys:",Object.keys(u.aeries.schedule)))}function s(c){t.value=c.map(u=>{const f=ph(u);return{id:u.id,...f}})}async function i(){return(await $t(bt(ze,"students"))).docs.map(u=>({id:u.id,...u.data()}))}async function a(c,u){await Cp(Ze(ze,"students",c),u);try{const f=await r();if(f&&f.linkedSheetId.value){const h=t.value.findIndex(p=>p.id===c);h!==-1&&(t.value[h]={...t.value[h],...u}),console.log("Syncing student update to Google Sheets..."),await f.updateSheetData(t.value)}}catch(f){console.error("Failed to sync to Google Sheets:",f)}}async function o(c){var f,h,p,m,v,g,y;const u=t.value.find(E=>E.id===c);await ho(Ze(ze,"students",c)),await tn.logStudentAccess(c,"delete",{studentName:u?`${((h=(f=u.app)==null?void 0:f.studentData)==null?void 0:h.firstName)||""} ${((m=(p=u.app)==null?void 0:p.studentData)==null?void 0:m.lastName)||""}`.trim():"Unknown",ssid:(g=(v=u==null?void 0:u.app)==null?void 0:v.studentData)==null?void 0:g.ssid,deletedFields:u?Object.keys(((y=u.app)==null?void 0:y.studentData)||{}):[]});try{const E=await r();E&&E.linkedSheetId.value&&(t.value=t.value.filter(b=>b.id!==c),console.log("Syncing student deletion to Google Sheets..."),await E.updateSheetData(t.value))}catch(E){console.error("Failed to sync to Google Sheets:",E)}}return{students:t,fetchStudents:n,setStudents:s,fetchAllStudents:i,updateStudent:a,deleteStudent:o,deleteAllStudents:async()=>{try{const u=(await $t(bt(ze,"students"))).docs;return await tn.logStudentAccess("bulk_operation","delete_all",{studentCount:u.length,operation:"bulk_delete_all_students",deletedStudentIds:u.map(f=>f.id)}),await RB(u,async f=>{const h=yx(ze);f.forEach(p=>{h.delete(p.ref)}),await h.commit()},50,2e3),{success:!0}}catch(c){throw console.error("Error deleting all students:",c),await tn.logStudentAccess("bulk_operation","delete_all_failed",{error:c.message,operation:"bulk_delete_all_students_failed"}),c}}}}function ya(){const t=se({}),e=se([]);async function r(){const a=await $t(bt(ze,"users")),o={},l=[];a.forEach(c=>{const u=c.data();o[c.id]={id:c.id,...u},l.push({id:c.id,...u}),u.aeriesId&&console.log("🔍 Loaded user with Aeries ID:",{name:u.name,email:u.email,aeriesId:u.aeriesId,id:c.id})}),t.value=o,e.value=l,console.log("📚 Total users loaded:",l.length),console.log("🔑 Users with Aeries IDs:",l.filter(c=>c.aeriesId).length)}const n=Se(()=>({teachers:e.value.filter(a=>["teacher","case_manager","sped_chair"].includes(a.role)),caseManagers:e.value.filter(a=>["case_manager","sped_chair","admin_504","administrator_504_CM"].includes(a.role)),speech:e.value.filter(a=>a.provider==="SLP"),ot:e.value.filter(a=>a.provider==="OT"),mh:e.value.filter(a=>a.provider==="MH"),pt:e.value.filter(a=>a.provider==="PT"),sc:e.value.filter(a=>a.provider==="SC"),tr:e.value.filter(a=>a.provider==="TR"),aud:e.value.filter(a=>a.provider==="AUD"),vi:e.value.filter(a=>a.provider==="VI"),at:e.value.filter(a=>a.provider==="AT"),dhh:e.value.filter(a=>a.provider==="DHH"),om:e.value.filter(a=>a.provider==="O&M"),bis:e.value.filter(a=>a.provider==="BIS"),hn:e.value.filter(a=>a.provider==="HN"),sw:e.value.filter(a=>a.provider==="SW")})),s=Se(()=>e.value.filter(a=>["case_manager","sped_chair","admin_504","administrator_504_CM"].includes(a.role))),i=Se(()=>e.value.filter(a=>["teacher","case_manager","sped_chair"].includes(a.role)));return{users:t,userList:e,fetchUsers:r,caseManagers:s,teacherList:i,userRoles:n}}function Rx(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const h=await $t(bt(ze,"aideSchedules")),p={};h.forEach(m=>{p[m.id]=m.data()}),t.value=p}catch(h){console.error("Error loading aide assignments:",h),t.value={}}finally{e.value=!1}}async function n(h){if(!h){console.warn("loadAideAssignment called without aideId");return}e.value=!0;try{const p=await Jt(Ze(ze,"aideSchedules",h));p.exists()?t.value[h]=p.data():t.value[h]={classAssignment:{},directAssignment:[]}}catch(p){console.error("Error loading aide assignment:",p),t.value[h]={classAssignment:{},directAssignment:[]}}finally{e.value=!1}}async function s(h,p){try{const m=JSON.parse(JSON.stringify(p));await Ht(Ze(ze,"aideSchedules",h),m,{merge:!0}),t.value[h]=m}catch(m){throw console.error("Error saving aide assignment:",m),m}}async function i(){try{const h=Object.entries(t.value);for(const[p,m]of h){const v=JSON.parse(JSON.stringify(m));await Ht(Ze(ze,"aideSchedules",p),v,{merge:!0})}}catch(h){throw console.error("Error saving all aide assignments:",h),h}}function a(h,p){const m=[];return Object.entries(t.value).forEach(([v,g])=>{g.classAssignment&&g.classAssignment[p]&&(Array.isArray(g.classAssignment[p])?g.classAssignment[p]:[g.classAssignment[p]]).includes(h)&&m.push(v)}),m}function o(h){var m;const p=(m=t.value[h])==null?void 0:m.directAssignment;return Array.isArray(p)?p.length>0?p[0]:null:p||null}function l(h){return Object.keys(t.value).find(m=>{var g;const v=(g=t.value[m])==null?void 0:g.directAssignment;return Array.isArray(v)?v.includes(h):v===h})||null}function c(h,p,m){const v=[],g=t.value[h];return g&&((Array.isArray(g.directAssignment)?g.directAssignment:g.directAssignment?[g.directAssignment]:[]).forEach(E=>{if(E){const b=p.find(k=>k.id===E);b&&v.push({...b,assignmentType:"direct"})}}),Object.entries(g.classAssignment||{}).forEach(([E,b])=>{b&&(Array.isArray(b)?b:[b]).forEach(P=>{P&&p.forEach(w=>{const x=f(w);if(x){const S=x[E];if((typeof S=="string"?S:S==null?void 0:S.teacherId)===P){const A=v.findIndex(C=>C.id===w.id);A===-1?v.push({...w,assignmentType:"class",period:E,teacherId:P}):(v[A].assignmentType="both",v[A].period=E,v[A].teacherId=P)}}})})})),v}function u(h,p,m,v){if(!h||!p||!m||!v)return!1;const g=m.find(w=>w.id===p);if(!g)return!1;const y=t.value[h];if(!y)return!1;if((Array.isArray(y.directAssignment)?y.directAssignment:y.directAssignment?[y.directAssignment]:[]).includes(p))return!0;const b=f(g);if(!b)return!1;const k=y.classAssignment||{};return Object.entries(b).some(([w,x])=>{const S=typeof x=="string"?x:x==null?void 0:x.teacherId,_=k[w];return!_||!S?!1:(Array.isArray(_)?_:[_]).includes(S)})}function f(h){var p,m,v,g,y;return h.schedule?h.schedule:(m=(p=h.app)==null?void 0:p.schedule)!=null&&m.periods?h.app.schedule.periods:(g=(v=h.aeries)==null?void 0:v.schedule)!=null&&g.periods?h.aeries.schedule.periods:(y=h.aeries)!=null&&y.schedule?h.aeries.schedule:null}return{aideAssignment:Se(()=>t.value),loading:Se(()=>e.value),loadAideAssignments:r,loadAideAssignment:n,saveAideAssignment:s,saveAllAideAssignments:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}function Fx(){const t=se(!1),e=se(""),r=se("");let n,s,i,a;try{n=oc(),s=Ca(n,"getStudentFeedback"),i=Ca(n,"createFeedbackFormSheet"),a=Ca(n,"createFeedbackFormSheetWithUserAuth")}catch(k){console.warn("Firebase Functions not available:",k),s=()=>Promise.reject(new Error("Functions not available")),i=()=>Promise.reject(new Error("Functions not available")),a=()=>Promise.reject(new Error("Functions not available"))}const o=bt(ze,"feedbackForms"),l=se(!1),c=se([]);let u;const f=Se(()=>{var P;return(((P=c.value)==null?void 0:P.filter(w=>w.active!==!1))||[]).sort((w,x)=>{var A,C;const S=(A=w.createdAt)!=null&&A.seconds?new Date(w.createdAt.seconds*1e3):new Date(w.createdAt);return((C=x.createdAt)!=null&&C.seconds?new Date(x.createdAt.seconds*1e3):new Date(x.createdAt))-S})}),h=async k=>{try{t.value=!0,e.value="",console.log("🔄 Creating Google Sheet with personal account for form:",k.title);const P=await i({title:k.title,description:k.description,formUrl:k.formUrl,studentId:k.studentId||null,studentName:k.studentName||null});if(!P.data.success)throw new Error("Failed to create Google Sheet: "+P.data.message);console.log("✅ Google Sheet created:",P.data.spreadsheetUrl);const w={title:k.title,description:k.description,formUrl:k.formUrl,spreadsheetId:P.data.spreadsheetId,spreadsheetUrl:P.data.spreadsheetUrl,userDriveId:P.data.userDriveId,parentFolderId:P.data.parentFolderId,active:!0,createdAt:new Date,createdBy:k.createdBy},x=Ze(o);return await Ht(x,w),r.value="Feedback form and Google Sheet created successfully!",{id:x.id,...w}}catch(P){throw console.error("Error creating feedback form:",P),P.message.includes("storage quota exceeded")||P.message.includes("Service account storage quota exceeded")?P.value='❌ Cannot create Google Sheet: Service account has no storage quota. Please use the "Test with Personal Account" button in Google Drive Setup to use your personal Google account instead.':P.message.includes("permission")||P.message.includes("access")?P.value="❌ Permission denied: Please ensure the folder is shared with the service account or use your personal Google account.":P.value=P.message,P}finally{t.value=!1}},p=async(k,P)=>{try{t.value=!0,e.value="";const w=Ze(o,k);await Ht(w,{...P,updatedAt:new Date},{merge:!0}),r.value="Feedback form updated successfully!"}catch(w){throw console.error("Error updating feedback form:",w),e.value=w.message,w}finally{t.value=!1}},m=async k=>{try{t.value=!0,e.value="";const P=Ze(o,k);await ho(P),r.value="Feedback form deleted successfully!"}catch(P){throw console.error("Error deleting feedback form:",P),e.value=P.message,P}finally{t.value=!1}},v=()=>{e.value="",r.value=""},g=k=>{const P=k.match(/\/forms\/d\/([a-zA-Z0-9-_]+)/);return P?P[1]:null},y=()=>{try{u=Ac(o,k=>{c.value=k.docs.map(P=>({id:P.id,...P.data()})),l.value=!1},k=>{console.warn("Error listening to feedback forms:",k),l.value=!1})}catch(k){console.warn("Error initializing Firestore listeners:",k),l.value=!1}},E=()=>{u&&u()};return Ut(()=>{y()}),Ba(()=>{E()}),{isLoading:t,error:e,successMessage:r,formsLoading:l,feedbackForms:c,activeForms:f,createFeedbackForm:h,updateFeedbackForm:p,deleteFeedbackForm:m,clearMessages:v,extractFormId:g,createFeedbackFormWithUserAuth:async(k,P)=>{try{t.value=!0,e.value="",console.log("🔄 Creating Google Sheet with personal account for form:",k.title);const w=await a({title:k.title,description:k.description,formUrl:k.formUrl,studentId:k.studentId||null,studentName:k.studentName||null,accessToken:P});if(!w.data.success)throw new Error("Failed to create Google Sheet: "+w.data.message);console.log("✅ Google Sheet created with personal account:",w.data.spreadsheetUrl);const x={title:k.title,description:k.description,formUrl:k.formUrl,spreadsheetId:w.data.spreadsheetId,spreadsheetUrl:w.data.spreadsheetUrl,driveType:"personal",active:!0,createdAt:new Date,createdBy:k.createdBy},S=Ze(o);return await Ht(S,x),r.value="Feedback form and Google Sheet created successfully in your personal Google Drive!",{id:S.id,...x}}catch(w){throw console.error("Error creating feedback form with user auth:",w),w.value=w.message,w}finally{t.value=!1}}}}function FB(){const t=xa(),e=se(!1),r=se(null),n=se([]),s=se(0),i=Se(()=>t.user),a=Se(()=>{var k;return(k=t.user)==null?void 0:k.role}),o=Se(()=>{var k;return(k=t.user)==null?void 0:k.uid}),l=async()=>{console.log("🔍 Admin query: Loading all students - START"),console.log("🔍 Admin query: currentUser:",i.value),console.log("🔍 Admin query: currentRole:",a.value),console.log("🔍 Admin query: currentUserId:",o.value);try{const k=nr(bt(ze,"students"),Gr("app.studentData.lastName","asc"));console.log("🔍 Admin query created:",k);const P=await $t(k);console.log("🔍 Admin query snapshot:",P.size,"documents");const w=P.docs.map(x=>({id:x.id,...x.data()}));if(console.log("🔍 Admin query result:",w.length,"students"),w.length>0)console.log("🔍 First student structure:",w[0]);else{console.log("🔍 Admin query: NO STUDENTS FOUND - checking collection directly");const x=nr(bt(ze,"students")),S=await $t(x);console.log("🔍 Simple query found:",S.size,"documents")}return w}catch(k){console.error("🔴 Admin query error:",k),console.error("🔴 Admin query error details:",k.message,k.code);try{console.log("🔍 Trying fallback query without ordering...");const P=nr(bt(ze,"students")),w=await $t(P);console.log("🔍 Fallback query found:",w.size,"documents");const x=w.docs.map(S=>({id:S.id,...S.data()}));return console.log("🔍 Fallback query returning:",x.length,"students"),x}catch(P){return console.error("🔴 Fallback query also failed:",P),console.error("🔴 Fallback query error details:",P.message,P.code),[]}}},c=async()=>{console.log("🔍 504 Admin query: Loading all students (edit restrictions applied at form level)");try{const k=nr(bt(ze,"students"),Gr("app.studentData.lastName","asc"));return(await $t(k)).docs.map(w=>({id:w.id,...w.data()}))}catch(k){console.error("🔴 504 Admin query error:",k);try{const P=nr(bt(ze,"students"));return(await $t(P)).docs.map(x=>({id:x.id,...x.data()}))}catch(P){return console.error("🔴 504 Admin fallback query failed:",P),[]}}},u=async()=>{console.log("🔍 SPED Chair query: Loading only IEP students");try{const k=nr(bt(ze,"students"),Rr("app.studentData.plan","==","IEP"),Gr("app.studentData.lastName","asc"));return(await $t(k)).docs.map(w=>({id:w.id,...w.data()}))}catch(k){console.error("🔴 SPED Chair query error:",k);try{const P=nr(bt(ze,"students"),Rr("app.studentData.plan","==","IEP"));return(await $t(P)).docs.map(x=>({id:x.id,...x.data()}))}catch(P){return console.error("🔴 SPED Chair fallback query failed:",P),[]}}},f=async k=>{console.log("🔒 Security: Loading students for case manager using staffIds:",k);try{const P=nr(bt(ze,"students"),Rr("app.staffIds","array-contains",k),Gr("app.studentData.lastName","asc")),x=(await $t(P)).docs.map(S=>({id:S.id,...S.data()}));return console.log("🔒 Security: Case manager has access to",x.length,"students via staffIds"),console.log("🔒 Security: CM accessible students:",x.map(S=>{var _,A,C,T;return`${(A=(_=S.app)==null?void 0:_.studentData)==null?void 0:A.firstName} ${(T=(C=S.app)==null?void 0:C.studentData)==null?void 0:T.lastName}`}).slice(0,5)),x}catch(P){return console.error("🔒 Security: Error loading case manager students:",P),[]}},h=async k=>{console.log("🔍 Teacher query: Loading students for teacher",k);try{const P=nr(bt(ze,"students"),Rr("app.staffIds","array-contains",k),Gr("app.studentData.lastName","asc")),w=await $t(P);return console.log("🔍 Teacher query: Found",w.size,"students with teacher in staffIds"),w.docs.map(x=>({id:x.id,...x.data()}))}catch(P){return console.error("🔒 Security: Error loading teacher students:",P),[]}},p=async k=>{var P,w,x,S;console.log("🔍 Service Provider query: Loading students for provider",k),console.log("🔍 Service Provider query: userId type:",typeof k),console.log("🔍 Service Provider query: userId value:",JSON.stringify(k));try{const _=nr(bt(ze,"students"),Rr("app.staffIds","array-contains",k));console.log("🔍 Service Provider query: Executing staffIds query...");const A=await $t(_);console.log("🔍 Service Provider query: Success! Found",A.size,"students");const C=A.docs.map(T=>({id:T.id,...T.data()}));return C.sort((T,D)=>{var R,F,M,O;const V=((F=(R=T.app)==null?void 0:R.studentData)==null?void 0:F.lastName)||"",B=((O=(M=D.app)==null?void 0:M.studentData)==null?void 0:O.lastName)||"";return V.localeCompare(B)}),C}catch(_){console.error("🔴 Service Provider query FAILED:",_),console.error("🔴 Error code:",_.code),console.error("🔴 Error message:",_.message),console.error("🔴 Full error object:",_);const A=Yo();return console.error("🔴 Current auth state:",{uid:(P=A.currentUser)==null?void 0:P.uid,email:(w=A.currentUser)==null?void 0:w.email,customClaims:"Check in browser dev tools"}),console.error("🔴 Auth mismatch check:",{queryUserId:k,authUid:(x=A.currentUser)==null?void 0:x.uid,match:k===((S=A.currentUser)==null?void 0:S.uid)}),[]}},m=async k=>{var P,w,x,S;console.log("🔍 Paraeducator query: Loading students for aide",k),console.log("🔍 Paraeducator query: userId type:",typeof k),console.log("🔍 Paraeducator query: userId value:",JSON.stringify(k));try{console.log("🔍 Paraeducator query: Trying staffIds approach first...");try{const B=nr(bt(ze,"students"),Rr("app.staffIds","array-contains",k),Gr("app.studentData.lastName","asc")),R=await $t(B);if(console.log("🔍 Paraeducator query: staffIds approach found",R.size,"students"),R.size>0){const F=R.docs.map(M=>({id:M.id,...M.data()}));return console.log("🔍 Paraeducator query: SUCCESS with staffIds approach"),F}}catch(B){console.log("🔍 Paraeducator query: staffIds approach failed:",B.message)}console.log("🔍 Paraeducator query: Using aideSchedules fallback...");const _=await Jt(Ze(ze,"aideSchedules",k));if(!_.exists())return console.log("🔍 Paraeducator query: No aide schedule document found for",k),[];const A=_.data();console.log("🔍 Paraeducator query: Found aide data:",A);let C=[];if(A.studentIds&&Array.isArray(A.studentIds)?(C=A.studentIds,console.log("🔍 Paraeducator query: Using studentIds array:",C)):A.directAssignment&&(C=Array.isArray(A.directAssignment)?A.directAssignment:[A.directAssignment],console.log("🔍 Paraeducator query: Using directAssignment as fallback:",C)),C.length===0)return console.log("🔍 Paraeducator query: No student assignments found for aide",k),[];console.log("🔍 Paraeducator query: Fetching",C.length,"assigned students individually...");const T=C.map(async B=>{try{const R=await Jt(Ze(ze,"students",B));return R.exists()?{id:R.id,...R.data()}:null}catch(R){return console.warn("🔍 Paraeducator query: Failed to fetch student",B,":",R.message),null}}),V=(await Promise.all(T)).filter(B=>B!==null);return V.sort((B,R)=>{var O,K,j,H;const F=((K=(O=B.app)==null?void 0:O.studentData)==null?void 0:K.lastName)||"",M=((H=(j=R.app)==null?void 0:j.studentData)==null?void 0:H.lastName)||"";return F.localeCompare(M)}),console.log("🔍 Paraeducator query: Successfully fetched",V.length,"students"),V}catch(_){console.error("🔴 Paraeducator query FAILED:",_),console.error("🔴 Error code:",_.code),console.error("🔴 Error message:",_.message),console.error("🔴 Full error object:",_);const A=Yo();return console.error("🔴 Current auth state:",{uid:(P=A.currentUser)==null?void 0:P.uid,email:(w=A.currentUser)==null?void 0:w.email,customClaims:"Check in browser dev tools"}),console.error("🔴 Auth mismatch check:",{queryUserId:k,authUid:(x=A.currentUser)==null?void 0:x.uid,match:k===((S=A.currentUser)==null?void 0:S.uid)}),[]}},v=async()=>{console.log("🔍 Testing query: Loading students with testing flags");const k=nr(bt(ze,"students"),Rr("app.flags.flag2","==",!0),Gr("app.studentData.lastName","asc")),P=nr(bt(ze,"students"),Rr("app.flags.separateSetting","==",!0),Gr("app.studentData.lastName","asc")),[w,x]=await Promise.all([$t(k),$t(P)]),S=w.docs.map(C=>({id:C.id,...C.data()})),_=x.docs.map(C=>({id:C.id,...C.data()})),A=[...S];return _.forEach(C=>{A.find(T=>T.id===C.id)||A.push(C)}),A.sort((C,T)=>{var B,R,F,M;const D=((R=(B=C.app)==null?void 0:B.studentData)==null?void 0:R.lastName)||"",V=((M=(F=T.app)==null?void 0:F.studentData)==null?void 0:M.lastName)||"";return D.localeCompare(V)})},g=async(k={})=>{var P,w;if(console.log("🔍 loadStudents called - DEBUG AUTH STATE:"),console.log("  currentUserId.value:",o.value),console.log("  currentRole.value:",a.value),console.log("  authStore.user:",t.user),console.log("  authStore.user?.uid:",(P=t.user)==null?void 0:P.uid),console.log("  authStore.user?.role:",(w=t.user)==null?void 0:w.role),!o.value||!a.value)return console.error("🔴 No authenticated user or role - FAILING AUTH CHECK"),console.error("  currentUserId.value is:",o.value),console.error("  currentRole.value is:",a.value),r.value="Authentication required",[];e.value=!0,r.value=null;try{let x=[];switch(console.log("🔍 ROUTING to query based on role:",a.value),console.log("🔍 Available role cases: admin, school_admin, staff_view, staff_edit, admin_504, sped_chair, case_manager, teacher, service_provider, paraeducator"),a.value){case"admin":case"school_admin":case"staff_view":case"staff_edit":case"administrator":x=await l();break;case"sped_chair":x=await u();break;case"admin_504":case"administrator_504_CM":x=await c();break;case"case_manager":console.log("🔍 CALLING getCaseManagerStudents with userId:",o.value),x=await f(o.value),console.log("🔍 getCaseManagerStudents COMPLETED, returned:",x.length,"students");break;case"teacher":x=await h(o.value);break;case"service_provider":x=await p(o.value);break;case"paraeducator":x=await m(o.value);break;default:return console.error("🔴 Unknown role:",a.value),r.value="Invalid user role",[]}return k.testingOnly&&(x=await v()),n.value=x,s.value=x.length,console.log(`🟢 Loaded ${x.length} students for ${a.value}`),x}catch(x){return console.error("🔴 Error loading students:",x),r.value=x.message||"Failed to load students",[]}finally{e.value=!1}},y=async k=>{if(!k)throw new Error("Student ID is required");if(!o.value||!a.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{const P=await Jt(Ze(ze,"students",k));if(!P.exists())throw new Error("Student not found");const w={id:P.id,...P.data()};if(!await E(w,o.value,a.value))throw new Error("Access denied to this student");return w}catch(P){throw console.error("🔴 Error getting student:",P),r.value=P.message,P}finally{e.value=!1}},E=async(k,P,w)=>{var x,S,_,A,C,T,D;if(!k||!P||!w)return!1;if(["admin","administrator","administrator_504_CM","sped_chair"].includes(w))return!0;if(w==="case_manager")return((S=(x=k.app)==null?void 0:x.studentData)==null?void 0:S.caseManagerId)===P;if(w==="teacher"){if(!((A=(_=k.app)==null?void 0:_.schedule)!=null&&A.periods))return!1;const V=k.app.schedule.periods,B=Object.values(V);return B.includes(P)?!0:B.some(R=>{var F;return typeof R=="object"&&R!==null?R.teacherId===P||((F=R.coTeaching)==null?void 0:F.caseManagerId)===P:!1})}if(w==="service_provider"){if((C=k.app)!=null&&C.providers&&Object.values(k.app.providers).includes(P))return!0;if((D=(T=k.app)==null?void 0:T.schedule)!=null&&D.periods){const V=k.app.schedule.periods,B=Object.values(V);return B.includes(P)?!0:B.some(R=>{var F;return typeof R=="object"&&R!==null?R.teacherId===P||((F=R.coTeaching)==null?void 0:F.caseManagerId)===P:!1})}}return!1},b=async(k=50,P=null)=>{if(!o.value||!a.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{let w=nr(bt(ze,"students"),Gr("app.studentData.lastName","asc"),Ts(k));P&&(w=nr(w,uh(P))),a.value==="case_manager"&&(w=nr(bt(ze,"students"),Rr("app.studentData.caseManagerId","==",o.value),Gr("app.studentData.lastName","asc"),Ts(k)),P&&(w=nr(w,uh(P))));const x=await $t(w);return{students:x.docs.map(_=>({id:_.id,..._.data()})),lastDoc:x.docs[x.docs.length-1],hasMore:x.docs.length===k}}catch(w){throw console.error("🔴 Error loading paginated students:",w),r.value=w.message,w}finally{e.value=!1}};return{students:Se(()=>n.value),loading:Se(()=>e.value),error:Se(()=>r.value),totalCount:Se(()=>s.value),loadStudents:g,getStudent:y,verifyStudentAccess:E,loadStudentsPaginated:b,getAdminStudents:l,getAdmin504Students:c,getCaseManagerStudents:f,getTeacherStudents:h,getServiceProviderStudents:p,getParaeducatorStudents:m,getTestingStudents:v}}function NB(t,e){const r={isSecure:!0,violations:[],summary:"",studentCount:t.length,authorizedCount:0,unauthorizedCount:0};return!e||!e.role?(r.isSecure=!1,r.violations.push("No user or role provided"),r):(t.forEach((n,s)=>{var a,o,l,c;OB(n,e)?r.authorizedCount++:(r.unauthorizedCount++,r.isSecure=!1,r.violations.push({studentIndex:s,studentName:`${(o=(a=n.app)==null?void 0:a.studentData)==null?void 0:o.firstName} ${(c=(l=n.app)==null?void 0:l.studentData)==null?void 0:c.lastName}`,studentId:n.id,reason:MB(n,e)}))}),r.summary=`User ${e.role} (${e.uid}) has access to ${r.authorizedCount}/${r.studentCount} students`,r.isSecure||(r.summary+=`. SECURITY VIOLATION: ${r.unauthorizedCount} unauthorized students accessible!`),r)}function OB(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"admin":case"administrator":case"administrator_504_CM":case"sped_chair":return!0;case"case_manager":return((i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===n;case"teacher":const f=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(f).includes(n);case"service_provider":const h=((l=t.app)==null?void 0:l.providers)||{},p=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},m=Object.values(h).includes(n),v=Object.values(p).includes(n);return m||v;case"paraeducator":return!0;default:return!1}}function MB(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"case_manager":const f=(i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId;return`Case manager ${n} is not assigned to student (assigned to: ${f})`;case"teacher":const h=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{},p=Object.values(h);return`Teacher ${n} does not teach this student (teachers: ${p.join(", ")})`;case"service_provider":const m=((l=t.app)==null?void 0:l.providers)||{},v=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},g=Object.values(m).filter(E=>E),y=Object.values(v);return`Service provider ${n} is not assigned to student (providers: ${g.join(", ")}, teachers: ${y.join(", ")})`;case"paraeducator":return null;default:return`Unknown role: ${r}`}}function LB(t){t.isSecure?console.log("✅ SECURITY TEST PASSED:",t.summary):(console.error("🚨 SECURITY TEST FAILED:",t.summary),console.error("Violations:",t.violations))}function Ab(t,e){const r=NB(t,e);return LB(r),r}const H4=(t,e)=>{console.log(`🔍 DEBUG: Schedule Operation - ${t}:`,e)};function j4(t){return H4("getTeacherIdFromPeriod",{periodData:t,type:typeof t}),t?typeof t=="string"?t:t.teacherId||null:null}function Pp(t){var e;return H4("getCoTeachingCaseManagerFromPeriod",{periodData:t}),!t||typeof t!="object"?null:((e=t.coTeaching)==null?void 0:e.caseManagerId)||null}function BB(t,e={}){if(!t||!t.periods)return[];const r=new Set;return Object.values(t.periods).forEach(n=>{const s=j4(n);s&&r.add(s);const i=Pp(n);if(i){const a=e[i];a&&(a.role==="teacher"||a.roles&&a.roles.includes("teacher"))&&r.add(i)}}),Array.from(r)}function UB(t){if(!t||!t.periods)return[];const e=new Set;return Object.values(t.periods).forEach(r=>{const n=Pp(r);n&&e.add(n)}),Array.from(e)}function $B(t,e){var r,n;return!((n=(r=t.app)==null?void 0:r.schedule)!=null&&n.periods)||!e?!1:Object.values(t.app.schedule.periods).some(s=>Pp(s)===e)}function VB(){const t=wi(),e=xa(),{students:r,setStudents:n}=Ua(),{users:s,userList:i,fetchUsers:a,caseManagers:o,teacherList:l,userRoles:c}=ya(),{loadAideAssignment:u,loadAideAssignments:f,shouldAideSeeStudent:h,aideAssignment:p}=Rx(),{feedbackForms:m,formsLoading:v}=Fx(),{loadStudents:g}=FB(),y=se(!1),E=se(null),b=Se(()=>e.currentUser),k=Se(()=>{var B;const V=(B=b.value)==null?void 0:B.role;return["admin","administrator","sped_chair","administrator_504_CM"].includes(V)}),P=Se(()=>{var V;return["case_manager","administrator_504_CM","sped_chair"].includes((V=b.value)==null?void 0:V.role)}),w=Se(()=>s.value||{}),x=Se(()=>{var V;return((V=i.value)==null?void 0:V.filter(B=>B.role==="paraeducator"))||[]}),S=async()=>{var V,B;console.log("🔍 useStudentData: fetchData() called"),y.value=!0,E.value=null;try{console.log("🔍 useStudentData: About to fetchUsers()..."),await a(),console.log("🔍 useStudentData: fetchUsers() completed");const R=b.value;if(console.log("🔍 useStudentData: Checking user for loadStudents call:",R),R){console.log("🔒 Security: Fetching students for user role:",R.role),console.log("🔍 useStudentData: About to call loadStudents()...");const M=await g();console.log("🔍 useStudentData: loadStudents() returned:",M.length,"students"),n(M);const O=Ab(M,R);O.isSecure||console.error("🚨 SECURITY VIOLATION DETECTED:",O.violations)}else console.log("🔒 Security: No user found - setting empty student array"),n([]);const F=(V=b.value)==null?void 0:V.role;if(["admin","school_admin","admin_504","sped_chair","administrator","administrator_504_CM"].includes(F))await f();else if(F==="paraeducator"&&b.value.uid){console.log("🔍 useStudentData: Loading individual aide assignment for paraeducator:",b.value.uid),await u(b.value.uid);const M=Ze(ze,"aideSchedules",b.value.uid),O=Ac(M,async K=>{if(K.exists()){console.log("🔍 useStudentData: Aide schedule updated, reloading students..."),await u(b.value.uid);const j=await g();n(j)}});Ba(()=>O())}console.log("🔒 Security: Loaded",r.value.length,"students for",(B=b.value)==null?void 0:B.role),console.log("StudentsView - loaded users:",Object.keys(s.value||{}).length,"users")}catch(R){console.error("Error fetching data:",R),E.value=R.message||"Failed to load data"}finally{y.value=!1}},_=V=>r.value.find(B=>B.id===V)||{},A=V=>{const B=s.value[V];return B&&(B.name||B.email)||V},C=V=>{if(!V)return"N/A";const B=s.value[V];return B&&(B.name||B.email)||V},T=V=>{var B,R;return((R=(B=V.app)==null?void 0:B.studentData)==null?void 0:R.caseManagerId)||V.caseManagerId||V.casemanager_id},D=V=>{var B,R,F,M,O;return V.schedule?V.schedule:(R=(B=V.app)==null?void 0:B.schedule)!=null&&R.periods?V.app.schedule.periods:(M=(F=V.aeries)==null?void 0:F.schedule)!=null&&M.periods?V.aeries.schedule.periods:(O=V.aeries)!=null&&O.schedule?V.aeries.schedule:null};return Ut(()=>{console.log("🔍 useStudentData: onMounted triggered, calling fetchData..."),S()}),Vt(()=>{var V;return(V=b.value)==null?void 0:V.role},async(V,B)=>{if(V&&V!==B){console.log("🔒 Security: User role changed from",B,"to",V,"- reloading students");const R=b.value;if(console.log("🔍 useStudentData: Role watcher - checking user:",R),R){console.log("🔍 useStudentData: Role watcher - about to call loadStudents()...");const F=await g();console.log("🔍 useStudentData: Role watcher - loadStudents() returned:",F.length,"students"),n(F);const M=Ab(F,R);M.isSecure||console.error("🚨 SECURITY VIOLATION DETECTED:",M.violations),console.log("🔒 Security: Reloaded",F.length,"students for role",V)}}},{immediate:!1}),{isLoading:y,error:E,students:r,userMap:s,userList:i,userMapObj:w,caseManagers:o,teacherList:l,userRoles:c,aideAssignment:p,feedbackForms:m,formsLoading:v,paraeducators:x,currentUser:b,isAdmin:k,showProviderView:P,fetchData:S,getStudentById:_,getUserName:A,getCaseManagerName:C,getCaseManagerId:T,getSchedule:D,shouldAideSeeStudent:h,getTeacherIdFromPeriod:j4,getCoTeachingCaseManagerFromPeriod:Pp,getAllTeacherIdsFromSchedule:BB,getCoTeachingCaseManagersFromSchedule:UB,isCoTeachingCaseManager:$B,router:t}}function ot(t,e,r="—"){const n=(l,c)=>c.split(".").reduce((u,f)=>u&&u[f]!==void 0?u[f]:null,l),s=n(t.overrides,e);if(t.overrides&&s!=null&&s!=="")return s;if(t.app){if(["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(e)){const c=n(t.app,`studentData.${e}`);if(c!=null&&c!=="")return c}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const c=n(t.app,`dates.${e}`);if(c!=null&&c!=="")return c}if(["instruction","assessment"].includes(e)){const c=n(t.app,`accommodations.${e}`);if(c!=null&&c!=="")return c}const l=n(t.app,e);if(l!=null&&l!=="")return l}const i=n(t.aeries,e);if(t.aeries&&i!=null&&i!=="")return i;const a=n(t.seis,e);if(t.seis&&a!=null&&a!=="")return a;const o=n(t,e);return o!=null&&o!==""?o:r}function ou(t,e){const r=(o,l)=>l.split(".").reduce((c,u)=>c&&c[u]!==void 0?c[u]:null,o),n=r(t.overrides,e);if(t.overrides&&n!=null&&n!=="")return"Override";if(t.app){if(["firstName","lastName","grade","plan"].includes(e)){const l=r(t.app,`studentData.${e}`);if(l!=null&&l!=="")return"App"}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const l=r(t.app,`dates.${e}`);if(l!=null&&l!=="")return"App"}if(["instruction","assessment"].includes(e)){const l=r(t.app,`accommodations.${e}`);if(l!=null&&l!=="")return"App"}const o=r(t.app,e);if(o!=null&&o!=="")return"App"}const s=r(t.aeries,e);if(t.aeries&&s!=null&&s!=="")return"Aeries";const i=r(t.seis,e);if(t.seis&&i!=null&&i!=="")return"SEIS";const a=r(t,e);return a!=null&&a!==""?"Top-level":"—"}function HB(t){return t?`<ul class="bullet-list">${t.split(/\n|\r|\d+\.\s+|\-\s+|;/).map(r=>r.trim()).filter(Boolean).map(r=>`<li>${r}</li>`).join("")}</ul>`:"<div>—</div>"}function jB(t){const{students:e,currentUser:r,shouldAideSeeStudent:n,userMap:s,getCaseManagerId:i,getSchedule:a,aideAssignment:o}=t,l=se(!1),c=se([]),u=Rs({sortBy:"firstName",cm:"all",teacher:"all",paraeducator:"all",plan:"all",search:"",providerView:"all",viewMode:"list"});let f=null;const h=()=>{f&&clearTimeout(f),f=setTimeout(()=>{g()},300)},p=()=>{l.value=!l.value},m=()=>{u.sortBy="firstName",u.cm="all",u.teacher="all",u.paraeducator="all",u.plan="all",u.search="",u.providerView="all",u.viewMode="list",g()},v=()=>({paraeducator:u.paraeducator,teacher:u.teacher}),g=(y=u)=>{var P,w,x,S;console.log("🔍 FILTER DEBUG: applyFilters called with students.value.length:",e.value.length),console.log("🔍 FILTER DEBUG: currentUser:",(P=r.value)==null?void 0:P.role,(w=r.value)==null?void 0:w.uid);let E=e.value;const b=(x=r.value)==null?void 0:x.role,k=["admin","administrator"];if(console.log("🔍 FILTER DEBUG: Provider view filtering check:",{userRole:b,providerView:y.providerView,shouldSkip:k.includes(b),resultLengthBefore:E.length}),!k.includes(b)&&y.providerView==="case_manager"?(console.log("🔍 FILTER DEBUG: Applying case_manager filter"),E=E.filter(_=>{var A;return i(_)===((A=r.value)==null?void 0:A.uid)}),console.log("🔍 FILTER DEBUG: After case_manager filter:",E.length)):!k.includes(b)&&y.providerView==="service_provider"?(console.log("🔍 FILTER DEBUG: Applying service_provider filter"),E=E.filter(_=>{var V;const A=a(_),C=A?Object.entries(A).some(([B,R])=>{var F,M;return typeof R=="string"?R===((F=r.value)==null?void 0:F.uid):R&&typeof R=="object"?R.teacherId===((M=r.value)==null?void 0:M.uid):!1}):!1,T=(_.services||[]).some(B=>{var R;return B.includes((R=r.value)==null?void 0:R.uid)}),D=i(_)!==((V=r.value)==null?void 0:V.uid);return(C||T)&&D}),console.log("🔍 FILTER DEBUG: After service_provider filter:",E.length)):console.log("🔍 FILTER DEBUG: Skipping provider view filtering for role:",b),((S=r.value)==null?void 0:S.role)==="paraeducator"&&console.log("🔍 FILTER DEBUG: Paraeducator - using database-filtered students, no additional filtering"),y.search){const _=y.search.toLowerCase();E=E.filter(A=>{const C=ot(A,"firstName")||"",T=ot(A,"lastName")||"";return`${C} ${T}`.toLowerCase().includes(_)})}if(y.cm&&y.cm!=="all"&&(E=E.filter(_=>i(_)===y.cm)),y.teacher&&y.teacher!=="all"&&(E=E.filter(_=>{const A=a(_);return A?Object.entries(A).some(([C,T])=>typeof T=="string"?T===y.teacher:T&&typeof T=="object"?T.teacherId===y.teacher:!1):!1})),y.paraeducator&&y.paraeducator!=="all"){console.log("🔍 FILTER DEBUG: Applying paraeducator filter for:",y.paraeducator);const _=o.value[y.paraeducator];if(_){console.log("🔍 FILTER DEBUG: Found aide data:",_);let A=[];_.studentIds&&Array.isArray(_.studentIds)?(A=_.studentIds,console.log("🔍 FILTER DEBUG: Using studentIds array:",A)):_.directAssignment&&(A=Array.isArray(_.directAssignment)?_.directAssignment:[_.directAssignment],console.log("🔍 FILTER DEBUG: Using directAssignment as fallback:",A)),E=E.filter(C=>A.includes(C.id)),console.log("🔍 FILTER DEBUG: After paraeducator filter:",E.length,"students")}else console.log("🔍 FILTER DEBUG: No aide data found for:",y.paraeducator),E=[]}y.plan&&y.plan!=="all"&&(E=E.filter(_=>ot(_,"plan")===y.plan)),y.sortBy&&E.sort((_,A)=>{const C=ot(_,y.sortBy)||"",T=ot(A,y.sortBy)||"";if(["reviewDate","reevalDate","meetingDate"].includes(y.sortBy)){const D=C?new Date(C).getTime():0,V=T?new Date(T).getTime():0;return D-V}return C.toString().toLowerCase().localeCompare(T.toString().toLowerCase())}),c.value=E,console.log("🔍 FILTER DEBUG: applyFilters completed. filteredStudents.value.length:",c.value.length)};return Vt(()=>[e.value,r.value],()=>{console.log("🔍 FILTER DEBUG: Watcher triggered. students.value.length:",e.value.length),e.value.length>0?(console.log("🔍 FILTER DEBUG: Calling applyFilters from watcher"),g()):console.log("🔍 FILTER DEBUG: No students to filter")},{deep:!0}),{showFilters:l,filteredStudents:c,currentFilters:u,toggleFilters:p,clearFilters:m,applyFilters:g,debouncedApplyFilters:h,getCurrentFilters:v}}const A0={grades:[],classServices:[{name:"SDC",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Co-teach",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"RSP",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Directed Studies",subcategories:["Directed Studies"],enabledSubcategories:["Directed Studies"]},{name:"FA",subcategories:["FA"],enabledSubcategories:["FA"]}],sdcSubcategories:[],customClassServices:[],serviceProviders:["SLP","OT","PT","SC","MH","TR","AUD","VI","AT","DHH","O&M","BIS","HN","SW"],customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"]},Ys=se({...A0}),_a=se(!1),Mi=se(null);let lu=!1;function zs(){const t=Ze(ze,"app_settings","global"),e=async()=>{if(_a.value)return new Promise(s=>{const i=Vt(_a,a=>{a||(i(),s(Ys.value))})});if(lu&&!Mi.value)return Ys.value;_a.value=!0,Mi.value=null;try{const s=await Jt(t);return s.exists()?(Ys.value=s.data(),console.log("useAppSettings: Loaded existing settings:",Ys.value)):(Ys.value={...A0},console.log("useAppSettings: No existing settings, using defaults:",Ys.value)),lu=!0,Ys.value}catch(s){throw Mi.value=s.message,console.error("useAppSettings: Error loading settings:",s),s}finally{_a.value=!1}},r=async s=>{_a.value=!0,Mi.value=null;try{console.log("useAppSettings: Saving settings:",s),await Ht(t,s),console.log("useAppSettings: Settings saved successfully"),Ys.value={...s},lu=!0}catch(i){throw Mi.value=i.message,console.error("useAppSettings: Error saving settings:",i),i}finally{_a.value=!1}},n=async()=>{_a.value=!0,Mi.value=null;try{await Ht(t,{...A0}),Ys.value={...A0},lu=!0}catch(s){throw Mi.value=s.message,s}finally{_a.value=!1}};return!lu&&!_a.value&&e(),Vt(Ys,s=>{console.log("appSettings changed:",s)},{deep:!0}),{appSettings:Ys,loadAppSettings:e,saveAppSettings:r,resetAppSettings:n,loading:_a,error:Mi}}function xo(){const{appSettings:t}=zs(),e=Se(()=>{var l,c,u,f;if(console.log("🏷️ usePeriodLabels: appSettings.value:",t.value),console.log("🏷️ usePeriodLabels: periodLabels:",(l=t.value)==null?void 0:l.periodLabels),console.log("🏷️ usePeriodLabels: numPeriods:",(c=t.value)==null?void 0:c.numPeriods),(u=t.value)!=null&&u.periodLabels&&((f=t.value)!=null&&f.numPeriods)){const h=t.value.periodLabels.slice(0,t.value.numPeriods);return console.log("🏷️ usePeriodLabels: returning labels:",h),h}const o=["1","2","3","4","5","6","7"];return console.log("🏷️ usePeriodLabels: returning fallback labels:",o),o}),r=o=>{const l=parseInt(o);if(!l||l<1)return`Period ${o}`;const c=l-1,u=e.value[c]||`Period ${l}`;return console.log(`🏷️ getLabel(${o}) -> "${u}" (index: ${c}, labels:`,e.value,")"),u},n=o=>{const l=e.value.findIndex(c=>c===o);return l!==-1?l+1:null},s=Se(()=>{var l;const o=((l=t.value)==null?void 0:l.numPeriods)||7;return Array.from({length:o},(c,u)=>u+1)}),i=Se(()=>{const o={};return e.value.forEach((l,c)=>{o[l]=c+1}),o}),a=Se(()=>{const o={};return e.value.forEach((l,c)=>{o[c+1]=l}),o});return{labels:e,getLabel:r,getNumber:n,numericPeriods:s,labelToNumberMap:i,numberToLabelMap:a}}function GB(t,e){const{students:r,userMapObj:n,currentUser:s,getCaseManagerId:i,getSchedule:a,getUserName:o,formatDate:l}=t,{getLabel:c}=xo(),{filteredStudents:u,currentFilters:f,applyFilters:h}=e,p=(B,R)=>{if(!B)return{periods:{},isTeacher:!1,isCoTeacher:!1};let F=!1,M=!1;const O={};return Object.entries(B).forEach(([K,j])=>{const H=typeof j=="string"?j:j==null?void 0:j.teacherId,W=typeof j=="object"?j==null?void 0:j.coTeaching:null,X=W==null?void 0:W.caseManagerId;O[K]={teacherId:H,coTeaching:W,coTeachingCM:X,teacherName:o(H),coTeacherName:X?o(X):null,label:c(K)},H===R&&(F=!0),X===R&&(M=!0)}),{periods:O,isTeacher:F,isCoTeacher:M}},m=(B,R,F)=>{if(!B||!R)return[];switch(F){case"case_manager":return B.filter(M=>i(M)===R);case"service_provider":return B.filter(M=>{const O=a(M);return O?Object.values(O).some(j=>{var H;return typeof j=="string"?j===R:j&&typeof j=="object"?j.teacherId===R||((H=j.coTeaching)==null?void 0:H.caseManagerId)===R:!1}):!1});case"all":return B;default:return console.warn(`Unknown provider view: ${F}`),[]}},v=(B,R)=>!B||!R?[]:B.filter(F=>{const{isTeacher:M,isCoTeacher:O}=p(a(F),R);return M||O}),g=(B,R)=>{const F={};return B.forEach(M=>{const O=a(M);if(!O)return;const{periods:K}=p(O,R);Object.entries(K).forEach(([j,H])=>{(H.teacherId===R||H.coTeachingCM===R)&&(F[j]||(F[j]=[]),F[j].push(M))})}),F},y=Se(()=>u.value||[]),E=B=>{const R=ot(B,"firstName"),F=ot(B,"lastName");return`${R} ${F}`},b=B=>({name:E(B),grade:ot(B,"grade"),plan:ot(B,"plan"),caseManager:o(i(B))}),k=B=>({reviewDate:l(ot(B,"reviewDate")),reevalDate:l(ot(B,"reevalDate")),meetingDate:l(ot(B,"meetingDate"))}),P=B=>{const R=a(B);return R?Object.entries(R).reduce((F,[M,O])=>(F[M]={teacherId:O,teacherName:o(O)},F),{}):{}},w=B=>{f.search=B,h()},x=B=>{f.cm=B,h()},S=B=>{f.teacher=B,h()},_=B=>{f.viewMode=B,h()},A=Se(()=>{const B={};return y.value.forEach(R=>{const F=ot(R,"grade");B[F]||(B[F]=[]),B[F].push(R)}),B}),C=Se(()=>{const B={};return y.value.forEach(R=>{const F=ot(R,"plan");B[F]||(B[F]=[]),B[F].push(R)}),B}),T=Se(()=>{var F;const B=(F=s.value)==null?void 0:F.role,R=f;return["teacher","paraeducator"].includes(B)?!1:B==="case_manager"||["sped_chair","admin_504","administrator_504_CM"].includes(B)?R.providerView!=="service_provider"&&R.teacher==="all":["admin","school_admin","staff_view","staff_edit","administrator"].includes(B)?R.teacher==="all"&&R.paraeducator==="all":B==="service_provider"?R.providerView!=="service_provider":!0}),D=Se(()=>{var R;const B=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","administrator","administrator_504_CM"].includes(B)}),V=Se(()=>{var R;const B=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","administrator","administrator_504_CM"].includes(B)});return Vt(()=>T.value,B=>{B&&f.viewMode==="class"&&(console.log("🔄 Auto-switching from class view to list view because class view is now disabled"),f.viewMode="list",h())},{immediate:!1}),{visibleStudents:y,currentUser:s,userMapObj:n,standardizeScheduleAccess:p,getProviderViewStudents:m,getClassViewStudents:v,groupStudentsByPeriod:g,groupStudentsByGrade:A,groupStudentsByPlan:C,canAccessFilters:V,isClassViewDisabled:T,isAdminRole:D,formatStudentName:E,formatStudentInfo:b,formatDates:k,getStudentSchedule:P,filterByName:w,filterByCaseManager:x,filterByTeacher:S,setViewMode:_,currentFilters:f,showProviderView:!1,providerViewOptions:Se(()=>[])}}const Wt={ADMIN:"admin",ADMINISTRATOR:"administrator",ADMINISTRATOR_504_CM:"administrator_504_CM",SPED_CHAIR:"sped_chair",CASE_MANAGER:"case_manager",TEACHER:"teacher",SERVICE_PROVIDER:"service_provider",PARAEDUCATOR:"paraeducator"},WB={[Wt.ADMIN]:100,[Wt.ADMINISTRATOR]:90,[Wt.SPED_CHAIR]:80,[Wt.ADMINISTRATOR_504_CM]:70,[Wt.CASE_MANAGER]:60,[Wt.SERVICE_PROVIDER]:50,[Wt.TEACHER]:40,[Wt.PARAEDUCATOR]:30},xt={CAN_VIEW_ALL_STUDENTS:"canViewAllStudents",CAN_EDIT_ALL_STUDENTS:"canEditAllStudents",CAN_EDIT_OWN_STUDENTS:"canEditOwnStudents",CAN_SEND_FEEDBACK:"canSendFeedback",CAN_MANAGE_USERS:"canManageUsers",CAN_MANAGE_AIDES:"canManageAides",CAN_ACCESS_TESTING:"canAccessTesting",CAN_ACCESS_FILTERS:"canAccessFilters",SHOW_PROVIDER_VIEW:"showProviderView",CAN_USE_CLASS_VIEW:"canUseClassView"},zB={[Wt.ADMIN]:[xt.CAN_VIEW_ALL_STUDENTS,xt.CAN_EDIT_ALL_STUDENTS,xt.CAN_SEND_FEEDBACK,xt.CAN_MANAGE_USERS,xt.CAN_MANAGE_AIDES,xt.CAN_ACCESS_TESTING,xt.CAN_ACCESS_FILTERS,xt.SHOW_PROVIDER_VIEW,xt.CAN_USE_CLASS_VIEW],[Wt.ADMINISTRATOR]:[xt.CAN_VIEW_ALL_STUDENTS,xt.CAN_EDIT_ALL_STUDENTS,xt.CAN_SEND_FEEDBACK,xt.CAN_MANAGE_USERS,xt.CAN_MANAGE_AIDES,xt.CAN_ACCESS_TESTING,xt.CAN_ACCESS_FILTERS,xt.SHOW_PROVIDER_VIEW,xt.CAN_USE_CLASS_VIEW],[Wt.SPED_CHAIR]:[xt.CAN_VIEW_ALL_STUDENTS,xt.CAN_EDIT_ALL_STUDENTS,xt.CAN_SEND_FEEDBACK,xt.CAN_MANAGE_AIDES,xt.CAN_ACCESS_TESTING,xt.CAN_ACCESS_FILTERS,xt.SHOW_PROVIDER_VIEW,xt.CAN_USE_CLASS_VIEW],[Wt.ADMINISTRATOR_504_CM]:[xt.CAN_VIEW_ALL_STUDENTS,xt.CAN_EDIT_OWN_STUDENTS,xt.CAN_SEND_FEEDBACK,xt.CAN_MANAGE_USERS,xt.CAN_ACCESS_TESTING,xt.CAN_ACCESS_FILTERS,xt.SHOW_PROVIDER_VIEW,xt.CAN_USE_CLASS_VIEW],[Wt.CASE_MANAGER]:[xt.CAN_EDIT_OWN_STUDENTS,xt.CAN_SEND_FEEDBACK,xt.CAN_ACCESS_TESTING,xt.SHOW_PROVIDER_VIEW,xt.CAN_USE_CLASS_VIEW],[Wt.TEACHER]:[xt.CAN_ACCESS_TESTING,xt.CAN_USE_CLASS_VIEW],[Wt.SERVICE_PROVIDER]:[xt.CAN_EDIT_ALL_STUDENTS,xt.CAN_ACCESS_TESTING,xt.SHOW_PROVIDER_VIEW,xt.CAN_USE_CLASS_VIEW],[Wt.PARAEDUCATOR]:[xt.CAN_ACCESS_TESTING,xt.CAN_USE_CLASS_VIEW]},KB={[Wt.SPED_CHAIR]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"},{value:"iep_all",label:"*"}],[Wt.ADMINISTRATOR_504_CM]:[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}],[Wt.CASE_MANAGER]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}],[Wt.SERVICE_PROVIDER]:[{value:"all",label:"All"},{value:"service_provider",label:"SP"}]},qB={[Wt.SPED_CHAIR]:"all",[Wt.ADMINISTRATOR_504_CM]:"case_manager",[Wt.CASE_MANAGER]:"all",[Wt.SERVICE_PROVIDER]:"service_provider"},XB={[Wt.CASE_MANAGER]:{patterns:["case_manager"],description:"Students in their caseload"},[Wt.TEACHER]:{patterns:["teacher"],description:"Students in their classes"},[Wt.SERVICE_PROVIDER]:{patterns:["teacher"],description:"Students in their classes"},[Wt.PARAEDUCATOR]:{patterns:["paraeducator"],description:"Students they are assigned to assist"},[Wt.SPED_CHAIR]:{patterns:["case_manager","teacher","all_iep"],description:"All students, with special access to IEP students"},[Wt.ADMINISTRATOR_504_CM]:{patterns:["case_manager","all_iep_504"],description:"All students, with special access to IEP/504 students"},[Wt.ADMIN]:{patterns:["all"],description:"All students"},[Wt.ADMINISTRATOR]:{patterns:["all"],description:"All students"}},Yi={case_manager:(t,e,r)=>r.getCaseManagerId(e)===t,teacher:(t,e,r)=>{const n=r.getSchedule(e);return n?Object.values(n).some(s=>{var i;return typeof s=="string"?s===t:s&&typeof s=="object"?s.teacherId===t||((i=s.coTeaching)==null?void 0:i.caseManagerId)===t:!1}):!1},paraeducator:(t,e,r)=>r?r.shouldAideSeeStudent(t,e):!1,all_iep:(t,e,r)=>ot(e,"plan")==="IEP",all_iep_504:(t,e,r)=>{const n=ot(e,"plan");return n==="IEP"||n==="504"},all:()=>!0},YB={[Wt.CASE_MANAGER]:{canSendFeedback:(t,e,r)=>r.getCaseManagerId(e)===t,description:"Can send feedback for students in their caseload"},[Wt.SPED_CHAIR]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=Yi.teacher(t,e,r),i=Yi.all_iep(t,e,r);return n||s||i},description:"Can send feedback for students they case manage, teach, or have IEP"},[Wt.ADMINISTRATOR_504_CM]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=Yi.all_iep_504(t,e,r);return n||s},description:"Can send feedback for students they case manage or have IEP/504"},[Wt.ADMIN]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"},[Wt.ADMINISTRATOR]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"}},Mn={hasPermission:(t,e)=>(zB[t]||[]).includes(e),getProviderViewOptions:t=>KB[t]||[],getDefaultProviderView:t=>qB[t]||"all",canAccessStudent:(t,e,r,n,s=null)=>{var a;return(((a=XB[e])==null?void 0:a.patterns)||[]).some(o=>{const l=Yi[o];return l?l(t,r,n,s):!1})},canSendFeedback:(t,e,r,n)=>{const s=YB[e];return s?s.canSendFeedback(t,r,n):!1},getRoleLevel:t=>WB[t]||0,hasHigherPrivileges:(t,e)=>Mn.getRoleLevel(t)>Mn.getRoleLevel(e)};function QB(t,e){const r=GB(t,e),n=Se(()=>{var D;return(D=r.currentUser.value)==null?void 0:D.uid}),s=Se(()=>{var D;return((D=r.currentUser.value)==null?void 0:D.role)||"guest"}),i=Se(()=>Mn.getProviderViewOptions(s.value));Vt(i,D=>{if(D.length>0){const V=Mn.getDefaultProviderView(s.value);D.map(R=>R.value).includes(e.currentFilters.providerView)||(e.currentFilters.providerView=V,e.applyFilters())}},{immediate:!0});const a=Se(()=>{if(!n.value)return[];const D=r.visibleStudents.value,V=e.currentFilters.providerView,B=s.value;switch(V){case"case_manager":return D.filter(R=>Yi.case_manager(n.value,R,t));case"service_provider":return D.filter(R=>Yi.teacher(n.value,R,t));case"all":return D.filter(R=>Mn.canAccessStudent(n.value,B,R,t));case"iep_all":return B==="sped_chair"?D.filter(R=>Yi.all_iep(n.value,R,t)):[];case"iep_504_all":return B==="administrator_504_CM"?D.filter(R=>Yi.all_iep_504(n.value,R,t)):[];default:return console.warn(`Unknown provider view: ${V}`),[]}}),o=Se(()=>Mn.hasPermission(s.value,xt.CAN_EDIT_ALL_STUDENTS)),l=Se(()=>Mn.hasPermission(s.value,xt.CAN_EDIT_OWN_STUDENTS)),c=Se(()=>Mn.hasPermission(s.value,xt.CAN_VIEW_ALL_STUDENTS)),u=Se(()=>Mn.hasPermission(s.value,xt.CAN_MANAGE_USERS)),f=Se(()=>Mn.hasPermission(s.value,xt.CAN_MANAGE_AIDES)),h=Se(()=>Mn.hasPermission(s.value,xt.CAN_ACCESS_TESTING)),p=Se(()=>h.value),m=Se(()=>h.value),v=Se(()=>Mn.hasPermission(s.value,xt.CAN_ACCESS_FILTERS)),g=Se(()=>Mn.hasPermission(s.value,xt.SHOW_PROVIDER_VIEW)),y=Se(()=>Mn.hasPermission(s.value,xt.CAN_USE_CLASS_VIEW)),E=D=>{if(!n.value||!D)return!1;const V=s.value;return V==="paraeducator"||V==="teacher"?!1:V==="case_manager"?t.getCaseManagerId(D)===n.value:["admin","administrator","sped_chair","administrator_504_CM","service_provider"].includes(V)},b=D=>!n.value||!D?!1:Mn.canSendFeedback(n.value,s.value,D,t),k=Se(()=>n.value?r.groupStudentsByPeriod(a.value,n.value):{}),P=D=>{if(D==="class"&&!y.value){e.currentFilters.viewMode="list";return}e.currentFilters.viewMode=D},w=Se(()=>{if(s.value!=="teacher")return{instruction:[],assessment:[]};const D={instruction:[],assessment:[]};return a.value.forEach(V=>{var B,R,F,M;(R=(B=V.app)==null?void 0:B.accommodations)!=null&&R.instruction&&D.instruction.push(V),(M=(F=V.app)==null?void 0:F.accommodations)!=null&&M.assessment&&D.assessment.push(V)}),D}),x=Se(()=>{if(s.value!=="teacher")return{};const D={};return a.value.forEach(V=>{var R;const B=((R=V.app)==null?void 0:R.providers)||{};Object.entries(B).forEach(([F,M])=>{M&&(D[M]||(D[M]={provider:t.getUserName(M),providerType:F,students:[]}),D[M].students.push(V))})}),D}),S=Se(()=>s.value==="teacher"),_=Se(()=>s.value==="teacher"),A=Se(()=>s.value==="teacher"),C=Se(()=>!1),T=Se(()=>!1);return{...r,visibleStudents:a,studentsByPeriod:k,providerViewOptions:i,showProviderView:g,canEditAllStudents:o,canEditOwnStudents:l,canViewAllStudents:c,canManageUsers:u,canManageAides:f,canAccessTesting:h,canAccessTestingPartial:p,hasAnyTestingAccess:m,canAccessFilters:v,canUseClassView:y,canEditStudent:E,canSendFeedback:b,setViewMode:P,studentsByAccommodation:w,studentsByServiceProvider:x,canViewAccommodations:S,canViewBasicInfo:_,canViewServiceProviders:A,canViewDates:C,canEditStudents:T,currentRole:s,currentUserId:n}}function JB(t){Object.entries(t).reduce((e,[r,n])=>(e[r]=n.length,e),{})}function ZB(t,e,r=null){const{aideAssignment:n,getCaseManagerId:s,getSchedule:i,standardizeScheduleAccess:a,currentUser:o}=t,{filteredStudents:l,currentFilters:c,getCurrentFilters:u}=e,f=r||l,h=se("list");Vt(()=>c.viewMode,E=>{h.value=E||"list"});const p=Se(()=>f.value.filter(E=>{var b,k,P,w;return((k=(b=E.app)==null?void 0:b.flags)==null?void 0:k.flag2)||((w=(P=E.app)==null?void 0:P.flags)==null?void 0:w.separateSetting)||E.separateSetting||E.flag2||!1})),m=Se(()=>{var x,S;const E={};if(h.value!=="class")return E;const b=(x=o.value)==null?void 0:x.uid;if(!b)return console.log("🔴 studentsByClass: No current user ID"),E;console.log("🔵 studentsByClass: Current user ID:",b);const k=(S=t.currentUser.value)==null?void 0:S.role;let P;k==="case_manager"?(P=t.students.value,console.log("🔵 studentsByClass: Case manager - using raw database students:",P.length)):(P=f.value,console.log("🔵 studentsByClass: Other role - using provider-filtered students:",P.length));const w=u();return w.paraeducator&&w.paraeducator,P.forEach(_=>{var C,T;const A=i(_)||{};console.log(`🕵️ studentsByClass full schedule for ${(T=(C=_.app)==null?void 0:C.studentData)==null?void 0:T.firstName}:`,A),Object.entries(A).forEach(([D,V])=>{var H,W,X;let B,R;if(typeof V=="string")B=V;else if(V&&typeof V=="object")B=V.teacherId,R=(H=V.coTeaching)==null?void 0:H.caseManagerId,V.coTeaching&&console.log(`🕵️ studentsByClass coTeaching data for ${(X=(W=_.app)==null?void 0:W.studentData)==null?void 0:X.firstName} in period ${D}:`,V.coTeaching);else return;let F=!1;const M=u(),O=M.teacher&&M.teacher!=="all",K=M.paraeducator&&M.paraeducator!=="all";if(k==="paraeducator"){const re=n.value[b];re!=null&&re.classAssignment&&re.classAssignment[D]&&(F=(Array.isArray(re.classAssignment[D])?re.classAssignment[D]:[re.classAssignment[D]]).includes(B))}else if(["admin","administrator"].includes(k))if(O)F=B===M.teacher||R===M.teacher;else if(K){const re=n.value[M.paraeducator];re!=null&&re.classAssignment&&re.classAssignment[D]&&(F=(Array.isArray(re.classAssignment[D])?re.classAssignment[D]:[re.classAssignment[D]]).includes(B))}else F=!0;else F=B===b||R===b;!F||(E[D]||(E[D]=[]),E[D].some(re=>re.id===_.id))||E[D].push(_)})}),console.log("🟢 studentsByClass: Final groups:",Object.keys(E).map(_=>`Period ${_}: ${E[_].length} students`)),JB(E),Object.keys(E).forEach(_=>{E[_].length===0&&delete E[_]}),Object.keys(E).sort((_,A)=>{const C=parseInt(_.replace(/\D/g,"")),T=parseInt(A.replace(/\D/g,""));return C-T}).reduce((_,A)=>(_[A]=E[A],_),{})}),v=Se(()=>{var _,A;const E=u(),b=(_=t.currentUser.value)==null?void 0:_.role,k=(A=t.currentUser.value)==null?void 0:A.uid;let P=null;if(b==="paraeducator")P=k;else{if(!(E.paraeducator&&E.paraeducator!=="all"))return[];P=E.paraeducator}if(!P)return[];const w=n.value[P];if(!w||!w.directAssignment)return console.log("🔍 directAssignmentStudents: No aide data or direct assignment for",P),[];const x=Array.isArray(w.directAssignment)?w.directAssignment:[w.directAssignment];console.log("🔍 directAssignmentStudents: Direct student IDs:",x),console.log("🔍 directAssignmentStudents: Available students:",f.value.length);const S=f.value.filter(C=>x.includes(C.id));return console.log("🔍 directAssignmentStudents: Found direct assignment students:",S.length),S}),g=Se(()=>{const E={};return f.value.forEach(b=>{const k=s(b);k&&(E[k]||(E[k]=[]),E[k].push(b))}),E});return{currentViewMode:h,studentsByClass:m,directAssignmentStudents:v,studentsByCaseManager:g,testingViewStudents:p,setViewMode:E=>{h.value=E,c.viewMode=E}}}function e7(t){const{router:e,fetchData:r}=t,n=se(null),s=se(null),i=se(!1),a=se(!1),o=se(!1),l=se(null),c=k=>{n.value=k},u=k=>{s.value=k},f=k=>{l.value=k,o.value=!0},h=()=>{console.log("Teacher feedback form sent successfully")},p=()=>{a.value=!1,r()},m=()=>{console.log("Student saved"),r()},v=()=>{e.push("/admin")},g=()=>{e.push("/testing")},y=()=>{e.push("/aide-schedule")},E=async k=>{switch(k){case"add-student":a.value=!0;break;case"export":i.value=!0;break;case"print":window.print();break;case"admin":v();break;case"testing":g();break;case"aide-schedule":y();break;case"logout":await b();break}},b=async()=>{try{const{useAuthStore:k}=await aa(async()=>{const{useAuthStore:w}=await Promise.resolve().then(()=>VL);return{useAuthStore:w}},void 0);await k().logout(),e.push("/login")}catch(k){console.error("Logout failed:",k)}};return{editingStudentId:n,emailingStudentId:s,showExport:i,showAddStudent:a,showFeedbackDialog:o,feedbackStudentId:l,editStudent:c,emailStudent:u,handleTeacherFeedback:f,handleFormSent:h,handleStudentAdded:p,handleStudentSaved:m,navigateToAdmin:v,navigateToTesting:g,navigateToAideSchedule:y,handleNavAction:E,handleLogout:b}}const t7={class:"student-nav-menu"},r7=["title"],n7={class:"nav-content"},s7={class:"nav-section"},a7={class:"nav-buttons"},i7={key:0,class:"nav-section"},o7={class:"nav-buttons"},l7={key:1,class:"nav-section"},c7={class:"nav-buttons"},u7={class:"nav-section"},d7={class:"user-info"},f7={class:"user-details"},h7={key:0,class:"user-role"},p7={__name:"StudentNavMenu",props:{currentUser:{type:Object,default:null},isAdmin:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:e}){const r=t,n=e,s=Se(()=>{var u;const c=(u=r.currentUser)==null?void 0:u.role;return c!=="paraeducator"&&c!=="teacher"}),i=se(!1);function a(){i.value=!i.value}function o(){i.value=!1}function l(c){n("action",c),o()}return(c,u)=>{var f,h,p,m;return N(),L("div",t7,[d("button",{onClick:a,class:Qe(["hamburger-btn",{active:i.value}]),title:i.value?"Close Menu":"Open Menu"},u[7]||(u[7]=[d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1)]),10,r7),i.value?(N(),L("div",{key:0,class:"nav-overlay",onClick:o})):_e("",!0),d("div",{class:Qe(["nav-panel",{open:i.value}])},[d("div",{class:"nav-header"},[u[8]||(u[8]=d("h3",null,"Student Management",-1)),d("button",{onClick:o,class:"close-btn"},"×")]),d("div",n7,[d("div",s7,[u[12]||(u[12]=d("h4",null,"Actions",-1)),d("div",a7,[s.value?(N(),L("button",{key:0,onClick:u[0]||(u[0]=v=>l("add-student")),class:"nav-btn primary"},u[9]||(u[9]=[d("span",null,"➕",-1),Ne(" Add Student ")]))):_e("",!0),d("button",{onClick:u[1]||(u[1]=v=>l("export")),class:"nav-btn"},u[10]||(u[10]=[d("span",null,"📊",-1),Ne(" Export ")])),d("button",{onClick:u[2]||(u[2]=v=>l("print")),class:"nav-btn print-btn"},u[11]||(u[11]=[d("span",null,"🖨️",-1),Ne(" Print ")]))])]),t.isAdmin?(N(),L("div",i7,[u[15]||(u[15]=d("h4",null,"Admin",-1)),d("div",o7,[d("button",{onClick:u[3]||(u[3]=v=>l("admin")),class:"nav-btn"},u[13]||(u[13]=[d("span",null,"⚙️",-1),Ne(" Admin Panel ")])),d("button",{onClick:u[4]||(u[4]=v=>l("testing")),class:"nav-btn"},u[14]||(u[14]=[d("span",null,"🧪",-1),Ne(" Testing ")]))])])):_e("",!0),((f=t.currentUser)==null?void 0:f.role)==="paraeducator"?(N(),L("div",l7,[u[17]||(u[17]=d("h4",null,"Schedule",-1)),d("div",c7,[d("button",{onClick:u[5]||(u[5]=v=>l("aide-schedule")),class:"nav-btn"},u[16]||(u[16]=[d("span",null,"📅",-1),Ne(" My Schedule ")]))])])):_e("",!0),d("div",u7,[u[19]||(u[19]=d("h4",null,"User",-1)),d("div",d7,[d("div",f7,[d("strong",null,J(((h=t.currentUser)==null?void 0:h.name)||((p=t.currentUser)==null?void 0:p.email)||"User"),1),(m=t.currentUser)!=null&&m.role?(N(),L("span",h7,"("+J(t.currentUser.role)+")",1)):_e("",!0)]),d("button",{onClick:u[6]||(u[6]=v=>l("logout")),class:"nav-btn danger"},u[18]||(u[18]=[d("span",null,"🚪",-1),Ne(" Logout ")]))])])])],2)])}}},m7=yt(p7,[["__scopeId","data-v-7b701536"]]);function g7(t){const{appSettings:e,loadAppSettings:r,loading:n,error:s}=zs(),{getLabel:i}=xo();Ut(async()=>{try{console.log("StudentTable: Loading app settings..."),await r(),console.log("StudentTable: App settings loaded successfully"),t.studentData.students.value.length>0&&await tn.logStudentAccess("table_view","view",{studentCount:t.studentData.students.value.length,viewType:"student_table",hasFilters:Object.keys(t.filterData.activeFilters.value||{}).length>0})}catch(T){console.error("StudentTable: Error loading app settings:",T)}});const a=T=>{const D=t.userMap[T];return D&&(D.name||D.email)||T},o=T=>{const D=t.userMap[T];return D?D.initials?D.initials:D.name?D.name.split(" ").map(B=>B[0]).join("").toUpperCase():D.email?D.email[0].toUpperCase():"?":"?"},l=T=>{const D=t.userMap[T];if(!D)return T;if(D.name){const V=D.name.trim().split(" ");return V.length===1?V[0]:`${V[0][0]}. ${V.slice(1).join(" ")}`}return D.email?D.email[0].toUpperCase():T},c=T=>T?new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",u=T=>{if(!T)return"";const D=new Date,V=new Date(T),B=Math.ceil((V-D)/(1e3*60*60*24));return B<=0?"flag-critical":B<=7?"flag-high":B<=14?"flag-medium":B<=21?"flag-mid":B<=28?"flag-low":B<=35?"flag-prep":""},f=T=>{if(!T)return"";const D=new Date,V=new Date(T),B=Math.ceil((V-D)/(1e3*60*60*24));return B<=0?"flag-critical":B<=7?"flag-high":B<=14?"flag-medium":B<=21?"flag-mid":B<=28?"flag-low":B<=60?"flag-prep-reeval":""},h=T=>u(ot(T,"meetingDate")),p=T=>u(ot(T,"reviewDate")),m=T=>f(ot(T,"reevalDate")),v=T=>{var D,V;return((V=(D=T.app)==null?void 0:D.studentData)==null?void 0:V.caseManagerId)||T.caseManagerId||T.casemanager_id},g=(T,D)=>{var V,B;return((B=(V=T.app)==null?void 0:V.flags)==null?void 0:B[D])||T[D]||!1},y=T=>{var D;return((D=T.app)==null?void 0:D.flags)&&Object.values(T.app.flags).some(Boolean)||T.flag1||T.flag2},E=(T,D)=>{var B,R,F,M,O;console.log("🔍 getDocumentUrl called with:",{studentId:T.id,type:D,appDocuments:(B=T.app)==null?void 0:B.documents,directUrl:T[`${D}Url`],underscoreUrl:T[`${D}_url`],appLevel:(R=T.app)==null?void 0:R[D]});const V=((M=(F=T.app)==null?void 0:F.documents)==null?void 0:M[D])||((O=T.app)==null?void 0:O[D])||T[D]||T[`${D}_url`]||null;return console.log("🔍 getDocumentUrl result:",V),V&&V.includes(".enc")&&console.log("🔍 Secure filename detected:",V),V},b=T=>{var D,V,B,R,F;if(T.schedule)return T.schedule;if((V=(D=T.app)==null?void 0:D.schedule)!=null&&V.periods)return T.app.schedule.periods;if((R=(B=T.aeries)==null?void 0:B.schedule)!=null&&R.periods)return T.aeries.schedule.periods;if((F=T.aeries)!=null&&F.schedule){const M={};return Object.entries(T.aeries.schedule).forEach(([O,K])=>{if(K&&K.teacherId){const j=parseInt(O.replace("period","")),H=i(j);let W=K.teacherId;if(t.userMap){let X=Object.values(t.userMap).find(re=>re.aeriesId===K.teacherId||re.aeriesId===parseInt(K.teacherId)||re.id===K.teacherId);if(X||(X=Object.values(t.userMap).find(re=>{var he,ue,pe,q;return((he=re.aeriesId)==null?void 0:he.toString())===((ue=K.teacherId)==null?void 0:ue.toString())||((pe=re.id)==null?void 0:pe.toString())===((q=K.teacherId)==null?void 0:q.toString())})),X&&X.name){const re=X.name.split(" ");if(re.length>=2){const he=re[0],ue=re[re.length-1];W=`${he.charAt(0)}. ${ue}`}else W=X.name}else console.warn(`Teacher not found for ID: ${K.teacherId}`)}M[H]=W}}),Object.keys(M).length>0?M:null}return null},k=T=>{const D=[],V=b(T);return V&&Object.entries(V).forEach(([B,R])=>{if(R&&typeof R=="object"&&R.coTeaching){const F=R.coTeaching.subject;F&&D.push(`Co-teach: ${F}`)}}),D};return{appSettings:e,appSettingsLoading:n,appSettingsError:s,getUserName:a,getUserInitials:o,getUserInitialLastName:l,formatDate:c,getMeetingUrgencyClass:h,getReviewUrgencyClass:p,getReevalUrgencyClass:m,getCaseManagerId:v,getFlagValue:g,hasFlags:y,getDocumentUrl:E,getSchedule:b,getClassServices:T=>{var M,O;const D=((O=(M=T.app)==null?void 0:M.schedule)==null?void 0:O.classServices)||T.services||[],V=k(T),B=D.filter(K=>K&&K.startsWith&&K.startsWith("Co-teach:")),R=V.filter(K=>!B.includes(K)),F=[...D,...R];if(n.value)return Array.isArray(F)?F.filter(K=>typeof K=="string"&&K.includes(":")):[];if(s.value)return Array.isArray(F)?F.filter(K=>typeof K=="string"&&K.includes(":")):[];if(e.value&&e.value.classServices){const K=e.value.classServices.filter(j=>j.enabledSubcategories&&j.enabledSubcategories.length>0).map(j=>j.name);return Array.isArray(F)?F.filter(j=>{if(typeof j!="string"||!j.includes(":"))return!1;const H=j.split(":")[0];return K.includes(H)}):[]}return Array.isArray(F)?F.filter(K=>typeof K=="string"&&K.includes(":")):[]},getOtherServices:T=>{var V,B;const D=((B=(V=T.app)==null?void 0:V.schedule)==null?void 0:B.otherServices)||T.other_services||[];return Array.isArray(D)?D.filter(R=>!!R):[]},getCoTeachingServices:k,hasServiceProviders:T=>{var R;const D=((R=T.app)==null?void 0:R.providers)||{},V=Object.values(D).some(Boolean);if(n.value||s.value){const F=T.speechId||T.speech_id||T.mhId||T.mh_id||T.otId||T.ot_id||T.ptId||T.pt_id||T.scId||T.sc_id||T.trId||T.tr_id||T.audId||T.aud_id||T.viId||T.vi_id||T.atId||T.at_id||T.dhhId||T.dhh_id||T.omId||T.om_id||T.bisId||T.bis_id||T.hnId||T.hn_id||T.swId||T.sw_id;return V||F}let B=!1;if(e.value&&e.value.serviceProviders){const F=e.value.serviceProviders,M={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"};B=F.some(O=>{const K=M[O];return T[K]||T[K.replace("Id","_id")]})}else B=T.speechId||T.speech_id||T.mhId||T.mh_id||T.otId||T.ot_id||T.ptId||T.pt_id||T.scId||T.sc_id||T.trId||T.tr_id||T.audId||T.aud_id||T.viId||T.vi_id||T.atId||T.at_id||T.dhhId||T.dhh_id||T.omId||T.om_id||T.bisId||T.bis_id||T.hnId||T.hn_id||T.swId||T.sw_id;return V||B},getServiceProviderId:(T,D)=>{var B,R;return((R=(B=T.app)==null?void 0:B.providers)==null?void 0:R[D])||T[D]||T[D.replace("Id","_id")]||null},getProviderFieldName:T=>({SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"})[T]||`${T.toLowerCase()}Id`,isDirectAssignment:T=>{if(!t.currentUser||t.currentUser.role!=="paraeducator")return!1;const D=t.currentUser.uid;let V=t.aideSchedule[D];if(!V){const B=Object.entries(t.userMap).find(([R,F])=>F.uid===D||F.email===t.currentUser.email);if(B){const[R]=B;V=t.aideSchedule[R]}}return(V==null?void 0:V.directAssignment)===T},formatListFromText:HB,getFlagClass:T=>{const D=T.toLowerCase();return D.includes("critical")?"flag-critical":D.includes("high")?"flag-high":D.includes("medium")?"flag-medium":D.includes("mid")?"flag-mid":D.includes("low")?"flag-low":D.includes("prep")?"flag-prep":"flag-low"}}}let Vf;const v7=new Uint8Array(16);function x7(){if(!Vf&&(Vf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Vf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vf(v7)}const En=[];for(let t=0;t<256;++t)En.push((t+256).toString(16).slice(1));function y7(t,e=0){return En[t[e+0]]+En[t[e+1]]+En[t[e+2]]+En[t[e+3]]+"-"+En[t[e+4]]+En[t[e+5]]+"-"+En[t[e+6]]+En[t[e+7]]+"-"+En[t[e+8]]+En[t[e+9]]+"-"+En[t[e+10]]+En[t[e+11]]+En[t[e+12]]+En[t[e+13]]+En[t[e+14]]+En[t[e+15]]}const E7=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Tb={randomUUID:E7};function _7(t,e,r){if(Tb.randomUUID&&!t)return Tb.randomUUID();t=t||{};const n=t.random||(t.rng||x7)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,y7(n)}var Bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G4(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Nx(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var W4={exports:{}};function b7(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Em={exports:{}};const S7={},A7=Object.freeze(Object.defineProperty({__proto__:null,default:S7},Symbol.toStringTag,{value:"Module"})),T7=Nx(A7);var wb;function Zt(){return wb||(wb=1,function(t,e){(function(r,n){t.exports=n()})(Bt,function(){var r=r||function(n,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof Bt<"u"&&Bt.crypto&&(i=Bt.crypto),!i&&typeof b7=="function")try{i=T7}catch{}var a=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function E(){}return function(b){var k;return E.prototype=b,k=new E,E.prototype=null,k}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(E){var b=o(this);return E&&b.mixIn(E),(!b.hasOwnProperty("init")||this.init===b.init)&&(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var E=this.extend();return E.init.apply(E,arguments),E},init:function(){},mixIn:function(E){for(var b in E)E.hasOwnProperty(b)&&(this[b]=E[b]);E.hasOwnProperty("toString")&&(this.toString=E.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=c.WordArray=u.extend({init:function(E,b){E=this.words=E||[],b!=s?this.sigBytes=b:this.sigBytes=E.length*4},toString:function(E){return(E||p).stringify(this)},concat:function(E){var b=this.words,k=E.words,P=this.sigBytes,w=E.sigBytes;if(this.clamp(),P%4)for(var x=0;x<w;x++){var S=k[x>>>2]>>>24-x%4*8&255;b[P+x>>>2]|=S<<24-(P+x)%4*8}else for(var _=0;_<w;_+=4)b[P+_>>>2]=k[_>>>2];return this.sigBytes+=w,this},clamp:function(){var E=this.words,b=this.sigBytes;E[b>>>2]&=4294967295<<32-b%4*8,E.length=n.ceil(b/4)},clone:function(){var E=u.clone.call(this);return E.words=this.words.slice(0),E},random:function(E){for(var b=[],k=0;k<E;k+=4)b.push(a());return new f.init(b,E)}}),h=l.enc={},p=h.Hex={stringify:function(E){for(var b=E.words,k=E.sigBytes,P=[],w=0;w<k;w++){var x=b[w>>>2]>>>24-w%4*8&255;P.push((x>>>4).toString(16)),P.push((x&15).toString(16))}return P.join("")},parse:function(E){for(var b=E.length,k=[],P=0;P<b;P+=2)k[P>>>3]|=parseInt(E.substr(P,2),16)<<24-P%8*4;return new f.init(k,b/2)}},m=h.Latin1={stringify:function(E){for(var b=E.words,k=E.sigBytes,P=[],w=0;w<k;w++){var x=b[w>>>2]>>>24-w%4*8&255;P.push(String.fromCharCode(x))}return P.join("")},parse:function(E){for(var b=E.length,k=[],P=0;P<b;P++)k[P>>>2]|=(E.charCodeAt(P)&255)<<24-P%4*8;return new f.init(k,b)}},v=h.Utf8={stringify:function(E){try{return decodeURIComponent(escape(m.stringify(E)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(E){return m.parse(unescape(encodeURIComponent(E)))}},g=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(E){typeof E=="string"&&(E=v.parse(E)),this._data.concat(E),this._nDataBytes+=E.sigBytes},_process:function(E){var b,k=this._data,P=k.words,w=k.sigBytes,x=this.blockSize,S=x*4,_=w/S;E?_=n.ceil(_):_=n.max((_|0)-this._minBufferSize,0);var A=_*x,C=n.min(A*4,w);if(A){for(var T=0;T<A;T+=x)this._doProcessBlock(P,T);b=P.splice(0,A),k.sigBytes-=C}return new f.init(b,C)},clone:function(){var E=u.clone.call(this);return E._data=this._data.clone(),E},_minBufferSize:0});c.Hasher=g.extend({cfg:u.extend(),init:function(E){this.cfg=this.cfg.extend(E),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(E){return this._append(E),this._process(),this},finalize:function(E){E&&this._append(E);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(E){return function(b,k){return new E.init(k).finalize(b)}},_createHmacHelper:function(E){return function(b,k){return new y.HMAC.init(E,k).finalize(b)}}});var y=l.algo={};return l}(Math);return r})}(Em)),Em.exports}var _m={exports:{}},Cb;function Rp(){return Cb||(Cb=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=s.x64={};l.Word=a.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=a.extend({init:function(c,u){c=this.words=c||[],u!=n?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,f=[],h=0;h<u;h++){var p=c[h];f.push(p.high),f.push(p.low)}return o.create(f,this.sigBytes)},clone:function(){for(var c=a.clone.call(this),u=c.words=this.words.slice(0),f=u.length,h=0;h<f;h++)u[h]=u[h].clone();return c}})}(),r})}(_m)),_m.exports}var bm={exports:{}},Ib;function w7(){return Ib||(Ib=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,s=n.lib,i=s.WordArray,a=i.init,o=i.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],f=0;f<c;f++)u[f>>>2]|=l[f]<<24-f%4*8;a.call(this,u,c)}else a.apply(this,arguments)};o.prototype=i}}(),r.lib.WordArray})}(bm)),bm.exports}var Sm={exports:{}},kb;function C7(){return kb||(kb=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=c[h>>>2]>>>16-h%4*8&65535;f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=l.charCodeAt(f)<<16-f%2*16;return i.create(u,c*2)}},a.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=o(c[h>>>2]>>>16-h%4*8&65535);f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=o(l.charCodeAt(f)<<16-f%2*16);return i.create(u,c*2)}};function o(l){return l<<8&4278255360|l>>>8&16711935}}(),r.enc.Utf16})}(Sm)),Sm.exports}var Am={exports:{}},Db;function hl(){return Db||(Db=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,f=this._map;l.clamp();for(var h=[],p=0;p<u;p+=3)for(var m=c[p>>>2]>>>24-p%4*8&255,v=c[p+1>>>2]>>>24-(p+1)%4*8&255,g=c[p+2>>>2]>>>24-(p+2)%4*8&255,y=m<<16|v<<8|g,E=0;E<4&&p+E*.75<u;E++)h.push(f.charAt(y>>>6*(3-E)&63));var b=f.charAt(64);if(b)for(;h.length%4;)h.push(b);return h.join("")},parse:function(l){var c=l.length,u=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<u.length;h++)f[u.charCodeAt(h)]=h}var p=u.charAt(64);if(p){var m=l.indexOf(p);m!==-1&&(c=m)}return o(l,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var m=u[l.charCodeAt(p-1)]<<p%4*2,v=u[l.charCodeAt(p)]>>>6-p%4*2,g=m|v;f[h>>>2]|=g<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64})}(Am)),Am.exports}var Tm={exports:{}},Pb;function I7(){return Pb||(Pb=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,f=l.sigBytes,h=c?this._safe_map:this._map;l.clamp();for(var p=[],m=0;m<f;m+=3)for(var v=u[m>>>2]>>>24-m%4*8&255,g=u[m+1>>>2]>>>24-(m+1)%4*8&255,y=u[m+2>>>2]>>>24-(m+2)%4*8&255,E=v<<16|g<<8|y,b=0;b<4&&m+b*.75<f;b++)p.push(h.charAt(E>>>6*(3-b)&63));var k=h.charAt(64);if(k)for(;p.length%4;)p.push(k);return p.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,f=c?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var p=0;p<f.length;p++)h[f.charCodeAt(p)]=p}var m=f.charAt(64);if(m){var v=l.indexOf(m);v!==-1&&(u=v)}return o(l,u,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var m=u[l.charCodeAt(p-1)]<<p%4*2,v=u[l.charCodeAt(p)]>>>6-p%4*2,g=m|v;f[h>>>2]|=g<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64url})}(Tm)),Tm.exports}var wm={exports:{}},Rb;function pl(){return Rb||(Rb=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[];(function(){for(var v=0;v<64;v++)c[v]=n.abs(n.sin(v+1))*4294967296|0})();var u=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,g){for(var y=0;y<16;y++){var E=g+y,b=v[E];v[E]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}var k=this._hash.words,P=v[g+0],w=v[g+1],x=v[g+2],S=v[g+3],_=v[g+4],A=v[g+5],C=v[g+6],T=v[g+7],D=v[g+8],V=v[g+9],B=v[g+10],R=v[g+11],F=v[g+12],M=v[g+13],O=v[g+14],K=v[g+15],j=k[0],H=k[1],W=k[2],X=k[3];j=f(j,H,W,X,P,7,c[0]),X=f(X,j,H,W,w,12,c[1]),W=f(W,X,j,H,x,17,c[2]),H=f(H,W,X,j,S,22,c[3]),j=f(j,H,W,X,_,7,c[4]),X=f(X,j,H,W,A,12,c[5]),W=f(W,X,j,H,C,17,c[6]),H=f(H,W,X,j,T,22,c[7]),j=f(j,H,W,X,D,7,c[8]),X=f(X,j,H,W,V,12,c[9]),W=f(W,X,j,H,B,17,c[10]),H=f(H,W,X,j,R,22,c[11]),j=f(j,H,W,X,F,7,c[12]),X=f(X,j,H,W,M,12,c[13]),W=f(W,X,j,H,O,17,c[14]),H=f(H,W,X,j,K,22,c[15]),j=h(j,H,W,X,w,5,c[16]),X=h(X,j,H,W,C,9,c[17]),W=h(W,X,j,H,R,14,c[18]),H=h(H,W,X,j,P,20,c[19]),j=h(j,H,W,X,A,5,c[20]),X=h(X,j,H,W,B,9,c[21]),W=h(W,X,j,H,K,14,c[22]),H=h(H,W,X,j,_,20,c[23]),j=h(j,H,W,X,V,5,c[24]),X=h(X,j,H,W,O,9,c[25]),W=h(W,X,j,H,S,14,c[26]),H=h(H,W,X,j,D,20,c[27]),j=h(j,H,W,X,M,5,c[28]),X=h(X,j,H,W,x,9,c[29]),W=h(W,X,j,H,T,14,c[30]),H=h(H,W,X,j,F,20,c[31]),j=p(j,H,W,X,A,4,c[32]),X=p(X,j,H,W,D,11,c[33]),W=p(W,X,j,H,R,16,c[34]),H=p(H,W,X,j,O,23,c[35]),j=p(j,H,W,X,w,4,c[36]),X=p(X,j,H,W,_,11,c[37]),W=p(W,X,j,H,T,16,c[38]),H=p(H,W,X,j,B,23,c[39]),j=p(j,H,W,X,M,4,c[40]),X=p(X,j,H,W,P,11,c[41]),W=p(W,X,j,H,S,16,c[42]),H=p(H,W,X,j,C,23,c[43]),j=p(j,H,W,X,V,4,c[44]),X=p(X,j,H,W,F,11,c[45]),W=p(W,X,j,H,K,16,c[46]),H=p(H,W,X,j,x,23,c[47]),j=m(j,H,W,X,P,6,c[48]),X=m(X,j,H,W,T,10,c[49]),W=m(W,X,j,H,O,15,c[50]),H=m(H,W,X,j,A,21,c[51]),j=m(j,H,W,X,F,6,c[52]),X=m(X,j,H,W,S,10,c[53]),W=m(W,X,j,H,B,15,c[54]),H=m(H,W,X,j,w,21,c[55]),j=m(j,H,W,X,D,6,c[56]),X=m(X,j,H,W,K,10,c[57]),W=m(W,X,j,H,C,15,c[58]),H=m(H,W,X,j,M,21,c[59]),j=m(j,H,W,X,_,6,c[60]),X=m(X,j,H,W,R,10,c[61]),W=m(W,X,j,H,x,15,c[62]),H=m(H,W,X,j,V,21,c[63]),k[0]=k[0]+j|0,k[1]=k[1]+H|0,k[2]=k[2]+W|0,k[3]=k[3]+X|0},_doFinalize:function(){var v=this._data,g=v.words,y=this._nDataBytes*8,E=v.sigBytes*8;g[E>>>5]|=128<<24-E%32;var b=n.floor(y/4294967296),k=y;g[(E+64>>>9<<4)+15]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,g[(E+64>>>9<<4)+14]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,v.sigBytes=(g.length+1)*4,this._process();for(var P=this._hash,w=P.words,x=0;x<4;x++){var S=w[x];w[x]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}return P},clone:function(){var v=o.clone.call(this);return v._hash=this._hash.clone(),v}});function f(v,g,y,E,b,k,P){var w=v+(g&y|~g&E)+b+P;return(w<<k|w>>>32-k)+g}function h(v,g,y,E,b,k,P){var w=v+(g&E|y&~E)+b+P;return(w<<k|w>>>32-k)+g}function p(v,g,y,E,b,k,P){var w=v+(g^y^E)+b+P;return(w<<k|w>>>32-k)+g}function m(v,g,y,E,b,k,P){var w=v+(y^(g|~E))+b+P;return(w<<k|w>>>32-k)+g}s.MD5=o._createHelper(u),s.HmacMD5=o._createHmacHelper(u)}(Math),r.MD5})}(wm)),wm.exports}var Cm={exports:{}},Fb;function z4(){return Fb||(Fb=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.Hasher,o=n.algo,l=[],c=o.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,f){for(var h=this._hash.words,p=h[0],m=h[1],v=h[2],g=h[3],y=h[4],E=0;E<80;E++){if(E<16)l[E]=u[f+E]|0;else{var b=l[E-3]^l[E-8]^l[E-14]^l[E-16];l[E]=b<<1|b>>>31}var k=(p<<5|p>>>27)+y+l[E];E<20?k+=(m&v|~m&g)+1518500249:E<40?k+=(m^v^g)+1859775393:E<60?k+=(m&v|m&g|v&g)-1894007588:k+=(m^v^g)-899497514,y=g,g=v,v=m<<30|m>>>2,m=p,p=k}h[0]=h[0]+p|0,h[1]=h[1]+m|0,h[2]=h[2]+v|0,h[3]=h[3]+g|0,h[4]=h[4]+y|0},_doFinalize:function(){var u=this._data,f=u.words,h=this._nDataBytes*8,p=u.sigBytes*8;return f[p>>>5]|=128<<24-p%32,f[(p+64>>>9<<4)+14]=Math.floor(h/4294967296),f[(p+64>>>9<<4)+15]=h,u.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c)}(),r.SHA1})}(Cm)),Cm.exports}var Im={exports:{}},Nb;function Ox(){return Nb||(Nb=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[],u=[];(function(){function p(y){for(var E=n.sqrt(y),b=2;b<=E;b++)if(!(y%b))return!1;return!0}function m(y){return(y-(y|0))*4294967296|0}for(var v=2,g=0;g<64;)p(v)&&(g<8&&(c[g]=m(n.pow(v,1/2))),u[g]=m(n.pow(v,1/3)),g++),v++})();var f=[],h=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(p,m){for(var v=this._hash.words,g=v[0],y=v[1],E=v[2],b=v[3],k=v[4],P=v[5],w=v[6],x=v[7],S=0;S<64;S++){if(S<16)f[S]=p[m+S]|0;else{var _=f[S-15],A=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,C=f[S-2],T=(C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10;f[S]=A+f[S-7]+T+f[S-16]}var D=k&P^~k&w,V=g&y^g&E^y&E,B=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),R=(k<<26|k>>>6)^(k<<21|k>>>11)^(k<<7|k>>>25),F=x+R+D+u[S]+f[S],M=B+V;x=w,w=P,P=k,k=b+F|0,b=E,E=y,y=g,g=F+M|0}v[0]=v[0]+g|0,v[1]=v[1]+y|0,v[2]=v[2]+E|0,v[3]=v[3]+b|0,v[4]=v[4]+k|0,v[5]=v[5]+P|0,v[6]=v[6]+w|0,v[7]=v[7]+x|0},_doFinalize:function(){var p=this._data,m=p.words,v=this._nDataBytes*8,g=p.sigBytes*8;return m[g>>>5]|=128<<24-g%32,m[(g+64>>>9<<4)+14]=n.floor(v/4294967296),m[(g+64>>>9<<4)+15]=v,p.sigBytes=m.length*4,this._process(),this._hash},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});s.SHA256=o._createHelper(h),s.HmacSHA256=o._createHmacHelper(h)}(Math),r.SHA256})}(Im)),Im.exports}var km={exports:{}},Ob;function k7(){return Ob||(Ob=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Ox())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c}});n.SHA224=o._createHelper(l),n.HmacSHA224=o._createHmacHelper(l)}(),r.SHA224})}(km)),km.exports}var Dm={exports:{}},Mb;function K4(){return Mb||(Mb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Rp())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.Hasher,a=n.x64,o=a.Word,l=a.WordArray,c=n.algo;function u(){return o.create.apply(o,arguments)}var f=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],h=[];(function(){for(var m=0;m<80;m++)h[m]=u()})();var p=c.SHA512=i.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(m,v){for(var g=this._hash.words,y=g[0],E=g[1],b=g[2],k=g[3],P=g[4],w=g[5],x=g[6],S=g[7],_=y.high,A=y.low,C=E.high,T=E.low,D=b.high,V=b.low,B=k.high,R=k.low,F=P.high,M=P.low,O=w.high,K=w.low,j=x.high,H=x.low,W=S.high,X=S.low,re=_,he=A,ue=C,pe=T,q=D,G=V,oe=B,Q=R,Y=F,Z=M,ne=O,ge=K,ae=j,ce=H,fe=W,Ae=X,Ie=0;Ie<80;Ie++){var Te,Ge,ke=h[Ie];if(Ie<16)Ge=ke.high=m[v+Ie*2]|0,Te=ke.low=m[v+Ie*2+1]|0;else{var $e=h[Ie-15],Be=$e.high,We=$e.low,Ke=(Be>>>1|We<<31)^(Be>>>8|We<<24)^Be>>>7,Ee=(We>>>1|Be<<31)^(We>>>8|Be<<24)^(We>>>7|Be<<25),ye=h[Ie-2],be=ye.high,Oe=ye.low,je=(be>>>19|Oe<<13)^(be<<3|Oe>>>29)^be>>>6,lt=(Oe>>>19|be<<13)^(Oe<<3|be>>>29)^(Oe>>>6|be<<26),gt=h[Ie-7],Et=gt.high,jt=gt.low,pt=h[Ie-16],ut=pt.high,mt=pt.low;Te=Ee+jt,Ge=Ke+Et+(Te>>>0<Ee>>>0?1:0),Te=Te+lt,Ge=Ge+je+(Te>>>0<lt>>>0?1:0),Te=Te+mt,Ge=Ge+ut+(Te>>>0<mt>>>0?1:0),ke.high=Ge,ke.low=Te}var Dt=Y&ne^~Y&ae,Ot=Z&ge^~Z&ce,br=re&ue^re&q^ue&q,Zn=he&pe^he&G^pe&G,ki=(re>>>28|he<<4)^(re<<30|he>>>2)^(re<<25|he>>>7),fs=(he>>>28|re<<4)^(he<<30|re>>>2)^(he<<25|re>>>7),_l=(Y>>>14|Z<<18)^(Y>>>18|Z<<14)^(Y<<23|Z>>>9),ja=(Z>>>14|Y<<18)^(Z>>>18|Y<<14)^(Z<<23|Y>>>9),_o=f[Ie],nn=_o.high,bo=_o.low,Dr=Ae+ja,Dn=fe+_l+(Dr>>>0<Ae>>>0?1:0),Dr=Dr+Ot,Dn=Dn+Dt+(Dr>>>0<Ot>>>0?1:0),Dr=Dr+bo,Dn=Dn+nn+(Dr>>>0<bo>>>0?1:0),Dr=Dr+Te,Dn=Dn+Ge+(Dr>>>0<Te>>>0?1:0),bl=fs+Zn,Wc=ki+br+(bl>>>0<fs>>>0?1:0);fe=ae,Ae=ce,ae=ne,ce=ge,ne=Y,ge=Z,Z=Q+Dr|0,Y=oe+Dn+(Z>>>0<Q>>>0?1:0)|0,oe=q,Q=G,q=ue,G=pe,ue=re,pe=he,he=Dr+bl|0,re=Dn+Wc+(he>>>0<Dr>>>0?1:0)|0}A=y.low=A+he,y.high=_+re+(A>>>0<he>>>0?1:0),T=E.low=T+pe,E.high=C+ue+(T>>>0<pe>>>0?1:0),V=b.low=V+G,b.high=D+q+(V>>>0<G>>>0?1:0),R=k.low=R+Q,k.high=B+oe+(R>>>0<Q>>>0?1:0),M=P.low=M+Z,P.high=F+Y+(M>>>0<Z>>>0?1:0),K=w.low=K+ge,w.high=O+ne+(K>>>0<ge>>>0?1:0),H=x.low=H+ce,x.high=j+ae+(H>>>0<ce>>>0?1:0),X=S.low=X+Ae,S.high=W+fe+(X>>>0<Ae>>>0?1:0)},_doFinalize:function(){var m=this._data,v=m.words,g=this._nDataBytes*8,y=m.sigBytes*8;v[y>>>5]|=128<<24-y%32,v[(y+128>>>10<<5)+30]=Math.floor(g/4294967296),v[(y+128>>>10<<5)+31]=g,m.sigBytes=v.length*4,this._process();var E=this._hash.toX32();return E},clone:function(){var m=i.clone.call(this);return m._hash=this._hash.clone(),m},blockSize:1024/32});n.SHA512=i._createHelper(p),n.HmacSHA512=i._createHmacHelper(p)}(),r.SHA512})}(Dm)),Dm.exports}var Pm={exports:{}},Lb;function D7(){return Lb||(Lb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Rp(),K4())})(Bt,function(r){return function(){var n=r,s=n.x64,i=s.Word,a=s.WordArray,o=n.algo,l=o.SHA512,c=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});n.SHA384=l._createHelper(c),n.HmacSHA384=l._createHmacHelper(c)}(),r.SHA384})}(Pm)),Pm.exports}var Rm={exports:{}},Bb;function P7(){return Bb||(Bb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Rp())})(Bt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.x64,c=l.Word,u=s.algo,f=[],h=[],p=[];(function(){for(var g=1,y=0,E=0;E<24;E++){f[g+5*y]=(E+1)*(E+2)/2%64;var b=y%5,k=(2*g+3*y)%5;g=b,y=k}for(var g=0;g<5;g++)for(var y=0;y<5;y++)h[g+5*y]=y+(2*g+3*y)%5*5;for(var P=1,w=0;w<24;w++){for(var x=0,S=0,_=0;_<7;_++){if(P&1){var A=(1<<_)-1;A<32?S^=1<<A:x^=1<<A-32}P&128?P=P<<1^113:P<<=1}p[w]=c.create(x,S)}})();var m=[];(function(){for(var g=0;g<25;g++)m[g]=c.create()})();var v=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var g=this._state=[],y=0;y<25;y++)g[y]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(g,y){for(var E=this._state,b=this.blockSize/2,k=0;k<b;k++){var P=g[y+2*k],w=g[y+2*k+1];P=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360;var x=E[k];x.high^=w,x.low^=P}for(var S=0;S<24;S++){for(var _=0;_<5;_++){for(var A=0,C=0,T=0;T<5;T++){var x=E[_+5*T];A^=x.high,C^=x.low}var D=m[_];D.high=A,D.low=C}for(var _=0;_<5;_++)for(var V=m[(_+4)%5],B=m[(_+1)%5],R=B.high,F=B.low,A=V.high^(R<<1|F>>>31),C=V.low^(F<<1|R>>>31),T=0;T<5;T++){var x=E[_+5*T];x.high^=A,x.low^=C}for(var M=1;M<25;M++){var A,C,x=E[M],O=x.high,K=x.low,j=f[M];j<32?(A=O<<j|K>>>32-j,C=K<<j|O>>>32-j):(A=K<<j-32|O>>>64-j,C=O<<j-32|K>>>64-j);var H=m[h[M]];H.high=A,H.low=C}var W=m[0],X=E[0];W.high=X.high,W.low=X.low;for(var _=0;_<5;_++)for(var T=0;T<5;T++){var M=_+5*T,x=E[M],re=m[M],he=m[(_+1)%5+5*T],ue=m[(_+2)%5+5*T];x.high=re.high^~he.high&ue.high,x.low=re.low^~he.low&ue.low}var x=E[0],pe=p[S];x.high^=pe.high,x.low^=pe.low}},_doFinalize:function(){var g=this._data,y=g.words;this._nDataBytes*8;var E=g.sigBytes*8,b=this.blockSize*32;y[E>>>5]|=1<<24-E%32,y[(n.ceil((E+1)/b)*b>>>5)-1]|=128,g.sigBytes=y.length*4,this._process();for(var k=this._state,P=this.cfg.outputLength/8,w=P/8,x=[],S=0;S<w;S++){var _=k[S],A=_.high,C=_.low;A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,x.push(C),x.push(A)}return new a.init(x,P)},clone:function(){for(var g=o.clone.call(this),y=g._state=this._state.slice(0),E=0;E<25;E++)y[E]=y[E].clone();return g}});s.SHA3=o._createHelper(v),s.HmacSHA3=o._createHmacHelper(v)}(Math),r.SHA3})}(Rm)),Rm.exports}var Fm={exports:{}},Ub;function R7(){return Ub||(Ub=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=a.create([0,1518500249,1859775393,2400959708,2840853838]),m=a.create([1352829926,1548603684,1836072691,2053994217,0]),v=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(w,x){for(var S=0;S<16;S++){var _=x+S,A=w[_];w[_]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var C=this._hash.words,T=p.words,D=m.words,V=c.words,B=u.words,R=f.words,F=h.words,M,O,K,j,H,W,X,re,he,ue;W=M=C[0],X=O=C[1],re=K=C[2],he=j=C[3],ue=H=C[4];for(var pe,S=0;S<80;S+=1)pe=M+w[x+V[S]]|0,S<16?pe+=g(O,K,j)+T[0]:S<32?pe+=y(O,K,j)+T[1]:S<48?pe+=E(O,K,j)+T[2]:S<64?pe+=b(O,K,j)+T[3]:pe+=k(O,K,j)+T[4],pe=pe|0,pe=P(pe,R[S]),pe=pe+H|0,M=H,H=j,j=P(K,10),K=O,O=pe,pe=W+w[x+B[S]]|0,S<16?pe+=k(X,re,he)+D[0]:S<32?pe+=b(X,re,he)+D[1]:S<48?pe+=E(X,re,he)+D[2]:S<64?pe+=y(X,re,he)+D[3]:pe+=g(X,re,he)+D[4],pe=pe|0,pe=P(pe,F[S]),pe=pe+ue|0,W=ue,ue=he,he=P(re,10),re=X,X=pe;pe=C[1]+K+he|0,C[1]=C[2]+j+ue|0,C[2]=C[3]+H+W|0,C[3]=C[4]+M+X|0,C[4]=C[0]+O+re|0,C[0]=pe},_doFinalize:function(){var w=this._data,x=w.words,S=this._nDataBytes*8,_=w.sigBytes*8;x[_>>>5]|=128<<24-_%32,x[(_+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,w.sigBytes=(x.length+1)*4,this._process();for(var A=this._hash,C=A.words,T=0;T<5;T++){var D=C[T];C[T]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}return A},clone:function(){var w=o.clone.call(this);return w._hash=this._hash.clone(),w}});function g(w,x,S){return w^x^S}function y(w,x,S){return w&x|~w&S}function E(w,x,S){return(w|~x)^S}function b(w,x,S){return w&S|x&~S}function k(w,x,S){return w^(x|~S)}function P(w,x){return w<<x|w>>>32-x}s.RIPEMD160=o._createHelper(v),s.HmacRIPEMD160=o._createHmacHelper(v)}(),r.RIPEMD160})}(Fm)),Fm.exports}var Nm={exports:{}},$b;function Mx(){return $b||($b=1,function(t,e){(function(r,n){t.exports=n(Zt())})(Bt,function(r){(function(){var n=r,s=n.lib,i=s.Base,a=n.enc,o=a.Utf8,l=n.algo;l.HMAC=i.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=o.parse(u));var f=c.blockSize,h=f*4;u.sigBytes>h&&(u=c.finalize(u)),u.clamp();for(var p=this._oKey=u.clone(),m=this._iKey=u.clone(),v=p.words,g=m.words,y=0;y<f;y++)v[y]^=1549556828,g[y]^=909522486;p.sigBytes=m.sigBytes=h,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,f=u.finalize(c);u.reset();var h=u.finalize(this._oKey.clone().concat(f));return h}})})()})}(Nm)),Nm.exports}var Om={exports:{}},Vb;function F7(){return Vb||(Vb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Ox(),Mx())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.SHA256,c=o.HMAC,u=o.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,h){for(var p=this.cfg,m=c.create(p.hasher,f),v=a.create(),g=a.create([1]),y=v.words,E=g.words,b=p.keySize,k=p.iterations;y.length<b;){var P=m.update(h).finalize(g);m.reset();for(var w=P.words,x=w.length,S=P,_=1;_<k;_++){S=m.finalize(S),m.reset();for(var A=S.words,C=0;C<x;C++)w[C]^=A[C]}v.concat(P),E[0]++}return v.sigBytes=b*4,v}});n.PBKDF2=function(f,h,p){return u.create(p).compute(f,h)}}(),r.PBKDF2})}(Om)),Om.exports}var Mm={exports:{}},Hb;function yo(){return Hb||(Hb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),z4(),Mx())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.MD5,c=o.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,f){for(var h,p=this.cfg,m=p.hasher.create(),v=a.create(),g=v.words,y=p.keySize,E=p.iterations;g.length<y;){h&&m.update(h),h=m.update(u).finalize(f),m.reset();for(var b=1;b<E;b++)h=m.finalize(h),m.reset();v.concat(h)}return v.sigBytes=y*4,v}});n.EvpKDF=function(u,f,h){return c.create(h).compute(u,f)}}(),r.EvpKDF})}(Mm)),Mm.exports}var Lm={exports:{}},jb;function xn(){return jb||(jb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),yo())})(Bt,function(r){r.lib.Cipher||function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=i.BufferedBlockAlgorithm,c=s.enc;c.Utf8;var u=c.Base64,f=s.algo,h=f.EvpKDF,p=i.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(A,C){return this.create(this._ENC_XFORM_MODE,A,C)},createDecryptor:function(A,C){return this.create(this._DEC_XFORM_MODE,A,C)},init:function(A,C,T){this.cfg=this.cfg.extend(T),this._xformMode=A,this._key=C,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var C=this._doFinalize();return C},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function A(C){return typeof C=="string"?_:w}return function(C){return{encrypt:function(T,D,V){return A(D).encrypt(C,T,D,V)},decrypt:function(T,D,V){return A(D).decrypt(C,T,D,V)}}}}()});i.StreamCipher=p.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1});var m=s.mode={},v=i.BlockCipherMode=a.extend({createEncryptor:function(A,C){return this.Encryptor.create(A,C)},createDecryptor:function(A,C){return this.Decryptor.create(A,C)},init:function(A,C){this._cipher=A,this._iv=C}}),g=m.CBC=function(){var A=v.extend();A.Encryptor=A.extend({processBlock:function(T,D){var V=this._cipher,B=V.blockSize;C.call(this,T,D,B),V.encryptBlock(T,D),this._prevBlock=T.slice(D,D+B)}}),A.Decryptor=A.extend({processBlock:function(T,D){var V=this._cipher,B=V.blockSize,R=T.slice(D,D+B);V.decryptBlock(T,D),C.call(this,T,D,B),this._prevBlock=R}});function C(T,D,V){var B,R=this._iv;R?(B=R,this._iv=n):B=this._prevBlock;for(var F=0;F<V;F++)T[D+F]^=B[F]}return A}(),y=s.pad={},E=y.Pkcs7={pad:function(A,C){for(var T=C*4,D=T-A.sigBytes%T,V=D<<24|D<<16|D<<8|D,B=[],R=0;R<D;R+=4)B.push(V);var F=o.create(B,D);A.concat(F)},unpad:function(A){var C=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=C}};i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:g,padding:E}),reset:function(){var A;p.reset.call(this);var C=this.cfg,T=C.iv,D=C.mode;this._xformMode==this._ENC_XFORM_MODE?A=D.createEncryptor:(A=D.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==A?this._mode.init(this,T&&T.words):(this._mode=A.call(D,this,T&&T.words),this._mode.__creator=A)},_doProcessBlock:function(A,C){this._mode.processBlock(A,C)},_doFinalize:function(){var A,C=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(C.pad(this._data,this.blockSize),A=this._process(!0)):(A=this._process(!0),C.unpad(A)),A},blockSize:128/32});var b=i.CipherParams=a.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),k=s.format={},P=k.OpenSSL={stringify:function(A){var C,T=A.ciphertext,D=A.salt;return D?C=o.create([1398893684,1701076831]).concat(D).concat(T):C=T,C.toString(u)},parse:function(A){var C,T=u.parse(A),D=T.words;return D[0]==1398893684&&D[1]==1701076831&&(C=o.create(D.slice(2,4)),D.splice(0,4),T.sigBytes-=16),b.create({ciphertext:T,salt:C})}},w=i.SerializableCipher=a.extend({cfg:a.extend({format:P}),encrypt:function(A,C,T,D){D=this.cfg.extend(D);var V=A.createEncryptor(T,D),B=V.finalize(C),R=V.cfg;return b.create({ciphertext:B,key:T,iv:R.iv,algorithm:A,mode:R.mode,padding:R.padding,blockSize:A.blockSize,formatter:D.format})},decrypt:function(A,C,T,D){D=this.cfg.extend(D),C=this._parse(C,D.format);var V=A.createDecryptor(T,D).finalize(C.ciphertext);return V},_parse:function(A,C){return typeof A=="string"?C.parse(A,this):A}}),x=s.kdf={},S=x.OpenSSL={execute:function(A,C,T,D,V){if(D||(D=o.random(64/8)),V)var B=h.create({keySize:C+T,hasher:V}).compute(A,D);else var B=h.create({keySize:C+T}).compute(A,D);var R=o.create(B.words.slice(C),T*4);return B.sigBytes=C*4,b.create({key:B,iv:R,salt:D})}},_=i.PasswordBasedCipher=w.extend({cfg:w.cfg.extend({kdf:S}),encrypt:function(A,C,T,D){D=this.cfg.extend(D);var V=D.kdf.execute(T,A.keySize,A.ivSize,D.salt,D.hasher);D.iv=V.iv;var B=w.encrypt.call(this,A,C,V.key,D);return B.mixIn(V),B},decrypt:function(A,C,T,D){D=this.cfg.extend(D),C=this._parse(C,D.format);var V=D.kdf.execute(T,A.keySize,A.ivSize,C.salt,D.hasher);D.iv=V.iv;var B=w.decrypt.call(this,A,C,V.key,D);return B}})}()})}(Lm)),Lm.exports}var Bm={exports:{}},Gb;function N7(){return Gb||(Gb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.mode.CFB=function(){var n=r.lib.BlockCipherMode.extend();n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize;s.call(this,i,a,l,o),this._prevBlock=i.slice(a,a+l)}}),n.Decryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=i.slice(a,a+l);s.call(this,i,a,l,o),this._prevBlock=c}});function s(i,a,o,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var f=0;f<o;f++)i[a+f]^=c[f]}return n}(),r.mode.CFB})}(Bm)),Bm.exports}var Um={exports:{}},Wb;function O7(){return Wb||(Wb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.mode.CTR=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var f=u.slice(0);o.encryptBlock(f,0),u[l-1]=u[l-1]+1|0;for(var h=0;h<l;h++)i[a+h]^=f[h]}});return n.Decryptor=s,n}(),r.mode.CTR})}(Um)),Um.exports}var $m={exports:{}},zb;function M7(){return zb||(zb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return r.mode.CTRGladman=function(){var n=r.lib.BlockCipherMode.extend();function s(o){if((o>>24&255)===255){var l=o>>16&255,c=o>>8&255,u=o&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,o=0,o+=l<<16,o+=c<<8,o+=u}else o+=1<<24;return o}function i(o){return(o[0]=s(o[0]))===0&&(o[1]=s(o[1])),o}var a=n.Encryptor=n.extend({processBlock:function(o,l){var c=this._cipher,u=c.blockSize,f=this._iv,h=this._counter;f&&(h=this._counter=f.slice(0),this._iv=void 0),i(h);var p=h.slice(0);c.encryptBlock(p,0);for(var m=0;m<u;m++)o[l+m]^=p[m]}});return n.Decryptor=a,n}(),r.mode.CTRGladman})}($m)),$m.exports}var Vm={exports:{}},Kb;function L7(){return Kb||(Kb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.mode.OFB=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var f=0;f<l;f++)i[a+f]^=u[f]}});return n.Decryptor=s,n}(),r.mode.OFB})}(Vm)),Vm.exports}var Hm={exports:{}},qb;function B7(){return qb||(qb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.mode.ECB=function(){var n=r.lib.BlockCipherMode.extend();return n.Encryptor=n.extend({processBlock:function(s,i){this._cipher.encryptBlock(s,i)}}),n.Decryptor=n.extend({processBlock:function(s,i){this._cipher.decryptBlock(s,i)}}),n}(),r.mode.ECB})}(Hm)),Hm.exports}var jm={exports:{}},Xb;function U7(){return Xb||(Xb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.pad.AnsiX923={pad:function(n,s){var i=n.sigBytes,a=s*4,o=a-i%a,l=i+o-1;n.clamp(),n.words[l>>>2]|=o<<24-l%4*8,n.sigBytes+=o},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Ansix923})}(jm)),jm.exports}var Gm={exports:{}},Yb;function $7(){return Yb||(Yb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.pad.Iso10126={pad:function(n,s){var i=s*4,a=i-n.sigBytes%i;n.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Iso10126})}(Gm)),Gm.exports}var Wm={exports:{}},Qb;function V7(){return Qb||(Qb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.pad.Iso97971={pad:function(n,s){n.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(n,s)},unpad:function(n){r.pad.ZeroPadding.unpad(n),n.sigBytes--}},r.pad.Iso97971})}(Wm)),Wm.exports}var zm={exports:{}},Jb;function H7(){return Jb||(Jb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.pad.ZeroPadding={pad:function(n,s){var i=s*4;n.clamp(),n.sigBytes+=i-(n.sigBytes%i||i)},unpad:function(n){for(var s=n.words,i=n.sigBytes-1,i=n.sigBytes-1;i>=0;i--)if(s[i>>>2]>>>24-i%4*8&255){n.sigBytes=i+1;break}}},r.pad.ZeroPadding})}(zm)),zm.exports}var Km={exports:{}},Zb;function j7(){return Zb||(Zb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}(Km)),Km.exports}var qm={exports:{}},eS;function G7(){return eS||(eS=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})(Bt,function(r){return function(n){var s=r,i=s.lib,a=i.CipherParams,o=s.enc,l=o.Hex,c=s.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var f=l.parse(u);return a.create({ciphertext:f})}}}(),r.format.Hex})}(qm)),qm.exports}var Xm={exports:{}},tS;function W7(){return tS||(tS=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),hl(),pl(),yo(),xn())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo,o=[],l=[],c=[],u=[],f=[],h=[],p=[],m=[],v=[],g=[];(function(){for(var b=[],k=0;k<256;k++)k<128?b[k]=k<<1:b[k]=k<<1^283;for(var P=0,w=0,k=0;k<256;k++){var x=w^w<<1^w<<2^w<<3^w<<4;x=x>>>8^x&255^99,o[P]=x,l[x]=P;var S=b[P],_=b[S],A=b[_],C=b[x]*257^x*16843008;c[P]=C<<24|C>>>8,u[P]=C<<16|C>>>16,f[P]=C<<8|C>>>24,h[P]=C;var C=A*16843009^_*65537^S*257^P*16843008;p[x]=C<<24|C>>>8,m[x]=C<<16|C>>>16,v[x]=C<<8|C>>>24,g[x]=C,P?(P=S^b[b[b[A^S]]],w^=b[b[w]]):P=w=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],E=a.AES=i.extend({_doReset:function(){var b;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var k=this._keyPriorReset=this._key,P=k.words,w=k.sigBytes/4,x=this._nRounds=w+6,S=(x+1)*4,_=this._keySchedule=[],A=0;A<S;A++)A<w?_[A]=P[A]:(b=_[A-1],A%w?w>6&&A%w==4&&(b=o[b>>>24]<<24|o[b>>>16&255]<<16|o[b>>>8&255]<<8|o[b&255]):(b=b<<8|b>>>24,b=o[b>>>24]<<24|o[b>>>16&255]<<16|o[b>>>8&255]<<8|o[b&255],b^=y[A/w|0]<<24),_[A]=_[A-w]^b);for(var C=this._invKeySchedule=[],T=0;T<S;T++){var A=S-T;if(T%4)var b=_[A];else var b=_[A-4];T<4||A<=4?C[T]=b:C[T]=p[o[b>>>24]]^m[o[b>>>16&255]]^v[o[b>>>8&255]]^g[o[b&255]]}}},encryptBlock:function(b,k){this._doCryptBlock(b,k,this._keySchedule,c,u,f,h,o)},decryptBlock:function(b,k){var P=b[k+1];b[k+1]=b[k+3],b[k+3]=P,this._doCryptBlock(b,k,this._invKeySchedule,p,m,v,g,l);var P=b[k+1];b[k+1]=b[k+3],b[k+3]=P},_doCryptBlock:function(b,k,P,w,x,S,_,A){for(var C=this._nRounds,T=b[k]^P[0],D=b[k+1]^P[1],V=b[k+2]^P[2],B=b[k+3]^P[3],R=4,F=1;F<C;F++){var M=w[T>>>24]^x[D>>>16&255]^S[V>>>8&255]^_[B&255]^P[R++],O=w[D>>>24]^x[V>>>16&255]^S[B>>>8&255]^_[T&255]^P[R++],K=w[V>>>24]^x[B>>>16&255]^S[T>>>8&255]^_[D&255]^P[R++],j=w[B>>>24]^x[T>>>16&255]^S[D>>>8&255]^_[V&255]^P[R++];T=M,D=O,V=K,B=j}var M=(A[T>>>24]<<24|A[D>>>16&255]<<16|A[V>>>8&255]<<8|A[B&255])^P[R++],O=(A[D>>>24]<<24|A[V>>>16&255]<<16|A[B>>>8&255]<<8|A[T&255])^P[R++],K=(A[V>>>24]<<24|A[B>>>16&255]<<16|A[T>>>8&255]<<8|A[D&255])^P[R++],j=(A[B>>>24]<<24|A[T>>>16&255]<<16|A[D>>>8&255]<<8|A[V&255])^P[R++];b[k]=M,b[k+1]=O,b[k+2]=K,b[k+3]=j},keySize:256/32});n.AES=i._createHelper(E)}(),r.AES})}(Xm)),Xm.exports}var Ym={exports:{}},rS;function z7(){return rS||(rS=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),hl(),pl(),yo(),xn())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.BlockCipher,o=n.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=o.DES=a.extend({_doReset:function(){for(var y=this._key,E=y.words,b=[],k=0;k<56;k++){var P=l[k]-1;b[k]=E[P>>>5]>>>31-P%32&1}for(var w=this._subKeys=[],x=0;x<16;x++){for(var S=w[x]=[],_=u[x],k=0;k<24;k++)S[k/6|0]|=b[(c[k]-1+_)%28]<<31-k%6,S[4+(k/6|0)]|=b[28+(c[k+24]-1+_)%28]<<31-k%6;S[0]=S[0]<<1|S[0]>>>31;for(var k=1;k<7;k++)S[k]=S[k]>>>(k-1)*4+3;S[7]=S[7]<<5|S[7]>>>27}for(var A=this._invSubKeys=[],k=0;k<16;k++)A[k]=w[15-k]},encryptBlock:function(y,E){this._doCryptBlock(y,E,this._subKeys)},decryptBlock:function(y,E){this._doCryptBlock(y,E,this._invSubKeys)},_doCryptBlock:function(y,E,b){this._lBlock=y[E],this._rBlock=y[E+1],m.call(this,4,252645135),m.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),m.call(this,1,1431655765);for(var k=0;k<16;k++){for(var P=b[k],w=this._lBlock,x=this._rBlock,S=0,_=0;_<8;_++)S|=f[_][((x^P[_])&h[_])>>>0];this._lBlock=x,this._rBlock=w^S}var A=this._lBlock;this._lBlock=this._rBlock,this._rBlock=A,m.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),m.call(this,16,65535),m.call(this,4,252645135),y[E]=this._lBlock,y[E+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function m(y,E){var b=(this._lBlock>>>y^this._rBlock)&E;this._rBlock^=b,this._lBlock^=b<<y}function v(y,E){var b=(this._rBlock>>>y^this._lBlock)&E;this._lBlock^=b,this._rBlock^=b<<y}n.DES=a._createHelper(p);var g=o.TripleDES=a.extend({_doReset:function(){var y=this._key,E=y.words;if(E.length!==2&&E.length!==4&&E.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var b=E.slice(0,2),k=E.length<4?E.slice(0,2):E.slice(2,4),P=E.length<6?E.slice(0,2):E.slice(4,6);this._des1=p.createEncryptor(i.create(b)),this._des2=p.createEncryptor(i.create(k)),this._des3=p.createEncryptor(i.create(P))},encryptBlock:function(y,E){this._des1.encryptBlock(y,E),this._des2.decryptBlock(y,E),this._des3.encryptBlock(y,E)},decryptBlock:function(y,E){this._des3.decryptBlock(y,E),this._des2.encryptBlock(y,E),this._des1.decryptBlock(y,E)},keySize:192/32,ivSize:64/32,blockSize:64/32});n.TripleDES=a._createHelper(g)}(),r.TripleDES})}(Ym)),Ym.exports}var Qm={exports:{}},nS;function K7(){return nS||(nS=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),hl(),pl(),yo(),xn())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=a.RC4=i.extend({_doReset:function(){for(var u=this._key,f=u.words,h=u.sigBytes,p=this._S=[],m=0;m<256;m++)p[m]=m;for(var m=0,v=0;m<256;m++){var g=m%h,y=f[g>>>2]>>>24-g%4*8&255;v=(v+p[m]+y)%256;var E=p[m];p[m]=p[v],p[v]=E}this._i=this._j=0},_doProcessBlock:function(u,f){u[f]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,f=this._i,h=this._j,p=0,m=0;m<4;m++){f=(f+1)%256,h=(h+u[f])%256;var v=u[f];u[f]=u[h],u[h]=v,p|=u[(u[f]+u[h])%256]<<24-m*8}return this._i=f,this._j=h,p}n.RC4=i._createHelper(o);var c=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});n.RC4Drop=i._createHelper(c)}(),r.RC4})}(Qm)),Qm.exports}var Jm={exports:{}},sS;function q7(){return sS||(sS=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),hl(),pl(),yo(),xn())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.Rabbit=i.extend({_doReset:function(){for(var h=this._key.words,p=this.cfg.iv,m=0;m<4;m++)h[m]=(h[m]<<8|h[m]>>>24)&16711935|(h[m]<<24|h[m]>>>8)&4278255360;var v=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],g=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var m=0;m<4;m++)f.call(this);for(var m=0;m<8;m++)g[m]^=v[m+4&7];if(p){var y=p.words,E=y[0],b=y[1],k=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,P=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,w=k>>>16|P&4294901760,x=P<<16|k&65535;g[0]^=k,g[1]^=w,g[2]^=P,g[3]^=x,g[4]^=k,g[5]^=w,g[6]^=P,g[7]^=x;for(var m=0;m<4;m++)f.call(this)}},_doProcessBlock:function(h,p){var m=this._X;f.call(this),o[0]=m[0]^m[5]>>>16^m[3]<<16,o[1]=m[2]^m[7]>>>16^m[5]<<16,o[2]=m[4]^m[1]>>>16^m[7]<<16,o[3]=m[6]^m[3]>>>16^m[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,h[p+v]^=o[v]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,m=0;m<8;m++)l[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var m=0;m<8;m++){var v=h[m]+p[m],g=v&65535,y=v>>>16,E=((g*g>>>17)+g*y>>>15)+y*y,b=((v&4294901760)*v|0)+((v&65535)*v|0);c[m]=E^b}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.Rabbit=i._createHelper(u)}(),r.Rabbit})}(Jm)),Jm.exports}var Zm={exports:{}},aS;function X7(){return aS||(aS=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),hl(),pl(),yo(),xn())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.RabbitLegacy=i.extend({_doReset:function(){var h=this._key.words,p=this.cfg.iv,m=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],v=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var g=0;g<4;g++)f.call(this);for(var g=0;g<8;g++)v[g]^=m[g+4&7];if(p){var y=p.words,E=y[0],b=y[1],k=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,P=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,w=k>>>16|P&4294901760,x=P<<16|k&65535;v[0]^=k,v[1]^=w,v[2]^=P,v[3]^=x,v[4]^=k,v[5]^=w,v[6]^=P,v[7]^=x;for(var g=0;g<4;g++)f.call(this)}},_doProcessBlock:function(h,p){var m=this._X;f.call(this),o[0]=m[0]^m[5]>>>16^m[3]<<16,o[1]=m[2]^m[7]>>>16^m[5]<<16,o[2]=m[4]^m[1]>>>16^m[7]<<16,o[3]=m[6]^m[3]>>>16^m[1]<<16;for(var v=0;v<4;v++)o[v]=(o[v]<<8|o[v]>>>24)&16711935|(o[v]<<24|o[v]>>>8)&4278255360,h[p+v]^=o[v]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,m=0;m<8;m++)l[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var m=0;m<8;m++){var v=h[m]+p[m],g=v&65535,y=v>>>16,E=((g*g>>>17)+g*y>>>15)+y*y,b=((v&4294901760)*v|0)+((v&65535)*v|0);c[m]=E^b}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.RabbitLegacy=i._createHelper(u)}(),r.RabbitLegacy})}(Zm)),Zm.exports}var eg={exports:{}},iS;function Y7(){return iS||(iS=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),hl(),pl(),yo(),xn())})(Bt,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo;const o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function f(g,y){let E=y>>24&255,b=y>>16&255,k=y>>8&255,P=y&255,w=g.sbox[0][E]+g.sbox[1][b];return w=w^g.sbox[2][k],w=w+g.sbox[3][P],w}function h(g,y,E){let b=y,k=E,P;for(let w=0;w<o;++w)b=b^g.pbox[w],k=f(g,b)^k,P=b,b=k,k=P;return P=b,b=k,k=P,k=k^g.pbox[o],b=b^g.pbox[o+1],{left:b,right:k}}function p(g,y,E){let b=y,k=E,P;for(let w=o+1;w>1;--w)b=b^g.pbox[w],k=f(g,b)^k,P=b,b=k,k=P;return P=b,b=k,k=P,k=k^g.pbox[1],b=b^g.pbox[0],{left:b,right:k}}function m(g,y,E){for(let x=0;x<4;x++){g.sbox[x]=[];for(let S=0;S<256;S++)g.sbox[x][S]=c[x][S]}let b=0;for(let x=0;x<o+2;x++)g.pbox[x]=l[x]^y[b],b++,b>=E&&(b=0);let k=0,P=0,w=0;for(let x=0;x<o+2;x+=2)w=h(g,k,P),k=w.left,P=w.right,g.pbox[x]=k,g.pbox[x+1]=P;for(let x=0;x<4;x++)for(let S=0;S<256;S+=2)w=h(g,k,P),k=w.left,P=w.right,g.sbox[x][S]=k,g.sbox[x][S+1]=P;return!0}var v=a.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var g=this._keyPriorReset=this._key,y=g.words,E=g.sigBytes/4;m(u,y,E)}},encryptBlock:function(g,y){var E=h(u,g[y],g[y+1]);g[y]=E.left,g[y+1]=E.right},decryptBlock:function(g,y){var E=p(u,g[y],g[y+1]);g[y]=E.left,g[y+1]=E.right},blockSize:64/32,keySize:128/32,ivSize:64/32});n.Blowfish=i._createHelper(v)}(),r.Blowfish})}(eg)),eg.exports}(function(t,e){(function(r,n,s){t.exports=n(Zt(),Rp(),w7(),C7(),hl(),I7(),pl(),z4(),Ox(),k7(),K4(),D7(),P7(),R7(),Mx(),F7(),yo(),xn(),N7(),O7(),M7(),L7(),B7(),U7(),$7(),V7(),H7(),j7(),G7(),W7(),z7(),K7(),q7(),X7(),Y7())})(Bt,function(r){return r})})(W4);var Q7=W4.exports;const zi=G4(Q7);class J7{constructor(){this.encryptionKey="your-dev-key-here"}async encryptAndUploadPdf(e,r){try{if(console.log("🔒 Starting PDF encryption for student:",r),console.log("📁 File details:",{name:e.name,size:e.size,type:e.type}),(!this.encryptionKey||this.encryptionKey==="your-dev-key-here")&&console.warn("⚠️ Using default encryption key - set VITE_PDF_ENCRYPTION_KEY in production"),!St.currentUser)throw new Error("User not authenticated");if(console.log("👤 Current user:",St.currentUser.uid),r){console.log("🔍 Checking student access for:",r);try{if(!(await Jt(Ze(ze,"students",r))).exists())throw new Error(`Student ${r} not found`);console.log("✅ Student document exists")}catch(l){throw console.error("❌ Student access check failed:",l),new Error(`Student access check failed: ${l.message}`)}}console.log("📖 Reading file as ArrayBuffer...");const n=await e.arrayBuffer();console.log("✅ ArrayBuffer read, size:",n.byteLength),console.log("🔄 Converting to Base64...");const s=btoa(new Uint8Array(n).reduce((l,c)=>l+String.fromCharCode(c),""));console.log("✅ Base64 conversion complete, length:",s.length),console.log("🔐 Encrypting content...");const i=zi.AES.encrypt(s,this.encryptionKey).toString();console.log("✅ Encryption complete, length:",i.length);const a=`${_7()}.enc`;console.log("📝 Generated filename:",a),console.log("📤 Uploading to storage...");const o=fh(Tc,`students/${r}/${a}`);return console.log("📍 Storage path:",`students/${r}/${a}`),await g4(o,i),console.log("✅ Upload to storage successful"),console.log("💾 Storing metadata in Firestore..."),await Ht(Ze(ze,"pdfMetadata",a),{originalName:e.name,studentId:r,uploadedBy:St.currentUser.uid,uploadedAt:Wn(),accessCount:0,lastAccessed:null,encryptionVersion:"1.0",fileSize:e.size,mimeType:e.type}),console.log("✅ Metadata stored successfully"),a}catch(n){throw console.error("❌ PDF encryption failed:",n),console.error("❌ Error details:",{message:n.message,code:n.code,stack:n.stack}),new Error(`Failed to securely store PDF: ${n.message}`)}}async downloadAndDecryptPdf(e,r){try{if(!await this.verifyAccess(r))throw new Error("Access denied");const{auth:s}=await aa(async()=>{const{auth:h}=await Promise.resolve().then(()=>T4);return{auth:h}},void 0),i=await s.currentUser.getIdToken(),a=`https://downloadstudentfile-zr6j2ycwuq-uc.a.run.app/downloadStudentFile?studentId=${r}&fileName=${e}`;console.log("🔗 Using proxy URL for secure download");const o=await fetch(a,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error(`Failed to fetch file: ${o.status} ${o.statusText}`);const l=await o.text();console.log("✅ Downloaded encrypted content via proxy");const c=zi.AES.decrypt(l,this.encryptionKey).toString(zi.enc.Utf8),u=atob(c),f=new Blob([new Uint8Array(u.split("").map(h=>h.charCodeAt(0)))],{type:"application/pdf"});return console.log("✅ PDF decrypted and blob created"),f}catch(n){throw console.error("PDF decryption failed:",n),new Error("Failed to retrieve PDF")}}async verifyAccess(e){var r,n,s,i,a,o;try{const l=St.currentUser;if(!l)return!1;const u=(await Jt(Ze(ze,"users",l.uid))).data();if(["admin","administrator","sped_chair"].includes(u.role))return!0;if(u.role==="case_manager")return((s=(n=(r=(await Jt(Ze(ze,"students",e))).data())==null?void 0:r.app)==null?void 0:n.studentData)==null?void 0:s.caseManagerId)===l.uid;if(u.role==="teacher"){const h=((o=(a=(i=(await Jt(Ze(ze,"students",e))).data())==null?void 0:i.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(h).includes(l.uid)}return!1}catch(l){return console.error("Access verification failed:",l),!1}}async logAccess(e,r){try{await Ht(Ze(ze,"pdfAccessLogs",`${e}_${Date.now()}`),{fileId:e,studentId:r,userId:St.currentUser.uid,userEmail:St.currentUser.email,accessTime:Wn(),userAgent:navigator.userAgent,accessType:"download"})}catch(n){console.error("Failed to log access:",n)}}async updateAccessMetadata(e){try{const r=Ze(ze,"pdfMetadata",e),n=await Jt(r);n.exists()&&await Ht(r,{...n.data(),accessCount:(n.data().accessCount||0)+1,lastAccessed:Wn()},{merge:!0})}catch(r){console.error("Failed to update access metadata:",r)}}async getFileAccessHistory(e){try{const r=nr(bt(ze,"pdfAccessLogs"),Rr("fileId","==",e),Gr("accessTime","desc"));return(await $t(r)).docs.map(s=>s.data())}catch(r){return console.error("Failed to fetch access history:",r),[]}}}const T0=new J7;function Lx(){const t=se(!1),e=se(!1),r=se(null);return{uploadPdf:async(a,o)=>{t.value=!0,r.value=null;try{if(a.type!=="application/pdf")throw new Error("Only PDF files are allowed");if(a.size>10*1024*1024)throw new Error("File size must be less than 10MB");return await T0.encryptAndUploadPdf(a,o)}catch(l){throw r.value=l.message,l}finally{t.value=!1}},downloadPdf:async(a,o,l)=>{e.value=!0,r.value=null;try{const c=await T0.downloadAndDecryptPdf(a,o),u=window.URL.createObjectURL(c),f=window.open(u,"_blank","noopener,noreferrer");setTimeout(()=>{window.URL.revokeObjectURL(u)},5e3)}catch(c){throw r.value=c.message,c}finally{e.value=!1}},getAccessHistory:async a=>{try{return await T0.getFileAccessHistory(a)}catch(o){return r.value=o.message,[]}},isUploading:t,isDownloading:e,error:r}}const Z7={class:"docs-item"},eU={__name:"StudentDocsCell",props:{student:{type:Object,required:!0},getDocumentUrl:{type:Function,required:!0}},setup(t){const e=t,{downloadPdf:r}=Lx(),n=async s=>{var i,a,o,l;try{if(!s){alert("File not found.");return}const c=((a=(i=e.student.app)==null?void 0:i.documents)==null?void 0:a.bipFileName)||((l=(o=e.student.app)==null?void 0:o.documents)==null?void 0:l.ataglanceFileName)||"document.pdf";await r(s,e.student.id,c)}catch(c){console.error("Error opening secure file:",c),alert("Error opening file. Please try again.")}};return(s,i)=>(N(),L("td",null,[d("div",Z7,[t.getDocumentUrl(t.student,"ataglancePdfUrl")?(N(),L("a",{key:0,href:"#",onClick:i[0]||(i[0]=dn(a=>n(t.getDocumentUrl(t.student,"ataglancePdfUrl")),["prevent"]))}," At-A-Glance ")):_e("",!0),t.getDocumentUrl(t.student,"bipPdfUrl")?(N(),L("a",{key:1,href:"#",onClick:i[1]||(i[1]=dn(a=>n(t.getDocumentUrl(t.student,"bipPdfUrl")),["prevent"]))}," BIP ")):_e("",!0),!t.getDocumentUrl(t.student,"ataglancePdfUrl")&&!t.getDocumentUrl(t.student,"bipPdfUrl")?(N(),L(Re,{key:2},[Ne("—")],64)):_e("",!0)])]))}},tU={class:"action-buttons"},rU=["title"],nU={__name:"StudentActionsCell",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!1},studentData:{type:Object,required:!1}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,n=Se(()=>{var c,u,f;if(!((c=r.currentUser)!=null&&c.role)||!r.student)return!1;const a=r.currentUser.role,o=r.currentUser.uid;return a==="paraeducator"||a==="teacher"?!1:a==="case_manager"?((f=(u=r.student.app)==null?void 0:u.studentData)==null?void 0:f.caseManagerId)===o:["admin","school_admin","staff_edit","admin_504","sped_chair","service_provider","administrator","administrator_504_CM"].includes(a)}),s=Se(()=>{var a;return!((a=r.currentUser)!=null&&a.role)||!r.student||!r.studentData?!1:Mn.canSendFeedback(r.currentUser.uid,r.currentUser.role,r.student,r.studentData)});function i(a,o=!1){if(!(a!=null&&a.seconds))return"";const l=new Date(a.seconds*1e3);return o?l.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}):l.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})+" at "+l.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0,timeZoneName:"short"})}return(a,o)=>{var l,c;return N(),L("td",null,[d("div",tU,[n.value?(N(),L("button",{key:0,class:"edit-btn",onClick:o[0]||(o[0]=u=>a.$emit("edit",t.student.id)),title:"Edit Student"},"✏️")):_e("",!0),d("button",{class:"email-btn",onClick:o[1]||(o[1]=u=>a.$emit("email",t.student.id)),title:"Email Student"},"✉️"),s.value?(N(),L("button",{key:1,class:"teacher-feedback-btn",onClick:o[2]||(o[2]=u=>a.$emit("teacher-feedback",t.student.id)),title:"Send Teacher Feedback Form"},"📝")):_e("",!0)]),(c=(l=t.student)==null?void 0:l.updatedAt)!=null&&c.seconds?(N(),L("div",{key:0,class:"updated-date",title:"Last Updated: "+i(t.student.updatedAt)},J(i(t.student.updatedAt,!0)),9,rU)):_e("",!0)])}}},sU=yt(nU,[["__scopeId","data-v-3a28c19b"]]),aU={key:0,class:"schedule-list"},iU={class:"period-assignment"},oU={class:"primary-line"},lU={class:"period-label"},cU={class:"primary-teacher"},uU={key:0,class:"coteaching-info"},dU=["title"],fU={key:1,class:"no-schedule"},hU={__name:"StudentScheduleCell",props:{student:{type:Object,required:!0},getSchedule:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0}},setup(t){const e=r=>r&&typeof r=="object"&&r.coTeaching&&r.teacherId;return(r,n)=>(N(),L("td",null,[t.getSchedule(t.student)?(N(),L("div",aU,[d("ul",null,[(N(!0),L(Re,null,Ve(t.getSchedule(t.student),(s,i)=>(N(),L("li",{key:i,class:"schedule-period"},[d("div",iU,[d("div",oU,[d("span",lU,J(i)+":",1),d("span",cU,J(t.getUserInitialLastName(s.teacherId||s)),1)]),e(s)?(N(),L("div",uU,[d("span",{class:"coteaching-indicator",title:`Co-teach ${s.coTeaching.subject}`},J(t.getUserInitialLastName(s.coTeaching.caseManagerId))+" (C"+J(s.coTeaching.subject.charAt(0))+") ",9,dU)])):_e("",!0)])]))),128))])])):(N(),L("div",fU,"—"))]))}},pU={key:0,class:"services-section"},mU={class:"services-container"},gU={key:1,class:"services-section"},vU={class:"services-container"},xU={key:0,class:"service-provider-item"},yU={key:0,class:"service-provider-item"},EU={key:1,class:"service-provider-item"},_U={key:2,class:"service-provider-item"},bU={key:3,class:"service-provider-item"},SU={key:4,class:"service-provider-item"},AU={key:5,class:"service-provider-item"},TU={__name:"StudentServicesCell",props:{student:{type:Object,required:!0},appSettings:{type:Object,required:!1},getClassServices:{type:Function,required:!0},getOtherServices:{type:Function,required:!0},hasServiceProviders:{type:Function,required:!0},getServiceProviderId:{type:Function,required:!0},getProviderFieldName:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0}},setup(t){return(e,r)=>(N(),L("td",null,[t.getClassServices(t.student).length>0||t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(N(),L(Re,{key:0},[t.getClassServices(t.student).length>0?(N(),L("div",pU,[r[0]||(r[0]=d("strong",null,"Class Services:",-1)),d("div",mU,[(N(!0),L(Re,null,Ve(t.getClassServices(t.student),n=>(N(),L("span",{key:n,class:"service-item"},J(n),1))),128))])])):_e("",!0),t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(N(),L("div",gU,[r[1]||(r[1]=d("strong",null,"Related Services:",-1)),d("div",vU,[(N(!0),L(Re,null,Ve(t.getOtherServices(t.student),n=>(N(),L("span",{key:n,class:"service-item"},J(n),1))),128)),t.appSettings&&t.appSettings.value&&t.appSettings.value.serviceProviders?(N(!0),L(Re,{key:0},Ve(t.appSettings.value.serviceProviders,n=>(N(),L(Re,{key:n},[t.getServiceProviderId(t.student,t.getProviderFieldName(n))?(N(),L("span",xU,J(n)+" ("+J(t.getUserInitialLastName(t.getServiceProviderId(t.student,t.getProviderFieldName(n))))+") ",1)):_e("",!0)],64))),128)):(N(),L(Re,{key:1},[t.getServiceProviderId(t.student,"speechId")?(N(),L("span",yU,"SP ("+J(t.getUserInitialLastName(t.getServiceProviderId(t.student,"speechId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"mhId")?(N(),L("span",EU,"MH ("+J(t.getUserInitialLastName(t.getServiceProviderId(t.student,"mhId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"otId")?(N(),L("span",_U,"OT ("+J(t.getUserInitialLastName(t.getServiceProviderId(t.student,"otId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"ptId")?(N(),L("span",bU,"PT ("+J(t.getUserInitialLastName(t.getServiceProviderId(t.student,"ptId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"scId")?(N(),L("span",SU,"SC ("+J(t.getUserInitialLastName(t.getServiceProviderId(t.student,"scId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"trId")?(N(),L("span",AU,"TR ("+J(t.getUserInitialLastName(t.getServiceProviderId(t.student,"trId")))+")",1)):_e("",!0)],64))])])):_e("",!0)],64)):(N(),L(Re,{key:1},[Ne(" — ")],64))]))}},wU={key:1,class:"pill-list"},CU=["innerHTML"],IU={key:2},oS={__name:"AccommodationsCell",props:{student:{type:Object,required:!0},fieldName:{type:String,required:!0},flagType:{type:String,required:!0},flagText:{type:String,required:!0},flagClass:{type:String,required:!0},getFlagValue:{type:Function,required:!0},formatListFromText:{type:Function,required:!0}},setup(t){return(e,r)=>(N(),L("td",{class:Qe(["instruction-cell",{"with-flag":t.getFlagValue(t.student,t.flagType)}])},[t.getFlagValue(t.student,t.flagType)?(N(),L("div",{key:0,class:Qe(["flag-overlay",t.flagClass])},J(t.flagText),3)):_e("",!0),ee(ot)(t.student,t.fieldName)?(N(),L("div",wU,[d("div",{innerHTML:t.formatListFromText(ee(ot)(t.student,t.fieldName))},null,8,CU)])):(N(),L("div",IU,"—"))],2))}},kU={class:"student-name"},DU={class:"std-info-subheading"},PU={key:0,class:"schedule-list"},RU={class:"period-assignment"},FU={class:"primary-line"},NU={class:"period-label"},OU={class:"primary-teacher"},MU={key:0,class:"coteaching-info"},LU=["title"],BU={key:1,class:"no-schedule"},UU={key:0,class:"flag-overlay flag-separate-setting"},$U={key:1,class:"bullet-list"},VU=["innerHTML"],HU={key:2},jU={class:"student-name"},GU=["title"],WU={class:"std-info-subheading"},zU={class:"student-dates print"},KU={key:0,class:"direct-assignment-badge"},Hf={__name:"StudentTable",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})},currentUser:{type:Object,default:null},studentData:{type:Object,default:null},testingView:{type:Boolean,default:!1},aideSchedule:{type:Object,default:()=>({})}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,{appSettings:n,getUserName:s,getUserInitialLastName:i,formatDate:a,getMeetingUrgencyClass:o,getReviewUrgencyClass:l,getReevalUrgencyClass:c,getCaseManagerId:u,getFlagValue:f,getDocumentUrl:h,getSchedule:p,getClassServices:m,getOtherServices:v,hasServiceProviders:g,getServiceProviderId:y,getProviderFieldName:E,isDirectAssignment:b,formatListFromText:k}=g7(r),P=w=>w&&typeof w=="object"&&w.coTeaching&&w.teacherId;return Vt(()=>r.student,w=>{var x,S,_,A,C,T,D;w&&Object.keys(w).length>0&&(form.schedule=((S=(x=w.app)==null?void 0:x.schedule)==null?void 0:S.periods)||w.schedule||((A=(_=w.aeries)==null?void 0:_.schedule)==null?void 0:A.periods)||{},console.log("StudentForm DEBUG - form.schedule:",form.schedule),console.log("StudentForm DEBUG - aeries.schedule:",(C=r.student.aeries)==null?void 0:C.schedule),console.log("StudentForm DEBUG - app.schedule.periods:",(D=(T=r.student.app)==null?void 0:T.schedule)==null?void 0:D.periods))},{immediate:!0,deep:!0}),(w,x)=>(N(),L("table",{class:Qe(["students-table",{"testing-view":t.testingView}])},[d("thead",null,[d("tr",null,[t.testingView?(N(),L(Re,{key:0},[x[0]||(x[0]=d("th",{class:"print"},"Student Info",-1)),x[1]||(x[1]=d("th",{class:"print"},"Schedule",-1)),x[2]||(x[2]=d("th",{class:"print"},"Assessment Accom.",-1))],64)):(N(),L(Re,{key:1},[x[3]||(x[3]=d("th",{class:"print"},"Student Info",-1)),x[4]||(x[4]=d("th",{class:"print"},"Services",-1)),x[5]||(x[5]=d("th",{class:"print"},"Schedule",-1)),x[6]||(x[6]=d("th",{class:"print"},"Instruction Accom.",-1)),x[7]||(x[7]=d("th",{class:"print"},"Assessment Accom.",-1)),x[8]||(x[8]=d("th",{class:"print"},"Docs",-1)),x[9]||(x[9]=d("th",{class:"print"},"Actions",-1))],64))])]),d("tbody",null,[(N(!0),L(Re,null,Ve(t.students,S=>{var _;return N(),L("tr",{key:S.id},[t.testingView?(N(),L(Re,{key:0},[d("td",null,[d("div",kU,[d("strong",null,J(ee(ot)(S,"firstName"))+" "+J(ee(ot)(S,"lastName")),1)]),d("div",DU,[d("div",null,"Grd: "+J(ee(ot)(S,"grade"))+" | Prg: "+J(ee(ot)(S,"plan")),1),d("div",null,"CM: "+J(ee(s)(ee(u)(S))),1)])]),d("td",null,[ee(p)(S)?(N(),L("div",PU,[d("ul",null,[(N(!0),L(Re,null,Ve(ee(p)(S),(A,C)=>(N(),L("li",{key:C,class:"schedule-period"},[d("div",RU,[d("div",FU,[d("span",NU,J(C)+":",1),d("span",OU,J(ee(i)(A.teacherId||A)),1)]),P(A)?(N(),L("div",MU,[d("span",{class:"coteaching-indicator",title:`Co-teach ${A.coTeaching.subject}`},J(ee(i)(A.coTeaching.caseManagerId))+" (C"+J(A.coTeaching.subject.charAt(0))+") ",9,LU)])):_e("",!0)])]))),128))])])):(N(),L("div",BU,"—"))]),d("td",{class:Qe(["instruction-cell",{"with-flag":ee(f)(S,"flag2")}])},[ee(f)(S,"flag2")?(N(),L("div",UU,"Separate setting")):_e("",!0),ee(ot)(S,"assessment")?(N(),L("div",$U,[d("div",{innerHTML:ee(k)(ee(ot)(S,"assessment"))},null,8,VU)])):(N(),L("div",HU,"—"))],2)],64)):(N(),L(Re,{key:1},[d("td",null,[d("div",jU,[d("strong",null,J(ee(ot)(S,"firstName"))+" "+J(ee(ot)(S,"lastName")),1),d("span",{class:"data-source",title:`Data source: ${ee(ou)(S,"firstName")}`},J(ee(ou)(S,"firstName")==="Override"?"🔒":ee(ou)(S,"firstName")==="App"?"📱":ee(ou)(S,"firstName")==="Aeries"?"📊":ee(ou)(S,"firstName")==="SEIS"?"📋":""),9,GU)]),d("div",WU,[d("div",null,"Grd: "+J(ee(ot)(S,"grade"))+" | Prg: "+J(ee(ot)(S,"plan")),1),d("div",null,"CM: "+J(ee(s)(ee(u)(S))),1)]),d("div",zU,[d("span",{class:Qe(["badge badge-review plan-review",ee(l)(S)])},"PR: "+J(ee(a)(ee(ot)(S,"reviewDate"))),3),d("span",{class:Qe(["badge badge-reeval reeval-due",ee(c)(S)])},"RE: "+J(ee(a)(ee(ot)(S,"reevalDate"))),3),d("span",{class:Qe(["badge badge-meeting meeting-date",[ee(o)(S),ee(ot)(S,"meetingDate")?"date-set":""]])}," 🗓 "+J(ee(a)(ee(ot)(S,"meetingDate"))||"Not set"),3)]),((_=t.currentUser)==null?void 0:_.role)==="paraeducator"&&ee(b)(S.id)?(N(),L("div",KU,x[10]||(x[10]=[d("span",{class:"badge badge-direct"},"Direct Assignment",-1)]))):_e("",!0)]),nt(TU,{student:S,"app-settings":ee(n),"get-class-services":ee(m),"get-other-services":ee(v),"has-service-providers":ee(g),"get-service-provider-id":ee(y),"get-provider-field-name":ee(E),"get-user-initial-last-name":ee(i)},null,8,["student","app-settings","get-class-services","get-other-services","has-service-providers","get-service-provider-id","get-provider-field-name","get-user-initial-last-name"]),nt(hU,{student:S,"get-schedule":ee(p),"get-user-initial-last-name":ee(i)},null,8,["student","get-schedule","get-user-initial-last-name"]),nt(oS,{student:S,"field-name":"instruction","flag-type":"flag1","flag-text":"Preferential Seating","flag-class":"flag-preferential-seating","get-flag-value":ee(f),"format-list-from-text":ee(k)},null,8,["student","get-flag-value","format-list-from-text"]),nt(oS,{student:S,"field-name":"assessment","flag-type":"flag2","flag-text":"Separate Setting","flag-class":"flag-separate-setting","get-flag-value":ee(f),"format-list-from-text":ee(k)},null,8,["student","get-flag-value","format-list-from-text"]),nt(eU,{student:S,"get-document-url":ee(h)},null,8,["student","get-document-url"]),nt(sU,{student:S,"current-user":t.currentUser,"student-data":t.studentData,onEdit:A=>w.$emit("edit",S.id),onEmail:A=>w.$emit("email",S.id),onTeacherFeedback:A=>w.$emit("teacher-feedback",S.id)},null,8,["student","current-user","student-data","onEdit","onEmail","onTeacherFeedback"])],64))])}),128))])],2))}};function qU(t,e){const{appSettings:r,loadAppSettings:n,loading:s,error:i}=zs(),a=se(!1);Ut(async()=>{try{console.log("useStudentForm: Starting to load app settings..."),await n(),console.log("useStudentForm: App settings loaded successfully:",r.value)}catch(A){console.error("useStudentForm: Error loading app settings:",A)}});const o=Se(()=>{var C;const A=((C=r.value)==null?void 0:C.numPeriods)||7;return Array.from({length:A},(T,D)=>D+1)}),l=Se(()=>{var A;return(A=r.value)!=null&&A.grades&&r.value.grades.length>0?(console.log("useStudentForm: Using app settings grades:",r.value.grades),r.value.grades):(console.log("useStudentForm: Using fallback grades: [7, 8]"),["7","8"])}),c=Se(()=>{var A;if((A=r.value)!=null&&A.classServices&&r.value.classServices.length>0){const C=r.value.classServices.filter(T=>T.enabledSubcategories&&T.enabledSubcategories.length>0);return console.log("useStudentForm: Available class services:",C.length,"services"),C}return console.log("useStudentForm: No class services available"),[]}),u=Se(()=>{var A;return(A=r.value)!=null&&A.serviceProviders&&r.value.serviceProviders.length>0?(console.log("useStudentForm: Using app settings service providers:",r.value.serviceProviders.length,"providers"),r.value.serviceProviders):(console.log("useStudentForm: No service providers configured in app settings"),[])}),f=Se(()=>{var A;return(A=r.value)!=null&&A.customServiceProviders?r.value.customServiceProviders:[]}),h=Se(()=>{let A=t.users.userRoles?t.users.userRoles:{teachers:t.users.teachers||[],caseManagers:t.users.caseManagers||[],speech:t.users.speech||[],ot:t.users.ot||[],mh:t.users.mh||[]};return A.teachers&&(A={...A,teachers:A.teachers.map(C=>({...C,id:String(C.id)}))}),A}),p=A=>{var C,T,D,V,B,R,F,M,O,K,j,H,W,X,re,he,ue,pe,q,G,oe,Q,Y,Z,ne,ge,ae,ce,fe,Ae,Ie,Te,Ge,ke,$e,Be,We,Ke,Ee,ye,be,Oe,je,lt,gt,Et;return{ssid:ot(A,"ssid")||A.id||"",firstName:ot(A,"firstName")||"",lastName:ot(A,"lastName")||"",grade:ot(A,"grade")||"7",plan:ot(A,"plan")||"IEP",reviewDate:ot(A,"reviewDate")||"",reevalDate:ot(A,"reevalDate")||"",meetingDate:ot(A,"meetingDate")||"",caseManagerId:ot(A,"caseManagerId")||A.caseManagerId||A.casemanager_id||"",schedule:((T=(C=A.app)==null?void 0:C.schedule)==null?void 0:T.periods)||((V=(D=A.aeries)==null?void 0:D.schedule)==null?void 0:V.periods)||A.schedule||{},services:((R=(B=A.app)==null?void 0:B.schedule)==null?void 0:R.classServices)||A.services||[],speechId:((M=(F=A.app)==null?void 0:F.providers)==null?void 0:M.speechId)||A.speechId||A.speech_id||"",otId:((K=(O=A.app)==null?void 0:O.providers)==null?void 0:K.otId)||A.otId||A.ot_id||"",mhId:((H=(j=A.app)==null?void 0:j.providers)==null?void 0:H.mhId)||A.mhId||A.mh_id||"",ptId:((X=(W=A.app)==null?void 0:W.providers)==null?void 0:X.ptId)||A.ptId||A.pt_id||"",scId:((he=(re=A.app)==null?void 0:re.providers)==null?void 0:he.scId)||A.scId||A.sc_id||"",trId:((pe=(ue=A.app)==null?void 0:ue.providers)==null?void 0:pe.trId)||A.trId||A.tr_id||"",audId:((G=(q=A.app)==null?void 0:q.providers)==null?void 0:G.audId)||A.audId||A.aud_id||"",viId:((Q=(oe=A.app)==null?void 0:oe.providers)==null?void 0:Q.viId)||A.viId||A.vi_id||"",atId:((Z=(Y=A.app)==null?void 0:Y.providers)==null?void 0:Z.atId)||A.atId||A.at_id||"",dhhId:((ge=(ne=A.app)==null?void 0:ne.providers)==null?void 0:ge.dhhId)||A.dhhId||A.dhh_id||"",omId:((ce=(ae=A.app)==null?void 0:ae.providers)==null?void 0:ce.omId)||A.omId||A.om_id||"",bisId:((Ae=(fe=A.app)==null?void 0:fe.providers)==null?void 0:Ae.bisId)||A.bisId||A.bis_id||"",hnId:((Te=(Ie=A.app)==null?void 0:Ie.providers)==null?void 0:Te.hnId)||A.hnId||A.hn_id||"",swId:((ke=(Ge=A.app)==null?void 0:Ge.providers)==null?void 0:ke.swId)||A.swId||A.sw_id||"",instruction:ot(A,"instruction")||"",assessment:ot(A,"assessment")||"",flag1:((Be=($e=A.app)==null?void 0:$e.flags)==null?void 0:Be.flag1)||A.flag1||!1,flag2:((Ke=(We=A.app)==null?void 0:We.flags)==null?void 0:Ke.flag2)||A.flag2||!1,ataglancePdfUrl:((ye=(Ee=A.app)==null?void 0:Ee.documents)==null?void 0:ye.ataglancePdfUrl)||A.ataglancePdfUrl||A.ataglance_pdf_url||"",bipPdfUrl:((Oe=(be=A.app)==null?void 0:be.documents)==null?void 0:Oe.bipPdfUrl)||A.bipPdfUrl||A.bip_pdf_url||"",ataglanceFileName:((lt=(je=A.app)==null?void 0:je.documents)==null?void 0:lt.ataglanceFileName)||A.ataglanceFileName||"",bipFileName:((Et=(gt=A.app)==null?void 0:gt.documents)==null?void 0:Et.bipFileName)||A.bipFileName||"",bipFile:null,ataglanceFile:null,removeBipFile:!1,removeAtaglanceFile:!1}},m=Rs(p(t.student||{})),v=A=>{const C=[];return A&&typeof A=="object"&&Object.entries(A).forEach(([T,D])=>{if(D&&typeof D=="object"&&D.coTeaching){const V=D.coTeaching.subject;V&&C.push(`Co-teach: ${V}`)}}),C},g=()=>{const A=v(m.schedule),C=m.services.filter(T=>!T.startsWith("Co-teach:"));m.services=[...C,...A]};Vt(()=>m.schedule,()=>{g()},{deep:!0}),Vt(()=>t.student,(A,C)=>{if(A&&Object.keys(A).length>0){const T=!C||Object.keys(C).length===0,D=A.id!==(C==null?void 0:C.id);if(T||D){console.log("🔍 useStudentForm DEBUG - Student data changed, updating form:",A.id),console.log("🔍 useStudentForm DEBUG - Student data:",{firstName:ot(A,"firstName"),lastName:ot(A,"lastName"),plan:ot(A,"plan"),caseManagerId:ot(A,"caseManagerId"),rawStudent:A});const V=p(A);Object.assign(m,V),g(),console.log("🔍 useStudentForm DEBUG - Form updated:",{plan:m.plan,caseManagerId:m.caseManagerId,firstName:m.firstName,lastName:m.lastName})}}},{immediate:!0,deep:!0}),Vt(()=>r.value,A=>{console.log("useStudentForm: App settings watcher triggered:",A),A!=null&&A.grades&&A.grades.length>0&&(A.grades.includes(m.grade)||(m.grade=A.grades[0]||"7"))},{immediate:!0,deep:!0});const y=(A,C)=>{const T=A.target.files[0]||null;if(T){const D=Vc(T,{allowedTypes:["pdf"],maxSize:10485760,fieldName:C==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!D.isValid){alert(D.error),A.target.value="";return}const V=qr(T.name);if(!V.isSafe){alert(`File name contains potentially dangerous content: ${V.threats.join(", ")}`),A.target.value="";return}}m[C]=T},E=A=>{A.preventDefault(),A.stopPropagation(),m.removeBipFile=!0,m.bipFile=null},b=A=>{A.preventDefault(),A.stopPropagation(),m.removeAtaglanceFile=!0,m.ataglanceFile=null},k={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"},P=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],w=A=>{var T;if((T=r.value)!=null&&T.serviceProviders&&Array.isArray(r.value.serviceProviders)){const D=(r.value.serviceProvidersDetails||P).find(V=>V.abbreviation===A);if(D)return D.name+" ("+A+")"}const C=P.find(D=>D.abbreviation===A);return C?C.name+" ("+A+")":A},x=A=>{const T={SLP:"speech",OT:"ot",MH:"mh",PT:"pt",SC:"sc",TR:"tr",AUD:"aud",VI:"vi",AT:"at",DHH:"dhh","O&M":"om",BIS:"bis",HN:"hn",SW:"sw"}[A]||A.toLowerCase();return h.value[T]||[]},S=()=>{const A=V4(m),C={app:{studentData:{firstName:A.firstName,lastName:A.lastName,grade:A.grade,plan:A.plan,caseManagerId:A.caseManagerId}}},T=$4(C,{isNew:t.mode==="new"});if(!T.isValid)return alert(`Please fix the following errors:

${T.errors.join(`
`)}`),!1;const D=["firstName","lastName","instruction","assessment"];for(const V of D)if(m[V]){const B=qr(m[V]);if(!B.isSafe)return alert(`Security threat detected in ${V}: ${B.threats.join(", ")}`),!1}return Object.assign(m,A),!0};return{form:m,isSaving:a,appSettings:r,appSettingsLoading:s,appSettingsError:i,periods:o,gradeOptions:l,availableClassServices:c,serviceProviders:u,customServiceProviders:f,userRoles:h,onFileChange:y,removeBipFile:E,removeAtaglanceFile:b,providerFieldMap:k,getProviderLabel:w,getProviderUsers:x,handleSubmit:async()=>{var A,C,T,D;try{if(a.value){console.log("Form submission already in progress, ignoring duplicate");return}if(console.log("🚀 Form submitted:",{plan:m.plan,caseManagerId:m.caseManagerId,firstName:m.firstName,lastName:m.lastName,mode:t.mode,studentId:(A=t.student)==null?void 0:A.id}),a.value=!0,console.log("🔍 AUTH DEBUG - Current user:",{uid:(C=St.currentUser)==null?void 0:C.uid,email:(T=St.currentUser)==null?void 0:T.email,claims:await((D=St.currentUser)==null?void 0:D.getIdTokenResult())}),!S()){a.value=!1;return}const V=m.services.filter(j=>j&&j.includes(":")),B={};console.log("🔍 FORM SCHEDULE DEBUG - Complete form.schedule:",JSON.stringify(m.schedule,null,2)),console.log("🔍 FORM SCHEDULE DEBUG - periods.value:",o.value),o.value.forEach(j=>{if(console.log(`🔍 FORM SCHEDULE DEBUG - Period ${j} exists:`,!!m.schedule[j],"Value:",m.schedule[j]),m.schedule[j]){const H=m.schedule[j];console.log(`🔍 SCHEDULE DEBUG - Period ${j}:`,{type:typeof H,data:H,hasCoTeaching:!!(H&&H.coTeaching),hasCaseManagerId:!!(H&&H.coTeaching&&H.coTeaching.caseManagerId)}),typeof H=="string"?B[j]=H:typeof H=="object"&&H!==null&&(H.coTeaching&&H.coTeaching.caseManagerId?(console.log(`🔍 SCHEDULE DEBUG - Period ${j} has co-teaching, preserving structure`),B[j]={teacherId:H.teacherId,coTeaching:{caseManagerId:H.coTeaching.caseManagerId,subject:H.coTeaching.subject||""}}):(console.log(`🔍 SCHEDULE DEBUG - Period ${j} converting to simple format`),B[j]=H.teacherId||String(H)||H))}}),console.log("🔍 Schedule Composition Debug:"),console.log("Form schedule before:",JSON.stringify(m.schedule,null,2)),console.log("Composed schedule after:",JSON.stringify(B,null,2)),console.log("Composed data:",{classServices:V,schedule:B});let R=m.bipPdfUrl||null,F=m.ataglancePdfUrl||null;if(console.log("🔍 Form submission - PDF URLs:",{bipPdfUrl:R,ataglancePdfUrl:F,formBipPdfUrl:m.bipPdfUrl,formAtaglancePdfUrl:m.ataglancePdfUrl,bipFileName:m.bipFileName,ataglanceFileName:m.ataglanceFileName,bipFile:m.bipFile,ataglanceFile:m.ataglanceFile}),m.removeBipFile&&(console.log("Removing BIP file..."),R)){try{const j=se(Tc,`students/${t.student.id||"temp"}/${R}`);await bv(j),await deleteDoc(Ze(ze,"pdfMetadata",R)),console.log("Secure BIP file deleted:",R)}catch(j){console.warn("Error deleting secure BIP file:",j)}R=null}if(m.removeAtaglanceFile&&(console.log("Removing At-A-Glance file..."),F)){try{const j=se(Tc,`students/${t.student.id||"temp"}/${F}`);await bv(j),await deleteDoc(Ze(ze,"pdfMetadata",F)),console.log("Secure At-A-Glance file deleted:",F)}catch(j){console.warn("Error deleting secure At-A-Glance file:",j)}F=null}const M={studentData:{firstName:m.firstName,lastName:m.lastName,grade:m.grade,plan:m.plan,caseManagerId:m.caseManagerId},dates:{reviewDate:m.reviewDate,reevalDate:m.reevalDate,meetingDate:m.meetingDate},schedule:{periods:B,classServices:V},providers:{speechId:m.speechId,otId:m.otId,mhId:m.mhId,ptId:m.ptId,scId:m.scId,trId:m.trId,audId:m.audId,viId:m.viId,atId:m.atId,dhhId:m.dhhId,omId:m.omId,bisId:m.bisId,hnId:m.hnId,swId:m.swId},accommodations:{instruction:m.instruction,assessment:m.assessment},flags:{flag1:m.flag1,flag2:m.flag2},documents:{ataglancePdfUrl:F,bipPdfUrl:R,bipFileName:m.bipFileName||null,ataglanceFileName:m.ataglanceFileName||null}};console.log("📋 Documents being saved:",{ataglancePdfUrl:F,bipPdfUrl:R,bipFileName:m.bipFileName||null,ataglanceFileName:m.ataglanceFileName||null}),console.log("Saving payload:",M);const O={app:M,updatedAt:Wn()};console.log("Saving payload:",O);let K=null;if(t.mode==="edit"&&t.student.id)console.log("Updating existing student:",t.student.id),await Ht(Ze(ze,"students",t.student.id),O,{merge:!0}),K=t.student.id,console.log("Student updated successfully"),await tn.logStudentAccess(t.student.id,"edit",{fields:Object.keys(M.studentData||{}),hasDocuments:!!(F||R),formMode:"edit"});else{if(console.log("Adding new student"),!m.ssid||m.ssid.trim()===""){alert("SSID is required for new students");return}const j=m.ssid.trim();O.app.studentData.ssid=j;const H=Ze(bt(ze,"students"));O.createdAt=Wn(),await Ht(H,O),K=H.id,O.id=K,console.log("Student added successfully with ID:",K,"SSID:",j),await tn.logStudentAccess(K,"create",{ssid:j,fields:Object.keys(M.studentData||{}),hasDocuments:!!(F||R),formMode:"create"})}e("saved",O),e("close")}catch(V){console.error("Error saving student:",V),console.error("Error details:",{code:V.code,message:V.message,stack:V.stack}),alert(`Error saving student: ${V.message||V}. Please try again.`)}finally{a.value=!1}},validateForm:S}}const XU={class:"form-col"},YU={class:"inner-grid-3"},QU={key:0,class:"ssid-field"},JU=["value"],ZU=["value"],e$={__name:"StudentBasicInfo",props:{form:{type:Object,required:!0},mode:{type:String,default:"new"},gradeOptions:{type:Array,required:!0},userRoles:{type:Object,required:!0}},setup(t){return(e,r)=>(N(),L("fieldset",XU,[r[21]||(r[21]=d("legend",null,"Student Info",-1)),d("div",YU,[t.mode==="new"?(N(),L("label",QU,[r[9]||(r[9]=d("span",{class:"field-label"},"SSID (State Student ID) *",-1)),we(d("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>t.form.ssid=n),type:"text",required:"",placeholder:"Enter student SSID",class:"ssid-input"},null,512),[[Ye,t.form.ssid]]),r[10]||(r[10]=d("div",{class:"field-help"},[d("strong",null,"Required:"),Ne(" This can be found in your Student Information System (SIS) such as Aeries, or in SEIS. The SSID is used to link student data across different systems. ")],-1))])):_e("",!0),d("label",null,[r[11]||(r[11]=Ne(" First Name: ")),we(d("input",{"onUpdate:modelValue":r[1]||(r[1]=n=>t.form.firstName=n),type:"text",required:""},null,512),[[Ye,t.form.firstName]])]),d("label",null,[r[12]||(r[12]=Ne(" Last Name: ")),we(d("input",{"onUpdate:modelValue":r[2]||(r[2]=n=>t.form.lastName=n),type:"text",required:""},null,512),[[Ye,t.form.lastName]])]),d("label",null,[r[13]||(r[13]=Ne(" Grade: ")),we(d("select",{"onUpdate:modelValue":r[3]||(r[3]=n=>t.form.grade=n)},[(N(!0),L(Re,null,Ve(t.gradeOptions,n=>(N(),L("option",{key:n,value:n},J(n),9,JU))),128))],512),[[ur,t.form.grade]])]),d("label",null,[r[15]||(r[15]=Ne(" Plan Type: ")),we(d("select",{"onUpdate:modelValue":r[4]||(r[4]=n=>t.form.plan=n)},r[14]||(r[14]=[d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),512),[[ur,t.form.plan]])]),d("label",null,[r[16]||(r[16]=Ne(" Review Date: ")),we(d("input",{"onUpdate:modelValue":r[5]||(r[5]=n=>t.form.reviewDate=n),type:"date"},null,512),[[Ye,t.form.reviewDate]])]),d("label",null,[r[17]||(r[17]=Ne(" Reevaluation Date: ")),we(d("input",{"onUpdate:modelValue":r[6]||(r[6]=n=>t.form.reevalDate=n),type:"date"},null,512),[[Ye,t.form.reevalDate]])]),d("label",null,[r[18]||(r[18]=Ne(" Meeting Date: ")),we(d("input",{"onUpdate:modelValue":r[7]||(r[7]=n=>t.form.meetingDate=n),type:"date"},null,512),[[Ye,t.form.meetingDate]])]),d("label",null,[r[20]||(r[20]=Ne(" Case Manager: ")),we(d("select",{"onUpdate:modelValue":r[8]||(r[8]=n=>t.form.caseManagerId=n)},[r[19]||(r[19]=d("option",{value:""},"-- Select Case Manager --",-1)),(N(!0),L(Re,null,Ve(t.userRoles.caseManagers,n=>(N(),L("option",{key:n.id,value:n.id},J(n.name||n.email||n.id),9,ZU))),128))],512),[[ur,t.form.caseManagerId]])])])]))}},t$=yt(e$,[["__scopeId","data-v-5eadce29"]]),r$={class:"form-col"},n$={class:"periods-container"},s$={class:"period-main"},a$={class:"period-label"},i$=["value","onChange"],o$=["value"],l$=["disabled","onClick"],c$={key:0,class:"coteaching-config"},u$={class:"coteaching-info"},d$={class:"classroom-teacher"},f$={class:"case-manager-name"},h$={class:"config-row"},p$=["value","onChange"],m$=["value"],g$={class:"config-row"},v$=["value","onChange"],x$=["value"],y$={__name:"StudentSchedule",props:{form:{type:Object,required:!0},periods:{type:Array,required:!0},userRoles:{type:Object,required:!0},appSettings:{type:Object,default:()=>({})}},setup(t){const e=t,{getLabel:r}=xo(),n=Se(()=>(e.userRoles.caseManagers||[]).filter(y=>y.id&&(y.role==="case_manager"||y.role==="admin_504"||y.role==="administrator_504_CM"||y.role==="sped_chair"||y.roles&&y.roles.includes("case_manager")))),s=Se(()=>{var g;if((g=e.appSettings)!=null&&g.classServices){const y=e.appSettings.classServices.find(E=>E.name==="Co-teach"&&E.enabledSubcategories);if(y)return y.enabledSubcategories.sort()}return["English","Math","History","Science"]}),i=g=>{const y=e.form.schedule[g];return typeof y=="string"?y:typeof y=="object"&&y!==null&&y.teacherId||""},a=(g,y)=>{if(h("SET_TEACHER_START",{period:g,teacherId:y,isCoTeachingActive:c(g),currentValue:e.form.schedule[g]}),c(g)){const E=u(g),b=f(g);e.form.schedule[g]={teacherId:y,coTeaching:{caseManagerId:E,subject:b}},h("SET_TEACHER_COTEACHING",{period:g,newValue:e.form.schedule[g]})}else e.form.schedule[g]=y,h("SET_TEACHER_SIMPLE",{period:g,newValue:e.form.schedule[g]})},o=g=>{if(!g)return"Unknown";const y=(e.userRoles.teachers||[]).find(E=>E.id===g);return y&&(y.name||y.email)||g},l=g=>{if(!g)return"Select Case Manager";const y=n.value.find(E=>E.id===g);return y&&(y.name||y.email)||g},c=g=>{var E;const y=e.form.schedule[g];return typeof y=="object"&&y!==null?!!((E=y.coTeaching)!=null&&E.caseManagerId):!1},u=g=>{var E;const y=e.form.schedule[g];return typeof y=="object"&&y!==null&&((E=y.coTeaching)==null?void 0:E.caseManagerId)||""},f=g=>{var E;const y=e.form.schedule[g];return typeof y=="object"&&y!==null&&((E=y.coTeaching)==null?void 0:E.subject)||""},h=(g,y)=>{const E=new Date().toISOString();console.log(`🕒 [${E}] Schedule Process: ${g}`,y)},p=(g,y)=>{h("UPDATE_CM_START",{period:g,caseManagerId:y,currentValue:e.form.schedule[g]});const E=i(g),b=f(g);E?(e.form.schedule[g]={teacherId:E,coTeaching:{caseManagerId:y,subject:b}},h("UPDATE_CM_COMPLETE",{period:g,newValue:e.form.schedule[g]}),console.log("🔍 CO-TEACHING DEBUG - Case Manager Updated:",{period:g,periodType:typeof g,caseManagerId:y,teacherId:E,subject:b,finalValue:e.form.schedule[g],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):h("UPDATE_CM_BLOCKED",{reason:"No teacher ID",period:g})},m=(g,y)=>{h("UPDATE_SUBJECT_START",{period:g,subject:y,currentValue:e.form.schedule[g]});const E=i(g),b=u(g);E?(e.form.schedule[g]={teacherId:E,coTeaching:{caseManagerId:b,subject:y}},h("UPDATE_SUBJECT_COMPLETE",{period:g,newValue:e.form.schedule[g]}),console.log("🔍 CO-TEACHING DEBUG - Subject Updated:",{period:g,periodType:typeof g,subject:y,teacherId:E,caseManagerId:b,finalValue:e.form.schedule[g],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):h("UPDATE_SUBJECT_BLOCKED",{reason:"No teacher ID",period:g})},v=g=>{var b;h("TOGGLE_START",{period:g,currentValue:e.form.schedule[g],formVersion:e.formVersion});const y=i(g);if(!y){h("TOGGLE_BLOCKED",{reason:"No teacher selected",period:g});return}const E=c(g);if(h("TOGGLE_STATE",{period:g,isActive:E,teacherId:y,beforeValue:e.form.schedule[g]}),E)e.form.schedule[g]=y;else{const k={teacherId:y,coTeaching:{caseManagerId:((b=n.value[0])==null?void 0:b.id)||"",subject:s.value[0]||""}};e.form.schedule[g]=k,setTimeout(()=>{var P;console.log("🔍 CO-TEACHING PERSISTENCE CHECK - 100ms later:",{period:g,stillExists:!!e.form.schedule[g],currentValue:e.form.schedule[g],isObject:typeof e.form.schedule[g]=="object",hasCoTeaching:!!((P=e.form.schedule[g])!=null&&P.coTeaching)})},100),setTimeout(()=>{var P;console.log("🔍 CO-TEACHING PERSISTENCE CHECK - 1000ms later:",{period:g,stillExists:!!e.form.schedule[g],currentValue:e.form.schedule[g],isObject:typeof e.form.schedule[g]=="object",hasCoTeaching:!!((P=e.form.schedule[g])!=null&&P.coTeaching)})},1e3)}h("TOGGLE_COMPLETE",{period:g,afterValue:e.form.schedule[g],formVersion:e.formVersion}),console.log("🔍 CO-TEACHING DEBUG - Toggle Complete:",{period:g,periodType:typeof g,isActive:!E,finalValue:e.form.schedule[g],entireSchedule:JSON.stringify(e.form.schedule,null,2),availableCaseManagers:n.value.length,availableSubjects:s.value.length})};return Vt(()=>e.form.schedule,(g,y)=>{console.log("🔍 SCHEDULE WATCHER - Schedule changed:",{timestamp:new Date().toISOString(),newSchedule:JSON.stringify(g,null,2),oldSchedule:JSON.stringify(y,null,2),periodsWithObjects:Object.keys(g).filter(E=>typeof g[E]=="object"),periodsWithCoTeaching:Object.keys(g).filter(E=>{var b;return(b=g[E])==null?void 0:b.coTeaching})})},{deep:!0}),(g,y)=>(N(),L("fieldset",r$,[y[7]||(y[7]=d("legend",null,"Schedule",-1)),d("div",n$,[(N(!0),L(Re,null,Ve(t.periods,E=>(N(),L("div",{key:E,class:"period-row"},[d("div",s$,[d("label",a$,J(ee(r)(E))+":",1),d("select",{value:i(E),onChange:b=>a(E,b.target.value),class:"teacher-select"},[y[0]||(y[0]=d("option",{value:""},"--",-1)),(N(!0),L(Re,null,Ve(t.userRoles.teachers,b=>(N(),L("option",{key:b.id,value:b.id},J(b.name||b.email||b.id),9,o$))),128))],40,i$),d("button",{type:"button",class:Qe(["coteaching-toggle",{active:c(E)}]),disabled:!i(E),onClick:b=>v(E),title:"Co-Teaching"}," C ",10,l$)]),c(E)?(N(),L("div",c$,[d("div",u$,[y[1]||(y[1]=d("span",{class:"coteaching-label"},"Co-Teaching:",-1)),d("span",d$,J(o(i(E))),1),y[2]||(y[2]=d("span",{class:"plus-sign"},"+",-1)),d("span",f$,J(l(u(E))),1)]),d("div",h$,[y[4]||(y[4]=d("label",{class:"config-label"},"Subject:",-1)),d("select",{value:f(E),onChange:b=>m(E,b.target.value),class:"subject-select",required:""},[y[3]||(y[3]=d("option",{value:""},"-- Select Subject --",-1)),(N(!0),L(Re,null,Ve(s.value,b=>(N(),L("option",{key:b,value:b},J(b),9,m$))),128))],40,p$)]),d("div",g$,[y[6]||(y[6]=d("label",{class:"config-label"},"Case Manager:",-1)),d("select",{value:u(E),onChange:b=>p(E,b.target.value),class:"cm-select",required:""},[y[5]||(y[5]=d("option",{value:""},"-- Select Case Manager --",-1)),(N(!0),L(Re,null,Ve(n.value,b=>(N(),L("option",{key:b.id,value:b.id},J(b.name||b.email||b.id),9,x$))),128))],40,v$)])])):_e("",!0)]))),128))])]))}},E$=yt(y$,[["__scopeId","data-v-4aeb2d99"]]),_$={class:"checkbox-inline-group"},b$=["value","checked","onChange"],lS={__name:"ServiceCheckboxGroup",props:["label","items","modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const r=t,n=e;function s(i){const a=r.label+": "+i,o=r.modelValue?[...r.modelValue]:[],l=o.indexOf(a);l===-1?o.push(a):o.splice(l,1),n("update:modelValue",o)}return(i,a)=>(N(),L("fieldset",null,[d("legend",null,J(t.label),1),d("div",_$,[(N(!0),L(Re,null,Ve(t.items,o=>(N(),L("label",{key:o},[d("input",{type:"checkbox",value:t.label+": "+o,checked:t.modelValue&&t.modelValue.includes(t.label+": "+o),onChange:l=>s(o)},null,40,b$),Ne(" "+J(o),1)]))),128))])]))}},S$={class:"form-col"},A$={class:"inner-grid-3"},T$={key:0,class:"loading-message"},w$={key:1,class:"error-message"},C$={style:{display:"none"}},I$={key:3,class:"no-services-message"},k$={__name:"StudentClassServices",props:{form:{type:Object,required:!0},availableClassServices:{type:Array,required:!0},appSettingsLoading:{type:Boolean,default:!1},appSettingsError:{type:String,default:null}},setup(t){const e=t,r=Se(()=>e.availableClassServices.filter(s=>s.name!=="Co-teach")),n=Se(()=>e.availableClassServices.filter(s=>s.name==="Co-teach"));return(s,i)=>(N(),L("fieldset",S$,[i[5]||(i[5]=d("legend",null,"Services: classes",-1)),d("div",A$,[t.appSettingsLoading?(N(),L("div",T$,i[2]||(i[2]=[d("span",{class:"loading-spinner"},"⏳",-1),Ne(" Loading app settings... ")]))):t.appSettingsError?(N(),L("div",w$,[i[3]||(i[3]=d("span",{class:"error-icon"},"⚠️",-1)),Ne(" Error loading app settings: "+J(t.appSettingsError),1)])):t.availableClassServices.length>0?(N(),L(Re,{key:2},[(N(!0),L(Re,null,Ve(r.value,a=>(N(),Kr(lS,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[0]||(i[0]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128)),d("div",C$,[(N(!0),L(Re,null,Ve(n.value,a=>(N(),Kr(lS,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[1]||(i[1]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128))])],64)):(N(),L("div",I$,i[4]||(i[4]=[d("span",{class:"info-icon"},"ℹ️",-1),Ne(" No class services configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},D$=yt(k$,[["__scopeId","data-v-d750acb2"]]),P$=["id","value"],R$=["value"],cS={__name:"ServiceSelect",props:["id","label","list","modelValue"],emits:["update:modelValue"],setup(t){return(e,r)=>(N(),L("label",null,[Ne(J(t.label)+": ",1),d("select",{id:t.id,value:t.modelValue,onChange:r[0]||(r[0]=n=>e.$emit("update:modelValue",n.target.value))},[r[1]||(r[1]=d("option",{value:""},"--",-1)),(N(!0),L(Re,null,Ve(t.list,n=>(N(),L("option",{key:n.id,value:n.id},J(n.name),9,R$))),128))],40,P$)]))}},F$={class:"inner-grid-3"},N$={key:1,class:"no-services-message"},O$={__name:"StudentProviders",props:{form:{type:Object,required:!0},serviceProviders:{type:Array,required:!0},customServiceProviders:{type:Array,required:!0},providerFieldMap:{type:Object,required:!0},getProviderLabel:{type:Function,required:!0},getProviderUsers:{type:Function,required:!0}},setup(t){return(e,r)=>(N(),L("fieldset",null,[r[1]||(r[1]=d("legend",null,"Services: providers",-1)),d("div",F$,[t.serviceProviders.length>0?(N(),L(Re,{key:0},[(N(!0),L(Re,null,Ve(t.serviceProviders,n=>(N(),Kr(cS,{key:n,id:n,label:t.getProviderLabel(n),list:t.getProviderUsers(n),modelValue:t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`]=s},null,8,["id","label","list","modelValue","onUpdate:modelValue"]))),128)),(N(!0),L(Re,null,Ve(t.customServiceProviders,n=>(N(),Kr(cS,{key:n,id:n,label:n,list:[],modelValue:t.form[`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[`${n.toLowerCase()}Id`]=s},null,8,["id","label","modelValue","onUpdate:modelValue"]))),128))],64)):(N(),L("div",N$,r[0]||(r[0]=[d("span",{class:"info-icon"},"ℹ️",-1),Ne(" No service providers configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},M$=yt(O$,[["__scopeId","data-v-faa02238"]]),L$={class:"form-col"},B$={class:"document-section"},U$={key:0,class:"current-file"},$$={key:1,class:"removed-file"},V$={key:2,class:"upload-status loading-pulse"},H$={key:3,class:"error-message"},j$={class:"document-section"},G$={key:0,class:"current-file"},W$={key:1,class:"removed-file"},z$={key:2,class:"upload-status loading-pulse"},K$={__name:"StudentDocuments",props:{form:{type:Object,required:!0},student:{type:Object,default:()=>({})},mode:{type:String,default:"new"},onFileChange:{type:Function,required:!0},removeBipFile:{type:Function,required:!0},removeAtaglanceFile:{type:Function,required:!0}},emits:["loading-change"],setup(t,{emit:e}){const r=t,n=e,{uploadPdf:s,downloadPdf:i,isUploading:a,error:o}=Lx(),l=se(null),c=Se(()=>a.value||l.value!==null);Vt(c,p=>{n("loading-change",p)},{immediate:!0});const u=Se(()=>{var m,v,g,y;const p=((m=r.student)==null?void 0:m.id)||((v=r.form)==null?void 0:v.id);return console.log("🔍 StudentDocuments - studentId computed:",{studentId:(g=r.student)==null?void 0:g.id,formId:(y=r.form)==null?void 0:y.id,finalId:p}),p}),f=async(p,m)=>{const v=p.target.files[0]||null;if(v){const g=Vc(v,{allowedTypes:["pdf"],maxSize:10485760,fieldName:m==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!g.isValid){alert(g.error),p.target.value="";return}const y=qr(v.name);if(!y.isSafe){alert(`File name contains potentially dangerous content: ${y.threats.join(", ")}`),p.target.value="";return}try{if(l.value=m==="bipFile"?"bip":"ataglance",!u.value)throw new Error("Student ID is required for secure file upload");const E=m==="bipFile"?r.form.bipPdfUrl:r.form.ataglancePdfUrl;if(E){console.log(`🗑️ Cleaning up old ${m} file:`,E);try{const{ref:k,deleteObject:P}=await aa(async()=>{const{ref:C,deleteObject:T}=await Promise.resolve().then(()=>yM);return{ref:C,deleteObject:T}},void 0),{doc:w,deleteDoc:x}=await aa(async()=>{const{doc:C,deleteDoc:T}=await Promise.resolve().then(()=>n9);return{doc:C,deleteDoc:T}},void 0),{storage:S,db:_}=await aa(async()=>{const{storage:C,db:T}=await Promise.resolve().then(()=>T4);return{storage:C,db:T}},void 0),A=k(S,`students/${u.value}/${E}`);await P(A),await x(w(_,"pdfMetadata",E)),console.log(`✅ Old ${m} file cleaned up:`,E)}catch(k){console.warn(`Failed to clean up old ${m} file:`,k.message)}}const b=await s(v,u.value);m==="bipFile"?(Object.assign(r.form,{bipPdfUrl:b,bipFileName:v.name}),console.log("✅ BIP file updated in form:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName})):(Object.assign(r.form,{ataglancePdfUrl:b,ataglanceFileName:v.name}),console.log("✅ At-A-Glance file updated in form:",{ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})),console.log(`✅ Secure PDF uploaded: ${b}`),console.log("📋 Current form state:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName,ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})}catch(E){console.error("Secure PDF upload failed:",E),alert(`Failed to upload PDF: ${E.message}`)}finally{l.value=null,p.target.value=""}}r.onFileChange(p,m)},h=async p=>{try{const m=p==="bip"?r.form.bipPdfUrl:r.form.ataglancePdfUrl,v=p==="bip"?r.form.bipFileName:r.form.ataglanceFileName;if(!m||!u.value)throw new Error("File not found or student ID missing");await i(m,u.value,v)}catch(m){console.error("Secure PDF download failed:",m),alert(`Failed to download PDF: ${m.message}`)}};return(p,m)=>(N(),L("fieldset",L$,[m[16]||(m[16]=d("legend",null,"Documents",-1)),d("div",B$,[d("label",null,[m[11]||(m[11]=Ne(" BIP: ")),d("input",{type:"file",accept:"application/pdf",onChange:m[0]||(m[0]=v=>f(v,"bipFile"))},null,32),t.form.bipPdfUrl&&!t.form.removeBipFile?(N(),L("span",U$,[m[8]||(m[8]=Ne(" Current: ")),d("a",{href:"#",onClick:m[1]||(m[1]=dn(v=>h("bip"),["prevent"])),target:"_blank"},"View BIP"),d("button",{type:"button",onClick:m[2]||(m[2]=(...v)=>t.removeBipFile&&t.removeBipFile(...v)),class:"btn-remove"}," 🗑️ Remove ")])):_e("",!0),t.form.removeBipFile?(N(),L("span",$$,[m[9]||(m[9]=Ne(" BIP file will be removed ")),d("button",{type:"button",onClick:m[3]||(m[3]=v=>t.form.removeBipFile=!1),class:"btn-undo"}," ↩️ Undo ")])):_e("",!0),ee(a)&&l.value==="bip"?(N(),L("div",V$,m[10]||(m[10]=[d("span",{class:"loading-spinner"},"🔄",-1),d("strong",null,"Loading... Uploading BIP document...",-1)]))):_e("",!0),ee(o)?(N(),L("div",H$,J(ee(o)),1)):_e("",!0)])]),d("div",j$,[d("label",null,[m[15]||(m[15]=Ne(" At-A-Glance PDF: ")),d("input",{type:"file",accept:"application/pdf",onChange:m[4]||(m[4]=v=>f(v,"ataglanceFile"))},null,32),t.form.ataglancePdfUrl&&!t.form.removeAtaglanceFile?(N(),L("span",G$,[m[12]||(m[12]=Ne(" Current: ")),d("a",{href:"#",onClick:m[5]||(m[5]=dn(v=>h("ataglance"),["prevent"])),target:"_blank"},"View At-A-Glance"),d("button",{type:"button",onClick:m[6]||(m[6]=(...v)=>t.removeAtaglanceFile&&t.removeAtaglanceFile(...v)),class:"btn-remove"}," 🗑️ Remove ")])):_e("",!0),t.form.removeAtaglanceFile?(N(),L("span",W$,[m[13]||(m[13]=Ne(" At-A-Glance file will be removed ")),d("button",{type:"button",onClick:m[7]||(m[7]=v=>t.form.removeAtaglanceFile=!1),class:"btn-undo"}," ↩️ Undo ")])):_e("",!0),ee(a)&&l.value==="ataglance"?(N(),L("div",z$,m[14]||(m[14]=[d("span",{class:"loading-spinner"},"🔄",-1),d("strong",null,"Loading... Uploading At-A-Glance document...",-1)]))):_e("",!0)])])]))}},q$=yt(K$,[["__scopeId","data-v-078af5f3"]]),X$={class:"form-col"},Y$={class:"inner-grid-2"},Q$={__name:"StudentAccommodations",props:{form:{type:Object,required:!0}},setup(t){return(e,r)=>(N(),L("fieldset",X$,[r[4]||(r[4]=d("legend",null,"Accommodations",-1)),d("div",Y$,[d("label",null,[r[2]||(r[2]=Ne(" Instruction: ")),we(d("textarea",{"onUpdate:modelValue":r[0]||(r[0]=n=>t.form.instruction=n),placeholder:"Enter instructional accommodations..."},null,512),[[Ye,t.form.instruction]])]),d("label",null,[r[3]||(r[3]=Ne(" Assessment: ")),we(d("textarea",{"onUpdate:modelValue":r[1]||(r[1]=n=>t.form.assessment=n),placeholder:"Enter assessment accommodations..."},null,512),[[Ye,t.form.assessment]])])])]))}},J$=yt(Q$,[["__scopeId","data-v-4ce4f379"]]),Z$={class:"flags-container"},eV={class:"checkbox-label"},tV={class:"checkbox-label"},rV={__name:"StudentFlags",props:{form:{type:Object,required:!0}},setup(t){return(e,r)=>(N(),L("fieldset",null,[r[4]||(r[4]=d("legend",null,"Flags",-1)),d("div",Z$,[d("label",eV,[we(d("input",{type:"checkbox","onUpdate:modelValue":r[0]||(r[0]=n=>t.form.flag1=n)},null,512),[[_t,t.form.flag1]]),r[2]||(r[2]=Ne(" Preferential seating "))]),d("label",tV,[we(d("input",{type:"checkbox","onUpdate:modelValue":r[1]||(r[1]=n=>t.form.flag2=n)},null,512),[[_t,t.form.flag2]]),r[3]||(r[3]=Ne(" Separate setting "))])])]))}},nV=yt(rV,[["__scopeId","data-v-e7295a7a"]]),sV={class:"dialog-backdrop"},aV={class:"dialog"},iV=["disabled"],oV={__name:"StudentForm",props:{student:{type:Object,default:()=>({})},users:{type:Object,required:!0},mode:{type:String,default:"new"}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{form:s,isSaving:i,appSettings:a,appSettingsLoading:o,appSettingsError:l,periods:c,gradeOptions:u,availableClassServices:f,serviceProviders:h,customServiceProviders:p,userRoles:m,onFileChange:v,removeBipFile:g,removeAtaglanceFile:y,providerFieldMap:E,getProviderLabel:b,getProviderUsers:k,handleSubmit:P}=qU(r,n),w=se(!1),x=Se(()=>i.value||w.value),S=Se(()=>w.value?"Loading files...":i.value?"Saving...":r.mode==="edit"?"Save":"Add Student"),_=A=>{w.value=A};return(A,C)=>(N(),L("div",sV,[d("div",aV,[d("header",null,[d("h2",null,J(t.mode==="edit"?"Edit Student":"Add Student"),1),d("button",{onClick:C[0]||(C[0]=T=>A.$emit("close")),class:"close-btn"},"×")]),d("form",{onSubmit:C[2]||(C[2]=dn((...T)=>ee(P)&&ee(P)(...T),["prevent"])),id:"student-form"},[nt(t$,{form:ee(s),mode:t.mode,"grade-options":ee(u),"user-roles":ee(m)},null,8,["form","mode","grade-options","user-roles"]),nt(E$,{form:ee(s),periods:ee(c),"user-roles":ee(m),"app-settings":ee(a)},null,8,["form","periods","user-roles","app-settings"]),nt(D$,{form:ee(s),"available-class-services":ee(f),"app-settings-loading":ee(o),"app-settings-error":ee(l)},null,8,["form","available-class-services","app-settings-loading","app-settings-error"]),nt(M$,{form:ee(s),"service-providers":ee(h),"custom-service-providers":ee(p),"provider-field-map":ee(E),"get-provider-label":ee(b),"get-provider-users":ee(k)},null,8,["form","service-providers","custom-service-providers","provider-field-map","get-provider-label","get-provider-users"]),nt(q$,{form:ee(s),student:t.student,mode:t.mode,"on-file-change":ee(v),"remove-bip-file":ee(g),"remove-ataglance-file":ee(y),onLoadingChange:_},null,8,["form","student","mode","on-file-change","remove-bip-file","remove-ataglance-file"]),nt(J$,{form:ee(s)},null,8,["form"]),nt(nV,{form:ee(s)},null,8,["form"]),d("footer",null,[d("button",{type:"button",onClick:C[1]||(C[1]=T=>A.$emit("close")),class:"btn btn-secondary"}," Cancel "),d("button",{type:"submit",class:"btn btn-primary",disabled:x.value},J(S.value),9,iV)])],32)])]))}},Bx=yt(oV,[["__scopeId","data-v-7363b0d2"]]),lV={key:0},cV={key:1,class:"loading-dialog"},uV={__name:"StudentEditDialog",props:{studentId:{type:String,required:!0},users:{type:Object,required:!0}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{students:s,fetchStudents:i}=Ua(),a=Se(()=>{var c,u,f,h,p,m,v,g;const l=s.value.find(y=>y.id===r.studentId);return console.log("📋 StudentEditDialog - studentId:",r.studentId),console.log("📋 StudentEditDialog - students count:",s.value.length),console.log("📋 StudentEditDialog - found student:",l?{id:l.id,hasApp:!!l.app,keys:Object.keys(l)}:"NOT FOUND"),l&&console.log("📋 StudentEditDialog - student data preview:",{id:l.id,firstName:(u=(c=l.app)==null?void 0:c.studentData)==null?void 0:u.firstName,lastName:(h=(f=l.app)==null?void 0:f.studentData)==null?void 0:h.lastName,plan:(m=(p=l.app)==null?void 0:p.studentData)==null?void 0:m.plan,caseManagerId:(g=(v=l.app)==null?void 0:v.studentData)==null?void 0:g.caseManagerId}),l||{}});Ut(async()=>{s.value.length===0&&(console.log("StudentEditDialog - fetching students..."),await i())});function o(l){console.log("StudentEditDialog - student saved:",l),n("saved",l)}return(l,c)=>a.value&&Object.keys(a.value).length>0?(N(),L("div",lV,[nt(Bx,{student:a.value,users:t.users,mode:"edit",onClose:c[0]||(c[0]=u=>l.$emit("close")),onSaved:o},null,8,["student","users"])])):(N(),L("div",cV,c[1]||(c[1]=[d("div",{class:"dialog"},[d("header",null,[d("h2",null,"Loading Student Data...")]),d("div",{class:"content"},[d("p",null,"Please wait while we load the student information.")])],-1)])))}},dV=yt(uV,[["__scopeId","data-v-a4c3b7b7"]]),fV={class:"dialog-backdrop"},hV={class:"dialog"},pV={class:"button-group"},mV={key:0,class:"members-list"},gV={key:0,class:"email"},vV=["value"],xV={class:"docs-option"},yV={key:0,class:"no-docs"},EV=["disabled"],_V=["disabled"],bV={__name:"StudentsEmailDialog",props:{student:{type:Object,required:!0},userMap:{type:Object,required:!0}},emits:["close"],setup(t){const e=t,{student:r,userMap:n}=e,s=se(""),i=se([]),a=se(!1),o=Se(()=>{var y,E;if((E=(y=r.app)==null?void 0:y.schedule)!=null&&E.periods){const b=[];return Object.values(r.app.schedule.periods).forEach(k=>{var w;const P=typeof k=="string"?k:k==null?void 0:k.teacherId;P&&b.push(P),(w=k==null?void 0:k.coTeaching)!=null&&w.caseManagerId&&b.push(k.coTeaching.caseManagerId)}),b}const g=r.schedule||{};return Object.values(g).filter(Boolean)}),l=Se(()=>[...new Set(o.value)]),c=Se(()=>{var y;const g=[];(y=r.app)!=null&&y.providers&&Object.entries(r.app.providers).forEach(([E,b])=>{b&&!["caseManagerId"].includes(E)&&g.push(b)});for(const E in r)E.endsWith("_id")&&!["casemanager_id","caseManagerId"].includes(E)&&r[E]&&g.push(r[E]);return[...new Set(g)].filter(E=>!l.value.includes(E))}),u=Se(()=>l.value.map(g=>({id:g,...n[g]||{}})).filter(g=>g&&g.email)),f=Se(()=>c.value.map(g=>({id:g,...n[g]||{}})).filter(g=>g&&g.email)),h=Se(()=>[...u.value,...f.value]),p=Se(()=>{var g,y,E,b;return!!((y=(g=r.app)==null?void 0:g.documents)!=null&&y.ataglancePdfUrl||(b=(E=r.app)==null?void 0:E.documents)!=null&&b.bipPdfUrl||r.ataglancePdfUrl||r.ataglance_pdf_url||r.bipPdfUrl||r.bip_pdf_url)}),m=Se(()=>s.value?s.value==="Individual"?i.value.length>0:!0:!1);function v(){var _,A,C,T,D,V,B,R,F,M,O;let g=[];s.value==="Teachers"?g=u.value:s.value==="TeachersAndService"?g=[...u.value,...f.value]:s.value==="Individual"&&(g=h.value.filter(K=>i.value.includes(K.id)));const y=g.map(K=>K.email).filter(Boolean).join(",");if(!y){alert("No email addresses found for the selected recipients.");return}console.log("🔍 Student data for email:",{student:r,firstName:r.firstName,first_name:r.first_name,lastName:r.lastName,last_name:r.last_name,appStudentData:(_=r.app)==null?void 0:_.studentData});const E=r.firstName||r.first_name||((C=(A=r.app)==null?void 0:A.studentData)==null?void 0:C.firstName)||((T=r.app)==null?void 0:T.firstName)||"",b=r.lastName||r.last_name||((V=(D=r.app)==null?void 0:D.studentData)==null?void 0:V.lastName)||((B=r.app)==null?void 0:B.lastName)||"";console.log("🔍 Extracted names:",{firstName:E,lastName:b});const k=`${E} ${b}`.trim()||"Student",P=(((E==null?void 0:E[0])||"")+((b==null?void 0:b[0])||"")).toUpperCase()||"ST";console.log("🔍 Final values:",{fullName:k,initials:P});const w=`${P} - Student Update`;let x="";if(a.value){x+=`Hi team!

${k}'s updated documents are available in the CaseManage app.

`;const K=((F=(R=r.app)==null?void 0:R.documents)==null?void 0:F.ataglancePdfUrl)||r.ataglancePdfUrl||r.ataglance_pdf_url,j=((O=(M=r.app)==null?void 0:M.documents)==null?void 0:O.bipPdfUrl)||r.bipPdfUrl||r.bip_pdf_url;K||j?(x+=`Available documents:
`,K&&(x+=`• At-A-Glance
`),j&&(x+=`• BIP (Behavior Intervention Plan)
`),x+=`
To access the documents:
`,x+=`Log into the CaseManage app: ${window.location.origin}
`,x+=`Navigate to the student's record to view their documents.

`,x+=`The documents require authentication to view for security purposes.
`):(x+=`No documents are currently available for ${k}.

`,x+=`If documents are added, you can access them by logging into:
`,x+=`${window.location.origin}
`)}else x="See attached.";console.log("🔍 Email composition:",{subject:w,body:x});const S=`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(y)}&su=${encodeURIComponent(w)}&body=${encodeURIComponent(x)}`;window.open(S,"_blank","noopener")}return(g,y)=>(N(),L("div",fV,[d("div",hV,[d("header",null,[d("h2",null,"Email about "+J(ee(r).firstName||ee(r).first_name)+" "+J(ee(r).lastName||ee(r).last_name),1),d("button",{onClick:y[0]||(y[0]=E=>g.$emit("close")),title:"Close"},"×")]),d("main",null,[d("form",{onSubmit:y[6]||(y[6]=dn(()=>{},["prevent"]))},[d("div",pV,[d("button",{type:"button",class:Qe(["option-button",{active:s.value==="Teachers"}]),onClick:y[1]||(y[1]=E=>s.value="Teachers")}," Teachers ",2),d("button",{type:"button",class:Qe(["option-button",{active:s.value==="TeachersAndService"}]),onClick:y[2]||(y[2]=E=>s.value="TeachersAndService")}," Teachers and service providers ",2),d("button",{type:"button",class:Qe(["option-button",{active:s.value==="Individual"}]),onClick:y[3]||(y[3]=E=>s.value="Individual")}," Individual member of the IEP team ",2)]),s.value==="Individual"?(N(),L("div",mV,[y[8]||(y[8]=d("div",null,"Select members:",-1)),(N(!0),L(Re,null,Ve(h.value,E=>(N(),L("div",{key:E.id},[d("label",null,[d("span",null,[Ne(J(E.name||E.displayName||E.email||E.id)+" ",1),E.email?(N(),L("span",gV,"("+J(E.email)+")",1)):_e("",!0)]),we(d("input",{type:"checkbox",value:E.id,"onUpdate:modelValue":y[4]||(y[4]=b=>i.value=b)},null,8,vV),[[_t,i.value]])])]))),128))])):_e("",!0),d("div",xV,[d("label",null,[d("span",null,[y[9]||(y[9]=Ne(" Include documents ")),p.value?_e("",!0):(N(),L("span",yV,"(No docs available)"))]),we(d("input",{type:"checkbox","onUpdate:modelValue":y[5]||(y[5]=E=>a.value=E),disabled:!p.value},null,8,EV),[[_t,a.value]])])])],32)]),d("footer",null,[d("button",{onClick:y[7]||(y[7]=E=>g.$emit("close"))},"Cancel"),d("button",{disabled:!m.value,onClick:v},"Send",8,_V)])])]))}},SV=yt(bV,[["__scopeId","data-v-0e59eb1d"]]),AV={class:"dialog-backdrop"},TV={class:"dialog"},wV={class:"field-groups"},CV={class:"field-group"},IV={class:"field-group"},kV={class:"field-group"},DV={class:"field-group"},PV={class:"field-group"},RV={class:"field-group"},FV=["disabled"],NV={__name:"ExportDialog",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})}},emits:["close"],setup(t,{emit:e}){const r=t,n=e,s=xa(),i=B4(),a=se({studentData:{firstName:!0,lastName:!0,grade:!0,plan:!0,caseManagerId:!0},dates:{reviewDate:!0,reevalDate:!0,meetingDate:!0},providers:{all:!0},accommodations:{instruction:!0,assessment:!0},schedule:{periods:!0,classServices:!0},documents:{ataglancePdfUrl:!0,bipPdfUrl:!0}}),o=["speechId","otId","mhId","ptId","scId","trId","audId","viId","atId","dhhId","omId","bisId","hnId","swId"],l=Se(()=>Object.values(a.value).some(g=>Object.values(g).some(y=>y)));function c(g){if(!g||!r.userMap[g])return"";const y=r.userMap[g];return y.name||y.email||""}function u(g){const y=i.userPermissions||[];return Array.isArray(y)&&y.includes(g)}function f(){Object.keys(a.value).forEach(g=>{Object.keys(a.value[g]).forEach(y=>{a.value[g][y]=!0})})}function h(){Object.keys(a.value).forEach(g=>{Object.keys(a.value[g]).forEach(y=>{a.value[g][y]=!1})})}function p(g){var k,P,w,x,S,_,A,C,T,D,V,B,R,F,M,O,K,j,H,W,X,re,he,ue,pe,q,G,oe,Q,Y,Z,ne;const y=s.currentUser;if((y==null?void 0:y.role)==="admin"||(y==null?void 0:y.role)==="administrator"||(y==null?void 0:y.role)==="staff_view"||(y==null?void 0:y.role)==="sped_chair"||(y==null?void 0:y.role)==="administrator_504_CM"||(y==null?void 0:y.role)==="admin_504")return m(g);const b={};return a.value.studentData.firstName&&(b.firstName=(P=(k=g.app)==null?void 0:k.studentData)==null?void 0:P.firstName),a.value.studentData.lastName&&(b.lastName=(x=(w=g.app)==null?void 0:w.studentData)==null?void 0:x.lastName),a.value.studentData.grade&&(b.grade=(_=(S=g.app)==null?void 0:S.studentData)==null?void 0:_.grade),a.value.studentData.plan&&(b.plan=(C=(A=g.app)==null?void 0:A.studentData)==null?void 0:C.plan),a.value.studentData.caseManagerId&&(b.caseManagerId=(D=(T=g.app)==null?void 0:T.studentData)==null?void 0:D.caseManagerId),u("view_student_dates")&&(a.value.dates.reviewDate&&(b.reviewDate=(B=(V=g.app)==null?void 0:V.dates)==null?void 0:B.reviewDate),a.value.dates.reevalDate&&(b.reevalDate=(F=(R=g.app)==null?void 0:R.dates)==null?void 0:F.reevalDate),a.value.dates.meetingDate&&(b.meetingDate=(O=(M=g.app)==null?void 0:M.dates)==null?void 0:O.meetingDate)),(u("view_service_providers")||((j=(K=g.app)==null?void 0:K.studentData)==null?void 0:j.caseManagerId)===(y==null?void 0:y.uid)||o.some(ge=>{var ae,ce;return((ce=(ae=g.app)==null?void 0:ae.providers)==null?void 0:ce[ge])===(y==null?void 0:y.uid)}))&&a.value.providers.all&&o.forEach(ge=>{var ae,ce;b[ge]=(ce=(ae=g.app)==null?void 0:ae.providers)==null?void 0:ce[ge]}),u("view_accommodations")&&(a.value.accommodations.instruction&&(b.instruction=(W=(H=g.app)==null?void 0:H.accommodations)==null?void 0:W.instruction),a.value.accommodations.assessment&&(b.assessment=(re=(X=g.app)==null?void 0:X.accommodations)==null?void 0:re.assessment)),(u("view_schedule")||Object.values(((ue=(he=g.app)==null?void 0:he.schedule)==null?void 0:ue.periods)||{}).includes(y==null?void 0:y.uid))&&(a.value.schedule.periods&&(b.schedule=(q=(pe=g.app)==null?void 0:pe.schedule)==null?void 0:q.periods),a.value.schedule.classServices&&(b.classServices=(oe=(G=g.app)==null?void 0:G.schedule)==null?void 0:oe.classServices)),u("view_documents")&&(a.value.documents.ataglancePdfUrl&&(b.ataglancePdfUrl=(Y=(Q=g.app)==null?void 0:Q.documents)==null?void 0:Y.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(b.bipPdfUrl=(ne=(Z=g.app)==null?void 0:Z.documents)==null?void 0:ne.bipPdfUrl)),b}function m(g){var E,b,k,P,w,x,S,_,A,C,T,D,V,B,R,F,M,O,K,j,H,W,X,re,he,ue,pe,q;const y={};return a.value.studentData.firstName&&(y.firstName=(b=(E=g.app)==null?void 0:E.studentData)==null?void 0:b.firstName),a.value.studentData.lastName&&(y.lastName=(P=(k=g.app)==null?void 0:k.studentData)==null?void 0:P.lastName),a.value.studentData.grade&&(y.grade=(x=(w=g.app)==null?void 0:w.studentData)==null?void 0:x.grade),a.value.studentData.plan&&(y.plan=(_=(S=g.app)==null?void 0:S.studentData)==null?void 0:_.plan),a.value.studentData.caseManagerId&&(y.caseManagerId=(C=(A=g.app)==null?void 0:A.studentData)==null?void 0:C.caseManagerId),a.value.dates.reviewDate&&(y.reviewDate=(D=(T=g.app)==null?void 0:T.dates)==null?void 0:D.reviewDate),a.value.dates.reevalDate&&(y.reevalDate=(B=(V=g.app)==null?void 0:V.dates)==null?void 0:B.reevalDate),a.value.dates.meetingDate&&(y.meetingDate=(F=(R=g.app)==null?void 0:R.dates)==null?void 0:F.meetingDate),a.value.providers.all&&o.forEach(G=>{var oe,Q;y[G]=(Q=(oe=g.app)==null?void 0:oe.providers)==null?void 0:Q[G]}),a.value.accommodations.instruction&&(y.instruction=(O=(M=g.app)==null?void 0:M.accommodations)==null?void 0:O.instruction),a.value.accommodations.assessment&&(y.assessment=(j=(K=g.app)==null?void 0:K.accommodations)==null?void 0:j.assessment),a.value.schedule.periods&&(y.schedule=(W=(H=g.app)==null?void 0:H.schedule)==null?void 0:W.periods),a.value.schedule.classServices&&(y.classServices=(re=(X=g.app)==null?void 0:X.schedule)==null?void 0:re.classServices),a.value.documents.ataglancePdfUrl&&(y.ataglancePdfUrl=(ue=(he=g.app)==null?void 0:he.documents)==null?void 0:ue.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(y.bipPdfUrl=(q=(pe=g.app)==null?void 0:pe.documents)==null?void 0:q.bipPdfUrl),y}function v(){const g=r.students.map(S=>p(S)),y=[],E=[],b={firstName:"First Name",lastName:"Last Name",grade:"Grade",plan:"Plan Type",caseManagerId:"Case Manager",reviewDate:"Plan Review",reevalDate:"Reevaluation",meetingDate:"Meeting Date",speechId:"Speech",otId:"OT",mhId:"Mental Health",ptId:"PT",scId:"SC",trId:"TR",audId:"Audiology",viId:"Vision",atId:"AT",dhhId:"DHH",omId:"O&M",bisId:"BIS",hnId:"HN",swId:"SW",instruction:"Instructional Accommodation",assessment:"Assessment Accommodations",schedule:"Schedule",classServices:"Class Services",ataglancePdfUrl:"At-A-Glance",bipPdfUrl:"BIP"};Object.entries(a.value).forEach(([S,_])=>{Object.entries(_).forEach(([A,C])=>{C&&(A==="all"?o.forEach(T=>{y.push(b[T])}):y.push(b[A]))})}),g.forEach(S=>{const _=[];Object.entries(a.value).forEach(([A,C])=>{Object.entries(C).forEach(([T,D])=>{if(D)if(T==="all")o.forEach(V=>{const B=S[V]||"";_.push(B?c(B):"")});else{let V=S[T]||"";T.endsWith("Id")?V=V?c(V):"":T==="classServices"?V=Array.isArray(S.classServices)?S.classServices.join(", "):"":T==="schedule"&&(V=S.schedule?Object.entries(S.schedule).map(([B,R])=>`${B}: ${c(R)}`).join("; "):""),_.push(V)}})}),E.push(_)});const k=[y.join(","),...E.map(S=>S.map(_=>`"${String(_).replace(/"/g,'""')}"`).join(","))].join(`
`),P=new Blob([k],{type:"text/csv"}),w=window.URL.createObjectURL(P),x=document.createElement("a");x.href=w,x.download="students-export.csv",x.click(),window.URL.revokeObjectURL(w),n("close")}return(g,y)=>(N(),L("div",AV,[d("div",TV,[d("header",null,[y[17]||(y[17]=d("h2",null,"Export Students",-1)),d("button",{onClick:y[0]||(y[0]=E=>g.$emit("close")),class:"close-btn"},"×")]),d("main",null,[d("p",null,"Export "+J(t.students.length)+" students",1),d("div",wV,[d("div",CV,[y[23]||(y[23]=d("h4",null,"Student Info",-1)),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[1]||(y[1]=E=>a.value.studentData.firstName=E)},null,512),[[_t,a.value.studentData.firstName]]),y[18]||(y[18]=Ne(" First Name "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[2]||(y[2]=E=>a.value.studentData.lastName=E)},null,512),[[_t,a.value.studentData.lastName]]),y[19]||(y[19]=Ne(" Last Name "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[3]||(y[3]=E=>a.value.studentData.grade=E)},null,512),[[_t,a.value.studentData.grade]]),y[20]||(y[20]=Ne(" Grade "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[4]||(y[4]=E=>a.value.studentData.plan=E)},null,512),[[_t,a.value.studentData.plan]]),y[21]||(y[21]=Ne(" Plan Type "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[5]||(y[5]=E=>a.value.studentData.caseManagerId=E)},null,512),[[_t,a.value.studentData.caseManagerId]]),y[22]||(y[22]=Ne(" Case Manager "))])]),d("div",IV,[y[27]||(y[27]=d("h4",null,"Important Dates",-1)),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[6]||(y[6]=E=>a.value.dates.reviewDate=E)},null,512),[[_t,a.value.dates.reviewDate]]),y[24]||(y[24]=Ne(" Plan Review "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[7]||(y[7]=E=>a.value.dates.reevalDate=E)},null,512),[[_t,a.value.dates.reevalDate]]),y[25]||(y[25]=Ne(" Reevaluation "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[8]||(y[8]=E=>a.value.dates.meetingDate=E)},null,512),[[_t,a.value.dates.meetingDate]]),y[26]||(y[26]=Ne(" Meeting Date "))])]),d("div",kV,[y[29]||(y[29]=d("h4",null,"Related Services",-1)),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[9]||(y[9]=E=>a.value.providers.all=E)},null,512),[[_t,a.value.providers.all]]),y[28]||(y[28]=Ne(" All Service Providers "))])]),d("div",DV,[y[32]||(y[32]=d("h4",null,"Accommodations",-1)),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[10]||(y[10]=E=>a.value.accommodations.instruction=E)},null,512),[[_t,a.value.accommodations.instruction]]),y[30]||(y[30]=Ne(" Instructional "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[11]||(y[11]=E=>a.value.accommodations.assessment=E)},null,512),[[_t,a.value.accommodations.assessment]]),y[31]||(y[31]=Ne(" Assessment "))])]),d("div",PV,[y[35]||(y[35]=d("h4",null,"Schedule & Services",-1)),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[12]||(y[12]=E=>a.value.schedule.periods=E)},null,512),[[_t,a.value.schedule.periods]]),y[33]||(y[33]=Ne(" Class Schedule "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[13]||(y[13]=E=>a.value.schedule.classServices=E)},null,512),[[_t,a.value.schedule.classServices]]),y[34]||(y[34]=Ne(" Class Services "))])]),d("div",RV,[y[38]||(y[38]=d("h4",null,"Documents",-1)),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[14]||(y[14]=E=>a.value.documents.ataglancePdfUrl=E)},null,512),[[_t,a.value.documents.ataglancePdfUrl]]),y[36]||(y[36]=Ne(" At-A-Glance "))]),d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":y[15]||(y[15]=E=>a.value.documents.bipPdfUrl=E)},null,512),[[_t,a.value.documents.bipPdfUrl]]),y[37]||(y[37]=Ne(" BIP "))])])]),d("div",{class:"quick-select"},[d("button",{onClick:f},"Select All"),d("button",{onClick:h},"Deselect All")])]),d("footer",null,[d("button",{onClick:y[16]||(y[16]=E=>g.$emit("close")),class:"btn-secondary"},"Cancel"),d("button",{onClick:v,class:"btn-primary",disabled:!l.value},"Export",8,FV)])])]))}},OV=yt(NV,[["__scopeId","data-v-08e1f384"]]),MV={class:"modal-body"},LV={class:"student-info"},BV={class:"case-manager-info"},UV={class:"form-group"},$V={key:0,class:"no-forms-message"},VV={key:1,class:"form-selection"},HV=["id","value"],jV=["for"],GV={class:"form-title"},WV={class:"form-details"},zV={key:0,class:"form-description"},KV={class:"form-date"},qV={key:0,class:"form-group"},XV={class:"teacher-selection-header"},YV={class:"teacher-actions"},QV=["title"],JV={class:"teacher-selection"},ZV={key:0,class:"no-teachers-message"},eH={key:1,class:"teacher-checkboxes"},tH=["id","value"],rH=["for"],nH={class:"teacher-email"},sH={key:0,class:"selected-emails-preview"},aH={class:"email-preview"},iH={key:1,class:"form-group"},oH={class:"duplication-options"},lH={class:"option-item"},cH={key:2,class:"form-group"},uH={class:"send-history"},dH={class:"history-info"},fH={class:"history-date"},hH={class:"history-teachers"},pH={key:0,class:"history-success"},mH={key:1,class:"history-failed"},gH={key:0,class:"history-links"},vH=["href"],xH=["href"],yH={key:0,class:"resource-links"},EH={class:"resource-section"},_H={class:"resource-note"},bH={class:"success-details"},SH={key:0,class:"student-info"},AH={class:"form-link"},TH=["href"],wH={class:"modal-footer"},CH=["disabled"],IH={key:0},kH={key:1},DH={__name:"TeacherFeedbackDialog",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!0}},emits:["close","form-sent"],setup(t,{emit:e}){const r=t,n=e,{activeForms:s}=Fx(),{userList:i,fetchUsers:a}=ya(),o=se(!1),l=se(""),c=se(""),u=se(null),f=se(!1),h=se("Copy teacher emails to clipboard"),p=se(""),m=se([]),v=Se(()=>s.value||[]),g=Se(()=>{var C;return p.value&&((C=v.value)==null?void 0:C.find(T=>T.id===p.value))||null}),y=Se(()=>{if(!p.value||!r.student)return[];try{return JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]").filter(T=>T&&T.studentId===r.student.id&&T.formId===p.value).sort((T,D)=>new Date(D.sentAt)-new Date(T.sentAt))||[]}catch(C){return console.warn("Error parsing send history:",C),[]}}),E=Se(()=>{var T,D,V;if(!r.student||!i.value)return[];const C=new Set;if((D=(T=r.student.app)==null?void 0:T.schedule)!=null&&D.periods)Object.values(r.student.app.schedule.periods).forEach(B=>{var F;const R=typeof B=="string"?B:B==null?void 0:B.teacherId;R&&C.add(R),(F=B==null?void 0:B.coTeaching)!=null&&F.caseManagerId&&C.add(B.coTeaching.caseManagerId)});else{const B=r.student.schedule||{};Object.values(B).forEach(R=>{R&&C.add(R)})}return(V=r.student.aeries)!=null&&V.schedule&&Object.values(r.student.aeries.schedule).forEach(B=>{B!=null&&B.teacherId&&C.add(B.teacherId)}),Array.from(C).map(B=>(i.value||[]).find(R=>R&&R.id===B)).filter(Boolean).filter(B=>B&&B.role==="teacher")}),b=Se(()=>p.value&&(m.value||[]).length>0),k=C=>C?(C.seconds?new Date(C.seconds*1e3):new Date(C)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",P=C=>C?(C.seconds?new Date(C.seconds*1e3):new Date(C)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):"",w=()=>{m.value=[...E.value]},x=async()=>{const C=m.value.map(T=>T.email).join(", ");try{await navigator.clipboard.writeText(C),h.value="✅ Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch(T){console.error("Failed to copy emails:",T);const D=document.createElement("textarea");D.value=C,document.body.appendChild(D),D.select();try{document.execCommand("copy"),h.value="✅ Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch{h.value="❌ Copy failed",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}document.body.removeChild(D)}},S=async()=>{var C,T,D,V;if(b.value)try{o.value=!0,l.value="",u.value=null;const B=g.value,R=m.value.map(he=>he.email),F=m.value.map(he=>he.name||he.email).join(", "),M=r.student.firstName||r.student.first_name||((T=(C=r.student.app)==null?void 0:C.studentData)==null?void 0:T.firstName)||"",O=r.student.lastName||r.student.last_name||((V=(D=r.student.app)==null?void 0:D.studentData)==null?void 0:V.lastName)||"",K=`${M} ${O}`.trim(),j=(((M==null?void 0:M[0])||"")+((O==null?void 0:O[0])||"")).toUpperCase()||"ST";let H=B.formUrl;H.includes("/edit")&&(H=H.replace("/edit","/copy"));const W=new URLSearchParams;j&&j!=="ST"&&W.append("title",`${j} - ${B.title}`),K&&W.append("student",K),R.length>0&&W.append("responders",R.join(", "));const X=H.includes("?")?"&":"?",re=W.toString()?`${H}${X}${W.toString()}`:H;window.open(re,"_blank","noopener"),l.value=`Form opened for ${F}. Student: ${j} - ${K}`,c.value="success",u.value={message:`Form opened successfully for ${j} - ${K}`,sent:R.length,failed:0,formUrl:re,studentInitials:j,studentName:K},_(B,m.value,re)}catch(B){console.error("Error opening form:",B),l.value="Failed to open form. Please try again.",c.value="error"}finally{o.value=!1}},_=(C,T,D=null)=>{const V=JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]"),B={id:`${C.id}_${r.student.id}_${Date.now()}`,formId:C.id,formTitle:C.title,formUrl:D||C.formUrl,sheetUrl:null,studentId:r.student.id,studentName:`${r.student.firstName} ${r.student.lastName}`,caseManagerId:r.currentUser.uid,caseManagerName:r.currentUser.name||r.currentUser.email,teachers:T.map(F=>({id:F.id,name:F.name,email:F.email})),sentAt:new Date().toISOString(),method:"gmail"},R=V.findIndex(F=>F.id===B.id);R!==-1?V[R]=B:V.push(B),localStorage.setItem("casemanage_sent_forms",JSON.stringify(V))},A=()=>{n("close")};return Ut(()=>{p.value="",m.value=[],l.value="",a()}),Vt(E,C=>{C&&C.length>0&&m.value.length===0&&(m.value=[...C])},{immediate:!0}),(C,T)=>{var D,V,B,R;return N(),L("div",{class:"modal-overlay",onClick:A},[d("div",{class:"modal-content",onClick:T[3]||(T[3]=dn(()=>{},["stop"]))},[d("div",{class:"modal-header"},[T[4]||(T[4]=d("h3",null,"Send Teacher Feedback Form",-1)),d("button",{onClick:A,class:"close-btn"},"×")]),d("div",MV,[d("div",LV,[d("h4",null,J(t.student.firstName)+" "+J(t.student.lastName)+" (Grade "+J(t.student.grade)+")",1),d("p",BV,"Case Manager: "+J(((D=t.currentUser)==null?void 0:D.name)||((V=t.currentUser)==null?void 0:V.email)),1)]),d("div",UV,[T[6]||(T[6]=d("label",null,"Select Feedback Form to Send:",-1)),v.value.length===0?(N(),L("div",$V,T[5]||(T[5]=[d("p",null,"No feedback forms available. Forms must be created in the Admin Panel first.",-1),d("p",null,[d("em",null,"Contact your administrator to create feedback forms.")],-1)]))):(N(),L("div",VV,[(N(!0),L(Re,null,Ve(v.value,F=>(N(),L("div",{key:F.id,class:"form-option"},[we(d("input",{type:"radio",id:F.id,value:F.id,"onUpdate:modelValue":T[0]||(T[0]=M=>p.value=M)},null,8,HV),[[fa,p.value]]),d("label",{for:F.id,class:"form-option-label"},[d("div",GV,J(F.title),1),d("div",WV,[F.description?(N(),L("span",zV,J(F.description),1)):_e("",!0),d("span",KV,"Created: "+J(k(F.createdAt)),1)])],8,jV)]))),128))]))]),p.value?(N(),L("div",qV,[d("div",XV,[T[7]||(T[7]=d("label",null,"Select Teachers to Send Form To:",-1)),d("div",YV,[E.value.length>0?(N(),L("button",{key:0,onClick:w,type:"button",class:"btn-select-all"}," Select All ")):_e("",!0),m.value.length>0?(N(),L("button",{key:1,onClick:x,type:"button",class:"btn-copy-emails",title:h.value}," 📋 Copy Emails ",8,QV)):_e("",!0)])]),d("div",JV,[E.value.length===0?(N(),L("div",ZV,T[8]||(T[8]=[d("p",null,"No teachers found for this student's schedule.",-1)]))):(N(),L("div",eH,[(N(!0),L(Re,null,Ve(E.value,F=>(N(),L("div",{key:F.id,class:"checkbox-item"},[we(d("input",{type:"checkbox",id:`teacher-${F.id}`,value:F,"onUpdate:modelValue":T[1]||(T[1]=M=>m.value=M)},null,8,tH),[[_t,m.value]]),d("label",{for:`teacher-${F.id}`},[Ne(J(F.name||F.email)+" ",1),d("span",nH,"("+J(F.email)+")",1)],8,rH)]))),128))]))]),m.value.length>0?(N(),L("div",sH,[T[9]||(T[9]=d("p",null,[d("strong",null,"Selected teacher emails:")],-1)),d("div",aH,J(m.value.map(F=>F.email).join(", ")),1)])):_e("",!0)])):_e("",!0),p.value&&m.value.length>0&&((B=g.value)!=null&&B.sheetTemplateUrl)?(N(),L("div",iH,[T[11]||(T[11]=d("label",null,"Response Collection:",-1)),d("div",oH,[d("div",lH,[we(d("input",{type:"checkbox",id:"duplicate-sheet","onUpdate:modelValue":T[2]||(T[2]=F=>f.value=F)},null,512),[[_t,f.value]]),T[10]||(T[10]=d("label",{for:"duplicate-sheet"},[d("strong",null,"Duplicate custom sheet"),d("span",{class:"option-description"},"Create a copy of the response template sheet in your Google Drive")],-1))])])])):_e("",!0),p.value&&y.value.length>0?(N(),L("div",cH,[T[12]||(T[12]=d("label",null,"Previous Sends for this Student:",-1)),d("div",uH,[(N(!0),L(Re,null,Ve(y.value,F=>(N(),L("div",{key:F.id,class:"history-item"},[d("div",dH,[d("span",fH,J(P(F.sentAt)),1),d("span",hH,J((F.teacherEmails||[]).length)+" teacher"+J((F.teacherEmails||[]).length===1?"":"s"),1),F.successful>0?(N(),L("span",pH,"✅ "+J(F.successful)+" sent",1)):_e("",!0),F.failed>0?(N(),L("span",mH,"❌ "+J(F.failed)+" failed",1)):_e("",!0)]),F.formUrl||F.sheetUrl?(N(),L("div",gH,[F.formUrl?(N(),L("a",{key:0,href:F.formUrl,target:"_blank",class:"history-link"},"📝 Form",8,vH)):_e("",!0),F.sheetUrl?(N(),L("a",{key:1,href:F.sheetUrl,target:"_blank",class:"history-link"},"📊 Sheet",8,xH)):_e("",!0)])):_e("",!0)]))),128))])])):_e("",!0),l.value?(N(),L("div",{key:3,class:Qe(`status-message ${c.value}`)},[Ne(J(l.value)+" ",1),c.value==="success"&&u.value?(N(),L("div",yH,[d("div",EH,[T[16]||(T[16]=d("h5",null,"✅ Form Opened Successfully!",-1)),d("p",_H,[d("strong",null,J(u.value.message),1)]),d("div",bH,[d("p",null,[T[13]||(T[13]=Ne(" 📝 Form opened for ")),d("strong",null,J(u.value.sent),1),Ne(" teacher"+J(u.value.sent===1?"":"s"),1)]),u.value.studentInitials?(N(),L("p",SH,[T[14]||(T[14]=Ne(" 👤 Student: ")),d("strong",null,J(u.value.studentInitials),1),Ne(" - "+J(u.value.studentName),1)])):_e("",!0),d("p",AH,[T[15]||(T[15]=Ne(" 🔗 Form Link: ")),d("a",{href:u.value.formUrl,target:"_blank"},J((R=g.value)==null?void 0:R.title),9,TH)])])])])):_e("",!0)],2)):_e("",!0)]),d("div",wH,[d("button",{onClick:A,class:"secondary-btn"},"Cancel"),d("button",{onClick:S,class:"primary-btn",disabled:!b.value||o.value},[o.value?(N(),L("span",IH,"Creating Form...")):(N(),L("span",kH,"📝 Create New Form"))],8,CH)])])])}}},PH=yt(DH,[["__scopeId","data-v-f8c1ccfe"]]),RH={class:"students-view"},FH={class:"page-header"},NH={class:"header-left"},OH={class:"search-container"},MH={class:"header-controls"},LH={class:"filter-group"},BH={key:1,class:"filter-group"},UH={class:"radio-group"},$H=["value"],VH={class:"filter-group"},HH={class:"radio-group"},jH=["checked"],GH=["checked","disabled"],WH=["checked"],zH={key:0,class:"filters-panel"},KH={class:"filters-content"},qH={class:"filter-group"},XH=["value"],YH={class:"filter-group"},QH=["value"],JH={class:"filter-group"},ZH=["value"],ej={class:"filter-group"},tj={class:"content"},rj={key:0},nj={key:1,class:"view-container"},sj={key:0,class:"group-section"},aj={class:"group-header"},ij={key:2,class:"view-section"},oj={__name:"StudentsView",setup(t){const e=VB(),r=jB(e),n=QB(e,r),s=e7(e),{students:i,userMapObj:a,caseManagers:o,teacherList:l,userRoles:c,aideAssignment:u,paraeducators:f,currentUser:h,isAdmin:p,showProviderView:m,getStudentById:v}=e,{showFilters:g,currentFilters:y,toggleFilters:E,clearFilters:b,applyFilters:k,debouncedApplyFilters:P}=r,{visibleStudents:w,canEditAllStudents:x,canEditOwnStudents:S,canViewAllStudents:_,canAccessTesting:A,canAccessTestingPartial:C,canAccessFilters:T,isClassViewDisabled:D,setViewMode:V,providerViewOptions:B}=n,R=ZB(e,r,Se(()=>n.visibleStudents.value)),{currentViewMode:F,studentsByClass:M,directAssignmentStudents:O,testingViewStudents:K}=R,{editingStudentId:j,emailingStudentId:H,showExport:W,showAddStudent:X,showFeedbackDialog:re,feedbackStudentId:he,editStudent:ue,emailStudent:pe,handleTeacherFeedback:q,handleFormSent:G,handleStudentAdded:oe,handleStudentSaved:Q,handleNavAction:Y}=s;return Se(()=>{var ne;return B!=null&&B.value?B.value:((ne=h.value)==null?void 0:ne.role)==="case_manager"?[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]}),(Z,ne)=>{var ge,ae,ce;return N(),L("div",RH,[nt(m7,{"current-user":ee(h),"is-admin":ee(p),onAction:ee(Y)},null,8,["current-user","is-admin","onAction"]),d("div",FH,[d("div",NH,[ne[24]||(ne[24]=d("h1",null,"Student Management",-1)),d("div",OH,[we(d("input",{type:"text","onUpdate:modelValue":ne[0]||(ne[0]=fe=>ee(y).search=fe),onInput:ne[1]||(ne[1]=(...fe)=>ee(P)&&ee(P)(...fe)),placeholder:"Search students...",class:"search-input"},null,544),[[Ye,ee(y).search]])])]),d("div",MH,[ee(T)?(N(),L("button",{key:0,onClick:ne[2]||(ne[2]=(...fe)=>ee(E)&&ee(E)(...fe)),class:Qe(["filter-toggle-btn",{active:ee(g)}])},ne[25]||(ne[25]=[d("span",null,"🔍",-1),Ne(" Filters ")]),2)):_e("",!0),d("div",LH,[we(d("select",{"onUpdate:modelValue":ne[3]||(ne[3]=fe=>ee(y).sortBy=fe),onChange:ne[4]||(ne[4]=fe=>ee(k)()),class:"sort-select"},ne[26]||(ne[26]=[Fr('<option value="firstName" data-v-b18ef4f7>First Name</option><option value="lastName" data-v-b18ef4f7>Last Name</option><option value="grade" data-v-b18ef4f7>Grade</option><option value="reviewDate" data-v-b18ef4f7>Review Date</option><option value="reevalDate" data-v-b18ef4f7>Re-evaluation Date</option><option value="meetingDate" data-v-b18ef4f7>Meeting Date</option>',6)]),544),[[ur,ee(y).sortBy]])]),ee(B)&&ee(B).length?(N(),L("div",BH,[d("div",UH,[(N(!0),L(Re,null,Ve(ee(B),fe=>(N(),L("label",{key:fe.value,class:Qe(["radio-btn",{active:ee(y).providerView===fe.value}])},[we(d("input",{type:"radio","onUpdate:modelValue":ne[5]||(ne[5]=Ae=>ee(y).providerView=Ae),value:fe.value,onChange:ne[6]||(ne[6]=(...Ae)=>ee(k)&&ee(k)(...Ae))},null,40,$H),[[fa,ee(y).providerView]]),Ne(" "+J(fe.label),1)],2))),128))])])):_e("",!0),d("div",VH,[d("div",HH,[d("label",{class:Qe(["radio-btn",{active:ee(y).viewMode==="list"}])},[d("input",{type:"radio",value:"list",checked:ee(y).viewMode==="list",onChange:ne[7]||(ne[7]=fe=>ee(V)("list"))},null,40,jH),ne[27]||(ne[27]=Ne(" List "))],2),d("label",{class:Qe(["radio-btn",{active:ee(y).viewMode==="class",disabled:ee(D)}])},[d("input",{type:"radio",value:"class",checked:ee(y).viewMode==="class",onChange:ne[8]||(ne[8]=fe=>ee(V)("class")),disabled:ee(D)},null,40,GH),d("span",{class:Qe({strikethrough:ee(D)})},"Class",2)],2),ee(A)?(N(),L("label",{key:0,class:Qe(["radio-btn",{active:ee(y).viewMode==="testing"}])},[d("input",{type:"radio",value:"testing",checked:ee(y).viewMode==="testing",onChange:ne[9]||(ne[9]=fe=>ee(V)("testing"))},null,40,WH),ne[28]||(ne[28]=Ne(" SS-Testing "))],2)):_e("",!0)])]),d("button",{onClick:ne[10]||(ne[10]=(...fe)=>ee(b)&&ee(b)(...fe)),class:"reset-btn",title:"Reset all filters"}," 🔄 ")])]),ee(g)?(N(),L("div",zH,[d("div",KH,[d("div",qH,[ne[30]||(ne[30]=d("label",null,"Case Manager",-1)),we(d("select",{"onUpdate:modelValue":ne[11]||(ne[11]=fe=>ee(y).cm=fe),onChange:ne[12]||(ne[12]=fe=>ee(k)()),class:"filter-select"},[ne[29]||(ne[29]=d("option",{value:"all"},"All Case Managers",-1)),(N(!0),L(Re,null,Ve(ee(o),fe=>(N(),L("option",{key:fe.id,value:fe.id},J(fe.name||fe.email||fe.id),9,XH))),128))],544),[[ur,ee(y).cm]])]),d("div",YH,[ne[32]||(ne[32]=d("label",null,"Teacher",-1)),we(d("select",{"onUpdate:modelValue":ne[13]||(ne[13]=fe=>ee(y).teacher=fe),onChange:ne[14]||(ne[14]=fe=>ee(k)()),class:"filter-select"},[ne[31]||(ne[31]=d("option",{value:"all"},"All Teachers",-1)),(N(!0),L(Re,null,Ve(ee(l),fe=>(N(),L("option",{key:fe.id,value:fe.id},J(fe.name||fe.email||fe.id),9,QH))),128))],544),[[ur,ee(y).teacher]])]),d("div",JH,[ne[34]||(ne[34]=d("label",null,"Paraeducator",-1)),we(d("select",{"onUpdate:modelValue":ne[15]||(ne[15]=fe=>ee(y).paraeducator=fe),onChange:ne[16]||(ne[16]=fe=>ee(k)()),class:"filter-select"},[ne[33]||(ne[33]=d("option",{value:"all"},"All Paraeducators",-1)),(N(!0),L(Re,null,Ve(ee(f),fe=>(N(),L("option",{key:fe.id,value:fe.id},J(fe.name||fe.email||fe.id),9,ZH))),128))],544),[[ur,ee(y).paraeducator]])]),d("div",ej,[ne[36]||(ne[36]=d("label",null,"Plan Type",-1)),we(d("select",{"onUpdate:modelValue":ne[17]||(ne[17]=fe=>ee(y).plan=fe),onChange:ne[18]||(ne[18]=fe=>ee(k)()),class:"filter-select"},ne[35]||(ne[35]=[d("option",{value:"all"},"All Plans",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),544),[[ur,ee(y).plan]])])])])):_e("",!0),d("div",tj,[ee(F)==="list"?(N(),L("div",rj,[nt(Hf,{students:ee(w),"user-map":ee(a),"current-user":ee(h),"student-data":ee(e),"can-edit-all":ee(x),"can-edit-own":ee(S),"can-view-all":ee(_),"can-access-testing":ee(A),"can-access-testing-partial":ee(C),"aide-schedule":((ge=ee(h))==null?void 0:ge.role)==="paraeducator"?ee(u):{},onEdit:ee(ue),onEmail:ee(pe),onTeacherFeedback:ee(q)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):ee(F)==="class"?(N(),L("div",nj,[ee(O).length>0?(N(),L("div",sj,[ne[37]||(ne[37]=d("h3",{class:"group-header direct-assignment-header"},"Direct Assignment",-1)),nt(Hf,{students:ee(O),"user-map":ee(a),"current-user":ee(h),"student-data":ee(e),"can-edit-all":ee(x),"can-edit-own":ee(S),"can-view-all":ee(_),"can-access-testing":ee(A),"can-access-testing-partial":ee(C),"aide-schedule":((ae=ee(h))==null?void 0:ae.role)==="paraeducator"?ee(u):{},onEdit:ee(ue),onEmail:ee(pe),onTeacherFeedback:ee(q)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):_e("",!0),(N(!0),L(Re,null,Ve(ee(M),(fe,Ae)=>{var Ie;return N(),L("div",{key:Ae,class:"group-section"},[d("h3",aj,"Period "+J(Ae),1),nt(Hf,{students:fe,"user-map":ee(a),"current-user":ee(h),"student-data":ee(e),"can-edit-all":ee(x),"can-edit-own":ee(S),"can-view-all":ee(_),"can-access-testing":ee(A),"can-access-testing-partial":ee(C),"aide-schedule":((Ie=ee(h))==null?void 0:Ie.role)==="paraeducator"?ee(u):{},onEdit:ee(ue),onEmail:ee(pe),onTeacherFeedback:ee(q)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])}),128))])):ee(F)==="testing"?(N(),L("div",ij,[nt(Hf,{students:ee(K),"user-map":ee(a),"current-user":ee(h),"student-data":ee(e),"can-edit-all":ee(x),"can-edit-own":ee(S),"can-view-all":ee(_),"can-access-testing":ee(A),"can-access-testing-partial":ee(C),"testing-view":!0,"aide-schedule":((ce=ee(h))==null?void 0:ce.role)==="paraeducator"?ee(u):{},onEdit:ee(ue),onEmail:ee(pe),onTeacherFeedback:ee(q)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):_e("",!0)]),ee(j)?(N(),Kr(dV,{key:1,"student-id":ee(j),users:{userRoles:ee(c)},onClose:ne[19]||(ne[19]=fe=>j.value=null),onSaved:ee(Q)},null,8,["student-id","users","onSaved"])):_e("",!0),ee(H)?(N(),Kr(SV,{key:2,student:ee(v)(ee(H)),"user-map":ee(a),onClose:ne[20]||(ne[20]=fe=>H.value=null)},null,8,["student","user-map"])):_e("",!0),ee(W)?(N(),Kr(OV,{key:3,students:ee(i),"user-map":ee(a),onClose:ne[21]||(ne[21]=fe=>W.value=!1)},null,8,["students","user-map"])):_e("",!0),ee(X)?(N(),Kr(Bx,{key:4,users:{userRoles:ee(c)},onClose:ne[22]||(ne[22]=fe=>X.value=!1),onSaved:ee(oe)},null,8,["users","onSaved"])):_e("",!0),ee(re)?(N(),Kr(PH,{key:5,student:ee(v)(ee(he)),"current-user":ee(h),"user-map":ee(a),onClose:ne[23]||(ne[23]=fe=>re.value=!1),onFormSent:ee(G)},null,8,["student","current-user","user-map","onFormSent"])):_e("",!0)])}}},lj=yt(oj,[["__scopeId","data-v-b18ef4f7"]]),cj={class:"login-container"},uj={__name:"LoginView",setup(t){const e=wi(),r=async()=>{try{const{user:n}=await N1(St,A4),s=Ze(ze,"users",n.uid);(await Jt(s)).exists()||await Ht(s,{name:n.displayName||"",email:n.email,role:"admin"}),e.push({name:"Home"})}catch(n){console.error("Login failed:",n),alert("Login failed: "+n.message)}};return(n,s)=>(N(),L("div",cj,[s[0]||(s[0]=d("h1",null,"Case Manager Portal",-1)),s[1]||(s[1]=d("p",null,"Please sign in with your Google account:",-1)),d("button",{onClick:r,class:"primary-btn"}," Sign in with Google ")]))}},dj=yt(uj,[["__scopeId","data-v-d9b5a53b"]]),fj={name:"TabBar",props:{tabs:{type:Array,required:!0,default:()=>[]},activeTab:{type:String,required:!0}},emits:["tab-change"],methods:{getStatusIcon(t){switch(t){case"not-active":return"⭐";case"not-working":return"❌";default:return""}},getStatusTooltip(t){switch(t){case"not-active":return"⭐ = Not active";case"not-working":return"❌ = Not working";default:return""}}}},hj={class:"admin-tab-bar"},pj=["onClick","title"];function mj(t,e,r,n,s,i){return N(),L("div",hj,[(N(!0),L(Re,null,Ve(r.tabs,a=>(N(),L("button",{key:a.key,class:Qe({active:r.activeTab===a.key}),onClick:o=>t.$emit("tab-change",a.key),title:i.getStatusTooltip(a.status)},[Ne(J(a.label)+" ",1),a.status?(N(),L("span",{key:0,class:Qe(["status-indicator",a.status])},J(i.getStatusIcon(a.status)),3)):_e("",!0)],10,pj))),128))])}const gj=yt(fj,[["render",mj],["__scopeId","data-v-5be36c07"]]),vj={name:"UserAddForm",setup(){const t=Ca(S4,"addUserWithRole"),e=vo(),r=Rs({name:"",email:"",role:"",provider:"",aeriesId:""}),n=se(null),s=se(""),i=se(!1),a=se(null),o=lc,{appSettings:l,loadAppSettings:c}=zs(),u=Se(()=>{if(l&&l.value&&l.value.serviceProviders){const b=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}];return l.value.serviceProviders.map(k=>b.find(P=>P.abbreviation===k)||{name:k,abbreviation:k})}return[]}),f=(b,k=!1)=>{s.value=b,i.value=k,setTimeout(()=>{s.value="",i.value=!1},5e3)},h=async(b,k,P,w,x)=>{try{const S={name:b,email:k,role:P,provider:w,aeriesId:x,createdAt:new Date,status:"active"},_=await QC(bt(e,"users"),S);return await tn.logUserManagement(_.id,"create",{userData:{name:b,email:k,role:P,provider:w,aeriesId:x},method:"firestore_direct"}),{success:!0,userId:_.id}}catch(S){throw await tn.logUserManagement("unknown","create_failed",{error:S.message,attemptedData:{name:b,email:k,role:P,provider:w,aeriesId:x},method:"firestore_direct"}),S}},p=async(b,k,P,w,x)=>{var S,_;try{try{return await t({name:b,email:k,role:P,provider:w,aeriesId:x}),await tn.logUserManagement("cloud_function_user","create",{userData:{name:b,email:k,role:P,provider:w,aeriesId:x},method:"cloud_function"}),{success:!0,method:"cloud-function"}}catch(A){return A.code==="functions/already-exists"||(S=A.message)!=null&&S.includes("409")||(_=A.message)!=null&&_.includes("already exists")?(console.log(`User ${k} already exists in Firebase Auth, skipping...`),await tn.logUserManagement("existing_user","create_skipped",{userData:{name:b,email:k,role:P,provider:w,aeriesId:x},reason:"user_already_exists",method:"cloud_function"}),{success:!0,method:"already-exists",message:"User already exists"}):(await h(b,k,P,w,x),{success:!0,method:"firestore"})}}catch(A){return await tn.logUserManagement("unknown","create_failed",{error:A.message,attemptedData:{name:b,email:k,role:P,provider:w,aeriesId:x},method:"addUserToFirestore"}),{success:!1,error:A.message}}},m=async()=>{if(!Is("addUser",5,6e4).allowed){f("Too many requests. Please wait before adding another user.",!0);return}const k=PB(r),P=DB(k);if(!P.isValid){f(`Please fix the following errors:
${P.errors.join(`
`)}`,!0);return}const w=["name","email","aeriesId"];for(const S of w)if(k[S]){const _=qr(k[S]);if(!_.isSafe){f(`Security threat detected in ${S}: ${_.threats.join(", ")}`,!0);return}}Object.assign(r,k);const x=await p(r.name,r.email,r.role,r.provider,r.aeriesId);x.success?(f(`User ${r.name} added successfully!`),r.name="",r.email="",r.role="",r.provider="",r.aeriesId=""):f(`Error adding user: ${x.error}`,!0)},v=b=>{const k=b.target.files[0];if(k){const P=Vc(k,{allowedTypes:["csv","excel"],maxSize:5242880,fieldName:"User Import File"});if(!P.isValid){f(P.error,!0),b.target.value="";return}const w=qr(k.name);if(!w.isSafe){f(`File name contains potentially dangerous content: ${w.threats.join(", ")}`,!0),b.target.value="";return}n.value=k}},g=async()=>{if(!n.value){f("Please select a file first",!0);return}const b=n.value.name.toLowerCase();if(!(b.endsWith(".csv")||b.endsWith(".xls")||b.endsWith(".xlsx"))){f("Unsupported file type. Please upload a .csv, .xls, or .xlsx file.",!0);return}f("Processing file...");try{b.endsWith(".csv")?await y(n.value):await E(n.value)}catch(k){f(`Error processing file: ${k.message}`,!0),console.error("Bulk upload error:",k)}},y=async b=>new Promise((k,P)=>{const w=new FileReader;w.onload=async x=>{try{const _=x.target.result.trim().split(/\r?\n/);if(_.length===0){P(new Error("The CSV file is empty."));return}const A=M=>{const O=[];let K="",j=!1;for(let H=0;H<M.length;H++){const W=M[H];W==='"'?j=!j:W===","&&!j?(O.push(K.trim()),K=""):K+=W}return O.push(K.trim()),O};let C=0;const T={name:0,email:1,role:2,provider:3,aeriesId:4},D=A(_[0]);D.map(M=>M.toLowerCase()).some(M=>M.includes("name")||M.includes("email")||M.includes("role"))&&(D.forEach((M,O)=>{const K=M.trim().toLowerCase();(K==="name"||K==="displayname")&&(T.name=O),K==="email"&&(T.email=O),K==="role"&&(T.role=O),(K==="provider"||K==="providertype")&&(T.provider=O),(K==="aeriesid"||K==="aeries_id"||K==="teacherid")&&(T.aeriesId=O)}),C=1);let B=0;const R=[];for(let M=C;M<_.length;M++){const O=_[M].trim();if(!O)continue;const K=A(O),j=(K[T.name]||"").trim(),H=(K[T.email]||"").trim(),W=(K[T.role]||"").trim(),X=(K[T.provider]||"").trim(),re=(K[T.aeriesId]||"").trim(),he=j.replace(/^"|"$/g,""),ue=H.replace(/^"|"$/g,""),pe=W.replace(/^"|"$/g,""),q=X.replace(/^"|"$/g,""),G=re.replace(/^"|"$/g,"");if(!he||!ue||!pe){R.push(`Line ${M+1}: Missing name, email, or role.`);continue}if(!Eb(pe)){R.push(`Line ${M+1}: Invalid role "${pe}".`);continue}const oe=await p(he,ue,pe,q,G);oe.success?(B++,oe.method==="already-exists"&&console.log(`Line ${M+1}: User ${ue} already exists, skipped`)):R.push(`Line ${M+1}: ${oe.error}`)}let F=`${B} users added successfully.`;R.length>0&&(F+=`
${R.length} errors:
`+R.join(`
`)),f(F,R.length>0),n.value=null,a.value&&(a.value.value=""),k()}catch(S){P(new Error(`Error processing CSV file: ${S.message}`))}},w.onerror=()=>P(new Error("Failed to read the CSV file.")),w.readAsText(b)}),E=async b=>new Promise((k,P)=>{const w=new FileReader;w.onload=async x=>{try{if(typeof XLSX>"u"){P(new Error("Excel upload requires SheetJS (XLSX) library. Please include it in your page."));return}const S=new Uint8Array(x.target.result),_=XLSX.read(S,{type:"array"}),A=_.SheetNames[0],C=_.Sheets[A],T=XLSX.utils.sheet_to_json(C,{defval:""});if(T.length===0){P(new Error("The Excel file is empty or unrecognized."));return}let D=0;const V=[];for(let R=0;R<T.length;R++){const F=T[R];let M="",O="",K="",j="",H="";for(const re in F){const he=re.toLowerCase(),ue=(""+F[re]).trim();(he==="name"||he==="displayname")&&!M?M=ue:he==="email"&&!O?O=ue:he==="role"&&!K?K=ue:(he==="provider"||he==="providertype")&&!j?j=ue:(he==="aeriesid"||he==="aeries_id"||he==="teacherid")&&!H&&(H=ue)}const W=Object.values(F).map(re=>(""+re).trim());if(!M&&W[0]&&(M=W[0]),!O&&W[1]&&(O=W[1]),!K&&W[2]&&(K=W[2]),!j&&W[3]&&(j=W[3]),!H&&W[4]&&(H=W[4]),!M||!O||!K){V.push(`Row ${R+1}: Missing name, email, or role.`);continue}if(!Eb(K)){V.push(`Row ${R+1}: Invalid role "${K}".`);continue}const X=await p(M,O,K,j,H);X.success?(D++,X.method==="already-exists"&&console.log(`Row ${R+1}: User ${O} already exists, skipped`)):V.push(`Row ${R+1}: ${X.error}`)}let B=`${D} users added successfully.`;V.length>0&&(B+=`
${V.length} errors:
`+V.join(`
`)),f(B,V.length>0),n.value=null,a.value&&(a.value.value=""),k()}catch(S){P(new Error(`Error processing Excel file: ${S.message}`))}},w.onerror=()=>P(new Error("Failed to read the Excel file.")),w.readAsArrayBuffer(b)});return Ut(async()=>{await c()}),{singleUser:r,validRoles:o,providerOptions:u,addSingleUser:m,selectedFile:n,statusMessage:s,isError:i,bulkFileInput:a,handleFileSelect:v,uploadBulkUsers:g,appSettings:l}}},xj={class:"add-user-wrapper"},yj={class:"add-single"},Ej=["value"],_j={key:0},bj=["value"],Sj={class:"add-bulk"},Aj=["disabled"];function Tj(t,e,r,n,s,i){return N(),L("div",xj,[d("div",yj,[e[16]||(e[16]=d("h3",null,"Add Single User",-1)),d("form",{onSubmit:e[5]||(e[5]=dn((...a)=>n.addSingleUser&&n.addSingleUser(...a),["prevent"])),class:"form-grid"},[d("div",null,[d("label",null,[e[8]||(e[8]=Ne(" Name: ")),we(d("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>n.singleUser.name=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[Ye,n.singleUser.name]])])]),d("div",null,[d("label",null,[e[9]||(e[9]=Ne(" Email: ")),we(d("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>n.singleUser.email=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[Ye,n.singleUser.email]])])]),d("div",null,[d("label",null,[e[11]||(e[11]=Ne(" Role: ")),we(d("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.singleUser.role=a),required:""},[e[10]||(e[10]=d("option",{value:"",disabled:""},"Select role...",-1)),(N(!0),L(Re,null,Ve(n.validRoles,a=>(N(),L("option",{key:a,value:a},J(a),9,Ej))),128))],512),[[ur,n.singleUser.role]])])]),n.providerOptions.length>0?(N(),L("div",_j,[d("label",null,[e[13]||(e[13]=Ne(" Provider Type: ")),we(d("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>n.singleUser.provider=a)},[e[12]||(e[12]=d("option",{value:""},"None",-1)),(N(!0),L(Re,null,Ve(n.providerOptions,a=>(N(),L("option",{key:a.abbreviation,value:a.abbreviation},J(a.name)+" ("+J(a.abbreviation)+") ",9,bj))),128))],512),[[ur,n.singleUser.provider]])])])):_e("",!0),d("div",null,[d("label",null,[e[14]||(e[14]=Ne(" Aeries ID: ")),we(d("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=a=>n.singleUser.aeriesId=a),placeholder:"Optional Aeries Teacher ID"},null,512),[[Ye,n.singleUser.aeriesId]])])]),e[15]||(e[15]=d("button",{type:"submit"},"Add User",-1))],32)]),d("div",Sj,[e[17]||(e[17]=d("h3",null,"Bulk Upload Users",-1)),d("div",null,[d("input",{type:"file",ref:"bulkFileInput",accept:".csv, .xls, .xlsx",onChange:e[6]||(e[6]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[7]||(e[7]=(...a)=>n.uploadBulkUsers&&n.uploadBulkUsers(...a)),disabled:!n.selectedFile}," Upload Users ",8,Aj)]),e[18]||(e[18]=Fr(`<h4 data-v-9f1e8c9c>Example Formatting</h4><div data-v-9f1e8c9c>File needs to be in .csv, .xls, .xlsx format, like an Excel spreadsheet.</div><div class="example-format" data-v-9f1e8c9c><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>CSV Format:</strong></p><pre data-v-9f1e8c9c>Name,Email,Role,Provider,AeriesID
&quot;John Smith&quot;,&quot;john.smith@school.org&quot;,&quot;teacher&quot;,&quot;&quot;,&quot;123456&quot;
&quot;Jane Doe&quot;,&quot;jane.doe@school.org&quot;,&quot;service_provider&quot;,&quot;SLP&quot;,&quot;789012&quot;
&quot;Bob Johnson&quot;,&quot;bob.johnson@school.org&quot;,&quot;case_manager&quot;,&quot;&quot;,&quot;&quot;</pre><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>Supported Roles:</strong> admin, teacher, case_manager, sped_chair, service_provider</p><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>Provider Types:</strong> SLP, OT, PT, SC, MH, TR, AUD, VI, AT, DHH, O&amp;M, BIS, HN, SW</p><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>Aeries ID:</strong> Optional 6-digit teacher ID from Aeries system</p></div>`,3))]),n.statusMessage?(N(),L("div",{key:0,class:Qe(["status-msg",{error:n.isError}])},J(n.statusMessage),3)):_e("",!0)])}const wj=yt(vj,[["render",Tj],["__scopeId","data-v-9f1e8c9c"]]),Pl=se(null);function nf(){const t=new Promise(e=>{const r=tp(St,async n=>{if(n)try{const s=Ze(ze,"users",n.uid),i=await Jt(s);i.exists()?Pl.value={uid:n.uid,email:n.email,displayName:n.displayName,...i.data()}:(console.warn(`User ${n.uid} exists in Auth but not in users collection`),Pl.value={uid:n.uid,email:n.email,displayName:n.displayName,role:null})}catch(s){console.error("Error fetching user document:",s),Pl.value={uid:n.uid,email:n.email,displayName:n.displayName,role:null}}else Pl.value=null;e(Pl.value),r()})});return{currentUser:Pl,waitForAuthInit:t}}const Xa=se({}),jf=se(!1),tg=se(!1);function q4(){const{currentUser:t}=nf(),e=async()=>{if(jf.value||tg.value)return Xa.value;jf.value=!0;try{const a=Ze(ze,"app_settings","admin_panel_permissions"),o=await Jt(a);return o.exists()?Xa.value=o.data():Xa.value={},tg.value=!0,Xa.value}catch(a){return console.error("Error loading admin panel permissions:",a),Xa.value={},Xa.value}finally{jf.value=!1}},r=Se(()=>a=>{var l,c;if(!((l=t.value)!=null&&l.role)||!Xa.value[a])return!1;const o=t.value.role;return o==="admin"?!0:((c=Xa.value[a])==null?void 0:c[o])===!0}),n=Se(()=>r.value("delete-all-users")),s=Se(()=>r.value("delete-all-students"));return{permissions:Xa,isLoading:jf,hasPermission:r,canDeleteAllUsers:n,canDeleteAllStudents:s,loadPermissions:e,initializeIfNeeded:async()=>{tg.value||await e()}}}const cu=20,Cj={name:"UserTable",setup(){const t=vo(),e=se([]),r=se(1),n=se("name"),s=se(""),i=se(null),a=se(""),o=se(!1),l=se(!1),c=se([]),u=se(null),f=lc,h=zs(),p=h.appSettings,m=h.loadAppSettings,{canDeleteAllUsers:v,initializeIfNeeded:g}=q4();let y=null;const E=()=>{y&&clearTimeout(y),y=setTimeout(()=>{w()},300)},b=Se(()=>{var F;return Array.isArray((F=p.value)==null?void 0:F.serviceProviders)&&p.value.serviceProviders.length>0}),k=Se(()=>{var F;return((F=p.value)==null?void 0:F.serviceProviders)||[]}),P=(F,M=!1)=>{a.value=F,o.value=M,F&&setTimeout(()=>{a.value="",o.value=!1},5e3)},w=()=>{r.value=1,x()},x=async(F="first")=>{const M=bt(t,"users");let O;if(s.value&&n.value==="name"){const H=(await $t(nr(M,Gr("name"),Ts(1e3)))).docs.map(W=>({id:W.id,...W.data()})).filter(W=>(W.name||"").toLowerCase().includes(s.value.toLowerCase()));i.value=null,e.value=H,l.value=!1;return}s.value&&n.value==="email"?O=nr(M,Gr("email"),Rr("email",">=",s.value),Rr("email","<=",s.value+""),Ts(cu)):s.value?O=nr(M,Gr("name"),Rr("name",">=",s.value),Rr("name","<=",s.value+""),Ts(cu)):O=nr(M,Gr("name"),Ts(cu)),F==="next"&&c.value.length&&(O=nr(M,Gr(n.value),uh(c.value[c.value.length-1]),Ts(cu)));const K=await $t(O);c.value=K.docs,i.value=null,e.value=c.value.map(j=>({id:j.id,...j.data()})),l.value=K.size===cu},S=F=>{i.value||(i.value=F,u.value={...e.value.find(M=>M.id===F)})},_=()=>{i.value=null,u.value=null,x()},A=(F,M,O)=>{u.value&&u.value.id===F&&(u.value[M]=O)},C=async F=>{var M,O;if(!(!u.value||u.value.id!==F))try{const K=e.value.find(H=>H.id===F),j={};u.value.name!==void 0&&(j.name=((M=u.value.name)==null?void 0:M.trim())||null),u.value.title!==void 0&&(j.title=((O=u.value.title)==null?void 0:O.trim())||null),u.value.role!==void 0&&(j.role=u.value.role),u.value.provider!==void 0&&(j.provider=u.value.provider||null),await Cp(Ze(t,"users",F),j),await tn.logUserManagement(F,"update",{originalData:{name:K==null?void 0:K.name,title:K==null?void 0:K.title,role:K==null?void 0:K.role,provider:K==null?void 0:K.provider},updatedData:j,changedFields:Object.keys(j)}),P("✅ User updated."),i.value=null,u.value=null,x()}catch(K){console.error("Error updating user:",K),P(`❌ Error updating user: ${K.message}`,!0),await tn.logUserManagement(F,"update_failed",{error:K.message,attemptedData:updateData})}},T=async F=>{if(confirm("Are you sure you want to delete this user?"))try{const M=e.value.find(O=>O.id===F);await ho(Ze(t,"users",F)),await tn.logUserManagement(F,"delete",{deletedUser:{name:M==null?void 0:M.name,email:M==null?void 0:M.email,role:M==null?void 0:M.role,provider:M==null?void 0:M.provider}}),P("✅ User deleted."),i.value=null,u.value=null,x()}catch(M){console.error("Error deleting user:",M),P(`❌ Error deleting user: ${M.message}`,!0),await tn.logUserManagement(F,"delete_failed",{error:M.message})}},D=async()=>{if(prompt("Type DELETE ALL USERS to confirm:")==="DELETE ALL USERS")try{const M=await $t(bt(t,"users"));await Promise.all(M.docs.map(O=>ho(Ze(t,"users",O.id)))),P("✅ All users deleted."),r.value=1,x()}catch(M){console.error("Error deleting all users:",M),P(`❌ Error deleting all users: ${M.message}`,!0)}},V=()=>{r.value++,x("next")},B=()=>{r.value>1&&(r.value--,x())},R=F=>{var H;if(!F)return"";const O=(((H=p.value)==null?void 0:H.customServiceProviders)||[]).find(W=>W.abbreviation===F);if(O)return`${O.name} (${O.abbreviation})`;const j=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}].find(W=>W.abbreviation===F);return j?`${j.name} (${j.abbreviation})`:F};return Ut(async()=>{await m(),await g(),x()}),Ba(()=>{y&&clearTimeout(y)}),{users:e,currentPage:r,searchType:n,searchTerm:s,activeRowId:i,statusMessage:a,isError:o,hasNextPage:l,validRoles:f,handleSearch:w,debouncedHandleSearch:E,startEdit:S,cancelEdit:_,updateUserField:A,saveUser:C,deleteUser:T,deleteAllUsers:D,loadNextPage:V,loadPreviousPage:B,getProviderLabel:R,appSettings:p,editingUser:u,providersLoaded:b,serviceProviders:k,canDeleteAllUsers:v}}},Ij={class:"admin-form-row"},kj={class:"search-type-radios"},Dj={class:"user-admin-table striped"},Pj={key:0},Rj=["data-userid"],Fj=["value","disabled","onInput"],Nj=["value","disabled","onInput"],Oj=["disabled","value","onChange"],Mj=["value"],Lj={key:0},Bj={key:0},Uj={key:1},$j=["value","onChange"],Vj=["value"],Hj={key:1},jj={class:"admin-action-btns"},Gj=["onClick"],Wj=["onClick"],zj=["onClick"],Kj={class:"admin-pagination"},qj=["disabled"],Xj=["disabled"];function Yj(t,e,r,n,s,i){return N(),L("div",null,[e[16]||(e[16]=d("h2",null,"Edit Users",-1)),d("div",Ij,[we(d("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>n.searchTerm=a),placeholder:"Search by name or email",class:"admin-search-input",onInput:e[1]||(e[1]=(...a)=>n.debouncedHandleSearch&&n.debouncedHandleSearch(...a))},null,544),[[Ye,n.searchTerm]]),d("div",kj,[d("label",null,[we(d("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=a=>n.searchType=a),value:"name",onChange:e[3]||(e[3]=(...a)=>n.handleSearch&&n.handleSearch(...a))},null,544),[[fa,n.searchType]]),e[10]||(e[10]=Ne(" Name "))]),d("label",null,[we(d("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=a=>n.searchType=a),value:"email",onChange:e[5]||(e[5]=(...a)=>n.handleSearch&&n.handleSearch(...a))},null,544),[[fa,n.searchType]]),e[11]||(e[11]=Ne(" Email "))])]),n.canDeleteAllUsers?(N(),L("button",{key:0,onClick:e[6]||(e[6]=(...a)=>n.deleteAllUsers&&n.deleteAllUsers(...a)),class:"delete-all-btn"}," Delete All Users ")):_e("",!0)]),n.statusMessage?(N(),L("div",{key:0,class:Qe(["admin-status-msg",{error:n.isError}])},J(n.statusMessage),3)):_e("",!0),d("div",null,[d("table",Dj,[e[15]||(e[15]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Title"),d("th",null,"Email"),d("th",null,"Role"),d("th",null,"Provider Type"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[n.users.length===0?(N(),L("tr",Pj,e[12]||(e[12]=[d("td",{colspan:"5"},"No users found.",-1)]))):_e("",!0),(N(!0),L(Re,null,Ve(n.users,a=>(N(),L("tr",{key:a.id,class:Qe({"active-row":n.activeRowId===a.id}),"data-userid":a.id},[d("td",null,[d("input",{type:"text",value:a.name||"",class:"editable-input",disabled:n.activeRowId!==a.id,onInput:o=>n.updateUserField(a.id,"name",o.target.value)},null,40,Fj)]),d("td",null,[d("input",{type:"text",value:a.title||"",class:"editable-input",disabled:n.activeRowId!==a.id,onInput:o=>n.updateUserField(a.id,"title",o.target.value)},null,40,Nj)]),d("td",null,J(a.email),1),d("td",null,[d("select",{class:"editable-select",disabled:n.activeRowId!==a.id,value:n.activeRowId===a.id?n.editingUser.role:a.role,onChange:o=>n.updateUserField(a.id,"role",o.target.value)},[(N(!0),L(Re,null,Ve(n.validRoles,o=>(N(),L("option",{key:o,value:o},J(o.replace(/_/g," ")),9,Mj))),128))],40,Oj)]),n.providersLoaded?(N(),L("td",Lj,[n.activeRowId!==a.id?(N(),L("span",Bj,J(n.getProviderLabel(a.provider)||"—"),1)):(N(),L("span",Uj,[d("select",{value:n.editingUser.provider||"",onChange:o=>n.updateUserField(a.id,"provider",o.target.value)},[e[13]||(e[13]=d("option",{value:""},"None",-1)),(N(!0),L(Re,null,Ve(n.serviceProviders,o=>(N(),L("option",{key:o,value:o},J(n.getProviderLabel(o)),9,Vj))),128))],40,$j)]))])):(N(),L("td",Hj,e[14]||(e[14]=[d("span",null,"Loading...",-1)]))),d("td",jj,[n.activeRowId!==a.id?(N(),L("button",{key:0,onClick:o=>n.startEdit(a.id),class:"admin-action-btn edit",title:"Edit"},"✏️",8,Gj)):(N(),L(Re,{key:1},[d("button",{onClick:o=>n.saveUser(a.id),class:"admin-action-btn save",title:"Save"},"💾",8,Wj),d("button",{onClick:e[7]||(e[7]=(...o)=>n.cancelEdit&&n.cancelEdit(...o)),class:"admin-action-btn cancel",title:"Cancel"},"❌"),d("button",{onClick:o=>n.deleteUser(a.id),class:"admin-action-btn delete red",title:"Delete User"},"🗑️",8,zj)],64))])],10,Rj))),128))])])]),d("div",Kj,[d("button",{onClick:e[8]||(e[8]=(...a)=>n.loadPreviousPage&&n.loadPreviousPage(...a)),disabled:n.currentPage===1,class:"admin-btn"}," Previous ",8,qj),d("span",null,"Page "+J(n.currentPage),1),d("button",{onClick:e[9]||(e[9]=(...a)=>n.loadNextPage&&n.loadNextPage(...a)),disabled:!n.hasNextPage,class:"admin-btn"}," Next ",8,Xj)])])}const Qj=yt(Cj,[["render",Yj],["__scopeId","data-v-b807b0dc"]]),Jj={class:"admin-students"},Zj={class:"admin-form-row"},eG={class:"student-admin-table striped"},tG={key:0},rG=["data-id"],nG={style:{display:"none"}},sG=["value","disabled","onInput"],aG=["value","disabled","onInput"],iG=["value","disabled","onInput"],oG=["value","disabled","onChange"],lG=["value","disabled","onChange"],cG=["value"],uG=["title"],dG={class:"admin-action-btns"},fG=["onClick"],hG=["onClick"],pG=["onClick"],mG={class:"admin-pagination"},gG=["disabled"],vG=["disabled"],rg=50,xG={__name:"AdminStudents",setup(t){const e=vo(),{students:r,fetchStudents:n,updateStudent:s,deleteStudent:i}=Ua(),{caseManagers:a,fetchUsers:o}=ya(),{canDeleteAllStudents:l,initializeIfNeeded:c}=q4(),u=se(""),f=se([]),h=se(1),p=se(null),m=se({}),v=se(""),g=se(!1);let y=null;const E=()=>{y&&clearTimeout(y),y=setTimeout(()=>{w()},300)},b=Se(()=>{const M=(h.value-1)*rg,O=M+rg;return f.value.slice(M,O)}),k=Se(()=>Math.ceil(f.value.length/rg)),P=(M,O=!1)=>{v.value=M,g.value=O,setTimeout(()=>{v.value="",g.value=!1},5e3)},w=()=>{if(!Is("studentSearch",20,6e4).allowed){P("Too many search requests. Please wait before searching again.",!0);return}const O=pn(u.value,100),K=qr(O);if(!K.isSafe){P(`Security threat detected in search: ${K.threats.join(", ")}`,!0),u.value=O;return}O!==u.value&&(u.value=O);const j=O.toLowerCase();j?f.value=r.value.filter(H=>{const W=ot(H,"firstName")||"",X=ot(H,"lastName")||"";return`${W} ${X}`.toLowerCase().includes(j)}):f.value=r.value,h.value=1},x=M=>{var K;if(console.log("🚀 ADMIN EDIT DEBUG - Starting edit:",{studentId:M,activeEditId:p.value,studentExists:!!r.value.find(j=>j.id===M)}),p.value)return;const O=r.value.find(j=>j.id===M);O?(console.log("🚀 ADMIN EDIT DEBUG - Student found:",{id:O.id,hasApp:!!O.app,appStudentData:(K=O.app)==null?void 0:K.studentData,keys:Object.keys(O)}),p.value=M,m.value=JSON.parse(JSON.stringify(O)),console.log("🚀 ADMIN EDIT DEBUG - Edit state set:",{activeEditId:p.value,editingStudentId:m.value.id})):console.error("🚀 ADMIN EDIT DEBUG - Student not found!")},S=()=>{p.value=null,m.value={}},_=(M,O,K)=>{if(m.value.id===M){console.log("🚀 ADMIN UPDATE DEBUG - Updating field:",{studentId:M,field:O,value:K,currentValue:ot(m.value,O)});let j=K;if(O==="caseManagerId")j=K;else if(typeof K=="string"){j=pn(K,O==="grade"?10:100);const H=qr(j);if(!H.isSafe){P(`Security threat detected in ${O}: ${H.threats.join(", ")}`,!0);return}const W=Ad(j,O,0,O==="grade"?10:100);if(!W.isValid){P(W.error,!0);return}}["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(O)?(m.value.app||(m.value.app={}),m.value.app.studentData||(m.value.app.studentData={}),m.value.app.studentData[O]=j):m.value[O]=j,console.log("🚀 ADMIN UPDATE DEBUG - Updated field:",{field:O,newValue:j,updatedPath:["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(O)?`app.studentData.${O}`:O})}},A=async M=>{var O,K,j,H,W,X,re;try{console.log("🚀 ADMIN SAVE DEBUG - Starting saveStudent:",{studentId:M,editingStudentId:m.value.id,editingStudentKeys:Object.keys(m.value),hasStudentInList:!!r.value.find(ge=>ge.id===M)});const{currentUser:he}=nf();if(console.log("🔐 PERMISSION DEBUG:",{currentUser:he.value,userRole:(O=he.value)==null?void 0:O.role,userEmail:(K=he.value)==null?void 0:K.email,userId:(j=he.value)==null?void 0:j.uid}),!Is("saveStudent",10,6e4).allowed){P("Too many save requests. Please wait before saving again.",!0);return}const pe={},q=r.value.find(ge=>ge.id===M),G=["firstName","lastName","grade","plan","ssid","caseManagerId"];let oe={},Q=!1;if(G.forEach(ge=>{const ae=ot(m.value,ge),ce=ot(q,ge);ae!==ce&&(oe[ge]=ae,Q=!0,console.log(`✅ CHANGE DETECTED - ${ge}: "${ce}" → "${ae}"`))}),Q&&(pe.app={studentData:{firstName:(W=(H=q.app)==null?void 0:H.studentData)==null?void 0:W.firstName,lastName:(re=(X=q.app)==null?void 0:X.studentData)==null?void 0:re.lastName,...oe}}),Object.keys(m.value).forEach(ge=>{ge!=="id"&&ge!=="app"&&m.value[ge]!==q[ge]&&(pe[ge]=m.value[ge])}),console.log("🚀 ADMIN SAVE DEBUG - Updates prepared:",pe),Object.keys(pe).length===0){S();return}const Y=V4(pe),Z=$4(Y,{isNew:!1});if(!Z.isValid){P(`Validation failed: ${Z.errors.join(", ")}`,!0);return}Object.assign(m.value,Y),console.log("🚀 ADMIN SAVE DEBUG - Calling updateStudent with:",{studentId:M,sanitizedUpdates:Y}),await s(M,Y),console.log("🚀 ADMIN SAVE DEBUG - updateStudent completed successfully");const ne=r.value.findIndex(ge=>ge.id===M);if(ne!==-1){const ge={...r.value[ne]};Object.keys(Y).forEach(ae=>{ae==="app.studentData"?(ge.app||(ge.app={}),ge.app.studentData={...ge.app.studentData,...Y[ae]}):ge[ae]=Y[ae]}),r.value[ne]=ge}console.log("🚀 ADMIN SAVE DEBUG - Local state updated"),P("✅ Student updated.")}catch(he){console.error("🚀 ADMIN SAVE DEBUG - Save failed:",he),P("❌ Update failed.",!0),console.error("Update error:",he)}finally{S()}},C=async M=>{if(!Is("deleteStudent",5,3e5).allowed){P("Too many delete requests. Please wait before deleting again.",!0);return}if(confirm("Are you sure you want to delete this student? This action cannot be undone."))try{await i(M),P("✅ Student deleted.");const K=r.value.findIndex(j=>j.id===M);K!==-1&&r.value.splice(K,1),w()}catch(K){P("❌ Delete failed.",!0),console.error("Delete error:",K)}},T=async()=>{if(!Is("deleteAllStudents",1,36e5).allowed){P("Delete all operation rate limited. Please wait before trying again.",!0);return}const O=`Are you sure you want to delete ALL ${r.value.length} students? 

This action cannot be undone and will permanently remove all student data.

Type "DELETE ALL STUDENTS" to confirm:`;if(prompt(O)!=="DELETE ALL STUDENTS"){P("Delete all operation cancelled.",!1);return}try{P("Deleting all students...");const j=yx(e);let H=0;for(const W of r.value)j.delete(Ze(e,"students",W.id)),H++,H>=500&&(await j.commit(),H=0);H>0&&await j.commit(),r.value=[],f.value=[],P("✅ All students deleted.")}catch(j){P("❌ Failed to delete all students.",!0),console.error("Delete all error:",j)}},D=M=>{if(!M)return"N/A";try{if(M&&typeof M.toDate=="function")return M.toDate().toLocaleDateString();const O=new Date(M);return isNaN(O.getTime())?"Invalid Date":O.toLocaleDateString()}catch{return"Invalid Date"}},V=M=>{var O;return((O=M.app)==null?void 0:O.staffIds)&&Array.isArray(M.app.staffIds)&&M.app.staffIds.length>0},B=M=>V(M)?`Staff ID Array present (${M.app.staffIds.length} staff members)`:"Staff ID Array missing or empty",R=()=>{h.value<k.value&&h.value++},F=()=>{h.value>1&&h.value--};return Ut(async()=>{try{await Promise.all([n(),o(),c()]),f.value=r.value,console.log("🚀 ADMIN DEBUG - Case managers loaded:",a.value.length)}catch(M){P("Failed to load data.",!0),console.error("Load data error:",M)}}),Ba(()=>{y&&clearTimeout(y)}),(M,O)=>(N(),L("div",Jj,[O[5]||(O[5]=d("h2",null,"Edit Students",-1)),d("div",Zj,[we(d("input",{type:"text","onUpdate:modelValue":O[0]||(O[0]=K=>u.value=K),onInput:E,placeholder:"Search by name",class:"admin-search-input"},null,544),[[Ye,u.value]]),ee(l)?(N(),L("button",{key:0,onClick:T,class:"delete-all-btn"}," Delete All Students ")):_e("",!0)]),v.value?(N(),L("div",{key:0,class:Qe(["admin-status-msg",{error:g.value}])},J(v.value),3)):_e("",!0),d("table",eG,[O[4]||(O[4]=d("thead",null,[d("tr",null,[d("th",null,"SSID"),d("th",{style:{display:"none"}},"Student ID"),d("th",null,"First Name"),d("th",null,"Last Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",{title:"Staff ID Array present"},"staffIdArr"),d("th",null,"Date Added"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[b.value.length?_e("",!0):(N(),L("tr",tG,O[1]||(O[1]=[d("td",{colspan:"10"},"No students found.",-1)]))),(N(!0),L(Re,null,Ve(b.value,K=>(N(),L("tr",{key:K.id,class:Qe({"active-row":p.value===K.id}),"data-id":K.id},[d("td",null,J(ee(ot)(K,"ssid")||K.id),1),d("td",nG,J(K.id),1),d("td",null,[d("input",{class:"editable-input","data-field":"firstName",value:ee(ot)(K,"firstName")||"",disabled:p.value!==K.id,onInput:j=>_(K.id,"firstName",j.target.value)},null,40,sG)]),d("td",null,[d("input",{class:"editable-input","data-field":"lastName",value:ee(ot)(K,"lastName")||"",disabled:p.value!==K.id,onInput:j=>_(K.id,"lastName",j.target.value)},null,40,aG)]),d("td",null,[d("input",{class:"editable-input","data-field":"grade",value:ee(ot)(K,"grade")||"",disabled:p.value!==K.id,onInput:j=>_(K.id,"grade",j.target.value)},null,40,iG)]),d("td",null,[d("select",{class:"editable-select","data-field":"plan",value:ee(ot)(K,"plan")||"",disabled:p.value!==K.id,onChange:j=>_(K.id,"plan",j.target.value)},O[2]||(O[2]=[d("option",{value:""},"Select Plan",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),40,oG)]),d("td",null,[d("select",{class:"editable-select","data-field":"caseManagerId",value:ee(ot)(K,"caseManagerId")||"",disabled:p.value!==K.id,onChange:j=>_(K.id,"caseManagerId",j.target.value)},[O[3]||(O[3]=d("option",{value:""},"-- Select Case Manager --",-1)),(N(!0),L(Re,null,Ve(ee(a),j=>(N(),L("option",{key:j.id,value:j.id},J(j.name||j.email||j.id),9,cG))),128))],40,lG)]),d("td",{class:"staff-id-status",title:B(K)},[d("span",{class:Qe(["status-icon",V(K)?"present":"missing"])},J(V(K)?"✓":"✗"),3)],8,uG),d("td",null,J(D(K.created_at)),1),d("td",dG,[p.value===K.id?(N(),L(Re,{key:0},[d("button",{onClick:j=>A(K.id),class:"admin-action-btn save",title:"Save"},"💾",8,fG),d("button",{onClick:S,class:"admin-action-btn cancel",title:"Cancel"},"❌"),d("button",{onClick:j=>C(K.id),class:"admin-action-btn delete red",title:"Delete Student"},"🗑️",8,hG)],64)):(N(),L("button",{key:1,onClick:j=>x(K.id),class:"admin-action-btn edit",title:"Edit"},"✏️",8,pG))])],10,rG))),128))])]),d("div",mG,[d("button",{onClick:F,disabled:h.value===1,class:"admin-btn"}," Prev ",8,gG),d("span",null,"Page "+J(h.value)+" of "+J(k.value),1),d("button",{onClick:R,disabled:h.value===k.value,class:"admin-btn"}," Next ",8,vG)])]))}},yG=yt(xG,[["__scopeId","data-v-8a1750c8"]]),EG={class:"bulk-importer"},_G={key:0,class:"step-container"},bG={class:"file-upload-section"},SG={class:"file-input-wrapper"},AG={for:"csv-file",class:"file-label"},TG={class:"file-text"},wG={key:0,class:"error-message"},CG={key:1,class:"file-info"},IG={key:0},kG={class:"step-actions"},DG=["disabled"],PG={key:1,class:"step-container"},RG={class:"field-mapping-section"},FG={class:"mapping-grid"},NG={class:"csv-column"},OG={class:"app-field"},MG=["onUpdate:modelValue"],LG={class:"sample-data"},BG={key:0,class:"validation-errors"},UG={class:"step-actions"},$G=["disabled"],VG={key:2,class:"step-container"},HG={class:"preview-section"},jG={class:"preview-stats"},GG={class:"stat-item"},WG={class:"stat-value"},zG={class:"stat-item"},KG={class:"stat-value valid"},qG={class:"stat-item"},XG={class:"stat-value invalid"},YG={class:"preview-table-container"},QG={class:"preview-table"},JG={key:0,class:"error-list"},ZG={key:1,class:"no-errors"},eW={class:"import-options"},tW={class:"options-grid"},rW={class:"option-item"},nW={class:"option-item"},sW={class:"option-item"},aW={class:"step-actions"},iW=["disabled"],oW={key:3,class:"step-container"},lW={class:"results-section"},cW={class:"results-stats"},uW={class:"stat-item success"},dW={class:"stat-value"},fW={class:"stat-item error"},hW={class:"stat-value"},pW={class:"stat-item"},mW={class:"stat-value"},gW={key:0,class:"import-errors"},vW={class:"results-actions"},xW={key:4,class:"loading-overlay"},yW={class:"loading-content"},EW={class:"progress-bar"},_W={__name:"StudentBulkImporter",emits:["close","imported"],setup(t,{emit:e}){const r=e,{users:n,fetchUsers:s}=ya(),i=se(1),a=se(""),o=se(""),l=se([]),c=se([]),u=se({}),f=se(""),h=se([]),p=se([]),m=se("valid-only"),v=se(!1),g=se(!1),y=se(0),E=se({successful:0,failed:0,errors:[],processingTime:0}),b=se(null),k=Se(()=>{const q=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],G=Object.values(u.value).filter(Q=>Q),oe=G.includes("app.studentData.ssid");return q.every(Q=>G.includes(Q))&&oe}),P=Se(()=>p.value.filter(q=>q.errors.length===0)),w=Se(()=>p.value.filter(q=>q.errors.length>0));Ut(async()=>{console.log("🚀 StudentBulkImporter component mounted!");try{await s(),console.log("✅ Users loaded successfully:",Object.keys(n.value).length,"users"),console.log("First few users:",Object.values(n.value).slice(0,3).map(q=>({id:q.id,name:q.name,role:q.role})))}catch(q){console.error("❌ Failed to load users:",q)}});const x=async q=>{const G=q.target.files[0];if(G){if(!G.name.toLowerCase().endsWith(".csv")&&G.type!=="text/csv"){f.value="File must be a CSV file (.csv extension)";return}if(G.size>10*1024*1024){f.value="File must be smaller than 10MB";return}f.value="",a.value=G.name,o.value=K(G.size);try{const oe=await G.text();S(oe)}catch(oe){f.value="Failed to read CSV file: "+oe.message}}},S=q=>{try{const G=q.trim().split(`
`);if(G.length<2)throw new Error("CSV must have at least a header row and one data row");const oe=G[0].split(",").map(Y=>Y.trim().replace(/"/g,""));c.value=oe;const Q=[];for(let Y=1;Y<G.length;Y++){const Z={};let ne="",ge=!1,ae=0;for(let ce=0;ce<G[Y].length;ce++){const fe=G[Y][ce];fe==='"'?ge=!ge:fe===","&&!ge?(Z[oe[ae]]=ne.trim().replace(/^"|"$/g,""),ne="",ae++):ne+=fe}ae<oe.length&&(Z[oe[ae]]=ne.trim().replace(/^"|"$/g,"")),Q.push(Z)}l.value=Q,console.log("Parsed CSV data:",Q.length,"records")}catch(G){f.value="Failed to parse CSV: "+G.message}},_=()=>{const q={SSID:"app.studentData.ssid",FirstName:"app.studentData.firstName",LastName:"app.studentData.lastName",Grade:"app.studentData.grade",Plan:"app.studentData.plan",CaseManagerId:"app.studentData.caseManagerId",ReviewDate:"app.dates.reviewDate",ReevalDate:"app.dates.reevalDate",MeetingDate:"app.dates.meetingDate",Period1Teacher:"app.schedule.periods.1",Period2Teacher:"app.schedule.periods.2",Period3Teacher:"app.schedule.periods.3",Period4Teacher:"app.schedule.periods.4",Period5Teacher:"app.schedule.periods.5",Period6Teacher:"app.schedule.periods.6",PeriodSHTeacher:"app.schedule.periods.SH",ClassServices:"app.schedule.classServices",SpeechProvider:"app.providers.speechId",OTProvider:"app.providers.otId",PTProvider:"app.providers.ptId",ATProvider:"app.providers.atId",Audiologist:"app.providers.audId",BISProvider:"app.providers.bisId",DHHProvider:"app.providers.dhhId",HNProvider:"app.providers.hnId",MHProvider:"app.providers.mhId",OMProvider:"app.providers.omId",SCProvider:"app.providers.scId",SWProvider:"app.providers.swId",TRProvider:"app.providers.trId",VIProvider:"app.providers.viId",Flag1:"app.flags.flag1",Flag2:"app.flags.flag2",BIPPdfUrl:"app.documents.bipPdfUrl",AtAGlancePdfUrl:"app.documents.ataglancePdfUrl",Assessment:"app.accommodations.assessment",Instruction:"app.accommodations.instruction"};c.value.forEach(G=>{q[G]&&(u.value[G]=q[G])})},A=()=>{u.value={}},C=q=>{const G=l.value[0];if(!G)return"";const oe=G[q];return oe?q==="ClassServices"&&oe.includes(",")?`"${oe}"`:oe:""},T=()=>{h.value=[];const q=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],G=Object.values(u.value).filter(Y=>Y),oe=G.includes("app.studentData.ssid");q.forEach(Y=>{if(!G.includes(Y)){const Z=Y.split(".").pop();h.value.push(`Required field "${Z}" is not mapped`)}}),oe||h.value.push("SSID (State Student ID) must be mapped to app.studentData.ssid");const Q=G.filter((Y,Z)=>G.indexOf(Y)!==Z);Q.length>0&&h.value.push(`Duplicate field mappings: ${Q.join(", ")}`)},D=()=>{p.value=l.value.map(q=>{const G=V(q),oe=R(G);return console.log("Row mapping:",{original:q,mapped:G,errors:oe}),{data:G,errors:oe}})},V=q=>{const G={app:{studentData:{},dates:{},providers:{},accommodations:{},flags:{},schedule:{periods:{},classServices:[]},documents:{}}};return Object.entries(u.value).forEach(([oe,Q])=>{if(!Q||!q[oe])return;let Y=q[oe].trim();if(!Y)return;if(Q==="app.schedule.classServices"){Y.startsWith('"')&&Y.endsWith('"')&&(Y=Y.slice(1,-1)),G.app.schedule.classServices=Y.split(",").map(ge=>ge.trim()).filter(Boolean);return}if(Q.startsWith("app.schedule.periods.")){const ge=Q.split(".").pop(),ae=Y.trim();if(ae){const ce=X(ae);console.log(`Mapping Period ${ge} teacher:`,ae,"→",ce),G.app.schedule.periods[ge]=ce}return}if(Q.startsWith("app.providers.")){const ge=Q.split(".").pop(),ae=Y.trim();if(ae){const ce=re(ae);console.log(`Mapping ${ge} provider:`,ae,"→",ce),G.app.providers[ge]=ce}return}if(Q==="app.accommodations.assessment"||Q==="app.accommodations.instruction"){const ge=Q.split(".").pop();G.app.accommodations[ge]=Y;return}if(Q.startsWith("app.flags.")){const ge=Q.split(".").pop();G.app.flags[ge]=["true","1","yes","y"].includes(Y.toLowerCase());return}if(Q.includes("Date")){const[ge,ae,ce]=Q.split(".");G[ge][ae]||(G[ge][ae]={}),G[ge][ae][ce]=M(Y);return}const Z=Q.split(".");let ne=G;for(let ge=0;ge<Z.length-1;ge++){const ae=Z[ge];ne[ae]||(ne[ae]={}),ne=ne[ae]}ne[Z[Z.length-1]]=Y}),G},B=q=>{const G=Object.values(n.value).find(oe=>oe.id===q||oe.name===q||oe.email===q||oe.aeriesId===q);return console.log("Mapping case manager:",q,"to Firebase ID:",G==null?void 0:G.id),G?G.id:q},R=q=>{var Q,Y,Z,ne,ge,ae,ce,fe,Ae,Ie,Te,Ge,ke,$e,Be,We,Ke,Ee;const G=[],oe=q.ssid||((Y=(Q=q.app)==null?void 0:Q.studentData)==null?void 0:Y.ssid);return oe||G.push("SSID is required (either top-level or in app.studentData)"),(ne=(Z=q.app)==null?void 0:Z.studentData)!=null&&ne.firstName||G.push("First name is required"),(ae=(ge=q.app)==null?void 0:ge.studentData)!=null&&ae.lastName||G.push("Last name is required"),(fe=(ce=q.app)==null?void 0:ce.studentData)!=null&&fe.grade||G.push("Grade is required"),oe&&!/^\d{9,10}$/.test(oe)&&G.push("SSID must be 9-10 digits"),(Ie=(Ae=q.app)==null?void 0:Ae.studentData)!=null&&Ie.grade&&!["K","1","2","3","4","5","6","7","8","9","10","11","12"].includes(q.app.studentData.grade)&&G.push("Grade must be K-12"),(Ge=(Te=q.app)==null?void 0:Te.studentData)!=null&&Ge.plan&&!["IEP","504"].includes(q.app.studentData.plan)&&G.push("Plan must be IEP or 504"),($e=(ke=q.app)==null?void 0:ke.dates)!=null&&$e.reviewDate&&!F(q.app.dates.reviewDate)&&G.push("Invalid review date format (use YYYY-MM-DD)"),(We=(Be=q.app)==null?void 0:Be.dates)!=null&&We.reevalDate&&!F(q.app.dates.reevalDate)&&G.push("Invalid reevaluation date format (use YYYY-MM-DD)"),(Ee=(Ke=q.app)==null?void 0:Ke.dates)!=null&&Ee.meetingDate&&!F(q.app.dates.meetingDate)&&G.push("Invalid meeting date format (use YYYY-MM-DD)"),G},F=q=>{if(!q)return!0;const G=new Date(q);return!isNaN(G.getTime())&&q.match(/^\d{4}-\d{2}-\d{2}$/)},M=q=>{if(!q)return"";try{const G=new Date(q);return isNaN(G.getTime())?"":G.toISOString().split("T")[0]}catch{return""}},O=q=>{var Q,Y,Z,ne;const G=((Y=(Q=q.app)==null?void 0:Q.studentData)==null?void 0:Y.firstName)||"",oe=((ne=(Z=q.app)==null?void 0:Z.studentData)==null?void 0:ne.lastName)||"";return`${G} ${oe}`.trim()||"Missing Name"},K=q=>{if(q===0)return"0 Bytes";const G=1024,oe=["Bytes","KB","MB","GB"],Q=Math.floor(Math.log(q)/Math.log(G));return parseFloat((q/Math.pow(G,Q)).toFixed(2))+" "+oe[Q]},j=()=>{if(i.value===2){if(T(),h.value.length>0)return;D()}i.value++},H=()=>{i.value--},W=async()=>{g.value=!0,y.value=0;const q=Date.now(),G=m.value==="valid-only"?P.value:p.value;let oe=0,Q=0;const Y=[];try{for(let Z=0;Z<G.length;Z++){const ne=G[Z];try{await ue(ne.data),oe++}catch(ge){Q++,Y.push(`Row ${Z+1}: ${ge.message}`)}y.value=Math.round((Z+1)/G.length*100)}E.value={successful:oe,failed:Q,errors:Y,processingTime:Date.now()-q},i.value=4,r("imported",{successful:oe,failed:Q})}catch(Z){console.error("Import failed:",Z),Y.push("Import process failed: "+Z.message),E.value={successful:oe,failed:Q,errors:Y,processingTime:Date.now()-q},i.value=4}finally{g.value=!1}},X=q=>{if(!q)return"";console.log("🔍 Mapping teacher ID:",q),console.log("📚 Available users:",Object.values(n.value).map(Q=>({name:Q.name,aeriesId:Q.aeriesId,id:Q.id})));const G=Object.values(n.value).find(Q=>{const Y=String(Q.aeriesId)===String(q);return Y&&console.log("✅ Found exact Aeries ID match:",{teacherId:q,user:{name:Q.name,aeriesId:Q.aeriesId,id:Q.id}}),Y});if(G)return console.log("✅ Using Aeries ID match:",q,"→",G.id,"(",G.name,")"),G.id;const oe=Object.values(n.value).find(Q=>Q.id===q);return oe?(console.log("✅ Using Firebase ID match:",q,"→",oe.id,"(",oe.name,")"),oe.id):(console.warn("❌ No user found for teacher ID:",q),q)},re=q=>{if(!q)return"";console.log("🔍 Mapping provider ID:",q),console.log("📚 Available users:",Object.values(n.value).map(Q=>({name:Q.name,aeriesId:Q.aeriesId,id:Q.id})));const G=Object.values(n.value).find(Q=>{const Y=String(Q.aeriesId)===String(q);return Y&&console.log("✅ Found exact Aeries ID match:",{providerId:q,user:{name:Q.name,aeriesId:Q.aeriesId,id:Q.id}}),Y});if(G)return console.log("✅ Using Aeries ID match:",q,"→",G.id,"(",G.name,")"),G.id;const oe=Object.values(n.value).find(Q=>Q.id===q);return oe?(console.log("✅ Using Firebase ID match:",q,"→",oe.id,"(",oe.name,")"),oe.id):(console.warn("❌ No user found for provider ID:",q),q)},he=q=>{try{return q.app&&q.app.studentData&&q.app.studentData.ssid&&q.app.studentData.firstName&&q.app.studentData.lastName&&q.app.studentData.grade&&q.app.schedule&&Array.isArray(q.app.schedule.classServices)}catch{return!1}},ue=async q=>{try{const G=q.app.studentData.ssid,oe=bt(ze,"students"),Q=nr(oe,Rr("app.studentData.ssid","==",G)),Y=await $t(Q);if(!Y.empty&&!v.value)throw new Error(`Student with SSID ${G} already exists`);const Z={createdAt:Wn(),updatedAt:Wn(),app:{studentData:{firstName:q.app.studentData.firstName||"",lastName:q.app.studentData.lastName||"",grade:q.app.studentData.grade||"",plan:q.app.studentData.plan||"",caseManagerId:B(q.app.studentData.caseManagerId)||"",ssid:G},dates:{reviewDate:q.app.dates.reviewDate||"",reevalDate:q.app.dates.reevalDate||"",meetingDate:q.app.dates.meetingDate||""},schedule:{periods:q.app.schedule.periods||{1:"",2:"",3:"",4:"",5:"",6:"",SH:""},classServices:Array.isArray(q.app.schedule.classServices)?q.app.schedule.classServices:[]},providers:q.app.providers||{speechId:"",otId:"",ptId:"",atId:"",audId:"",bisId:"",dhhId:"",hnId:"",mhId:"",omId:"",scId:"",swId:"",trId:"",viId:""},accommodations:{assessment:q.app.accommodations.assessment||"",instruction:q.app.accommodations.instruction||""},flags:{flag1:!!q.app.flags.flag1,flag2:!!q.app.flags.flag2},documents:{bipPdfUrl:q.app.documents.bipPdfUrl||null,ataglancePdfUrl:q.app.documents.ataglancePdfUrl||null}}};if(console.log("Saving student data:",{ssid:Z.app.studentData.ssid,schedule:Z.app.schedule.periods,providers:Z.app.providers}),!he(Z))throw new Error("Invalid student data structure");if(!Y.empty&&v.value){const ne=Y.docs[0];await Ht(Ze(ze,"students",ne.id),Z,{merge:!0})}else{const ne=Ze(bt(ze,"students"));await Ht(ne,Z)}}catch(G){throw console.error("Error importing student:",G),G}},pe=()=>{i.value=1,a.value="",o.value="",l.value=[],c.value=[],u.value={},f.value="",h.value=[],p.value=[],E.value={successful:0,failed:0,errors:[],processingTime:0},b.value&&(b.value.value="")};return(q,G)=>(N(),L("div",EG,[G[30]||(G[30]=d("div",{style:{background:"#e8f5e8",border:"2px solid #4caf50",padding:"10px","margin-bottom":"20px","border-radius":"4px","text-align":"center"}},[d("strong",null,"✅ StudentBulkImporter Component Loaded Successfully")],-1)),G[31]||(G[31]=d("div",{class:"importer-header"},[d("h2",null,"Add Students - Bulk Import"),d("p",{class:"description"}," Import multiple students from a CSV file. The system will map CSV fields to the app's database structure and allow you to preview and validate the data before importing. ")],-1)),i.value===1?(N(),L("div",_G,[G[8]||(G[8]=d("div",{class:"step-header"},[d("h3",null,"Step 1: Upload CSV File"),d("p",null,"Select a CSV file containing student data. The first row should contain column headers.")],-1)),d("div",bG,[d("div",SG,[d("input",{type:"file",ref_key:"fileInput",ref:b,onChange:x,accept:".csv",class:"file-input",id:"csv-file"},null,544),d("label",AG,[G[4]||(G[4]=d("span",{class:"file-icon"},"📁",-1)),d("span",TG,J(a.value||"Choose CSV File"),1)])]),f.value?(N(),L("div",wG,J(f.value),1)):_e("",!0),a.value?(N(),L("div",CG,[d("p",null,[G[5]||(G[5]=d("strong",null,"File:",-1)),Ne(" "+J(a.value),1)]),d("p",null,[G[6]||(G[6]=d("strong",null,"Size:",-1)),Ne(" "+J(o.value),1)]),l.value.length>0?(N(),L("p",IG,[G[7]||(G[7]=d("strong",null,"Records:",-1)),Ne(" "+J(l.value.length),1)])):_e("",!0)])):_e("",!0)]),G[9]||(G[9]=Fr('<div class="sample-format" data-v-494a4282><h4 data-v-494a4282>Expected CSV Format:</h4><div class="format-example" data-v-494a4282><code data-v-494a4282> SSID,FirstName,LastName,Grade,Plan,CaseManagerId,ReviewDate,ReevalDate,MeetingDate,Period1Teacher,Period2Teacher,Period3Teacher,Period4Teacher,Period5Teacher,Period6Teacher,SHTeacher,ClassServices,SpeechProvider,OTProvider,PTProvider,ATProvider,Audiologist,BISProvider,DHHProvider,HNProvider,MHProvider,OMProvider,SCProvider,SWProvider,TRProvider,VIProvider,Flag1,Flag2,BIPPdfUrl,AtAGlancePdfUrl,Assessment,Instruction<br data-v-494a4282> 123456789,John,Doe,9,IEP,user003,2025-07-15,2025-12-15,2025-07-10,user007,user008,user009,user010,user011,user012,user013,&quot;SDC: English,RSP: Math&quot;,user020,user021,user022,user023,user024,user025,user026,user027,user028,user029,user030,user031,user032,user033,true,false,https://example.com/bip.pdf,https://example.com/ataglance.pdf,&quot;Allow for test re-takes if the score is below average...&quot;,Divide larger projects or assignments into manageable parts... </code></div><p class="format-note" data-v-494a4282><strong data-v-494a4282>Required fields:</strong> SSID, FirstName, LastName, Grade<br data-v-494a4282><strong data-v-494a4282>App Structure:</strong> All fields map to the app data structure in your database<br data-v-494a4282><strong data-v-494a4282>Schedule fields:</strong> Period1Teacher through Period6Teacher and SHTeacher (Firebase user IDs like user001, user002, etc.)<br data-v-494a4282><strong data-v-494a4282>Provider fields:</strong> All service provider fields (Firebase user IDs like user020, user021, etc.)<br data-v-494a4282><strong data-v-494a4282>Class Services:</strong> Comma-separated list (e.g., &quot;SDC: English,RSP: Math,Co-teach: Science&quot;)<br data-v-494a4282><strong data-v-494a4282>Dates:</strong> Use YYYY-MM-DD format (e.g., 2025-07-15)<br data-v-494a4282><strong data-v-494a4282>Flags:</strong> Use true/false or 1/0<br data-v-494a4282><strong data-v-494a4282>Accommodations:</strong> Text fields for assessment and instruction<br data-v-494a4282><strong data-v-494a4282>Note:</strong> Teacher and provider IDs will be automatically mapped from names, emails, or Aeries IDs if user lookup is available </p></div>',1)),d("div",kG,[d("button",{onClick:j,disabled:!l.value.length,class:"btn btn-primary"}," Next: Map Fields ",8,DG)])])):_e("",!0),i.value===2?(N(),L("div",PG,[G[15]||(G[15]=d("div",{class:"step-header"},[d("h3",null,"Step 2: Map CSV Fields"),d("p",null,"Map your CSV columns to the app's database fields. Required fields are marked with *")],-1)),d("div",RG,[d("div",FG,[G[12]||(G[12]=Fr('<div class="mapping-header" data-v-494a4282><div class="csv-column" data-v-494a4282>CSV Column</div><div class="arrow" data-v-494a4282>→</div><div class="app-field" data-v-494a4282>App Database Field</div><div class="sample-data" data-v-494a4282>Sample Data</div></div>',1)),(N(!0),L(Re,null,Ve(c.value,(oe,Q)=>(N(),L("div",{key:Q,class:"mapping-row"},[d("div",NG,[d("strong",null,J(oe),1)]),G[11]||(G[11]=d("div",{class:"arrow"},"→",-1)),d("div",OG,[we(d("select",{"onUpdate:modelValue":Y=>u.value[oe]=Y,class:"field-select"},G[10]||(G[10]=[Fr('<option value="" data-v-494a4282>-- Skip this field --</option><optgroup label="Required Fields" data-v-494a4282><option value="app.studentData.ssid" data-v-494a4282>SSID (State Student ID) *</option><option value="app.studentData.firstName" data-v-494a4282>First Name *</option><option value="app.studentData.lastName" data-v-494a4282>Last Name *</option><option value="app.studentData.grade" data-v-494a4282>Grade *</option></optgroup><optgroup label="Student Information" data-v-494a4282><option value="app.studentData.plan" data-v-494a4282>Plan Type (IEP/504/RTI/None)</option><option value="app.studentData.caseManagerId" data-v-494a4282>Case Manager ID</option></optgroup><optgroup label="Important Dates" data-v-494a4282><option value="app.dates.reviewDate" data-v-494a4282>Review Date</option><option value="app.dates.reevalDate" data-v-494a4282>Reevaluation Date</option><option value="app.dates.meetingDate" data-v-494a4282>Meeting Date</option></optgroup><optgroup label="Class Schedule" data-v-494a4282><option value="app.schedule.periods.1" data-v-494a4282>Period 1 Teacher ID</option><option value="app.schedule.periods.2" data-v-494a4282>Period 2 Teacher ID</option><option value="app.schedule.periods.3" data-v-494a4282>Period 3 Teacher ID</option><option value="app.schedule.periods.4" data-v-494a4282>Period 4 Teacher ID</option><option value="app.schedule.periods.5" data-v-494a4282>Period 5 Teacher ID</option><option value="app.schedule.periods.6" data-v-494a4282>Period 6 Teacher ID</option><option value="app.schedule.periods.SH" data-v-494a4282>Study Hall Teacher ID</option><option value="app.schedule.classServices" data-v-494a4282>Class Services (Comma-separated)</option></optgroup><optgroup label="Service Providers" data-v-494a4282><option value="app.providers.speechId" data-v-494a4282>Speech Provider ID</option><option value="app.providers.otId" data-v-494a4282>OT Provider ID</option><option value="app.providers.ptId" data-v-494a4282>PT Provider ID</option><option value="app.providers.atId" data-v-494a4282>AT Provider ID</option><option value="app.providers.audId" data-v-494a4282>Audiologist ID</option><option value="app.providers.bisId" data-v-494a4282>BIS Provider ID</option><option value="app.providers.dhhId" data-v-494a4282>DHH Provider ID</option><option value="app.providers.hnId" data-v-494a4282>HN Provider ID</option><option value="app.providers.mhId" data-v-494a4282>MH Provider ID</option><option value="app.providers.omId" data-v-494a4282>OM Provider ID</option><option value="app.providers.scId" data-v-494a4282>SC Provider ID</option><option value="app.providers.swId" data-v-494a4282>SW Provider ID</option><option value="app.providers.trId" data-v-494a4282>TR Provider ID</option><option value="app.providers.viId" data-v-494a4282>VI Provider ID</option></optgroup><optgroup label="Flags" data-v-494a4282><option value="app.flags.flag1" data-v-494a4282>Flag 1 (Boolean)</option><option value="app.flags.flag2" data-v-494a4282>Flag 2 (Boolean)</option></optgroup><optgroup label="Documents" data-v-494a4282><option value="app.documents.bipPdfUrl" data-v-494a4282>BIP PDF URL</option><option value="app.documents.ataglancePdfUrl" data-v-494a4282>At-A-Glance PDF URL</option></optgroup><optgroup label="Accommodations" data-v-494a4282><option value="app.accommodations.assessment" data-v-494a4282>Assessment Accommodations</option><option value="app.accommodations.instruction" data-v-494a4282>Instructional Accommodations</option></optgroup>',9)]),8,MG),[[ur,u.value[oe]]])]),d("div",LG,[d("code",null,J(C(oe)),1)])]))),128))]),d("div",{class:"auto-mapping-section"},[G[13]||(G[13]=d("h4",null,"Quick Mapping Options:",-1)),d("div",{class:"quick-actions"},[d("button",{onClick:_,class:"btn btn-secondary"}," Auto-map Common Fields "),d("button",{onClick:A,class:"btn btn-secondary"}," Clear All Mappings ")])]),h.value.length>0?(N(),L("div",BG,[G[14]||(G[14]=d("h4",null,"Mapping Issues:",-1)),d("ul",null,[(N(!0),L(Re,null,Ve(h.value,oe=>(N(),L("li",{key:oe,class:"error-item"},J(oe),1))),128))])])):_e("",!0)]),d("div",UG,[d("button",{onClick:H,class:"btn btn-secondary"}," Back "),d("button",{onClick:j,disabled:!k.value,class:"btn btn-primary"}," Next: Preview Data ",8,$G)])])):_e("",!0),i.value===3?(N(),L("div",VG,[G[23]||(G[23]=d("div",{class:"step-header"},[d("h3",null,"Step 3: Preview and Validate"),d("p",null,"Review the mapped data before importing. Check for any validation errors.")],-1)),d("div",HG,[d("div",jG,[d("div",GG,[G[16]||(G[16]=d("span",{class:"stat-label"},"Total Records:",-1)),d("span",WG,J(l.value.length),1)]),d("div",zG,[G[17]||(G[17]=d("span",{class:"stat-label"},"Valid Records:",-1)),d("span",KG,J(P.value.length),1)]),d("div",qG,[G[18]||(G[18]=d("span",{class:"stat-label"},"Invalid Records:",-1)),d("span",XG,J(w.value.length),1)])]),d("div",YG,[d("table",QG,[G[19]||(G[19]=d("thead",null,[d("tr",null,[d("th",null,"Status"),d("th",null,"SSID"),d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",null,"Issues")])],-1)),d("tbody",null,[(N(!0),L(Re,null,Ve(p.value,(oe,Q)=>{var Y,Z,ne,ge,ae,ce,fe,Ae;return N(),L("tr",{key:Q,class:Qe({"invalid-row":oe.errors.length>0})},[d("td",null,[d("span",{class:Qe(["status-badge",oe.errors.length>0?"error":"valid"])},J(oe.errors.length>0?"Error":"Valid"),3)]),d("td",null,J(oe.data.ssid||((Z=(Y=oe.data.app)==null?void 0:Y.studentData)==null?void 0:Z.ssid)||"Missing"),1),d("td",null,J(O(oe.data)),1),d("td",null,J(((ge=(ne=oe.data.app)==null?void 0:ne.studentData)==null?void 0:ge.grade)||"Missing"),1),d("td",null,J(((ce=(ae=oe.data.app)==null?void 0:ae.studentData)==null?void 0:ce.plan)||"Not set"),1),d("td",null,J(((Ae=(fe=oe.data.app)==null?void 0:fe.studentData)==null?void 0:Ae.caseManagerId)||"Not set"),1),d("td",null,[oe.errors.length>0?(N(),L("ul",JG,[(N(!0),L(Re,null,Ve(oe.errors,Ie=>(N(),L("li",{key:Ie,class:"error-item"},J(Ie),1))),128))])):(N(),L("span",ZG,"No issues"))])],2)}),128))])])]),d("div",eW,[G[22]||(G[22]=d("h4",null,"Import Options:",-1)),d("div",tW,[d("label",rW,[we(d("input",{type:"radio","onUpdate:modelValue":G[0]||(G[0]=oe=>m.value=oe),value:"valid-only"},null,512),[[fa,m.value]]),d("span",null,"Import only valid records ("+J(P.value.length)+" records)",1)]),d("label",nW,[we(d("input",{type:"radio","onUpdate:modelValue":G[1]||(G[1]=oe=>m.value=oe),value:"all"},null,512),[[fa,m.value]]),G[20]||(G[20]=d("span",null,"Import all records (may cause errors for invalid data)",-1))]),d("label",sW,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[2]||(G[2]=oe=>v.value=oe)},null,512),[[_t,v.value]]),G[21]||(G[21]=d("span",null,"Update existing students if SSID already exists",-1))])])])]),d("div",aW,[d("button",{onClick:H,class:"btn btn-secondary"}," Back "),d("button",{onClick:W,disabled:g.value||m.value==="valid-only"&&P.value.length===0,class:"btn btn-primary"},J(g.value?"Importing...":`Import ${m.value==="valid-only"?P.value.length:l.value.length} Students`),9,iW)])])):_e("",!0),i.value===4?(N(),L("div",oW,[G[28]||(G[28]=d("div",{class:"step-header"},[d("h3",null,"Step 4: Import Complete"),d("p",null,"Your bulk import has been completed. Review the results below.")],-1)),d("div",lW,[d("div",cW,[d("div",uW,[G[24]||(G[24]=d("span",{class:"stat-label"},"Successfully Imported:",-1)),d("span",dW,J(E.value.successful),1)]),d("div",fW,[G[25]||(G[25]=d("span",{class:"stat-label"},"Failed to Import:",-1)),d("span",hW,J(E.value.failed),1)]),d("div",pW,[G[26]||(G[26]=d("span",{class:"stat-label"},"Total Processing Time:",-1)),d("span",mW,J(E.value.processingTime)+"ms",1)])]),E.value.errors.length>0?(N(),L("div",gW,[G[27]||(G[27]=d("h4",null,"Import Errors:",-1)),d("ul",null,[(N(!0),L(Re,null,Ve(E.value.errors,oe=>(N(),L("li",{key:oe,class:"error-item"},J(oe),1))),128))])])):_e("",!0),d("div",vW,[d("button",{onClick:pe,class:"btn btn-secondary"}," Import More Students "),d("button",{onClick:G[3]||(G[3]=oe=>q.$emit("close")),class:"btn btn-primary"}," Close ")])])])):_e("",!0),g.value?(N(),L("div",xW,[d("div",yW,[G[29]||(G[29]=d("div",{class:"loading-spinner"},null,-1)),d("p",null,"Importing students... "+J(y.value)+"%",1),d("div",EW,[d("div",{class:"progress-fill",style:as({width:y.value+"%"})},null,4)])])])):_e("",!0)]))}},bW=yt(_W,[["__scopeId","data-v-494a4282"]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),SW=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),AW=t=>{const e=SW(t);return e.charAt(0).toUpperCase()+e.slice(1)},TW=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Gf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wW=({size:t,strokeWidth:e=2,absoluteStrokeWidth:r,color:n,iconNode:s,name:i,class:a,...o},{slots:l})=>Xo("svg",{...Gf,width:t||Gf.width,height:t||Gf.height,stroke:n||Gf.stroke,"stroke-width":r?Number(e)*24/Number(t):e,class:TW("lucide",...i?[`lucide-${uS(AW(i))}-icon`,`lucide-${uS(i)}`]:["lucide-icon"]),...o},[...s.map(c=>Xo(...c)),...l.default?[l.default()]:[]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=(t,e)=>(r,{slots:n})=>Xo(wW,{...r,iconNode:e,name:t},n);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CW=$a("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IW=$a("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kW=$a("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DW=$a("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PW=$a("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RW=$a("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FW=$a("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NW=$a("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OW=$a("user-search",[["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}],["path",{d:"M10.3 15H7a4 4 0 0 0-4 4v2",key:"3bnktk"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["path",{d:"m21 21-1.9-1.9",key:"1g2n9r"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=$a("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),MW={class:"permissions-overview"},LW={class:"roles-summary"},BW={class:"role-icon"},UW={class:"role-info"},$W={class:"role-stats"},VW={class:"stat"},HW={class:"stat-number"},jW={class:"stat"},GW={class:"stat-number"},WW={class:"stat"},zW={class:"stat-number"},KW={class:"permissions-matrix"},qW={class:"matrix-table-container"},XW={class:"matrix-table"},YW=["data-role"],QW={class:"permission-info"},JW={class:"permission-name"},ZW={class:"permission-description"},ez={class:"permission-firebase"},tz={class:"admin-panel-access"},rz={class:"access-grid"},nz={class:"access-header"},sz={class:"access-icon"},az={class:"role-name"},iz={key:0,class:"access-details"},oz={class:"access-level"},lz={class:"access-description"},cz={key:1,class:"no-access"},uz={__name:"PermissionsOverview",setup(t){const e=yu,r=Se(()=>lc.slice().sort((l,c)=>{var h,p;const u=((h=e[l])==null?void 0:h.length)||0;return(((p=e[c])==null?void 0:p.length)||0)-u})),n={admin:kW,school_admin:RW,staff_view:OW,staff_edit:FW,admin_504:IW,sped_chair:PW,case_manager:NW,teacher:dS,paraeducator:CW,service_provider:DW},s=Se(()=>r.value.map(l=>{const c=e[l]||[],u=c.some(v=>v.includes("admin_panel"));let f="No Access",h="No admin panel access";c.includes("admin_panel_full")?(f="Full Access",h="All admin panel features including permissions management"):c.includes("admin_panel_school")?(f="School Access",h="School operations, users, aides, and students"):c.includes("admin_panel_limited")?(f="Limited Access",h="Student management, aide management, and 504-related functions"):c.includes("admin_panel_sped")&&(f="SPED Access",h="SPED program management and aide oversight");let p="Viewer";c.includes(it.EDIT_STUDENT_ALL)?l==="admin"||l==="school_admin"?p="Admin":l==="staff_edit"?p="Editor":(l==="sped_chair"||l==="admin_504")&&(p="Admin/CM"):c.includes(it.EDIT_STUDENT_CM)&&(l==="admin_504"?p="Admin/CM":p="CM");const m=l==="admin_504"?"504 Coordinator":l==="sped_chair"?"SPED Chair":l==="school_admin"?"School Administrator":l==="staff_view"?"Staff Viewer":l==="staff_edit"?"Staff Editor":l==="case_manager"?"Case Manager":l==="service_provider"?"Service Provider":l.charAt(0).toUpperCase()+l.slice(1);return{key:l,name:m,icon:n[l]||dS,description:jL[l]||`${m} role`,adminAccess:u,adminLevel:f,adminDescription:h,studentAccessLevel:p,permissions:c}})),i=Se(()=>[{key:it.VIEW_USERS,name:"View Users",description:"Can view user accounts and basic information",firebaseRule:"All authenticated users"},{key:it.EDIT_USER,name:"Edit Users",description:"Can modify user accounts and profiles",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:it.DELETE_USER,name:"Delete Users",description:"Can remove user accounts",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:it.MANAGE_TEACHER_FEEDBACK,name:"Manage Teacher Feedback",description:"Can create and manage teacher feedback forms",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager"},{key:it.MANAGE_IMPORTS,name:"Manage Data Imports",description:"Can import data from SEIS, Aeries, and other sources",firebaseRule:"Admin, School Admin"},{key:it.MANAGE_BACKUPS,name:"Manage Backups",description:"Can create, restore, and manage database backups",firebaseRule:"Admin, School Admin"},{key:it.VIEW_STUDENTS,name:"View Students",description:"Can view student records (role-filtered)",firebaseRule:"All authenticated users"},{key:it.EDIT_STUDENT_CM,name:"Edit Own Caseload",description:"Can modify students on own caseload",firebaseRule:"Case Manager, Service Provider"},{key:it.EDIT_STUDENT_ALL,name:"Edit All Students",description:"Can modify any student record",firebaseRule:"Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair"},{key:it.ACCESS_ADMIN_PANEL,name:"Admin Panel Access",description:"Can access administrative functions",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:it.MANAGE_AIDES,name:"Aide Management",description:"Can manage aide assignments and schedules",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:it.MANAGE_SYSTEM_SETTINGS,name:"System Settings",description:"Can modify system-level configuration",firebaseRule:"Admin only"}].sort((c,u)=>{const f=lc.filter(p=>{var m;return(m=e[p])==null?void 0:m.includes(c.key)}).length;return lc.filter(p=>{var m;return(m=e[p])==null?void 0:m.includes(u.key)}).length-f})),a=(l,c)=>{var u;return((u=e[l])==null?void 0:u.includes(c))||!1},o=l=>({admin:"Admin",school_admin:"School Admin",staff_view:"Staff View",staff_edit:"Staff Edit",admin_504:"504 Coord",sped_chair:"SPED Chair",case_manager:"Case Mgr",teacher:"Teacher",service_provider:"Service",paraeducator:"Para"})[l]||l;return(l,c)=>(N(),L("div",MW,[c[7]||(c[7]=d("div",{class:"overview-header"},[d("h2",null,"📋 Permissions Overview"),d("p",{class:"overview-description"}," This a summary of the role-based permissions These permissions are hard-coded for consistency and security. ")],-1)),d("div",LW,[(N(!0),L(Re,null,Ve(s.value,u=>(N(),L("div",{class:"summary-card",key:u.key},[d("div",{class:Qe(["role-header",u.key])},[d("div",BW,[(N(),Kr(_A(u.icon),{class:"w-6 h-6"}))]),d("div",UW,[d("h3",null,J(u.name),1),d("p",null,J(u.description),1)])],2),d("div",$W,[d("div",VW,[d("span",HW,J(u.permissions.length),1),c[0]||(c[0]=d("span",{class:"stat-label"},"Permissions",-1))]),d("div",jW,[d("span",GW,J(u.adminAccess?"Yes":"No"),1),c[1]||(c[1]=d("span",{class:"stat-label"},"Admin Panel",-1))]),d("div",WW,[d("span",zW,J(u.studentAccessLevel),1),c[2]||(c[2]=d("span",{class:"stat-label"},"Student Access",-1))])])]))),128))]),d("div",KW,[c[4]||(c[4]=d("h3",null,"🔐 Detailed Permissions Matrix",-1)),c[5]||(c[5]=d("div",{class:"matrix-note"},[d("strong",null,"Note:"),Ne(" These permissions are synchronized with Firebase security rules and cannot be modified. They ensure consistent security across your application. ")],-1)),d("div",qW,[d("table",XW,[d("thead",null,[d("tr",null,[c[3]||(c[3]=d("th",{class:"permission-column"},"Permission",-1)),(N(!0),L(Re,null,Ve(r.value,u=>(N(),L("th",{key:u,class:Qe(`role-header ${u}`),"data-role":o(u)},null,10,YW))),128))])]),d("tbody",null,[(N(!0),L(Re,null,Ve(i.value,u=>(N(),L("tr",{key:u.key,class:"permission-row"},[d("td",QW,[d("div",JW,J(u.name),1),d("div",ZW,J(u.description),1),d("div",ez,J(u.firebaseRule),1)]),(N(!0),L(Re,null,Ve(r.value,f=>(N(),L("td",{key:f,class:"permission-cell"},[d("span",{class:Qe(["permission-indicator",{granted:a(f,u.key)}])},J(a(f,u.key)?"✅":"❌"),3)]))),128))]))),128))])])])]),d("div",tz,[c[6]||(c[6]=d("h3",null,"⚙️ Admin Panel Access",-1)),d("div",rz,[(N(!0),L(Re,null,Ve(s.value,u=>(N(),L("div",{key:u.key,class:Qe(["access-card",{"has-access":u.adminAccess}])},[d("div",nz,[d("span",sz,J(u.adminAccess?"✅":"❌"),1),d("span",az,J(u.name),1)]),u.adminAccess?(N(),L("div",iz,[d("div",oz,J(u.adminLevel),1),d("div",lz,J(u.adminDescription),1)])):(N(),L("div",cz," No admin panel access "))],2))),128))])]),c[8]||(c[8]=Fr('<div class="firebase-rules" data-v-88586d63><h3 data-v-88586d63>🔥 Firebase Security Rules Summary</h3><div class="rules-grid" data-v-88586d63><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>👥 Users Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>🎓 Students Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users (role-filtered)</li><li data-v-88586d63><strong data-v-88586d63>Write (All):</strong> Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Write (Own Caseload):</strong> Case Manager, Service Provider</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>⚙️ App Settings</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>📝 Audit Logs</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> All authenticated users (own actions)</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>📝 Feedback Forms</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>💾 Backups</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read/Write:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin</li></ul></div></div></div>',1))]))}},dz=yt(uz,[["__scopeId","data-v-88586d63"]]),fz={class:"admin-permissions"},hz={__name:"AdminPermissions",setup(t){return(e,r)=>(N(),L("div",fz,[nt(dz)]))}},pz=yt(hz,[["__scopeId","data-v-699444ca"]]);var X4={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((r,n)=>{t.exports=n()})(Bt,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},s,i=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(_){var A=P(_);A.chunkSize=parseInt(A.chunkSize),_.step||_.chunk||(A.chunkSize=null),this._handle=new v(A),(this._handle.streamer=this)._config=A}).call(this,S),this.parseChunk=function(_,A){var C=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<C){let D=this._config.newline;D||(T=this._config.quoteChar||'"',D=this._handle.guessLineEndings(_,T)),_=[..._.split(D).slice(C)].join(D)}this.isFirstChunk&&x(this._config.beforeFirstChunk)&&(T=this._config.beforeFirstChunk(_))!==void 0&&(_=T),this.isFirstChunk=!1,this._halted=!1;var C=this._partialLine+_,T=(this._partialLine="",this._handle.parse(C,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(_=T.meta.cursor,C=(this._finished||(this._partialLine=C.substring(_-this._baseIndex),this._baseIndex=_),T&&T.data&&(this._rowCount+=T.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)n.postMessage({results:T,workerId:c.WORKER_ID,finished:C});else if(x(this._config.chunk)&&!A){if(this._config.chunk(T,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=T=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(T.data),this._completeResults.errors=this._completeResults.errors.concat(T.errors),this._completeResults.meta=T.meta),this._completed||!C||!x(this._config.complete)||T&&T.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),C||T&&T.meta.paused||this._nextChunk(),T}this._halted=!0},this._sendError=function(_){x(this._config.error)?this._config.error(_):a&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:_,finished:!1})}}function f(S){var _;(S=S||{}).chunkSize||(S.chunkSize=c.RemoteChunkSize),u.call(this,S),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(A){this._input=A,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(_=new XMLHttpRequest,this._config.withCredentials&&(_.withCredentials=this._config.withCredentials),i||(_.onload=w(this._chunkLoaded,this),_.onerror=w(this._chunkError,this)),_.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var A,C=this._config.downloadRequestHeaders;for(A in C)_.setRequestHeader(A,C[A])}var T;this._config.chunkSize&&(T=this._start+this._config.chunkSize-1,_.setRequestHeader("Range","bytes="+this._start+"-"+T));try{_.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}i&&_.status===0&&this._chunkError()}},this._chunkLoaded=function(){_.readyState===4&&(_.status<200||400<=_.status?this._chunkError():(this._start+=this._config.chunkSize||_.responseText.length,this._finished=!this._config.chunkSize||this._start>=(A=>(A=A.getResponseHeader("Content-Range"))!==null?parseInt(A.substring(A.lastIndexOf("/")+1)):-1)(_),this.parseChunk(_.responseText)))},this._chunkError=function(A){A=_.statusText||A,this._sendError(new Error(A))}}function h(S){(S=S||{}).chunkSize||(S.chunkSize=c.LocalChunkSize),u.call(this,S);var _,A,C=typeof FileReader<"u";this.stream=function(T){this._input=T,A=T.slice||T.webkitSlice||T.mozSlice,C?((_=new FileReader).onload=w(this._chunkLoaded,this),_.onerror=w(this._chunkError,this)):_=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input,D=(this._config.chunkSize&&(D=Math.min(this._start+this._config.chunkSize,this._input.size),T=A.call(T,this._start,D)),_.readAsText(T,this._config.encoding));C||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(_.error)}}function p(S){var _;u.call(this,S=S||{}),this.stream=function(A){return _=A,this._nextChunk()},this._nextChunk=function(){var A,C;if(!this._finished)return A=this._config.chunkSize,_=A?(C=_.substring(0,A),_.substring(A)):(C=_,""),this._finished=!_,this.parseChunk(C)}}function m(S){u.call(this,S=S||{});var _=[],A=!0,C=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){C&&_.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),_.length?this.parseChunk(_.shift()):A=!0},this._streamData=w(function(T){try{_.push(typeof T=="string"?T:T.toString(this._config.encoding)),A&&(A=!1,this._checkIsFinished(),this.parseChunk(_.shift()))}catch(D){this._streamError(D)}},this),this._streamError=w(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=w(function(){this._streamCleanUp(),C=!0,this._streamData("")},this),this._streamCleanUp=w(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function v(S){var _,A,C,T,D=Math.pow(2,53),V=-D,B=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,R=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,F=this,M=0,O=0,K=!1,j=!1,H=[],W={data:[],errors:[],meta:{}};function X(pe){return S.skipEmptyLines==="greedy"?pe.join("").trim()==="":pe.length===1&&pe[0].length===0}function re(){if(W&&C&&(ue("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),C=!1),S.skipEmptyLines&&(W.data=W.data.filter(function(Q){return!X(Q)})),he()){let Q=function(Y,Z){x(S.transformHeader)&&(Y=S.transformHeader(Y,Z)),H.push(Y)};var oe=Q;if(W)if(Array.isArray(W.data[0])){for(var pe=0;he()&&pe<W.data.length;pe++)W.data[pe].forEach(Q);W.data.splice(0,1)}else W.data.forEach(Q)}function q(Q,Y){for(var Z=S.header?{}:[],ne=0;ne<Q.length;ne++){var ge=ne,ae=Q[ne],ae=((ce,fe)=>(Ae=>(S.dynamicTypingFunction&&S.dynamicTyping[Ae]===void 0&&(S.dynamicTyping[Ae]=S.dynamicTypingFunction(Ae)),(S.dynamicTyping[Ae]||S.dynamicTyping)===!0))(ce)?fe==="true"||fe==="TRUE"||fe!=="false"&&fe!=="FALSE"&&((Ae=>{if(B.test(Ae)&&(Ae=parseFloat(Ae),V<Ae&&Ae<D))return 1})(fe)?parseFloat(fe):R.test(fe)?new Date(fe):fe===""?null:fe):fe)(ge=S.header?ne>=H.length?"__parsed_extra":H[ne]:ge,ae=S.transform?S.transform(ae,ge):ae);ge==="__parsed_extra"?(Z[ge]=Z[ge]||[],Z[ge].push(ae)):Z[ge]=ae}return S.header&&(ne>H.length?ue("FieldMismatch","TooManyFields","Too many fields: expected "+H.length+" fields but parsed "+ne,O+Y):ne<H.length&&ue("FieldMismatch","TooFewFields","Too few fields: expected "+H.length+" fields but parsed "+ne,O+Y)),Z}var G;W&&(S.header||S.dynamicTyping||S.transform)&&(G=1,!W.data.length||Array.isArray(W.data[0])?(W.data=W.data.map(q),G=W.data.length):W.data=q(W.data,0),S.header&&W.meta&&(W.meta.fields=H),O+=G)}function he(){return S.header&&H.length===0}function ue(pe,q,G,oe){pe={type:pe,code:q,message:G},oe!==void 0&&(pe.row=oe),W.errors.push(pe)}x(S.step)&&(T=S.step,S.step=function(pe){W=pe,he()?re():(re(),W.data.length!==0&&(M+=pe.data.length,S.preview&&M>S.preview?A.abort():(W.data=W.data[0],T(W,F))))}),this.parse=function(pe,q,G){var oe=S.quoteChar||'"',oe=(S.newline||(S.newline=this.guessLineEndings(pe,oe)),C=!1,S.delimiter?x(S.delimiter)&&(S.delimiter=S.delimiter(pe),W.meta.delimiter=S.delimiter):((oe=((Q,Y,Z,ne,ge)=>{var ae,ce,fe,Ae;ge=ge||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Ie=0;Ie<ge.length;Ie++){for(var Te,Ge=ge[Ie],ke=0,$e=0,Be=0,We=(fe=void 0,new y({comments:ne,delimiter:Ge,newline:Y,preview:10}).parse(Q)),Ke=0;Ke<We.data.length;Ke++)Z&&X(We.data[Ke])?Be++:(Te=We.data[Ke].length,$e+=Te,fe===void 0?fe=Te:0<Te&&(ke+=Math.abs(Te-fe),fe=Te));0<We.data.length&&($e/=We.data.length-Be),(ce===void 0||ke<=ce)&&(Ae===void 0||Ae<$e)&&1.99<$e&&(ce=ke,ae=Ge,Ae=$e)}return{successful:!!(S.delimiter=ae),bestDelimiter:ae}})(pe,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess)).successful?S.delimiter=oe.bestDelimiter:(C=!0,S.delimiter=c.DefaultDelimiter),W.meta.delimiter=S.delimiter),P(S));return S.preview&&S.header&&oe.preview++,_=pe,A=new y(oe),W=A.parse(_,q,G),re(),K?{meta:{paused:!0}}:W||{meta:{paused:!1}}},this.paused=function(){return K},this.pause=function(){K=!0,A.abort(),_=x(S.chunk)?"":_.substring(A.getCharIndex())},this.resume=function(){F.streamer._halted?(K=!1,F.streamer.parseChunk(_,!0)):setTimeout(F.resume,3)},this.aborted=function(){return j},this.abort=function(){j=!0,A.abort(),W.meta.aborted=!0,x(S.complete)&&S.complete(W),_=""},this.guessLineEndings=function(Q,oe){Q=Q.substring(0,1048576);var oe=new RegExp(g(oe)+"([^]*?)"+g(oe),"gm"),G=(Q=Q.replace(oe,"")).split("\r"),oe=Q.split(`
`),Q=1<oe.length&&oe[0].length<G[0].length;if(G.length===1||Q)return`
`;for(var Y=0,Z=0;Z<G.length;Z++)G[Z][0]===`
`&&Y++;return Y>=G.length/2?`\r
`:"\r"}}function g(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(S){var _=(S=S||{}).delimiter,A=S.newline,C=S.comments,T=S.step,D=S.preview,V=S.fastMode,B=null,R=!1,F=S.quoteChar==null?'"':S.quoteChar,M=F;if(S.escapeChar!==void 0&&(M=S.escapeChar),(typeof _!="string"||-1<c.BAD_DELIMITERS.indexOf(_))&&(_=","),C===_)throw new Error("Comment character same as delimiter");C===!0?C="#":(typeof C!="string"||-1<c.BAD_DELIMITERS.indexOf(C))&&(C=!1),A!==`
`&&A!=="\r"&&A!==`\r
`&&(A=`
`);var O=0,K=!1;this.parse=function(j,H,W){if(typeof j!="string")throw new Error("Input must be a string");var X=j.length,re=_.length,he=A.length,ue=C.length,pe=x(T),q=[],G=[],oe=[],Q=O=0;if(!j)return ke();if(V||V!==!1&&j.indexOf(F)===-1){for(var Y=j.split(A),Z=0;Z<Y.length;Z++){if(oe=Y[Z],O+=oe.length,Z!==Y.length-1)O+=A.length;else if(W)return ke();if(!C||oe.substring(0,ue)!==C){if(pe){if(q=[],Ae(oe.split(_)),$e(),K)return ke()}else Ae(oe.split(_));if(D&&D<=Z)return q=q.slice(0,D),ke(!0)}}return ke()}for(var ne=j.indexOf(_,O),ge=j.indexOf(A,O),ae=new RegExp(g(M)+g(F),"g"),ce=j.indexOf(F,O);;)if(j[O]===F)for(ce=O,O++;;){if((ce=j.indexOf(F,ce+1))===-1)return W||G.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:q.length,index:O}),Te();if(ce===X-1)return Te(j.substring(O,ce).replace(ae,F));if(F===M&&j[ce+1]===M)ce++;else if(F===M||ce===0||j[ce-1]!==M){ne!==-1&&ne<ce+1&&(ne=j.indexOf(_,ce+1));var fe=Ie((ge=ge!==-1&&ge<ce+1?j.indexOf(A,ce+1):ge)===-1?ne:Math.min(ne,ge));if(j.substr(ce+1+fe,re)===_){oe.push(j.substring(O,ce).replace(ae,F)),j[O=ce+1+fe+re]!==F&&(ce=j.indexOf(F,O)),ne=j.indexOf(_,O),ge=j.indexOf(A,O);break}if(fe=Ie(ge),j.substring(ce+1+fe,ce+1+fe+he)===A){if(oe.push(j.substring(O,ce).replace(ae,F)),Ge(ce+1+fe+he),ne=j.indexOf(_,O),ce=j.indexOf(F,O),pe&&($e(),K))return ke();if(D&&q.length>=D)return ke(!0);break}G.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:q.length,index:O}),ce++}}else if(C&&oe.length===0&&j.substring(O,O+ue)===C){if(ge===-1)return ke();O=ge+he,ge=j.indexOf(A,O),ne=j.indexOf(_,O)}else if(ne!==-1&&(ne<ge||ge===-1))oe.push(j.substring(O,ne)),O=ne+re,ne=j.indexOf(_,O);else{if(ge===-1)break;if(oe.push(j.substring(O,ge)),Ge(ge+he),pe&&($e(),K))return ke();if(D&&q.length>=D)return ke(!0)}return Te();function Ae(Be){q.push(Be),Q=O}function Ie(Be){var We=0;return We=Be!==-1&&(Be=j.substring(ce+1,Be))&&Be.trim()===""?Be.length:We}function Te(Be){return W||(Be===void 0&&(Be=j.substring(O)),oe.push(Be),O=X,Ae(oe),pe&&$e()),ke()}function Ge(Be){O=Be,Ae(oe),oe=[],ge=j.indexOf(A,O)}function ke(Be){if(S.header&&!H&&q.length&&!R){var We=q[0],Ke=Object.create(null),Ee=new Set(We);let ye=!1;for(let be=0;be<We.length;be++){let Oe=We[be];if(Ke[Oe=x(S.transformHeader)?S.transformHeader(Oe,be):Oe]){let je,lt=Ke[Oe];for(;je=Oe+"_"+lt,lt++,Ee.has(je););Ee.add(je),We[be]=je,Ke[Oe]++,ye=!0,(B=B===null?{}:B)[je]=Oe}else Ke[Oe]=1,We[be]=Oe;Ee.add(Oe)}ye&&console.warn("Duplicate headers found and renamed."),R=!0}return{data:q,errors:G,meta:{delimiter:_,linebreak:A,aborted:K,truncated:!!Be,cursor:Q+(H||0),renamedHeaders:B}}}function $e(){T(ke()),q=[],G=[]}},this.abort=function(){K=!0},this.getCharIndex=function(){return O}}function E(S){var _=S.data,A=o[_.workerId],C=!1;if(_.error)A.userError(_.error,_.file);else if(_.results&&_.results.data){var T={abort:function(){C=!0,b(_.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:k,resume:k};if(x(A.userStep)){for(var D=0;D<_.results.data.length&&(A.userStep({data:_.results.data[D],errors:_.results.errors,meta:_.results.meta},T),!C);D++);delete _.results}else x(A.userChunk)&&(A.userChunk(_.results,T,_.file),delete _.results)}_.finished&&!C&&b(_.workerId,_.results)}function b(S,_){var A=o[S];x(A.userComplete)&&A.userComplete(_),A.terminate(),delete o[S]}function k(){throw new Error("Not implemented.")}function P(S){if(typeof S!="object"||S===null)return S;var _,A=Array.isArray(S)?[]:{};for(_ in S)A[_]=P(S[_]);return A}function w(S,_){return function(){S.apply(_,arguments)}}function x(S){return typeof S=="function"}return c.parse=function(S,_){var A=(_=_||{}).dynamicTyping||!1;if(x(A)&&(_.dynamicTypingFunction=A,A={}),_.dynamicTyping=A,_.transform=!!x(_.transform)&&_.transform,!_.worker||!c.WORKERS_SUPPORTED)return A=null,c.NODE_STREAM_INPUT,typeof S=="string"?(S=(C=>C.charCodeAt(0)!==65279?C:C.slice(1))(S),A=new(_.download?f:p)(_)):S.readable===!0&&x(S.read)&&x(S.on)?A=new m(_):(n.File&&S instanceof File||S instanceof Object)&&(A=new h(_)),A.stream(S);(A=(()=>{var C;return!!c.WORKERS_SUPPORTED&&(C=(()=>{var T=n.URL||n.webkitURL||null,D=r.toString();return c.BLOB_URL||(c.BLOB_URL=T.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))})(),(C=new n.Worker(C)).onmessage=E,C.id=l++,o[C.id]=C)})()).userStep=_.step,A.userChunk=_.chunk,A.userComplete=_.complete,A.userError=_.error,_.step=x(_.step),_.chunk=x(_.chunk),_.complete=x(_.complete),_.error=x(_.error),delete _.worker,A.postMessage({input:S,config:_,workerId:A.id})},c.unparse=function(S,_){var A=!1,C=!0,T=",",D=`\r
`,V='"',B=V+V,R=!1,F=null,M=!1,O=((()=>{if(typeof _=="object"){if(typeof _.delimiter!="string"||c.BAD_DELIMITERS.filter(function(H){return _.delimiter.indexOf(H)!==-1}).length||(T=_.delimiter),typeof _.quotes!="boolean"&&typeof _.quotes!="function"&&!Array.isArray(_.quotes)||(A=_.quotes),typeof _.skipEmptyLines!="boolean"&&typeof _.skipEmptyLines!="string"||(R=_.skipEmptyLines),typeof _.newline=="string"&&(D=_.newline),typeof _.quoteChar=="string"&&(V=_.quoteChar),typeof _.header=="boolean"&&(C=_.header),Array.isArray(_.columns)){if(_.columns.length===0)throw new Error("Option columns is empty");F=_.columns}_.escapeChar!==void 0&&(B=_.escapeChar+V),_.escapeFormulae instanceof RegExp?M=_.escapeFormulae:typeof _.escapeFormulae=="boolean"&&_.escapeFormulae&&(M=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(V),"g"));if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return K(null,S,R);if(typeof S[0]=="object")return K(F||Object.keys(S[0]),S,R)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||F),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),K(S.fields||[],S.data||[],R);throw new Error("Unable to serialize unrecognized input");function K(H,W,X){var re="",he=(typeof H=="string"&&(H=JSON.parse(H)),typeof W=="string"&&(W=JSON.parse(W)),Array.isArray(H)&&0<H.length),ue=!Array.isArray(W[0]);if(he&&C){for(var pe=0;pe<H.length;pe++)0<pe&&(re+=T),re+=j(H[pe],pe);0<W.length&&(re+=D)}for(var q=0;q<W.length;q++){var G=(he?H:W[q]).length,oe=!1,Q=he?Object.keys(W[q]).length===0:W[q].length===0;if(X&&!he&&(oe=X==="greedy"?W[q].join("").trim()==="":W[q].length===1&&W[q][0].length===0),X==="greedy"&&he){for(var Y=[],Z=0;Z<G;Z++){var ne=ue?H[Z]:Z;Y.push(W[q][ne])}oe=Y.join("").trim()===""}if(!oe){for(var ge=0;ge<G;ge++){0<ge&&!Q&&(re+=T);var ae=he&&ue?H[ge]:ge;re+=j(W[q][ae],ge)}q<W.length-1&&(!X||0<G&&!Q)&&(re+=D)}}return re}function j(H,W){var X,re;return H==null?"":H.constructor===Date?JSON.stringify(H).slice(1,25):(re=!1,M&&typeof H=="string"&&M.test(H)&&(H="'"+H,re=!0),X=H.toString().replace(O,B),(re=re||A===!0||typeof A=="function"&&A(H,W)||Array.isArray(A)&&A[W]||((he,ue)=>{for(var pe=0;pe<ue.length;pe++)if(-1<he.indexOf(ue[pe]))return!0;return!1})(X,c.BAD_DELIMITERS)||-1<X.indexOf(T)||X.charAt(0)===" "||X.charAt(X.length-1)===" ")?V+X+V:X)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=y,c.ParserHandle=v,c.NetworkStreamer=f,c.FileStreamer=h,c.StringStreamer=p,c.ReadableStreamStreamer=m,n.jQuery&&((s=n.jQuery).fn.parse=function(S){var _=S.config||{},A=[];return this.each(function(D){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var V=0;V<this.files.length;V++)A.push({file:this.files[V],inputElem:this,instanceConfig:s.extend({},_)})}),C(),this;function C(){if(A.length===0)x(S.complete)&&S.complete();else{var D,V,B,R,F=A[0];if(x(S.before)){var M=S.before(F.file,F.inputElem);if(typeof M=="object"){if(M.action==="abort")return D="AbortError",V=F.file,B=F.inputElem,R=M.reason,void(x(S.error)&&S.error({name:D},V,B,R));if(M.action==="skip")return void T();typeof M.config=="object"&&(F.instanceConfig=s.extend(F.instanceConfig,M.config))}else if(M==="skip")return void T()}var O=F.instanceConfig.complete;F.instanceConfig.complete=function(K){x(O)&&O(K,F.file,F.inputElem),T()},c.parse(F.file,F.instanceConfig)}}function T(){A.splice(0,1),C()}}),a&&(n.onmessage=function(S){S=S.data,c.WORKER_ID===void 0&&S&&(c.WORKER_ID=S.workerId),typeof S.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(S.input,S.config),finished:!0}):(n.File&&S.input instanceof File||S.input instanceof Object)&&(S=c.parse(S.input,S.config))&&n.postMessage({workerId:c.WORKER_ID,results:S,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,(p.prototype=Object.create(p.prototype)).constructor=p,(m.prototype=Object.create(u.prototype)).constructor=m,c})})(X4);var mz=X4.exports;const Y4=G4(mz),Mo=vo();function Q4(t){return t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(e,r)=>r.toUpperCase()).replace(/^[A-Z]/,e=>e.toLowerCase())}async function gz(t,e){if(!t)return null;const r=Object.values(e).find(n=>{var s;return n.aeriesId===t||n.aeriesId===parseInt(t)||((s=n.aeriesId)==null?void 0:s.toString())===(t==null?void 0:t.toString())});return r?r.id:(console.warn(`No Firebase user found for Aeries teacher ID: ${t}`),null)}function Iv(t){return{sourcedId:"stateId",SSID:"stateId",StateStudentID:"stateId",StudentNumber:"localId",givenName:"firstName",FirstName:"firstName",familyName:"lastName",LastName:"lastName",middleName:"middleName",MiddleName:"middleName",email:"email",Email:"email",phone:"phone",Phone:"phone",dateOfBirth:"birthDate",DOB:"birthDate",sex:"gender",Gender:"gender",grade:"grade",Grade:"grade",Address:"address",City:"city",State:"state",ZipCode:"zipCode",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",AttendanceRate:"attendanceRate",attendanceRate:"attendanceRate",Period1TeacherId:"schedule.periods.1",period1TeacherId:"schedule.periods.1",Period2TeacherId:"schedule.periods.2",period2TeacherId:"schedule.periods.2",Period3TeacherId:"schedule.periods.3",period3TeacherId:"schedule.periods.3",Period4TeacherId:"schedule.periods.4",period4TeacherId:"schedule.periods.4",Period5TeacherId:"schedule.periods.5",period5TeacherId:"schedule.periods.5",Period6TeacherId:"schedule.periods.6",period6TeacherId:"schedule.periods.6",Period7TeacherId:"schedule.periods.7",period7TeacherId:"schedule.periods.7",SHTeacherId:"schedule.periods.SH",shTeacherId:"schedule.periods.SH"}[t]||Q4(t)}function kv(t){return{SSID:"ssid",FirstName:"firstName",LastName:"lastName",MiddleName:"middleName",Grade:"grade",DOB:"dob",Gender:"gender",Ethnicity:"ethnicity",School:"school",Address:"address",City:"city",State:"state",ZipCode:"zipCode",Phone:"phone",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",ELL:"ell",504:"504",IEP:"iep",CaseManager:"caseManager",Disability:"disability",ServiceMinutes:"serviceMinutes",Goals:"goals",Notes:"notes",Plan:"plan",ReviewDate:"reviewDate",ReevalDate:"reevalDate",MeetingDate:"meetingDate",SpeechProvider:"speechProvider",MHProvider:"mhProvider",OTProvider:"otProvider",ProgramAccommodations:"programAccommodations",Accommodations:"programAccommodations",IEP_Services:"iepServices"}[t]||Q4(t)}async function vz(t){return new Promise((e,r)=>{Y4.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));const i=Object.keys(s[0]).map(o=>o.trim().toLowerCase());if(!(i.includes("sourcedid")||i.includes("ssid")||i.includes("statestudentid")))return r(new Error("Missing required 'sourcedId' or 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function xz(t,e){var a;let r=0;const n=bt(Mo,"users"),s=await $t(n),i={};s.forEach(o=>{i[o.id]={id:o.id,...o.data()}}),console.log(`Loaded ${Object.keys(i).length} users for teacher ID mapping`);for(const o of t){const l=(a=o.sourcedId||o.SSID||o.ssid||o.StateStudentID||o.stateStudentId)==null?void 0:a.trim();if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={firstName:"",lastName:"",grade:"",birthDate:"",gender:"",address:"",city:"",state:"",zipCode:"",phone:"",email:"",parentName:"",parentPhone:"",parentEmail:"",attendanceRate:"",schedule:{periods:{}}};for(const u of e){const f=Iv(u),h=o[u],p=h!=null&&typeof h=="string"?h.trim():h!=null?String(h):null;if(f.startsWith("schedule.periods.")){const m=f.split(".")[2];if(p){const v=await gz(p,i);v?(c.schedule.periods[m]=v,console.log(`Mapped Aeries teacher ID ${p} to Firebase user ID ${v} for period ${m}`)):console.warn(`Could not map Aeries teacher ID ${p} for period ${m}`)}}else c[f]=p}c.lastAeriesImport=new Date().toISOString(),console.log("Final aeriesData.schedule structure:",JSON.stringify(c.schedule,null,2));try{const u=bt(Mo,"students"),f=nr(u,Rr("app.studentData.ssid","==",l)),h=await $t(f);if(h.empty){const p=Ze(bt(Mo,"students")),m={app:{studentData:{ssid:l}},aeries:c,createdAt:Wn()};await Ht(p,m),console.log(`Created new student ${p.id} with Aeries data for SSID ${l}`)}else{const p=h.docs[0];await Ht(Ze(Mo,"students",p.id),{aeries:c},{merge:!0}),console.log(`Updated existing student ${p.id} with Aeries data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import Aeries data for SSID ${l}:`,u)}}return r}async function yz(t){return new Promise((e,r)=>{Y4.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));if(!Object.keys(s[0]).some(a=>a.trim().toLowerCase()==="ssid"))return r(new Error("Missing required 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function Ez(t,e){var n,s,i,a;let r=0;for(const o of t){const l=((n=o.SSID)==null?void 0:n.trim())||((s=o.ssid)==null?void 0:s.trim());if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={};for(const u of e){const f=kv(u);u==="IEP_Services"||u==="iep_services"?c[f]=((i=o[u])==null?void 0:i.split(";").map(h=>h.trim()))||[]:u==="ProgramAccommodations"||u==="Accommodations"?c[f]=((a=o[u])==null?void 0:a.split(";").map(h=>h.trim()))||[]:c[f]=o[u]}c.lastSeisImport=new Date().toISOString();try{const u=bt(Mo,"students"),f=nr(u,Rr("app.studentData.ssid","==",l)),h=await $t(f);if(h.empty){const p=Ze(bt(Mo,"students")),m={app:{studentData:{ssid:l}},seis:c,createdAt:Wn()};await Ht(p,m),console.log(`Created new student ${p.id} with SEIS data for SSID ${l}`)}else{const p=h.docs[0];await Ht(Ze(Mo,"students",p.id),{seis:c},{merge:!0}),console.log(`Updated existing student ${p.id} with SEIS data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import SEIS data for SSID ${l}:`,u)}}return r}const _z={name:"SeisImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=Se(()=>r.value.length>0&&s.value.length>0),c=(p,m=!1)=>{a.value=p,o.value=m,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const m=p.target.files[0];if(m){const v=Vc(m,{allowedTypes:["csv"],maxSize:10485760,fieldName:"SEIS Import File"});if(!v.isValid){c(v.error,!0),p.target.value="";return}const g=qr(m.name);if(!g.isSafe){c(`File name contains potentially dangerous content: ${g.threats.join(", ")}`,!0),p.target.value="";return}e.value=m}},previewFile:async()=>{const p=e.value;if(!p){c("❌ Please select a CSV file.",!0);return}if(!Is("seisPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const g=(await yz(p)).map(E=>{const b={};return Object.entries(E).forEach(([k,P])=>{const w=pn(k,{trim:!0,maxLength:100,removeDangerous:!0});let x=P;if(typeof P=="string"){x=pn(P,{trim:!0,maxLength:500,removeDangerous:!0});const S=qr(x);S.isSafe||(console.warn(`Security threat detected in SEIS data: ${S.threats.join(", ")}`),x="")}b[w]=x}),b});r.value=g,c(`✅ Loaded ${r.value.length} rows.`);const y=Object.keys(r.value[0]||{}).filter(E=>E.length>0);n.value=y,s.value=[...y],i.value=r.value.slice(0,5)}catch(v){c(`❌ Error: ${v.message}`,!0),console.error("SEIS Parse Error:",v)}},importData:async()=>{if(!l.value){c("❌ Cannot import: No data or fields selected.",!0);return}if(!Is("seisImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} SEIS records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const m=r.value.map(g=>{const y={};return s.value.forEach(E=>{g[E]!==void 0&&(y[E]=g[E])}),y}),v=m.filter(g=>Object.values(g).some(E=>E&&typeof E=="string"&&E.trim().length>0));if(v.length===0){c("❌ No valid records found to import.",!0);return}if(v.length!==m.length){const g=m.length-v.length;c(`⚠️ Skipping ${g} invalid records. Importing ${v.length} valid records.`)}await Ez(v,s.value),c(`✅ Successfully imported ${v.length} SEIS records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(m){c(`❌ Import failed: ${m.message}`,!0),console.error("SEIS Import Error:",m)}}}}}},bz={class:"seis-import"},Sz=["disabled"],Az={key:0,id:"seis-field-options"},Tz=["value"],wz={key:1,id:"seis-preview-container",style:{"margin-top":"1rem"}},Cz={border:"1",cellpadding:"4"},Iz=["disabled"];function kz(t,e,r,n,s,i){return N(),L("div",bz,[e[5]||(e[5]=d("h3",null,"Upload SEIS CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,Sz),n.fieldOptions.length>0?(N(),L("div",Az,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(N(!0),L(Re,null,Ve(n.fieldOptions,a=>(N(),L("label",{key:a},[we(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,Tz),[[_t,n.selectedFields]]),Ne(" "+J(a),1)]))),128))])):_e("",!0),n.previewData.length>0?(N(),L("div",wz,[d("table",Cz,[d("thead",null,[d("tr",null,[(N(!0),L(Re,null,Ve(n.fieldOptions,a=>(N(),L("th",{key:a},J(a),1))),128))])]),d("tbody",null,[(N(!0),L(Re,null,Ve(n.previewData,(a,o)=>(N(),L("tr",{key:o},[(N(!0),L(Re,null,Ve(n.fieldOptions,l=>(N(),L("td",{key:l},J(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+J(n.previewData.length)+" of "+J(n.parsedData.length)+" rows.",1)])):_e("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,Iz),d("p",{class:Qe(["status-msg",{error:n.isError}])},J(n.statusMessage),3)])}const Dz=yt(_z,[["render",kz],["__scopeId","data-v-b942d3b4"]]),Pz={name:"AeriesImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=Se(()=>r.value.length>0&&s.value.length>0),c=(p,m=!1)=>{a.value=p,o.value=m,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const m=p.target.files[0];if(m){const v=Vc(m,{allowedTypes:["csv"],maxSize:10485760,fieldName:"Aeries Import File"});if(!v.isValid){c(v.error,!0),p.target.value="";return}const g=qr(m.name);if(!g.isSafe){c(`File name contains potentially dangerous content: ${g.threats.join(", ")}`,!0),p.target.value="";return}e.value=m}},previewFile:async()=>{const p=e.value;if(!p){c("❌ Please select a CSV file.",!0);return}if(!Is("aeriesPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const g=(await vz(p)).map(E=>{const b={};return Object.entries(E).forEach(([k,P])=>{const w=pn(k,{trim:!0,maxLength:100,removeDangerous:!0});let x=P;if(typeof P=="string"){x=pn(P,{trim:!0,maxLength:500,removeDangerous:!0});const S=qr(x);S.isSafe||(console.warn(`Security threat detected in Aeries data: ${S.threats.join(", ")}`),x="")}b[w]=x}),b});r.value=g,c(`✅ Loaded ${r.value.length} rows.`);const y=Object.keys(r.value[0]||{}).filter(E=>E.length>0);n.value=y,s.value=[...y],i.value=r.value.slice(0,5)}catch(v){c(`❌ Error: ${v.message}`,!0),console.error("Aeries Parse Error:",v)}},importData:async()=>{if(!l.value){c("❌ Cannot import: No data or fields selected.",!0);return}if(!Is("aeriesImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} Aeries records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const m=r.value.map(g=>{const y={};return s.value.forEach(E=>{g[E]!==void 0&&(y[E]=g[E])}),y}),v=m.filter(g=>Object.values(g).some(E=>E&&typeof E=="string"&&E.trim().length>0));if(v.length===0){c("❌ No valid records found to import.",!0);return}if(v.length!==m.length){const g=m.length-v.length;c(`⚠️ Skipping ${g} invalid records. Importing ${v.length} valid records.`)}await xz(v,s.value),c(`✅ Successfully imported ${v.length} Aeries records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(m){c(`❌ Import failed: ${m.message}`,!0),console.error("Aeries Import Error:",m)}}}}}},Rz={class:"aeries-import"},Fz=["disabled"],Nz={key:0,id:"aeries-field-options"},Oz=["value"],Mz={key:1,id:"aeries-preview-container",style:{"margin-top":"1rem"}},Lz={border:"1",cellpadding:"4"},Bz=["disabled"];function Uz(t,e,r,n,s,i){return N(),L("div",Rz,[e[5]||(e[5]=d("h3",null,"Upload Aeries CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,Fz),n.fieldOptions.length>0?(N(),L("div",Nz,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(N(!0),L(Re,null,Ve(n.fieldOptions,a=>(N(),L("label",{key:a},[we(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,Oz),[[_t,n.selectedFields]]),Ne(" "+J(a),1)]))),128))])):_e("",!0),n.previewData.length>0?(N(),L("div",Mz,[d("table",Lz,[d("thead",null,[d("tr",null,[(N(!0),L(Re,null,Ve(n.fieldOptions,a=>(N(),L("th",{key:a},J(a),1))),128))])]),d("tbody",null,[(N(!0),L(Re,null,Ve(n.previewData,(a,o)=>(N(),L("tr",{key:o},[(N(!0),L(Re,null,Ve(n.fieldOptions,l=>(N(),L("td",{key:l},J(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+J(n.previewData.length)+" of "+J(n.parsedData.length)+" rows.",1)])):_e("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,Bz),d("p",{class:Qe(["status-msg",{error:n.isError}])},J(n.statusMessage),3)])}const $z=yt(Pz,[["render",Uz],["__scopeId","data-v-b40a9547"]]);function Vz(){const t=oc(jd()),e=se(!1),r=se(!1),n=se(""),s=se(""),i=se(!1),a=Rs({baseUrl:"encrypted",clientId:"encrypted",clientSecret:"encrypted",selectedSchoolId:"school123",selectedClassIds:["class1","class2"],selectedApiTypes:{oneroster:!0,nativeAeries:!0},selectedEndpoints:["/schools","/students","/api/special-education/students"]}),o=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"},{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),l=(C,T=!1)=>{s.value=C,i.value=T,setTimeout(()=>{s.value="",i.value=!1},5e3)},c=()=>{a.baseUrl="https://demo.aeries.net/aeries",a.clientId="1279e5c6b747b6d62b7c76db3a205d40eb7458e678a90493d537d5af6b953550",a.clientSecret="68019dbf8d8ba82980dd148eecc3977ac0d7f1f040d444225874c88eb80b9c1a",l("Demo credentials loaded. Click Connect to test.")},u=async()=>{if(!a.baseUrl||!a.clientId||!a.clientSecret)return l("Please fill in all connection fields.",!0),!1;r.value=!0,l("Connecting to Aeries API...");try{const D=(await Ca(t,"getAeriesToken")({baseUrl:a.baseUrl,clientId:a.clientId,clientSecret:a.clientSecret})).data;if(D.success&&D.access_token)return n.value=D.access_token,e.value=!0,l("✅ Successfully connected to Aeries API!"),!0;throw new Error("No access token received")}catch(C){const T=C.message||"Connection failed";return l(`❌ Connection failed: ${T}`,!0),console.error("Aeries API Connection Error:",C),!1}finally{r.value=!1}},f=()=>{e.value=!1,n.value="",l("Disconnected from Aeries API.")},h=async C=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const V=(await Ca(t,"testAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:C,accessToken:n.value})).data;if(V.success)return l(`✅ Successfully fetched data from ${C}`),{data:V.data,responseTime:V.responseTime};throw new Error(V.error||"API call failed")}catch(T){const D=T.message||"API call failed";return l(`❌ API call failed: ${D}`,!0),console.error("Aeries API Test Error:",T),{error:D}}},p=async C=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const V=(await Ca(t,"testCustomAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:C,accessToken:n.value})).data;return V.success?(l(`✅ Successfully fetched data from ${C}`),{data:V.data,responseTime:V.responseTime}):{error:V.error||"API call failed"}}catch(T){const D=T.message||"API call failed";return l(`❌ API call failed: ${D}`,!0),console.error("Custom Aeries API Test Error:",T),{error:D}}},m=async()=>await h("/students"),v=async()=>await h("/teachers"),g=async()=>{const C=["/api/special-education/students","/api/students/special-education","/api/iep/students","/api/504/students"];for(const T of C){const D=await p(T);if(D&&!D.error)return D}return{error:"No special education endpoints found"}},y=async()=>await p("/api/special-education/ieps"),E=async()=>await p("/api/special-education/504-plans"),b=async()=>await p("/api/special-education/accommodations"),k=async()=>await p("/api/special-education/services"),P=async()=>await p("/api/special-education/case-managers"),w=async()=>{const C={},T=o.value.filter(D=>D.path.includes("special-education")||D.path.includes("iep")||D.path.includes("504"));for(const D of T)C[D.path]=await p(D.path);return C},x=async()=>{var T;const C=await h("/students");if(C&&!C.error&&C.data){const D=((T=C.data.students)==null?void 0:T[0])||C.data[0],V=D&&(D.specialEducation||D.iep||D.plan504||D.disabilities||D.accommodations);return{success:!0,hasSpecialEdFields:V,sampleStudent:D,message:V?"OneRoster includes special education data!":"OneRoster does not include special education data"}}return C},S=async()=>{const C=["?filter=specialEducation=true","?filter=iep=true","?filter=plan504=true","?filter=disabilities=*","?filter=accommodations=*"],T={};for(const D of C)T[D]=await h(`/students${D}`);return T};async function _({baseUrl:C,accessToken:T}){const D=oc(),R=await Ca(D,"testAeriesEndpoint")({baseUrl:C,endpoint:"/schools",accessToken:T});return R.data.data.orgs||R.data.data.schools||R.data.data||[]}async function A({baseUrl:C,accessToken:T,schoolId:D}){const V=oc(),B=Ca(V,"testAeriesEndpoint"),R=`/classes?filter=school.sourcedId='${D}'`,F=await B({baseUrl:C,endpoint:R,accessToken:T});return F.data.data.classes||F.data.data||[]}return{isConnected:e,isConnecting:r,accessToken:n,connectionStatus:s,isError:i,connectionConfig:a,availableEndpoints:o,showStatus:l,loadDemoCredentials:c,connect:u,disconnect:f,testEndpoint:h,testCustomEndpoint:p,fetchStudents:m,fetchTeachers:v,fetchSpecialEducationStudents:g,fetchIEPRecords:y,fetch504Plans:E,fetchAccommodations:b,fetchServices:k,fetchCaseManagers:P,testAllSpecialEducationEndpoints:w,testOneRosterForSpecialEd:x,testStudentsWithSpecialEd:S,fetchSchools:_,fetchClasses:A}}const ng=(t,e)=>{let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t.charCodeAt(n)^e.charCodeAt(n%e.length));return btoa(r)},sg=(t,e)=>{const r=atob(t);let n="";for(let s=0;s<r.length;s++)n+=String.fromCharCode(r.charCodeAt(s)^e.charCodeAt(s%e.length));return n};function Hz(){const t=vo(),e=Yo(),r=se(!1),n=se(null),s=()=>{const c=e.currentUser;if(!c)throw new Error("User not authenticated");return c.uid+"_aeries_config_key"};return{isLoading:r,error:n,saveAeriesConfig:async c=>{if(!e.currentUser)throw new Error("User must be authenticated to save configuration");r.value=!0,n.value=null;try{const u=e.currentUser,f=s(),h={baseUrl:ng(c.baseUrl,f),clientId:ng(c.clientId,f),clientSecret:ng(c.clientSecret,f),selectedSchoolId:c.selectedSchoolId||"",selectedClassIds:c.selectedClassIds||[],manualClassInput:c.manualClassInput||"",savedAt:new Date().toISOString(),userId:u.uid},p=Ze(t,"users",u.uid,"aeries_config","current");return await Ht(p,h),{success:!0,message:"Configuration saved securely"}}catch(u){throw n.value=u.message,console.error("Failed to save Aeries configuration:",u),u}finally{r.value=!1}},loadAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to load configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=s(),f=Ze(t,"users",c.uid,"aeries_config","current"),h=await Jt(f);if(!h.exists())return null;const p=h.data();if(p.userId!==c.uid)throw new Error("Configuration security check failed");return{baseUrl:sg(p.baseUrl,u),clientId:sg(p.clientId,u),clientSecret:sg(p.clientSecret,u),selectedSchoolId:p.selectedSchoolId||"",selectedClassIds:p.selectedClassIds||[],manualClassInput:p.manualClassInput||"",savedAt:p.savedAt}}catch(c){throw n.value=c.message,console.error("Failed to load Aeries configuration:",c),c}finally{r.value=!1}},deleteAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to delete configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=Ze(t,"users",c.uid,"aeries_config","current");return await ho(u),{success:!0,message:"Configuration deleted securely"}}catch(c){throw n.value=c.message,console.error("Failed to delete Aeries configuration:",c),c}finally{r.value=!1}},hasSavedConfig:async()=>{if(!e.currentUser)return!1;try{const c=e.currentUser,u=Ze(t,"users",c.uid,"aeries_config","current");return(await Jt(u)).exists()}catch(c){return console.error("Failed to check for saved configuration:",c),!1}}}}const jz={name:"AeriesAPIConnector",setup(){const{isConnected:t,isConnecting:e,accessToken:r,connectionStatus:n,isError:s,connectionConfig:i,availableEndpoints:a,showStatus:o,loadDemoCredentials:l,connect:c,disconnect:u,testEndpoint:f,testAllSpecialEducationEndpoints:h,testOneRosterForSpecialEd:p,testStudentsWithSpecialEd:m,fetchSchools:v,fetchClasses:g}=Vz(),{isLoading:y,error:E,saveAeriesConfig:b,loadAeriesConfig:k,deleteAeriesConfig:P,hasSavedConfig:w}=Hz(),x=se(!1),S=se(null),_=se(""),A=se(null),C=se([]),T=se(""),D=se([]),V=se([]),B=se(!1),R=se(""),F=se(""),M=se(!1),O=se({oneroster:!1,nativeAeries:!1}),K=se([]),j=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"}]),H=se([{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),W=Se(()=>i.baseUrl&&i.clientId&&i.clientSecret),X=async()=>{if(await c())try{x.value=!0;const ce=await v({baseUrl:i.baseUrl,accessToken:r.value});C.value=ce||[],T.value=""}catch(ce){console.error("Failed to fetch schools:",ce),o("Failed to fetch schools",!0),C.value=[]}finally{x.value=!1}},re=async ae=>{x.value=!0,_.value=ae,S.value=null,A.value=null;const ce=await f(ae);ce&&!ce.error?(S.value=ce.data,A.value=ce.responseTime):ce&&ce.error&&(S.value={error:ce.error}),x.value=!1},he=async()=>{x.value=!0,await h(),x.value=!1},ue=async()=>{x.value=!0,_.value="/students (SPED check)",S.value=null,A.value=null;const ae=await p();ae&&!ae.error?(S.value=ae,o(ae.message)):ae&&ae.error&&(S.value={error:ae.error},o(`❌ OneRoster test failed: ${ae.error}`,!0)),x.value=!1},pe=async()=>{x.value=!0,_.value="/students (SPED filters)",S.value=null,A.value=null;const ae=await m();ae&&(S.value=ae,o("OneRoster SPED filter tests completed")),x.value=!1};Vt(T,async ae=>{if(!ae){D.value=[],V.value=[];return}B.value=!1,R.value="",x.value=!0;try{D.value=await g({baseUrl:i.baseUrl,accessToken:r.value,schoolId:ae}),V.value=[]}catch{B.value=!0,D.value=[],V.value=[]}finally{x.value=!1}});const q=Se(()=>t.value&&C.value.length>0),G=Se(()=>q.value&&T.value),oe=Se(()=>O.value.oneroster||O.value.nativeAeries),Q=()=>{const ae=[];O.value.oneroster&&ae.push(...j.value),O.value.nativeAeries&&ae.push(...H.value),a.value=ae},Y=(ae,ce=!1)=>{F.value=ae,M.value=ce,setTimeout(()=>{F.value="",M.value=!1},5e3)},Z=async()=>{try{const ae={baseUrl:i.baseUrl,clientId:i.clientId,clientSecret:i.clientSecret,selectedSchoolId:T.value,selectedClassIds:V.value,manualClassInput:R.value,selectedApiTypes:O.value,selectedEndpoints:K.value};await b(ae),Y("✅ Configuration saved securely to Firebase!")}catch(ae){console.error("Failed to save configuration:",ae),Y(`❌ Failed to save configuration: ${ae.message}`,!0)}},ne=async()=>{try{const ae=await k();if(!ae){Y("❌ No saved configuration found",!0);return}i.baseUrl=ae.baseUrl||"",i.clientId=ae.clientId||"",i.clientSecret=ae.clientSecret||"",T.value=ae.selectedSchoolId||"",V.value=ae.selectedClassIds||[],R.value=ae.manualClassInput||"",ae.selectedApiTypes&&(O.value=ae.selectedApiTypes),ae.selectedEndpoints&&(K.value=ae.selectedEndpoints),Q();const ce=ae.savedAt?new Date(ae.savedAt).toLocaleString():"Unknown";Y(`✅ Configuration loaded securely (saved: ${ce})`)}catch(ae){console.error("Failed to load configuration:",ae),Y(`❌ Failed to load configuration: ${ae.message}`,!0)}},ge=async()=>{if(confirm("Are you sure you want to permanently delete the saved configuration? This action cannot be undone."))try{await P(),Y("✅ Configuration permanently deleted from Firebase!")}catch(ae){console.error("Failed to clear configuration:",ae),Y(`❌ Failed to clear configuration: ${ae.message}`,!0)}};return Ut(async()=>{try{if(await w()){const ce=await k();ce&&(i.baseUrl=ce.baseUrl||"",i.clientId=ce.clientId||"",i.clientSecret=ce.clientSecret||"",ce.selectedApiTypes&&(O.value=ce.selectedApiTypes),ce.selectedEndpoints&&(K.value=ce.selectedEndpoints),Q(),Y("✅ Configuration auto-loaded securely from Firebase"))}}catch(ae){console.error("Failed to auto-load configuration:",ae)}}),{connectionConfig:i,isConnected:t,isConnecting:e,isLoading:x,connectionStatus:n,isError:s,apiResults:S,currentEndpoint:_,responseTime:A,availableEndpoints:a,canConnect:W,loadDemoCredentials:l,connect:X,disconnect:u,testEndpoint:re,handleTestSpecialEd:he,handleTestOneRosterSpecialEd:ue,handleTestStudentsWithSpecialEd:pe,schools:C,selectedSchoolId:T,classes:D,selectedClassIds:V,classesFetchError:B,manualClassInput:R,canShowSchoolDropdown:q,canShowClasses:G,configStatus:F,configError:M,storageLoading:y,storageError:E,saveConfiguration:Z,loadConfiguration:ne,clearConfiguration:ge,selectedApiTypes:O,selectedEndpoints:K,onerosterEndpoints:j,nativeAeriesEndpoints:H,hasSelectedApiTypes:oe,updateAvailableEndpoints:Q}}},Gz={class:"aeries-api-connector"},Wz={class:"connection-form"},zz={class:"form-group"},Kz=["disabled"],qz={class:"form-group"},Xz=["disabled"],Yz={class:"form-group"},Qz=["disabled"],Jz={class:"button-group"},Zz=["disabled"],eK=["disabled"],tK={class:"api-type-selection"},rK={class:"api-type-options"},nK={class:"api-type-option"},sK={class:"checkbox-label"},aK={class:"api-type-option"},iK={class:"checkbox-label"},oK={key:0,class:"endpoint-selection"},lK={class:"endpoint-categories"},cK={key:0,class:"endpoint-category"},uK={class:"endpoint-checkboxes"},dK=["value"],fK={class:"endpoint-name"},hK={class:"endpoint-path-small"},pK={key:1,class:"endpoint-category"},mK={class:"endpoint-checkboxes"},gK=["value"],vK={class:"endpoint-name"},xK={class:"endpoint-path-small"},yK={class:"config-management"},EK={class:"config-buttons"},_K=["disabled"],bK=["disabled"],SK=["disabled"],AK={key:1,class:"api-testing"},TK={class:"special-ed-section"},wK={class:"quick-test-buttons"},CK=["disabled"],IK=["disabled"],kK=["disabled"],DK=["disabled"],PK=["disabled"],RK=["disabled"],FK={class:"endpoint-grid"},NK={class:"endpoint-path"},OK={class:"endpoint-description"},MK=["onClick","disabled"],LK={key:0,class:"api-results"},BK={class:"results-header"},UK={class:"endpoint-tested"},$K={key:0,class:"response-time"},VK={class:"results-content"},HK={key:2,class:"form-group"},jK=["value"],GK={key:3,class:"form-group"},WK={key:0},zK=["value"],KK={key:1};function qK(t,e,r,n,s,i){return N(),L("div",Gz,[e[48]||(e[48]=Fr('<h3 data-v-0f37c4fc>Aeries API Connection</h3><div class="api-info-section" data-v-0f37c4fc><h4 data-v-0f37c4fc>Getting Students with IEP/504 Plans</h4><div class="info-grid" data-v-0f37c4fc><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc>🔍 OneRoster API (Limited)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> All students, basic info</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Cannot filter:</strong> Students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> You&#39;d get ALL students, not just SPED</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc>🎯 Custom Aeries API (Recommended)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Only students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Includes:</strong> Accommodations, services, case managers</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Perfect for your use case</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc>📋 CSV Import (Fallback)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Filtered data from Aeries export</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Process:</strong> Export SPED students → Import CSV</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Works but requires manual steps</p></div></div><div class="testing-note" data-v-0f37c4fc><p data-v-0f37c4fc><strong data-v-0f37c4fc>Test the buttons below to see what your Aeries instance supports!</strong></p></div></div>',2)),d("div",Wz,[d("div",zz,[e[24]||(e[24]=d("label",{for:"baseUrl"},"Base URL:",-1)),we(d("input",{id:"baseUrl","onUpdate:modelValue":e[0]||(e[0]=a=>n.connectionConfig.baseUrl=a),type:"url",placeholder:"https://demo.aeries.net/aeries",disabled:n.isConnected},null,8,Kz),[[Ye,n.connectionConfig.baseUrl]])]),d("div",qz,[e[25]||(e[25]=d("label",{for:"clientId"},"Client ID:",-1)),we(d("input",{id:"clientId","onUpdate:modelValue":e[1]||(e[1]=a=>n.connectionConfig.clientId=a),type:"text",placeholder:"Enter your Client ID",disabled:n.isConnected},null,8,Xz),[[Ye,n.connectionConfig.clientId]])]),d("div",Yz,[e[26]||(e[26]=d("label",{for:"clientSecret"},"Client Secret:",-1)),we(d("input",{id:"clientSecret","onUpdate:modelValue":e[2]||(e[2]=a=>n.connectionConfig.clientSecret=a),type:"password",placeholder:"Enter your Client Secret",disabled:n.isConnected},null,8,Qz),[[Ye,n.connectionConfig.clientSecret]])]),d("div",Jz,[d("button",{onClick:e[3]||(e[3]=(...a)=>n.connect&&n.connect(...a)),disabled:!n.canConnect||n.isConnecting,class:"btn-primary"},J(n.isConnecting?"Connecting...":"Connect"),9,Zz),n.isConnected?(N(),L("button",{key:0,onClick:e[4]||(e[4]=(...a)=>n.disconnect&&n.disconnect(...a)),class:"btn-secondary"}," Disconnect ")):_e("",!0),d("button",{onClick:e[5]||(e[5]=(...a)=>n.loadDemoCredentials&&n.loadDemoCredentials(...a)),disabled:n.isConnected,class:"btn-demo"}," Load Demo Credentials ",8,eK)]),d("div",tK,[e[37]||(e[37]=d("h4",null,"Select API Types",-1)),e[38]||(e[38]=d("p",{class:"api-type-description"},"Choose which Aeries API types you want to use. This determines which endpoints will be available for testing and data import.",-1)),d("div",rK,[d("div",nK,[d("label",sK,[we(d("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>n.selectedApiTypes.oneroster=a),onChange:e[7]||(e[7]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[_t,n.selectedApiTypes.oneroster]]),e[27]||(e[27]=d("span",{class:"checkmark"},null,-1)),e[28]||(e[28]=d("strong",null,"OneRoster API",-1))]),e[29]||(e[29]=d("p",{class:"api-type-desc"},"Standard OneRoster endpoints for basic student, teacher, and class data",-1))]),d("div",aK,[d("label",iK,[we(d("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=a=>n.selectedApiTypes.nativeAeries=a),onChange:e[9]||(e[9]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[_t,n.selectedApiTypes.nativeAeries]]),e[30]||(e[30]=d("span",{class:"checkmark"},null,-1)),e[31]||(e[31]=d("strong",null,"Native Aeries v5 API",-1))]),e[32]||(e[32]=d("p",{class:"api-type-desc"},"Aeries-specific endpoints for special education, IEP, and 504 plan data",-1))])]),n.hasSelectedApiTypes?(N(),L("div",oK,[e[35]||(e[35]=d("h5",null,"Select Endpoints to Use",-1)),e[36]||(e[36]=d("p",{class:"endpoint-description"},"Check the endpoints you want to enable for data import and testing.",-1)),d("div",lK,[n.selectedApiTypes.oneroster?(N(),L("div",cK,[e[33]||(e[33]=d("h6",null,"OneRoster Endpoints",-1)),d("div",uK,[(N(!0),L(Re,null,Ve(n.onerosterEndpoints,a=>(N(),L("label",{key:a.path,class:"endpoint-checkbox"},[we(d("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=o=>n.selectedEndpoints=o),value:a.path},null,8,dK),[[_t,n.selectedEndpoints]]),d("span",fK,J(a.name),1),d("span",hK,J(a.path),1)]))),128))])])):_e("",!0),n.selectedApiTypes.nativeAeries?(N(),L("div",pK,[e[34]||(e[34]=d("h6",null,"Native Aeries v5 Endpoints",-1)),d("div",mK,[(N(!0),L(Re,null,Ve(n.nativeAeriesEndpoints,a=>(N(),L("label",{key:a.path,class:"endpoint-checkbox"},[we(d("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=o=>n.selectedEndpoints=o),value:a.path},null,8,gK),[[_t,n.selectedEndpoints]]),d("span",vK,J(a.name),1),d("span",xK,J(a.path),1)]))),128))])])):_e("",!0)])])):_e("",!0)]),d("div",yK,[e[39]||(e[39]=d("h4",null,"Save/Load Configuration",-1)),e[40]||(e[40]=d("div",{class:"security-note"},[d("p",null,[d("strong",null,"🔒 Security:"),Ne(" Your API credentials are encrypted and stored securely in Firebase. Only you can access your saved configuration.")])],-1)),d("div",EK,[d("button",{onClick:e[12]||(e[12]=(...a)=>n.saveConfiguration&&n.saveConfiguration(...a)),disabled:!n.canConnect||n.storageLoading,class:"btn-save"},J(n.storageLoading?"⏳ Saving...":"💾 Save Configuration"),9,_K),d("button",{onClick:e[13]||(e[13]=(...a)=>n.loadConfiguration&&n.loadConfiguration(...a)),disabled:n.storageLoading,class:"btn-load"},J(n.storageLoading?"⏳ Loading...":"📂 Load Saved Configuration"),9,bK),d("button",{onClick:e[14]||(e[14]=(...a)=>n.clearConfiguration&&n.clearConfiguration(...a)),disabled:n.storageLoading,class:"btn-clear"},J(n.storageLoading?"⏳ Deleting...":"🗑️ Clear Saved Configuration"),9,SK)]),n.configStatus?(N(),L("div",{key:0,class:Qe(["config-status",{error:n.configError}])},J(n.configStatus),3)):_e("",!0)])]),n.connectionStatus?(N(),L("div",{key:0,class:Qe(["status-message",{error:n.isError}])},J(n.connectionStatus),3)):_e("",!0),n.isConnected?(N(),L("div",AK,[e[43]||(e[43]=d("h4",null,"Test API Endpoints",-1)),d("div",TK,[e[41]||(e[41]=d("h5",null,"Special Education Data (IEP/504)",-1)),d("div",wK,[d("button",{onClick:e[15]||(e[15]=(...a)=>n.handleTestSpecialEd&&n.handleTestSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-special"},J(n.isLoading?"Testing...":"Test All SPED Endpoints"),9,CK),d("button",{onClick:e[16]||(e[16]=(...a)=>n.handleTestOneRosterSpecialEd&&n.handleTestOneRosterSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster for SPED Data ",8,IK),d("button",{onClick:e[17]||(e[17]=(...a)=>n.handleTestStudentsWithSpecialEd&&n.handleTestStudentsWithSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster SPED Filters ",8,kK),d("button",{onClick:e[18]||(e[18]=a=>t.handleTestEndpoint("/api/special-education/students")),disabled:n.isLoading,class:"btn-test-special"}," SPED Students ",8,DK),d("button",{onClick:e[19]||(e[19]=a=>t.handleTestEndpoint("/api/special-education/ieps")),disabled:n.isLoading,class:"btn-test-special"}," IEP Records ",8,PK),d("button",{onClick:e[20]||(e[20]=a=>t.handleTestEndpoint("/api/special-education/504-plans")),disabled:n.isLoading,class:"btn-test-special"}," 504 Plans ",8,RK)])]),d("div",FK,[(N(!0),L(Re,null,Ve(n.availableEndpoints,a=>(N(),L("div",{key:a.path,class:"endpoint-card"},[d("h5",null,J(a.name),1),d("p",NK,J(a.path),1),d("p",OK,J(a.description),1),d("button",{onClick:o=>n.testEndpoint(a.path),disabled:n.isLoading,class:"btn-test"},J(n.isLoading&&n.currentEndpoint===a.path?"Testing...":"Test"),9,MK)]))),128))]),n.apiResults?(N(),L("div",LK,[e[42]||(e[42]=d("h4",null,"API Response",-1)),d("div",BK,[d("span",UK,"Endpoint: "+J(n.currentEndpoint),1),n.responseTime?(N(),L("span",$K,"Response time: "+J(n.responseTime)+"ms",1)):_e("",!0)]),d("div",VK,[d("pre",null,J(JSON.stringify(n.apiResults,null,2)),1)])])):_e("",!0)])):_e("",!0),n.canShowSchoolDropdown?(N(),L("div",HK,[e[45]||(e[45]=d("label",null,"School",-1)),we(d("select",{"onUpdate:modelValue":e[21]||(e[21]=a=>n.selectedSchoolId=a)},[e[44]||(e[44]=d("option",{value:"",disabled:""},"Select a school",-1)),(N(!0),L(Re,null,Ve(n.schools,a=>(N(),L("option",{key:a.sourcedId||a.id||a.schoolId,value:a.sourcedId||a.id||a.schoolId},J(a.name||a.title||a.schoolName),9,jK))),128))],512),[[ur,n.selectedSchoolId]])])):_e("",!0),n.canShowClasses?(N(),L("div",GK,[e[47]||(e[47]=d("label",null,"Case Manager Classes",-1)),n.classesFetchError?(N(),L("div",KK,[e[46]||(e[46]=d("p",{class:"error"},"Could not fetch classes. Enter class names manually (comma separated):",-1)),we(d("input",{"onUpdate:modelValue":e[23]||(e[23]=a=>n.manualClassInput=a),type:"text",placeholder:"Class1, Class2, ..."},null,512),[[Ye,n.manualClassInput]])])):(N(),L("div",WK,[we(d("select",{"onUpdate:modelValue":e[22]||(e[22]=a=>n.selectedClassIds=a),multiple:""},[(N(!0),L(Re,null,Ve(n.classes,a=>(N(),L("option",{key:a.sourcedId||a.id||a.classId,value:a.sourcedId||a.id||a.classId},J(a.title||a.name||a.className),9,zK))),128))],512),[[ur,n.selectedClassIds]])]))])):_e("",!0)])}const XK=yt(jz,[["render",qK],["__scopeId","data-v-0f37c4fc"]]),YK={key:0,class:"app-settings-panel"},QK={class:"settings-section"},JK={class:"grades-checkboxes"},ZK=["checked"],eq=["value"],tq={class:"settings-section"},rq={key:0,class:"class-service-fieldset"},nq={class:"checkbox-inline-group"},sq=["value"],aq={key:1,class:"class-service-fieldset"},iq={class:"checkbox-inline-group"},oq=["value"],lq={key:2,class:"class-service-fieldset"},cq={class:"checkbox-inline-group"},uq=["value"],dq={key:3,class:"class-service-fieldset"},fq={class:"checkbox-inline-group"},hq={key:4,class:"class-service-fieldset"},pq={class:"checkbox-inline-group"},mq=["onClick"],gq={class:"checkbox-inline-group"},vq=["onClick"],xq=["onClick"],yq={class:"add-class-service"},Eq={class:"custom-chips"},_q=["onClick"],bq={class:"settings-section"},Sq={class:"service-providers-defaults"},Aq=["value"],Tq={class:"service-providers-custom"},wq={class:"custom-provider-inputs"},Cq={class:"custom-chips"},Iq=["onClick"],kq={class:"settings-section"},Dq={class:"periods-controls"},Pq={class:"period-number-control"},Rq={key:0,class:"period-labels"},Fq={class:"period-labels-grid"},Nq=["onUpdate:modelValue","placeholder"],Oq={key:1,class:"period-preview"},Mq={class:"settings-section"},Lq={class:"admin-action-btns"},Bq=["disabled"],Uq=["disabled"],$q=["disabled"],Vq={key:1,class:"not-admin"},Hq={__name:"AppSettings",setup(t){const{currentUser:e}=nf(),r=Se(()=>{var A;return((A=e.value)==null?void 0:A.role)||null}),n=Se(()=>["admin","school_admin","admin_504","sped_chair"].includes(r.value)),s=[{value:"K",label:"K"},...Array.from({length:12},(A,C)=>({value:(C+1).toString(),label:(C+1).toString()}))],i=["English","Math","History","Science"],a=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],{loadAppSettings:o,saveAppSettings:l}=zs(),c=se(!1),u=se(!1),f=se(""),h=se(!1),p=se(""),m=se(""),v=se({grades:["7","8"],classServices:[{name:"SDC",enabledSubcategories:[...i]},{name:"Co-teach",enabledSubcategories:[...i]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:a,customServiceProviders:[],numPeriods:7,periodLabels:["Per1","Per2","Per3","Per4","Per5","Per6","Per7"]}),g=()=>{const A=Sb(v.value.numPeriods,{min:1,max:15,decimals:0});if(A===null)return w("Invalid number of periods. Must be between 1 and 15.",!0),!1;v.value.numPeriods=A;for(let C=0;C<v.value.numPeriods;C++){v.value.periodLabels[C]||(v.value.periodLabels[C]=`Per${C+1}`);const T=pn(v.value.periodLabels[C],{trim:!0,maxLength:3,removeDangerous:!0}),D=qr(T);if(!D.isSafe)return w(`Security threat detected in period ${C+1} label: ${D.threats.join(", ")}`,!0),!1;const V=Ad(T,{max:3,fieldName:`Period ${C+1} label`});if(!V.isValid)return w(V.error,!0),!1;v.value.periodLabels[C]=T}if(v.value.customServiceProviders)for(let C=0;C<v.value.customServiceProviders.length;C++){const T=v.value.customServiceProviders[C];if(T.name){const D=pn(T.name,{trim:!0,maxLength:100,removeDangerous:!0}),V=qr(D);if(!V.isSafe)return w(`Security threat detected in custom provider ${C+1}: ${V.threats.join(", ")}`,!0),!1;T.name=D}if(T.abbreviation){const D=pn(T.abbreviation,{trim:!0,maxLength:10,removeDangerous:!0}),V=qr(D);if(!V.isSafe)return w(`Security threat detected in custom provider abbreviation ${C+1}: ${V.threats.join(", ")}`,!0),!1;T.abbreviation=D}}return!0},y=Se(()=>a),E=Se(()=>s.every(A=>v.value.grades.includes(A.value))),b=A=>{A.target.checked?v.value.grades=s.map(C=>C.value):v.value.grades=[]},k=()=>{if(!p.value.trim()||!m.value.trim()){w("Both name and abbreviation are required for custom service providers",!0);return}if(v.value.customServiceProviders.some(C=>C.abbreviation.toLowerCase()===m.value.toLowerCase())){w("A service provider with this abbreviation already exists",!0);return}v.value.customServiceProviders.push({name:p.value.trim(),abbreviation:m.value.trim()}),p.value="",m.value="",w("Custom service provider added successfully")},P=A=>{v.value.customServiceProviders.splice(A,1)};Vt(()=>v.value.numPeriods,A=>{const C=Sb(A,{min:1,max:15,decimals:0});if(C!==null&&C!==A&&(v.value.numPeriods=C),v.value.periodLabels.length<v.value.numPeriods)for(let T=v.value.periodLabels.length;T<v.value.numPeriods;T++)v.value.periodLabels.push(`Per${T+1}`)}),Vt(()=>v.value.periodLabels,A=>{A.forEach((C,T)=>{C&&C.length>3&&(v.value.periodLabels[T]=C.substring(0,3))})},{deep:!0});const w=(A,C=!1)=>{f.value=A,h.value=C,setTimeout(()=>{f.value="",h.value=!1},5e3)},x=async(A=!1)=>{c.value=!0;try{const C=await o();if(C){if(v.value={...v.value,...C},!v.value.periodLabels||v.value.periodLabels.length<v.value.numPeriods){v.value.periodLabels=[];for(let T=0;T<v.value.numPeriods;T++)v.value.periodLabels[T]=v.value.periodLabels[T]||`Per${T+1}`}A&&w("Settings loaded successfully")}}catch(C){w("Error loading settings",!0),console.error("Load settings error:",C)}finally{c.value=!1}},S=async()=>{if(!Is("saveAppSettings",10,6e4).allowed){w("Too many save requests. Please wait before saving again.",!0);return}if(g()){u.value=!0;try{await l(v.value),w("Settings saved successfully")}catch(C){w("Error saving settings",!0),console.error("Save settings error:",C)}finally{u.value=!1}}},_=()=>{confirm("Are you sure you want to reset all settings to defaults? This cannot be undone.")&&(v.value={grades:["7","8"],classServices:[{name:"SDC",enabledSubcategories:[...i]},{name:"Co-teach",enabledSubcategories:[...i]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:a,customServiceProviders:[],numPeriods:7,periodLabels:["Per1","Per2","Per3","Per4","Per5","Per6","Per7"]},w("Settings reset to defaults"))};return Ut(()=>{x()}),(A,C)=>n.value?(N(),L("div",YK,[C[33]||(C[33]=d("h2",null,"App Settings",-1)),d("form",{onSubmit:dn(S,["prevent"])},[d("section",QK,[d("fieldset",null,[C[17]||(C[17]=d("legend",null,"Grades",-1)),d("div",JK,[d("label",null,[d("input",{type:"checkbox",checked:E.value,onChange:b},null,40,ZK),C[16]||(C[16]=d("span",null,"Select All",-1))]),(N(),L(Re,null,Ve(s,T=>d("label",{key:T.value},[we(d("input",{type:"checkbox","onUpdate:modelValue":C[0]||(C[0]=D=>v.value.grades=D),value:T.value},null,8,eq),[[_t,v.value.grades]]),d("span",null,J(T.label),1)])),64))])])]),d("section",tq,[C[26]||(C[26]=d("h3",null,"Class Services",-1)),v.value.classServices[0]&&v.value.classServices[0].enabledSubcategories?(N(),L("div",rq,[d("fieldset",null,[C[18]||(C[18]=d("legend",null,"SDC",-1)),d("div",nq,[(N(),L(Re,null,Ve(i,T=>d("label",{key:T},[we(d("input",{type:"checkbox","onUpdate:modelValue":C[1]||(C[1]=D=>v.value.classServices[0].enabledSubcategories=D),value:T},null,8,sq),[[_t,v.value.classServices[0].enabledSubcategories]]),Ne(" "+J(T),1)])),64))])])])):_e("",!0),v.value.classServices[1]&&v.value.classServices[1].enabledSubcategories?(N(),L("div",aq,[d("fieldset",null,[C[19]||(C[19]=d("legend",null,"Co-teach",-1)),d("div",iq,[(N(),L(Re,null,Ve(i,T=>d("label",{key:T},[we(d("input",{type:"checkbox","onUpdate:modelValue":C[2]||(C[2]=D=>v.value.classServices[1].enabledSubcategories=D),value:T},null,8,oq),[[_t,v.value.classServices[1].enabledSubcategories]]),Ne(" "+J(T),1)])),64))])])])):_e("",!0),v.value.classServices[2]&&v.value.classServices[2].enabledSubcategories?(N(),L("div",lq,[d("fieldset",null,[C[20]||(C[20]=d("legend",null,"RSP",-1)),d("div",cq,[(N(),L(Re,null,Ve(i,T=>d("label",{key:T},[we(d("input",{type:"checkbox","onUpdate:modelValue":C[3]||(C[3]=D=>v.value.classServices[2].enabledSubcategories=D),value:T},null,8,uq),[[_t,v.value.classServices[2].enabledSubcategories]]),Ne(" "+J(T),1)])),64))])])])):_e("",!0),v.value.classServices[3]&&v.value.classServices[3].enabledSubcategories?(N(),L("div",dq,[d("fieldset",null,[C[22]||(C[22]=d("legend",null,"Directed Studies",-1)),d("div",fq,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":C[4]||(C[4]=T=>v.value.classServices[3].enabledSubcategories=T),value:"Directed Studies"},null,512),[[_t,v.value.classServices[3].enabledSubcategories]]),C[21]||(C[21]=Ne(" Directed Studies "))])])])])):_e("",!0),v.value.classServices[4]&&v.value.classServices[4].enabledSubcategories?(N(),L("div",hq,[d("fieldset",null,[C[24]||(C[24]=d("legend",null,"FA",-1)),d("div",pq,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":C[5]||(C[5]=T=>v.value.classServices[4].enabledSubcategories=T),value:"FA"},null,512),[[_t,v.value.classServices[4].enabledSubcategories]]),C[23]||(C[23]=Ne(" FA "))])])])])):_e("",!0),(N(!0),L(Re,null,Ve(v.value.classServices.slice(5),(T,D)=>(N(),L("div",{key:T.name,class:"class-service-fieldset"},[d("fieldset",null,[d("legend",null,[Ne(J(T.name)+" ",1),d("button",{type:"button",onClick:V=>A.removeClassService(D+5),title:"Remove Service"},"×",8,mq)]),d("div",gq,[(N(!0),L(Re,null,Ve(T.subcategories,(V,B)=>(N(),L("label",{key:V},[C[25]||(C[25]=d("input",{type:"checkbox",checked:!0,disabled:""},null,-1)),Ne(" "+J(V)+" ",1),d("button",{type:"button",onClick:R=>A.removeSubcategory(D+5,B),title:"Remove Subcategory"},"×",8,vq)]))),128)),d("button",{type:"button",onClick:V=>A.addSubcategory(D+5)},"+ Add Subcategory",8,xq)])])]))),128)),d("div",yq,[we(d("input",{type:"text","onUpdate:modelValue":C[6]||(C[6]=T=>A.newServiceName=T),placeholder:"New Service Name",maxlength:"18"},null,512),[[Ye,A.newServiceName]]),we(d("input",{type:"text","onUpdate:modelValue":C[7]||(C[7]=T=>A.newServiceSubcat=T),placeholder:"Add Subcategory",maxlength:"18",onKeyup:C[8]||(C[8]=_T((...T)=>A.addNewServiceSubcat&&A.addNewServiceSubcat(...T),["enter"]))},null,544),[[Ye,A.newServiceSubcat]]),d("button",{type:"button",onClick:C[9]||(C[9]=(...T)=>A.addNewServiceSubcat&&A.addNewServiceSubcat(...T))},"+ Add Subcategory"),d("div",Eq,[(N(!0),L(Re,null,Ve(A.newServiceSubcats,(T,D)=>(N(),L("span",{key:T,class:"chip"},[Ne(J(T)+" ",1),d("button",{type:"button",onClick:V=>A.removeNewServiceSubcat(D)},"×",8,_q)]))),128))]),d("button",{type:"button",onClick:C[10]||(C[10]=(...T)=>A.addClassService&&A.addClassService(...T))},"+ Add Class Service")])]),d("section",bq,[d("fieldset",null,[C[28]||(C[28]=d("legend",null,"Service Providers",-1)),d("div",Sq,[(N(!0),L(Re,null,Ve(y.value,T=>(N(),L("label",{key:T.abbreviation},[we(d("input",{type:"checkbox","onUpdate:modelValue":C[11]||(C[11]=D=>v.value.serviceProviders=D),value:T.abbreviation},null,8,Aq),[[_t,v.value.serviceProviders]]),d("span",null,J(T.name)+" ("+J(T.abbreviation)+")",1)]))),128))]),d("div",Tq,[C[27]||(C[27]=d("label",null,"Add Custom Service Provider:",-1)),d("div",wq,[we(d("input",{type:"text","onUpdate:modelValue":C[12]||(C[12]=T=>p.value=T),placeholder:"Full Name",maxlength:"100"},null,512),[[Ye,p.value]]),we(d("input",{type:"text","onUpdate:modelValue":C[13]||(C[13]=T=>m.value=T),placeholder:"Abbreviation",maxlength:"10"},null,512),[[Ye,m.value]]),d("button",{type:"button",onClick:k},"Add")]),d("div",Cq,[(N(!0),L(Re,null,Ve(v.value.customServiceProviders,(T,D)=>(N(),L("span",{key:D,class:"chip"},[Ne(J(T.name)+" ("+J(T.abbreviation)+") ",1),d("button",{type:"button",onClick:V=>P(D)},"×",8,Iq)]))),128))])])])]),d("section",kq,[d("fieldset",null,[C[32]||(C[32]=d("legend",null,"Periods",-1)),d("div",Dq,[d("div",Pq,[d("label",null,[C[29]||(C[29]=Ne(" Number of Periods (max 15): ")),we(d("input",{type:"number","onUpdate:modelValue":C[14]||(C[14]=T=>v.value.numPeriods=T),min:"1",max:"15",class:"period-number-input"},null,512),[[Ye,v.value.numPeriods]])])]),v.value.numPeriods>0?(N(),L("div",Rq,[C[30]||(C[30]=d("h4",null,"Period Labels (3 chars max each):",-1)),d("div",Fq,[(N(!0),L(Re,null,Ve(v.value.numPeriods,T=>(N(),L("div",{key:T,class:"period-label-item"},[d("label",null,[Ne(" Period "+J(T)+": ",1),we(d("input",{type:"text","onUpdate:modelValue":D=>v.value.periodLabels[T-1]=D,maxlength:"3",placeholder:`Per${T}`,class:"period-label-input"},null,8,Nq),[[Ye,v.value.periodLabels[T-1]]])])]))),128))])])):_e("",!0),v.value.numPeriods>0?(N(),L("div",Oq,[C[31]||(C[31]=d("strong",null,"Preview:",-1)),(N(!0),L(Re,null,Ve(v.value.numPeriods,T=>(N(),L("span",{key:T,class:"period-preview-item"},J(v.value.periodLabels[T-1]||`Per${T}`),1))),128))])):_e("",!0)])])]),d("section",Mq,[d("div",Lq,[d("button",{type:"submit",disabled:u.value||c.value,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},"💾 Save Settings",8,Bq),d("button",{type:"button",onClick:C[15]||(C[15]=()=>x(!0)),disabled:c.value,class:"admin-action-btn info",style:{"min-width":"100px","max-width":"100px"}},"📂 Load",8,Uq),d("button",{type:"button",onClick:_,disabled:c.value,class:"admin-action-btn warning",style:{"min-width":"100px","max-width":"100px"}},"↩️ Reset",8,$q)]),f.value?(N(),L("div",{key:0,class:Qe(["status-message",{error:h.value,success:!h.value}])},J(f.value),3)):_e("",!0)])],32)])):(N(),L("div",Vq,C[34]||(C[34]=[d("h2",null,"App Settings",-1),d("p",null,"Access denied. You must be an admin to view this page.",-1)])))}},jq=yt(Hq,[["__scopeId","data-v-a0957efc"]]),Gq={class:"admin-aide-assignment"},Wq={class:"header"},zq={class:"header-actions"},Kq=["disabled"],qq={key:0},Xq={key:1},Yq={class:"content"},Qq={key:0,class:"error-message"},Jq={key:1,class:"error-message"},Zq={key:2,class:"loading"},eX={key:3,class:"schedule-container"},tX={class:"aide-schedule-table"},rX={class:"aide-name"},nX=["value","onChange"],sX=["value"],aX={class:"assignment-buttons"},iX=["onClick"],oX=["onClick"],lX={class:"direct-assignment-cell"},cX=["value","onChange"],uX=["value"],dX={class:"assignment-buttons"},fX=["onClick"],hX=["onClick"],pX={__name:"AdminAideAssignment",setup(t){const e=wi(),{userList:r,fetchUsers:n}=ya(),{students:s,fetchStudents:i}=Ua(),a=xa(),{aideAssignment:o,loadAideAssignments:l,saveAllAideAssignments:c}=Rx(),{appSettings:u,loadAppSettings:f}=zs(),h=se(!0),p=se(!1),m=Se(()=>{var R;const B=(R=a.currentUser)==null?void 0:R.role;return["admin","school_admin","admin_504","sped_chair"].includes(B)}),v=Se(()=>{var B;return((B=r.value)==null?void 0:B.filter(R=>R.role==="paraeducator"))||[]}),g=Se(()=>{var B;return((B=r.value)==null?void 0:B.filter(R=>R.role==="teacher"))||[]}),y=Se(()=>{var R;const B=((R=u.value)==null?void 0:R.numPeriods)||7;return Array.from({length:B},(F,M)=>M+1)});function E(B){return B.id}function b(B){return B.id}function k(B,R){if(!o.value[B])return[""];o.value[B].classAssignment||(o.value[B].classAssignment={});let F=o.value[B].classAssignment[R];return Array.isArray(F)?F.length?F:[""]:typeof F=="string"&&F!==""?[F]:[""]}function P(B){if(!o.value[B])return[""];let R=o.value[B].directAssignment;return Array.isArray(R)?R.length?R:[""]:typeof R=="string"&&R!==""?[R]:[""]}function w(B,R,F,M){o.value[B]||(o.value[B]={classAssignment:{},directAssignment:[]}),o.value[B].classAssignment||(o.value[B].classAssignment={});let O=k(B,R);for(O[F]=M;O.length>1&&O[O.length-1]==="";)O.pop();o.value[B].classAssignment[R]=[...O]}function x(B,R,F){o.value[B]||(o.value[B]={classAssignment:{},directAssignment:[]});let M=P(B);for(M[R]=F;M.length>1&&M[M.length-1]==="";)M.pop();o.value[B].directAssignment=[...M]}function S(B,R){o.value[B]||(o.value[B]={classAssignment:{},directAssignment:[]}),o.value[B].classAssignment||(o.value[B].classAssignment={});let F=k(B,R);F.push(""),o.value[B].classAssignment[R]=[...F]}function _(B,R,F){if(!o.value[B]||!o.value[B].classAssignment)return;let M=k(B,R);M.length<=1||(M.splice(F,1),o.value[B].classAssignment[R]=[...M])}function A(B){o.value[B]||(o.value[B]={classAssignment:{},directAssignment:[]});let R=P(B);R.push(""),o.value[B].directAssignment=[...R]}function C(B,R){if(!o.value[B])return;let F=P(B);F.length<=1||(F.splice(R,1),o.value[B].directAssignment=[...F])}async function T(){try{h.value=!0,await Promise.all([n(),i(),l(),f()]),h.value=!1}catch(B){console.error("Error loading data:",B),h.value=!1}}async function D(){try{p.value=!0,await c(),p.value=!1}catch(B){console.error("Error saving aide assignments:",B),p.value=!1}}function V(){e.push("/admin")}return Ut(T),(B,R)=>(N(),L("div",Gq,[d("div",Wq,[R[3]||(R[3]=d("h1",null,"Aide Assignment Management",-1)),d("div",zq,[d("button",{onClick:D,class:"btn btn-primary",disabled:p.value},[p.value?(N(),L("span",qq,"💾")):(N(),L("span",Xq,"💾")),Ne(" "+J(p.value?"Saving...":"Save Assignments"),1)],8,Kq),d("button",{onClick:V,class:"btn btn-secondary"},R[2]||(R[2]=[d("span",null,"←",-1),Ne(" Back ")]))])]),d("div",Yq,[ee(a).currentUser?m.value?h.value?(N(),L("div",Zq," Loading aide assignments... ")):(N(),L("div",eX,[d("table",tX,[d("thead",null,[d("tr",null,[R[8]||(R[8]=d("th",null,"Aide Name",-1)),(N(!0),L(Re,null,Ve(y.value,F=>(N(),L("th",{key:F,class:"period-header"}," Period "+J(F),1))),128)),R[9]||(R[9]=d("th",null,"Direct Assignment",-1))])]),d("tbody",null,[(N(!0),L(Re,null,Ve(v.value,F=>(N(),L("tr",{key:F.id,class:"aide-row"},[d("td",rX,J(F.name||F.email),1),(N(!0),L(Re,null,Ve(y.value,M=>(N(),L("td",{key:M,class:"period-cell"},[(N(!0),L(Re,null,Ve(k(E(F),M),(O,K)=>(N(),L("div",{key:"t-"+K,class:"assignment-row"},[d("select",{value:O,onChange:j=>w(E(F),M,K,j.target.value),class:"teacher-select"},[R[10]||(R[10]=d("option",{value:""},"No Assignment",-1)),(N(!0),L(Re,null,Ve(g.value,j=>(N(),L("option",{key:b(j),value:b(j)},J(j.name||j.email),9,sX))),128))],40,nX),d("div",aX,[k(E(F),M).length>1?(N(),L("button",{key:0,onClick:j=>_(E(F),M,K),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"–",8,iX)):_e("",!0),K===k(E(F),M).length-1?(N(),L("button",{key:1,onClick:j=>S(E(F),M),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,oX)):_e("",!0)])]))),128))]))),128)),d("td",lX,[(N(!0),L(Re,null,Ve(P(E(F)),(M,O)=>(N(),L("div",{key:"d-"+O,class:"assignment-row"},[d("select",{value:M,onChange:K=>x(E(F),O,K.target.value),class:"student-select"},[R[11]||(R[11]=d("option",{value:""},"No Assignment",-1)),(N(!0),L(Re,null,Ve(ee(s),K=>(N(),L("option",{key:K.id,value:K.id},J(ee(ot)(K,"firstName"))+" "+J(ee(ot)(K,"lastName")),9,uX))),128))],40,cX),d("div",dX,[P(E(F)).length>1?(N(),L("button",{key:0,onClick:K=>C(E(F),O),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"–",8,fX)):_e("",!0),O===P(E(F)).length-1?(N(),L("button",{key:1,onClick:K=>A(E(F)),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,hX)):_e("",!0)])]))),128))])]))),128))])])])):(N(),L("div",Jq,[R[6]||(R[6]=d("h2",null,"Access Denied",-1)),R[7]||(R[7]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:R[1]||(R[1]=F=>ee(e).push("/")),class:"btn btn-primary"},"Go Home")])):(N(),L("div",Qq,[R[4]||(R[4]=d("h2",null,"Authentication Required",-1)),R[5]||(R[5]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:R[0]||(R[0]=F=>ee(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},J4=yt(pX,[["__scopeId","data-v-bd60dfde"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Z4=1252,mX=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ux={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$x=function(t){mX.indexOf(t)!=-1&&(Z4=Ux[0]=t)};function gX(){$x(1252)}var ia=function(t){$x(t)};function eI(){ia(1200),gX()}function fS(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function vX(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function tI(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Eu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?vX(t.slice(2)):e==254&&r==255?tI(t.slice(2)):e==65279?t.slice(1):t},Wf=function(e){return String.fromCharCode(e)},hS=function(e){return String.fromCharCode(e)},Td,Qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pS(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Qi.charAt(i)+Qi.charAt(a)+Qi.charAt(o)+Qi.charAt(l);return e}function Ps(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=Qi.indexOf(t.charAt(c++)),a=Qi.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=Qi.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Qi.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Qt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ml=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function po(t){return Qt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function mS(t){return Qt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var sa=function(e){return Qt?ml(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function gl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Vx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Vx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ki=Qt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ml(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function xX(t){for(var e=[],r=0,n=t.length+250,s=po(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=po(65535),n=65530)}return e.push(s.slice(0,r)),Ki(e)}var us=/\u0000/g,_u=/[\u0001-\u0006]/g;function cc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function oa(t,e){var r=""+t;return r.length>=e?r:Ur("0",e-r.length)+r}function Hx(t,e){var r=""+t;return r.length>=e?r:Ur(" ",e-r.length)+r}function mh(t,e){var r=""+t;return r.length>=e?r:r+Ur(" ",e-r.length)}function yX(t,e){var r=""+Math.round(t);return r.length>=e?r:Ur("0",e-r.length)+r}function EX(t,e){var r=""+t;return r.length>=e?r:Ur("0",e-r.length)+r}var gS=Math.pow(2,32);function Rl(t,e){if(t>gS||t<-gS)return yX(t,e);var r=Math.round(t);return EX(r,e)}function gh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var vS=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ag=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _X(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},xS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bX={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vh(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(s);c<e&&(f=Math.floor(s),o=f*a+i,u=f*c+l,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function Lo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=IX(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var rI=new Date(1899,11,31,0,0,0),SX=rI.getTime(),AX=new Date(1900,2,1,0,0,0);function nI(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=AX&&(r+=24*60*60*1e3),(r-(SX+(t.getTimezoneOffset()-rI.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function jx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function TX(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function wX(t){var e=t<0?12:11,r=jx(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function CX(t){var e=jx(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function wd(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=wX(t):e===10?r=t.toFixed(10).substr(0,12):r=CX(t),jx(TX(r.toUpperCase()))}function nl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):wd(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return js(14,nI(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function IX(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function kX(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return ag[r.m-1][1];case 5:return ag[r.m-1][0];default:return ag[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return vS[r.q][0];default:return vS[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?oa(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=oa(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?oa(l,c):"";return u}function Ji(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var sI=/%/g;function DX(t,e,r){var n=e.replace(sI,""),s=e.length-n.length;return di(t,n,r*Math.pow(10,2*s))+Ur("%",s)}function PX(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return di(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function aI(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+aI(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var iI=/# (\?+)( ?)\/( ?)(\d+)/;function RX(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Ur(" ",t[1].length+1+t[4].length):Hx(a,t[1].length)+t[2]+"/"+t[3]+oa(o,t[4].length))}function FX(t,e,r){return r+(e===0?"":""+e)+Ur(" ",t[1].length+2+t[4].length)}var oI=/^#*0*\.([0#]+)/,lI=/\).*[0#]/,cI=/\(###\) ###\\?-####/;function ns(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function yS(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function ES(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function NX(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function OX(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ms(t,e,r){if(t.charCodeAt(0)===40&&!e.match(lI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ms("n",n,r):"("+Ms("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return PX(t,e,r);if(e.indexOf("%")!==-1)return DX(t,e,r);if(e.indexOf("E")!==-1)return aI(e,r);if(e.charCodeAt(0)===36)return"$"+Ms(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Rl(l,e.length);if(e.match(/^[#?]+$/))return s=Rl(r,0),s==="0"&&(s=""),s.length>e.length?s:ns(e.substr(0,e.length-s.length))+s;if(i=e.match(iI))return RX(i,l,c);if(e.match(/^#+0+$/))return c+Rl(l,e.length-e.indexOf("0"));if(i=e.match(oI))return s=yS(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ns(i[1])).replace(/\.$/,"."+ns(i[1])).replace(/\.(\d*)$/,function(m,v){return"."+v+Ur("0",ns(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+yS(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Ji(Rl(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ms(t,e,-r):Ji(""+(Math.floor(r)+NX(r,i[1].length)))+"."+oa(ES(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Ms(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=cc(Ms(t,e.replace(/[\\-]/g,""),r)),a=0,cc(cc(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<s.length?s.charAt(a++):m==="0"?"0":""}));if(e.match(cI))return s=Ms(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=vh(l,Math.pow(10,a)-1,!1),s=""+c,u=di("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=mh(o[2],a),u.length<i[4].length&&(u=ns(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=vh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Hx(o[1],a)+i[2]+"/"+i[3]+mh(o[2],a):Ur(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Rl(r,0),e.length<=s.length?s:ns(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return ns(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=ES(r,i[1].length),r<0?"-"+Ms(t,e,-r):Ji(OX(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?oa(0,3-m.length):"")+m})+"."+oa(a,i[1].length);switch(e){case"###,##0.00":return Ms(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ji(Rl(l,0));return p!=="0"?c+p:"";case"###,###.00":return Ms(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ms(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function MX(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return di(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function LX(t,e,r){var n=e.replace(sI,""),s=e.length-n.length;return di(t,n,r*Math.pow(10,2*s))+Ur("%",s)}function uI(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+uI(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Aa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(lI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Aa("n",n,r):"("+Aa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return MX(t,e,r);if(e.indexOf("%")!==-1)return LX(t,e,r);if(e.indexOf("E")!==-1)return uI(e,r);if(e.charCodeAt(0)===36)return"$"+Aa(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+oa(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:ns(e.substr(0,e.length-s.length))+s;if(i=e.match(iI))return FX(i,l,c);if(e.match(/^#+0+$/))return c+oa(l,e.length-e.indexOf("0"));if(i=e.match(oI))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ns(i[1])).replace(/\.$/,"."+ns(i[1])),s=s.replace(/\.(\d*)$/,function(m,v){return"."+v+Ur("0",ns(i[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Ji(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Aa(t,e,-r):Ji(""+r)+"."+Ur("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Aa(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=cc(Aa(t,e.replace(/[\\-]/g,""),r)),a=0,cc(cc(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<s.length?s.charAt(a++):m==="0"?"0":""}));if(e.match(cI))return s=Aa(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=vh(l,Math.pow(10,a)-1,!1),s=""+c,u=di("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=mh(o[2],a),u.length<i[4].length&&(u=ns(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=vh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Hx(o[1],a)+i[2]+"/"+i[3]+mh(o[2],a):Ur(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:ns(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return ns(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Aa(t,e,-r):Ji(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?oa(0,3-m.length):"")+m})+"."+oa(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Ji(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return Aa(t,e.slice(0,e.lastIndexOf(".")),r)+ns(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function di(t,e,r){return(r|0)===r?Aa(t,e,r):Ms(t,e,r)}function BX(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var dI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":gh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(dI))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function UX(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,f,h="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!gh(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=t.charAt(++a),m=p==="("||p===")"?p:"t";s[s.length]={t:m,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Lo(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Lo(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"上":var v={t:o,v:o};if(c==null&&(c=Lo(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",h="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",a+=5,h="h"):t.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(v.v=c.H>=12?"下午":"上午"),v.t="T",a+=5,h="h"):(v.t="t",++a),c==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(dI)){if(c==null&&(c=Lo(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var g=0,y=0,E;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=h,l="h",g<1&&(g=1);break;case"s":(E=s[a].v.match(/\.0+$/))&&(y=Math.max(y,E[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[a].v.match(/[Hh]/)&&(g=1),g<2&&s[a].v.match(/[Mm]/)&&(g=2),g<3&&s[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var b="",k;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=kX(s[a].t.charCodeAt(0),s[a].v,c,y),s[a].t="t";break;case"n":case"?":for(k=a+1;s[k]!=null&&((o=s[k].t)==="?"||o==="D"||(o===" "||o==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[a].v+=s[k].v,s[k]={v:"",t:";"},++k;b+=s[a].v,a=k-1;break;case"G":s[a].t="t",s[a].v=nl(e,r);break}var P="",w,x;if(b.length>0){b.charCodeAt(0)==40?(w=e<0&&b.charCodeAt(0)===45?-e:e,x=di("n",b,w)):(w=e<0&&n>1?-e:e,x=di("n",b,w),w<0&&s[0]&&s[0].t=="t"&&(x=x.substr(1),s[0].v="-"+s[0].v)),k=x.length-1;var S=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){S=a;break}var _=s.length;if(S===s.length&&x.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(k>=s[a].v.length-1?(k-=s[a].v.length,s[a].v=x.substr(k+1,s[a].v.length)):k<0?s[a].v="":(s[a].v=x.substr(0,k+1),k=-1),s[a].t="t",_=a);k>=0&&_<s.length&&(s[_].v=x.substr(0,k+1)+s[_].v)}else if(S!==s.length&&x.indexOf("E")===-1){for(k=x.indexOf(".")-1,a=S;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===S?s[a].v.indexOf(".")-1:s[a].v.length-1,P=s[a].v.substr(u+1);u>=0;--u)k>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(P=x.charAt(k--)+P);s[a].v=P,s[a].t="t",_=a}for(k>=0&&_<s.length&&(s[_].v=x.substr(0,k+1)+s[_].v),k=x.indexOf(".")+1,a=S;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==S)){for(u=s[a].v.indexOf(".")>-1&&a===S?s[a].v.indexOf(".")+1:0,P=s[a].v.substr(0,u);u<s[a].v.length;++u)k<x.length&&(P+=x.charAt(k++));s[a].v=P,s[a].t="t",_=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(w=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=di(s[a].t,s[a].v,w),s[a].t="t");var A="";for(a=0;a!==s.length;++a)s[a]!=null&&(A+=s[a].v);return A}var _S=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function bS(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function $X(t,e){var r=BX(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(_S),o=r[1].match(_S);return bS(e,a)?[n,r[0]]:bS(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function js(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Lt)[t],n==null&&(n=r.table&&r.table[xS[t]]||Lt[xS[t]]),n==null&&(n=bX[t]||"General");break}if(gh(n,0))return nl(e,r);e instanceof Date&&(e=nI(e,r.date1904));var s=$X(n,e);if(gh(s[1]))return nl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return UX(s[1],e,r,s[0])}function Go(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Lt[r]==null){e<0&&(e=r);continue}if(Lt[r]==t){e=r;break}}e<0&&(e=391)}return Lt[e]=t,e}function fI(){Lt=_X()}var VX={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function HX(t){var e=typeof t=="number"?Lt[t]:t;return e=e.replace(hI,"(\\d+)"),new RegExp("^"+e+"$")}function jX(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(hI)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var GX=function(){var t={};t.version="1.2.0";function e(){for(var x=0,S=new Array(256),_=0;_!=256;++_)x=_,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,S[_]=x;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(x){var S=0,_=0,A=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(A=0;A!=256;++A)C[A]=x[A];for(A=0;A!=256;++A)for(_=x[A],S=256+A;S<4096;S+=256)_=C[S]=_>>>8^x[_&255];var T=[];for(A=1;A!=16;++A)T[A-1]=typeof Int32Array<"u"?C.subarray(A*256,A*256+256):C.slice(A*256,A*256+256);return T}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],f=s[6],h=s[7],p=s[8],m=s[9],v=s[10],g=s[11],y=s[12],E=s[13],b=s[14];function k(x,S){for(var _=S^-1,A=0,C=x.length;A<C;)_=_>>>8^r[(_^x.charCodeAt(A++))&255];return~_}function P(x,S){for(var _=S^-1,A=x.length-15,C=0;C<A;)_=b[x[C++]^_&255]^E[x[C++]^_>>8&255]^y[x[C++]^_>>16&255]^g[x[C++]^_>>>24]^v[x[C++]]^m[x[C++]]^p[x[C++]]^h[x[C++]]^f[x[C++]]^u[x[C++]]^c[x[C++]]^l[x[C++]]^o[x[C++]]^a[x[C++]]^i[x[C++]]^r[x[C++]];for(A+=15;C<A;)_=_>>>8^r[(_^x[C++])&255];return~_}function w(x,S){for(var _=S^-1,A=0,C=x.length,T=0,D=0;A<C;)T=x.charCodeAt(A++),T<128?_=_>>>8^r[(_^T)&255]:T<2048?(_=_>>>8^r[(_^(192|T>>6&31))&255],_=_>>>8^r[(_^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,D=x.charCodeAt(A++)&1023,_=_>>>8^r[(_^(240|T>>8&7))&255],_=_>>>8^r[(_^(128|T>>2&63))&255],_=_>>>8^r[(_^(128|D>>6&15|(T&3)<<4))&255],_=_>>>8^r[(_^(128|D&63))&255]):(_=_>>>8^r[(_^(224|T>>12&15))&255],_=_>>>8^r[(_^(128|T>>6&63))&255],_=_>>>8^r[(_^(128|T&63))&255]);return~_}return t.table=r,t.bstr=k,t.buf=P,t.str=w,t}(),tr=function(){var e={};e.version="1.2.1";function r(te,me){for(var le=te.split("/"),de=me.split("/"),ve=0,xe=0,De=Math.min(le.length,de.length);ve<De;++ve){if(xe=le[ve].length-de[ve].length)return xe;if(le[ve]!=de[ve])return le[ve]<de[ve]?-1:1}return le.length-de.length}function n(te){if(te.charAt(te.length-1)=="/")return te.slice(0,-1).indexOf("/")===-1?te:n(te.slice(0,-1));var me=te.lastIndexOf("/");return me===-1?te:te.slice(0,me+1)}function s(te){if(te.charAt(te.length-1)=="/")return s(te.slice(0,-1));var me=te.lastIndexOf("/");return me===-1?te:te.slice(me+1)}function i(te,me){typeof me=="string"&&(me=new Date(me));var le=me.getHours();le=le<<6|me.getMinutes(),le=le<<5|me.getSeconds()>>>1,te.write_shift(2,le);var de=me.getFullYear()-1980;de=de<<4|me.getMonth()+1,de=de<<5|me.getDate(),te.write_shift(2,de)}function a(te){var me=te.read_shift(2)&65535,le=te.read_shift(2)&65535,de=new Date,ve=le&31;le>>>=5;var xe=le&15;le>>>=4,de.setMilliseconds(0),de.setFullYear(le+1980),de.setMonth(xe-1),de.setDate(ve);var De=me&31;me>>>=5;var Ue=me&63;return me>>>=6,de.setHours(me),de.setMinutes(Ue),de.setSeconds(De<<1),de}function o(te){Sn(te,0);for(var me={},le=0;te.l<=te.length-4;){var de=te.read_shift(2),ve=te.read_shift(2),xe=te.l+ve,De={};switch(de){case 21589:le=te.read_shift(1),le&1&&(De.mtime=te.read_shift(4)),ve>5&&(le&2&&(De.atime=te.read_shift(4)),le&4&&(De.ctime=te.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}te.l=xe,me[de]=De}return me}var l;function c(){return l||(l={})}function u(te,me){if(te[0]==80&&te[1]==75)return mt(te,me);if((te[0]|32)==109&&(te[1]|32)==105)return _o(te,me);if(te.length<512)throw new Error("CFB file size "+te.length+" < 512");var le=3,de=512,ve=0,xe=0,De=0,Ue=0,Pe=0,Fe=[],Me=te.slice(0,512);Sn(Me,0);var Xe=f(Me);switch(le=Xe[0],le){case 3:de=512;break;case 4:de=4096;break;case 0:if(Xe[1]==0)return mt(te,me);default:throw new Error("Major Version: Expected 3 or 4 saw "+le)}de!==512&&(Me=te.slice(0,de),Sn(Me,28));var et=te.slice(0,de);h(Me,le);var ct=Me.read_shift(4,"i");if(le===3&&ct!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ct);Me.l+=4,De=Me.read_shift(4,"i"),Me.l+=4,Me.chk("00100000","Mini Stream Cutoff Size: "),Ue=Me.read_shift(4,"i"),ve=Me.read_shift(4,"i"),Pe=Me.read_shift(4,"i"),xe=Me.read_shift(4,"i");for(var Je=-1,at=0;at<109&&(Je=Me.read_shift(4,"i"),!(Je<0));++at)Fe[at]=Je;var Ct=p(te,de);g(Pe,xe,Ct,de,Fe);var pr=E(Ct,De,Fe,de);pr[De].name="!Directory",ve>0&&Ue!==D&&(pr[Ue].name="!MiniFAT"),pr[Fe[0]].name="!FAT",pr.fat_addrs=Fe,pr.ssz=de;var dr={},wr=[],Ga=[],So=[];b(De,pr,Ct,wr,ve,dr,Ga,Ue),m(Ga,So,wr),wr.shift();var Di={FileIndex:Ga,FullPaths:So};return me&&me.raw&&(Di.raw={header:et,sectors:Ct}),Di}function f(te){if(te[te.l]==80&&te[te.l+1]==75)return[0,0];te.chk(V,"Header Signature: "),te.l+=16;var me=te.read_shift(2,"u");return[te.read_shift(2,"u"),me]}function h(te,me){var le=9;switch(te.l+=2,le=te.read_shift(2)){case 9:if(me!=3)throw new Error("Sector Shift: Expected 9 saw "+le);break;case 12:if(me!=4)throw new Error("Sector Shift: Expected 12 saw "+le);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+le)}te.chk("0600","Mini Sector Shift: "),te.chk("000000000000","Reserved: ")}function p(te,me){for(var le=Math.ceil(te.length/me)-1,de=[],ve=1;ve<le;++ve)de[ve-1]=te.slice(ve*me,(ve+1)*me);return de[le-1]=te.slice(le*me),de}function m(te,me,le){for(var de=0,ve=0,xe=0,De=0,Ue=0,Pe=le.length,Fe=[],Me=[];de<Pe;++de)Fe[de]=Me[de]=de,me[de]=le[de];for(;Ue<Me.length;++Ue)de=Me[Ue],ve=te[de].L,xe=te[de].R,De=te[de].C,Fe[de]===de&&(ve!==-1&&Fe[ve]!==ve&&(Fe[de]=Fe[ve]),xe!==-1&&Fe[xe]!==xe&&(Fe[de]=Fe[xe])),De!==-1&&(Fe[De]=de),ve!==-1&&de!=Fe[de]&&(Fe[ve]=Fe[de],Me.lastIndexOf(ve)<Ue&&Me.push(ve)),xe!==-1&&de!=Fe[de]&&(Fe[xe]=Fe[de],Me.lastIndexOf(xe)<Ue&&Me.push(xe));for(de=1;de<Pe;++de)Fe[de]===de&&(xe!==-1&&Fe[xe]!==xe?Fe[de]=Fe[xe]:ve!==-1&&Fe[ve]!==ve&&(Fe[de]=Fe[ve]));for(de=1;de<Pe;++de)if(te[de].type!==0){if(Ue=de,Ue!=Fe[Ue])do Ue=Fe[Ue],me[de]=me[Ue]+"/"+me[de];while(Ue!==0&&Fe[Ue]!==-1&&Ue!=Fe[Ue]);Fe[de]=-1}for(me[0]+="/",de=1;de<Pe;++de)te[de].type!==2&&(me[de]+="/")}function v(te,me,le){for(var de=te.start,ve=te.size,xe=[],De=de;le&&ve>0&&De>=0;)xe.push(me.slice(De*T,De*T+T)),ve-=T,De=Fo(le,De*4);return xe.length===0?an(0):Ki(xe).slice(0,te.size)}function g(te,me,le,de,ve){var xe=D;if(te===D){if(me!==0)throw new Error("DIFAT chain shorter than expected")}else if(te!==-1){var De=le[te],Ue=(de>>>2)-1;if(!De)return;for(var Pe=0;Pe<Ue&&(xe=Fo(De,Pe*4))!==D;++Pe)ve.push(xe);g(Fo(De,de-4),me-1,le,de,ve)}}function y(te,me,le,de,ve){var xe=[],De=[];ve||(ve=[]);var Ue=de-1,Pe=0,Fe=0;for(Pe=me;Pe>=0;){ve[Pe]=!0,xe[xe.length]=Pe,De.push(te[Pe]);var Me=le[Math.floor(Pe*4/de)];if(Fe=Pe*4&Ue,de<4+Fe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+de);if(!te[Me])break;Pe=Fo(te[Me],Fe)}return{nodes:xe,data:RS([De])}}function E(te,me,le,de){var ve=te.length,xe=[],De=[],Ue=[],Pe=[],Fe=de-1,Me=0,Xe=0,et=0,ct=0;for(Me=0;Me<ve;++Me)if(Ue=[],et=Me+me,et>=ve&&(et-=ve),!De[et]){Pe=[];var Je=[];for(Xe=et;Xe>=0;){Je[Xe]=!0,De[Xe]=!0,Ue[Ue.length]=Xe,Pe.push(te[Xe]);var at=le[Math.floor(Xe*4/de)];if(ct=Xe*4&Fe,de<4+ct)throw new Error("FAT boundary crossed: "+Xe+" 4 "+de);if(!te[at]||(Xe=Fo(te[at],ct),Je[Xe]))break}xe[et]={nodes:Ue,data:RS([Pe])}}return xe}function b(te,me,le,de,ve,xe,De,Ue){for(var Pe=0,Fe=de.length?2:0,Me=me[te].data,Xe=0,et=0,ct;Xe<Me.length;Xe+=128){var Je=Me.slice(Xe,Xe+128);Sn(Je,64),et=Je.read_shift(2),ct=qx(Je,0,et-Fe),de.push(ct);var at={name:ct,type:Je.read_shift(1),color:Je.read_shift(1),L:Je.read_shift(4,"i"),R:Je.read_shift(4,"i"),C:Je.read_shift(4,"i"),clsid:Je.read_shift(16),state:Je.read_shift(4,"i"),start:0,size:0},Ct=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);Ct!==0&&(at.ct=k(Je,Je.l-8));var pr=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);pr!==0&&(at.mt=k(Je,Je.l-8)),at.start=Je.read_shift(4,"i"),at.size=Je.read_shift(4,"i"),at.size<0&&at.start<0&&(at.size=at.type=0,at.start=D,at.name=""),at.type===5?(Pe=at.start,ve>0&&Pe!==D&&(me[Pe].name="!StreamData")):at.size>=4096?(at.storage="fat",me[at.start]===void 0&&(me[at.start]=y(le,at.start,me.fat_addrs,me.ssz)),me[at.start].name=at.name,at.content=me[at.start].data.slice(0,at.size)):(at.storage="minifat",at.size<0?at.size=0:Pe!==D&&at.start!==D&&me[Pe]&&(at.content=v(at,me[Pe].data,(me[Ue]||{}).data))),at.content&&Sn(at.content,0),xe[ct]=at,De.push(at)}}function k(te,me){return new Date((As(te,me+4)/1e7*Math.pow(2,32)+As(te,me)/1e7-11644473600)*1e3)}function P(te,me){return c(),u(l.readFileSync(te),me)}function w(te,me){var le=me&&me.type;switch(le||Qt&&Buffer.isBuffer(te)&&(le="buffer"),le||"base64"){case"file":return P(te,me);case"base64":return u(sa(Ps(te)),me);case"binary":return u(sa(te),me)}return u(te,me)}function x(te,me){var le=me||{},de=le.root||"Root Entry";if(te.FullPaths||(te.FullPaths=[]),te.FileIndex||(te.FileIndex=[]),te.FullPaths.length!==te.FileIndex.length)throw new Error("inconsistent CFB structure");te.FullPaths.length===0&&(te.FullPaths[0]=de+"/",te.FileIndex[0]={name:de,type:5}),le.CLSID&&(te.FileIndex[0].clsid=le.CLSID),S(te)}function S(te){var me="Sh33tJ5";if(!tr.find(te,"/"+me)){var le=an(4);le[0]=55,le[1]=le[3]=50,le[2]=54,te.FileIndex.push({name:me,type:2,content:le,size:4,L:69,R:69,C:69}),te.FullPaths.push(te.FullPaths[0]+me),_(te)}}function _(te,me){x(te);for(var le=!1,de=!1,ve=te.FullPaths.length-1;ve>=0;--ve){var xe=te.FileIndex[ve];switch(xe.type){case 0:de?le=!0:(te.FileIndex.pop(),te.FullPaths.pop());break;case 1:case 2:case 5:de=!0,isNaN(xe.R*xe.L*xe.C)&&(le=!0),xe.R>-1&&xe.L>-1&&xe.R==xe.L&&(le=!0);break;default:le=!0;break}}if(!(!le&&!me)){var De=new Date(1987,1,19),Ue=0,Pe=Object.create?Object.create(null):{},Fe=[];for(ve=0;ve<te.FullPaths.length;++ve)Pe[te.FullPaths[ve]]=!0,te.FileIndex[ve].type!==0&&Fe.push([te.FullPaths[ve],te.FileIndex[ve]]);for(ve=0;ve<Fe.length;++ve){var Me=n(Fe[ve][0]);de=Pe[Me],de||(Fe.push([Me,{name:s(Me).replace("/",""),type:1,clsid:R,ct:De,mt:De,content:null}]),Pe[Me]=!0)}for(Fe.sort(function(ct,Je){return r(ct[0],Je[0])}),te.FullPaths=[],te.FileIndex=[],ve=0;ve<Fe.length;++ve)te.FullPaths[ve]=Fe[ve][0],te.FileIndex[ve]=Fe[ve][1];for(ve=0;ve<Fe.length;++ve){var Xe=te.FileIndex[ve],et=te.FullPaths[ve];if(Xe.name=s(et).replace("/",""),Xe.L=Xe.R=Xe.C=-(Xe.color=1),Xe.size=Xe.content?Xe.content.length:0,Xe.start=0,Xe.clsid=Xe.clsid||R,ve===0)Xe.C=Fe.length>1?1:-1,Xe.size=0,Xe.type=5;else if(et.slice(-1)=="/"){for(Ue=ve+1;Ue<Fe.length&&n(te.FullPaths[Ue])!=et;++Ue);for(Xe.C=Ue>=Fe.length?-1:Ue,Ue=ve+1;Ue<Fe.length&&n(te.FullPaths[Ue])!=n(et);++Ue);Xe.R=Ue>=Fe.length?-1:Ue,Xe.type=1}else n(te.FullPaths[ve+1]||"")==n(et)&&(Xe.R=ve+1),Xe.type=2}}}function A(te,me){var le=me||{};if(le.fileType=="mad")return nn(te,le);switch(_(te),le.fileType){case"zip":return Ot(te,le)}var de=function(ct){for(var Je=0,at=0,Ct=0;Ct<ct.FileIndex.length;++Ct){var pr=ct.FileIndex[Ct];if(pr.content){var dr=pr.content.length;dr>0&&(dr<4096?Je+=dr+63>>6:at+=dr+511>>9)}}for(var wr=ct.FullPaths.length+3>>2,Ga=Je+7>>3,So=Je+127>>7,Di=Ga+at+wr+So,Ea=Di+127>>7,Sl=Ea<=109?0:Math.ceil((Ea-109)/127);Di+Ea+Sl+127>>7>Ea;)Sl=++Ea<=109?0:Math.ceil((Ea-109)/127);var Es=[1,Sl,Ea,So,wr,at,Je,0];return ct.FileIndex[0].size=Je<<6,Es[7]=(ct.FileIndex[0].start=Es[0]+Es[1]+Es[2]+Es[3]+Es[4]+Es[5])+(Es[6]+7>>3),Es}(te),ve=an(de[7]<<9),xe=0,De=0;{for(xe=0;xe<8;++xe)ve.write_shift(1,B[xe]);for(xe=0;xe<8;++xe)ve.write_shift(2,0);for(ve.write_shift(2,62),ve.write_shift(2,3),ve.write_shift(2,65534),ve.write_shift(2,9),ve.write_shift(2,6),xe=0;xe<3;++xe)ve.write_shift(2,0);for(ve.write_shift(4,0),ve.write_shift(4,de[2]),ve.write_shift(4,de[0]+de[1]+de[2]+de[3]-1),ve.write_shift(4,0),ve.write_shift(4,4096),ve.write_shift(4,de[3]?de[0]+de[1]+de[2]-1:D),ve.write_shift(4,de[3]),ve.write_shift(-4,de[1]?de[0]-1:D),ve.write_shift(4,de[1]),xe=0;xe<109;++xe)ve.write_shift(-4,xe<de[2]?de[1]+xe:-1)}if(de[1])for(De=0;De<de[1];++De){for(;xe<236+De*127;++xe)ve.write_shift(-4,xe<de[2]?de[1]+xe:-1);ve.write_shift(-4,De===de[1]-1?D:De+1)}var Ue=function(ct){for(De+=ct;xe<De-1;++xe)ve.write_shift(-4,xe+1);ct&&(++xe,ve.write_shift(-4,D))};for(De=xe=0,De+=de[1];xe<De;++xe)ve.write_shift(-4,F.DIFSECT);for(De+=de[2];xe<De;++xe)ve.write_shift(-4,F.FATSECT);Ue(de[3]),Ue(de[4]);for(var Pe=0,Fe=0,Me=te.FileIndex[0];Pe<te.FileIndex.length;++Pe)Me=te.FileIndex[Pe],Me.content&&(Fe=Me.content.length,!(Fe<4096)&&(Me.start=De,Ue(Fe+511>>9)));for(Ue(de[6]+7>>3);ve.l&511;)ve.write_shift(-4,F.ENDOFCHAIN);for(De=xe=0,Pe=0;Pe<te.FileIndex.length;++Pe)Me=te.FileIndex[Pe],Me.content&&(Fe=Me.content.length,!(!Fe||Fe>=4096)&&(Me.start=De,Ue(Fe+63>>6)));for(;ve.l&511;)ve.write_shift(-4,F.ENDOFCHAIN);for(xe=0;xe<de[4]<<2;++xe){var Xe=te.FullPaths[xe];if(!Xe||Xe.length===0){for(Pe=0;Pe<17;++Pe)ve.write_shift(4,0);for(Pe=0;Pe<3;++Pe)ve.write_shift(4,-1);for(Pe=0;Pe<12;++Pe)ve.write_shift(4,0);continue}Me=te.FileIndex[xe],xe===0&&(Me.start=Me.size?Me.start-1:D);var et=xe===0&&le.root||Me.name;if(Fe=2*(et.length+1),ve.write_shift(64,et,"utf16le"),ve.write_shift(2,Fe),ve.write_shift(1,Me.type),ve.write_shift(1,Me.color),ve.write_shift(-4,Me.L),ve.write_shift(-4,Me.R),ve.write_shift(-4,Me.C),Me.clsid)ve.write_shift(16,Me.clsid,"hex");else for(Pe=0;Pe<4;++Pe)ve.write_shift(4,0);ve.write_shift(4,Me.state||0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,Me.start),ve.write_shift(4,Me.size),ve.write_shift(4,0)}for(xe=1;xe<te.FileIndex.length;++xe)if(Me=te.FileIndex[xe],Me.size>=4096)if(ve.l=Me.start+1<<9,Qt&&Buffer.isBuffer(Me.content))Me.content.copy(ve,ve.l,0,Me.size),ve.l+=Me.size+511&-512;else{for(Pe=0;Pe<Me.size;++Pe)ve.write_shift(1,Me.content[Pe]);for(;Pe&511;++Pe)ve.write_shift(1,0)}for(xe=1;xe<te.FileIndex.length;++xe)if(Me=te.FileIndex[xe],Me.size>0&&Me.size<4096)if(Qt&&Buffer.isBuffer(Me.content))Me.content.copy(ve,ve.l,0,Me.size),ve.l+=Me.size+63&-64;else{for(Pe=0;Pe<Me.size;++Pe)ve.write_shift(1,Me.content[Pe]);for(;Pe&63;++Pe)ve.write_shift(1,0)}if(Qt)ve.l=ve.length;else for(;ve.l<ve.length;)ve.write_shift(1,0);return ve}function C(te,me){var le=te.FullPaths.map(function(Pe){return Pe.toUpperCase()}),de=le.map(function(Pe){var Fe=Pe.split("/");return Fe[Fe.length-(Pe.slice(-1)=="/"?2:1)]}),ve=!1;me.charCodeAt(0)===47?(ve=!0,me=le[0].slice(0,-1)+me):ve=me.indexOf("/")!==-1;var xe=me.toUpperCase(),De=ve===!0?le.indexOf(xe):de.indexOf(xe);if(De!==-1)return te.FileIndex[De];var Ue=!xe.match(_u);for(xe=xe.replace(us,""),Ue&&(xe=xe.replace(_u,"!")),De=0;De<le.length;++De)if((Ue?le[De].replace(_u,"!"):le[De]).replace(us,"")==xe||(Ue?de[De].replace(_u,"!"):de[De]).replace(us,"")==xe)return te.FileIndex[De];return null}var T=64,D=-2,V="d0cf11e0a1b11ae1",B=[208,207,17,224,161,177,26,225],R="00000000000000000000000000000000",F={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:R,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function M(te,me,le){c();var de=A(te,le);l.writeFileSync(me,de)}function O(te){for(var me=new Array(te.length),le=0;le<te.length;++le)me[le]=String.fromCharCode(te[le]);return me.join("")}function K(te,me){var le=A(te,me);switch(me&&me.type||"buffer"){case"file":return c(),l.writeFileSync(me.filename,le),le;case"binary":return typeof le=="string"?le:O(le);case"base64":return pS(typeof le=="string"?le:O(le));case"buffer":if(Qt)return Buffer.isBuffer(le)?le:ml(le);case"array":return typeof le=="string"?sa(le):le}return le}var j;function H(te){try{var me=te.InflateRaw,le=new me;if(le._processChunk(new Uint8Array([3,0]),le._finishFlushFlag),le.bytesRead)j=te;else throw new Error("zlib does not expose bytesRead")}catch(de){console.error("cannot use native zlib: "+(de.message||de))}}function W(te,me){if(!j)return pt(te,me);var le=j.InflateRaw,de=new le,ve=de._processChunk(te.slice(te.l),de._finishFlushFlag);return te.l+=de.bytesRead,ve}function X(te){return j?j.deflateRawSync(te):ye(te)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(te){var me=(te<<1|te<<11)&139536|(te<<5|te<<15)&558144;return(me>>16|me>>8|me)&255}for(var q=typeof Uint8Array<"u",G=q?new Uint8Array(256):[],oe=0;oe<256;++oe)G[oe]=pe(oe);function Q(te,me){var le=G[te&255];return me<=8?le>>>8-me:(le=le<<8|G[te>>8&255],me<=16?le>>>16-me:(le=le<<8|G[te>>16&255],le>>>24-me))}function Y(te,me){var le=me&7,de=me>>>3;return(te[de]|(le<=6?0:te[de+1]<<8))>>>le&3}function Z(te,me){var le=me&7,de=me>>>3;return(te[de]|(le<=5?0:te[de+1]<<8))>>>le&7}function ne(te,me){var le=me&7,de=me>>>3;return(te[de]|(le<=4?0:te[de+1]<<8))>>>le&15}function ge(te,me){var le=me&7,de=me>>>3;return(te[de]|(le<=3?0:te[de+1]<<8))>>>le&31}function ae(te,me){var le=me&7,de=me>>>3;return(te[de]|(le<=1?0:te[de+1]<<8))>>>le&127}function ce(te,me,le){var de=me&7,ve=me>>>3,xe=(1<<le)-1,De=te[ve]>>>de;return le<8-de||(De|=te[ve+1]<<8-de,le<16-de)||(De|=te[ve+2]<<16-de,le<24-de)||(De|=te[ve+3]<<24-de),De&xe}function fe(te,me,le){var de=me&7,ve=me>>>3;return de<=5?te[ve]|=(le&7)<<de:(te[ve]|=le<<de&255,te[ve+1]=(le&7)>>8-de),me+3}function Ae(te,me,le){var de=me&7,ve=me>>>3;return le=(le&1)<<de,te[ve]|=le,me+1}function Ie(te,me,le){var de=me&7,ve=me>>>3;return le<<=de,te[ve]|=le&255,le>>>=8,te[ve+1]=le,me+8}function Te(te,me,le){var de=me&7,ve=me>>>3;return le<<=de,te[ve]|=le&255,le>>>=8,te[ve+1]=le&255,te[ve+2]=le>>>8,me+16}function Ge(te,me){var le=te.length,de=2*le>me?2*le:me+5,ve=0;if(le>=me)return te;if(Qt){var xe=mS(de);if(te.copy)te.copy(xe);else for(;ve<te.length;++ve)xe[ve]=te[ve];return xe}else if(q){var De=new Uint8Array(de);if(De.set)De.set(te);else for(;ve<le;++ve)De[ve]=te[ve];return De}return te.length=de,te}function ke(te){for(var me=new Array(te),le=0;le<te;++le)me[le]=0;return me}function $e(te,me,le){var de=1,ve=0,xe=0,De=0,Ue=0,Pe=te.length,Fe=q?new Uint16Array(32):ke(32);for(xe=0;xe<32;++xe)Fe[xe]=0;for(xe=Pe;xe<le;++xe)te[xe]=0;Pe=te.length;var Me=q?new Uint16Array(Pe):ke(Pe);for(xe=0;xe<Pe;++xe)Fe[ve=te[xe]]++,de<ve&&(de=ve),Me[xe]=0;for(Fe[0]=0,xe=1;xe<=de;++xe)Fe[xe+16]=Ue=Ue+Fe[xe-1]<<1;for(xe=0;xe<Pe;++xe)Ue=te[xe],Ue!=0&&(Me[xe]=Fe[Ue+16]++);var Xe=0;for(xe=0;xe<Pe;++xe)if(Xe=te[xe],Xe!=0)for(Ue=Q(Me[xe],de)>>de-Xe,De=(1<<de+4-Xe)-1;De>=0;--De)me[Ue|De<<Xe]=Xe&15|xe<<4;return de}var Be=q?new Uint16Array(512):ke(512),We=q?new Uint16Array(32):ke(32);if(!q){for(var Ke=0;Ke<512;++Ke)Be[Ke]=0;for(Ke=0;Ke<32;++Ke)We[Ke]=0}(function(){for(var te=[],me=0;me<32;me++)te.push(5);$e(te,We,32);var le=[];for(me=0;me<=143;me++)le.push(8);for(;me<=255;me++)le.push(9);for(;me<=279;me++)le.push(7);for(;me<=287;me++)le.push(8);$e(le,Be,288)})();var Ee=function(){for(var me=q?new Uint8Array(32768):[],le=0,de=0;le<ue.length-1;++le)for(;de<ue[le+1];++de)me[de]=le;for(;de<32768;++de)me[de]=29;var ve=q?new Uint8Array(259):[];for(le=0,de=0;le<he.length-1;++le)for(;de<he[le+1];++de)ve[de]=le;function xe(Ue,Pe){for(var Fe=0;Fe<Ue.length;){var Me=Math.min(65535,Ue.length-Fe),Xe=Fe+Me==Ue.length;for(Pe.write_shift(1,+Xe),Pe.write_shift(2,Me),Pe.write_shift(2,~Me&65535);Me-- >0;)Pe[Pe.l++]=Ue[Fe++]}return Pe.l}function De(Ue,Pe){for(var Fe=0,Me=0,Xe=q?new Uint16Array(32768):[];Me<Ue.length;){var et=Math.min(65535,Ue.length-Me);if(et<10){for(Fe=fe(Pe,Fe,+(Me+et==Ue.length)),Fe&7&&(Fe+=8-(Fe&7)),Pe.l=Fe/8|0,Pe.write_shift(2,et),Pe.write_shift(2,~et&65535);et-- >0;)Pe[Pe.l++]=Ue[Me++];Fe=Pe.l*8;continue}Fe=fe(Pe,Fe,+(Me+et==Ue.length)+2);for(var ct=0;et-- >0;){var Je=Ue[Me];ct=(ct<<5^Je)&32767;var at=-1,Ct=0;if((at=Xe[ct])&&(at|=Me&-32768,at>Me&&(at-=32768),at<Me))for(;Ue[at+Ct]==Ue[Me+Ct]&&Ct<250;)++Ct;if(Ct>2){Je=ve[Ct],Je<=22?Fe=Ie(Pe,Fe,G[Je+1]>>1)-1:(Ie(Pe,Fe,3),Fe+=5,Ie(Pe,Fe,G[Je-23]>>5),Fe+=3);var pr=Je<8?0:Je-4>>2;pr>0&&(Te(Pe,Fe,Ct-he[Je]),Fe+=pr),Je=me[Me-at],Fe=Ie(Pe,Fe,G[Je]>>3),Fe-=3;var dr=Je<4?0:Je-2>>1;dr>0&&(Te(Pe,Fe,Me-at-ue[Je]),Fe+=dr);for(var wr=0;wr<Ct;++wr)Xe[ct]=Me&32767,ct=(ct<<5^Ue[Me])&32767,++Me;et-=Ct-1}else Je<=143?Je=Je+48:Fe=Ae(Pe,Fe,1),Fe=Ie(Pe,Fe,G[Je]),Xe[ct]=Me&32767,++Me}Fe=Ie(Pe,Fe,0)-1}return Pe.l=(Fe+7)/8|0,Pe.l}return function(Pe,Fe){return Pe.length<8?xe(Pe,Fe):De(Pe,Fe)}}();function ye(te){var me=an(50+Math.floor(te.length*1.1)),le=Ee(te,me);return me.slice(0,le)}var be=q?new Uint16Array(32768):ke(32768),Oe=q?new Uint16Array(32768):ke(32768),je=q?new Uint16Array(128):ke(128),lt=1,gt=1;function Et(te,me){var le=ge(te,me)+257;me+=5;var de=ge(te,me)+1;me+=5;var ve=ne(te,me)+4;me+=4;for(var xe=0,De=q?new Uint8Array(19):ke(19),Ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Pe=1,Fe=q?new Uint8Array(8):ke(8),Me=q?new Uint8Array(8):ke(8),Xe=De.length,et=0;et<ve;++et)De[re[et]]=xe=Z(te,me),Pe<xe&&(Pe=xe),Fe[xe]++,me+=3;var ct=0;for(Fe[0]=0,et=1;et<=Pe;++et)Me[et]=ct=ct+Fe[et-1]<<1;for(et=0;et<Xe;++et)(ct=De[et])!=0&&(Ue[et]=Me[ct]++);var Je=0;for(et=0;et<Xe;++et)if(Je=De[et],Je!=0){ct=G[Ue[et]]>>8-Je;for(var at=(1<<7-Je)-1;at>=0;--at)je[ct|at<<Je]=Je&7|et<<3}var Ct=[];for(Pe=1;Ct.length<le+de;)switch(ct=je[ae(te,me)],me+=ct&7,ct>>>=3){case 16:for(xe=3+Y(te,me),me+=2,ct=Ct[Ct.length-1];xe-- >0;)Ct.push(ct);break;case 17:for(xe=3+Z(te,me),me+=3;xe-- >0;)Ct.push(0);break;case 18:for(xe=11+ae(te,me),me+=7;xe-- >0;)Ct.push(0);break;default:Ct.push(ct),Pe<ct&&(Pe=ct);break}var pr=Ct.slice(0,le),dr=Ct.slice(le);for(et=le;et<286;++et)pr[et]=0;for(et=de;et<30;++et)dr[et]=0;return lt=$e(pr,be,286),gt=$e(dr,Oe,30),me}function jt(te,me){if(te[0]==3&&!(te[1]&3))return[po(me),2];for(var le=0,de=0,ve=mS(me||1<<18),xe=0,De=ve.length>>>0,Ue=0,Pe=0;!(de&1);){if(de=Z(te,le),le+=3,de>>>1)de>>1==1?(Ue=9,Pe=5):(le=Et(te,le),Ue=lt,Pe=gt);else{le&7&&(le+=8-(le&7));var Fe=te[le>>>3]|te[(le>>>3)+1]<<8;if(le+=32,Fe>0)for(!me&&De<xe+Fe&&(ve=Ge(ve,xe+Fe),De=ve.length);Fe-- >0;)ve[xe++]=te[le>>>3],le+=8;continue}for(;;){!me&&De<xe+32767&&(ve=Ge(ve,xe+32767),De=ve.length);var Me=ce(te,le,Ue),Xe=de>>>1==1?Be[Me]:be[Me];if(le+=Xe&15,Xe>>>=4,!(Xe>>>8&255))ve[xe++]=Xe;else{if(Xe==256)break;Xe-=257;var et=Xe<8?0:Xe-4>>2;et>5&&(et=0);var ct=xe+he[Xe];et>0&&(ct+=ce(te,le,et),le+=et),Me=ce(te,le,Pe),Xe=de>>>1==1?We[Me]:Oe[Me],le+=Xe&15,Xe>>>=4;var Je=Xe<4?0:Xe-2>>1,at=ue[Xe];for(Je>0&&(at+=ce(te,le,Je),le+=Je),!me&&De<ct&&(ve=Ge(ve,ct+100),De=ve.length);xe<ct;)ve[xe]=ve[xe-at],++xe}}}return me?[ve,le+7>>>3]:[ve.slice(0,xe),le+7>>>3]}function pt(te,me){var le=te.slice(te.l||0),de=jt(le,me);return te.l+=de[1],de[0]}function ut(te,me){if(te)typeof console<"u"&&console.error(me);else throw new Error(me)}function mt(te,me){var le=te;Sn(le,0);var de=[],ve=[],xe={FileIndex:de,FullPaths:ve};x(xe,{root:me.root});for(var De=le.length-4;(le[De]!=80||le[De+1]!=75||le[De+2]!=5||le[De+3]!=6)&&De>=0;)--De;le.l=De+4,le.l+=4;var Ue=le.read_shift(2);le.l+=6;var Pe=le.read_shift(4);for(le.l=Pe,De=0;De<Ue;++De){le.l+=20;var Fe=le.read_shift(4),Me=le.read_shift(4),Xe=le.read_shift(2),et=le.read_shift(2),ct=le.read_shift(2);le.l+=8;var Je=le.read_shift(4),at=o(le.slice(le.l+Xe,le.l+Xe+et));le.l+=Xe+et+ct;var Ct=le.l;le.l=Je+4,Dt(le,Fe,Me,xe,at),le.l=Ct}return xe}function Dt(te,me,le,de,ve){te.l+=2;var xe=te.read_shift(2),De=te.read_shift(2),Ue=a(te);if(xe&8257)throw new Error("Unsupported ZIP encryption");for(var Pe=te.read_shift(4),Fe=te.read_shift(4),Me=te.read_shift(4),Xe=te.read_shift(2),et=te.read_shift(2),ct="",Je=0;Je<Xe;++Je)ct+=String.fromCharCode(te[te.l++]);if(et){var at=o(te.slice(te.l,te.l+et));(at[21589]||{}).mt&&(Ue=at[21589].mt),((ve||{})[21589]||{}).mt&&(Ue=ve[21589].mt)}te.l+=et;var Ct=te.slice(te.l,te.l+Fe);switch(De){case 8:Ct=W(te,Me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var pr=!1;xe&8&&(Pe=te.read_shift(4),Pe==134695760&&(Pe=te.read_shift(4),pr=!0),Fe=te.read_shift(4),Me=te.read_shift(4)),Fe!=me&&ut(pr,"Bad compressed size: "+me+" != "+Fe),Me!=le&&ut(pr,"Bad uncompressed size: "+le+" != "+Me),Dr(de,ct,Ct,{unsafe:!0,mt:Ue})}function Ot(te,me){var le=me||{},de=[],ve=[],xe=an(1),De=le.compression?8:0,Ue=0,Pe=0,Fe=0,Me=0,Xe=0,et=te.FullPaths[0],ct=et,Je=te.FileIndex[0],at=[],Ct=0;for(Pe=1;Pe<te.FullPaths.length;++Pe)if(ct=te.FullPaths[Pe].slice(et.length),Je=te.FileIndex[Pe],!(!Je.size||!Je.content||ct=="Sh33tJ5")){var pr=Me,dr=an(ct.length);for(Fe=0;Fe<ct.length;++Fe)dr.write_shift(1,ct.charCodeAt(Fe)&127);dr=dr.slice(0,dr.l),at[Xe]=GX.buf(Je.content,0);var wr=Je.content;De==8&&(wr=X(wr)),xe=an(30),xe.write_shift(4,67324752),xe.write_shift(2,20),xe.write_shift(2,Ue),xe.write_shift(2,De),Je.mt?i(xe,Je.mt):xe.write_shift(4,0),xe.write_shift(-4,at[Xe]),xe.write_shift(4,wr.length),xe.write_shift(4,Je.content.length),xe.write_shift(2,dr.length),xe.write_shift(2,0),Me+=xe.length,de.push(xe),Me+=dr.length,de.push(dr),Me+=wr.length,de.push(wr),xe=an(46),xe.write_shift(4,33639248),xe.write_shift(2,0),xe.write_shift(2,20),xe.write_shift(2,Ue),xe.write_shift(2,De),xe.write_shift(4,0),xe.write_shift(-4,at[Xe]),xe.write_shift(4,wr.length),xe.write_shift(4,Je.content.length),xe.write_shift(2,dr.length),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(4,0),xe.write_shift(4,pr),Ct+=xe.l,ve.push(xe),Ct+=dr.length,ve.push(dr),++Xe}return xe=an(22),xe.write_shift(4,101010256),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,Xe),xe.write_shift(2,Xe),xe.write_shift(4,Ct),xe.write_shift(4,Me),xe.write_shift(2,0),Ki([Ki(de),Ki(ve),xe])}var br={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Zn(te,me){if(te.ctype)return te.ctype;var le=te.name||"",de=le.match(/\.([^\.]+)$/);return de&&br[de[1]]||me&&(de=(le=me).match(/[\.\\]([^\.\\])+$/),de&&br[de[1]])?br[de[1]]:"application/octet-stream"}function ki(te){for(var me=pS(te),le=[],de=0;de<me.length;de+=76)le.push(me.slice(de,de+76));return le.join(`\r
`)+`\r
`}function fs(te){var me=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Fe){var Me=Fe.charCodeAt(0).toString(16).toUpperCase();return"="+(Me.length==1?"0"+Me:Me)});me=me.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),me.charAt(0)==`
`&&(me="=0D"+me.slice(1)),me=me.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var le=[],de=me.split(`\r
`),ve=0;ve<de.length;++ve){var xe=de[ve];if(xe.length==0){le.push("");continue}for(var De=0;De<xe.length;){var Ue=76,Pe=xe.slice(De,De+Ue);Pe.charAt(Ue-1)=="="?Ue--:Pe.charAt(Ue-2)=="="?Ue-=2:Pe.charAt(Ue-3)=="="&&(Ue-=3),Pe=xe.slice(De,De+Ue),De+=Ue,De<xe.length&&(Pe+="="),le.push(Pe)}}return le.join(`\r
`)}function _l(te){for(var me=[],le=0;le<te.length;++le){for(var de=te[le];le<=te.length&&de.charAt(de.length-1)=="=";)de=de.slice(0,de.length-1)+te[++le];me.push(de)}for(var ve=0;ve<me.length;++ve)me[ve]=me[ve].replace(/[=][0-9A-Fa-f]{2}/g,function(xe){return String.fromCharCode(parseInt(xe.slice(1),16))});return sa(me.join(`\r
`))}function ja(te,me,le){for(var de="",ve="",xe="",De,Ue=0;Ue<10;++Ue){var Pe=me[Ue];if(!Pe||Pe.match(/^\s*$/))break;var Fe=Pe.match(/^(.*?):\s*([^\s].*)$/);if(Fe)switch(Fe[1].toLowerCase()){case"content-location":de=Fe[2].trim();break;case"content-type":xe=Fe[2].trim();break;case"content-transfer-encoding":ve=Fe[2].trim();break}}switch(++Ue,ve.toLowerCase()){case"base64":De=sa(Ps(me.slice(Ue).join("")));break;case"quoted-printable":De=_l(me.slice(Ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ve)}var Me=Dr(te,de.slice(le.length),De,{unsafe:!0});xe&&(Me.ctype=xe)}function _o(te,me){if(O(te.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var le=me&&me.root||"",de=(Qt&&Buffer.isBuffer(te)?te.toString("binary"):O(te)).split(`\r
`),ve=0,xe="";for(ve=0;ve<de.length;++ve)if(xe=de[ve],!!/^Content-Location:/i.test(xe)&&(xe=xe.slice(xe.indexOf("file")),le||(le=xe.slice(0,xe.lastIndexOf("/")+1)),xe.slice(0,le.length)!=le))for(;le.length>0&&(le=le.slice(0,le.length-1),le=le.slice(0,le.lastIndexOf("/")+1),xe.slice(0,le.length)!=le););var De=(de[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var Ue="--"+(De[1]||""),Pe=[],Fe=[],Me={FileIndex:Pe,FullPaths:Fe};x(Me);var Xe,et=0;for(ve=0;ve<de.length;++ve){var ct=de[ve];ct!==Ue&&ct!==Ue+"--"||(et++&&ja(Me,de.slice(Xe,ve),le),Xe=ve)}return Me}function nn(te,me){var le=me||{},de=le.boundary||"SheetJS";de="------="+de;for(var ve=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+de.slice(2)+'"',"","",""],xe=te.FullPaths[0],De=xe,Ue=te.FileIndex[0],Pe=1;Pe<te.FullPaths.length;++Pe)if(De=te.FullPaths[Pe].slice(xe.length),Ue=te.FileIndex[Pe],!(!Ue.size||!Ue.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ct){return"_x"+Ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ct){return"_u"+Ct.charCodeAt(0).toString(16)+"_"});for(var Fe=Ue.content,Me=Qt&&Buffer.isBuffer(Fe)?Fe.toString("binary"):O(Fe),Xe=0,et=Math.min(1024,Me.length),ct=0,Je=0;Je<=et;++Je)(ct=Me.charCodeAt(Je))>=32&&ct<128&&++Xe;var at=Xe>=et*4/5;ve.push(de),ve.push("Content-Location: "+(le.root||"file:///C:/SheetJS/")+De),ve.push("Content-Transfer-Encoding: "+(at?"quoted-printable":"base64")),ve.push("Content-Type: "+Zn(Ue,De)),ve.push(""),ve.push(at?fs(Me):ki(Me))}return ve.push(de+`--\r
`),ve.join(`\r
`)}function bo(te){var me={};return x(me,te),me}function Dr(te,me,le,de){var ve=de&&de.unsafe;ve||x(te);var xe=!ve&&tr.find(te,me);if(!xe){var De=te.FullPaths[0];me.slice(0,De.length)==De?De=me:(De.slice(-1)!="/"&&(De+="/"),De=(De+me).replace("//","/")),xe={name:s(me),type:2},te.FileIndex.push(xe),te.FullPaths.push(De),ve||tr.utils.cfb_gc(te)}return xe.content=le,xe.size=le?le.length:0,de&&(de.CLSID&&(xe.clsid=de.CLSID),de.mt&&(xe.mt=de.mt),de.ct&&(xe.ct=de.ct)),xe}function Dn(te,me){x(te);var le=tr.find(te,me);if(le){for(var de=0;de<te.FileIndex.length;++de)if(te.FileIndex[de]==le)return te.FileIndex.splice(de,1),te.FullPaths.splice(de,1),!0}return!1}function bl(te,me,le){x(te);var de=tr.find(te,me);if(de){for(var ve=0;ve<te.FileIndex.length;++ve)if(te.FileIndex[ve]==de)return te.FileIndex[ve].name=s(le),te.FullPaths[ve]=le,!0}return!1}function Wc(te){_(te,!0)}return e.find=C,e.read=w,e.parse=u,e.write=K,e.writeFile=M,e.utils={cfb_new:bo,cfb_add:Dr,cfb_del:Dn,cfb_mov:bl,cfb_gc:Wc,ReadShift:Wu,CheckField:OI,prep_blob:Sn,bconcat:Ki,use_zlib:H,_deflateRaw:ye,_inflateRaw:pt,consts:F},e}();function WX(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ma(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Gx(t){for(var e=[],r=Ma(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var xh=new Date(1899,11,30,0,0,0);function ds(t,e){var r=t.getTime(),n=xh.getTime()+(t.getTimezoneOffset()-xh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var pI=new Date,zX=xh.getTime()+(pI.getTimezoneOffset()-xh.getTimezoneOffset())*6e4,SS=pI.getTimezoneOffset();function Fp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+zX),e.getTimezoneOffset()!==SS&&e.setTime(e.getTime()+(e.getTimezoneOffset()-SS)*6e4),e}function KX(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var AS=new Date("2017-02-19T19:06:09.000Z"),mI=isNaN(AS.getFullYear())?new Date("2/19/17"):AS,qX=mI.getFullYear()==2017;function gn(t,e){var r=new Date(t);if(qX)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(mI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function sl(t,e){if(Qt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Su(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Su(tI(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Su(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Su(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function In(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=In(t[r]));return e}function Ur(t,e){for(var r="";r.length<e;)r+=t;return r}function ua(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var XX=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ic(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&XX.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var YX=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function gI(t){return t?t.content&&t.type?sl(t.content,!0):t.data?Eu(t.data):t.asNodeBuffer&&Qt?Eu(t.asNodeBuffer().toString("binary")):t.asBinary?Eu(t.asBinary()):t._data&&t._data.getContent?Eu(sl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function vI(t){if(!t)return null;if(t.data)return fS(t.data);if(t.asNodeBuffer&&Qt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?fS(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function QX(t){return t&&t.name.slice(-4)===".bin"?vI(t):gI(t)}function Ls(t,e){for(var r=t.FullPaths||Ma(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Wx(t,e){var r=Ls(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Jr(t,e,r){if(!r)return QX(Wx(t,e));if(!e)return null;try{return Jr(t,e)}catch{return null}}function ws(t,e,r){if(!r)return gI(Wx(t,e));if(!e)return null;try{return ws(t,e)}catch{return null}}function JX(t,e,r){return vI(Wx(t,e))}function TS(t){for(var e=t.FullPaths||Ma(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ZX(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Qt?n=ml(r):n=xX(r),tr.utils.cfb_add(t,e,n)}tr.utils.cfb_add(t,e,r)}else t.file(e,r)}function xI(t,e){switch(e.type){case"base64":return tr.read(t,{type:"base64"});case"binary":return tr.read(t,{type:"binary"});case"buffer":case"array":return tr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function bu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var yI=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eY=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tY=/<[^>]*>/g,Jn=yI.match(wS)?wS:tY,rY=/<\w*:/,nY=/<(\/?)\w+:/;function wt(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(eY),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,l=f.slice(i+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Va(t){return t.replace(nY,"<$1")}var EI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},sY=Gx(EI),sr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return EI[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),aY=/[&<>'"]/g,iY=/[\u0000-\u001f]/g;function zx(t){var e=t+"";return e.replace(aY,function(r){return sY[r]}).replace(/\n/g,"<br/>").replace(iY,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var CS=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Ir(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ig(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function IS(t){var e=po(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function kS(t){return ml(t,"binary").toString("utf8")}var zf="foo bar bazâð£",Er=Qt&&(kS(zf)==ig(zf)&&kS||IS(zf)==ig(zf)&&IS)||ig,Su=Qt?function(t){return ml(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Cd=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),_I=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),oY=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),lY=/<\/?(?:vt:)?variant>/g,cY=/<(?:vt:)([^>]*)>([\s\S]*)</;function DS(t,e){var r=wt(t),n=t.match(oY(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(lY,"").match(cY);a&&s.push({v:Er(a[2]),t:a[1]})}),s}var uY=/(^\s|\s$|\n)/;function dY(t){return Ma(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function fY(t,e,r){return"<"+t+(r!=null?dY(r):"")+(e!=null?(e.match(uY)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Kx(t){if(Qt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Er(gl(Vx(t)));throw new Error("Bad input format: expected Buffer or string")}var Id=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,hY={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},pY=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function mY(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function gY(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var PS=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},RS=Qt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ml(e)})):PS(t)}:PS,FS=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(li(t,s)));return n.join("").replace(us,"")},qx=Qt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(us,""):FS(t,e,r)}:FS,NS=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},bI=Qt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):NS(t,e,r)}:NS,OS=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Hl(t,s)));return n.join("")},sf=Qt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):OS(e,r,n)}:OS,SI=function(t,e){var r=As(t,e);return r>0?sf(t,e+4,e+4+r-1):""},AI=SI,TI=function(t,e){var r=As(t,e);return r>0?sf(t,e+4,e+4+r-1):""},wI=TI,CI=function(t,e){var r=2*As(t,e);return r>0?sf(t,e+4,e+4+r-1):""},II=CI,kI=function(e,r){var n=As(e,r);return n>0?qx(e,r+4,r+4+n):""},DI=kI,PI=function(t,e){var r=As(t,e);return r>0?sf(t,e+4,e+4+r):""},RI=PI,FI=function(t,e){return mY(t,e)},yh=FI,NI=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Qt&&(AI=function(e,r){if(!Buffer.isBuffer(e))return SI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},wI=function(e,r){if(!Buffer.isBuffer(e))return TI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},II=function(e,r){if(!Buffer.isBuffer(e))return CI(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},DI=function(e,r){if(!Buffer.isBuffer(e))return kI(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},RI=function(e,r){if(!Buffer.isBuffer(e))return PI(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},yh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):FI(e,r)},NI=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Hl=function(t,e){return t[e]},li=function(t,e){return t[e+1]*256+t[e]},vY=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},As=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Fo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},xY=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Wu(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Qt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(li(this,c)),c+=2;t*=2;break;case"utf8":r=sf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=qx(this,this.l,this.l+t);break;case"wstr":return Wu.call(this,t,"dbcs");case"lpstr-ansi":r=AI(this,this.l),t=4+As(this,this.l);break;case"lpstr-cp":r=wI(this,this.l),t=4+As(this,this.l);break;case"lpwstr":r=II(this,this.l),t=4+2*As(this,this.l);break;case"lpp4":t=4+As(this,this.l),r=DI(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+As(this,this.l),r=RI(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Hl(this,this.l+t++))!==0;)i.push(Wf(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=li(this,this.l+t))!==0;)i.push(Wf(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Hl(this,c),this.l=c+1,o=Wu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Wf(li(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Hl(this,c),this.l=c+1,o=Wu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Wf(Hl(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=Hl(this,this.l),this.l++,n;case 2:return n=(e==="i"?vY:li)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Fo:xY)(this,this.l),this.l+=4,n):(s=As(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=yh(this,this.l):s=yh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=bI(this,this.l,t);break}}return this.l+=t,r}var yY=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},EY=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},_Y=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function bY(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)_Y(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,yY(this,e,this.l);break;case 8:if(n=8,r==="f"){gY(this,e,this.l);break}case 16:break;case-4:n=4,EY(this,e,this.l);break}return this.l+=n,this}function OI(t,e){var r=bI(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sn(t,e){t.l=e,t.read_shift=Wu,t.chk=OI,t.write_shift=bY}function Qn(t,e){t.l+=e}function an(t){var e=po(t);return Sn(e,0),e}function Ci(t,e,r){if(t){var n,s,i;Sn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Th[o]||Th[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var u=c.f&&c.f(t,i,r);if(t.l=l,e(u,c,o))return}}}function Dv(){var t=[],e=Qt?256:2048,r=function(c){var u=an(c);return Sn(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),Ki(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function zu(t,e,r){var n=In(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function MS(t,e,r){var n=In(t);return n.s=zu(n.s,e.s,r),n.e=zu(n.e,e.s,r),n}function Ku(t,e){if(t.cRel&&t.c<0)for(t=In(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=In(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ft(t);return!t.cRel&&t.cRel!=null&&(r=TY(r)),!t.rRel&&t.rRel!=null&&(r=SY(r)),r}function og(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+cn(t.s.c)+":"+(t.e.cRel?"":"$")+cn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+kn(t.s.r)+":"+(t.e.rRel?"":"$")+kn(t.e.r):Ku(t.s,e.biff)+":"+Ku(t.e,e.biff)}function Xx(t){return parseInt(AY(t),10)-1}function kn(t){return""+(t+1)}function SY(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function AY(t){return t.replace(/\$(\d+)$/,"$1")}function Yx(t){for(var e=wY(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function cn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function TY(t){return t.replace(/^([A-Z])/,"$$$1")}function wY(t){return t.replace(/^\$([A-Z])/,"$1")}function CY(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ls(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Ft(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function jc(t){var e=t.indexOf(":");return e==-1?{s:ls(t),e:ls(t)}:{s:ls(t.slice(0,e)),e:ls(t.slice(e+1))}}function rr(t,e){return typeof e>"u"||typeof e=="number"?rr(t.s,t.e):(typeof t!="string"&&(t=Ft(t)),typeof e!="string"&&(e=Ft(e)),t==e?t:t+":"+e)}function Vr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function LS(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=js(t.z,r?ds(e):e)}catch{}try{return t.w=js((t.XF||{}).numFmtId||(r?14:0),r?ds(e):e)}catch{return""+e}}function Ai(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?yl[t.v]||t.v:e==null?LS(t,t.v):LS(t,e))}function Eo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function MI(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ls(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Vr(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[f].length;++h)if(!(typeof e[f][h]>"u")){var p={v:e[f][h]},m=a+f,v=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>v&&(c.s.c=v),c.e.r<m&&(c.e.r=m),c.e.c<v&&(c.e.c=v),e[f][h]&&typeof e[f][h]=="object"&&!Array.isArray(e[f][h])&&!(e[f][h]instanceof Date))p=e[f][h];else if(Array.isArray(p.v)&&(p.f=e[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Lt[14],n.cellDates?(p.t="d",p.w=js(p.z,ds(p.v))):(p.t="n",p.v=ds(p.v),p.w=js(p.z,p.v))):p.t="s";if(s)i[m]||(i[m]=[]),i[m][v]&&i[m][v].z&&(p.z=i[m][v].z),i[m][v]=p;else{var g=Ft({c:v,r:m});i[g]&&i[g].z&&(p.z=i[g].z),i[g]=p}}}return c.s.c<1e7&&(i["!ref"]=rr(c)),i}function Gc(t,e){return MI(null,t,e)}function IY(t){return t.read_shift(4,"i")}function Xn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function kY(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Qx(t,e){var r=t.l,n=t.read_shift(1),s=Xn(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(kY(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var DY=Qx;function Ks(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function vl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var PY=Xn;function Jx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var RY=Xn,Pv=Jx;function Zx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?yh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Fo(e,0)>>2;return r?s/100:s}function LI(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var xl=LI;function Hn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function FY(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Wo[s];c&&(e.rgb=Dd(c));break;case 2:e.rgb=Dd([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function NY(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function BI(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function OY(t){return BI(t,1)}function MY(t){return BI(t,2)}var ey=2,gs=3,Kf=11,BS=12,Eh=19,qf=64,LY=65,BY=71,UY=4108,$Y=4126,hn=80,UI=81,VY=[hn,UI],HY={1:{n:"CodePage",t:ey},2:{n:"Category",t:hn},3:{n:"PresentationFormat",t:hn},4:{n:"ByteCount",t:gs},5:{n:"LineCount",t:gs},6:{n:"ParagraphCount",t:gs},7:{n:"SlideCount",t:gs},8:{n:"NoteCount",t:gs},9:{n:"HiddenCount",t:gs},10:{n:"MultimediaClipCount",t:gs},11:{n:"ScaleCrop",t:Kf},12:{n:"HeadingPairs",t:UY},13:{n:"TitlesOfParts",t:$Y},14:{n:"Manager",t:hn},15:{n:"Company",t:hn},16:{n:"LinksUpToDate",t:Kf},17:{n:"CharacterCount",t:gs},19:{n:"SharedDoc",t:Kf},22:{n:"HyperlinksChanged",t:Kf},23:{n:"AppVersion",t:gs,p:"version"},24:{n:"DigSig",t:LY},26:{n:"ContentType",t:hn},27:{n:"ContentStatus",t:hn},28:{n:"Language",t:hn},29:{n:"Version",t:hn},255:{},2147483648:{n:"Locale",t:Eh},2147483651:{n:"Behavior",t:Eh},1919054434:{}},jY={1:{n:"CodePage",t:ey},2:{n:"Title",t:hn},3:{n:"Subject",t:hn},4:{n:"Author",t:hn},5:{n:"Keywords",t:hn},6:{n:"Comments",t:hn},7:{n:"Template",t:hn},8:{n:"LastAuthor",t:hn},9:{n:"RevNumber",t:hn},10:{n:"EditTime",t:qf},11:{n:"LastPrinted",t:qf},12:{n:"CreatedDate",t:qf},13:{n:"ModifiedDate",t:qf},14:{n:"PageCount",t:gs},15:{n:"WordCount",t:gs},16:{n:"CharCount",t:gs},17:{n:"Thumbnail",t:BY},18:{n:"Application",t:hn},19:{n:"DocSecurity",t:gs},255:{},2147483648:{n:"Locale",t:Eh},2147483651:{n:"Behavior",t:Eh},1919054434:{}},US={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},GY=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function WY(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var zY=WY([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Wo=In(zY),yl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$I={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$S={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function KY(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qY(t){var e=KY();if(!t||!t.match)return e;var r={};if((t.match(Jn)||[]).forEach(function(n){var s=wt(n);switch(s[0].replace(rY,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[$S[s.ContentType]]!==void 0&&e[$S[s.ContentType]].push(s.PartName);break}}),e.xmlns!==hY.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var zl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Rv(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function qu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Jn)||[]).forEach(function(s){var i=wt(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:bu(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var XY="application/vnd.oasis.opendocument.spreadsheet";function YY(t,e){for(var r=Kx(t),n,s;n=Id.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=wt(n[0],!1),s.path=="/"&&s.type!==XY)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Xu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],QY=function(){for(var t=new Array(Xu.length),e=0;e<Xu.length;++e){var r=Xu[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function VI(t){var e={};t=Er(t);for(var r=0;r<Xu.length;++r){var n=Xu[r],s=t.match(QY[r]);s!=null&&s.length>0&&(e[n[1]]=sr(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=gn(e[n[1]]))}return e}var JY=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function HI(t,e,r,n){var s=[];if(typeof t=="string")s=DS(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(u){return{v:u}}));var a=typeof e=="string"?DS(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function ZY(t,e,r){var n={};return e||(e={}),t=Er(t),JY.forEach(function(s){var i=(t.match(Cd(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=sr(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&HI(n.HeadingPairs,n.TitlesOfParts,e,r),e}var eQ=/<[^>]+>[^<]*/g;function tQ(t,e){var r={},n="",s=t.match(eQ);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=wt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=sr(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=sr(u);break;case"bool":r[n]=Ir(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=gn(u);break;case"cy":case"error":r[n]=sr(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var rQ={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},lg;function nQ(t,e,r){lg||(lg=Gx(rQ)),e=lg[e]||e,t[e]=r}function ty(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function jI(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function GI(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function WI(t,e,r){return e===31?GI(t):jI(t,e,r)}function Fv(t,e,r){return WI(t,e,r===!1?0:4)}function sQ(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return WI(t,e,0)}function aQ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(us,""),t.l-s&2&&(t.l+=2)}return r}function iQ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(us,"");return r}function oQ(t){var e=t.l,r=_h(t,UI);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=_h(t,gs);return[r,n]}function lQ(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(oQ(t));return r}function VS(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(us,"").replace(_u,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function zI(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function cQ(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function _h(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==BS&&n!==e&&VY.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===BS?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return jI(t,n,4).replace(us,"");case 31:return GI(t);case 64:return ty(t);case 65:return zI(t);case 71:return cQ(t);case 80:return Fv(t,n,!i.raw).replace(us,"");case 81:return sQ(t,n).replace(us,"");case 4108:return lQ(t);case 4126:case 4127:return n==4127?aQ(t):iQ(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function HS(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var u=t.read_shift(4),f=t.read_shift(4);i[a]=[u,f+r]}i.sort(function(E,b){return E[1]-b[1]});var h={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var p=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(p=!1,t.l=i[a][1]),p)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var m=e[i[a][0]];if(h[m.n]=_h(t,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ia(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(i[a][0]===1){if(o=h.CodePage=_h(t,ey),ia(o),l!==-1){var v=t.l;t.l=i[l][1],c=VS(t,o),t.l=v}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=VS(t,o)}else{var g=c[i[a][0]],y;switch(t[t.l]){case 65:t.l+=4,y=zI(t);break;case 30:t.l+=4,y=Fv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,y=Fv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,y=t.read_shift(4,"i");break;case 19:t.l+=4,y=t.read_shift(4);break;case 5:t.l+=4,y=t.read_shift(8,"f");break;case 11:t.l+=4,y=jr(t,4);break;case 64:t.l+=4,y=gn(ty(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[g]=y}}return t.l=r+n,h}function jS(t,e,r){var n=t.content;if(!n)return{};Sn(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==tr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=HS(n,e),h={SystemIdentifier:c};for(var p in f)h[p]=f[p];if(h.FMTID=i,s===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=HS(n,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[i,a],h}function Li(t,e){return t.read_shift(e),null}function uQ(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function jr(t,e){return t.read_shift(e)===1}function Zr(t){return t.read_shift(2,"u")}function KI(t,e){return uQ(t,e,Zr)}function dQ(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function af(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function fQ(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function al(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function of(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):al(t,n,r)}function El(t,e,r){if(r.biff>5)return of(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function hQ(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function pQ(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(us,"");return n&&(t.l+=24),s}function mQ(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(us,"");return r+a}function gQ(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return pQ(t);case"0303000000000000c000000000000046":return mQ(t);default:throw new Error("Unsupported Moniker "+r)}}function Xf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(us,""):"";return r}function vQ(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",u,f;s&16&&(i=Xf(t,r-t.l)),s&128&&(a=Xf(t,r-t.l)),(s&257)===257&&(o=Xf(t,r-t.l)),(s&257)===1&&(l=gQ(t,r-t.l)),s&8&&(c=Xf(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(f=ty(t)),t.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),f&&(p.time=f),i&&(p.Tooltip=i),p}function qI(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function XI(t,e){var r=qI(t);return r[3]=0,r}function Ha(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function xQ(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function yQ(t,e,r){return e===0?"":El(t,e,r)}function EQ(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function YI(t){var e=t.read_shift(2),r=Zx(t);return[e,r]}function _Q(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=af(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Np(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function QI(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var bQ=QI;function JI(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function SQ(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function AQ(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Nn(t){t.l+=2,t.l+=t.read_shift(2)}var TQ={0:Nn,4:Nn,5:Nn,6:Nn,7:AQ,8:Nn,9:Nn,10:Nn,11:Nn,12:Nn,13:SQ,14:Nn,15:Nn,16:Nn,17:Nn,18:Nn,19:Nn,20:Nn,21:JI};function wQ(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(TQ[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Yf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function CQ(t,e){return e===0||t.read_shift(2),1200}function IQ(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=El(t,0,r);return t.read_shift(e+n-t.l),s}function kQ(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function DQ(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=af(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function PQ(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(fQ(t));return i.Count=n,i.Unique=s,i}function RQ(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function FQ(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function NQ(t){var e=xQ(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function OQ(t){return t.read_shift(2),t.read_shift(4)}function GS(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function MQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function LQ(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function BQ(){}function UQ(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=af(t,0,r),n}function $Q(t){var e=Ha(t);return e.isst=t.read_shift(4),e}function VQ(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Ha(t);r.biff==2&&t.l++;var i=of(t,n-t.l,r);return s.val=i,s}function HQ(t,e,r){var n=t.read_shift(2),s=El(t,0,r);return[n,s]}var jQ=El;function WS(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function GQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=YI(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function WQ(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(YI(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function zQ(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function KQ(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=GY[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function qQ(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=KQ(t,e,n.fStyle,r),n}function XQ(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function zS(t,e,r){var n=Ha(t);(r.biff==2||e==9)&&++t.l;var s=dQ(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function YQ(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ha(t),s=Hn(t);return n.val=s,n}var KS=yQ;function QQ(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=al(t,i),o=[];n>t.l;)o.push(of(t));return[i,s,a,o]}function qS(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=_Q(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var JQ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function XS(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=al(t,a,r);s&32&&(c=JQ[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var f=n==t.l||o===0||!(u>0)?[]:Fte(t,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function ZI(t,e,r){if(r.biff<8)return ZQ(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(EQ(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function ZQ(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=af(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function eJ(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=al(t,n,r),a=al(t,s,r);return[i,a]}function tJ(t,e,r){var n=QI(t);t.l++;var s=t.read_shift(1);return e-=8,[Nte(t,e,r),s,n]}function YS(t,e,r){var n=bQ(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Pte(t,e,r)]}function rJ(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function nJ(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=El(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function sJ(t,e,r){return nJ(t,e,r)}function aJ(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Np(t));return r}function iJ(t,e,r){if(r&&r.biff<8)return lJ(t,e,r);var n=JI(t),s=wQ(t,e-22,n[1]);return{cmo:n,ft:s}}var oJ={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function lJ(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((oJ[n]||Qn)(t,e,r)),{cmo:[s,n,i],ft:a}}function cJ(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=hQ(t,6,r);var o=t.read_shift(2);t.read_shift(2),Zr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],f=al(t,t.lens[c+1]-t.lens[c]-1);if(s+=f,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function uJ(t,e){var r=Np(t);t.l+=16;var n=vQ(t,e-24);return[r,n]}function dJ(t,e){t.read_shift(2);var r=Np(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(us,""),[r,n]}function fJ(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=US[r]||r,r=t.read_shift(2),e[1]=US[r]||r,e}function hJ(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(XI(t));return r}function pJ(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(XI(t));return r}function mJ(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function ek(t,e,r){if(!r.cellStyles)return Qn(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function gJ(t,e){var r={};return e<32||(t.l+=16,r.header=Hn(t),r.footer=Hn(t),t.l+=2),r}function vJ(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var xJ=Ha,yJ=KI,EJ=of;function _J(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function bJ(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ha(t);++t.l;var s=El(t,e-7,r);return n.t="str",n.val=s,n}function SJ(t){var e=Ha(t);++t.l;var r=Hn(t);return e.t="n",e.val=r,e}function AJ(t){var e=Ha(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function TJ(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function wJ(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function CJ(t,e,r){var n=t.l+e,s=Ha(t),i=t.read_shift(2),a=al(t,i,r);return t.l=n,s.t="str",s.val=a,s}var IJ=[2,3,48,49,131,139,140,245],QS=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Gx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=po(1);switch(l.type){case"base64":u=sa(Ps(o));break;case"binary":u=sa(o);break;case"buffer":case"array":u=o;break}Sn(u,0);var f=u.read_shift(1),h=!!(f&136),p=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,g=521;f==2&&(v=u.read_shift(2)),u.l+=3,f!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(g=u.read_shift(2));var y=u.read_shift(2),E=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(E=t[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var b=[],k={},P=Math.min(u.length,f==2?521:g-10-(p?264:0)),w=m?32:11;u.l<P&&u[u.l]!=13;)switch(k={},k.name=Td.utils.decode(E,u.slice(u.l,u.l+w)).replace(/[\u0000\r\n].*$/g,""),u.l+=w,k.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),f==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&b.push(k),f!=2&&(u.l+=m?13:14),k.type){case"B":(!p||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var x=0,S=0;for(c[0]=[],S=0;S!=b.length;++S)c[0][S]=b[S].name;for(;v-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,c[++x]=[],S=0,S=0;S!=b.length;++S){var _=u.slice(u.l,u.l+b[S].len);u.l+=b[S].len,Sn(_,0);var A=Td.utils.decode(E,_);switch(b[S].type){case"C":A.trim().length&&(c[x][S]=A.replace(/\s+$/,""));break;case"D":A.length===8?c[x][S]=new Date(+A.slice(0,4),+A.slice(4,6)-1,+A.slice(6,8)):c[x][S]=A;break;case"F":c[x][S]=parseFloat(A.trim());break;case"+":case"I":c[x][S]=m?_.read_shift(-4,"i")^2147483648:_.read_shift(4,"i");break;case"L":switch(A.trim().toUpperCase()){case"Y":case"T":c[x][S]=!0;break;case"N":case"F":c[x][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+A+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[x][S]="##MEMO##"+(m?parseInt(A.trim(),10):_.read_shift(4));break;case"N":A=A.replace(/\u0000/g,"").trim(),A&&A!="."&&(c[x][S]=+A||0);break;case"@":c[x][S]=new Date(_.read_shift(-8,"f")-621356832e5);break;case"T":c[x][S]=new Date((_.read_shift(4)-2440588)*864e5+_.read_shift(4));break;case"Y":c[x][S]=_.read_shift(4,"i")/1e4+_.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[x][S]=-_.read_shift(-8,"f");break;case"B":if(p&&b[S].len==8){c[x][S]=_.read_shift(8,"f");break}case"G":case"P":_.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=b,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Gc(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function s(o,l){try{return Eo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ia(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Dv(),f=Uv(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),m=o["!cols"]||[],v=0,g=0,y=0,E=1;for(v=0;v<h.length;++v){if(((m[v]||{}).DBF||{}).name){h[v]=m[v].DBF.name,++y;continue}if(h[v]!=null){if(++y,typeof h[v]=="number"&&(h[v]=h[v].toString(10)),typeof h[v]!="string")throw new Error("DBF Invalid column name "+h[v]+" |"+typeof h[v]+"|");if(h.indexOf(h[v])!==v){for(g=0;g<1024;++g)if(h.indexOf(h[v]+"_"+g)==-1){h[v]+="_"+g;break}}}}var b=Vr(o["!ref"]),k=[],P=[],w=[];for(v=0;v<=b.e.c-b.s.c;++v){var x="",S="",_=0,A=[];for(g=0;g<p.length;++g)p[g][v]!=null&&A.push(p[g][v]);if(A.length==0||h[v]==null){k[v]="?";continue}for(g=0;g<A.length;++g){switch(typeof A[g]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=A[g]instanceof Date?"D":"C";break;default:S="C"}_=Math.max(_,String(A[g]).length),x=x&&x!=S?"C":S}_>250&&(_=250),S=((m[v]||{}).DBF||{}).type,S=="C"&&m[v].DBF.len>_&&(_=m[v].DBF.len),x=="B"&&S=="N"&&(x="N",w[v]=m[v].DBF.dec,_=m[v].DBF.len),P[v]=x=="C"||S=="N"?_:i[x]||0,E+=P[v],k[v]=x}var C=u.next(32);for(C.write_shift(4,318902576),C.write_shift(4,p.length),C.write_shift(2,296+32*y),C.write_shift(2,E),v=0;v<4;++v)C.write_shift(4,0);for(C.write_shift(4,0|(+e[Z4]||3)<<8),v=0,g=0;v<h.length;++v)if(h[v]!=null){var T=u.next(32),D=(h[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,D,"sbcs"),T.write_shift(1,k[v]=="?"?"C":k[v],"sbcs"),T.write_shift(4,g),T.write_shift(1,P[v]||i[k[v]]||0),T.write_shift(1,w[v]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),g+=P[v]||i[k[v]]||0}var V=u.next(264);for(V.write_shift(4,13),v=0;v<65;++v)V.write_shift(4,0);for(v=0;v<p.length;++v){var B=u.next(E);for(B.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(k[g]){case"L":B.write_shift(1,p[v][g]==null?63:p[v][g]?84:70);break;case"B":B.write_shift(8,p[v][g]||0,"f");break;case"N":var R="0";for(typeof p[v][g]=="number"&&(R=p[v][g].toFixed(w[g]||0)),y=0;y<P[g]-R.length;++y)B.write_shift(1,32);B.write_shift(1,R,"sbcs");break;case"D":p[v][g]?(B.write_shift(4,("0000"+p[v][g].getFullYear()).slice(-4),"sbcs"),B.write_shift(2,("00"+(p[v][g].getMonth()+1)).slice(-2),"sbcs"),B.write_shift(2,("00"+p[v][g].getDate()).slice(-2),"sbcs")):B.write_shift(8,"00000000","sbcs");break;case"C":var F=String(p[v][g]!=null?p[v][g]:"").slice(0,P[g]);for(B.write_shift(1,F,"sbcs"),y=0;y<P[g]-F.length;++y)B.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),kJ=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ma(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=t[p];return typeof m=="number"?hS(m):m},n=function(h,p,m){var v=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return v==59?h:hS(v)};t["|"]=254;function s(h,p){switch(p.type){case"base64":return i(Ps(h),p);case"binary":return i(h,p);case"buffer":return i(Qt&&Buffer.isBuffer(h)?h.toString("binary"):gl(h),p);case"array":return i(sl(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var m=h.split(/[\n\r]+/),v=-1,g=-1,y=0,E=0,b=[],k=[],P=null,w={},x=[],S=[],_=[],A=0,C;for(+p.codepage>=0&&ia(+p.codepage);y!==m.length;++y){A=0;var T=m[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=T.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),V=D[0],B;if(T.length>0)switch(V){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&k.push(T.slice(3).replace(/;;/g,";"));break;case"C":var R=!1,F=!1,M=!1,O=!1,K=-1,j=-1;for(E=1;E<D.length;++E)switch(D[E].charAt(0)){case"A":break;case"X":g=parseInt(D[E].slice(1))-1,F=!0;break;case"Y":for(v=parseInt(D[E].slice(1))-1,F||(g=0),C=b.length;C<=v;++C)b[C]=[];break;case"K":B=D[E].slice(1),B.charAt(0)==='"'?B=B.slice(1,B.length-1):B==="TRUE"?B=!0:B==="FALSE"?B=!1:isNaN(ua(B))?isNaN(Ic(B).getDate())||(B=gn(B)):(B=ua(B),P!==null&&Hc(P)&&(B=Fp(B))),R=!0;break;case"E":O=!0;var H=uc(D[E].slice(1),{r:v,c:g});b[v][g]=[b[v][g],H];break;case"S":M=!0,b[v][g]=[b[v][g],"S5S"];break;case"G":break;case"R":K=parseInt(D[E].slice(1))-1;break;case"C":j=parseInt(D[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(R&&(b[v][g]&&b[v][g].length==2?b[v][g][0]=B:b[v][g]=B,P=null),M){if(O)throw new Error("SYLK shared formula cannot have own formula");var W=K>-1&&b[K][j];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");b[v][g][1]=uk(W[1],{r:v-K,c:g-j})}break;case"F":var X=0;for(E=1;E<D.length;++E)switch(D[E].charAt(0)){case"X":g=parseInt(D[E].slice(1))-1,++X;break;case"Y":for(v=parseInt(D[E].slice(1))-1,C=b.length;C<=v;++C)b[C]=[];break;case"M":A=parseInt(D[E].slice(1))/20;break;case"F":break;case"G":break;case"P":P=k[parseInt(D[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(_=D[E].slice(1).split(" "),C=parseInt(_[0],10);C<=parseInt(_[1],10);++C)A=parseInt(_[2],10),S[C-1]=A===0?{hidden:!0}:{wch:A},kc(S[C-1]);break;case"C":g=parseInt(D[E].slice(1))-1,S[g]||(S[g]={});break;case"R":v=parseInt(D[E].slice(1))-1,x[v]||(x[v]={}),A>0?(x[v].hpt=A,x[v].hpx=Pd(A)):A===0&&(x[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}X<1&&(P=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return x.length>0&&(w["!rows"]=x),S.length>0&&(w["!cols"]=S),p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),[b,w]}function a(h,p){var m=s(h,p),v=m[0],g=m[1],y=Gc(v,p);return Ma(g).forEach(function(E){y[E]=g[E]}),y}function o(h,p){return Eo(a(h,p),p)}function l(h,p,m,v){var g="C;Y"+(m+1)+";X"+(v+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+mee(h.f,{r:m,c:v}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,p){p.forEach(function(m,v){var g="F;W"+(v+1)+" "+(v+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Sh(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Ah(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,p){p.forEach(function(m,v){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*ok(m.hpx)+";"),g.length>2&&h.push(g+"R"+(v+1))})}function f(h,p){var m=["ID;PWXL;N;E"],v=[],g=Vr(h["!ref"]),y,E=Array.isArray(h),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&c(m,h["!cols"]),h["!rows"]&&u(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var k=g.s.r;k<=g.e.r;++k)for(var P=g.s.c;P<=g.e.c;++P){var w=Ft({r:k,c:P});y=E?(h[k]||[])[P]:h[w],!(!y||y.v==null&&(!y.f||y.F))&&v.push(l(y,h,k,P))}return m.join(b)+b+v.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),DJ=function(){function t(i,a){switch(a.type){case"base64":return e(Ps(i),a);case"binary":return e(i,a);case"buffer":return e(Qt&&Buffer.isBuffer(i)?i.toString("binary"):gl(i),a);case"array":return e(sl(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),p=h[0],m=h[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+=`
`+o[++u];switch(v=v.trim(),+p){case-1:if(v==="BOT"){f[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[l][c]=!0:v==="FALSE"?f[l][c]=!1:isNaN(ua(m))?isNaN(Ic(m).getDate())?f[l][c]=m:f[l][c]=gn(m):f[l][c]=ua(m),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(i,a){return Gc(t(i,a),a)}function n(i,a){return Eo(r(i,a),a)}var s=function(){var i=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Vr(l["!ref"]),f,h=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var v=Ft({r:p,c:m});if(f=h?(l[p]||[])[m]:l[v],!f){a(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=js(f.z||Lt[14],ds(gn(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var y=`\r
`,E=c.join(y);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),PJ=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),m=-1,v=-1,g=0,y=[];g!==p.length;++g){var E=p[g].trim().split(":");if(E[0]==="cell"){var b=ls(E[1]);if(y.length<=b.r)for(m=y.length;m<=b.r;++m)y[m]||(y[m]=[]);switch(m=b.r,v=b.c,E[2]){case"t":y[m][v]=t(E[3]);break;case"v":y[m][v]=+E[3];break;case"vtf":var k=E[E.length-1];case"vtc":switch(E[3]){case"nl":y[m][v]=!!+E[4];break;default:y[m][v]=+E[4];break}E[2]=="vtf"&&(y[m][v]=[y[m][v],k])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(f,h){return Gc(r(f,h),h)}function s(f,h){return Eo(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],m,v="",g=jc(f["!ref"]),y=Array.isArray(f),E=g.s.r;E<=g.e.r;++E)for(var b=g.s.c;b<=g.e.c;++b)if(v=Ft({r:E,c:b}),m=y?(f[E]||[])[b]:f[v],!(!m||m.v==null||m.t==="z")){switch(p=["cell",v,"t"],m.t){case"s":case"str":p.push(e(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=e(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=ds(gn(m.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=m.w||js(m.z||Lt[14],k);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,a,o,a,c(f),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),kd=function(){function t(u,f,h,p,m){m.raw?f[h][p]=u:u===""||(u==="TRUE"?f[h][p]=!0:u==="FALSE"?f[h][p]=!1:isNaN(ua(u))?isNaN(Ic(u).getDate())?f[h][p]=u:f[h][p]=gn(u):f[h][p]=ua(u))}function e(u,f){var h=f||{},p=[];if(!u||u.length===0)return p;for(var m=u.split(/[\r\n]/),v=m.length-1;v>=0&&m[v].length===0;)--v;for(var g=10,y=0,E=0;E<=v;++E)y=m[E].indexOf(" "),y==-1?y=m[E].length:y++,g=Math.max(g,y);for(E=0;E<=v;++E){p[E]=[];var b=0;for(t(m[E].slice(0,g).trim(),p,E,b,h),b=1;b<=(m[E].length-g)/10+1;++b)t(m[E].slice(g+(b-1)*10,g+b*10).trim(),p,E,b,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,p=0,m=0;p<u.length;++p)(m=u.charCodeAt(p))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p]);if(!m.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p])}return m.sort(function(v,g){return v[0]-g[0]||n[v[1]]-n[g[1]]}),r[m.pop()[1]]||44}function i(u,f){var h=f||{},p="",m=h.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):h&&h.FS?p=h.FS:p=s(u.slice(0,1024));var g=0,y=0,E=0,b=0,k=0,P=p.charCodeAt(0),w=!1,x=0,S=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var _=h.dateNF!=null?HX(h.dateNF):null;function A(){var C=u.slice(b,k),T={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)T.t="z";else if(h.raw)T.t="s",T.v=C;else if(C.trim().length===0)T.t="s",T.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(T.t="s",T.v=C.slice(2,-1).replace(/""/g,'"')):vee(C)?(T.t="n",T.f=C.slice(1)):(T.t="s",T.v=C);else if(C=="TRUE")T.t="b",T.v=!0;else if(C=="FALSE")T.t="b",T.v=!1;else if(!isNaN(E=ua(C)))T.t="n",h.cellText!==!1&&(T.w=C),T.v=E;else if(!isNaN(Ic(C).getDate())||_&&C.match(_)){T.z=h.dateNF||Lt[14];var D=0;_&&C.match(_)&&(C=jX(C,h.dateNF,C.match(_)||[]),D=1),h.cellDates?(T.t="d",T.v=gn(C,D)):(T.t="n",T.v=ds(gn(C,D))),h.cellText!==!1&&(T.w=js(T.z,T.v instanceof Date?ds(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=C;if(T.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][y]=T):m[Ft({c:y,r:g})]=T),b=k+1,S=u.charCodeAt(b),v.e.c<y&&(v.e.c=y),v.e.r<g&&(v.e.r=g),x==P)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;k<u.length;++k)switch(x=u.charCodeAt(k)){case 34:S===34&&(w=!w);break;case P:case 10:case 13:if(!w&&A())break e;break}return k-b>0&&A(),m["!ref"]=rr(v),m}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):Gc(e(u,f),f)}function o(u,f){var h="",p=f.type=="string"?[0,0,0,0]:cy(u,f);switch(f.type){case"base64":h=Ps(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Td<"u"||(h=Qt&&Buffer.isBuffer(u)?u.toString("binary"):gl(u));break;case"array":h=sl(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Er(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Er(h):f.type=="binary"&&typeof Td<"u",h.slice(0,19)=="socialcalc:version:"?PJ.to_sheet(f.type=="string"?h:Er(h),f):a(h,f)}function l(u,f){return Eo(o(u,f),f)}function c(u){for(var f=[],h=Vr(u["!ref"]),p,m=Array.isArray(u),v=h.s.r;v<=h.e.r;++v){for(var g=[],y=h.s.c;y<=h.e.c;++y){var E=Ft({r:v,c:y});if(p=m?(u[v]||[])[y]:u[E],!p||p.v==null){g.push("          ");continue}for(var b=(p.w||(Ai(p),p.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(y===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function RJ(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=kJ.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return kd.to_workbook(t,e)}}var Yu=function(){function t(H,W,X){if(H){Sn(H,H.l||0);for(var re=X.Enum||K;H.l<H.length;){var he=H.read_shift(2),ue=re[he]||re[65535],pe=H.read_shift(2),q=H.l+pe,G=ue.f&&ue.f(H,pe,X);if(H.l=q,W(G,ue,he))return}}}function e(H,W){switch(W.type){case"base64":return r(sa(Ps(H)),W);case"binary":return r(sa(H),W);case"buffer":case"array":return r(H,W)}throw"Unsupported type "+W.type}function r(H,W){if(!H)return H;var X=W||{},re=X.dense?[]:{},he="Sheet1",ue="",pe=0,q={},G=[],oe=[],Q={s:{r:0,c:0},e:{r:0,c:0}},Y=X.sheetRows||0;if(H[2]==0&&(H[3]==8||H[3]==9)&&H.length>=16&&H[14]==5&&H[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(H[2]==2)X.Enum=K,t(H,function(ae,ce,fe){switch(fe){case 0:X.vers=ae,ae>=4096&&(X.qpro=!0);break;case 6:Q=ae;break;case 204:ae&&(ue=ae);break;case 222:ue=ae;break;case 15:case 51:X.qpro||(ae[1].v=ae[1].v.slice(1));case 13:case 14:case 16:fe==14&&(ae[2]&112)==112&&(ae[2]&15)>1&&(ae[2]&15)<15&&(ae[1].z=X.dateNF||Lt[14],X.cellDates&&(ae[1].t="d",ae[1].v=Fp(ae[1].v))),X.qpro&&ae[3]>pe&&(re["!ref"]=rr(Q),q[he]=re,G.push(he),re=X.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},pe=ae[3],he=ue||"Sheet"+(pe+1),ue="");var Ae=X.dense?(re[ae[0].r]||[])[ae[0].c]:re[Ft(ae[0])];if(Ae){Ae.t=ae[1].t,Ae.v=ae[1].v,ae[1].z!=null&&(Ae.z=ae[1].z),ae[1].f!=null&&(Ae.f=ae[1].f);break}X.dense?(re[ae[0].r]||(re[ae[0].r]=[]),re[ae[0].r][ae[0].c]=ae[1]):re[Ft(ae[0])]=ae[1];break}},X);else if(H[2]==26||H[2]==14)X.Enum=j,H[2]==14&&(X.qpro=!0,H.l=0),t(H,function(ae,ce,fe){switch(fe){case 204:he=ae;break;case 22:ae[1].v=ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ae[3]>pe&&(re["!ref"]=rr(Q),q[he]=re,G.push(he),re=X.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},pe=ae[3],he="Sheet"+(pe+1)),Y>0&&ae[0].r>=Y)break;X.dense?(re[ae[0].r]||(re[ae[0].r]=[]),re[ae[0].r][ae[0].c]=ae[1]):re[Ft(ae[0])]=ae[1],Q.e.c<ae[0].c&&(Q.e.c=ae[0].c),Q.e.r<ae[0].r&&(Q.e.r=ae[0].r);break;case 27:ae[14e3]&&(oe[ae[14e3][0]]=ae[14e3][1]);break;case 1537:oe[ae[0]]=ae[1],ae[0]==pe&&(he=ae[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+H[2]);if(re["!ref"]=rr(Q),q[ue||he]=re,G.push(ue||he),!oe.length)return{SheetNames:G,Sheets:q};for(var Z={},ne=[],ge=0;ge<oe.length;++ge)q[G[ge]]?(ne.push(oe[ge]||G[ge]),Z[oe[ge]]=q[oe[ge]]||q[G[ge]]):(ne.push(oe[ge]),Z[oe[ge]]={"!ref":"A1"});return{SheetNames:ne,Sheets:Z}}function n(H,W){var X=W||{};if(+X.codepage>=0&&ia(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var re=Dv(),he=Vr(H["!ref"]),ue=Array.isArray(H),pe=[];Js(re,0,i(1030)),Js(re,6,l(he));for(var q=Math.min(he.e.r,8191),G=he.s.r;G<=q;++G)for(var oe=kn(G),Q=he.s.c;Q<=he.e.c;++Q){G===he.s.r&&(pe[Q]=cn(Q));var Y=pe[Q]+oe,Z=ue?(H[G]||[])[Q]:H[Y];if(!(!Z||Z.t=="z"))if(Z.t=="n")(Z.v|0)==Z.v&&Z.v>=-32768&&Z.v<=32767?Js(re,13,p(G,Q,Z.v)):Js(re,14,v(G,Q,Z.v));else{var ne=Ai(Z);Js(re,15,f(G,Q,ne.slice(0,239)))}}return Js(re,1),re.end()}function s(H,W){var X=W||{};if(+X.codepage>=0&&ia(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var re=Dv();Js(re,0,a(H));for(var he=0,ue=0;he<H.SheetNames.length;++he)(H.Sheets[H.SheetNames[he]]||{})["!ref"]&&Js(re,27,O(H.SheetNames[he],ue++));var pe=0;for(he=0;he<H.SheetNames.length;++he){var q=H.Sheets[H.SheetNames[he]];if(!(!q||!q["!ref"])){for(var G=Vr(q["!ref"]),oe=Array.isArray(q),Q=[],Y=Math.min(G.e.r,8191),Z=G.s.r;Z<=Y;++Z)for(var ne=kn(Z),ge=G.s.c;ge<=G.e.c;++ge){Z===G.s.r&&(Q[ge]=cn(ge));var ae=Q[ge]+ne,ce=oe?(q[Z]||[])[ge]:q[ae];if(!(!ce||ce.t=="z"))if(ce.t=="n")Js(re,23,A(Z,ge,pe,ce.v));else{var fe=Ai(ce);Js(re,22,x(Z,ge,pe,fe.slice(0,239)))}}++pe}}return Js(re,1),re.end()}function i(H){var W=an(2);return W.write_shift(2,H),W}function a(H){var W=an(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var X=0,re=0,he=0,ue=0;ue<H.SheetNames.length;++ue){var pe=H.SheetNames[ue],q=H.Sheets[pe];if(!(!q||!q["!ref"])){++he;var G=jc(q["!ref"]);X<G.e.r&&(X=G.e.r),re<G.e.c&&(re=G.e.c)}}return X>8191&&(X=8191),W.write_shift(2,X),W.write_shift(1,he),W.write_shift(1,re),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(H,W,X){var re={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&X.qpro?(re.s.c=H.read_shift(1),H.l++,re.s.r=H.read_shift(2),re.e.c=H.read_shift(1),H.l++,re.e.r=H.read_shift(2),re):(re.s.c=H.read_shift(2),re.s.r=H.read_shift(2),W==12&&X.qpro&&(H.l+=2),re.e.c=H.read_shift(2),re.e.r=H.read_shift(2),W==12&&X.qpro&&(H.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function l(H){var W=an(8);return W.write_shift(2,H.s.c),W.write_shift(2,H.s.r),W.write_shift(2,H.e.c),W.write_shift(2,H.e.r),W}function c(H,W,X){var re=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(re[0].c=H.read_shift(1),re[3]=H.read_shift(1),re[0].r=H.read_shift(2),H.l+=2):(re[2]=H.read_shift(1),re[0].c=H.read_shift(2),re[0].r=H.read_shift(2)),re}function u(H,W,X){var re=H.l+W,he=c(H,W,X);if(he[1].t="s",X.vers==20768){H.l++;var ue=H.read_shift(1);return he[1].v=H.read_shift(ue,"utf8"),he}return X.qpro&&H.l++,he[1].v=H.read_shift(re-H.l,"cstr"),he}function f(H,W,X){var re=an(7+X.length);re.write_shift(1,255),re.write_shift(2,W),re.write_shift(2,H),re.write_shift(1,39);for(var he=0;he<re.length;++he){var ue=X.charCodeAt(he);re.write_shift(1,ue>=128?95:ue)}return re.write_shift(1,0),re}function h(H,W,X){var re=c(H,W,X);return re[1].v=H.read_shift(2,"i"),re}function p(H,W,X){var re=an(7);return re.write_shift(1,255),re.write_shift(2,W),re.write_shift(2,H),re.write_shift(2,X,"i"),re}function m(H,W,X){var re=c(H,W,X);return re[1].v=H.read_shift(8,"f"),re}function v(H,W,X){var re=an(13);return re.write_shift(1,255),re.write_shift(2,W),re.write_shift(2,H),re.write_shift(8,X,"f"),re}function g(H,W,X){var re=H.l+W,he=c(H,W,X);if(he[1].v=H.read_shift(8,"f"),X.qpro)H.l=re;else{var ue=H.read_shift(2);k(H.slice(H.l,H.l+ue),he),H.l+=ue}return he}function y(H,W,X){var re=W&32768;return W&=-32769,W=(re?H:0)+(W>=8192?W-16384:W),(re?"":"$")+(X?cn(W):kn(W))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(H,W){Sn(H,0);for(var X=[],re=0,he="",ue="",pe="",q="";H.l<H.length;){var G=H[H.l++];switch(G){case 0:X.push(H.read_shift(8,"f"));break;case 1:ue=y(W[0].c,H.read_shift(2),!0),he=y(W[0].r,H.read_shift(2),!1),X.push(ue+he);break;case 2:{var oe=y(W[0].c,H.read_shift(2),!0),Q=y(W[0].r,H.read_shift(2),!1);ue=y(W[0].c,H.read_shift(2),!0),he=y(W[0].r,H.read_shift(2),!1),X.push(oe+Q+":"+ue+he)}break;case 3:if(H.l<H.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(H.read_shift(2));break;case 6:{for(var Y="";G=H[H.l++];)Y+=String.fromCharCode(G);X.push('"'+Y.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:q=X.pop(),pe=X.pop(),X.push(["AND","OR"][G-20]+"("+pe+","+q+")");break;default:if(G<32&&b[G])q=X.pop(),pe=X.pop(),X.push(pe+b[G]+q);else if(E[G]){if(re=E[G][1],re==69&&(re=H[H.l++]),re>X.length){console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+X.join("|")+"|");return}var Z=X.slice(-re);X.length-=re,X.push(E[G][0]+"("+Z.join(",")+")")}else return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16))}}X.length==1?W[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function P(H){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=H.read_shift(2),W[3]=H[H.l++],W[0].c=H[H.l++],W}function w(H,W){var X=P(H);return X[1].t="s",X[1].v=H.read_shift(W-4,"cstr"),X}function x(H,W,X,re){var he=an(6+re.length);he.write_shift(2,H),he.write_shift(1,X),he.write_shift(1,W),he.write_shift(1,39);for(var ue=0;ue<re.length;++ue){var pe=re.charCodeAt(ue);he.write_shift(1,pe>=128?95:pe)}return he.write_shift(1,0),he}function S(H,W){var X=P(H);X[1].v=H.read_shift(2);var re=X[1].v>>1;if(X[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return X[1].v=re,X}function _(H,W){var X=P(H),re=H.read_shift(4),he=H.read_shift(4),ue=H.read_shift(2);if(ue==65535)return re===0&&he===3221225472?(X[1].t="e",X[1].v=15):re===0&&he===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var pe=ue&32768;return ue=(ue&32767)-16446,X[1].v=(1-pe*2)*(he*Math.pow(2,ue+32)+re*Math.pow(2,ue)),X}function A(H,W,X,re){var he=an(14);if(he.write_shift(2,H),he.write_shift(1,X),he.write_shift(1,W),re==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var ue=0,pe=0,q=0,G=0;return re<0&&(ue=1,re=-re),pe=Math.log2(re)|0,re/=Math.pow(2,pe-31),G=re>>>0,G&2147483648||(re/=2,++pe,G=re>>>0),re-=G,G|=2147483648,G>>>=0,re*=Math.pow(2,32),q=re>>>0,he.write_shift(4,q),he.write_shift(4,G),pe+=16383+(ue?32768:0),he.write_shift(2,pe),he}function C(H,W){var X=_(H);return H.l+=W-14,X}function T(H,W){var X=P(H),re=H.read_shift(4);return X[1].v=re>>6,X}function D(H,W){var X=P(H),re=H.read_shift(8,"f");return X[1].v=re,X}function V(H,W){var X=D(H);return H.l+=W-10,X}function B(H,W){return H[H.l+W-1]==0?H.read_shift(W,"cstr"):""}function R(H,W){var X=H[H.l++];X>W-1&&(X=W-1);for(var re="";re.length<X;)re+=String.fromCharCode(H[H.l++]);return re}function F(H,W,X){if(!(!X.qpro||W<21)){var re=H.read_shift(1);H.l+=17,H.l+=1,H.l+=2;var he=H.read_shift(W-21,"cstr");return[re,he]}}function M(H,W){for(var X={},re=H.l+W;H.l<re;){var he=H.read_shift(2);if(he==14e3){for(X[he]=[0,""],X[he][0]=H.read_shift(2);H[H.l];)X[he][1]+=String.fromCharCode(H[H.l]),H.l++;H.l++}}return X}function O(H,W){var X=an(5+H.length);X.write_shift(2,14e3),X.write_shift(2,W);for(var re=0;re<H.length;++re){var he=H.charCodeAt(re);X[X.l++]=he>127?95:he}return X[X.l++]=0,X}var K={0:{n:"BOF",f:Zr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:B},222:{n:"SHEETNAMELP",f:R},65535:{n:""}},j={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:_},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:M},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:B},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:F},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function FJ(t){var e={},r=t.match(Jn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=wt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Ux[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var NJ=function(){var t=Cd("t"),e=Cd("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:sr(a[1])},l=i.match(e);return l&&(o.s=FJ(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),OJ=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),MJ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,LJ=/<(?:\w+:)?r>/,BJ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ry(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=sr(Er(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Er(t),r&&(n.h=zx(n.t))):t.match(LJ)&&(n.r=Er(t),n.t=sr(Er((t.replace(BJ,"").match(MJ)||[]).join("").replace(Jn,""))),r&&(n.h=OJ(NJ(n.r)))),n):{t:""}}var UJ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$J=/<(?:\w+:)?(?:si|sstItem)>/g,VJ=/<\/(?:\w+:)?(?:si|sstItem)>/;function HJ(t,e){var r=[],n="";if(!t)return r;var s=t.match(UJ);if(s){n=s[2].replace($J,"").split(VJ);for(var i=0;i!=n.length;++i){var a=ry(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=wt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function jJ(t){return[t.read_shift(4),t.read_shift(4)]}function GJ(t,e){var r=[],n=!1;return Ci(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function tk(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function fi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function WJ(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=fi(t,4),e.U=fi(t,4),e.W=fi(t,4),e}function zJ(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function KJ(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(zJ(t));return e}function qJ(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function XJ(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=fi(t,4),e.U=fi(t,4),e.W=fi(t,4),e}function YJ(t){var e=XJ(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function rk(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function nk(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function QJ(t){var e=fi(t);switch(e.Minor){case 2:return[e.Minor,JJ(t)];case 3:return[e.Minor,ZJ()];case 4:return[e.Minor,eZ(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function JJ(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=rk(t,r),s=nk(t,t.length-t.l);return{t:"Std",h:n,v:s}}function ZJ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function eZ(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Jn,function(i){var a=wt(i);switch(Va(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function tZ(t,e){var r={},n=r.EncryptionVersionInfo=fi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=rk(t,s),e-=s,r.EncryptionVerifier=nk(t,e),r}function rZ(t){var e={},r=e.EncryptionVersionInfo=fi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function nZ(t){var e=0,r,n=tk(t),s=n.length+1,i,a,o,l,c;for(r=po(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var sk=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=tk(a),l=i(o),c=o.length,u=po(16),f=0;f!=16;++f)u[f]=0;var h,p,m;for((c&1)===1&&(h=l>>8,u[c]=s(t[0],h),--c,h=l&255,p=o[o.length-1],u[c]=s(p,h));c>0;)--c,h=l>>8,u[c]=s(o[c],h),--c,h=l&255,u[c]=s(o[c],h);for(c=15,m=15-o.length;m>0;)h=l>>8,u[c]=s(t[m],h),--c,--m,h=l&255,u[c]=s(o[c],h),--c,--m;return u}}(),sZ=function(t,e,r,n,s){s||(s=e),n||(n=sk(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},aZ=function(t){var e=0,r=sk(t);return function(n){var s=sZ("",n,e,r);return e=s[1],s[0]}};function iZ(t,e,r,n){var s={key:Zr(t),verificationBytes:Zr(t)};return r.password&&(s.verifier=nZ(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=aZ(r.password)),s}function oZ(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=rZ(t):n.Data=tZ(t,e),n}function lZ(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?oZ(t,e-2,n):iZ(t,r.biff>=8?e:e-2,r,n),n}var cZ=function(){function t(s,i){switch(i.type){case"base64":return e(Ps(s),i);case"binary":return e(s,i);case"buffer":return e(Qt&&Buffer.isBuffer(s)?s.toString("binary"):gl(s),i);case"array":return e(sl(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,m,v=-1;m=h.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(p,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++v,g.length){var y={v:g,t:"s"};Array.isArray(o)?o[f][v]=y:o[Ft({r:f,c:v})]=y}break}p=h.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=rr(c),o}function r(s,i){return Eo(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Vr(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Ft({r:c,c:u});o=l?(s[c]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ai(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function uZ(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Dd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function dZ(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function fZ(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function bh(t,e){if(e===0)return t;var r=dZ(uZ(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Dd(fZ(r))}var ak=6,hZ=15,pZ=1,os=ak;function Sh(t){return Math.floor((t+Math.round(128/os)/256)*os)}function Ah(t){return Math.floor((t-5)/os*100+.5)/100}function Nv(t){return Math.round((t*os+5)/os*256)/256}function cg(t){return Nv(Ah(Sh(t)))}function ny(t){var e=Math.abs(t-cg(t)),r=os;if(e>.005)for(os=pZ;os<hZ;++os)Math.abs(t-cg(t))<=e&&(e=Math.abs(t-cg(t)),r=os);os=r}function kc(t){t.width?(t.wpx=Sh(t.width),t.wch=Ah(t.wpx),t.MDW=os):t.wpx?(t.wch=Ah(t.wpx),t.width=Nv(t.wch),t.MDW=os):typeof t.wch=="number"&&(t.width=Nv(t.wch),t.wpx=Sh(t.width),t.MDW=os),t.customWidth&&delete t.customWidth}var mZ=96,ik=mZ;function ok(t){return t*96/ik}function Pd(t){return t*ik/96}var gZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function vZ(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Jn)||[]).forEach(function(a){var o=wt(a);switch(Va(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Ir(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Ir(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function xZ(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Jn)||[]).forEach(function(a){var o=wt(a);switch(Va(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function yZ(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Jn)||[]).forEach(function(a){var o=wt(a);switch(Va(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Er(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Ir(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Ir(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Ir(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Ir(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Ir(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Ir(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Ir(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Ux[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Ir(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Wo[s.color.index];s.color.index==81&&(l=Wo[1]),l||(l=Wo[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=bh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function EZ(t,e,r){e.NumberFmt=[];for(var n=Ma(Lt),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Lt[n[s]];var i=t[0].match(Jn);if(i)for(s=0;s<i.length;++s){var a=wt(i[s]);switch(Va(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=sr(Er(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Go(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Qf=["numFmtId","fillId","fontId","borderId","xfId"],Jf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function _Z(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Jn)||[]).forEach(function(i){var a=wt(i),o=0;switch(Va(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Qf.length;++o)n[Qf[o]]&&(n[Qf[o]]=parseInt(n[Qf[o]],10));for(o=0;o<Jf.length;++o)n[Jf[o]]&&(n[Jf[o]]=Ir(n[Jf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Ir(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var bZ=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&EZ(f,u,c),(f=o.match(s))&&yZ(f,u,l,c),(f=o.match(n))&&xZ(f,u,l,c),(f=o.match(i))&&vZ(f,u,l,c),(f=o.match(r))&&_Z(f,u,c),u}}();function SZ(t,e){var r=t.read_shift(2),n=Xn(t);return[r,n]}function AZ(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=NY(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=FY(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Xn(t),n}var TZ=Qn;function wZ(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var CZ=Qn;function IZ(t,e,r){var n={};n.NumberFmt=[];for(var s in Lt)n.NumberFmt[s]=Lt[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return Ci(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Go(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=bh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(u),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var kZ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function DZ(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Jn)||[]).forEach(function(s){var i=wt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[kZ.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function PZ(){}function RZ(){}var FZ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,NZ=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,OZ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function MZ(t,e,r){e.themeElements={};var n;[["clrScheme",FZ,DZ],["fontScheme",NZ,PZ],["fmtScheme",OZ,RZ]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var LZ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function lk(t,e){(!t||t.length===0)&&(t=BZ());var r,n={};if(!(r=t.match(LZ)))throw new Error("themeElements not found in theme");return MZ(r[0],n,e),n.raw=t,n}function BZ(t,e){var r=[yI];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function UZ(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=xI(i,{type:"array"})}catch{return}var o=ws(a,"theme/theme/theme1.xml",!0);if(o)return lk(o,r)}}function $Z(t){return t.read_shift(4)}function VZ(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=HZ(t,4);break;case 2:e.xclrValue=qI(t);break;case 3:e.xclrValue=$Z(t);break;case 4:t.l+=4;break}return t.l+=8,e}function HZ(t,e){return Qn(t,e)}function jZ(t,e){return Qn(t,e)}function GZ(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=VZ(t);break;case 6:n[1]=jZ(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function WZ(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(GZ(t,r-t.l));return{ixfe:n,ext:i}}function zZ(t,e){e.forEach(function(r){switch(r[0]){}})}function KZ(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Xn(t)}}function qZ(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function XZ(t){return t.l+=4,t.read_shift(4)!=0}function YZ(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return Ci(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function QZ(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(Jn,function(o){var l=wt(o);switch(Va(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function JZ(t){var e=[];if(!t)return e;var r=1;return(t.match(Jn)||[]).forEach(function(n){var s=wt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function ZZ(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ft(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function eee(t,e,r){var n=[];return Ci(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function tee(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Ci(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function ree(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function JS(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=ls(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=Vr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=rr(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function nee(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=wt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=ls(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&ry(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function see(t,e){var r=[],n=!1,s={},i=0;return t.replace(Jn,function(o,l){var c=wt(o);switch(Va(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function aee(t,e){var r=[],n=!1;return t.replace(Jn,function(i){var a=wt(i);switch(Va(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function iee(t){var e={};e.iauthor=t.read_shift(4);var r=xl(t);return e.rfx=r.s,e.ref=Ft(r.s),t.l+=16,e}var oee=Xn;function lee(t,e){var r=[],n=[],s={},i=!1;return Ci(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var cee="application/vnd.ms-office.vbaProject";function uee(t){var e=tr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),tr.write(e)}function dee(){return{"!type":"dialog"}}function fee(){return{"!type":"dialog"}}function hee(){return{"!type":"macro"}}function pee(){return{"!type":"macro"}}var uc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+cn(u)+(l?"":"$")+kn(c)}return function(s,i){return e=i,s.replace(t,r)}}(),ck=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mee=function(){return function(e,r){return e.replace(ck,function(n,s,i,a,o,l){var c=Yx(a)-(i?0:r.c),u=Xx(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":i?c+1:"["+c+"]";return s+"R"+f+"C"+h})}}();function uk(t,e){return t.replace(ck,function(r,n,s,i,a,o){return n+(s=="$"?s+i:cn(Yx(i)+e.c))+(a=="$"?a+o:kn(Xx(o)+e.r))})}function gee(t,e,r){var n=jc(e),s=n.s,i=ls(r),a={r:i.r-s.r,c:i.c-s.c};return uk(t,a)}function vee(t){return t.length!=1}function ZS(t){return t.replace(/_xlfn\./g,"")}function Xr(t){t.l+=1}function mo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function dk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return fk(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=mo(t),o=mo(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function fk(t){var e=mo(t),r=mo(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function xee(t,e,r){if(r.biff<8)return fk(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=mo(t),a=mo(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function hk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return yee(t);var n=t.read_shift(r&&r.biff==12?4:2),s=mo(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function yee(t){var e=mo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Eee(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _ee(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return bee(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function bee(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function See(t,e,r){var n=(t[t.l++]&96)>>5,s=dk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Aee(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=dk(t,i,r);return[n,s,a]}function Tee(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function wee(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function Cee(t,e,r){var n=(t[t.l++]&96)>>5,s=xee(t,e-1,r);return[n,s]}function Iee(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function e2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function kee(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function Dee(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Pee(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Ree(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Fee(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function pk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Nee(t){return t.read_shift(2),pk(t)}function Oee(t){return t.read_shift(2),pk(t)}function Mee(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=hk(t,0,r);return[n,s]}function Lee(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=_ee(t,0,r);return[n,s]}function Bee(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=hk(t,0,r);return[n,s,i]}function Uee(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[$te[s],vk[s],n]}function $ee(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Vee(t);return[s,(i[0]===0?vk:Ute)[i[1]]]}function Vee(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Hee(t,e,r){t.l+=r&&r.biff==2?3:4}function jee(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Gee(t){return t.l++,yl[t.read_shift(1)]}function Wee(t){return t.l++,t.read_shift(2)}function zee(t){return t.l++,t.read_shift(1)!==0}function Kee(t){return t.l++,Hn(t)}function qee(t,e,r){return t.l++,af(t,e-1,r)}function Xee(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=jr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=yl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Hn(t);break;case 2:r[1]=El(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Yee(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?xl:Np)(t));return s}function Qee(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=Xee(t,r.biff);return a}function Jee(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function Zee(t,e,r){if(r.biff==5)return ete(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function ete(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function tte(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function rte(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function nte(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function ste(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var ate=Qn,ite=Qn,ote=Qn;function lf(t,e,r){return t.l+=2,[Eee(t)]}function sy(t){return t.l+=6,[]}var lte=lf,cte=sy,ute=sy,dte=lf;function mk(t){return t.l+=2,[Zr(t),t.read_shift(2)&1]}var fte=lf,hte=mk,pte=sy,mte=lf,gte=lf,vte=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function xte(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=vte[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function yte(t){return t.l+=2,[t.read_shift(4)]}function Ete(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function _te(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bte(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Ste(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Ate(t){return t.l+=4,[0,0]}var t2={1:{n:"PtgExp",f:jee},2:{n:"PtgTbl",f:ote},3:{n:"PtgAdd",f:Xr},4:{n:"PtgSub",f:Xr},5:{n:"PtgMul",f:Xr},6:{n:"PtgDiv",f:Xr},7:{n:"PtgPower",f:Xr},8:{n:"PtgConcat",f:Xr},9:{n:"PtgLt",f:Xr},10:{n:"PtgLe",f:Xr},11:{n:"PtgEq",f:Xr},12:{n:"PtgGe",f:Xr},13:{n:"PtgGt",f:Xr},14:{n:"PtgNe",f:Xr},15:{n:"PtgIsect",f:Xr},16:{n:"PtgUnion",f:Xr},17:{n:"PtgRange",f:Xr},18:{n:"PtgUplus",f:Xr},19:{n:"PtgUminus",f:Xr},20:{n:"PtgPercent",f:Xr},21:{n:"PtgParen",f:Xr},22:{n:"PtgMissArg",f:Xr},23:{n:"PtgStr",f:qee},26:{n:"PtgSheet",f:Ete},27:{n:"PtgEndSheet",f:_te},28:{n:"PtgErr",f:Gee},29:{n:"PtgBool",f:zee},30:{n:"PtgInt",f:Wee},31:{n:"PtgNum",f:Kee},32:{n:"PtgArray",f:Iee},33:{n:"PtgFunc",f:Uee},34:{n:"PtgFuncVar",f:$ee},35:{n:"PtgName",f:Jee},36:{n:"PtgRef",f:Mee},37:{n:"PtgArea",f:See},38:{n:"PtgMemArea",f:tte},39:{n:"PtgMemErr",f:ate},40:{n:"PtgMemNoMem",f:ite},41:{n:"PtgMemFunc",f:rte},42:{n:"PtgRefErr",f:nte},43:{n:"PtgAreaErr",f:Tee},44:{n:"PtgRefN",f:Lee},45:{n:"PtgAreaN",f:Cee},46:{n:"PtgMemAreaN",f:bte},47:{n:"PtgMemNoMemN",f:Ste},57:{n:"PtgNameX",f:Zee},58:{n:"PtgRef3d",f:Bee},59:{n:"PtgArea3d",f:Aee},60:{n:"PtgRefErr3d",f:ste},61:{n:"PtgAreaErr3d",f:wee},255:{}},Tte={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},wte={1:{n:"PtgElfLel",f:mk},2:{n:"PtgElfRw",f:mte},3:{n:"PtgElfCol",f:lte},6:{n:"PtgElfRwV",f:gte},7:{n:"PtgElfColV",f:dte},10:{n:"PtgElfRadical",f:fte},11:{n:"PtgElfRadicalS",f:pte},13:{n:"PtgElfColS",f:cte},15:{n:"PtgElfColSV",f:ute},16:{n:"PtgElfRadicalLel",f:hte},25:{n:"PtgList",f:xte},29:{n:"PtgSxName",f:yte},255:{}},Cte={0:{n:"PtgAttrNoop",f:Ate},1:{n:"PtgAttrSemi",f:Fee},2:{n:"PtgAttrIf",f:Pee},4:{n:"PtgAttrChoose",f:kee},8:{n:"PtgAttrGoto",f:Dee},16:{n:"PtgAttrSum",f:Hee},32:{n:"PtgAttrBaxcel",f:e2},33:{n:"PtgAttrBaxcel",f:e2},64:{n:"PtgAttrSpace",f:Nee},65:{n:"PtgAttrSpaceSemi",f:Oee},128:{n:"PtgAttrIfError",f:Ree},255:{}};function cf(t,e,r,n){if(n.biff<8)return Qn(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=Qee(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Yee(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Qn(t,e)),i}function uf(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=t2[i]||t2[Tte[i]],(i===24||i===25)&&(s=(i===24?wte:Cte)[t[t.l+1]]),!s||!s.f?Qn(t,e):a.push([s.n,s.f(t,e,r)]);return a}function Ite(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var kte={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Dte(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function gk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function r2(t,e,r){var n=gk(t,e,r);return n=="#REF"?n:Dte(n,r)}function Un(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,f=0,h=0,p,m="";if(!t[0]||!t[0][0])return"";for(var v=-1,g="",y=0,E=t[0].length;y<E;++y){var b=t[0][y];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:g=Ur(" ",t[0][v][1][1]);break;case 1:g=Ur("\r",t[0][v][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}c=c+g,v=-1}o.push(c+kte[b[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=zu(b[1][1],a,s),o.push(Ku(u,i));break;case"PtgRefN":u=r?zu(b[1][1],r,s):b[1][1],o.push(Ku(u,i));break;case"PtgRef3d":f=b[1][1],u=zu(b[1][2],a,s),m=r2(n,f,s),o.push(m+"!"+Ku(u,i));break;case"PtgFunc":case"PtgFuncVar":var k=b[1][0],P=b[1][1];k||(k=0),k&=127;var w=k==0?[]:o.slice(-k);o.length-=k,P==="User"&&(P=w.shift()),o.push(P+"("+w.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":p=MS(b[1][1],r?{s:r}:a,s),o.push(og(p,s));break;case"PtgArea":p=MS(b[1][1],a,s),o.push(og(p,s));break;case"PtgArea3d":f=b[1][1],p=b[1][2],m=r2(n,f,s),o.push(m+"!"+og(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var x=(n.names||[])[h-1]||(n[0]||[])[h],S=x?x.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var _=b[1][1];h=b[1][2];var A;if(s.biff<=5)_<0&&(_=-_),n[_]&&(A=n[_][h]);else{var C="";if(((n[_]||[])[0]||[])[0]==14849||(((n[_]||[])[0]||[])[0]==1025?n[_][h]&&n[_][h].itab>0&&(C=n.SheetNames[n[_][h].itab-1]+"!"):C=n.SheetNames[h-1]+"!"),n[_]&&n[_][h])C+=n[_][h].Name;else if(n[0]&&n[0][h])C+=n[0][h].Name;else{var T=(gk(n,_,s)||"").split(";;");T[h-1]?C=T[h-1]:C+="SH33TJSERRX"}o.push(C);break}A||(A={Name:"SH33TJSERRY"}),o.push(A.Name);break;case"PtgParen":var D="(",V=")";if(v>=0){switch(g="",t[0][v][1][0]){case 2:D=Ur(" ",t[0][v][1][1])+D;break;case 3:D=Ur("\r",t[0][v][1][1])+D;break;case 4:V=Ur(" ",t[0][v][1][1])+V;break;case 5:V=Ur("\r",t[0][v][1][1])+V;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(D+o.pop()+V);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var B={c:r.c,r:r.r};if(n.sharedf[Ft(u)]){var R=n.sharedf[Ft(u)];o.push(Un(R,a,B,n,s))}else{var F=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Un(c[1],a,B,n,s)),F=!0;break}F||o.push(b[1])}break;case"PtgArray":o.push("{"+Ite(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var M=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&M.indexOf(t[0][y][0])==-1){b=t[0][v];var O=!0;switch(b[1][0]){case 4:O=!1;case 0:g=Ur(" ",b[1][1]);break;case 5:O=!1;case 1:g=Ur("\r",b[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((O?g:"")+o.pop()+(O?"":g)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Pte(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Qn(t,e-2)];var o=uf(t,a,r);return e!==a+s&&(i=cf(t,e-a-s,o,r)),t.l=n,[o,i]}function Rte(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Qn(t,e-2)];var o=uf(t,a,r);return e!==a+s&&(i=cf(t,e-a-s,o,r)),t.l=n,[o,i]}function Fte(t,e,r,n){var s=t.l+e,i=uf(t,n,r),a;return s!==t.l&&(a=cf(t,s-t.l,i,r)),[i,a]}function Nte(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=uf(t,i,r);return i==65535?[[],Qn(t,e-2)]:(e!==i+2&&(s=cf(t,n-i-2,a,r)),[a,s])}function Ote(t){var e;if(li(t,t.l+6)!==65535)return[Hn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function ug(t,e,r){var n=t.l+e,s=Ha(t);r.biff==2&&++t.l;var i=Ote(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=Rte(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function Op(t,e,r){var n=t.read_shift(4),s=uf(t,n,r),i=t.read_shift(4),a=i>0?cf(t,i,s,r):null;return[s,a]}var Mte=Op,Mp=Op,Lte=Op,Bte=Op,Ute={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$te={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function n2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function dg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Qu={},dc={};function Ju(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function xk(t,e,r,n,s,i){try{n.cellNF&&(t.z=Lt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=gn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Lt[e]==null&&Go(VX[e]||"General",e),t.t==="e")t.w=t.w||yl[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=wd(t.v);else if(t.t==="d"){var a=ds(t.v);(a|0)===a?t.w=a.toString(10):t.w=wd(a)}else{if(t.v===void 0)return"";t.w=nl(t.v,dc)}else t.t==="d"?t.w=js(e,ds(t.v),dc):t.w=js(e,t.v,dc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=bh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=bh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function Vte(t,e){var r=Vr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=rr(r))}var Hte=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jte=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Gte=/<(?:\w:)?hyperlink [^>]*>/mg,Wte=/"(\w*:\w*)"/,zte=/<(?:\w:)?col\b[^>]*[\/]?>/g,Kte=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,qte=/<(?:\w:)?pageMargins[^>]*\/>/g,yk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Xte=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Yte=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Qte(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=t.match(jte);f?(c=t.slice(0,f.index),u=t.slice(f.index+f[0].length)):c=u=t;var h=c.match(yk);h?ay(h[0],o,s,r):(h=c.match(Xte))&&Jte(h[0],h[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=c.slice(p,p+50).match(Wte);m&&Vte(o,m[1])}var v=c.match(Yte);v&&v[1]&&sre(v[1],s);var g=[];if(e.cellStyles){var y=c.match(zte);y&&tre(g,y)}f&&are(f[1],o,e,l,i,a);var E=u.match(Kte);E&&(o["!autofilter"]=rre(E[0]));var b=[],k=u.match(Hte);if(k)for(p=0;p!=k.length;++p)b[p]=Vr(k[p].slice(k[p].indexOf('"')+1));var P=u.match(Gte);P&&Zte(o,P,n);var w=u.match(qte);if(w&&(o["!margins"]=ere(wt(w[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=rr(l)),e.sheetRows>0&&o["!ref"]){var x=Vr(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=rr(x))}return g.length>0&&(o["!cols"]=g),b.length>0&&(o["!merges"]=b),o}function ay(t,e,r,n){var s=wt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=sr(Er(s.codeName)))}function Jte(t,e,r,n,s){ay(t.slice(0,t.indexOf(">")),r,n,s)}function Zte(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=wt(Er(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+sr(i.location))):(i.Target="#"+sr(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Vr(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ft({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function ere(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function tre(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=wt(e[n],!0);s.hidden&&(s.hidden=Ir(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ny(s.width)),kc(s);i<=a;)t[i++]=In(s)}}function rre(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var nre=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function sre(t,e){e.Views||(e.Views=[{}]),(t.match(nre)||[]).forEach(function(r,n){var s=wt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Ir(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var are=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Cd("v"),a=Cd("f");return function(l,c,u,f,h,p){for(var m=0,v="",g=[],y=[],E=0,b=0,k=0,P="",w,x,S=0,_=0,A,C,T=0,D=0,V=Array.isArray(p.CellXf),B,R=[],F=[],M=Array.isArray(c),O=[],K={},j=!1,H=!!u.sheetStubs,W=l.split(e),X=0,re=W.length;X!=re;++X){v=W[X].trim();var he=v.length;if(he!==0){var ue=0;e:for(m=0;m<he;++m)switch(v[m]){case">":if(v[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(x=wt(v.slice(ue,m),!0),S=x.r!=null?parseInt(x.r,10):S+1,_=-1,u.sheetRows&&u.sheetRows<S)continue;K={},j=!1,x.ht&&(j=!0,K.hpt=parseFloat(x.ht),K.hpx=Pd(K.hpt)),x.hidden=="1"&&(j=!0,K.hidden=!0),x.outlineLevel!=null&&(j=!0,K.level=+x.outlineLevel),j&&(O[S-1]=K)}break;case"<":ue=m;break}if(ue>=m)break;if(x=wt(v.slice(ue,m),!0),S=x.r!=null?parseInt(x.r,10):S+1,_=-1,!(u.sheetRows&&u.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),u&&u.cellStyles&&(K={},j=!1,x.ht&&(j=!0,K.hpt=parseFloat(x.ht),K.hpx=Pd(K.hpt)),x.hidden=="1"&&(j=!0,K.hidden=!0),x.outlineLevel!=null&&(j=!0,K.level=+x.outlineLevel),j&&(O[S-1]=K)),g=v.slice(m).split(t);for(var pe=0;pe!=g.length&&g[pe].trim().charAt(0)=="<";++pe);for(g=g.slice(pe),m=0;m!=g.length;++m)if(v=g[m].trim(),v.length!==0){if(y=v.match(r),E=m,b=0,k=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,y!=null&&y.length===2){for(E=0,P=y[1],b=0;b!=P.length&&!((k=P.charCodeAt(b)-64)<1||k>26);++b)E=26*E+k;--E,_=E}else++_;for(b=0;b!=v.length&&v.charCodeAt(b)!==62;++b);if(++b,x=wt(v.slice(0,b),!0),x.r||(x.r=Ft({r:S-1,c:_})),P=v.slice(b),w={t:""},(y=P.match(i))!=null&&y[1]!==""&&(w.v=sr(y[1])),u.cellFormula){if((y=P.match(a))!=null&&y[1]!==""){if(w.f=sr(Er(y[1])).replace(/\r\n/g,`
`),u.xlfn||(w.f=ZS(w.f)),y[0].indexOf('t="array"')>-1)w.F=(P.match(s)||[])[1],w.F.indexOf(":")>-1&&R.push([Vr(w.F),w.F]);else if(y[0].indexOf('t="shared"')>-1){C=wt(y[0]);var q=sr(Er(y[1]));u.xlfn||(q=ZS(q)),F[parseInt(C.si,10)]=[C,q,x.r]}}else(y=P.match(/<f[^>]*\/>/))&&(C=wt(y[0]),F[C.si]&&(w.f=gee(F[C.si][1],F[C.si][2],x.r)));var G=ls(x.r);for(b=0;b<R.length;++b)G.r>=R[b][0].s.r&&G.r<=R[b][0].e.r&&G.c>=R[b][0].s.c&&G.c<=R[b][0].e.c&&(w.F=R[b][1])}if(x.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(H)w.t="z";else continue;else w.t=x.t||"n";switch(f.s.c>_&&(f.s.c=_),f.e.c<_&&(f.e.c=_),w.t){case"n":if(w.v==""||w.v==null){if(!H)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v>"u"){if(!H)continue;w.t="z"}else A=Qu[parseInt(w.v,10)],w.v=A.t,w.r=A.r,u.cellHTML&&(w.h=A.h);break;case"str":w.t="s",w.v=w.v!=null?Er(w.v):"",u.cellHTML&&(w.h=zx(w.v));break;case"inlineStr":y=P.match(n),w.t="s",y!=null&&(A=ry(y[1]))?(w.v=A.t,u.cellHTML&&(w.h=A.h)):w.v="";break;case"b":w.v=Ir(w.v);break;case"d":u.cellDates?w.v=gn(w.v,1):(w.v=ds(gn(w.v,1)),w.t="n");break;case"e":(!u||u.cellText!==!1)&&(w.w=w.v),w.v=$I[w.v];break}if(T=D=0,B=null,V&&x.s!==void 0&&(B=p.CellXf[x.s],B!=null&&(B.numFmtId!=null&&(T=B.numFmtId),u.cellStyles&&B.fillId!=null&&(D=B.fillId))),xk(w,T,D,u,h,p),u.cellDates&&V&&w.t=="n"&&Hc(Lt[T])&&(w.t="d",w.v=Fp(w.v)),x.cm&&u.xlmeta){var oe=(u.xlmeta.Cell||[])[+x.cm-1];oe&&oe.type=="XLDAPR"&&(w.D=!0)}if(M){var Q=ls(x.r);c[Q.r]||(c[Q.r]=[]),c[Q.r][Q.c]=w}else c[x.r]=w}}}}O.length>0&&(c["!rows"]=O)}}();function ire(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var ore=xl;function lre(){}function cre(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=PY(t),r}function ure(t){var e=Ks(t);return[e]}function dre(t){var e=vl(t);return[e]}function fre(t){var e=Ks(t),r=t.read_shift(1);return[e,r,"b"]}function hre(t){var e=vl(t),r=t.read_shift(1);return[e,r,"b"]}function pre(t){var e=Ks(t),r=t.read_shift(1);return[e,r,"e"]}function mre(t){var e=vl(t),r=t.read_shift(1);return[e,r,"e"]}function gre(t){var e=Ks(t),r=t.read_shift(4);return[e,r,"s"]}function vre(t){var e=vl(t),r=t.read_shift(4);return[e,r,"s"]}function xre(t){var e=Ks(t),r=Hn(t);return[e,r,"n"]}function Ek(t){var e=vl(t),r=Hn(t);return[e,r,"n"]}function yre(t){var e=Ks(t),r=Zx(t);return[e,r,"n"]}function Ere(t){var e=vl(t),r=Zx(t);return[e,r,"n"]}function _re(t){var e=Ks(t),r=Qx(t);return[e,r,"is"]}function bre(t){var e=Ks(t),r=Xn(t);return[e,r,"str"]}function Sre(t){var e=vl(t),r=Xn(t);return[e,r,"str"]}function Are(t,e,r){var n=t.l+e,s=Ks(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=Mp(t,n-t.l,r);a[3]=Un(o,null,s,r.supbooks,r)}else t.l=n;return a}function Tre(t,e,r){var n=t.l+e,s=Ks(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=Mp(t,n-t.l,r);a[3]=Un(o,null,s,r.supbooks,r)}else t.l=n;return a}function wre(t,e,r){var n=t.l+e,s=Ks(t);s.r=r["!row"];var i=Hn(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=Mp(t,n-t.l,r);a[3]=Un(o,null,s,r.supbooks,r)}else t.l=n;return a}function Cre(t,e,r){var n=t.l+e,s=Ks(t);s.r=r["!row"];var i=Xn(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=Mp(t,n-t.l,r);a[3]=Un(o,null,s,r.supbooks,r)}else t.l=n;return a}var Ire=xl;function kre(t,e){var r=t.l+e,n=xl(t),s=Jx(t),i=Xn(t),a=Xn(t),o=Xn(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function Dre(){}function Pre(t,e,r){var n=t.l+e,s=LI(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=Mte(t,n-t.l,r);a[1]=o}else t.l=n;return a}function Rre(t,e,r){var n=t.l+e,s=xl(t),i=[s];if(r.cellFormula){var a=Bte(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var Fre=["left","right","top","bottom","header","footer"];function Nre(t){var e={};return Fre.forEach(function(r){e[r]=Hn(t)}),e}function Ore(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Mre(){}function Lre(){}function Bre(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,m,v,g,y,E,b,k,P,w=[];o.biff=12,o["!row"]=0;var x=0,S=!1,_=[],A={},C=o.supbooks||s.supbooks||[[]];if(C.sharedf=A,C.arrayf=_,C.SheetNames=s.SheetNames||s.Sheets.map(function(M){return M.name}),!o.supbooks&&(o.supbooks=C,s.Names))for(var T=0;T<s.Names.length;++T)C[0][T+1]=s.Names[T];var D=[],V=[],B=!1;Th[16]={n:"BrtShortReal",f:Ek};var R;if(Ci(t,function(O,K,j){if(!h)switch(j){case 148:c=O;break;case 0:p=O,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),k=kn(g=p.r),o["!row"]=p.r,(O.hidden||O.hpt||O.level!=null)&&(O.hpt&&(O.hpx=Pd(O.hpt)),V[O.r]=O);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:O[2]},O[2]){case"n":m.v=O[1];break;case"s":b=Qu[O[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!O[1];break;case"e":m.v=O[1],o.cellText!==!1&&(m.w=yl[m.v]);break;case"str":m.t="s",m.v=O[1];break;case"is":m.t="s",m.v=O[1].t;break}if((v=a.CellXf[O[0].iStyleRef])&&xk(m,v.numFmtId,null,o,i,a),y=O[0].c==-1?y+1:O[0].c,o.dense?(l[g]||(l[g]=[]),l[g][y]=m):l[cn(y)+k]=m,o.cellFormula){for(S=!1,x=0;x<_.length;++x){var H=_[x];p.r>=H[0].s.r&&p.r<=H[0].e.r&&y>=H[0].s.c&&y<=H[0].e.c&&(m.F=rr(H[0]),S=!0)}!S&&O.length>3&&(m.f=O[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>y&&(u.s.c=y),u.e.r<p.r&&(u.e.r=p.r),u.e.c<y&&(u.e.c=y),o.cellDates&&v&&m.t=="n"&&Hc(Lt[v.numFmtId])){var W=Lo(m.v);W&&(m.t="d",m.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}R&&(R.type=="XLDAPR"&&(m.D=!0),R=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},y=O[0].c==-1?y+1:O[0].c,o.dense?(l[g]||(l[g]=[]),l[g][y]=m):l[cn(y)+k]=m,u.s.r>p.r&&(u.s.r=p.r),u.s.c>y&&(u.s.c=y),u.e.r<p.r&&(u.e.r=p.r),u.e.c<y&&(u.e.c=y),R&&(R.type=="XLDAPR"&&(m.D=!0),R=void 0);break;case 176:w.push(O);break;case 49:R=((o.xlmeta||{}).Cell||[])[O-1];break;case 494:var X=n["!id"][O.relId];for(X?(O.Target=X.Target,O.loc&&(O.Target+="#"+O.loc),O.Rel=X):O.relId==""&&(O.Target="#"+O.loc),g=O.rfx.s.r;g<=O.rfx.e.r;++g)for(y=O.rfx.s.c;y<=O.rfx.e.c;++y)o.dense?(l[g]||(l[g]=[]),l[g][y]||(l[g][y]={t:"z",v:void 0}),l[g][y].l=O):(E=Ft({c:y,r:g}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=O);break;case 426:if(!o.cellFormula)break;_.push(O),P=o.dense?l[g][y]:l[cn(y)+k],P.f=Un(O[1],u,{r:p.r,c:y},C,o),P.F=rr(O[0]);break;case 427:if(!o.cellFormula)break;A[Ft(O[0].s)]=O[1],P=o.dense?l[g][y]:l[cn(y)+k],P.f=Un(O[1],u,{r:p.r,c:y},C,o);break;case 60:if(!o.cellStyles)break;for(;O.e>=O.s;)D[O.e--]={width:O.w/256,hidden:!!(O.flags&1),level:O.level},B||(B=!0,ny(O.w/256)),kc(D[O.e+1]);break;case 161:l["!autofilter"]={ref:rr(O)};break;case 476:l["!margins"]=O;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),O.name&&(s.Sheets[r].CodeName=O.name),(O.above||O.left)&&(l["!outline"]={above:O.above,left:O.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),O.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!K.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+j.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=rr(c||u)),o.sheetRows&&l["!ref"]){var F=Vr(l["!ref"]);o.sheetRows<=+F.e.r&&(F.e.r=o.sheetRows-1,F.e.r>u.e.r&&(F.e.r=u.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>u.e.c&&(F.e.c=u.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),l["!fullref"]=l["!ref"],l["!ref"]=rr(F))}return w.length>0&&(l["!merges"]=w),D.length>0&&(l["!cols"]=D),V.length>0&&(l["!rows"]=V),l}function Ure(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=sr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function $re(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Ure(f);u.s.r=u.s.c=0,u.e.c=o,c=cn(o),h[0].forEach(function(p,m){a[c+kn(m)]={t:"n",v:p,z:h[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=rr(u)),a}function Vre(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(yk);return o&&ay(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Hre(t,e){t.l+=10;var r=Xn(t);return{name:r}}function jre(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Ci(t,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var _k=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Gre=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Wre=[],zre=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function s2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Ir(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function a2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ir(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function bk(t){a2(t.WBProps,_k),a2(t.CalcPr,zre),s2(t.WBView,Gre),s2(t.Sheets,Wre),dc.date1904=Ir(t.WBProps.date1904)}var Kre="][*?/\\".split("");function qre(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Kre.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Xre=/<\w+:workbook/;function Yre(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(Jn,function(l,c){var u=wt(l);switch(Va(u[0])){case"<?xml":break;case"<workbook":l.match(Xre)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":_k.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ir(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Er(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=sr(Er(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Er(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Ir(u.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=sr(Er(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),pY.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return bk(r),r}function Qre(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Pv(t),r.name=Xn(t),r}function Jre(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Xn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Zre(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function ene(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=RY(t),a=Lte(t,0,r),o=Jx(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function tne(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Th[16]={n:"BrtFRTArchID$",f:Zre},Ci(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Un(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),bk(r),r.Names=i,r.supbooks=a,r}function rne(t,e,r){return e.slice(-4)===".bin"?tne(t,r):Yre(t,r)}function nne(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Bre(t,n,r,s,i,a,o):Qte(t,n,r,s,i,a,o)}function sne(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?jre(t,n,r,s,i):Vre(t,n,r,s,i)}function ane(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?hee():pee()}function ine(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?dee():fee()}function one(t,e,r,n){return e.slice(-4)===".bin"?IZ(t,r,n):bZ(t,r,n)}function lne(t,e,r){return lk(t,r)}function cne(t,e,r){return e.slice(-4)===".bin"?GJ(t,r):HJ(t,r)}function une(t,e,r){return e.slice(-4)===".bin"?lee(t,r):nee(t,r)}function dne(t,e,r){return e.slice(-4)===".bin"?eee(t):JZ(t)}function fne(t,e,r,n){return r.slice(-4)===".bin"?tee(t,e,r,n):void 0}function hne(t,e,r){return e.slice(-4)===".bin"?YZ(t,e,r):QZ(t,e,r)}var Sk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ak=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(Sk),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(Ak),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function pne(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Sk),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(Ak),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var Zu;function mne(t,e){var r=Zu[t]||sr(t);return r==="General"?nl(e):js(r,e)}function gne(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ir(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=gn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[sr(e)]=s}function vne(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||yl[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=wd(t.v):t.w=nl(t.v):t.w=mne(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=Zu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Hc(n)){var s=Lo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function xne(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=gZ[n.Pattern]||n.Pattern)}t[e.ID]=e}function yne(t,e,r,n,s,i,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var p=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&p.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ir(t);break;case"String":n.t="s",n.r=CS(sr(t)),n.v=t.indexOf("<")>-1?sr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(gn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=sr(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=$I[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=CS(e||t));break}if(vne(n,u,c),c.cellFormula!==!1)if(n.Formula){var v=sr(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=uc(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=uc("RC:RC",s):n.ArrayRange&&(n.F=uc(n.ArrayRange,s),l.push([Vr(n.F),n.F]))}else for(m=0;m<l.length;++m)s.r>=l[m][0].s.r&&s.r<=l[m][0].e.r&&s.c>=l[m][0].s.c&&s.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(p.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Ene(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function fg(t,e){var r=e||{};fI();var n=Eu(Kx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Er(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=In(r);return a.type="string",kd.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ce){s.indexOf("<"+ce)>=0&&(i=!0)}),i)return kne(n,r);Zu={"General Number":"General","General Date":Lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Lt[15],"Short Date":Lt[14],"Long Time":Lt[19],"Medium Time":Lt[18],"Short Time":Lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Lt[2],Standard:Lt[4],Percent:Lt[10],Scientific:Lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},p="",m={},v={},g=Qs('<Data ss:Type="String">'),y=0,E=0,b=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},w={},x="",S=0,_=[],A={},C={},T=0,D=[],V=[],B={},R=[],F,M=!1,O=[],K=[],j={},H=0,W=0,X={Sheets:[],WBProps:{date1904:!1}},re={};Id.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";o=Id.exec(n);)switch(o[3]=(he=o[3]).toLowerCase()){case"data":if(he=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?yne(n.slice(y,o.index),x,g,l[l.length-1][0]=="comment"?B:m,{c:E,r:b},P,R[E],v,O,r):(x="",g=Qs(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(V.length>0&&(m.c=V),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(h[b]||(h[b]=[]),h[b][E]=m):h[cn(E)+kn(b)]=m),m.HRef&&(m.l={Target:sr(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(H=E+(parseInt(m.MergeAcross,10)|0),W=b+(parseInt(m.MergeDown,10)|0),_.push({s:{c:E,r:b},e:{c:H,r:W}})),!r.sheetStubs)m.MergeAcross?E=H+1:++E;else if(m.MergeAcross||m.MergeDown){for(var ue=E;ue<=H;++ue)for(var pe=b;pe<=W;++pe)(ue>E||pe>b)&&(r.dense?(h[pe]||(h[pe]=[]),h[pe][ue]={t:"z"}):h[cn(ue)+kn(pe)]={t:"z"});E=H+1}else++E;else m=pne(o[0]),m.Index&&(E=+m.Index-1),E<k.s.c&&(k.s.c=E),E>k.e.c&&(k.e.c=E),o[0].slice(-2)==="/>"&&++E,V=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<k.s.r&&(k.s.r=b),b>k.e.r&&(k.e.r=b),o[0].slice(-2)==="/>"&&(v=Qs(o[0]),v.Index&&(b=+v.Index-1)),E=0,++b):(v=Qs(o[0]),v.Index&&(b=+v.Index-1),j={},(v.AutoFitHeight=="0"||v.Height)&&(j.hpx=parseInt(v.Height,10),j.hpt=ok(j.hpx),K[b]=j),v.Hidden=="1"&&(j.hidden=!0,K[b]=j));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(p),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(h["!ref"]=rr(k),r.sheetRows&&r.sheetRows<=k.e.r&&(h["!fullref"]=h["!ref"],k.e.r=r.sheetRows-1,h["!ref"]=rr(k))),_.length&&(h["!merges"]=_),R.length>0&&(h["!cols"]=R),K.length>0&&(h["!rows"]=K),u[p]=h}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=E=0,l.push([o[3],!1]),c=Qs(o[0]),p=sr(c.Name),h=r.dense?[]:{},_=[],O=[],K=[],re={name:p,Hidden:0},X.Sheets.push(re);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),R=[],M=!1}break;case"style":o[1]==="/"?xne(P,w,r):w=Qs(o[0]);break;case"numberformat":w.nf=sr(Qs(o[0]).Format||"General"),Zu[w.nf]&&(w.nf=Zu[w.nf]);for(var q=0;q!=392&&Lt[q]!=w.nf;++q);if(q==392){for(q=57;q!=392;++q)if(Lt[q]==null){Go(w.nf,q);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(F=Qs(o[0]),F.Hidden&&(F.hidden=!0,delete F.Hidden),F.Width&&(F.wpx=parseInt(F.Width,10)),!M&&F.wpx>10){M=!0,os=ak;for(var G=0;G<R.length;++G)R[G]&&kc(R[G])}M&&kc(F),R[F.Index-1||R.length]=F;for(var oe=0;oe<+F.Span;++oe)R[R.length]=In(F);break;case"namedrange":if(o[1]==="/")break;X.Names||(X.Names=[]);var Q=wt(o[0]),Y={Name:Q.Name,Ref:uc(Q.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(Y.Sheet=X.Sheets.length-1),X.Names.push(Y);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;w.Interior=Qs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?nQ(A,he,n.slice(T,o.index)):T=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));Ene(B),V.push(B)}else l.push([o[3],!1]),c=Qs(o[0]),B={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Z=Qs(o[0]);h["!autofilter"]={ref:uc(Z.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return d2(n,r);var ne=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ne=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ne=!1}break;case"excelworkbook":switch(o[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ne=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ne=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(T,o.index)){case"SheetHidden":re.Hidden=1;break;case"SheetVeryHidden":re.Hidden=2;break}else T=o.index+o[0].length;break;case"header":h["!margins"]||Ju(h["!margins"]={},"xlml"),isNaN(+wt(o[0]).Margin)||(h["!margins"].header=+wt(o[0]).Margin);break;case"footer":h["!margins"]||Ju(h["!margins"]={},"xlml"),isNaN(+wt(o[0]).Margin)||(h["!margins"].footer=+wt(o[0]).Margin);break;case"pagemargins":var ge=wt(o[0]);h["!margins"]||Ju(h["!margins"]={},"xlml"),isNaN(+ge.Top)||(h["!margins"].top=+ge.Top),isNaN(+ge.Left)||(h["!margins"].left=+ge.Left),isNaN(+ge.Right)||(h["!margins"].right=+ge.Right),isNaN(+ge.Bottom)||(h["!margins"].bottom=+ge.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ne=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ne=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ne=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ne=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ne=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ne=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ne=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ne=!1}break;case"smarttags":break;default:ne=!1;break}if(ne||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?gne(C,he,D,n.slice(T,o.index)):(D=o,T=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ae={};return!r.bookSheets&&!r.bookProps&&(ae.Sheets=u),ae.SheetNames=f,ae.Workbook=X,ae.SSF=In(Lt),ae.Props=A,ae.Custprops=C,ae}function Ov(t,e){switch(ly(e=e||{}),e.type||"base64"){case"base64":return fg(Ps(t),e);case"binary":case"buffer":case"file":return fg(t,e);case"array":return fg(gl(t),e)}}function _ne(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=OY(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=MY(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var bne=[60,1084,2066,2165,2175];function Sne(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=li(r,r.l),c=Mv[l],u=0;c!=null&&bne.indexOf(l)>-1;)i=li(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),a.push(o),r.l+=4+i,c=Mv[l=li(r,r.l)];var f=Ki(a);Sn(f,0);var h=0;f.lens=[];for(var p=0;p<a.length;++p)f.lens.push(h),h+=a[p].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,s)}function ba(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Lt[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||yl[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=wd(t.v):t.w=nl(t.v):t.w=js(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Hc(Lt[n]||String(n))){var s=Lo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Zf(t,e,r){return{v:t,ixfe:e,t:r}}function Ane(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",u={},f,h="",p,m,v,g,y={},E=[],b,k,P=[],w=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},_=function(ye){return ye<8?Wo[ye]:ye<64&&w[ye-8]||Wo[ye]},A=function(ye,be,Oe){var je=be.XF.data;if(!(!je||!je.patternType||!Oe||!Oe.cellStyles)){be.s={},be.s.patternType=je.patternType;var lt;(lt=Dd(_(je.icvFore)))&&(be.s.fgColor={rgb:lt}),(lt=Dd(_(je.icvBack)))&&(be.s.bgColor={rgb:lt})}},C=function(ye,be,Oe){if(!(j>1)&&!(Oe.sheetRows&&ye.r>=Oe.sheetRows)){if(Oe.cellStyles&&be.XF&&be.XF.data&&A(ye,be,Oe),delete be.ixfe,delete be.XF,f=ye,h=Ft(ye),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ye.r<a.s.r&&(a.s.r=ye.r),ye.c<a.s.c&&(a.s.c=ye.c),ye.r+1>a.e.r&&(a.e.r=ye.r+1),ye.c+1>a.e.c&&(a.e.c=ye.c+1),Oe.cellFormula&&be.f){for(var je=0;je<E.length;++je)if(!(E[je][0].s.c>ye.c||E[je][0].s.r>ye.r)&&!(E[je][0].e.c<ye.c||E[je][0].e.r<ye.r)){be.F=rr(E[je][0]),(E[je][0].s.c!=ye.c||E[je][0].s.r!=ye.r)&&delete be.f,be.f&&(be.f=""+Un(E[je][1],a,ye,O,T));break}}Oe.dense?(s[ye.r]||(s[ye.r]=[]),s[ye.r][ye.c]=be):s[h]=be}},T={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var D,V=[],B=[],R=[],F=[],M=!1,O=[];O.SheetNames=T.snames,O.sharedf=T.sharedf,O.arrayf=T.arrayf,O.names=[],O.XTI=[];var K=0,j=0,H=0,W=[],X=[],re;T.codepage=1200,ia(1200);for(var he=!1;t.l<t.length-1;){var ue=t.l,pe=t.read_shift(2);if(pe===0&&K===10)break;var q=t.l===t.length?0:t.read_shift(2),G=Mv[pe];if(G&&G.f){if(e.bookSheets&&K===133&&pe!==133)break;if(K=pe,G.r===2||G.r==12){var oe=t.read_shift(2);if(q-=2,!T.enc&&oe!==pe&&((oe&255)<<8|oe>>8)!==pe)throw new Error("rt mismatch: "+oe+"!="+pe);G.r==12&&(t.l+=10,q-=10)}var Q={};if(pe===10?Q=G.f(t,q,T):Q=Sne(pe,G,t,q,T),j==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(pe){case 34:r.opts.Date1904=x.WBProps.date1904=Q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=Q,!e.password)throw new Error("File is password-protected");if(Q.valid==null)throw new Error("Encryption scheme unsupported");if(!Q.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=Q;break;case 66:var Y=Number(Q);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252;break}ia(T.codepage=Y),he=!0;break;case 317:T.rrtabid=Q;break;case 25:T.winlocked=Q;break;case 439:r.opts.RefreshAll=Q;break;case 12:r.opts.CalcCount=Q;break;case 16:r.opts.CalcDelta=Q;break;case 17:r.opts.CalcIter=Q;break;case 13:r.opts.CalcMode=Q;break;case 14:r.opts.CalcPrecision=Q;break;case 95:r.opts.CalcSaveRecalc=Q;break;case 15:T.CalcRefMode=Q;break;case 2211:r.opts.FullCalc=Q;break;case 129:Q.fDialog&&(s["!type"]="dialog"),Q.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Q.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:P.push(Q);break;case 430:O.push([Q]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push(Q);break;case 24:case 536:re={Name:Q.Name,Ref:Un(Q.rgce,a,null,O,T)},Q.itab>0&&(re.Sheet=Q.itab-1),O.names.push(re),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push(Q),Q.Name=="_xlnm._FilterDatabase"&&Q.itab>0&&Q.rgce&&Q.rgce[0]&&Q.rgce[0][0]&&Q.rgce[0][0][0]=="PtgArea3d"&&(X[Q.itab-1]={ref:rr(Q.rgce[0][0][1][2])});break;case 22:T.ExternCount=Q;break;case 23:O.length==0&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat(Q),O.XTI=O.XTI.concat(Q);break;case 2196:if(T.biff<8)break;re!=null&&(re.Comment=Q[1]);break;case 18:s["!protect"]=Q;break;case 19:Q!==0&&T.WTF&&console.error("Password verifier: "+Q);break;case 133:i[Q.pos]=Q,T.snames.push(Q.name);break;case 10:{if(--j)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=rr(a),e.sheetRows&&e.sheetRows<=a.e.r){var Z=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=rr(a),a.e.r=Z}a.e.r++,a.e.c++}V.length>0&&(s["!merges"]=V),B.length>0&&(s["!objects"]=B),R.length>0&&(s["!cols"]=R),F.length>0&&(s["!rows"]=F),x.Sheets.push(S)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Q.BIFFVer]||8),T.biffguess=Q.BIFFVer==0,Q.BIFFVer==0&&Q.dt==4096&&(T.biff=5,he=!0,ia(T.codepage=28591)),T.biff==8&&Q.BIFFVer==0&&Q.dt==16&&(T.biff=2),j++)break;if(s=e.dense?[]:{},T.biff<8&&!he&&(he=!0,ia(T.codepage=e.codepage||1252)),T.biff<5||Q.BIFFVer==0&&Q.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var ne={pos:t.l-q,name:c};i[ne.pos]=ne,T.snames.push(c)}else c=(i[ue]||{name:""}).name;Q.dt==32&&(s["!type"]="chart"),Q.dt==64&&(s["!type"]="macro"),V=[],B=[],T.arrayf=E=[],R=[],F=[],M=!1,S={Hidden:(i[ue]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[Q.r]||[])[Q.c]:s[Ft({c:Q.c,r:Q.r})])&&++Q.c,b={ixfe:Q.ixfe,XF:P[Q.ixfe]||{},v:Q.val,t:"n"},H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:Q.c,r:Q.r},b,e);break;case 5:case 517:b={ixfe:Q.ixfe,XF:P[Q.ixfe],v:Q.val,t:Q.t},H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:Q.c,r:Q.r},b,e);break;case 638:b={ixfe:Q.ixfe,XF:P[Q.ixfe],v:Q.rknum,t:"n"},H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:Q.c,r:Q.r},b,e);break;case 189:for(var ge=Q.c;ge<=Q.C;++ge){var ae=Q.rkrec[ge-Q.c][0];b={ixfe:ae,XF:P[ae],v:Q.rkrec[ge-Q.c][1],t:"n"},H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:ge,r:Q.r},b,e)}break;case 6:case 518:case 1030:{if(Q.val=="String"){o=Q;break}if(b=Zf(Q.val,Q.cell.ixfe,Q.tt),b.XF=P[b.ixfe],e.cellFormula){var ce=Q.formula;if(ce&&ce[0]&&ce[0][0]&&ce[0][0][0]=="PtgExp"){var fe=ce[0][0][1][0],Ae=ce[0][0][1][1],Ie=Ft({r:fe,c:Ae});y[Ie]?b.f=""+Un(Q.formula,a,Q.cell,O,T):b.F=((e.dense?(s[fe]||[])[Ae]:s[Ie])||{}).F}else b.f=""+Un(Q.formula,a,Q.cell,O,T)}H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C(Q.cell,b,e),o=Q}break;case 7:case 519:if(o)o.val=Q,b=Zf(Q,o.cell.ixfe,"s"),b.XF=P[b.ixfe],e.cellFormula&&(b.f=""+Un(o.formula,a,o.cell,O,T)),H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C(o.cell,b,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(Q);var Te=Ft(Q[0].s);if(p=e.dense?(s[Q[0].s.r]||[])[Q[0].s.c]:s[Te],e.cellFormula&&p){if(!o||!Te||!p)break;p.f=""+Un(Q[1],a,Q[0],O,T),p.F=rr(Q[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!o)break;y[Ft(o.cell)]=Q[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ft(o.cell)],(p||{}).f=""+Un(Q[0],a,f,O,T)}}break;case 253:b=Zf(l[Q.isst].t,Q.ixfe,"s"),l[Q.isst].h&&(b.h=l[Q.isst].h),b.XF=P[b.ixfe],H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:Q.c,r:Q.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:Q.ixfe,XF:P[Q.ixfe],t:"z"},H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:Q.c,r:Q.r},b,e));break;case 190:if(e.sheetStubs)for(var Ge=Q.c;Ge<=Q.C;++Ge){var ke=Q.ixfe[Ge-Q.c];b={ixfe:ke,XF:P[ke],t:"z"},H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:Ge,r:Q.r},b,e)}break;case 214:case 516:case 4:b=Zf(Q.val,Q.ixfe,"s"),b.XF=P[b.ixfe],H>0&&(b.z=W[b.ixfe>>8&63]),ba(b,e,r.opts.Date1904),C({c:Q.c,r:Q.r},b,e);break;case 0:case 512:j===1&&(a=Q);break;case 252:l=Q;break;case 1054:if(T.biff==4){W[H++]=Q[1];for(var $e=0;$e<H+163&&Lt[$e]!=Q[1];++$e);$e>=163&&Go(Q[1],H+163)}else Go(Q[1],Q[0]);break;case 30:{W[H++]=Q;for(var Be=0;Be<H+163&&Lt[Be]!=Q;++Be);Be>=163&&Go(Q,H+163)}break;case 229:V=V.concat(Q);break;case 93:B[Q.cmo[0]]=T.lastobj=Q;break;case 438:T.lastobj.TxO=Q;break;case 127:T.lastobj.ImData=Q;break;case 440:for(g=Q[0].s.r;g<=Q[0].e.r;++g)for(v=Q[0].s.c;v<=Q[0].e.c;++v)p=e.dense?(s[g]||[])[v]:s[Ft({c:v,r:g})],p&&(p.l=Q[1]);break;case 2048:for(g=Q[0].s.r;g<=Q[0].e.r;++g)for(v=Q[0].s.c;v<=Q[0].e.c;++v)p=e.dense?(s[g]||[])[v]:s[Ft({c:v,r:g})],p&&p.l&&(p.l.Tooltip=Q[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;p=e.dense?(s[Q[0].r]||[])[Q[0].c]:s[Ft(Q[0])];var We=B[Q[2]];p||(e.dense?(s[Q[0].r]||(s[Q[0].r]=[]),p=s[Q[0].r][Q[0].c]={t:"z"}):p=s[Ft(Q[0])]={t:"z"},a.e.r=Math.max(a.e.r,Q[0].r),a.s.r=Math.min(a.s.r,Q[0].r),a.e.c=Math.max(a.e.c,Q[0].c),a.s.c=Math.min(a.s.c,Q[0].c)),p.c||(p.c=[]),m={a:Q[1],t:We.TxO.t},p.c.push(m)}break;case 2173:zZ(P[Q.ixfe],Q.ext);break;case 125:{if(!T.cellStyles)break;for(;Q.e>=Q.s;)R[Q.e--]={width:Q.w/256,level:Q.level||0,hidden:!!(Q.flags&1)},M||(M=!0,ny(Q.w/256)),kc(R[Q.e+1])}break;case 520:{var Ke={};Q.level!=null&&(F[Q.r]=Ke,Ke.level=Q.level),Q.hidden&&(F[Q.r]=Ke,Ke.hidden=!0),Q.hpt&&(F[Q.r]=Ke,Ke.hpt=Q.hpt,Ke.hpx=Pd(Q.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ju(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=Q;break;case 161:s["!margins"]||Ju(s["!margins"]={}),s["!margins"].header=Q.header,s["!margins"].footer=Q.footer;break;case 574:Q.RTL&&(x.Views[0].RTL=!0);break;case 146:w=Q;break;case 2198:D=Q;break;case 140:k=Q;break;case 442:c?S.CodeName=Q||S.name:x.WBProps.CodeName=Q||"ThisWorkbook";break}}else G||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),t.l+=q}return r.SheetNames=Ma(i).sort(function(Ee,ye){return Number(Ee)-Number(ye)}).map(function(Ee){return i[Ee].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&X.forEach(function(Ee,ye){r.Sheets[r.SheetNames[ye]]["!autofilter"]=Ee}),r.Strings=l,r.SSF=In(Lt),T.enc&&(r.Encryption=T.enc),D&&(r.Themes=D),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),O.names.length>0&&(x.Names=O.names),r.Workbook=x,r}var i2={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Tne(t,e,r){var n=tr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=jS(n,HY,i2.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=tr.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=jS(a,jY,i2.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(HI(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Tk(t,e){e||(e={}),ly(e),eI(),e.codepage&&$x(e.codepage);var r,n;if(t.FullPaths){if(tr.find(t,"/encryption"))throw new Error("File is password-protected");r=tr.find(t,"!CompObj"),n=tr.find(t,"/Workbook")||tr.find(t,"/Book")}else{switch(e.type){case"base64":t=sa(Ps(t));break;case"binary":t=sa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sn(t,0),n={content:t}}var s,i;if(r&&_ne(r),e.bookProps&&!e.bookSheets)s={};else{var a=Qt?"buffer":"array";if(n&&n.content)s=Ane(n.content,e);else if((i=tr.find(t,"PerfectOffice_MAIN"))&&i.content)s=Yu.to_workbook(i.content,(e.type=a,e));else if((i=tr.find(t,"NativeContent_MAIN"))&&i.content)s=Yu.to_workbook(i.content,(e.type=a,e));else throw(i=tr.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&tr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=uee(t))}var o={};return t.FullPaths&&Tne(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var Th={0:{f:ire},1:{f:ure},2:{f:yre},3:{f:pre},4:{f:fre},5:{f:xre},6:{f:bre},7:{f:gre},8:{f:Cre},9:{f:wre},10:{f:Are},11:{f:Tre},12:{f:dre},13:{f:Ere},14:{f:mre},15:{f:hre},16:{f:Ek},17:{f:Sre},18:{f:vre},19:{f:Qx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ene},40:{},42:{},43:{f:AZ},44:{f:SZ},45:{f:TZ},46:{f:CZ},47:{f:wZ},48:{},49:{f:IY},50:{},51:{f:qZ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ek},62:{f:_re},63:{f:ZZ},64:{f:Mre},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ore},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:cre},148:{f:ore,p:16},151:{f:Dre},152:{},153:{f:Jre},154:{},155:{},156:{f:Qre},157:{},158:{},159:{T:1,f:jJ},160:{T:-1},161:{T:1,f:xl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ire},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:KZ},336:{T:-1},337:{f:XZ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ZI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Pre},427:{f:Rre},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Nre},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:lre},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kre},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:oee},633:{T:1},634:{T:-1},635:{T:1,f:iee},636:{T:-1},637:{f:DY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Hre},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Lre},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mv={6:{f:ug},10:{f:Li},12:{f:Zr},13:{f:Zr},14:{f:jr},15:{f:jr},16:{f:Hn},17:{f:jr},18:{f:jr},19:{f:Zr},20:{f:KS},21:{f:KS},23:{f:ZI},24:{f:XS},25:{f:jr},26:{},27:{},28:{f:sJ},29:{},34:{f:jr},35:{f:qS},38:{f:Hn},39:{f:Hn},40:{f:Hn},41:{f:Hn},42:{f:jr},43:{f:jr},47:{f:lZ},49:{f:UQ},51:{f:Zr},60:{},61:{f:MQ},64:{f:jr},65:{f:BQ},66:{f:Zr},77:{},80:{},81:{},82:{},85:{f:Zr},89:{},90:{},91:{},92:{f:IQ},93:{f:iJ},94:{},95:{f:jr},96:{},97:{},99:{f:jr},125:{f:ek},128:{f:XQ},129:{f:kQ},130:{f:Zr},131:{f:jr},132:{f:jr},133:{f:DQ},134:{},140:{f:fJ},141:{f:Zr},144:{},146:{f:pJ},151:{},152:{},153:{},154:{},155:{},156:{f:Zr},157:{},158:{},160:{f:yJ},161:{f:gJ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:WQ},190:{f:zQ},193:{f:Li},197:{},198:{},199:{},200:{},201:{},202:{f:jr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zr},220:{},221:{f:jr},222:{},224:{f:qQ},225:{f:CQ},226:{f:Li},227:{},229:{f:aJ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:PQ},253:{f:$Q},255:{f:RQ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:KI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jr},353:{f:Li},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:QQ},431:{f:jr},432:{},433:{},434:{},437:{},438:{f:cJ},439:{f:jr},440:{f:uJ},441:{},442:{f:of},443:{},444:{f:Zr},445:{},446:{},448:{f:Li},449:{f:OQ,r:2},450:{f:Li},512:{f:WS},513:{f:xJ},515:{f:YQ},516:{f:VQ},517:{f:zS},519:{f:EJ},520:{f:FQ},523:{},545:{f:YS},549:{f:GS},566:{},574:{f:LQ},638:{f:GQ},659:{},1048:{},1054:{f:HQ},1084:{},1212:{f:tJ},2048:{f:dJ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Yf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Li},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mJ,r:12},2173:{f:WZ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:eJ,r:12},2197:{},2198:{f:UZ,r:12},2199:{},2200:{},2201:{},2202:{f:rJ,r:12},2203:{f:Li},2204:{},2205:{},2206:{},2207:{},2211:{f:NQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vJ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:hJ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:WS},1:{},2:{f:AJ},3:{f:SJ},4:{f:bJ},5:{f:zS},7:{f:TJ},8:{},9:{f:Yf},11:{},22:{f:Zr},30:{f:jQ},31:{},32:{},33:{f:YS},36:{},37:{f:GS},50:{f:wJ},62:{},52:{},67:{},68:{f:Zr},69:{},86:{},126:{},127:{f:_J},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:CJ},223:{},234:{},354:{},421:{},518:{f:ug},521:{f:Yf},536:{f:XS},547:{f:qS},561:{},579:{},1030:{f:ug},1033:{f:Yf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Js(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&NI(r)&&t.push(r)}}function o2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=YX(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(a=0;a<l.length;++a){var v=l[a].trim(),g=v.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var y=v.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var E=y[o].trim();if(E.match(/<t[dh]/i)){for(var b=E,k=0;b.charAt(0)=="<"&&(k=b.indexOf(">"))>-1;)b=b.slice(k+1);for(var P=0;P<m.length;++P){var w=m[P];w.s.c==u&&w.s.r<c&&c<=w.e.r&&(u=w.e.c+1,P=-1)}var x=wt(E.slice(0,E.indexOf(">")));h=x.colspan?+x.colspan:1,((f=+x.rowspan)>1||h>1)&&m.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var S=x.t||x["data-t"]||"";if(!b.length){u+=h;continue}if(b=_I(b),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!b.length){u+=h;continue}var _={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?_={t:"b",v:!0}:b==="FALSE"?_={t:"b",v:!1}:isNaN(ua(b))?isNaN(Ic(b).getDate())||(_={t:"d",v:gn(b)},r.cellDates||(_={t:"n",v:ds(_.v)}),_.z=r.dateNF||Lt[14]):_={t:"n",v:ua(b)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=_):n[Ft({r:c,c:u})]=_,u+=h}}}}return n["!ref"]=rr(p),m.length&&(n["!merges"]=m),n}function wne(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Ft({r,c:a}),f=n.dense?(t[r]||[])[a]:t[u],h=f&&f.v!=null&&(f.h||zx(f.w||(Ai(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,i.push(fY("td",h,p))}}var m="<tr>";return m+i.join("")+"</tr>"}var Cne='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Ine="</body></html>";function kne(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Eo(o2(r[0],e),e);var n=uy();return r.forEach(function(s,i){dy(n,o2(s,e),"Sheet"+(i+1))}),n}function Dne(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Pne(t,e){var r=e||{},n=r.header!=null?r.header:Cne,s=r.footer!=null?r.footer:Ine,i=[n],a=jc(t["!ref"]);r.dense=Array.isArray(t),i.push(Dne(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(wne(t,a,o,r));return i.push("</table>"+s),i.join("")}function wk(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?ls(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var u=jc(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var f=[],h=0,p=t["!rows"]||(t["!rows"]=[]),m=0,v=0,g=0,y=0,E=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<o.length&&v<l;++m){var k=o[m];if(l2(k)){if(n.display)continue;p[v]={hidden:!0}}var P=k.children;for(g=y=0;g<P.length;++g){var w=P[g];if(!(n.display&&l2(w))){var x=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):_I(w.innerHTML),S=w.getAttribute("data-z")||w.getAttribute("z");for(h=0;h<f.length;++h){var _=f[h];_.s.c==y+i&&_.s.r<v+s&&v+s<=_.e.r&&(y=_.e.c+1-i,h=-1)}b=+w.getAttribute("colspan")||1,((E=+w.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:v+s,c:y+i},e:{r:v+s+(E||1)-1,c:y+i+(b||1)-1}});var A={t:"s",v:x},C=w.getAttribute("data-t")||w.getAttribute("t")||"";x!=null&&(x.length==0?A.t=C||"z":n.raw||x.trim().length==0||C=="s"||(x==="TRUE"?A={t:"b",v:!0}:x==="FALSE"?A={t:"b",v:!1}:isNaN(ua(x))?isNaN(Ic(x).getDate())||(A={t:"d",v:gn(x)},n.cellDates||(A={t:"n",v:ds(A.v)}),A.z=n.dateNF||Lt[14]):A={t:"n",v:ua(x)})),A.z===void 0&&S!=null&&(A.z=S);var T="",D=w.getElementsByTagName("A");if(D&&D.length)for(var V=0;V<D.length&&!(D[V].hasAttribute("href")&&(T=D[V].getAttribute("href"),T.charAt(0)!="#"));++V);T&&T.charAt(0)!="#"&&(A.l={Target:T}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][y+i]=A):t[Ft({c:y+i,r:v+s})]=A,c.e.c<y+i&&(c.e.c=y+i),y+=b}}++v}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,v-1+s),t["!ref"]=rr(c),v>=l&&(t["!fullref"]=rr((c.e.r=o.length-m+v-1+s,c))),t}function Ck(t,e){var r=e||{},n=r.dense?[]:{};return wk(n,t,e)}function Rne(t,e){return Eo(Ck(t,e),e)}function l2(t){var e="",r=Fne(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Fne(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Nne(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=sr(e.replace(/<[^>]*>/g,""));return[r]}var c2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ik(t,e){var r=e||{},n=Kx(t),s=[],i,a,o={name:""},l="",c=0,u,f,h={},p=[],m=r.dense?[]:{},v,g,y={value:""},E="",b=0,k=[],P=-1,w=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,_={},A=[],C={},T=0,D=0,V=[],B=1,R=1,F=[],M={Names:[]},O={},K=["",""],j=[],H={},W="",X=0,re=!1,he=!1,ue=0;for(Id.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Id.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"工作表":v[1]==="/"?(x.e.c>=x.s.c&&x.e.r>=x.s.r?m["!ref"]=rr(x):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=x.e.r&&(m["!fullref"]=m["!ref"],x.e.r=r.sheetRows-1,m["!ref"]=rr(x)),A.length&&(m["!merges"]=A),V.length&&(m["!rows"]=V),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),h[u.name]=m,he=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=wt(v[0],!1),P=w=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,m=r.dense?[]:{},A=[],V=[],he=!0);break;case"table-row-group":v[1]==="/"?--S:++S;break;case"table-row":case"行":if(v[1]==="/"){P+=B,B=1;break}if(f=wt(v[0],!1),f.行号?P=f.行号-1:P==-1&&(P=0),B=+f["number-rows-repeated"]||1,B<10)for(ue=0;ue<B;++ue)S>0&&(V[P+ue]={level:S});w=-1;break;case"covered-table-cell":v[1]!=="/"&&++w,r.sheetStubs&&(r.dense?(m[P]||(m[P]=[]),m[P][w]={t:"z"}):m[Ft({r:P,c:w})]={t:"z"}),E="",k=[];break;case"table-cell":case"数据":if(v[0].charAt(v[0].length-2)==="/")++w,y=wt(v[0],!1),R=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=n2(sr(y.formula))),(y.数据类型||y["value-type"])=="string"&&(g.t="s",g.v=sr(y["string-value"]||""),r.dense?(m[P]||(m[P]=[]),m[P][w]=g):m[Ft({r:P,c:w})]=g),w+=R-1;else if(v[1]!=="/"){++w,E="",b=0,k=[],R=1;var pe=B?P+B-1:P;if(w>x.e.c&&(x.e.c=w),w<x.s.c&&(x.s.c=w),P<x.s.r&&(x.s.r=P),pe>x.e.r&&(x.e.r=pe),y=wt(v[0],!1),j=[],H={},g={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=sr(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(T=parseInt(y["number-matrix-rows-spanned"],10)||0,D=parseInt(y["number-matrix-columns-spanned"],10)||0,C={s:{r:P,c:w},e:{r:P+T-1,c:w+D-1}},g.F=rr(C),F.push([C,g.F])),y.formula)g.f=n2(y.formula);else for(ue=0;ue<F.length;++ue)P>=F[ue][0].s.r&&P<=F[ue][0].e.r&&w>=F[ue][0].s.c&&w<=F[ue][0].e.c&&(g.F=F[ue][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(T=parseInt(y["number-rows-spanned"],10)||0,D=parseInt(y["number-columns-spanned"],10)||0,C={s:{r:P,c:w},e:{r:P+T-1,c:w+D-1}},A.push(C)),y["number-columns-repeated"]&&(R=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Ir(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=gn(y["date-value"]),r.cellDates||(g.t="n",g.v=ds(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=KX(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Fp(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(E=sr(y["string-value"]),k=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(re=!1,g.t==="s"&&(g.v=E||"",k.length&&(g.R=k),re=b==0),O.Target&&(g.l=O),j.length>0&&(g.c=j,j=[]),E&&r.cellText!==!1&&(g.w=E),re&&(g.t="z",delete g.v),(!re||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var q=0;q<B;++q){if(R=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(m[P+q]||(m[P+q]=[]),m[P+q][w]=q==0?g:In(g);--R>0;)m[P+q][w+R]=In(g);else for(m[Ft({r:P+q,c:w})]=g;--R>0;)m[Ft({r:P+q,c:w+R})]=In(g);x.e.c<=w&&(x.e.c=w)}R=parseInt(y["number-columns-repeated"]||"1",10),w+=R-1,R=0,g={},E="",k=[]}O={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i;H.t=E,k.length&&(H.R=k),H.a=W,j.push(H)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);W="",X=0,E="",b=0,k=[];break;case"creator":v[1]==="/"?W=n.slice(X,v.index):X=v.index+v[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);E="",b=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(_[o.name]=l,(i=s.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=wt(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=wt(v[0],!1),l+=c2[v[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=wt(v[0],!1),l+=c2[v[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,v.index);break}else c=v.index+v[0].length;break;case"named-range":a=wt(v[0],!1),K=dg(a["cell-range-address"]);var G={Name:a.name,Ref:K[0]+"!"+K[1]};he&&(G.Sheet=p.length),M.Names.push(G);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!y||!y["string-value"])){var oe=Nne(n.slice(b,v.index));E=(E.length>0?E+`
`:"")+oe[0]}else wt(v[0],!1),b=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{K=dg(wt(v[0])["target-range-address"]),h[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(O=wt(v[0],!1),!O.href)break;O.Target=sr(O.href),delete O.href,O.Target.charAt(0)=="#"&&O.Target.indexOf(".")>-1?(K=dg(O.Target.slice(1)),O.Target="#"+K[0]+"!"+K[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(v)}}var Q={Sheets:h,SheetNames:p,Workbook:M};return r.bookSheets&&delete Q.Sheets,Q}function u2(t,e){e=e||{},Ls(t,"META-INF/manifest.xml")&&YY(Jr(t,"META-INF/manifest.xml"),e);var r=ws(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ik(Er(r),e);return Ls(t,"meta.xml")&&(n.Props=VI(Jr(t,"meta.xml"))),n}function d2(t,e){return Ik(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function iy(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Lv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Er(gl(t))}function Bv(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function f2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function One(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Rd(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function un(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Kn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Rd(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Rd(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function oy(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Mne(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Rd(t,n),i=Kn(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:un(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Kn(o.data),c=un(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=un(i[3][0].data)>>>0>0),r.push(a)}return r}function Lne(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Rd(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Bv(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Bv(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Bne(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Lne(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Bv(e)}function Une(t,e,r,n){var s=iy(t),i=s.getUint32(4,!0),a=(n>1?12:8)+f2(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=f2(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:e[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function $ne(t,e,r){var n=iy(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=One(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return f}function Vne(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Une(t,e,r,t[0]);case 5:return $ne(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function so(t){var e=Kn(t);return Rd(e[1][0].data)}function h2(t,e){var r=Kn(e.data),n=un(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Kn(a.data),l=un(o[1][0].data)>>>0;switch(n){case 1:i[l]=Lv(o[3][0].data);break;case 8:{var c=t[so(o[9][0].data)][0],u=Kn(c.data),f=t[so(u[1][0].data)][0],h=un(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Kn(f.data);i[l]=p[3].map(function(m){return Lv(m.data)}).join("")}break}}),i}function Hne(t,e){var r,n,s,i,a,o,l,c,u,f,h,p,m,v,g=Kn(t),y=un(g[1][0].data)>>>0,E=un(g[2][0].data)>>>0,b=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&un(g[8][0].data)>0||!1,k,P;if((i=(s=g[7])==null?void 0:s[0])!=null&&i.data&&e!=0)k=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,P=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&e!=1)k=(p=(h=g[4])==null?void 0:h[0])==null?void 0:p.data,P=(v=(m=g[3])==null?void 0:m[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var w=b?4:1,x=iy(k),S=[],_=0;_<k.length/2;++_){var A=x.getUint16(_*2,!0);A<65535&&S.push([_,A])}if(S.length!=E)throw"Expected ".concat(E," cells, found ").concat(S.length);var C=[];for(_=0;_<S.length-1;++_)C[S[_][0]]=P.subarray(S[_][1]*w,S[_+1][1]*w);return S.length>=1&&(C[S[S.length-1][0]]=P.subarray(S[S.length-1][1]*w)),{R:y,cells:C}}function jne(t,e){var r,n=Kn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?un(n[7][0].data)>>>0>0?1:0:-1,i=oy(n[5],function(a){return Hne(a,s)});return{nrows:un(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function Gne(t,e,r){var n,s=Kn(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(un(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(un(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=rr(i);var a=Kn(s[4][0].data),o=h2(t,t[so(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?h2(t,t[so(a[17][0].data)][0]):[],c=Kn(a[3][0].data),u=0;c[1].forEach(function(f){var h=Kn(f.data),p=t[so(h[2][0].data)][0],m=un(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var v=jne(t,p);v.data.forEach(function(g,y){g.forEach(function(E,b){var k=Ft({r:u+y,c:b}),P=Vne(E,o,l);P&&(r[k]=P)})}),u+=v.nrows})}function Wne(t,e){var r=Kn(e.data),n={"!ref":"A1"},s=t[so(r[2][0].data)],i=un(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Gne(t,s[0],n),n}function zne(t,e){var r,n=Kn(e.data),s={name:(r=n[1])!=null&&r[0]?Lv(n[1][0].data):"",sheets:[]},i=oy(n[2],so);return i.forEach(function(a){t[a].forEach(function(o){var l=un(o.meta[1][0].data);l==6e3&&s.sheets.push(Wne(t,o))})}),s}function Kne(t,e){var r=uy(),n=Kn(e.data),s=oy(n[1],so);if(s.forEach(function(i){t[i].forEach(function(a){var o=un(a.meta[1][0].data);if(o==2){var l=zne(t,a);l.sheets.forEach(function(c,u){dy(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function hg(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Bne(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=Mne(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&un(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var u=un(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Kne(i,o)}function qne(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function ly(t){qne([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Xne(t){return zl.WS.indexOf(t)>-1?"sheet":t==zl.CS?"chart":t==zl.DS?"dialog":t==zl.MS?"macro":t&&t.length?t:"sheet"}function Yne(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Xne(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Qne(t,e,r,n,s,i,a,o,l,c,u,f){try{i[n]=qu(ws(t,r,!0),e);var h=Jr(t,e),p;switch(o){case"sheet":p=nne(h,e,s,l,i[n],c,u,f);break;case"chart":if(p=sne(h,e,s,l,i[n],c,u,f),!p||!p["!drawel"])break;var m=bu(p["!drawel"].Target,e),v=Rv(m),g=ree(ws(t,m,!0),qu(ws(t,v,!0),m)),y=bu(g,m),E=Rv(y);p=$re(ws(t,y,!0),y,l,qu(ws(t,E,!0),y),c,p);break;case"macro":p=ane(h,e,s,l,i[n],c,u,f);break;case"dialog":p=ine(h,e,s,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var b=[];i&&i[n]&&Ma(i[n]).forEach(function(k){var P="";if(i[n][k].Type==zl.CMNT){P=bu(i[n][k].Target,e);var w=une(Jr(t,P,!0),P,l);if(!w||!w.length)return;JS(p,w,!1)}i[n][k].Type==zl.TCMNT&&(P=bu(i[n][k].Target,e),b=b.concat(see(Jr(t,P,!0),l)))}),b&&b.length&&JS(p,b,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function Ns(t){return t.charAt(0)=="/"?t.slice(1):t}function Jne(t,e){if(fI(),e=e||{},ly(e),Ls(t,"META-INF/manifest.xml")||Ls(t,"objectdata.xml"))return u2(t,e);if(Ls(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof hg<"u"){if(t.FileIndex)return hg(t);var r=tr.utils.cfb_new();return TS(t).forEach(function(V){ZX(r,V,JX(t,V))}),hg(r)}throw new Error("Unsupported NUMBERS file")}if(!Ls(t,"[Content_Types].xml"))throw Ls(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ls(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=TS(t),s=qY(ws(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Jr(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Jr(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Qu=[],s.sst)try{Qu=cne(Jr(t,Ns(s.sst)),s.sst,e)}catch(V){if(e.WTF)throw V}e.cellStyles&&s.themes.length&&(l=lne(ws(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=one(Jr(t,Ns(s.style)),s.style,l,e))}s.links.map(function(V){try{var B=qu(ws(t,Rv(Ns(V))),V);return fne(Jr(t,Ns(V)),B,V,e)}catch{}});var u=rne(Jr(t,Ns(s.workbooks[0])),s.workbooks[0],e),f={},h="";s.coreprops.length&&(h=Jr(t,Ns(s.coreprops[0]),!0),h&&(f=VI(h)),s.extprops.length!==0&&(h=Jr(t,Ns(s.extprops[0]),!0),h&&ZY(h,f,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(h=ws(t,Ns(s.custprops[0]),!0),h&&(p=tQ(h,e)));var m={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(B){return B.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(m.Props=f,m.Custprops=p),e.bookSheets&&typeof a<"u"&&(m.SheetNames=a),e.bookSheets?m.SheetNames:e.bookProps))return m;a={};var v={};e.bookDeps&&s.calcchain&&(v=dne(Jr(t,Ns(s.calcchain)),s.calcchain));var g=0,y={},E,b;{var k=u.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var P=0;P!=k.length;++P)f.SheetNames[P]=k[P].name}var w=i?"bin":"xml",x=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,x+1)+"_rels/"+s.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");Ls(t,S)||(S="xl/_rels/workbook."+w+".rels");var _=qu(ws(t,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=hne(Jr(t,Ns(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=aee(Jr(t,Ns(s.people[0])),e)),_&&(_=Yne(_,u.Sheets));var A=Jr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var C="sheet";if(_&&_[g]?(E="xl/"+_[g][1].replace(/[\/]?xl\//,""),Ls(t,E)||(E=_[g][1]),Ls(t,E)||(E=S.replace(/_rels\/.*$/,"")+_[g][1]),C=_[g][2]):(E="xl/worksheets/sheet"+(g+1-A)+"."+w,E=E.replace(/sheet0\./,"sheet.")),b=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(g!=e.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==g&&(T=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==f.SheetNames[g].toLowerCase()&&(T=1);if(!T)continue e}}Qne(t,E,b,f.SheetNames[g],g,y,a,C,e,u,l,c)}return m={Directory:s,Workbook:u,Props:f,Custprops:p,Deps:v,Sheets:a,SheetNames:f.SheetNames,Strings:Qu,Styles:c,Themes:l,SSF:In(Lt)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(V,B){V=V.replace(/^Root Entry[\/]/,""),m.keys.push(V),m.files[V]=t.FileIndex[B]}))),e&&e.bookVBA&&(s.vba.length>0?m.vbaraw=Jr(t,Ns(s.vba[0]),!0):s.defaults&&s.defaults.bin===cee&&(m.vbaraw=Jr(t,"xl/vbaProject.bin",!0))),m}function Zne(t,e){var r=e||{},n="Workbook",s=tr.find(t,n);try{if(n="/!DataSpaces/Version",s=tr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(WJ(s.content),n="/!DataSpaces/DataSpaceMap",s=tr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=KJ(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=tr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=qJ(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=tr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);YJ(s.content)}catch{}if(n="/EncryptionInfo",s=tr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=QJ(s.content);if(n="/EncryptedPackage",s=tr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function cy(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ps(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ese(t,e){return tr.find(t,"EncryptedPackage")?Zne(t,e):Tk(t,e)}function tse(t,e){var r,n=t,s=e||{};return s.type||(s.type=Qt&&Buffer.isBuffer(t)?"buffer":"base64"),r=xI(n,s),Jne(r,s)}function kk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ov(t.slice(r),e);default:break e}return kd.to_workbook(t,e)}function rse(t,e){var r="",n=cy(t,e);switch(e.type){case"base64":r=Ps(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=sl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Er(r)),e.type="binary",kk(r,e)}function nse(t,e){var r=t;return e.type=="base64"&&(r=Ps(r)),r=Td.utils.decode(1200,r.slice(2),"str"),e.type="binary",kk(r,e)}function sse(t){return t.match(/[^\x00-\x7F]/)?Su(t):t}function pg(t,e,r,n){return n?(r.type="string",kd.to_workbook(t,r)):kd.to_workbook(e,r)}function wh(t,e){eI();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return wh(new Uint8Array(t),(r=In(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),dc={},r.dateNF&&(dc.dateNF=r.dateNF),r.type||(r.type=Qt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Qt?"buffer":"binary",n=WX(t),typeof Uint8Array<"u"&&!Qt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=sse(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=In(r),r.type="array",wh(Vx(n),r)}switch((s=cy(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return ese(tr.read(n,r),r);break;case 9:if(s[1]<=8)return Tk(n,r);break;case 60:return Ov(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return RJ(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return DJ.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?tse(n,r):pg(t,n,r,i);case 239:return s[3]===60?Ov(n,r):pg(t,n,r,i);case 255:if(s[1]===254)return nse(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Yu.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Yu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return QS.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return cZ.to_workbook(n,r);break;case 10:case 13:case 32:return rse(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return IJ.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?QS.to_workbook(n,r):pg(t,n,r,i)}function ase(t,e,r,n,s,i,a,o){var l=kn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var m=a?t[r][p]:t[n[p]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;i[p]!=null&&(h[i[p]]=c);continue}var v=m.v;switch(m.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[p]!=null){if(v==null)if(m.t=="e"&&v===null)h[i[p]]=null;else if(c!==void 0)h[i[p]]=c;else if(u&&v===null)h[i[p]]=null;else continue;else h[i[p]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?v:Ai(m,v,o);v!=null&&(f=!1)}}return{row:h,isempty:f}}function Uv(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Vr(u);break;case"number":l=Vr(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var f=kn(l.s.r),h=[],p=[],m=0,v=0,g=Array.isArray(t),y=l.s.r,E=0,b={};g&&!t[y]&&(t[y]=[]);var k=c.skipHidden&&t["!cols"]||[],P=c.skipHidden&&t["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(k[E]||{}).hidden)switch(h[E]=cn(E),r=g?t[y][E]:t[h[E]+f],n){case 1:i[E]=E-l.s.c;break;case 2:i[E]=h[E];break;case 3:i[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ai(r,null,c),v=b[a]||0,!v)b[a]=1;else{do o=a+"_"+v++;while(b[o]);b[a]=v,b[o]=1}i[E]=o}for(y=l.s.r+s;y<=l.e.r;++y)if(!(P[y]||{}).hidden){var w=ase(t,l,y,h,n,i,g,c);(w.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[m++]=w.row)}return p.length=m,p}var p2=/"/g;function ise(t,e,r,n,s,i,a,o){for(var l=!0,c=[],u="",f=kn(r),h=e.s.c;h<=e.e.c;++h)if(n[h]){var p=o.dense?(t[r]||[])[h]:t[n[h]+f];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:Ai(p,null,o));for(var m=0,v=0;m!==u.length;++m)if((v=u.charCodeAt(m))===s||v===i||v===34||o.forceQuotes){u='"'+u.replace(p2,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(p2,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function Dk(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Vr(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(h[m]||{}).hidden||(f[m]=cn(m));for(var v=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(u=ise(t,s,g,f,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((v++?o:"")+u)));return delete n.dense,r.join("")}function ose(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Dk(t,e);return r}function lse(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Vr(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=cn(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=kn(u),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function Pk(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ls(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var f=Vr(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+e.length-1+s)}else a==-1&&(a=0,u.e.r=e.length-1+s);var h=n.header||[],p=0;e.forEach(function(v,g){Ma(v).forEach(function(y){(p=h.indexOf(y))==-1&&(h[p=h.length]=y);var E=v[y],b="z",k="",P=Ft({c:o+p,r:a+g+s});c=Fd(i,P),E&&typeof E=="object"&&!(E instanceof Date)?i[P]=E:(typeof E=="number"?b="n":typeof E=="boolean"?b="b":typeof E=="string"?b="s":E instanceof Date?(b="d",n.cellDates||(b="n",E=ds(E)),k=n.dateNF||Lt[14]):E===null&&n.nullError&&(b="e",E=0),c?(c.t=b,c.v=E,delete c.w,delete c.R,k&&(c.z=k)):i[P]=c={t:b,v:E},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var m=kn(a);if(s)for(p=0;p<h.length;++p)i[cn(p+o)+m]={t:"s",v:h[p]};return i["!ref"]=rr(u),i}function cse(t,e){return Pk(null,t,e)}function Fd(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ls(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Fd(t,Ft(e)):Fd(t,Ft({r:e,c:r||0}))}function use(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function uy(){return{SheetNames:[],Sheets:{}}}function dy(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(qre(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function dse(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=use(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function fse(t,e){return t.z=e,t}function Rk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function hse(t,e,r){return Rk(t,"#"+e,r)}function pse(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function mse(t,e,r,n){for(var s=typeof e!="string"?e:Vr(e),i=typeof e=="string"?e:rr(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=Fd(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var gse={encode_col:cn,encode_row:kn,encode_cell:Ft,encode_range:rr,decode_col:Yx,decode_row:Xx,split_cell:CY,decode_cell:ls,decode_range:jc,format_cell:Ai,sheet_add_aoa:MI,sheet_add_json:Pk,sheet_add_dom:wk,aoa_to_sheet:Gc,json_to_sheet:cse,table_to_sheet:Ck,table_to_book:Rne,sheet_to_csv:Dk,sheet_to_txt:ose,sheet_to_json:Uv,sheet_to_html:Pne,sheet_to_formulae:lse,sheet_to_row_object_array:Uv,sheet_get_cell:Fd,book_new:uy,book_append_sheet:dy,book_set_sheet_visibility:dse,cell_set_number_format:fse,cell_set_hyperlink:Rk,cell_set_internal_link:hse,cell_add_comment:pse,sheet_set_array_formula:mse,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const vse={class:"admin-time-table"},xse={class:"header"},yse={class:"admin-action-btns"},Ese=["disabled"],_se={class:"import-section"},bse={key:0,class:"import-preview"},Sse={class:"import-options"},Ase={class:"import-option-group"},Tse=["disabled"],wse=["value"],Cse={class:"import-option-group"},Ise=["disabled"],kse={class:"import-actions"},Dse=["disabled"],Pse={class:"content"},Rse={key:0,class:"loading"},Fse={key:1,class:"time-tables-container"},Nse={key:0,class:"empty-state"},Ose={key:1,class:"time-tables-list"},Mse={class:"time-table-header"},Lse={class:"time-table-info"},Bse={class:"time-table-days"},Use={class:"admin-action-btns"},$se=["onClick"],Vse=["onClick"],Hse={class:"time-table-schedule"},jse={class:"schedule-item-info"},Gse={class:"item-name"},Wse={class:"item-time"},zse={class:"schedule-item-type"},Kse={class:"dialog-header"},qse={class:"dialog-content"},Xse={class:"form-group"},Yse={class:"form-group"},Qse={class:"days-checkboxes"},Jse=["value"],Zse={class:"form-group"},eae={class:"schedule-items"},tae={class:"item-row"},rae=["onUpdate:modelValue"],nae=["onUpdate:modelValue"],sae=["onUpdate:modelValue"],aae=["onUpdate:modelValue"],iae=["onClick"],oae={__name:"AdminTimeTable",setup(t){const{saveAppSettings:e}=zs(),r=se(!0),n=se(!1),s=se([]),i=se(!1),a=se(-1),o=se({name:"",days:[],schedule:[]}),l=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],c=se(null),u=se([]),f=se([]),h=se("overwrite"),p=se(""),m=se(""),v=Se(()=>h.value==="overwrite"?p.value!=="":m.value.trim()!==""),g=()=>{const F=pn(o.value.name,{trim:!0,maxLength:100,removeDangerous:!0}),M=qr(F);if(!M.isSafe)return alert(`Security threat detected in time table name: ${M.threats.join(", ")}`),!1;if(o.value.name=F,!o.value.name.trim())return alert("Please enter a time table name"),!1;if(o.value.days.length===0)return alert("Please select at least one day"),!1;if(o.value.schedule.length===0)return alert("Please add at least one schedule item"),!1;for(let O=0;O<o.value.schedule.length;O++){const K=o.value.schedule[O],j=pn(K.name,{trim:!0,maxLength:50,removeDangerous:!0}),H=qr(j);if(!H.isSafe)return alert(`Security threat detected in schedule item ${O+1}: ${H.threats.join(", ")}`),!1;if(K.name=j,!K.name.trim())return alert(`Please enter a name for schedule item ${O+1}`),!1;if(!K.startTime||!K.endTime)return alert(`Please enter start and end times for ${K.name}`),!1;if(K.startTime>=K.endTime)return alert(`${K.name}: Start time must be before end time`),!1}return!0},y=F=>{const M=pn(F,{trim:!0,maxLength:100,removeDangerous:!0}),O=qr(M);return O.isSafe?M:(alert(`Security threat detected in import name: ${O.threats.join(", ")}`),null)};async function E(){try{console.log("Loading time tables..."),r.value=!0;const F=await Jt(Ze(ze,"app_settings","global"));if(F.exists()){const M=F.data();s.value=M.timeTables||[],console.log("Loaded time tables:",s.value)}else s.value=[],console.log("No time tables found, starting with empty array");r.value=!1}catch(F){console.error("Error loading time tables:",F),r.value=!1}}function b(){a.value=-1,o.value={name:"",days:[],schedule:[]},i.value=!0}function k(F){a.value=F,o.value=JSON.parse(JSON.stringify(s.value[F])),i.value=!0}function P(F){confirm("Are you sure you want to delete this time table?")&&s.value.splice(F,1)}function w(){o.value.schedule.push({name:"",type:"period",startTime:"",endTime:""})}function x(F){o.value.schedule.splice(F,1)}function S(){if(!g())return;if(!Is("saveTimeTable",10,6e4).allowed){alert("Too many save requests. Please wait before saving again.");return}a.value===-1?s.value.push(JSON.parse(JSON.stringify(o.value))):s.value[a.value]=JSON.parse(JSON.stringify(o.value)),_()}function _(){i.value=!1,a.value=-1,o.value={name:"",days:[],schedule:[]}}async function A(){try{if(!Is("saveAllTimeTables",5,3e5).allowed){alert("Too many save all requests. Please wait before saving again.");return}n.value=!0,console.log("Saving time tables:",s.value);const M=await Jt(Ze(ze,"app_settings","global")),K={...M.exists()?M.data():{},timeTables:s.value};await e(K),n.value=!1,console.log("Time tables saved successfully")}catch(F){console.error("Error saving time tables:",F),n.value=!1}}function C(F){return F.length===0?"No days selected":F.length===7?"Every day":F.length===5&&F.includes("monday")&&F.includes("friday")?"Weekdays":F.map(M=>{const O=l.find(K=>K.value===M);return O?O.label:M}).join(", ")}function T(F){if(!F)return"";const[M,O]=F.split(":"),K=parseInt(M),j=K>=12?"PM":"AM";return`${K===0?12:K>12?K-12:K}:${O} ${j}`}function D(){c.value&&c.value.click()}function V(F){const M=F.target.files[0];if(!M)return;const O=Vc(M,{allowedTypes:["csv","excel"],maxSize:5*1024*1024,fieldName:"Time Table Import File"});if(!O.isValid){alert(O.error),F.target.value="";return}const K=qr(M.name);if(!K.isSafe){alert(`File name contains potentially dangerous content: ${K.threats.join(", ")}`),F.target.value="";return}const j=new FileReader;j.onload=H=>{try{let W=H.target.result,X;M.name.endsWith(".csv")?X=wh(W,{type:"binary"}):X=wh(W,{type:"binary"});const re=X.SheetNames[0],he=X.Sheets[re],pe=gse.sheet_to_json(he,{defval:""}).map(q=>{const G={};return Object.entries(q).forEach(([oe,Q])=>{const Y=pn(oe,{trim:!0,maxLength:50,removeDangerous:!0}),Z=pn(String(Q),{trim:!0,maxLength:100,removeDangerous:!0});G[Y]=Z}),G});u.value=pe,f.value=pe.length?Object.keys(pe[0]):[]}catch(W){alert("Error parsing file. Please check the file format and try again."),console.error("File parsing error:",W)}},j.readAsBinaryString(M)}function B(){try{if(!Is("importTimeTable",3,3e5).allowed){alert("Too many import requests. Please wait before importing again.");return}const M=u.value.map(O=>{const K=O.name||O.Name||O.period||O.Period||O.item||O.Item||"Unknown",j=O.startTime||O["Start Time"]||O.start||O.Start||"08:00",H=O.endTime||O["End Time"]||O.end||O.End||"08:55",W=pn(K,{trim:!0,maxLength:50,removeDangerous:!0}),X=qr(W);if(!X.isSafe)return console.warn(`Security threat detected in imported item: ${X.threats.join(", ")}`),null;let re="period";const he=O.type||O.Type||"",ue=W.toLowerCase();return he.toLowerCase().includes("lunch")||ue.includes("lunch")?re="lunch":he.toLowerCase().includes("break")||ue.includes("break")?re="break":(he.toLowerCase().includes("other")||ue.includes("other"))&&(re="other"),{name:W,type:re,startTime:j,endTime:H}}).filter(O=>O&&O.name&&O.name!=="Unknown");if(M.length===0){alert("No valid schedule items found in the imported data. Please check your file format.");return}if(h.value==="overwrite"){if(p.value===""){alert("Please select a time table to overwrite");return}const O=parseInt(p.value);s.value[O]={...s.value[O],schedule:M}}else{const O=y(m.value);if(!O)return;const K={name:O,days:["monday","tuesday","wednesday","thursday","friday"],schedule:M};s.value.push(K)}u.value=[],f.value=[],h.value="overwrite",p.value="",m.value="",alert("Time table imported successfully!")}catch(F){console.error("Error importing time table:",F),alert("Error importing time table. Please check your file format and try again.")}}function R(){u.value=[],f.value=[],h.value="overwrite",p.value="",m.value=""}return Ut(E),(F,M)=>(N(),L("div",vse,[d("div",xse,[M[7]||(M[7]=d("h1",null,"Time Table Management",-1)),d("div",yse,[d("button",{onClick:A,class:"admin-action-btn primary",disabled:n.value,style:{"min-width":"160px","max-width":"160px"}},J(n.value?"Saving...":"Save Time Tables"),9,Ese),d("button",{onClick:b,class:"admin-action-btn secondary",style:{"min-width":"140px","max-width":"140px"}}," Add Time Table ")])]),d("div",_se,[d("button",{onClick:D,class:"admin-action-btn info",style:{"min-width":"150px","max-width":"150px"}},"Import CSV/XLSX"),d("input",{ref_key:"fileInput",ref:c,type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},onChange:V},null,544),M[8]||(M[8]=d("div",{class:"import-note"}," You can export from Google Sheets or Excel as CSV, or upload your Excel file directly. ",-1))]),u.value.length?(N(),L("div",bse,[M[13]||(M[13]=d("h3",null,"Preview Imported Time Table",-1)),d("table",null,[d("thead",null,[d("tr",null,[(N(!0),L(Re,null,Ve(f.value,O=>(N(),L("th",{key:O},J(O),1))),128))])]),d("tbody",null,[(N(!0),L(Re,null,Ve(u.value,(O,K)=>(N(),L("tr",{key:K},[(N(!0),L(Re,null,Ve(f.value,j=>(N(),L("td",{key:j},J(O[j]),1))),128))]))),128))])]),d("div",Sse,[M[12]||(M[12]=d("h4",null,"Import Options",-1)),d("div",Ase,[d("label",null,[we(d("input",{type:"radio","onUpdate:modelValue":M[0]||(M[0]=O=>h.value=O),value:"overwrite"},null,512),[[fa,h.value]]),M[9]||(M[9]=Ne(" Overwrite existing time table: "))]),we(d("select",{"onUpdate:modelValue":M[1]||(M[1]=O=>p.value=O),disabled:h.value!=="overwrite",class:"form-select"},[M[10]||(M[10]=d("option",{value:""},"Select a time table...",-1)),(N(!0),L(Re,null,Ve(s.value,(O,K)=>(N(),L("option",{key:K,value:K},J(O.name),9,wse))),128))],8,Tse),[[ur,p.value]])]),d("div",Cse,[d("label",null,[we(d("input",{type:"radio","onUpdate:modelValue":M[2]||(M[2]=O=>h.value=O),value:"create"},null,512),[[fa,h.value]]),M[11]||(M[11]=Ne(" Create new time table: "))]),we(d("input",{"onUpdate:modelValue":M[3]||(M[3]=O=>m.value=O),type:"text",placeholder:"Enter time table name...",disabled:h.value!=="create",class:"form-input"},null,8,Ise),[[Ye,m.value]])])]),d("div",kse,[d("button",{onClick:B,class:"btn btn-primary",disabled:!v.value},J(h.value==="overwrite"?"Overwrite Time Table":"Create New Time Table"),9,Dse),d("button",{onClick:R,class:"btn btn-secondary"},"Cancel")])])):_e("",!0),d("div",Pse,[r.value?(N(),L("div",Rse," Loading time tables... ")):(N(),L("div",Fse,[s.value.length===0?(N(),L("div",Nse,[M[14]||(M[14]=d("h3",null,"No Time Tables Created",-1)),M[15]||(M[15]=d("p",null,"Create your first time table to get started.",-1)),d("button",{onClick:b,class:"btn btn-primary"},"Create Time Table")])):(N(),L("div",Ose,[(N(!0),L(Re,null,Ve(s.value,(O,K)=>(N(),L("div",{key:K,class:"time-table-card"},[d("div",Mse,[d("div",Lse,[d("h3",null,J(O.name),1),d("p",Bse,J(C(O.days)),1)]),d("div",Use,[d("button",{onClick:j=>k(K),class:"admin-action-btn edit"}," Edit ",8,$se),d("button",{onClick:j=>P(K),class:"admin-action-btn delete"}," Delete ",8,Vse)])]),d("div",Hse,[(N(!0),L(Re,null,Ve(O.schedule,(j,H)=>(N(),L("div",{key:H,class:"schedule-item"},[d("div",jse,[d("span",Gse,J(j.name),1),d("span",Wse,J(T(j.startTime))+" - "+J(T(j.endTime)),1)]),d("div",zse,[d("span",{class:Qe(["type-badge",j.type])},J(j.type),3)])]))),128))])]))),128))]))]))]),i.value?(N(),L("div",{key:1,class:"edit-dialog-overlay",onClick:_},[d("div",{class:"edit-dialog",onClick:M[6]||(M[6]=dn(()=>{},["stop"]))},[d("div",Kse,[d("h2",null,J(a.value===-1?"Create Time Table":"Edit Time Table"),1),d("button",{onClick:_,class:"btn-close"},"×")]),d("div",qse,[d("div",Xse,[M[16]||(M[16]=d("label",{for:"timeTableName"},"Time Table Name",-1)),we(d("input",{id:"timeTableName","onUpdate:modelValue":M[4]||(M[4]=O=>o.value.name=O),type:"text",placeholder:"e.g., Regular Schedule, Rally Day, Minimum Day",class:"form-input"},null,512),[[Ye,o.value.name]])]),d("div",Yse,[M[17]||(M[17]=d("label",null,"Days This Schedule Applies",-1)),d("div",Qse,[(N(),L(Re,null,Ve(l,O=>d("label",{key:O.value,class:"day-checkbox"},[we(d("input",{type:"checkbox",value:O.value,"onUpdate:modelValue":M[5]||(M[5]=K=>o.value.days=K)},null,8,Jse),[[_t,o.value.days]]),Ne(" "+J(O.label),1)])),64))])]),d("div",Zse,[M[20]||(M[20]=d("label",null,"Schedule Items",-1)),d("div",eae,[(N(!0),L(Re,null,Ve(o.value.schedule,(O,K)=>(N(),L("div",{key:K,class:"schedule-item-edit"},[d("div",tae,[we(d("input",{"onUpdate:modelValue":j=>O.name=j,type:"text",placeholder:"Period 1, Lunch, Break, etc.",class:"form-input item-name-input"},null,8,rae),[[Ye,O.name]]),we(d("select",{"onUpdate:modelValue":j=>O.type=j,class:"form-select item-type-select"},M[18]||(M[18]=[d("option",{value:"period"},"Period",-1),d("option",{value:"break"},"Break",-1),d("option",{value:"lunch"},"Lunch",-1),d("option",{value:"other"},"Other",-1)]),8,nae),[[ur,O.type]]),we(d("input",{"onUpdate:modelValue":j=>O.startTime=j,type:"time",class:"form-input time-input"},null,8,sae),[[Ye,O.startTime]]),M[19]||(M[19]=d("span",{class:"time-separator"},"to",-1)),we(d("input",{"onUpdate:modelValue":j=>O.endTime=j,type:"time",class:"form-input time-input"},null,8,aae),[[Ye,O.endTime]]),d("button",{onClick:j=>x(K),class:"admin-action-btn delete"}," Delete ",8,iae)])]))),128)),d("button",{onClick:w,class:"admin-action-btn secondary",style:{"min-width":"150px","max-width":"150px"}}," Add Schedule Item ")])])]),d("div",{class:"admin-action-btns"},[d("button",{onClick:_,class:"admin-action-btn cancel",style:{"min-width":"100px","max-width":"100px"}},"Cancel"),d("button",{onClick:S,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},"Save Time Table")])])])):_e("",!0)]))}},Fk=yt(oae,[["__scopeId","data-v-428c8e72"]]);function lae(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const f=await $t(bt(ze,"aideSchedules")),h={};f.forEach(p=>{h[p.id]=p.data()}),t.value=h}catch(f){console.error("Error loading aide schedules:",f),t.value={}}finally{e.value=!1}}async function n(f){e.value=!0;try{const h=await Jt(Ze(ze,"aideSchedules",f));h.exists()?t.value[f]=h.data():t.value[f]={schedule:{},directAssignment:[]}}catch(h){console.error("Error loading aide schedule:",h),t.value[f]={schedule:{},directAssignment:[]}}finally{e.value=!1}}async function s(f,h,p=!0){try{const m=JSON.parse(JSON.stringify(h));p?await Ht(Ze(ze,"aideSchedules",f),m,{merge:!0}):await Ht(Ze(ze,"aideSchedules",f),m),t.value[f]=m}catch(m){throw console.error("Error saving aide schedule:",m),m}}async function i(){try{const f=Object.entries(t.value);for(const[h,p]of f){const m=JSON.parse(JSON.stringify(p));await Ht(Ze(ze,"aideSchedules",h),m,{merge:!0})}}catch(f){throw console.error("Error saving all aide schedules:",f),f}}function a(f,h){const p=[];return Object.entries(t.value).forEach(([m,v])=>{v.schedule&&v.schedule[h]&&(Array.isArray(v.schedule[h])?v.schedule[h]:[v.schedule[h]]).includes(f)&&p.push(m)}),p}function o(f){var p;const h=(p=t.value[f])==null?void 0:p.directAssignment;return Array.isArray(h)?h.length>0?h[0]:null:h||null}function l(f){return Object.keys(t.value).find(p=>{var v;const m=(v=t.value[p])==null?void 0:v.directAssignment;return Array.isArray(m)?m.includes(f):m===f})||null}function c(f,h,p){const m=[],v=t.value[f];return v&&((Array.isArray(v.directAssignment)?v.directAssignment:v.directAssignment?[v.directAssignment]:[]).forEach(y=>{if(y){const E=h.find(b=>b.id===y);E&&m.push({...E,assignmentType:"direct"})}}),Object.entries(v.schedule||{}).forEach(([y,E])=>{E&&(Array.isArray(E)?E:[E]).forEach(k=>{k&&h.forEach(P=>{if(P.schedule&&P.schedule[y]===k){const w=m.findIndex(x=>x.id===P.id);w===-1?m.push({...P,assignmentType:"class",period:y,teacherId:k}):(m[w].assignmentType="both",m[w].period=y,m[w].teacherId=k)}})})})),m}function u(f,h,p,m){if(!f||!h||!p||!m)return!1;const v=p.find(k=>k.id===h);if(!v)return!1;const g=t.value[f];if(!g)return!1;if((Array.isArray(g.directAssignment)?g.directAssignment:g.directAssignment?[g.directAssignment]:[]).includes(h))return!0;if(!v.schedule)return!1;const E=g.schedule||{};return Object.entries(v.schedule).some(([k,P])=>{const w=E[k];return w?(Array.isArray(w)?w:[w]).includes(P):!1})}return{aideSchedule:Se(()=>t.value),loading:Se(()=>e.value),loadAideSchedules:r,loadAideSchedule:n,saveAideSchedule:s,saveAllAideSchedules:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}var cae={exports:{}};const uae=Nx(VR);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function m2(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function La(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?m2(Object(r),!0).forEach(function(n){dae(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m2(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function w0(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?w0=function(e){return typeof e}:w0=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w0(t)}function dae(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gs(){return Gs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gs.apply(this,arguments)}function fae(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function hae(t,e){if(t==null)return{};var r=fae(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function pae(t){return mae(t)||gae(t)||vae(t)||xae()}function mae(t){if(Array.isArray(t))return $v(t)}function gae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vae(t,e){if(t){if(typeof t=="string")return $v(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $v(t,e)}}function $v(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var yae="1.14.0";function hi(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Ii=hi(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),df=hi(/Edge/i),g2=hi(/firefox/i),ed=hi(/safari/i)&&!hi(/chrome/i)&&!hi(/android/i),Nk=hi(/iP(ad|od|hone)/i),Eae=hi(/chrome/i)&&hi(/android/i),Ok={capture:!1,passive:!1};function zt(t,e,r){t.addEventListener(e,r,!Ii&&Ok)}function Gt(t,e,r){t.removeEventListener(e,r,!Ii&&Ok)}function Ch(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function _ae(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function ta(t,e,r,n){if(t){r=r||document;do{if(e!=null&&(e[0]===">"?t.parentNode===r&&Ch(t,e):Ch(t,e))||n&&t===r)return t;if(t===r)break}while(t=_ae(t))}return null}var v2=/\s+/g;function Pr(t,e,r){if(t&&e)if(t.classList)t.classList[r?"add":"remove"](e);else{var n=(" "+t.className+" ").replace(v2," ").replace(" "+e+" "," ");t.className=(n+(r?" "+e:"")).replace(v2," ")}}function ht(t,e,r){var n=t&&t.style;if(n){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(r=t.currentStyle),e===void 0?r:r[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=r+(typeof r=="string"?"":"px")}}function zo(t,e){var r="";if(typeof t=="string")r=t;else do{var n=ht(t,"transform");n&&n!=="none"&&(r=n+" "+r)}while(!e&&(t=t.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(r)}function Mk(t,e,r){if(t){var n=t.getElementsByTagName(e),s=0,i=n.length;if(r)for(;s<i;s++)r(n[s],s);return n}return[]}function Ra(){var t=document.scrollingElement;return t||document.documentElement}function kr(t,e,r,n,s){if(!(!t.getBoundingClientRect&&t!==window)){var i,a,o,l,c,u,f;if(t!==window&&t.parentNode&&t!==Ra()?(i=t.getBoundingClientRect(),a=i.top,o=i.left,l=i.bottom,c=i.right,u=i.height,f=i.width):(a=0,o=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||r)&&t!==window&&(s=s||t.parentNode,!Ii))do if(s&&s.getBoundingClientRect&&(ht(s,"transform")!=="none"||r&&ht(s,"position")!=="static")){var h=s.getBoundingClientRect();a-=h.top+parseInt(ht(s,"border-top-width")),o-=h.left+parseInt(ht(s,"border-left-width")),l=a+i.height,c=o+i.width;break}while(s=s.parentNode);if(n&&t!==window){var p=zo(s||t),m=p&&p.a,v=p&&p.d;p&&(a/=v,o/=m,f/=m,u/=v,l=a+u,c=o+f)}return{top:a,left:o,bottom:l,right:c,width:f,height:u}}}function x2(t,e,r){for(var n=Zi(t,!0),s=kr(t)[e];n;){var i=kr(n)[r],a=void 0;if(a=s>=i,!a)return n;if(n===Ra())break;n=Zi(n,!1)}return!1}function Dc(t,e,r,n){for(var s=0,i=0,a=t.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==Tt.ghost&&(n||a[i]!==Tt.dragged)&&ta(a[i],r.draggable,t,!1)){if(s===e)return a[i];s++}i++}return null}function fy(t,e){for(var r=t.lastElementChild;r&&(r===Tt.ghost||ht(r,"display")==="none"||e&&!Ch(r,e));)r=r.previousElementSibling;return r||null}function Br(t,e){var r=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==Tt.clone&&(!e||Ch(t,e))&&r++;return r}function y2(t){var e=0,r=0,n=Ra();if(t)do{var s=zo(t),i=s.a,a=s.d;e+=t.scrollLeft*i,r+=t.scrollTop*a}while(t!==n&&(t=t.parentNode));return[e,r]}function bae(t,e){for(var r in t)if(t.hasOwnProperty(r)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t[r][n])return Number(r)}return-1}function Zi(t,e){if(!t||!t.getBoundingClientRect)return Ra();var r=t,n=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var s=ht(r);if(r.clientWidth<r.scrollWidth&&(s.overflowX=="auto"||s.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(s.overflowY=="auto"||s.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return Ra();if(n||e)return r;n=!0}}while(r=r.parentNode);return Ra()}function Sae(t,e){if(t&&e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function mg(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var td;function Lk(t,e){return function(){if(!td){var r=arguments,n=this;r.length===1?t.call(n,r[0]):t.apply(n,r),td=setTimeout(function(){td=void 0},e)}}}function Aae(){clearTimeout(td),td=void 0}function Bk(t,e,r){t.scrollLeft+=e,t.scrollTop+=r}function hy(t){var e=window.Polymer,r=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):r?r(t).clone(!0)[0]:t.cloneNode(!0)}function E2(t,e){ht(t,"position","absolute"),ht(t,"top",e.top),ht(t,"left",e.left),ht(t,"width",e.width),ht(t,"height",e.height)}function gg(t){ht(t,"position",""),ht(t,"top",""),ht(t,"left",""),ht(t,"width",""),ht(t,"height","")}var jn="Sortable"+new Date().getTime();function Tae(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(s){if(!(ht(s,"display")==="none"||s===Tt.ghost)){t.push({target:s,rect:kr(s)});var i=La({},t[t.length-1].rect);if(s.thisAnimationDuration){var a=zo(s,!0);a&&(i.top-=a.f,i.left-=a.e)}s.fromRect=i}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(bae(t,{target:n}),1)},animateAll:function(n){var s=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var i=!1,a=0;t.forEach(function(o){var l=0,c=o.target,u=c.fromRect,f=kr(c),h=c.prevFromRect,p=c.prevToRect,m=o.rect,v=zo(c,!0);v&&(f.top-=v.f,f.left-=v.e),c.toRect=f,c.thisAnimationDuration&&mg(h,f)&&!mg(u,f)&&(m.top-f.top)/(m.left-f.left)===(u.top-f.top)/(u.left-f.left)&&(l=Cae(m,h,p,s.options)),mg(f,u)||(c.prevFromRect=u,c.prevToRect=f,l||(l=s.options.animation),s.animate(c,m,f,l)),l&&(i=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),i?e=setTimeout(function(){typeof n=="function"&&n()},a):typeof n=="function"&&n(),t=[]},animate:function(n,s,i,a){if(a){ht(n,"transition",""),ht(n,"transform","");var o=zo(this.el),l=o&&o.a,c=o&&o.d,u=(s.left-i.left)/(l||1),f=(s.top-i.top)/(c||1);n.animatingX=!!u,n.animatingY=!!f,ht(n,"transform","translate3d("+u+"px,"+f+"px,0)"),this.forRepaintDummy=wae(n),ht(n,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),ht(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){ht(n,"transition",""),ht(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},a)}}}}function wae(t){return t.offsetWidth}function Cae(t,e,r,n){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))*n.animation}var Fl=[],vg={initializeByDefault:!0},ff={mount:function(e){for(var r in vg)vg.hasOwnProperty(r)&&!(r in e)&&(e[r]=vg[r]);Fl.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Fl.push(e)},pluginEvent:function(e,r,n){var s=this;this.eventCanceled=!1,n.cancel=function(){s.eventCanceled=!0};var i=e+"Global";Fl.forEach(function(a){r[a.pluginName]&&(r[a.pluginName][i]&&r[a.pluginName][i](La({sortable:r},n)),r.options[a.pluginName]&&r[a.pluginName][e]&&r[a.pluginName][e](La({sortable:r},n)))})},initializePlugins:function(e,r,n,s){Fl.forEach(function(o){var l=o.pluginName;if(!(!e.options[l]&&!o.initializeByDefault)){var c=new o(e,r,e.options);c.sortable=e,c.options=e.options,e[l]=c,Gs(n,c.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);typeof a<"u"&&(e.options[i]=a)}},getEventProperties:function(e,r){var n={};return Fl.forEach(function(s){typeof s.eventProperties=="function"&&Gs(n,s.eventProperties.call(r[s.pluginName],e))}),n},modifyOption:function(e,r,n){var s;return Fl.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[r]=="function"&&(s=i.optionListeners[r].call(e[i.pluginName],n))}),s}};function Au(t){var e=t.sortable,r=t.rootEl,n=t.name,s=t.targetEl,i=t.cloneEl,a=t.toEl,o=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,f=t.newDraggableIndex,h=t.originalEvent,p=t.putSortable,m=t.extraEventProperties;if(e=e||r&&r[jn],!!e){var v,g=e.options,y="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!Ii&&!df?v=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent(n,!0,!0)),v.to=a||r,v.from=o||r,v.item=s||r,v.clone=i,v.oldIndex=l,v.newIndex=c,v.oldDraggableIndex=u,v.newDraggableIndex=f,v.originalEvent=h,v.pullMode=p?p.lastPutMode:void 0;var E=La(La({},m),ff.getEventProperties(n,e));for(var b in E)v[b]=E[b];r&&r.dispatchEvent(v),g[y]&&g[y].call(e,v)}}var Iae=["evt"],hs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=n.evt,i=hae(n,Iae);ff.pluginEvent.bind(Tt)(e,r,La({dragEl:rt,parentEl:Mr,ghostEl:Mt,rootEl:Cr,nextEl:Ro,lastDownEl:C0,cloneEl:Lr,cloneHidden:qi,dragStarted:Tu,putSortable:_n,activeSortable:Tt.active,originalEvent:s,oldIndex:Kl,oldDraggableIndex:rd,newIndex:Ss,newDraggableIndex:Wi,hideGhostForTarget:Hk,unhideGhostForTarget:jk,cloneNowHidden:function(){qi=!0},cloneNowShown:function(){qi=!1},dispatchSortableEvent:function(o){rs({sortable:r,name:o,originalEvent:s})}},i))};function rs(t){Au(La({putSortable:_n,cloneEl:Lr,targetEl:rt,rootEl:Cr,oldIndex:Kl,oldDraggableIndex:rd,newIndex:Ss,newDraggableIndex:Wi},t))}var rt,Mr,Mt,Cr,Ro,C0,Lr,qi,Kl,Ss,rd,Wi,e0,_n,jl=!1,Ih=!1,kh=[],Io,Zs,xg,yg,_2,b2,Tu,Nl,nd,sd=!1,t0=!1,I0,On,Eg=[],Vv=!1,Dh=[],Lp=typeof document<"u",r0=Nk,S2=df||Ii?"cssFloat":"float",kae=Lp&&!Eae&&!Nk&&"draggable"in document.createElement("div"),Uk=function(){if(Lp){if(Ii)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),$k=function(e,r){var n=ht(e),s=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=Dc(e,0,r),a=Dc(e,1,r),o=i&&ht(i),l=a&&ht(a),c=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+kr(i).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+kr(a).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&o.float&&o.float!=="none"){var f=o.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return i&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||c>=s&&n[S2]==="none"||a&&n[S2]==="none"&&c+u>s)?"vertical":"horizontal"},Dae=function(e,r,n){var s=n?e.left:e.top,i=n?e.right:e.bottom,a=n?e.width:e.height,o=n?r.left:r.top,l=n?r.right:r.bottom,c=n?r.width:r.height;return s===o||i===l||s+a/2===o+c/2},Pae=function(e,r){var n;return kh.some(function(s){var i=s[jn].options.emptyInsertThreshold;if(!(!i||fy(s))){var a=kr(s),o=e>=a.left-i&&e<=a.right+i,l=r>=a.top-i&&r<=a.bottom+i;if(o&&l)return n=s}}),n},Vk=function(e){function r(i,a){return function(o,l,c,u){var f=o.options.group.name&&l.options.group.name&&o.options.group.name===l.options.group.name;if(i==null&&(a||f))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return r(i(o,l,c,u),a)(o,l,c,u);var h=(a?o:l).options.group.name;return i===!0||typeof i=="string"&&i===h||i.join&&i.indexOf(h)>-1}}var n={},s=e.group;(!s||w0(s)!="object")&&(s={name:s}),n.name=s.name,n.checkPull=r(s.pull,!0),n.checkPut=r(s.put),n.revertClone=s.revertClone,e.group=n},Hk=function(){!Uk&&Mt&&ht(Mt,"display","none")},jk=function(){!Uk&&Mt&&ht(Mt,"display","")};Lp&&document.addEventListener("click",function(t){if(Ih)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Ih=!1,!1},!0);var ko=function(e){if(rt){e=e.touches?e.touches[0]:e;var r=Pae(e.clientX,e.clientY);if(r){var n={};for(var s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);n.target=n.rootEl=r,n.preventDefault=void 0,n.stopPropagation=void 0,r[jn]._onDragOver(n)}}},Rae=function(e){rt&&rt.parentNode[jn]._isOutsideThisEl(e.target)};function Tt(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=Gs({},e),t[jn]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return $k(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Tt.supportPointer!==!1&&"PointerEvent"in window&&!ed,emptyInsertThreshold:5};ff.initializePlugins(this,t,r);for(var n in r)!(n in e)&&(e[n]=r[n]);Vk(e);for(var s in this)s.charAt(0)==="_"&&typeof this[s]=="function"&&(this[s]=this[s].bind(this));this.nativeDraggable=e.forceFallback?!1:kae,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?zt(t,"pointerdown",this._onTapStart):(zt(t,"mousedown",this._onTapStart),zt(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(zt(t,"dragover",this),zt(t,"dragenter",this)),kh.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Gs(this,Tae())}Tt.prototype={constructor:Tt,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Nl=null)},_getDirection:function(e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,e,r,rt):this.options.direction},_onTapStart:function(e){if(e.cancelable){var r=this,n=this.el,s=this.options,i=s.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(o||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=s.filter;if($ae(n),!rt&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||s.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&ed&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=ta(l,s.draggable,n,!1),!(l&&l.animated)&&C0!==l)){if(Kl=Br(l),rd=Br(l,s.draggable),typeof u=="function"){if(u.call(this,e,l,this)){rs({sortable:r,rootEl:c,name:"filter",targetEl:l,toEl:n,fromEl:n}),hs("filter",r,{evt:e}),i&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(f){if(f=ta(c,f.trim(),n,!1),f)return rs({sortable:r,rootEl:f,name:"filter",targetEl:l,fromEl:n,toEl:n}),hs("filter",r,{evt:e}),!0}),u)){i&&e.cancelable&&e.preventDefault();return}s.handle&&!ta(c,s.handle,n,!1)||this._prepareDragStart(e,o,l)}}},_prepareDragStart:function(e,r,n){var s=this,i=s.el,a=s.options,o=i.ownerDocument,l;if(n&&!rt&&n.parentNode===i){var c=kr(n);if(Cr=i,rt=n,Mr=rt.parentNode,Ro=rt.nextSibling,C0=n,e0=a.group,Tt.dragged=rt,Io={target:rt,clientX:(r||e).clientX,clientY:(r||e).clientY},_2=Io.clientX-c.left,b2=Io.clientY-c.top,this._lastX=(r||e).clientX,this._lastY=(r||e).clientY,rt.style["will-change"]="all",l=function(){if(hs("delayEnded",s,{evt:e}),Tt.eventCanceled){s._onDrop();return}s._disableDelayedDragEvents(),!g2&&s.nativeDraggable&&(rt.draggable=!0),s._triggerDragStart(e,r),rs({sortable:s,name:"choose",originalEvent:e}),Pr(rt,a.chosenClass,!0)},a.ignore.split(",").forEach(function(u){Mk(rt,u.trim(),_g)}),zt(o,"dragover",ko),zt(o,"mousemove",ko),zt(o,"touchmove",ko),zt(o,"mouseup",s._onDrop),zt(o,"touchend",s._onDrop),zt(o,"touchcancel",s._onDrop),g2&&this.nativeDraggable&&(this.options.touchStartThreshold=4,rt.draggable=!0),hs("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(df||Ii))){if(Tt.eventCanceled){this._onDrop();return}zt(o,"mouseup",s._disableDelayedDrag),zt(o,"touchend",s._disableDelayedDrag),zt(o,"touchcancel",s._disableDelayedDrag),zt(o,"mousemove",s._delayedDragTouchMoveHandler),zt(o,"touchmove",s._delayedDragTouchMoveHandler),a.supportPointer&&zt(o,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var r=e.touches?e.touches[0]:e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){rt&&_g(rt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Gt(e,"mouseup",this._disableDelayedDrag),Gt(e,"touchend",this._disableDelayedDrag),Gt(e,"touchcancel",this._disableDelayedDrag),Gt(e,"mousemove",this._delayedDragTouchMoveHandler),Gt(e,"touchmove",this._delayedDragTouchMoveHandler),Gt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,r){r=r||e.pointerType=="touch"&&e,!this.nativeDraggable||r?this.options.supportPointer?zt(document,"pointermove",this._onTouchMove):r?zt(document,"touchmove",this._onTouchMove):zt(document,"mousemove",this._onTouchMove):(zt(rt,"dragend",this),zt(Cr,"dragstart",this._onDragStart));try{document.selection?k0(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,r){if(jl=!1,Cr&&rt){hs("dragStarted",this,{evt:r}),this.nativeDraggable&&zt(document,"dragover",Rae);var n=this.options;!e&&Pr(rt,n.dragClass,!1),Pr(rt,n.ghostClass,!0),Tt.active=this,e&&this._appendGhost(),rs({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(Zs){this._lastX=Zs.clientX,this._lastY=Zs.clientY,Hk();for(var e=document.elementFromPoint(Zs.clientX,Zs.clientY),r=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Zs.clientX,Zs.clientY),e!==r);)r=e;if(rt.parentNode[jn]._isOutsideThisEl(e),r)do{if(r[jn]){var n=void 0;if(n=r[jn]._onDragOver({clientX:Zs.clientX,clientY:Zs.clientY,target:e,rootEl:r}),n&&!this.options.dragoverBubble)break}e=r}while(r=r.parentNode);jk()}},_onTouchMove:function(e){if(Io){var r=this.options,n=r.fallbackTolerance,s=r.fallbackOffset,i=e.touches?e.touches[0]:e,a=Mt&&zo(Mt,!0),o=Mt&&a&&a.a,l=Mt&&a&&a.d,c=r0&&On&&y2(On),u=(i.clientX-Io.clientX+s.x)/(o||1)+(c?c[0]-Eg[0]:0)/(o||1),f=(i.clientY-Io.clientY+s.y)/(l||1)+(c?c[1]-Eg[1]:0)/(l||1);if(!Tt.active&&!jl){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Mt){a?(a.e+=u-(xg||0),a.f+=f-(yg||0)):a={a:1,b:0,c:0,d:1,e:u,f};var h="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");ht(Mt,"webkitTransform",h),ht(Mt,"mozTransform",h),ht(Mt,"msTransform",h),ht(Mt,"transform",h),xg=u,yg=f,Zs=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Mt){var e=this.options.fallbackOnBody?document.body:Cr,r=kr(rt,!0,r0,!0,e),n=this.options;if(r0){for(On=e;ht(On,"position")==="static"&&ht(On,"transform")==="none"&&On!==document;)On=On.parentNode;On!==document.body&&On!==document.documentElement?(On===document&&(On=Ra()),r.top+=On.scrollTop,r.left+=On.scrollLeft):On=Ra(),Eg=y2(On)}Mt=rt.cloneNode(!0),Pr(Mt,n.ghostClass,!1),Pr(Mt,n.fallbackClass,!0),Pr(Mt,n.dragClass,!0),ht(Mt,"transition",""),ht(Mt,"transform",""),ht(Mt,"box-sizing","border-box"),ht(Mt,"margin",0),ht(Mt,"top",r.top),ht(Mt,"left",r.left),ht(Mt,"width",r.width),ht(Mt,"height",r.height),ht(Mt,"opacity","0.8"),ht(Mt,"position",r0?"absolute":"fixed"),ht(Mt,"zIndex","100000"),ht(Mt,"pointerEvents","none"),Tt.ghost=Mt,e.appendChild(Mt),ht(Mt,"transform-origin",_2/parseInt(Mt.style.width)*100+"% "+b2/parseInt(Mt.style.height)*100+"%")}},_onDragStart:function(e,r){var n=this,s=e.dataTransfer,i=n.options;if(hs("dragStart",this,{evt:e}),Tt.eventCanceled){this._onDrop();return}hs("setupClone",this),Tt.eventCanceled||(Lr=hy(rt),Lr.draggable=!1,Lr.style["will-change"]="",this._hideClone(),Pr(Lr,this.options.chosenClass,!1),Tt.clone=Lr),n.cloneId=k0(function(){hs("clone",n),!Tt.eventCanceled&&(n.options.removeCloneOnHide||Cr.insertBefore(Lr,rt),n._hideClone(),rs({sortable:n,name:"clone"}))}),!r&&Pr(rt,i.dragClass,!0),r?(Ih=!0,n._loopId=setInterval(n._emulateDragOver,50)):(Gt(document,"mouseup",n._onDrop),Gt(document,"touchend",n._onDrop),Gt(document,"touchcancel",n._onDrop),s&&(s.effectAllowed="move",i.setData&&i.setData.call(n,s,rt)),zt(document,"drop",n),ht(rt,"transform","translateZ(0)")),jl=!0,n._dragStartId=k0(n._dragStarted.bind(n,r,e)),zt(document,"selectstart",n),Tu=!0,ed&&ht(document.body,"user-select","none")},_onDragOver:function(e){var r=this.el,n=e.target,s,i,a,o=this.options,l=o.group,c=Tt.active,u=e0===l,f=o.sort,h=_n||c,p,m=this,v=!1;if(Vv)return;function g(M,O){hs(M,m,La({evt:e,isOwner:u,axis:p?"vertical":"horizontal",revert:a,dragRect:s,targetRect:i,canSort:f,fromSortable:h,target:n,completed:E,onMove:function(j,H){return n0(Cr,r,rt,s,j,kr(j),e,H)},changed:b},O))}function y(){g("dragOverAnimationCapture"),m.captureAnimationState(),m!==h&&h.captureAnimationState()}function E(M){return g("dragOverCompleted",{insertion:M}),M&&(u?c._hideClone():c._showClone(m),m!==h&&(Pr(rt,_n?_n.options.ghostClass:c.options.ghostClass,!1),Pr(rt,o.ghostClass,!0)),_n!==m&&m!==Tt.active?_n=m:m===Tt.active&&_n&&(_n=null),h===m&&(m._ignoreWhileAnimating=n),m.animateAll(function(){g("dragOverAnimationComplete"),m._ignoreWhileAnimating=null}),m!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(n===rt&&!rt.animated||n===r&&!n.animated)&&(Nl=null),!o.dragoverBubble&&!e.rootEl&&n!==document&&(rt.parentNode[jn]._isOutsideThisEl(e.target),!M&&ko(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function b(){Ss=Br(rt),Wi=Br(rt,o.draggable),rs({sortable:m,name:"change",toEl:r,newIndex:Ss,newDraggableIndex:Wi,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=ta(n,o.draggable,r,!0),g("dragOver"),Tt.eventCanceled)return v;if(rt.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||m._ignoreWhileAnimating===n)return E(!1);if(Ih=!1,c&&!o.disabled&&(u?f||(a=Mr!==Cr):_n===this||(this.lastPutMode=e0.checkPull(this,c,rt,e))&&l.checkPut(this,c,rt,e))){if(p=this._getDirection(e,n)==="vertical",s=kr(rt),g("dragOverValid"),Tt.eventCanceled)return v;if(a)return Mr=Cr,y(),this._hideClone(),g("revert"),Tt.eventCanceled||(Ro?Cr.insertBefore(rt,Ro):Cr.appendChild(rt)),E(!0);var k=fy(r,o.draggable);if(!k||Mae(e,p,this)&&!k.animated){if(k===rt)return E(!1);if(k&&r===e.target&&(n=k),n&&(i=kr(n)),n0(Cr,r,rt,s,n,i,e,!!n)!==!1)return y(),r.appendChild(rt),Mr=r,b(),E(!0)}else if(k&&Oae(e,p,this)){var P=Dc(r,0,o,!0);if(P===rt)return E(!1);if(n=P,i=kr(n),n0(Cr,r,rt,s,n,i,e,!1)!==!1)return y(),r.insertBefore(rt,P),Mr=r,b(),E(!0)}else if(n.parentNode===r){i=kr(n);var w=0,x,S=rt.parentNode!==r,_=!Dae(rt.animated&&rt.toRect||s,n.animated&&n.toRect||i,p),A=p?"top":"left",C=x2(n,"top","top")||x2(rt,"top","top"),T=C?C.scrollTop:void 0;Nl!==n&&(x=i[A],sd=!1,t0=!_&&o.invertSwap||S),w=Lae(e,n,i,p,_?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,t0,Nl===n);var D;if(w!==0){var V=Br(rt);do V-=w,D=Mr.children[V];while(D&&(ht(D,"display")==="none"||D===Mt))}if(w===0||D===n)return E(!1);Nl=n,nd=w;var B=n.nextElementSibling,R=!1;R=w===1;var F=n0(Cr,r,rt,s,n,i,e,R);if(F!==!1)return(F===1||F===-1)&&(R=F===1),Vv=!0,setTimeout(Nae,30),y(),R&&!B?r.appendChild(rt):n.parentNode.insertBefore(rt,R?B:n),C&&Bk(C,0,T-C.scrollTop),Mr=rt.parentNode,x!==void 0&&!t0&&(I0=Math.abs(x-kr(n)[A])),b(),E(!0)}if(r.contains(rt))return E(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Gt(document,"mousemove",this._onTouchMove),Gt(document,"touchmove",this._onTouchMove),Gt(document,"pointermove",this._onTouchMove),Gt(document,"dragover",ko),Gt(document,"mousemove",ko),Gt(document,"touchmove",ko)},_offUpEvents:function(){var e=this.el.ownerDocument;Gt(e,"mouseup",this._onDrop),Gt(e,"touchend",this._onDrop),Gt(e,"pointerup",this._onDrop),Gt(e,"touchcancel",this._onDrop),Gt(document,"selectstart",this)},_onDrop:function(e){var r=this.el,n=this.options;if(Ss=Br(rt),Wi=Br(rt,n.draggable),hs("drop",this,{evt:e}),Mr=rt&&rt.parentNode,Ss=Br(rt),Wi=Br(rt,n.draggable),Tt.eventCanceled){this._nulling();return}jl=!1,t0=!1,sd=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Hv(this.cloneId),Hv(this._dragStartId),this.nativeDraggable&&(Gt(document,"drop",this),Gt(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),ed&&ht(document.body,"user-select",""),ht(rt,"transform",""),e&&(Tu&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Mt&&Mt.parentNode&&Mt.parentNode.removeChild(Mt),(Cr===Mr||_n&&_n.lastPutMode!=="clone")&&Lr&&Lr.parentNode&&Lr.parentNode.removeChild(Lr),rt&&(this.nativeDraggable&&Gt(rt,"dragend",this),_g(rt),rt.style["will-change"]="",Tu&&!jl&&Pr(rt,_n?_n.options.ghostClass:this.options.ghostClass,!1),Pr(rt,this.options.chosenClass,!1),rs({sortable:this,name:"unchoose",toEl:Mr,newIndex:null,newDraggableIndex:null,originalEvent:e}),Cr!==Mr?(Ss>=0&&(rs({rootEl:Mr,name:"add",toEl:Mr,fromEl:Cr,originalEvent:e}),rs({sortable:this,name:"remove",toEl:Mr,originalEvent:e}),rs({rootEl:Mr,name:"sort",toEl:Mr,fromEl:Cr,originalEvent:e}),rs({sortable:this,name:"sort",toEl:Mr,originalEvent:e})),_n&&_n.save()):Ss!==Kl&&Ss>=0&&(rs({sortable:this,name:"update",toEl:Mr,originalEvent:e}),rs({sortable:this,name:"sort",toEl:Mr,originalEvent:e})),Tt.active&&((Ss==null||Ss===-1)&&(Ss=Kl,Wi=rd),rs({sortable:this,name:"end",toEl:Mr,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){hs("nulling",this),Cr=rt=Mr=Mt=Ro=Lr=C0=qi=Io=Zs=Tu=Ss=Wi=Kl=rd=Nl=nd=_n=e0=Tt.dragged=Tt.ghost=Tt.clone=Tt.active=null,Dh.forEach(function(e){e.checked=!0}),Dh.length=xg=yg=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":rt&&(this._onDragOver(e),Fae(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],r,n=this.el.children,s=0,i=n.length,a=this.options;s<i;s++)r=n[s],ta(r,a.draggable,this.el,!1)&&e.push(r.getAttribute(a.dataIdAttr)||Uae(r));return e},sort:function(e,r){var n={},s=this.el;this.toArray().forEach(function(i,a){var o=s.children[a];ta(o,this.options.draggable,s,!1)&&(n[i]=o)},this),r&&this.captureAnimationState(),e.forEach(function(i){n[i]&&(s.removeChild(n[i]),s.appendChild(n[i]))}),r&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,r){return ta(e,r||this.options.draggable,this.el,!1)},option:function(e,r){var n=this.options;if(r===void 0)return n[e];var s=ff.modifyOption(this,e,r);typeof s<"u"?n[e]=s:n[e]=r,e==="group"&&Vk(n)},destroy:function(){hs("destroy",this);var e=this.el;e[jn]=null,Gt(e,"mousedown",this._onTapStart),Gt(e,"touchstart",this._onTapStart),Gt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Gt(e,"dragover",this),Gt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),kh.splice(kh.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!qi){if(hs("hideClone",this),Tt.eventCanceled)return;ht(Lr,"display","none"),this.options.removeCloneOnHide&&Lr.parentNode&&Lr.parentNode.removeChild(Lr),qi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(qi){if(hs("showClone",this),Tt.eventCanceled)return;rt.parentNode==Cr&&!this.options.group.revertClone?Cr.insertBefore(Lr,rt):Ro?Cr.insertBefore(Lr,Ro):Cr.appendChild(Lr),this.options.group.revertClone&&this.animate(rt,Lr),ht(Lr,"display",""),qi=!1}}};function Fae(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function n0(t,e,r,n,s,i,a,o){var l,c=t[jn],u=c.options.onMove,f;return window.CustomEvent&&!Ii&&!df?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=r,l.draggedRect=n,l.related=s||e,l.relatedRect=i||kr(e),l.willInsertAfter=o,l.originalEvent=a,t.dispatchEvent(l),u&&(f=u.call(c,l,a)),f}function _g(t){t.draggable=!1}function Nae(){Vv=!1}function Oae(t,e,r){var n=kr(Dc(r.el,0,r.options,!0)),s=10;return e?t.clientX<n.left-s||t.clientY<n.top&&t.clientX<n.right:t.clientY<n.top-s||t.clientY<n.bottom&&t.clientX<n.left}function Mae(t,e,r){var n=kr(fy(r.el,r.options.draggable)),s=10;return e?t.clientX>n.right+s||t.clientX<=n.right&&t.clientY>n.bottom&&t.clientX>=n.left:t.clientX>n.right&&t.clientY>n.top||t.clientX<=n.right&&t.clientY>n.bottom+s}function Lae(t,e,r,n,s,i,a,o){var l=n?t.clientY:t.clientX,c=n?r.height:r.width,u=n?r.top:r.left,f=n?r.bottom:r.right,h=!1;if(!a){if(o&&I0<c*s){if(!sd&&(nd===1?l>u+c*i/2:l<f-c*i/2)&&(sd=!0),sd)h=!0;else if(nd===1?l<u+I0:l>f-I0)return-nd}else if(l>u+c*(1-s)/2&&l<f-c*(1-s)/2)return Bae(e)}return h=h||a,h&&(l<u+c*i/2||l>f-c*i/2)?l>u+c/2?1:-1:0}function Bae(t){return Br(rt)<Br(t)?1:-1}function Uae(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,r=e.length,n=0;r--;)n+=e.charCodeAt(r);return n.toString(36)}function $ae(t){Dh.length=0;for(var e=t.getElementsByTagName("input"),r=e.length;r--;){var n=e[r];n.checked&&Dh.push(n)}}function k0(t){return setTimeout(t,0)}function Hv(t){return clearTimeout(t)}Lp&&zt(document,"touchmove",function(t){(Tt.active||jl)&&t.cancelable&&t.preventDefault()});Tt.utils={on:zt,off:Gt,css:ht,find:Mk,is:function(e,r){return!!ta(e,r,e,!1)},extend:Sae,throttle:Lk,closest:ta,toggleClass:Pr,clone:hy,index:Br,nextTick:k0,cancelNextTick:Hv,detectDirection:$k,getChild:Dc};Tt.get=function(t){return t[jn]};Tt.mount=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(Tt.utils=La(La({},Tt.utils),n.utils)),ff.mount(n)})};Tt.create=function(t,e){return new Tt(t,e)};Tt.version=yae;var Qr=[],wu,jv,Gv=!1,bg,Sg,Ph,Cu;function Vae(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(r){var n=r.originalEvent;this.sortable.nativeDraggable?zt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?zt(document,"pointermove",this._handleFallbackAutoScroll):n.touches?zt(document,"touchmove",this._handleFallbackAutoScroll):zt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var n=r.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?Gt(document,"dragover",this._handleAutoScroll):(Gt(document,"pointermove",this._handleFallbackAutoScroll),Gt(document,"touchmove",this._handleFallbackAutoScroll),Gt(document,"mousemove",this._handleFallbackAutoScroll)),A2(),D0(),Aae()},nulling:function(){Ph=jv=wu=Gv=Cu=bg=Sg=null,Qr.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,n){var s=this,i=(r.touches?r.touches[0]:r).clientX,a=(r.touches?r.touches[0]:r).clientY,o=document.elementFromPoint(i,a);if(Ph=r,n||this.options.forceAutoScrollFallback||df||Ii||ed){Ag(r,this.options,o,n);var l=Zi(o,!0);Gv&&(!Cu||i!==bg||a!==Sg)&&(Cu&&A2(),Cu=setInterval(function(){var c=Zi(document.elementFromPoint(i,a),!0);c!==l&&(l=c,D0()),Ag(r,s.options,c,n)},10),bg=i,Sg=a)}else{if(!this.options.bubbleScroll||Zi(o,!0)===Ra()){D0();return}Ag(r,this.options,Zi(o,!1),!1)}}},Gs(t,{pluginName:"scroll",initializeByDefault:!0})}function D0(){Qr.forEach(function(t){clearInterval(t.pid)}),Qr=[]}function A2(){clearInterval(Cu)}var Ag=Lk(function(t,e,r,n){if(e.scroll){var s=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,l=Ra(),c=!1,u;jv!==r&&(jv=r,D0(),wu=e.scroll,u=e.scrollFn,wu===!0&&(wu=Zi(r,!0)));var f=0,h=wu;do{var p=h,m=kr(p),v=m.top,g=m.bottom,y=m.left,E=m.right,b=m.width,k=m.height,P=void 0,w=void 0,x=p.scrollWidth,S=p.scrollHeight,_=ht(p),A=p.scrollLeft,C=p.scrollTop;p===l?(P=b<x&&(_.overflowX==="auto"||_.overflowX==="scroll"||_.overflowX==="visible"),w=k<S&&(_.overflowY==="auto"||_.overflowY==="scroll"||_.overflowY==="visible")):(P=b<x&&(_.overflowX==="auto"||_.overflowX==="scroll"),w=k<S&&(_.overflowY==="auto"||_.overflowY==="scroll"));var T=P&&(Math.abs(E-s)<=a&&A+b<x)-(Math.abs(y-s)<=a&&!!A),D=w&&(Math.abs(g-i)<=a&&C+k<S)-(Math.abs(v-i)<=a&&!!C);if(!Qr[f])for(var V=0;V<=f;V++)Qr[V]||(Qr[V]={});(Qr[f].vx!=T||Qr[f].vy!=D||Qr[f].el!==p)&&(Qr[f].el=p,Qr[f].vx=T,Qr[f].vy=D,clearInterval(Qr[f].pid),(T!=0||D!=0)&&(c=!0,Qr[f].pid=setInterval((function(){n&&this.layer===0&&Tt.active._onTouchMove(Ph);var B=Qr[this.layer].vy?Qr[this.layer].vy*o:0,R=Qr[this.layer].vx?Qr[this.layer].vx*o:0;typeof u=="function"&&u.call(Tt.dragged.parentNode[jn],R,B,t,Ph,Qr[this.layer].el)!=="continue"||Bk(Qr[this.layer].el,R,B)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&h!==l&&(h=Zi(h,!1)));Gv=c}},30),Gk=function(e){var r=e.originalEvent,n=e.putSortable,s=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(r){var c=n||i;o();var u=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,f=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:s,putSortable:n}))}};function py(){}py.prototype={startIndex:null,dragStart:function(e){var r=e.oldDraggableIndex;this.startIndex=r},onSpill:function(e){var r=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var s=Dc(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(r,s):this.sortable.el.appendChild(r),this.sortable.animateAll(),n&&n.animateAll()},drop:Gk};Gs(py,{pluginName:"revertOnSpill"});function my(){}my.prototype={onSpill:function(e){var r=e.dragEl,n=e.putSortable,s=n||this.sortable;s.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),s.animateAll()},drop:Gk};Gs(my,{pluginName:"removeOnSpill"});var Os;function Hae(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(r){var n=r.dragEl;Os=n},dragOverValid:function(r){var n=r.completed,s=r.target,i=r.onMove,a=r.activeSortable,o=r.changed,l=r.cancel;if(a.options.swap){var c=this.sortable.el,u=this.options;if(s&&s!==c){var f=Os;i(s)!==!1?(Pr(s,u.swapClass,!0),Os=s):Os=null,f&&f!==Os&&Pr(f,u.swapClass,!1)}o(),n(!0),l()}},drop:function(r){var n=r.activeSortable,s=r.putSortable,i=r.dragEl,a=s||this.sortable,o=this.options;Os&&Pr(Os,o.swapClass,!1),Os&&(o.swap||s&&s.options.swap)&&i!==Os&&(a.captureAnimationState(),a!==n&&n.captureAnimationState(),jae(i,Os),a.animateAll(),a!==n&&n.animateAll())},nulling:function(){Os=null}},Gs(t,{pluginName:"swap",eventProperties:function(){return{swapItem:Os}}})}function jae(t,e){var r=t.parentNode,n=e.parentNode,s,i;!r||!n||r.isEqualNode(e)||n.isEqualNode(t)||(s=Br(t),i=Br(e),r.isEqualNode(n)&&s<i&&i++,r.insertBefore(e,r.children[s]),n.insertBefore(t,n.children[i]))}var Pt=[],bs=[],uu,ea,du=!1,ps=!1,Ol=!1,vr,fu,s0;function Gae(){function t(e){for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));e.options.supportPointer?zt(document,"pointerup",this._deselectMultiDrag):(zt(document,"mouseup",this._deselectMultiDrag),zt(document,"touchend",this._deselectMultiDrag)),zt(document,"keydown",this._checkKeyDown),zt(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(s,i){var a="";Pt.length&&ea===e?Pt.forEach(function(o,l){a+=(l?", ":"")+o.textContent}):a=i.textContent,s.setData("Text",a)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(r){var n=r.dragEl;vr=n},delayEnded:function(){this.isMultiDrag=~Pt.indexOf(vr)},setupClone:function(r){var n=r.sortable,s=r.cancel;if(this.isMultiDrag){for(var i=0;i<Pt.length;i++)bs.push(hy(Pt[i])),bs[i].sortableIndex=Pt[i].sortableIndex,bs[i].draggable=!1,bs[i].style["will-change"]="",Pr(bs[i],this.options.selectedClass,!1),Pt[i]===vr&&Pr(bs[i],this.options.chosenClass,!1);n._hideClone(),s()}},clone:function(r){var n=r.sortable,s=r.rootEl,i=r.dispatchSortableEvent,a=r.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Pt.length&&ea===n&&(T2(!0,s),i("clone"),a()))},showClone:function(r){var n=r.cloneNowShown,s=r.rootEl,i=r.cancel;this.isMultiDrag&&(T2(!1,s),bs.forEach(function(a){ht(a,"display","")}),n(),s0=!1,i())},hideClone:function(r){var n=this;r.sortable;var s=r.cloneNowHidden,i=r.cancel;this.isMultiDrag&&(bs.forEach(function(a){ht(a,"display","none"),n.options.removeCloneOnHide&&a.parentNode&&a.parentNode.removeChild(a)}),s(),s0=!0,i())},dragStartGlobal:function(r){r.sortable,!this.isMultiDrag&&ea&&ea.multiDrag._deselectMultiDrag(),Pt.forEach(function(n){n.sortableIndex=Br(n)}),Pt=Pt.sort(function(n,s){return n.sortableIndex-s.sortableIndex}),Ol=!0},dragStarted:function(r){var n=this,s=r.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){Pt.forEach(function(a){a!==vr&&ht(a,"position","absolute")});var i=kr(vr,!1,!0,!0);Pt.forEach(function(a){a!==vr&&E2(a,i)}),ps=!0,du=!0}s.animateAll(function(){ps=!1,du=!1,n.options.animation&&Pt.forEach(function(a){gg(a)}),n.options.sort&&a0()})}},dragOver:function(r){var n=r.target,s=r.completed,i=r.cancel;ps&&~Pt.indexOf(n)&&(s(!1),i())},revert:function(r){var n=r.fromSortable,s=r.rootEl,i=r.sortable,a=r.dragRect;Pt.length>1&&(Pt.forEach(function(o){i.addAnimationState({target:o,rect:ps?kr(o):a}),gg(o),o.fromRect=a,n.removeAnimationState(o)}),ps=!1,Wae(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(r){var n=r.sortable,s=r.isOwner,i=r.insertion,a=r.activeSortable,o=r.parentEl,l=r.putSortable,c=this.options;if(i){if(s&&a._hideClone(),du=!1,c.animation&&Pt.length>1&&(ps||!s&&!a.options.sort&&!l)){var u=kr(vr,!1,!0,!0);Pt.forEach(function(h){h!==vr&&(E2(h,u),o.appendChild(h))}),ps=!0}if(!s)if(ps||a0(),Pt.length>1){var f=s0;a._showClone(n),a.options.animation&&!s0&&f&&bs.forEach(function(h){a.addAnimationState({target:h,rect:fu}),h.fromRect=fu,h.thisAnimationDuration=null})}else a._showClone(n)}},dragOverAnimationCapture:function(r){var n=r.dragRect,s=r.isOwner,i=r.activeSortable;if(Pt.forEach(function(o){o.thisAnimationDuration=null}),i.options.animation&&!s&&i.multiDrag.isMultiDrag){fu=Gs({},n);var a=zo(vr,!0);fu.top-=a.f,fu.left-=a.e}},dragOverAnimationComplete:function(){ps&&(ps=!1,a0())},drop:function(r){var n=r.originalEvent,s=r.rootEl,i=r.parentEl,a=r.sortable,o=r.dispatchSortableEvent,l=r.oldIndex,c=r.putSortable,u=c||this.sortable;if(n){var f=this.options,h=i.children;if(!Ol)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Pr(vr,f.selectedClass,!~Pt.indexOf(vr)),~Pt.indexOf(vr))Pt.splice(Pt.indexOf(vr),1),uu=null,Au({sortable:a,rootEl:s,name:"deselect",targetEl:vr});else{if(Pt.push(vr),Au({sortable:a,rootEl:s,name:"select",targetEl:vr}),n.shiftKey&&uu&&a.el.contains(uu)){var p=Br(uu),m=Br(vr);if(~p&&~m&&p!==m){var v,g;for(m>p?(g=p,v=m):(g=m,v=p+1);g<v;g++)~Pt.indexOf(h[g])||(Pr(h[g],f.selectedClass,!0),Pt.push(h[g]),Au({sortable:a,rootEl:s,name:"select",targetEl:h[g]}))}}else uu=vr;ea=u}if(Ol&&this.isMultiDrag){if(ps=!1,(i[jn].options.sort||i!==s)&&Pt.length>1){var y=kr(vr),E=Br(vr,":not(."+this.options.selectedClass+")");if(!du&&f.animation&&(vr.thisAnimationDuration=null),u.captureAnimationState(),!du&&(f.animation&&(vr.fromRect=y,Pt.forEach(function(k){if(k.thisAnimationDuration=null,k!==vr){var P=ps?kr(k):y;k.fromRect=P,u.addAnimationState({target:k,rect:P})}})),a0(),Pt.forEach(function(k){h[E]?i.insertBefore(k,h[E]):i.appendChild(k),E++}),l===Br(vr))){var b=!1;Pt.forEach(function(k){if(k.sortableIndex!==Br(k)){b=!0;return}}),b&&o("update")}Pt.forEach(function(k){gg(k)}),u.animateAll()}ea=u}(s===i||c&&c.lastPutMode!=="clone")&&bs.forEach(function(k){k.parentNode&&k.parentNode.removeChild(k)})}},nullingGlobal:function(){this.isMultiDrag=Ol=!1,bs.length=0},destroyGlobal:function(){this._deselectMultiDrag(),Gt(document,"pointerup",this._deselectMultiDrag),Gt(document,"mouseup",this._deselectMultiDrag),Gt(document,"touchend",this._deselectMultiDrag),Gt(document,"keydown",this._checkKeyDown),Gt(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(r){if(!(typeof Ol<"u"&&Ol)&&ea===this.sortable&&!(r&&ta(r.target,this.options.draggable,this.sortable.el,!1))&&!(r&&r.button!==0))for(;Pt.length;){var n=Pt[0];Pr(n,this.options.selectedClass,!1),Pt.shift(),Au({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:n})}},_checkKeyDown:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},Gs(t,{pluginName:"multiDrag",utils:{select:function(r){var n=r.parentNode[jn];!n||!n.options.multiDrag||~Pt.indexOf(r)||(ea&&ea!==n&&(ea.multiDrag._deselectMultiDrag(),ea=n),Pr(r,n.options.selectedClass,!0),Pt.push(r))},deselect:function(r){var n=r.parentNode[jn],s=Pt.indexOf(r);!n||!n.options.multiDrag||!~s||(Pr(r,n.options.selectedClass,!1),Pt.splice(s,1))}},eventProperties:function(){var r=this,n=[],s=[];return Pt.forEach(function(i){n.push({multiDragElement:i,index:i.sortableIndex});var a;ps&&i!==vr?a=-1:ps?a=Br(i,":not(."+r.options.selectedClass+")"):a=Br(i),s.push({multiDragElement:i,index:a})}),{items:pae(Pt),clones:[].concat(bs),oldIndicies:n,newIndicies:s}},optionListeners:{multiDragKey:function(r){return r=r.toLowerCase(),r==="ctrl"?r="Control":r.length>1&&(r=r.charAt(0).toUpperCase()+r.substr(1)),r}}})}function Wae(t,e){Pt.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function T2(t,e){bs.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function a0(){Pt.forEach(function(t){t!==vr&&t.parentNode&&t.parentNode.removeChild(t)})}Tt.mount(new Vae);Tt.mount(my,py);const zae=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:Gae,Sortable:Tt,Swap:Hae,default:Tt},Symbol.toStringTag,{value:"Module"})),Kae=Nx(zae);(function(t,e){(function(n,s){t.exports=s(uae,Kae)})(typeof self<"u"?self:Bt,function(r,n){return function(s){var i={};function a(o){if(i[o])return i[o].exports;var l=i[o]={i:o,l:!1,exports:{}};return s[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=s,a.c=i,a.d=function(o,l,c){a.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,l){if(l&1&&(o=a(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var u in o)a.d(c,u,(function(f){return o[f]}).bind(null,u));return c},a.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(l,"a",l),l},a.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},a.p="",a(a.s="fb15")}({"00ee":function(s,i,a){var o=a("b622"),l=o("toStringTag"),c={};c[l]="z",s.exports=String(c)==="[object z]"},"0366":function(s,i,a){var o=a("1c0b");s.exports=function(l,c,u){if(o(l),c===void 0)return l;switch(u){case 0:return function(){return l.call(c)};case 1:return function(f){return l.call(c,f)};case 2:return function(f,h){return l.call(c,f,h)};case 3:return function(f,h,p){return l.call(c,f,h,p)}}return function(){return l.apply(c,arguments)}}},"057f":function(s,i,a){var o=a("fc6a"),l=a("241c").f,c={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(h){try{return l(h)}catch{return u.slice()}};s.exports.f=function(p){return u&&c.call(p)=="[object Window]"?f(p):l(o(p))}},"06cf":function(s,i,a){var o=a("83ab"),l=a("d1e7"),c=a("5c6c"),u=a("fc6a"),f=a("c04e"),h=a("5135"),p=a("0cfb"),m=Object.getOwnPropertyDescriptor;i.f=o?m:function(g,y){if(g=u(g),y=f(y,!0),p)try{return m(g,y)}catch{}if(h(g,y))return c(!l.f.call(g,y),g[y])}},"0cfb":function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("cc12");s.exports=!o&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(s,i,a){var o=a("23e7"),l=a("d58f").left,c=a("a640"),u=a("ae40"),f=c("reduce"),h=u("reduce",{1:0});o({target:"Array",proto:!0,forced:!f||!h},{reduce:function(m){return l(this,m,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(s,i,a){var o=a("c6b6"),l=a("9263");s.exports=function(c,u){var f=c.exec;if(typeof f=="function"){var h=f.call(c,u);if(typeof h!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return h}if(o(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(c,u)}},"159b":function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("17c2"),u=a("9112");for(var f in l){var h=o[f],p=h&&h.prototype;if(p&&p.forEach!==c)try{u(p,"forEach",c)}catch{p.forEach=c}}},"17c2":function(s,i,a){var o=a("b727").forEach,l=a("a640"),c=a("ae40"),u=l("forEach"),f=c("forEach");s.exports=!u||!f?function(p){return o(this,p,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(s,i,a){var o=a("d066");s.exports=o("document","documentElement")},"1c0b":function(s,i){s.exports=function(a){if(typeof a!="function")throw TypeError(String(a)+" is not a function");return a}},"1c7e":function(s,i,a){var o=a("b622"),l=o("iterator"),c=!1;try{var u=0,f={next:function(){return{done:!!u++}},return:function(){c=!0}};f[l]=function(){return this},Array.from(f,function(){throw 2})}catch{}s.exports=function(h,p){if(!p&&!c)return!1;var m=!1;try{var v={};v[l]=function(){return{next:function(){return{done:m=!0}}}},h(v)}catch{}return m}},"1d80":function(s,i){s.exports=function(a){if(a==null)throw TypeError("Can't call method on "+a);return a}},"1dde":function(s,i,a){var o=a("d039"),l=a("b622"),c=a("2d00"),u=l("species");s.exports=function(f){return c>=51||!o(function(){var h=[],p=h.constructor={};return p[u]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},"23cb":function(s,i,a){var o=a("a691"),l=Math.max,c=Math.min;s.exports=function(u,f){var h=o(u);return h<0?l(h+f,0):c(h,f)}},"23e7":function(s,i,a){var o=a("da84"),l=a("06cf").f,c=a("9112"),u=a("6eeb"),f=a("ce4e"),h=a("e893"),p=a("94ca");s.exports=function(m,v){var g=m.target,y=m.global,E=m.stat,b,k,P,w,x,S;if(y?k=o:E?k=o[g]||f(g,{}):k=(o[g]||{}).prototype,k)for(P in v){if(x=v[P],m.noTargetGet?(S=l(k,P),w=S&&S.value):w=k[P],b=p(y?P:g+(E?".":"#")+P,m.forced),!b&&w!==void 0){if(typeof x==typeof w)continue;h(x,w)}(m.sham||w&&w.sham)&&c(x,"sham",!0),u(k,P,x,m)}}},"241c":function(s,i,a){var o=a("ca84"),l=a("7839"),c=l.concat("length","prototype");i.f=Object.getOwnPropertyNames||function(f){return o(f,c)}},"25f0":function(s,i,a){var o=a("6eeb"),l=a("825a"),c=a("d039"),u=a("ad6d"),f="toString",h=RegExp.prototype,p=h[f],m=c(function(){return p.call({source:"a",flags:"b"})!="/a/b"}),v=p.name!=f;(m||v)&&o(RegExp.prototype,f,function(){var y=l(this),E=String(y.source),b=y.flags,k=String(b===void 0&&y instanceof RegExp&&!("flags"in h)?u.call(y):b);return"/"+E+"/"+k},{unsafe:!0})},"2ca0":function(s,i,a){var o=a("23e7"),l=a("06cf").f,c=a("50c4"),u=a("5a34"),f=a("1d80"),h=a("ab13"),p=a("c430"),m="".startsWith,v=Math.min,g=h("startsWith"),y=!p&&!g&&!!function(){var E=l(String.prototype,"startsWith");return E&&!E.writable}();o({target:"String",proto:!0,forced:!y&&!g},{startsWith:function(b){var k=String(f(this));u(b);var P=c(v(arguments.length>1?arguments[1]:void 0,k.length)),w=String(b);return m?m.call(k,w,P):k.slice(P,P+w.length)===w}})},"2d00":function(s,i,a){var o=a("da84"),l=a("342f"),c=o.process,u=c&&c.versions,f=u&&u.v8,h,p;f?(h=f.split("."),p=h[0]+h[1]):l&&(h=l.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=l.match(/Chrome\/(\d+)/),h&&(p=h[1]))),s.exports=p&&+p},"342f":function(s,i,a){var o=a("d066");s.exports=o("navigator","userAgent")||""},"35a1":function(s,i,a){var o=a("f5df"),l=a("3f8c"),c=a("b622"),u=c("iterator");s.exports=function(f){if(f!=null)return f[u]||f["@@iterator"]||l[o(f)]}},"37e8":function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("825a"),u=a("df75");s.exports=o?Object.defineProperties:function(h,p){c(h);for(var m=u(p),v=m.length,g=0,y;v>g;)l.f(h,y=m[g++],p[y]);return h}},"3bbe":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype");return l}},"3ca3":function(s,i,a){var o=a("6547").charAt,l=a("69f3"),c=a("7dd0"),u="String Iterator",f=l.set,h=l.getterFor(u);c(String,"String",function(p){f(this,{type:u,string:String(p),index:0})},function(){var m=h(this),v=m.string,g=m.index,y;return g>=v.length?{value:void 0,done:!0}:(y=o(v,g),m.index+=y.length,{value:y,done:!1})})},"3f8c":function(s,i){s.exports={}},4160:function(s,i,a){var o=a("23e7"),l=a("17c2");o({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},"428f":function(s,i,a){var o=a("da84");s.exports=o},"44ad":function(s,i,a){var o=a("d039"),l=a("c6b6"),c="".split;s.exports=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return l(u)=="String"?c.call(u,""):Object(u)}:Object},"44d2":function(s,i,a){var o=a("b622"),l=a("7c73"),c=a("9bf2"),u=o("unscopables"),f=Array.prototype;f[u]==null&&c.f(f,u,{configurable:!0,value:l(null)}),s.exports=function(h){f[u][h]=!0}},"44e7":function(s,i,a){var o=a("861d"),l=a("c6b6"),c=a("b622"),u=c("match");s.exports=function(f){var h;return o(f)&&((h=f[u])!==void 0?!!h:l(f)=="RegExp")}},4930:function(s,i,a){var o=a("d039");s.exports=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())})},"4d64":function(s,i,a){var o=a("fc6a"),l=a("50c4"),c=a("23cb"),u=function(f){return function(h,p,m){var v=o(h),g=l(v.length),y=c(m,g),E;if(f&&p!=p){for(;g>y;)if(E=v[y++],E!=E)return!0}else for(;g>y;y++)if((f||y in v)&&v[y]===p)return f||y||0;return!f&&-1}};s.exports={includes:u(!0),indexOf:u(!1)}},"4de4":function(s,i,a){var o=a("23e7"),l=a("b727").filter,c=a("1dde"),u=a("ae40"),f=c("filter"),h=u("filter");o({target:"Array",proto:!0,forced:!f||!h},{filter:function(m){return l(this,m,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(s,i,a){var o=a("0366"),l=a("7b0b"),c=a("9bdd"),u=a("e95a"),f=a("50c4"),h=a("8418"),p=a("35a1");s.exports=function(v){var g=l(v),y=typeof this=="function"?this:Array,E=arguments.length,b=E>1?arguments[1]:void 0,k=b!==void 0,P=p(g),w=0,x,S,_,A,C,T;if(k&&(b=o(b,E>2?arguments[2]:void 0,2)),P!=null&&!(y==Array&&u(P)))for(A=P.call(g),C=A.next,S=new y;!(_=C.call(A)).done;w++)T=k?c(A,b,[_.value,w],!0):_.value,h(S,w,T);else for(x=f(g.length),S=new y(x);x>w;w++)T=k?b(g[w],w):g[w],h(S,w,T);return S.length=w,S}},"4fad":function(s,i,a){var o=a("23e7"),l=a("6f53").entries;o({target:"Object",stat:!0},{entries:function(u){return l(u)}})},"50c4":function(s,i,a){var o=a("a691"),l=Math.min;s.exports=function(c){return c>0?l(o(c),9007199254740991):0}},5135:function(s,i){var a={}.hasOwnProperty;s.exports=function(o,l){return a.call(o,l)}},5319:function(s,i,a){var o=a("d784"),l=a("825a"),c=a("7b0b"),u=a("50c4"),f=a("a691"),h=a("1d80"),p=a("8aa5"),m=a("14c3"),v=Math.max,g=Math.min,y=Math.floor,E=/\$([$&'`]|\d\d?|<[^>]*>)/g,b=/\$([$&'`]|\d\d?)/g,k=function(P){return P===void 0?P:String(P)};o("replace",2,function(P,w,x,S){var _=S.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,A=S.REPLACE_KEEPS_$0,C=_?"$":"$0";return[function(V,B){var R=h(this),F=V==null?void 0:V[P];return F!==void 0?F.call(V,R,B):w.call(String(R),V,B)},function(D,V){if(!_&&A||typeof V=="string"&&V.indexOf(C)===-1){var B=x(w,D,this,V);if(B.done)return B.value}var R=l(D),F=String(this),M=typeof V=="function";M||(V=String(V));var O=R.global;if(O){var K=R.unicode;R.lastIndex=0}for(var j=[];;){var H=m(R,F);if(H===null||(j.push(H),!O))break;var W=String(H[0]);W===""&&(R.lastIndex=p(F,u(R.lastIndex),K))}for(var X="",re=0,he=0;he<j.length;he++){H=j[he];for(var ue=String(H[0]),pe=v(g(f(H.index),F.length),0),q=[],G=1;G<H.length;G++)q.push(k(H[G]));var oe=H.groups;if(M){var Q=[ue].concat(q,pe,F);oe!==void 0&&Q.push(oe);var Y=String(V.apply(void 0,Q))}else Y=T(ue,F,pe,q,oe,V);pe>=re&&(X+=F.slice(re,pe)+Y,re=pe+ue.length)}return X+F.slice(re)}];function T(D,V,B,R,F,M){var O=B+D.length,K=R.length,j=b;return F!==void 0&&(F=c(F),j=E),w.call(M,j,function(H,W){var X;switch(W.charAt(0)){case"$":return"$";case"&":return D;case"`":return V.slice(0,B);case"'":return V.slice(O);case"<":X=F[W.slice(1,-1)];break;default:var re=+W;if(re===0)return H;if(re>K){var he=y(re/10);return he===0?H:he<=K?R[he-1]===void 0?W.charAt(1):R[he-1]+W.charAt(1):H}X=R[re-1]}return X===void 0?"":X})}})},5692:function(s,i,a){var o=a("c430"),l=a("c6cd");(s.exports=function(c,u){return l[c]||(l[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:o?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(s,i,a){var o=a("d066"),l=a("241c"),c=a("7418"),u=a("825a");s.exports=o("Reflect","ownKeys")||function(h){var p=l.f(u(h)),m=c.f;return m?p.concat(m(h)):p}},"5a34":function(s,i,a){var o=a("44e7");s.exports=function(l){if(o(l))throw TypeError("The method doesn't accept regular expressions");return l}},"5c6c":function(s,i){s.exports=function(a,o){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:o}}},"5db7":function(s,i,a){var o=a("23e7"),l=a("a2bf"),c=a("7b0b"),u=a("50c4"),f=a("1c0b"),h=a("65f0");o({target:"Array",proto:!0},{flatMap:function(m){var v=c(this),g=u(v.length),y;return f(m),y=h(v,0),y.length=l(y,v,v,g,0,1,m,arguments.length>1?arguments[1]:void 0),y}})},6547:function(s,i,a){var o=a("a691"),l=a("1d80"),c=function(u){return function(f,h){var p=String(l(f)),m=o(h),v=p.length,g,y;return m<0||m>=v?u?"":void 0:(g=p.charCodeAt(m),g<55296||g>56319||m+1===v||(y=p.charCodeAt(m+1))<56320||y>57343?u?p.charAt(m):g:u?p.slice(m,m+2):(g-55296<<10)+(y-56320)+65536)}};s.exports={codeAt:c(!1),charAt:c(!0)}},"65f0":function(s,i,a){var o=a("861d"),l=a("e8b5"),c=a("b622"),u=c("species");s.exports=function(f,h){var p;return l(f)&&(p=f.constructor,typeof p=="function"&&(p===Array||l(p.prototype))?p=void 0:o(p)&&(p=p[u],p===null&&(p=void 0))),new(p===void 0?Array:p)(h===0?0:h)}},"69f3":function(s,i,a){var o=a("7f9a"),l=a("da84"),c=a("861d"),u=a("9112"),f=a("5135"),h=a("f772"),p=a("d012"),m=l.WeakMap,v,g,y,E=function(_){return y(_)?g(_):v(_,{})},b=function(_){return function(A){var C;if(!c(A)||(C=g(A)).type!==_)throw TypeError("Incompatible receiver, "+_+" required");return C}};if(o){var k=new m,P=k.get,w=k.has,x=k.set;v=function(_,A){return x.call(k,_,A),A},g=function(_){return P.call(k,_)||{}},y=function(_){return w.call(k,_)}}else{var S=h("state");p[S]=!0,v=function(_,A){return u(_,S,A),A},g=function(_){return f(_,S)?_[S]:{}},y=function(_){return f(_,S)}}s.exports={set:v,get:g,has:y,enforce:E,getterFor:b}},"6eeb":function(s,i,a){var o=a("da84"),l=a("9112"),c=a("5135"),u=a("ce4e"),f=a("8925"),h=a("69f3"),p=h.get,m=h.enforce,v=String(String).split("String");(s.exports=function(g,y,E,b){var k=b?!!b.unsafe:!1,P=b?!!b.enumerable:!1,w=b?!!b.noTargetGet:!1;if(typeof E=="function"&&(typeof y=="string"&&!c(E,"name")&&l(E,"name",y),m(E).source=v.join(typeof y=="string"?y:"")),g===o){P?g[y]=E:u(y,E);return}else k?!w&&g[y]&&(P=!0):delete g[y];P?g[y]=E:l(g,y,E)})(Function.prototype,"toString",function(){return typeof this=="function"&&p(this).source||f(this)})},"6f53":function(s,i,a){var o=a("83ab"),l=a("df75"),c=a("fc6a"),u=a("d1e7").f,f=function(h){return function(p){for(var m=c(p),v=l(m),g=v.length,y=0,E=[],b;g>y;)b=v[y++],(!o||u.call(m,b))&&E.push(h?[b,m[b]]:m[b]);return E}};s.exports={entries:f(!0),values:f(!1)}},"73d9":function(s,i,a){var o=a("44d2");o("flatMap")},7418:function(s,i){i.f=Object.getOwnPropertySymbols},"746f":function(s,i,a){var o=a("428f"),l=a("5135"),c=a("e538"),u=a("9bf2").f;s.exports=function(f){var h=o.Symbol||(o.Symbol={});l(h,f)||u(h,f,{value:c.f(f)})}},7839:function(s,i){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(s,i,a){var o=a("1d80");s.exports=function(l){return Object(o(l))}},"7c73":function(s,i,a){var o=a("825a"),l=a("37e8"),c=a("7839"),u=a("d012"),f=a("1be4"),h=a("cc12"),p=a("f772"),m=">",v="<",g="prototype",y="script",E=p("IE_PROTO"),b=function(){},k=function(_){return v+y+m+_+v+"/"+y+m},P=function(_){_.write(k("")),_.close();var A=_.parentWindow.Object;return _=null,A},w=function(){var _=h("iframe"),A="java"+y+":",C;return _.style.display="none",f.appendChild(_),_.src=String(A),C=_.contentWindow.document,C.open(),C.write(k("document.F=Object")),C.close(),C.F},x,S=function(){try{x=document.domain&&new ActiveXObject("htmlfile")}catch{}S=x?P(x):w();for(var _=c.length;_--;)delete S[g][c[_]];return S()};u[E]=!0,s.exports=Object.create||function(A,C){var T;return A!==null?(b[g]=o(A),T=new b,b[g]=null,T[E]=A):T=S(),C===void 0?T:l(T,C)}},"7dd0":function(s,i,a){var o=a("23e7"),l=a("9ed3"),c=a("e163"),u=a("d2bb"),f=a("d44e"),h=a("9112"),p=a("6eeb"),m=a("b622"),v=a("c430"),g=a("3f8c"),y=a("ae93"),E=y.IteratorPrototype,b=y.BUGGY_SAFARI_ITERATORS,k=m("iterator"),P="keys",w="values",x="entries",S=function(){return this};s.exports=function(_,A,C,T,D,V,B){l(C,A,T);var R=function(he){if(he===D&&j)return j;if(!b&&he in O)return O[he];switch(he){case P:return function(){return new C(this,he)};case w:return function(){return new C(this,he)};case x:return function(){return new C(this,he)}}return function(){return new C(this)}},F=A+" Iterator",M=!1,O=_.prototype,K=O[k]||O["@@iterator"]||D&&O[D],j=!b&&K||R(D),H=A=="Array"&&O.entries||K,W,X,re;if(H&&(W=c(H.call(new _)),E!==Object.prototype&&W.next&&(!v&&c(W)!==E&&(u?u(W,E):typeof W[k]!="function"&&h(W,k,S)),f(W,F,!0,!0),v&&(g[F]=S))),D==w&&K&&K.name!==w&&(M=!0,j=function(){return K.call(this)}),(!v||B)&&O[k]!==j&&h(O,k,j),g[A]=j,D)if(X={values:R(w),keys:V?j:R(P),entries:R(x)},B)for(re in X)(b||M||!(re in O))&&p(O,re,X[re]);else o({target:A,proto:!0,forced:b||M},X);return X}},"7f9a":function(s,i,a){var o=a("da84"),l=a("8925"),c=o.WeakMap;s.exports=typeof c=="function"&&/native code/.test(l(c))},"825a":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l))throw TypeError(String(l)+" is not an object");return l}},"83ab":function(s,i,a){var o=a("d039");s.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(s,i,a){var o=a("c04e"),l=a("9bf2"),c=a("5c6c");s.exports=function(u,f,h){var p=o(f);p in u?l.f(u,p,c(0,h)):u[p]=h}},"861d":function(s,i){s.exports=function(a){return typeof a=="object"?a!==null:typeof a=="function"}},8875:function(s,i,a){var o,l,c;(function(u,f){l=[],o=f,c=typeof o=="function"?o.apply(i,l):o,c!==void 0&&(s.exports=c)})(typeof self<"u"?self:this,function(){function u(){var f=Object.getOwnPropertyDescriptor(document,"currentScript");if(!f&&"currentScript"in document&&document.currentScript||f&&f.get!==u&&document.currentScript)return document.currentScript;try{throw new Error}catch(x){var h=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,p=/@([^@]*):(\d+):(\d+)\s*$/ig,m=h.exec(x.stack)||p.exec(x.stack),v=m&&m[1]||!1,g=m&&m[2]||!1,y=document.location.href.replace(document.location.hash,""),E,b,k,P=document.getElementsByTagName("script");v===y&&(E=document.documentElement.outerHTML,b=new RegExp("(?:[^\\n]+?\\n){0,"+(g-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),k=E.replace(b,"$1").trim());for(var w=0;w<P.length;w++)if(P[w].readyState==="interactive"||P[w].src===v||v===y&&P[w].innerHTML&&P[w].innerHTML.trim()===k)return P[w];return null}}return u})},8925:function(s,i,a){var o=a("c6cd"),l=Function.toString;typeof o.inspectSource!="function"&&(o.inspectSource=function(c){return l.call(c)}),s.exports=o.inspectSource},"8aa5":function(s,i,a){var o=a("6547").charAt;s.exports=function(l,c,u){return c+(u?o(l,c).length:1)}},"8bbf":function(s,i){s.exports=r},"90e3":function(s,i){var a=0,o=Math.random();s.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++a+o).toString(36)}},9112:function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("5c6c");s.exports=o?function(u,f,h){return l.f(u,f,c(1,h))}:function(u,f,h){return u[f]=h,u}},9263:function(s,i,a){var o=a("ad6d"),l=a("9f7f"),c=RegExp.prototype.exec,u=String.prototype.replace,f=c,h=function(){var g=/a/,y=/b*/g;return c.call(g,"a"),c.call(y,"a"),g.lastIndex!==0||y.lastIndex!==0}(),p=l.UNSUPPORTED_Y||l.BROKEN_CARET,m=/()??/.exec("")[1]!==void 0,v=h||m||p;v&&(f=function(y){var E=this,b,k,P,w,x=p&&E.sticky,S=o.call(E),_=E.source,A=0,C=y;return x&&(S=S.replace("y",""),S.indexOf("g")===-1&&(S+="g"),C=String(y).slice(E.lastIndex),E.lastIndex>0&&(!E.multiline||E.multiline&&y[E.lastIndex-1]!==`
`)&&(_="(?: "+_+")",C=" "+C,A++),k=new RegExp("^(?:"+_+")",S)),m&&(k=new RegExp("^"+_+"$(?!\\s)",S)),h&&(b=E.lastIndex),P=c.call(x?k:E,C),x?P?(P.input=P.input.slice(A),P[0]=P[0].slice(A),P.index=E.lastIndex,E.lastIndex+=P[0].length):E.lastIndex=0:h&&P&&(E.lastIndex=E.global?P.index+P[0].length:b),m&&P&&P.length>1&&u.call(P[0],k,function(){for(w=1;w<arguments.length-2;w++)arguments[w]===void 0&&(P[w]=void 0)}),P}),s.exports=f},"94ca":function(s,i,a){var o=a("d039"),l=/#|\.prototype\./,c=function(m,v){var g=f[u(m)];return g==p?!0:g==h?!1:typeof v=="function"?o(v):!!v},u=c.normalize=function(m){return String(m).replace(l,".").toLowerCase()},f=c.data={},h=c.NATIVE="N",p=c.POLYFILL="P";s.exports=c},"99af":function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("e8b5"),u=a("861d"),f=a("7b0b"),h=a("50c4"),p=a("8418"),m=a("65f0"),v=a("1dde"),g=a("b622"),y=a("2d00"),E=g("isConcatSpreadable"),b=9007199254740991,k="Maximum allowed index exceeded",P=y>=51||!l(function(){var _=[];return _[E]=!1,_.concat()[0]!==_}),w=v("concat"),x=function(_){if(!u(_))return!1;var A=_[E];return A!==void 0?!!A:c(_)},S=!P||!w;o({target:"Array",proto:!0,forced:S},{concat:function(A){var C=f(this),T=m(C,0),D=0,V,B,R,F,M;for(V=-1,R=arguments.length;V<R;V++)if(M=V===-1?C:arguments[V],x(M)){if(F=h(M.length),D+F>b)throw TypeError(k);for(B=0;B<F;B++,D++)B in M&&p(T,D,M[B])}else{if(D>=b)throw TypeError(k);p(T,D++,M)}return T.length=D,T}})},"9bdd":function(s,i,a){var o=a("825a");s.exports=function(l,c,u,f){try{return f?c(o(u)[0],u[1]):c(u)}catch(p){var h=l.return;throw h!==void 0&&o(h.call(l)),p}}},"9bf2":function(s,i,a){var o=a("83ab"),l=a("0cfb"),c=a("825a"),u=a("c04e"),f=Object.defineProperty;i.f=o?f:function(p,m,v){if(c(p),m=u(m,!0),c(v),l)try{return f(p,m,v)}catch{}if("get"in v||"set"in v)throw TypeError("Accessors not supported");return"value"in v&&(p[m]=v.value),p}},"9ed3":function(s,i,a){var o=a("ae93").IteratorPrototype,l=a("7c73"),c=a("5c6c"),u=a("d44e"),f=a("3f8c"),h=function(){return this};s.exports=function(p,m,v){var g=m+" Iterator";return p.prototype=l(o,{next:c(1,v)}),u(p,g,!1,!0),f[g]=h,p}},"9f7f":function(s,i,a){var o=a("d039");function l(c,u){return RegExp(c,u)}i.UNSUPPORTED_Y=o(function(){var c=l("a","y");return c.lastIndex=2,c.exec("abcd")!=null}),i.BROKEN_CARET=o(function(){var c=l("^r","gy");return c.lastIndex=2,c.exec("str")!=null})},a2bf:function(s,i,a){var o=a("e8b5"),l=a("50c4"),c=a("0366"),u=function(f,h,p,m,v,g,y,E){for(var b=v,k=0,P=y?c(y,E,3):!1,w;k<m;){if(k in p){if(w=P?P(p[k],k,h):p[k],g>0&&o(w))b=u(f,h,w,l(w.length),b,g-1)-1;else{if(b>=9007199254740991)throw TypeError("Exceed the acceptable array length");f[b]=w}b++}k++}return b};s.exports=u},a352:function(s,i){s.exports=n},a434:function(s,i,a){var o=a("23e7"),l=a("23cb"),c=a("a691"),u=a("50c4"),f=a("7b0b"),h=a("65f0"),p=a("8418"),m=a("1dde"),v=a("ae40"),g=m("splice"),y=v("splice",{ACCESSORS:!0,0:0,1:2}),E=Math.max,b=Math.min,k=9007199254740991,P="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!g||!y},{splice:function(x,S){var _=f(this),A=u(_.length),C=l(x,A),T=arguments.length,D,V,B,R,F,M;if(T===0?D=V=0:T===1?(D=0,V=A-C):(D=T-2,V=b(E(c(S),0),A-C)),A+D-V>k)throw TypeError(P);for(B=h(_,V),R=0;R<V;R++)F=C+R,F in _&&p(B,R,_[F]);if(B.length=V,D<V){for(R=C;R<A-V;R++)F=R+V,M=R+D,F in _?_[M]=_[F]:delete _[M];for(R=A;R>A-V+D;R--)delete _[R-1]}else if(D>V)for(R=A-V;R>C;R--)F=R+V-1,M=R+D-1,F in _?_[M]=_[F]:delete _[M];for(R=0;R<D;R++)_[R+C]=arguments[R+2];return _.length=A-V+D,B}})},a4d3:function(s,i,a){var o=a("23e7"),l=a("da84"),c=a("d066"),u=a("c430"),f=a("83ab"),h=a("4930"),p=a("fdbf"),m=a("d039"),v=a("5135"),g=a("e8b5"),y=a("861d"),E=a("825a"),b=a("7b0b"),k=a("fc6a"),P=a("c04e"),w=a("5c6c"),x=a("7c73"),S=a("df75"),_=a("241c"),A=a("057f"),C=a("7418"),T=a("06cf"),D=a("9bf2"),V=a("d1e7"),B=a("9112"),R=a("6eeb"),F=a("5692"),M=a("f772"),O=a("d012"),K=a("90e3"),j=a("b622"),H=a("e538"),W=a("746f"),X=a("d44e"),re=a("69f3"),he=a("b727").forEach,ue=M("hidden"),pe="Symbol",q="prototype",G=j("toPrimitive"),oe=re.set,Q=re.getterFor(pe),Y=Object[q],Z=l.Symbol,ne=c("JSON","stringify"),ge=T.f,ae=D.f,ce=A.f,fe=V.f,Ae=F("symbols"),Ie=F("op-symbols"),Te=F("string-to-symbol-registry"),Ge=F("symbol-to-string-registry"),ke=F("wks"),$e=l.QObject,Be=!$e||!$e[q]||!$e[q].findChild,We=f&&m(function(){return x(ae({},"a",{get:function(){return ae(this,"a",{value:7}).a}})).a!=7})?function(pt,ut,mt){var Dt=ge(Y,ut);Dt&&delete Y[ut],ae(pt,ut,mt),Dt&&pt!==Y&&ae(Y,ut,Dt)}:ae,Ke=function(pt,ut){var mt=Ae[pt]=x(Z[q]);return oe(mt,{type:pe,tag:pt,description:ut}),f||(mt.description=ut),mt},Ee=p?function(pt){return typeof pt=="symbol"}:function(pt){return Object(pt)instanceof Z},ye=function(ut,mt,Dt){ut===Y&&ye(Ie,mt,Dt),E(ut);var Ot=P(mt,!0);return E(Dt),v(Ae,Ot)?(Dt.enumerable?(v(ut,ue)&&ut[ue][Ot]&&(ut[ue][Ot]=!1),Dt=x(Dt,{enumerable:w(0,!1)})):(v(ut,ue)||ae(ut,ue,w(1,{})),ut[ue][Ot]=!0),We(ut,Ot,Dt)):ae(ut,Ot,Dt)},be=function(ut,mt){E(ut);var Dt=k(mt),Ot=S(Dt).concat(Et(Dt));return he(Ot,function(br){(!f||je.call(Dt,br))&&ye(ut,br,Dt[br])}),ut},Oe=function(ut,mt){return mt===void 0?x(ut):be(x(ut),mt)},je=function(ut){var mt=P(ut,!0),Dt=fe.call(this,mt);return this===Y&&v(Ae,mt)&&!v(Ie,mt)?!1:Dt||!v(this,mt)||!v(Ae,mt)||v(this,ue)&&this[ue][mt]?Dt:!0},lt=function(ut,mt){var Dt=k(ut),Ot=P(mt,!0);if(!(Dt===Y&&v(Ae,Ot)&&!v(Ie,Ot))){var br=ge(Dt,Ot);return br&&v(Ae,Ot)&&!(v(Dt,ue)&&Dt[ue][Ot])&&(br.enumerable=!0),br}},gt=function(ut){var mt=ce(k(ut)),Dt=[];return he(mt,function(Ot){!v(Ae,Ot)&&!v(O,Ot)&&Dt.push(Ot)}),Dt},Et=function(ut){var mt=ut===Y,Dt=ce(mt?Ie:k(ut)),Ot=[];return he(Dt,function(br){v(Ae,br)&&(!mt||v(Y,br))&&Ot.push(Ae[br])}),Ot};if(h||(Z=function(){if(this instanceof Z)throw TypeError("Symbol is not a constructor");var ut=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),mt=K(ut),Dt=function(Ot){this===Y&&Dt.call(Ie,Ot),v(this,ue)&&v(this[ue],mt)&&(this[ue][mt]=!1),We(this,mt,w(1,Ot))};return f&&Be&&We(Y,mt,{configurable:!0,set:Dt}),Ke(mt,ut)},R(Z[q],"toString",function(){return Q(this).tag}),R(Z,"withoutSetter",function(pt){return Ke(K(pt),pt)}),V.f=je,D.f=ye,T.f=lt,_.f=A.f=gt,C.f=Et,H.f=function(pt){return Ke(j(pt),pt)},f&&(ae(Z[q],"description",{configurable:!0,get:function(){return Q(this).description}}),u||R(Y,"propertyIsEnumerable",je,{unsafe:!0}))),o({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:Z}),he(S(ke),function(pt){W(pt)}),o({target:pe,stat:!0,forced:!h},{for:function(pt){var ut=String(pt);if(v(Te,ut))return Te[ut];var mt=Z(ut);return Te[ut]=mt,Ge[mt]=ut,mt},keyFor:function(ut){if(!Ee(ut))throw TypeError(ut+" is not a symbol");if(v(Ge,ut))return Ge[ut]},useSetter:function(){Be=!0},useSimple:function(){Be=!1}}),o({target:"Object",stat:!0,forced:!h,sham:!f},{create:Oe,defineProperty:ye,defineProperties:be,getOwnPropertyDescriptor:lt}),o({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:gt,getOwnPropertySymbols:Et}),o({target:"Object",stat:!0,forced:m(function(){C.f(1)})},{getOwnPropertySymbols:function(ut){return C.f(b(ut))}}),ne){var jt=!h||m(function(){var pt=Z();return ne([pt])!="[null]"||ne({a:pt})!="{}"||ne(Object(pt))!="{}"});o({target:"JSON",stat:!0,forced:jt},{stringify:function(ut,mt,Dt){for(var Ot=[ut],br=1,Zn;arguments.length>br;)Ot.push(arguments[br++]);if(Zn=mt,!(!y(mt)&&ut===void 0||Ee(ut)))return g(mt)||(mt=function(ki,fs){if(typeof Zn=="function"&&(fs=Zn.call(this,ki,fs)),!Ee(fs))return fs}),Ot[1]=mt,ne.apply(null,Ot)}})}Z[q][G]||B(Z[q],G,Z[q].valueOf),X(Z,pe),O[ue]=!0},a630:function(s,i,a){var o=a("23e7"),l=a("4df4"),c=a("1c7e"),u=!c(function(f){Array.from(f)});o({target:"Array",stat:!0,forced:u},{from:l})},a640:function(s,i,a){var o=a("d039");s.exports=function(l,c){var u=[][l];return!!u&&o(function(){u.call(null,c||function(){throw 1},1)})}},a691:function(s,i){var a=Math.ceil,o=Math.floor;s.exports=function(l){return isNaN(l=+l)?0:(l>0?o:a)(l)}},ab13:function(s,i,a){var o=a("b622"),l=o("match");s.exports=function(c){var u=/./;try{"/./"[c](u)}catch{try{return u[l]=!1,"/./"[c](u)}catch{}}return!1}},ac1f:function(s,i,a){var o=a("23e7"),l=a("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},ad6d:function(s,i,a){var o=a("825a");s.exports=function(){var l=o(this),c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),l.dotAll&&(c+="s"),l.unicode&&(c+="u"),l.sticky&&(c+="y"),c}},ae40:function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("5135"),u=Object.defineProperty,f={},h=function(p){throw p};s.exports=function(p,m){if(c(f,p))return f[p];m||(m={});var v=[][p],g=c(m,"ACCESSORS")?m.ACCESSORS:!1,y=c(m,0)?m[0]:h,E=c(m,1)?m[1]:void 0;return f[p]=!!v&&!l(function(){if(g&&!o)return!0;var b={length:-1};g?u(b,1,{enumerable:!0,get:h}):b[1]=1,v.call(b,y,E)})}},ae93:function(s,i,a){var o=a("e163"),l=a("9112"),c=a("5135"),u=a("b622"),f=a("c430"),h=u("iterator"),p=!1,m=function(){return this},v,g,y;[].keys&&(y=[].keys(),"next"in y?(g=o(o(y)),g!==Object.prototype&&(v=g)):p=!0),v==null&&(v={}),!f&&!c(v,h)&&l(v,h,m),s.exports={IteratorPrototype:v,BUGGY_SAFARI_ITERATORS:p}},b041:function(s,i,a){var o=a("00ee"),l=a("f5df");s.exports=o?{}.toString:function(){return"[object "+l(this)+"]"}},b0c0:function(s,i,a){var o=a("83ab"),l=a("9bf2").f,c=Function.prototype,u=c.toString,f=/^\s*function ([^ (]*)/,h="name";o&&!(h in c)&&l(c,h,{configurable:!0,get:function(){try{return u.call(this).match(f)[1]}catch{return""}}})},b622:function(s,i,a){var o=a("da84"),l=a("5692"),c=a("5135"),u=a("90e3"),f=a("4930"),h=a("fdbf"),p=l("wks"),m=o.Symbol,v=h?m:m&&m.withoutSetter||u;s.exports=function(g){return c(p,g)||(f&&c(m,g)?p[g]=m[g]:p[g]=v("Symbol."+g)),p[g]}},b64b:function(s,i,a){var o=a("23e7"),l=a("7b0b"),c=a("df75"),u=a("d039"),f=u(function(){c(1)});o({target:"Object",stat:!0,forced:f},{keys:function(p){return c(l(p))}})},b727:function(s,i,a){var o=a("0366"),l=a("44ad"),c=a("7b0b"),u=a("50c4"),f=a("65f0"),h=[].push,p=function(m){var v=m==1,g=m==2,y=m==3,E=m==4,b=m==6,k=m==5||b;return function(P,w,x,S){for(var _=c(P),A=l(_),C=o(w,x,3),T=u(A.length),D=0,V=S||f,B=v?V(P,T):g?V(P,0):void 0,R,F;T>D;D++)if((k||D in A)&&(R=A[D],F=C(R,D,_),m)){if(v)B[D]=F;else if(F)switch(m){case 3:return!0;case 5:return R;case 6:return D;case 2:h.call(B,R)}else if(E)return!1}return b?-1:y||E?E:B}};s.exports={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6)}},c04e:function(s,i,a){var o=a("861d");s.exports=function(l,c){if(!o(l))return l;var u,f;if(c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l))||typeof(u=l.valueOf)=="function"&&!o(f=u.call(l))||!c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l)))return f;throw TypeError("Can't convert object to primitive value")}},c430:function(s,i){s.exports=!1},c6b6:function(s,i){var a={}.toString;s.exports=function(o){return a.call(o).slice(8,-1)}},c6cd:function(s,i,a){var o=a("da84"),l=a("ce4e"),c="__core-js_shared__",u=o[c]||l(c,{});s.exports=u},c740:function(s,i,a){var o=a("23e7"),l=a("b727").findIndex,c=a("44d2"),u=a("ae40"),f="findIndex",h=!0,p=u(f);f in[]&&Array(1)[f](function(){h=!1}),o({target:"Array",proto:!0,forced:h||!p},{findIndex:function(v){return l(this,v,arguments.length>1?arguments[1]:void 0)}}),c(f)},c8ba:function(s,i){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}s.exports=a},c975:function(s,i,a){var o=a("23e7"),l=a("4d64").indexOf,c=a("a640"),u=a("ae40"),f=[].indexOf,h=!!f&&1/[1].indexOf(1,-0)<0,p=c("indexOf"),m=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:h||!p||!m},{indexOf:function(g){return h?f.apply(this,arguments)||0:l(this,g,arguments.length>1?arguments[1]:void 0)}})},ca84:function(s,i,a){var o=a("5135"),l=a("fc6a"),c=a("4d64").indexOf,u=a("d012");s.exports=function(f,h){var p=l(f),m=0,v=[],g;for(g in p)!o(u,g)&&o(p,g)&&v.push(g);for(;h.length>m;)o(p,g=h[m++])&&(~c(v,g)||v.push(g));return v}},caad:function(s,i,a){var o=a("23e7"),l=a("4d64").includes,c=a("44d2"),u=a("ae40"),f=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!f},{includes:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}}),c("includes")},cc12:function(s,i,a){var o=a("da84"),l=a("861d"),c=o.document,u=l(c)&&l(c.createElement);s.exports=function(f){return u?c.createElement(f):{}}},ce4e:function(s,i,a){var o=a("da84"),l=a("9112");s.exports=function(c,u){try{l(o,c,u)}catch{o[c]=u}return u}},d012:function(s,i){s.exports={}},d039:function(s,i){s.exports=function(a){try{return!!a()}catch{return!0}}},d066:function(s,i,a){var o=a("428f"),l=a("da84"),c=function(u){return typeof u=="function"?u:void 0};s.exports=function(u,f){return arguments.length<2?c(o[u])||c(l[u]):o[u]&&o[u][f]||l[u]&&l[u][f]}},d1e7:function(s,i,a){var o={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c=l&&!o.call({1:2},1);i.f=c?function(f){var h=l(this,f);return!!h&&h.enumerable}:o},d28b:function(s,i,a){var o=a("746f");o("iterator")},d2bb:function(s,i,a){var o=a("825a"),l=a("3bbe");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,u={},f;try{f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,f.call(u,[]),c=u instanceof Array}catch{}return function(p,m){return o(p),l(m),c?f.call(p,m):p.__proto__=m,p}}():void 0)},d3b7:function(s,i,a){var o=a("00ee"),l=a("6eeb"),c=a("b041");o||l(Object.prototype,"toString",c,{unsafe:!0})},d44e:function(s,i,a){var o=a("9bf2").f,l=a("5135"),c=a("b622"),u=c("toStringTag");s.exports=function(f,h,p){f&&!l(f=p?f:f.prototype,u)&&o(f,u,{configurable:!0,value:h})}},d58f:function(s,i,a){var o=a("1c0b"),l=a("7b0b"),c=a("44ad"),u=a("50c4"),f=function(h){return function(p,m,v,g){o(m);var y=l(p),E=c(y),b=u(y.length),k=h?b-1:0,P=h?-1:1;if(v<2)for(;;){if(k in E){g=E[k],k+=P;break}if(k+=P,h?k<0:b<=k)throw TypeError("Reduce of empty array with no initial value")}for(;h?k>=0:b>k;k+=P)k in E&&(g=m(g,E[k],k,y));return g}};s.exports={left:f(!1),right:f(!0)}},d784:function(s,i,a){a("ac1f");var o=a("6eeb"),l=a("d039"),c=a("b622"),u=a("9263"),f=a("9112"),h=c("species"),p=!l(function(){var E=/./;return E.exec=function(){var b=[];return b.groups={a:"7"},b},"".replace(E,"$<a>")!=="7"}),m=function(){return"a".replace(/./,"$0")==="$0"}(),v=c("replace"),g=function(){return/./[v]?/./[v]("a","$0")==="":!1}(),y=!l(function(){var E=/(?:)/,b=E.exec;E.exec=function(){return b.apply(this,arguments)};var k="ab".split(E);return k.length!==2||k[0]!=="a"||k[1]!=="b"});s.exports=function(E,b,k,P){var w=c(E),x=!l(function(){var D={};return D[w]=function(){return 7},""[E](D)!=7}),S=x&&!l(function(){var D=!1,V=/a/;return E==="split"&&(V={},V.constructor={},V.constructor[h]=function(){return V},V.flags="",V[w]=/./[w]),V.exec=function(){return D=!0,null},V[w](""),!D});if(!x||!S||E==="replace"&&!(p&&m&&!g)||E==="split"&&!y){var _=/./[w],A=k(w,""[E],function(D,V,B,R,F){return V.exec===u?x&&!F?{done:!0,value:_.call(V,B,R)}:{done:!0,value:D.call(B,V,R)}:{done:!1}},{REPLACE_KEEPS_$0:m,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:g}),C=A[0],T=A[1];o(String.prototype,E,C),o(RegExp.prototype,w,b==2?function(D,V){return T.call(D,this,V)}:function(D){return T.call(D,this)})}P&&f(RegExp.prototype[w],"sham",!0)}},d81d:function(s,i,a){var o=a("23e7"),l=a("b727").map,c=a("1dde"),u=a("ae40"),f=c("map"),h=u("map");o({target:"Array",proto:!0,forced:!f||!h},{map:function(m){return l(this,m,arguments.length>1?arguments[1]:void 0)}})},da84:function(s,i,a){(function(o){var l=function(c){return c&&c.Math==Math&&c};s.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof o=="object"&&o)||Function("return this")()}).call(this,a("c8ba"))},dbb4:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("56ef"),u=a("fc6a"),f=a("06cf"),h=a("8418");o({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(m){for(var v=u(m),g=f.f,y=c(v),E={},b=0,k,P;y.length>b;)P=g(v,k=y[b++]),P!==void 0&&h(E,k,P);return E}})},dbf1:function(s,i,a){(function(o){a.d(i,"a",function(){return c});function l(){return typeof window<"u"?window.console:o.console}var c=l()}).call(this,a("c8ba"))},ddb0:function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("e260"),u=a("9112"),f=a("b622"),h=f("iterator"),p=f("toStringTag"),m=c.values;for(var v in l){var g=o[v],y=g&&g.prototype;if(y){if(y[h]!==m)try{u(y,h,m)}catch{y[h]=m}if(y[p]||u(y,p,v),l[v]){for(var E in c)if(y[E]!==c[E])try{u(y,E,c[E])}catch{y[E]=c[E]}}}}},df75:function(s,i,a){var o=a("ca84"),l=a("7839");s.exports=Object.keys||function(u){return o(u,l)}},e01a:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("da84"),u=a("5135"),f=a("861d"),h=a("9bf2").f,p=a("e893"),m=c.Symbol;if(l&&typeof m=="function"&&(!("description"in m.prototype)||m().description!==void 0)){var v={},g=function(){var w=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),x=this instanceof g?new m(w):w===void 0?m():m(w);return w===""&&(v[x]=!0),x};p(g,m);var y=g.prototype=m.prototype;y.constructor=g;var E=y.toString,b=String(m("test"))=="Symbol(test)",k=/^Symbol\((.*)\)[^)]+$/;h(y,"description",{configurable:!0,get:function(){var w=f(this)?this.valueOf():this,x=E.call(w);if(u(v,w))return"";var S=b?x.slice(7,-1):x.replace(k,"$1");return S===""?void 0:S}}),o({global:!0,forced:!0},{Symbol:g})}},e163:function(s,i,a){var o=a("5135"),l=a("7b0b"),c=a("f772"),u=a("e177"),f=c("IE_PROTO"),h=Object.prototype;s.exports=u?Object.getPrototypeOf:function(p){return p=l(p),o(p,f)?p[f]:typeof p.constructor=="function"&&p instanceof p.constructor?p.constructor.prototype:p instanceof Object?h:null}},e177:function(s,i,a){var o=a("d039");s.exports=!o(function(){function l(){}return l.prototype.constructor=null,Object.getPrototypeOf(new l)!==l.prototype})},e260:function(s,i,a){var o=a("fc6a"),l=a("44d2"),c=a("3f8c"),u=a("69f3"),f=a("7dd0"),h="Array Iterator",p=u.set,m=u.getterFor(h);s.exports=f(Array,"Array",function(v,g){p(this,{type:h,target:o(v),index:0,kind:g})},function(){var v=m(this),g=v.target,y=v.kind,E=v.index++;return!g||E>=g.length?(v.target=void 0,{value:void 0,done:!0}):y=="keys"?{value:E,done:!1}:y=="values"?{value:g[E],done:!1}:{value:[E,g[E]],done:!1}},"values"),c.Arguments=c.Array,l("keys"),l("values"),l("entries")},e439:function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("fc6a"),u=a("06cf").f,f=a("83ab"),h=l(function(){u(1)}),p=!f||h;o({target:"Object",stat:!0,forced:p,sham:!f},{getOwnPropertyDescriptor:function(v,g){return u(c(v),g)}})},e538:function(s,i,a){var o=a("b622");i.f=o},e893:function(s,i,a){var o=a("5135"),l=a("56ef"),c=a("06cf"),u=a("9bf2");s.exports=function(f,h){for(var p=l(h),m=u.f,v=c.f,g=0;g<p.length;g++){var y=p[g];o(f,y)||m(f,y,v(h,y))}}},e8b5:function(s,i,a){var o=a("c6b6");s.exports=Array.isArray||function(c){return o(c)=="Array"}},e95a:function(s,i,a){var o=a("b622"),l=a("3f8c"),c=o("iterator"),u=Array.prototype;s.exports=function(f){return f!==void 0&&(l.Array===f||u[c]===f)}},f5df:function(s,i,a){var o=a("00ee"),l=a("c6b6"),c=a("b622"),u=c("toStringTag"),f=l(function(){return arguments}())=="Arguments",h=function(p,m){try{return p[m]}catch{}};s.exports=o?l:function(p){var m,v,g;return p===void 0?"Undefined":p===null?"Null":typeof(v=h(m=Object(p),u))=="string"?v:f?l(m):(g=l(m))=="Object"&&typeof m.callee=="function"?"Arguments":g}},f772:function(s,i,a){var o=a("5692"),l=a("90e3"),c=o("keys");s.exports=function(u){return c[u]||(c[u]=l(u))}},fb15:function(s,i,a){if(a.r(i),typeof window<"u"){var o=window.document.currentScript;{var l=a("8875");o=l(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:l})}var c=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(a.p=c[1])}a("99af"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("a434"),a("159b"),a("a4d3"),a("e439"),a("dbb4"),a("b64b");function u(Ee,ye,be){return ye in Ee?Object.defineProperty(Ee,ye,{value:be,enumerable:!0,configurable:!0,writable:!0}):Ee[ye]=be,Ee}function f(Ee,ye){var be=Object.keys(Ee);if(Object.getOwnPropertySymbols){var Oe=Object.getOwnPropertySymbols(Ee);ye&&(Oe=Oe.filter(function(je){return Object.getOwnPropertyDescriptor(Ee,je).enumerable})),be.push.apply(be,Oe)}return be}function h(Ee){for(var ye=1;ye<arguments.length;ye++){var be=arguments[ye]!=null?arguments[ye]:{};ye%2?f(Object(be),!0).forEach(function(Oe){u(Ee,Oe,be[Oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ee,Object.getOwnPropertyDescriptors(be)):f(Object(be)).forEach(function(Oe){Object.defineProperty(Ee,Oe,Object.getOwnPropertyDescriptor(be,Oe))})}return Ee}function p(Ee){if(Array.isArray(Ee))return Ee}a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function m(Ee,ye){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Ee)))){var be=[],Oe=!0,je=!1,lt=void 0;try{for(var gt=Ee[Symbol.iterator](),Et;!(Oe=(Et=gt.next()).done)&&(be.push(Et.value),!(ye&&be.length===ye));Oe=!0);}catch(jt){je=!0,lt=jt}finally{try{!Oe&&gt.return!=null&&gt.return()}finally{if(je)throw lt}}return be}}a("a630"),a("fb6a"),a("b0c0"),a("25f0");function v(Ee,ye){(ye==null||ye>Ee.length)&&(ye=Ee.length);for(var be=0,Oe=new Array(ye);be<ye;be++)Oe[be]=Ee[be];return Oe}function g(Ee,ye){if(Ee){if(typeof Ee=="string")return v(Ee,ye);var be=Object.prototype.toString.call(Ee).slice(8,-1);if(be==="Object"&&Ee.constructor&&(be=Ee.constructor.name),be==="Map"||be==="Set")return Array.from(Ee);if(be==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(be))return v(Ee,ye)}}function y(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E(Ee,ye){return p(Ee)||m(Ee,ye)||g(Ee,ye)||y()}function b(Ee){if(Array.isArray(Ee))return v(Ee)}function k(Ee){if(typeof Symbol<"u"&&Symbol.iterator in Object(Ee))return Array.from(Ee)}function P(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(Ee){return b(Ee)||k(Ee)||g(Ee)||P()}var x=a("a352"),S=a.n(x);function _(Ee){Ee.parentElement!==null&&Ee.parentElement.removeChild(Ee)}function A(Ee,ye,be){var Oe=be===0?Ee.children[0]:Ee.children[be-1].nextSibling;Ee.insertBefore(ye,Oe)}var C=a("dbf1");a("13d5"),a("4fad"),a("ac1f"),a("5319");function T(Ee){var ye=Object.create(null);return function(Oe){var je=ye[Oe];return je||(ye[Oe]=Ee(Oe))}}var D=/-(\w)/g,V=T(function(Ee){return Ee.replace(D,function(ye,be){return be.toUpperCase()})});a("5db7"),a("73d9");var B=["Start","Add","Remove","Update","End"],R=["Choose","Unchoose","Sort","Filter","Clone"],F=["Move"],M=[F,B,R].flatMap(function(Ee){return Ee}).map(function(Ee){return"on".concat(Ee)}),O={manage:F,manageAndEmit:B,emit:R};function K(Ee){return M.indexOf(Ee)!==-1}a("caad"),a("2ca0");var j=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function H(Ee){return j.includes(Ee)}function W(Ee){return["transition-group","TransitionGroup"].includes(Ee)}function X(Ee){return["id","class","role","style"].includes(Ee)||Ee.startsWith("data-")||Ee.startsWith("aria-")||Ee.startsWith("on")}function re(Ee){return Ee.reduce(function(ye,be){var Oe=E(be,2),je=Oe[0],lt=Oe[1];return ye[je]=lt,ye},{})}function he(Ee){var ye=Ee.$attrs,be=Ee.componentData,Oe=be===void 0?{}:be,je=re(Object.entries(ye).filter(function(lt){var gt=E(lt,2),Et=gt[0];return gt[1],X(Et)}));return h(h({},je),Oe)}function ue(Ee){var ye=Ee.$attrs,be=Ee.callBackBuilder,Oe=re(pe(ye));Object.entries(be).forEach(function(lt){var gt=E(lt,2),Et=gt[0],jt=gt[1];O[Et].forEach(function(pt){Oe["on".concat(pt)]=jt(pt)})});var je="[data-draggable]".concat(Oe.draggable||"");return h(h({},Oe),{},{draggable:je})}function pe(Ee){return Object.entries(Ee).filter(function(ye){var be=E(ye,2),Oe=be[0];return be[1],!X(Oe)}).map(function(ye){var be=E(ye,2),Oe=be[0],je=be[1];return[V(Oe),je]}).filter(function(ye){var be=E(ye,2),Oe=be[0];return be[1],!K(Oe)})}a("c740");function q(Ee,ye){if(!(Ee instanceof ye))throw new TypeError("Cannot call a class as a function")}function G(Ee,ye){for(var be=0;be<ye.length;be++){var Oe=ye[be];Oe.enumerable=Oe.enumerable||!1,Oe.configurable=!0,"value"in Oe&&(Oe.writable=!0),Object.defineProperty(Ee,Oe.key,Oe)}}function oe(Ee,ye,be){return ye&&G(Ee.prototype,ye),Ee}var Q=function(ye){var be=ye.el;return be},Y=function(ye,be){return ye.__draggable_context=be},Z=function(ye){return ye.__draggable_context},ne=function(){function Ee(ye){var be=ye.nodes,Oe=be.header,je=be.default,lt=be.footer,gt=ye.root,Et=ye.realList;q(this,Ee),this.defaultNodes=je,this.children=[].concat(w(Oe),w(je),w(lt)),this.externalComponent=gt.externalComponent,this.rootTransition=gt.transition,this.tag=gt.tag,this.realList=Et}return oe(Ee,[{key:"render",value:function(be,Oe){var je=this.tag,lt=this.children,gt=this._isRootComponent,Et=gt?{default:function(){return lt}}:lt;return be(je,Oe,Et)}},{key:"updated",value:function(){var be=this.defaultNodes,Oe=this.realList;be.forEach(function(je,lt){Y(Q(je),{element:Oe[lt],index:lt})})}},{key:"getUnderlyingVm",value:function(be){return Z(be)}},{key:"getVmIndexFromDomIndex",value:function(be,Oe){var je=this.defaultNodes,lt=je.length,gt=Oe.children,Et=gt.item(be);if(Et===null)return lt;var jt=Z(Et);if(jt)return jt.index;if(lt===0)return 0;var pt=Q(je[0]),ut=w(gt).findIndex(function(mt){return mt===pt});return be<ut?0:lt}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),Ee}(),ge=a("8bbf");function ae(Ee,ye){var be=Ee[ye];return be?be():[]}function ce(Ee){var ye=Ee.$slots,be=Ee.realList,Oe=Ee.getKey,je=be||[],lt=["header","footer"].map(function(mt){return ae(ye,mt)}),gt=E(lt,2),Et=gt[0],jt=gt[1],pt=ye.item;if(!pt)throw new Error("draggable element must have an item slot");var ut=je.flatMap(function(mt,Dt){return pt({element:mt,index:Dt}).map(function(Ot){return Ot.key=Oe(mt),Ot.props=h(h({},Ot.props||{}),{},{"data-draggable":!0}),Ot})});if(ut.length!==je.length)throw new Error("Item slot must have only one child");return{header:Et,footer:jt,default:ut}}function fe(Ee){var ye=W(Ee),be=!H(Ee)&&!ye;return{transition:ye,externalComponent:be,tag:be?Object(ge.resolveComponent)(Ee):ye?ge.TransitionGroup:Ee}}function Ae(Ee){var ye=Ee.$slots,be=Ee.tag,Oe=Ee.realList,je=Ee.getKey,lt=ce({$slots:ye,realList:Oe,getKey:je}),gt=fe(be);return new ne({nodes:lt,root:gt,realList:Oe})}function Ie(Ee,ye){var be=this;Object(ge.nextTick)(function(){return be.$emit(Ee.toLowerCase(),ye)})}function Te(Ee){var ye=this;return function(be,Oe){if(ye.realList!==null)return ye["onDrag".concat(Ee)](be,Oe)}}function Ge(Ee){var ye=this,be=Te.call(this,Ee);return function(Oe,je){be.call(ye,Oe,je),Ie.call(ye,Ee,Oe)}}var ke=null,$e={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(ye){return ye}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Be=["update:modelValue","change"].concat(w([].concat(w(O.manageAndEmit),w(O.emit)).map(function(Ee){return Ee.toLowerCase()}))),We=Object(ge.defineComponent)({name:"draggable",inheritAttrs:!1,props:$e,emits:Be,data:function(){return{error:!1}},render:function(){try{this.error=!1;var ye=this.$slots,be=this.$attrs,Oe=this.tag,je=this.componentData,lt=this.realList,gt=this.getKey,Et=Ae({$slots:ye,tag:Oe,realList:lt,getKey:gt});this.componentStructure=Et;var jt=he({$attrs:be,componentData:je});return Et.render(ge.h,jt)}catch(pt){return this.error=!0,Object(ge.h)("pre",{style:{color:"red"}},pt.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&C.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var ye=this;if(!this.error){var be=this.$attrs,Oe=this.$el,je=this.componentStructure;je.updated();var lt=ue({$attrs:be,callBackBuilder:{manageAndEmit:function(jt){return Ge.call(ye,jt)},emit:function(jt){return Ie.bind(ye,jt)},manage:function(jt){return Te.call(ye,jt)}}}),gt=Oe.nodeType===1?Oe:Oe.parentElement;this._sortable=new S.a(gt,lt),this.targetDomElement=gt,gt.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var ye=this.list;return ye||this.modelValue},getKey:function(){var ye=this.itemKey;return typeof ye=="function"?ye:function(be){return be[ye]}}},watch:{$attrs:{handler:function(ye){var be=this._sortable;be&&pe(ye).forEach(function(Oe){var je=E(Oe,2),lt=je[0],gt=je[1];be.option(lt,gt)})},deep:!0}},methods:{getUnderlyingVm:function(ye){return this.componentStructure.getUnderlyingVm(ye)||null},getUnderlyingPotencialDraggableComponent:function(ye){return ye.__draggable_component__},emitChanges:function(ye){var be=this;Object(ge.nextTick)(function(){return be.$emit("change",ye)})},alterList:function(ye){if(this.list){ye(this.list);return}var be=w(this.modelValue);ye(be),this.$emit("update:modelValue",be)},spliceList:function(){var ye=arguments,be=function(je){return je.splice.apply(je,w(ye))};this.alterList(be)},updatePosition:function(ye,be){var Oe=function(lt){return lt.splice(be,0,lt.splice(ye,1)[0])};this.alterList(Oe)},getRelatedContextFromMoveEvent:function(ye){var be=ye.to,Oe=ye.related,je=this.getUnderlyingPotencialDraggableComponent(be);if(!je)return{component:je};var lt=je.realList,gt={list:lt,component:je};if(be!==Oe&&lt){var Et=je.getUnderlyingVm(Oe)||{};return h(h({},Et),gt)}return gt},getVmIndexFromDomIndex:function(ye){return this.componentStructure.getVmIndexFromDomIndex(ye,this.targetDomElement)},onDragStart:function(ye){this.context=this.getUnderlyingVm(ye.item),ye.item._underlying_vm_=this.clone(this.context.element),ke=ye.item},onDragAdd:function(ye){var be=ye.item._underlying_vm_;if(be!==void 0){_(ye.item);var Oe=this.getVmIndexFromDomIndex(ye.newIndex);this.spliceList(Oe,0,be);var je={element:be,newIndex:Oe};this.emitChanges({added:je})}},onDragRemove:function(ye){if(A(this.$el,ye.item,ye.oldIndex),ye.pullMode==="clone"){_(ye.clone);return}var be=this.context,Oe=be.index,je=be.element;this.spliceList(Oe,1);var lt={element:je,oldIndex:Oe};this.emitChanges({removed:lt})},onDragUpdate:function(ye){_(ye.item),A(ye.from,ye.item,ye.oldIndex);var be=this.context.index,Oe=this.getVmIndexFromDomIndex(ye.newIndex);this.updatePosition(be,Oe);var je={element:this.context.element,oldIndex:be,newIndex:Oe};this.emitChanges({moved:je})},computeFutureIndex:function(ye,be){if(!ye.element)return 0;var Oe=w(be.to.children).filter(function(Et){return Et.style.display!=="none"}),je=Oe.indexOf(be.related),lt=ye.component.getVmIndexFromDomIndex(je),gt=Oe.indexOf(ke)!==-1;return gt||!be.willInsertAfter?lt:lt+1},onDragMove:function(ye,be){var Oe=this.move,je=this.realList;if(!Oe||!je)return!0;var lt=this.getRelatedContextFromMoveEvent(ye),gt=this.computeFutureIndex(lt,ye),Et=h(h({},this.context),{},{futureIndex:gt}),jt=h(h({},ye),{},{relatedContext:lt,draggedContext:Et});return Oe(jt,be)},onDragEnd:function(){ke=null}}}),Ke=We;i.default=Ke},fb6a:function(s,i,a){var o=a("23e7"),l=a("861d"),c=a("e8b5"),u=a("23cb"),f=a("50c4"),h=a("fc6a"),p=a("8418"),m=a("b622"),v=a("1dde"),g=a("ae40"),y=v("slice"),E=g("slice",{ACCESSORS:!0,0:0,1:2}),b=m("species"),k=[].slice,P=Math.max;o({target:"Array",proto:!0,forced:!y||!E},{slice:function(x,S){var _=h(this),A=f(_.length),C=u(x,A),T=u(S===void 0?A:S,A),D,V,B;if(c(_)&&(D=_.constructor,typeof D=="function"&&(D===Array||c(D.prototype))?D=void 0:l(D)&&(D=D[b],D===null&&(D=void 0)),D===Array||D===void 0))return k.call(_,C,T);for(V=new(D===void 0?Array:D)(P(T-C,0)),B=0;C<T;C++,B++)C in _&&p(V,B,_[C]);return V.length=B,V}})},fc6a:function(s,i,a){var o=a("44ad"),l=a("1d80");s.exports=function(c){return o(l(c))}},fdbc:function(s,i){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(s,i,a){var o=a("4930");s.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(cae);const qae={class:"assignment-dialog-modal"},Xae={class:"form-row"},Yae={key:0,class:"form-row"},Qae=["value"],Jae={key:1,class:"form-row"},Zae=["value"],eie={key:2,class:"form-row"},tie={class:"form-row"},rie={class:"form-row"},nie={class:"form-row"},sie={class:"dialog-actions"},aie={__name:"AssignmentDialog",props:{teachers:Array,students:Array,assignment:Object},emits:["save","close"],setup(t,{emit:e}){const r=t,n=e,s=se("lunch"),i=se(""),a=se(""),o=se(""),l=se("12:00"),c=se("12:30"),u=se(""),f=se(""),h=se("");Vt(()=>r.assignment,v=>{v?(f.value=v.id||Date.now().toString(),h.value=v.blockId||f.value||`block-${Date.now()}`,s.value=v.type||"lunch",i.value=v.teacherId||"",a.value=v.studentId||"",o.value=v.type==="other"?v.label:"",l.value=v.start||"12:00",c.value=v.end||"12:30",u.value=v.note||""):(f.value=Date.now().toString(),h.value=`block-${f.value}`,s.value="lunch",i.value="",a.value="",o.value="",l.value="12:00",c.value="12:30",u.value="")},{immediate:!0});const p=Se(()=>{if(s.value==="lunch")return"Lunch";if(s.value==="break")return"Break";if(s.value==="class"){const v=r.teachers.find(g=>g.id===i.value);return v?v.name||v.email||v.id:""}if(s.value==="student"){const v=r.students.find(g=>g.id===a.value);return v?`${v.firstName} ${v.lastName}`:""}return s.value==="other"?o.value:""});function m(){!l.value||!c.value||s.value==="class"&&!i.value||s.value==="student"&&!a.value||s.value==="other"&&!o.value||n("save",{id:f.value,blockId:h.value,type:s.value,label:p.value,start:l.value,end:c.value,note:u.value,teacherId:i.value,studentId:a.value})}return(v,g)=>(N(),L("div",{class:"assignment-dialog-overlay",onClick:g[8]||(g[8]=dn(y=>v.$emit("close"),["self"]))},[d("div",qae,[g[20]||(g[20]=d("h2",null,"Add Assignment",-1)),d("form",{onSubmit:dn(m,["prevent"])},[d("div",Xae,[g[10]||(g[10]=d("label",null,"Type:",-1)),we(d("select",{"onUpdate:modelValue":g[0]||(g[0]=y=>s.value=y)},g[9]||(g[9]=[Fr('<option value="lunch" data-v-f2af98a0>Lunch</option><option value="break" data-v-f2af98a0>Break</option><option value="class" data-v-f2af98a0>Class</option><option value="student" data-v-f2af98a0>Student</option><option value="other" data-v-f2af98a0>Other</option>',5)]),512),[[ur,s.value]])]),s.value==="class"?(N(),L("div",Yae,[g[12]||(g[12]=d("label",null,"Teacher:",-1)),we(d("select",{"onUpdate:modelValue":g[1]||(g[1]=y=>i.value=y)},[g[11]||(g[11]=d("option",{value:""},"Select teacher...",-1)),(N(!0),L(Re,null,Ve(t.teachers,y=>(N(),L("option",{key:y.id,value:y.id},J(y.name||y.email||y.id),9,Qae))),128))],512),[[ur,i.value]])])):_e("",!0),s.value==="student"?(N(),L("div",Jae,[g[14]||(g[14]=d("label",null,"Student:",-1)),we(d("select",{"onUpdate:modelValue":g[2]||(g[2]=y=>a.value=y)},[g[13]||(g[13]=d("option",{value:""},"Select student...",-1)),(N(!0),L(Re,null,Ve(t.students,y=>(N(),L("option",{key:y.id,value:y.id},J(y.firstName)+" "+J(y.lastName),9,Zae))),128))],512),[[ur,a.value]])])):_e("",!0),s.value==="other"?(N(),L("div",eie,[g[15]||(g[15]=d("label",null,"Label:",-1)),we(d("input",{"onUpdate:modelValue":g[3]||(g[3]=y=>o.value=y),placeholder:"Custom label"},null,512),[[Ye,o.value]])])):_e("",!0),d("div",tie,[g[16]||(g[16]=d("label",null,"Start Time:",-1)),we(d("input",{"onUpdate:modelValue":g[4]||(g[4]=y=>l.value=y),type:"time",required:""},null,512),[[Ye,l.value]])]),d("div",rie,[g[17]||(g[17]=d("label",null,"End Time:",-1)),we(d("input",{"onUpdate:modelValue":g[5]||(g[5]=y=>c.value=y),type:"time",required:""},null,512),[[Ye,c.value]])]),d("div",nie,[g[18]||(g[18]=d("label",null,"Note:",-1)),we(d("input",{"onUpdate:modelValue":g[6]||(g[6]=y=>u.value=y),placeholder:"Optional note"},null,512),[[Ye,u.value]])]),d("div",sie,[g[19]||(g[19]=d("button",{type:"submit",class:"btn btn-primary"},"Add",-1)),d("button",{type:"button",class:"btn btn-secondary",onClick:g[7]||(g[7]=y=>v.$emit("close"))},"Cancel")])],32)])]))}},iie=yt(aie,[["__scopeId","data-v-f2af98a0"]]),oie={class:"vertical-time-grid-wrapper"},lie={class:"grid-block-label-time"},cie=["title"],uie=["title"],die=["onDragstart","onDrag","onDragend"],fie={class:"assignment-content"},hie={class:"assignment-label-time"},pie={class:"assignment-time-label"},mie={class:"assignment-actions"},gie=["onClick"],vie=["onClick"],xie=["onMousedown"],w2=24,yie={__name:"VerticalTimeGrid",props:{assignments:Array,teachers:Array,students:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,blocks:Array},emits:["update:assignments","edit-assignment"],setup(t,{emit:e}){const r=t,n=e,s=se(null);se(!1);const i=se(r.assignments?r.assignments.map(R=>({...R})):[]);Vt(()=>r.assignments,R=>{i.value=R?R.map(F=>({...F})):[]},{immediate:!0});function a(R){const[F,M]=R.split(":").map(Number);return F*60+M}function o(R){const F=Math.floor(R/60),M=R%60;return`${F<10?"0":""}${F}:${M<10?"0":""}${M}`}const l=Se(()=>!r.blocks||r.blocks.length===0?"08:00":r.blocks.reduce((R,F)=>F.startTime<R?F.startTime:R,r.blocks[0].startTime)),c=Se(()=>!r.blocks||r.blocks.length===0?"16:00":r.blocks.reduce((R,F)=>F.endTime>R?F.endTime:R,r.blocks[0].endTime)),u=Se(()=>a(l.value)),f=Se(()=>a(c.value)),h=Se(()=>f.value-u.value),p=Se(()=>h.value*2.5+w2*2);Se(()=>{if(!r.blocks)return[];const R=[];return r.blocks.forEach(F=>{R.includes(F.startTime)||R.push(F.startTime),R.includes(F.endTime)||R.push(F.endTime)}),R.sort((F,M)=>a(F)-a(M))});function m(R){return(a(R)-u.value)*2.5+w2-10}function v(R,F){if(!R||!F)return!1;const M=a(R.startTime),O=a(R.endTime),K=a(F.startTime),j=a(F.endTime);return M<j&&O>K}function g(R){const F=[];for(let O=0;O<R.length;O++){const K=R[O];let j=null;for(let H=0;H<F.length;H++)if(F[H].ids.some(W=>v(K,R.find(X=>X.id===W)))){j=F[H];break}j?(j.ids.push(K.id),j.blocks.push(K)):F.push({ids:[K.id],blocks:[K]})}let M=!0;for(;M;){M=!1;for(let O=0;O<F.length;O++){for(let K=O+1;K<F.length;K++)if(F[O].ids.some(j=>F[K].ids.some(H=>v(R.find(W=>W.id===j),R.find(W=>W.id===H))))){F[O].ids=Array.from(new Set([...F[O].ids,...F[K].ids])),F[O].blocks=Array.from(new Set([...F[O].blocks,...F[K].blocks])),F.splice(K,1),M=!0;break}if(M)break}}return F.map(O=>{const K=O.blocks.sort((W,X)=>W.startTime.localeCompare(X.startTime)||W.id.localeCompare(X.id)),j=K.reduce((W,X)=>X.startTime<W?X.startTime:W,K[0].startTime),H=K.reduce((W,X)=>X.endTime>W?X.endTime:W,K[0].endTime);return{ids:O.ids,startTime:j,endTime:H}})}Se(()=>g(y.value));const y=Se(()=>(r.blocks||[]).map((R,F)=>({...R,id:R.id||`block-${F}`})));function E(R){const F=[];for(let K=0;K<R.length;K++){const j=R[K];let H=null;for(let W=0;W<F.length;W++)if(F[W].some(X=>v(j,R.find(re=>re.id===X)))){H=F[W];break}H?H.push(j.id):F.push([j.id])}let M=!0;for(;M;){M=!1;for(let K=0;K<F.length;K++){for(let j=K+1;j<F.length;j++)if(F[K].some(H=>F[j].some(W=>v(R.find(X=>X.id===H),R.find(X=>X.id===W))))){F[K]=Array.from(new Set([...F[K],...F[j]])),F.splice(j,1),M=!0;break}if(M)break}}const O={};for(const K of F){const j=K.map(H=>R.find(W=>W.id===H)).sort((H,W)=>H.startTime.localeCompare(W.startTime)||H.id.localeCompare(W.id));j.forEach((H,W)=>{O[H.id]={groupSize:j.length,colIndex:W}})}return O}function b(R,F){const M=E(y.value)[R.id]||{groupSize:1,colIndex:0},O=m(R.startTime),K=(a(R.endTime)-a(R.startTime))*2.5,j=100/M.groupSize;return{position:"absolute",left:j*M.colIndex+"%",width:j+"%",top:O+"px",height:K+"px",zIndex:1,opacity:.38,boxSizing:"border-box",overflow:"hidden"}}function k(R,F){const M=i.value.filter((q,G)=>{if(q.id===R.id)return!1;const oe=a(q.start),Q=a(q.end),Y=a(R.start),Z=a(R.end);return oe<Z&&Q>Y}),O=M.length+1,j=[R,...M].sort((q,G)=>q.start.localeCompare(G.start)||q.id.localeCompare(G.id)).findIndex(q=>q.id===R.id),H=m(R.start),W=(a(R.end)-a(R.start))*2.5,X=Math.max(W,2.5),re=73,he=27,ue=re/O;return{position:"absolute",left:he+ue*j+"%",width:ue+"%",top:H+"px",height:X+"px",zIndex:2,minWidth:"80px",boxSizing:"border-box",padding:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",cursor:"grab",transition:"top 0.2s, height 0.2s"}}const P=se(null),w=se(0),x=se(0),S=se(null);function _(R,F){P.value=F,w.value=R.clientY,x.value=a(F.start),S.value="move",F.isDragging=!0,R.target.classList.add("background-dragging-div");const O=document.createElement("div");O.className="drag-preview-div",O.style.width="160px",O.style.height="40px",O.style.background="transparent",O.style.border="2px solid #007bff",O.style.position="absolute",O.style.top="-9999px",O.style.left="-9999px",document.body.appendChild(O),R.dataTransfer.setDragImage(O,80,20),R.dataTransfer.effectAllowed="move",R.dataTransfer.setData("text/plain",F.id)}function A(R,F){if(!P.value||R.clientY===0)return;const M=R.clientY-w.value,O=Math.round(M/2.5);if(S.value==="move"){let K=x.value+O,j=K+(a(F.end)-a(F.start));K=Math.max(u.value,Math.min(K,f.value-1)),j=Math.max(K+1,Math.min(j,f.value)),F.start=o(K),F.end=o(j)}}function C(R,F){P.value=null,S.value=null,F.isDragging=!1,n("update:assignments",i.value)}function T(R,F){P.value=F,w.value=R.clientY,x.value=a(F.end),S.value="resize",window.addEventListener("mousemove",D),window.addEventListener("mouseup",V)}function D(R){if(!P.value)return;const F=R.clientY-w.value;let M=x.value+Math.round(F/2.5);const O=a(P.value.start);M=Math.max(O+1,Math.min(M,f.value)),P.value.end=o(M)}function V(R){P.value=null,S.value=null,window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",V)}function B(R){const F=i.value.findIndex(M=>M.id===R);F!==-1&&(i.value.splice(F,1),n("update:assignments",i.value))}return(R,F)=>(N(),L("div",oie,[d("div",{class:"vertical-time-grid",ref_key:"timeGridRef",ref:s,style:as({position:"relative",height:p.value+"px"})},[(N(!0),L(Re,null,Ve(y.value,(M,O)=>(N(),L("div",{key:M.id,class:Qe(["grid-block-bg",M.type==="period"?"blocktype-period":"blocktype-"+(M.type||"period")]),style:as(b(M))},[d("div",lie,[d("span",{class:"grid-block-label",title:M.name||(M.type==="period"?M.label||M.periodName||M.periodNumber||"Period":M.type?M.type.charAt(0).toUpperCase()+M.type.slice(1):"")},J(M.name||(M.type==="period"?M.label||M.periodName||M.periodNumber||"Period":M.type?M.type.charAt(0).toUpperCase()+M.type.slice(1):"")),9,cie),d("span",{class:"grid-block-time",title:M.startTime},J(M.startTime),9,uie)])],6))),128)),(N(!0),L(Re,null,Ve(i.value,(M,O)=>(N(),L("div",{key:M.id,class:Qe(["dialog-assignment-box",["type-"+(M.type||"other"),{dragging:M.isDragging}]]),style:as(k(M)),draggable:"true",onDragstart:K=>_(K,M),onDrag:K=>A(K,M),onDragend:K=>C(K,M)},[d("div",fie,[d("div",hie,[d("span",pie,J(M.start)+"–"+J(M.end)+" "+J(M.label),1)])]),d("div",mie,[d("button",{class:"edit-btn",onClick:K=>R.$emit("edit-assignment",M)},"✏️",8,gie),d("button",{class:"delete-btn",onClick:K=>B(M.id)},"🗑️",8,vie)]),d("div",{class:"resize-handle",onMousedown:dn(K=>T(K,M),["stop"]),title:"Drag to resize block"},null,40,xie)],46,die))),128))],4)]))}},Eie=yt(yie,[["__scopeId","data-v-8f5880e4"]]),_ie={class:"dialog-header"},bie={class:"dialog-header-actions"},Sie={class:"dialog-content"},Aie={style:{display:"flex","align-items":"flex-start"}},Tie={class:"dialog-actions"},wie=["disabled"],Cie={key:0},Iie={key:1},kie={__name:"AideScheduleEditDialog",props:{aideName:String,timeTicks:Array,isTickInAnyBlock:Function,aideAssignments:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,showAddAssignment:Boolean,addAssignment:Function,onImportAssignments:Function,onSave:Function,onClose:Function,saving:Boolean,blocks:Array,teachers:Array,students:Array},setup(t){const e=t,r=se([]),n=se(!1),s=se(null);Ut(()=>{console.log("DEBUG: AideScheduleEditDialog mounted, blocks:",e.blocks)}),Vt(()=>e.blocks,f=>{console.log("DEBUG: props.blocks in AideScheduleEditDialog",f)});function i(){e.onSave(r.value)}function a(){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],n.value=!0}function o(f){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],s.value={...f},n.value=!0}function l(f){if(s.value){const h=r.value.findIndex(p=>p.id===f.id);h!==-1&&(r.value[h]={...f}),s.value=null}else r.value=[...r.value,f];n.value=!1}function c(){s.value=null,n.value=!1}function u(f){console.log("handleUpdateAssignments called with:",f),r.value=f}return(f,h)=>(N(),L("div",{class:"dialog-overlay",onClick:h[4]||(h[4]=(...p)=>t.onClose&&t.onClose(...p))},[d("div",{class:"edit-dialog",onClick:h[3]||(h[3]=dn(()=>{},["stop"]))},[d("div",_ie,[d("h2",null,"Edit Schedule: "+J(t.aideName),1),d("div",bie,[d("button",{onClick:h[0]||(h[0]=(...p)=>t.onImportAssignments&&t.onImportAssignments(...p)),class:"btn btn-secondary btn-import-assignments"},"Import Aide Assignments"),d("button",{onClick:a,class:"btn btn-primary btn-add-assignment"},"Add Assignment"),d("button",{onClick:h[1]||(h[1]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary close-btn"},"×")])]),d("div",Sie,[d("div",Aie,[nt(Eie,{timeTicks:t.timeTicks,isTickInAnyBlock:t.isTickInAnyBlock,assignments:r.value,getAssignmentBoxStyle:t.getAssignmentBoxStyle,onAssignmentDragStart:t.onAssignmentDragStart,onAssignmentDrag:t.onAssignmentDrag,onAssignmentDragEnd:t.onAssignmentDragEnd,onResizeStart:t.onResizeStart,blocks:t.blocks,onEditAssignment:o,"onUpdate:assignments":u},null,8,["timeTicks","isTickInAnyBlock","assignments","getAssignmentBoxStyle","onAssignmentDragStart","onAssignmentDrag","onAssignmentDragEnd","onResizeStart","blocks"])]),n.value?(N(),Kr(iie,{key:0,teachers:t.teachers,students:t.students,assignment:s.value,onSave:l,onClose:c},null,8,["teachers","students","assignment"])):_e("",!0)]),d("div",Tie,[d("button",{onClick:i,class:"btn btn-primary",disabled:t.saving},[t.saving?(N(),L("span",Cie,"💾")):(N(),L("span",Iie,"💾")),Ne(" "+J(t.saving?"Saving...":"Save Schedule"),1)],8,wie),d("button",{onClick:h[2]||(h[2]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary"},"Cancel")])])]))}},Die={class:"master-schedule"},Pie={key:0,class:"no-time-table"},Rie={class:"no-data-message"},Fie={key:1,class:"schedule-graph-container"},Nie={class:"timeline-header"},Oie={class:"block-time"},Mie={class:"block-name"},Lie={class:"block-time"},Bie={class:"aide-header"},Uie={class:"aide-name"},$ie=["onClick"],Vie={class:"time-line-container"},Hie={class:"time-blocks-background"},jie={class:"assignment-bars"},Gie={class:"assignment-label"},Tg=30,Wie={__name:"AideScheduleMasterTable",props:{paraeducators:Array,blocks:Array,getAideTimeBlocks:Function,getAideName:Function,currentTimeTable:Object},emits:["editAideAssignment","gotoTimeTableConfig"],setup(t,{emit:e}){const r=t,n=se([]);function s(y){const E=r.getAideTimeBlocks(y).filter(b=>b.assignment).map(b=>({id:b.id,label:b.assignment,type:b.assignmentType,start:b.start||b.displayTime.split(" - ")[0],end:b.end||b.displayTime.split(" - ")[1]}));return i(E)}function i(y){if(y.length===0)return[];const E=[...y].sort((w,x)=>f(w.start)-f(x.start)),b=[];let k=[];for(const w of E)k.length===0?k=[w]:k.some(S=>f(w.start)<f(S.end)&&f(w.end)>f(S.start))?k.push(w):(b.push(k),k=[w]);k.length>0&&b.push(k);const P=[];for(const w of b)w.forEach((x,S)=>{x.overlapIndex=S,x.overlapCount=w.length,P.push(x)});return P}function a(y){if(!y.overlapCount||y.overlapCount<=1)return 10;const E=40;return(60-(y.overlapCount*E+(y.overlapCount-1)*2))/2+y.overlapIndex*(E+2)}function o(y){if(!r.blocks||r.blocks.length===0)return 0;const E=r.blocks[0],b=r.blocks[r.blocks.length-1],k=f(E.startTime),w=f(b.endTime)-k,S=(f(y)-k)/w*100;return Math.max(0,Math.min(95,S))}function l(y,E){if(!r.blocks||r.blocks.length===0)return 10;const b=r.blocks[0],k=r.blocks[r.blocks.length-1],P=f(b.startTime),x=f(k.endTime)-P,S=f(y),A=(f(E)-S)/x*100;return Math.max(5,Math.min(95,A))}function c(y){if(!r.blocks||r.blocks.length===0)return 0;const E=r.blocks[0],b=r.blocks[r.blocks.length-1],k=f(E.startTime),w=f(b.endTime)-k,S=(f(y)-k)/w*100;return Math.max(0,Math.min(95,S))}function u(y,E){if(!r.blocks||r.blocks.length===0)return 10;const b=r.blocks[0],k=r.blocks[r.blocks.length-1],P=f(b.startTime),x=f(k.endTime)-P,S=f(y),A=(f(E)-S)/x*100;return Math.max(5,Math.min(95,A))}function f(y){const[E,b]=y.split(":").map(Number);return E*60+b}function h(y){var b;const E=((b=y.name)==null?void 0:b.toLowerCase())||"";return E.includes("lunch")?"lunch":E.includes("break")||E.includes("recess")?"break":E.includes("period")||E.includes("class")?"period":"other"}function p(y){const E=[...y].sort((P,w)=>f(P.startTime)-f(w.startTime)),b=[];for(const P of E){let w=!1;for(let x=0;x<b.length;x++){const S=b[x];if(!S.some(A=>f(P.startTime)<f(A.endTime)&&f(P.endTime)>f(A.startTime))){S.push(P),P.overlapIndex=x,w=!0;break}}w||(P.overlapIndex=b.length,b.push([P]))}const k=b.length;return E.map(P=>({...P,overlapIndex:P.overlapIndex,overlapCount:k}))}const m=Se(()=>p(r.blocks||[])),v=Se(()=>Math.max(...m.value.map(y=>y.overlapCount||1),1)),g=Se(()=>v.value*Tg);return Vt(()=>r.aideAssignments,y=>{n.value=y?JSON.parse(JSON.stringify(y)):[]},{immediate:!0}),(y,E)=>(N(),L("div",Die,[E[4]||(E[4]=d("h2",null,"Master Schedule View",-1)),bA(y.$slots,"tab-bar",{},void 0,!0),!t.currentTimeTable||!t.currentTimeTable.schedule||t.currentTimeTable.schedule.length===0?(N(),L("div",Pie,[d("div",Rie,[E[1]||(E[1]=d("h3",null,"No Time Table Configured",-1)),E[2]||(E[2]=d("p",null,"You need to configure a time table first before you can create aide assignments.",-1)),d("button",{onClick:E[0]||(E[0]=b=>y.$emit("gotoTimeTableConfig")),class:"btn btn-primary"}," Go to Time Table Configuration ")])])):(N(),L("div",Fie,[d("div",Nie,[E[3]||(E[3]=d("div",{class:"aide-name-header"},"Aide Name",-1)),d("div",{class:"timeline-container",style:as({height:g.value+"px"})},[d("div",{class:"time-blocks-header",style:as({height:g.value+"px"})},[(N(!0),L(Re,null,Ve(m.value,b=>(N(),L("div",{key:b.id+"-"+b.overlapIndex,class:Qe(["time-block-header",h(b)]),style:as({left:o(b.startTime)+"%",width:l(b.startTime,b.endTime)+"%",top:b.overlapIndex*Tg+"px",height:Tg+"px",zIndex:10})},[d("div",Oie,J(b.startTime),1),d("div",Mie,J(b.name||b.type),1),d("div",Lie,J(b.endTime),1)],6))),128))],4)],4)]),(N(!0),L(Re,null,Ve(t.paraeducators,b=>(N(),L("div",{key:b.id,class:"aide-row"},[d("div",Bie,[d("span",Uie,J(t.getAideName(b.id)),1),d("button",{onClick:k=>y.$emit("editAideAssignment",b.id),class:"btn btn-small btn-primary edit-btn"}," Edit ",8,$ie)]),d("div",Vie,[d("div",Hie,[(N(!0),L(Re,null,Ve(t.blocks,k=>(N(),L("div",{key:k.id,class:Qe(["time-block-bg",h(k)]),style:as({left:o(k.startTime)+"%",width:l(k.startTime,k.endTime)+"%"})},null,6))),128)),(N(!0),L(Re,null,Ve(t.blocks.slice(0,-1),(k,P)=>(N(),L("div",{key:`bg-gap-${k.id}`,class:"time-block-bg-gap",style:as({left:o(k.endTime)-.5+"%",width:"1%"})},null,4))),128))]),d("div",jie,[(N(!0),L(Re,null,Ve(s(b.id),k=>(N(),L("div",{key:k.id,class:Qe(["master-assignment-bar",k.type]),style:as({left:c(k.start)+"%",width:u(k.start,k.end)+"%",top:a(k)+"px"})},[d("span",Gie,J(k.label),1)],6))),128))])])]))),128))]))]))}},zie=yt(Wie,[["__scopeId","data-v-40c5158e"]]);function i0(t){return(t==null?void 0:t.schedule)||[]}function Kie(t){let e="23:59",r="00:00";for(const n of t)n.startTime&&n.startTime<e&&(e=n.startTime),n.endTime&&n.endTime>r&&(r=n.endTime);return{min:e,max:r}}function qie(t){return Se(()=>{const{min:e,max:r}=Kie(t.value||t),[n,s]=e.split(":").map(Number),[i,a]=r.split(":").map(Number);let o=[],l=n,c=s;for(;l<i||l===i&&c<=a;){const f=l<10?`0${l}`:`${l}`,h=c<10?`0${c}`:`${c}`;o.push({time:`${f}:${h}`}),c+=5,c>=60&&(c=0,l++)}const u=(t.value||t).map(f=>f.startTime);for(const f of u)o.find(h=>h.time===f)||o.push({time:f});return o=Array.from(new Set(o.map(f=>f.time))).sort().map(f=>({time:f})),o})}function Xie(t,e){return e.some(r=>r.startTime<=t&&r.endTime>=t)}const Yie={class:"admin-aide-schedule-detailed"},Qie={class:"header"},Jie={class:"header-actions"},Zie=["disabled"],eoe={key:0},toe={key:1},roe={class:"content"},noe={key:0,class:"error-message"},soe={key:1,class:"error-message"},aoe={key:2,class:"loading"},ioe={key:3,class:"schedule-container"},ooe={key:0,class:"time-table-tab-bar"},loe=["onClick"],Wk={__name:"AdminAideSchedule",setup(t){const e=wi(),r=xa(),{userList:n,fetchUsers:s}=ya(),{students:i,fetchStudents:a}=Ua(),{appSettings:o,loadAppSettings:l,saveAppSettings:c}=zs(),{labels:u}=xo(),{aideSchedule:f,loadAideSchedules:h,saveAideSchedule:p}=lae(),{aideAssignment:m}=Rx(),v=se(!0),g=se(!1),y=se(null),E=se({}),b=se({}),k=se(null);se([]);const P=se({}),w=Se(()=>E.value&&Array.isArray(E.value.timeTables)&&E.value.timeTables.length>0?E.value.timeTables.map((ce,fe)=>({id:ce.name?ce.name.toLowerCase().replace(/\s+/g,"-"):`tt-${fe}`,label:ce.name||`Time Table ${fe+1}`,...ce})):E.value&&E.value.schedule?[{id:"default",label:E.value.label||"Default Schedule",schedule:E.value.schedule}]:[]);Ut(async()=>{console.log("Loaded timeTableData:",E.value),console.log("Computed allTimeTables:",w.value),w.value.length>0&&!k.value&&(k.value=w.value[0].id,console.log("Set selectedTimeTable:",k.value)),await l(),o.value.timeTables&&Array.isArray(o.value.timeTables)?(E.value={timeTables:o.value.timeTables},console.log("Set timeTableData to timeTables array:",E.value)):o.value.schedule&&(E.value={schedule:o.value.schedule},console.log("Set timeTableData to single schedule:",E.value))}),Vt(w,ce=>{console.log("allTimeTables changed:",ce)}),Vt(k,ce=>{console.log("selectedTimeTable changed:",ce)});const x=Se(()=>{const ce=w.value.find(fe=>fe.id===k.value)||w.value[0];return console.log("currentTimeTable:",ce),ce}),S=Se(()=>i0(x.value)),_=qie(S);function A(ce){return Xie(ce,S.value)}const C=Se(()=>{var fe;const ce=(fe=r.currentUser)==null?void 0:fe.role;return["admin","school_admin","admin_504","sped_chair"].includes(ce)}),T=Se(()=>{var ce;return((ce=n.value)==null?void 0:ce.filter(fe=>fe.role==="paraeducator"))||[]}),D=Se(()=>{var ce;return((ce=n.value)==null?void 0:ce.filter(fe=>fe.role==="teacher"))||[]});Se(()=>u.value);function V(ce){if(!S.value)return[];console.log("DEBUG: getAideTimeBlocks called for aide:",ce),console.log("DEBUG: aideSchedule.value:",f.value),console.log("DEBUG: aideAssignment.value:",m.value);const Ae=(f.value[ce]||{}).schedule||{};console.log("DEBUG: aideScheduleData:",Ae);const Ie=Object.values(Ae).filter(Te=>Te.start&&Te.end&&Te.label).map(Te=>({id:Te.id||Te.blockId||`assignment-${Date.now()}`,assignment:Te.label,assignmentType:Te.type||"custom",displayTime:`${Te.start} - ${Te.end}`,start:Te.start,end:Te.end}));return console.log("DEBUG: individualAssignments:",Ie),Ie.length>0?Ie:(console.log("DEBUG: No individual assignments found, adding test data"),[{id:"test-1",assignment:"Test Class Assignment",assignmentType:"class",displayTime:"08:00 - 09:00",start:"08:00",end:"09:00"},{id:"test-2",assignment:"Test Student Assignment",assignmentType:"student",displayTime:"10:00 - 11:00",start:"10:00",end:"11:00"}])}function B(ce){const fe=T.value.find(Ae=>Ae.id===ce);return fe?fe.name||fe.email:"Unknown Aide"}function R(ce){y.value=ce,q.value=!0}function F(){y.value=null}async function M(){try{g.value=!0;const fe={...await l(),detailedAideSchedule:b.value};await c(fe),console.log("Detailed aide schedule saved successfully")}catch(ce){console.error("Error saving detailed aide schedule:",ce)}finally{g.value=!1}}function O(){e.push("/admin")}async function K(){try{v.value=!0,await Promise.all([s(),a(),l()]);const ce=await Jt(Ze(ze,"app_settings","global"));if(ce.exists()){const fe=ce.data();b.value=fe.detailedAideSchedule||{}}v.value=!1}catch(ce){console.error("Error loading aide schedule data:",ce),v.value=!1}}Ut(K);function j(ce,fe){return ce.assignments&&ce.assignments[fe]||""}function H(){var Te,Ge;if(console.log("DEBUG: handleImportAssignments called"),console.log("DEBUG: editingAideId.value:",y.value),console.log("DEBUG: aideAssignment.value:",m.value),console.log("DEBUG: All aide IDs:",Object.keys(m.value)),console.log("DEBUG: All aide data:",Object.entries(m.value).map(([ke,$e])=>({id:ke,keys:Object.keys($e)}))),!y.value||!m.value[y.value]){console.log("DEBUG: No aide data found"),alert("No aide assignment data found for this aide.");return}const ce=Z.value.length;if(ce>0&&!confirm(`WARNING: This will remove ${ce} current assignments and replace them with imported assignments.

Do you want to continue?`))return;const fe=m.value[y.value];console.log("DEBUG: aideData:",fe),console.log("DEBUG: aideData.classAssignment:",fe.classAssignment),console.log("DEBUG: aideData.directAssignment:",fe.directAssignment),console.log("DEBUG: Object.keys(aideData):",Object.keys(fe)),console.log("DEBUG: aideData.schedule:",fe.schedule),console.log("DEBUG: typeof aideData.schedule:",typeof fe.schedule),console.log("DEBUG: Array.isArray(aideData.schedule):",Array.isArray(fe.schedule));let Ae=0;Z.value=[];const Ie=i0(x.value);console.log("DEBUG: timeTableBlocks:",Ie),console.log("DEBUG: timeTableBlocks with period numbers:",Ie.map(ke=>({name:ke.name,periodNumber:ke.periodNumber,type:ke.type})));for(const ke of Ie){console.log("DEBUG: Processing block:",ke),console.log("DEBUG: Block periodNumber:",ke.periodNumber),console.log("DEBUG: Block name:",ke.name),console.log("DEBUG: Available classAssignment keys:",Object.keys(fe.classAssignment||{}));let $e=ke.periodNumber;if(!$e&&ke.name){const Ke=ke.name.match(/Period\s*(\d+)/i);Ke&&($e=Ke[1],console.log("DEBUG: Extracted periodNumber from name:",$e))}let Be="",We=[];if($e&&fe.classAssignment&&fe.classAssignment[$e]){console.log("DEBUG: Found class assignment for periodNumber:",$e);const Ke=Array.isArray(fe.classAssignment[$e])?fe.classAssignment[$e]:[fe.classAssignment[$e]];We=Ke.filter(Boolean).map(Ee=>{const ye=D.value.find(be=>be.id===Ee);return ye?ye.name||ye.email:"Unknown Teacher"}),Be=Ke.filter(Boolean).map(Ee=>`teacher:${Ee}`).join(","),console.log("DEBUG: Created assignment for periodNumber:",Be)}if(!Be&&ke.name&&fe.classAssignment){console.log("DEBUG: Trying to match by block name:",ke.name);const Ke=Object.keys(fe.classAssignment).find(Ee=>Ee.toLowerCase().trim()===ke.name.toLowerCase().trim());if(Ke){console.log("DEBUG: Found match by block name:",Ke);const Ee=Array.isArray(fe.classAssignment[Ke])?fe.classAssignment[Ke]:[fe.classAssignment[Ke]];We=Ee.filter(Boolean).map(ye=>{const be=D.value.find(Oe=>Oe.id===ye);return be?be.name||be.email:"Unknown Teacher"}),Be=Ee.filter(Boolean).map(ye=>`teacher:${ye}`).join(","),console.log("DEBUG: Created assignment for block name:",Be)}}if(Be){const Ke=ke.startTime,Ee=W(ke.startTime,30),ye=Be.split(",").map(Oe=>Oe.replace("teacher:","")).filter(Boolean),be={id:`imported-class-${Date.now()}-${Ae}`,label:We.join(", "),start:Ke,end:Ee,type:"class",blockId:`imported-block-${Ae}`,teacherId:ye[0]||"",note:ye.length>1?`Multiple teachers: ${We.join(", ")}`:""};console.log("DEBUG: Adding new assignment:",be),Z.value.push(be),Ae++}}if(console.log("DEBUG: Checking direct assignments..."),console.log("DEBUG: aideData.directAssignment:",fe.directAssignment),console.log("DEBUG: typeof aideData.directAssignment:",typeof fe.directAssignment),console.log("DEBUG: Array.isArray(aideData.directAssignment):",Array.isArray(fe.directAssignment)),fe.directAssignment){console.log("DEBUG: Found directAssignment:",fe.directAssignment);const ke=Array.isArray(fe.directAssignment)?fe.directAssignment:[fe.directAssignment];console.log("DEBUG: directStudentIds:",ke),console.log("DEBUG: students.value length:",(Te=i.value)==null?void 0:Te.length),console.log("DEBUG: students.value sample:",(Ge=i.value)==null?void 0:Ge.slice(0,3));for(const $e of ke)if(console.log("DEBUG: Processing studentId:",$e),$e&&$e!==""){const Be=i.value.find(We=>We.id===$e);if(console.log("DEBUG: Found student:",Be),Be){const We=`${ot(Be,"firstName")} ${ot(Be,"lastName")}`;console.log("DEBUG: Student name:",We);const Ke=i0(x.value).find(Ee=>Ee.type==="period");if(console.log("DEBUG: First period block:",Ke),Ke){const Ee=Ke.startTime,ye=W(Ke.startTime,30),be={id:`imported-direct-${Date.now()}-${Ae}`,label:We,start:Ee,end:ye,type:"student",blockId:`imported-direct-block-${Ae}`,studentId:$e};console.log("DEBUG: Adding direct assignment:",be),Z.value.push(be),Ae++}}}}else console.log("DEBUG: No directAssignment found");if(console.log("DEBUG: Final importedCount:",Ae),console.log("DEBUG: Final localAideAssignments:",Z.value),Ae>0){alert(`Successfully imported ${Ae} assignments with 30-minute time spans.

Types: Class assignments set to 'class', Direct assignments set to 'student'
Labels: Teacher names for class assignments, Student names for direct assignments
Duration: 30 minutes each`);const ke=y.value,$e=f.value[ke]||{},Be={};Z.value.forEach(Ke=>{const Ee=Ke.blockId||Ke.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;Be[Ee]={id:Ke.id,blockId:Ee,type:Ke.type,label:Ke.label,start:Ke.start,end:Ke.end,note:Ke.note,teacherId:Ke.teacherId,studentId:Ke.studentId}});const We={...$e,schedule:Be};p(ke,We).then(()=>{h().then(()=>{F(),ll(()=>{R(ke)})})})}else alert("No matching assignments found in the Aide Assignment data for this schedule.")}function W(ce,fe){const[Ae,Ie]=ce.split(":").map(Number),Te=Ae*60+Ie+fe,Ge=Math.floor(Te/60),ke=Te%60;return`${Ge.toString().padStart(2,"0")}:${ke.toString().padStart(2,"0")}`}Vt(()=>i0(x.value),ce=>{const fe={};for(const Ae of ce){const Ie=j(Ae,y.value);fe[Ae.id]=Ie?[{id:Ie,value:Ie}]:[]}P.value=fe},{immediate:!0});function X(ce,fe){G.value=fe,oe.value=ce.clientY,Q.value=_.value.findIndex(Ae=>Ae.time===fe.start),Y.value=0,ce.dataTransfer.effectAllowed="move",ce.dataTransfer.setData("text/plain",fe.id)}function re(ce,fe){if(!G.value||ce.clientY===0)return;const Ae=ce.clientY-oe.value;Y.value=Ae,fe._dragOffset=Ae}function he(ce,fe){if(!G.value)return;const Ae=24,Ie=_.value.length;let Te=Q.value+Math.round(Y.value/Ae);Te=Math.max(0,Math.min(Ie-2,Te));const Ge=_.value[Te].time,ke=_.value.findIndex(We=>We.time===fe.end)-Q.value;let $e=Te+ke;$e=Math.max(Te+1,Math.min(Ie-1,$e));const Be=_.value[$e].time;fe.start=Ge,fe.end=Be,fe._dragOffset=0,G.value=null,Y.value=0}function ue(ce){const fe=_.value.findIndex(Be=>Be.time===ce.start),Ae=_.value.findIndex(Be=>Be.time===ce.end),Ie=24;if(fe===-1||Ae===-1)return{display:"none"};const Te=fe*Ie+(ce._dragOffset||0),Ge=Math.max((Ae-fe)*Ie,Ie);let ke,$e;return ce.type==="class"?(ke="#e8f4fd",$e="#4a90e2"):ce.type==="student"?(ke="#f0f8e8",$e="#7cb342"):(ke="#f5f5f5",$e="#9e9e9e"),{position:"absolute",left:"20px",top:`${Te}px`,height:`${Ge}px`,width:"200px",minHeight:"24px",background:ke,borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",border:`2px solid ${$e}`,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",cursor:"grab",zIndex:2,transition:G.value===ce?"none":"top 0.2s"}}function pe(){const ce=S.value&&S.value.length>0?S.value[0].startTime:"08:00",fe=S.value&&S.value.length>0?S.value[0].endTime:"08:30";Z.value.push({id:`custom:${Date.now()}`,label:"",start:ce,end:fe,blockId:`block-${Date.now()}`})}const q=se(!1);se(null);const G=se(null),oe=se(0),Q=se(0),Y=se(0),Z=se([]);Vt(y,ce=>{if(!ce){Z.value=[];return}const Ae=(f.value[ce]||{}).schedule||{};Z.value=Object.entries(Ae).map(([Ie,Te])=>({id:Ie+"-"+(ce||""),label:Te.label||"",start:Te.start,end:Te.end,blockId:Ie,type:Te.type||"lunch",teacherId:Te.teacherId||"",studentId:Te.studentId||"",note:Te.note||""}))},{immediate:!0});async function ne(ce){if(y.value)try{g.value=!0;const fe=f.value[y.value]||{},Ae={};ce.forEach(Te=>{const Ge=Te.blockId||Te.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;Ae[Ge]={id:Te.id,blockId:Ge,type:Te.type,label:Te.label,start:Te.start,end:Te.end,note:Te.note,teacherId:Te.teacherId,studentId:Te.studentId}});const Ie={...fe,schedule:Ae};await p(y.value,Ie),await h(),F(),alert("Schedule saved!")}catch(fe){alert("Failed to save schedule: "+fe.message)}finally{g.value=!1}}Vt(()=>S,ce=>{console.log("DEBUG: blocks",ce)},{immediate:!0}),Vt(y,ce=>{ce&&(console.log("DEBUG: Opening edit dialog for aide",ce),console.log("DEBUG: blocks passed to dialog",S.value))});function ge(ce,fe){console.log("Resize start:",fe)}function ae(){pe()}return(ce,fe)=>(N(),L("div",Yie,[d("div",Qie,[fe[4]||(fe[4]=d("h1",null,"Aide Schedule Management",-1)),d("div",Jie,[d("button",{onClick:M,class:"btn btn-primary",disabled:g.value},[g.value?(N(),L("span",eoe,"💾")):(N(),L("span",toe,"💾")),Ne(" "+J(g.value?"Saving...":"Save Schedule"),1)],8,Zie),d("button",{onClick:O,class:"btn btn-secondary"},fe[3]||(fe[3]=[d("span",null,"←",-1),Ne(" Back ")]))])]),d("div",roe,[ee(r).currentUser?C.value?v.value?(N(),L("div",aoe," Loading aide schedules... ")):(N(),L("div",ioe,[nt(zie,{paraeducators:T.value,blocks:S.value,getAideTimeBlocks:V,getAideName:B,currentTimeTable:x.value,onEditAideAssignment:R,onGotoTimeTableConfig:fe[2]||(fe[2]=()=>ee(e).push("/admin?tab=time-table"))},{"tab-bar":Gh(()=>[w.value.length>1?(N(),L("div",ooe,[(N(!0),L(Re,null,Ve(w.value,Ae=>(N(),L("div",{key:Ae.id,class:Qe(["tab-btn",{active:k.value===Ae.id}]),onClick:Ie=>k.value=Ae.id},J(Ae.label),11,loe))),128))])):_e("",!0)]),_:1},8,["paraeducators","blocks","currentTimeTable"]),y.value?(N(),Kr(kie,{key:0,aideName:B(y.value),timeTicks:ee(_),isTickInAnyBlock:A,aideAssignments:Z.value,getAssignmentBoxStyle:ue,onAssignmentDragStart:X,onAssignmentDrag:re,onAssignmentDragEnd:he,onResizeStart:ge,showAddAssignment:q.value,addAssignment:ae,onImportAssignments:H,onSave:ne,onClose:F,saving:g.value,blocks:S.value,teachers:D.value,students:ee(i)},null,8,["aideName","timeTicks","aideAssignments","showAddAssignment","saving","blocks","teachers","students"])):_e("",!0)])):(N(),L("div",soe,[fe[7]||(fe[7]=d("h2",null,"Access Denied",-1)),fe[8]||(fe[8]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:fe[1]||(fe[1]=Ae=>ee(e).push("/")),class:"btn btn-primary"},"Go Home")])):(N(),L("div",noe,[fe[5]||(fe[5]=d("h2",null,"Authentication Required",-1)),fe[6]||(fe[6]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:fe[0]||(fe[0]=Ae=>ee(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},coe={name:"AdminBackupRestore",setup(){const t=se([{id:"users",name:"Users"},{id:"students",name:"Students"},{id:"app_settings",name:"App Settings"},{id:"aideSchedules",name:"Aide Schedules"},{id:"aideAssignments",name:"Aide Assignments"},{id:"feedbackForms",name:"Teacher Feedback Forms"},{id:"config",name:"Configuration"},{id:"backups",name:"Backups Metadata"}]),e=se(["users","students","app_settings"]),r=se(""),n=se(!1),s=se(!1),i=se(null),a=se(null),o=se([]),l=se(""),c=se("info"),u=Rs({overwrite:!1,validate:!0}),f=se(null),h=async()=>{var P,w,x;try{console.log("🔍 DEBUG: Current user role:",(P=currentUser.value)==null?void 0:P.role),console.log("🔍 DEBUG: Current user:",currentUser.value);const S=bt(ze,"backups"),_=nr(S,Gr("createdAt","desc"),Ts(20)),A=await $t(_);o.value=A.docs.map(C=>({id:C.id,...C.data()})),console.log("✅ DEBUG: Successfully loaded",o.value.length,"backups")}catch(S){console.error("❌ DEBUG: Error loading backups:",S),console.error("❌ DEBUG: Error details:",{code:S.code,message:S.message,userRole:(w=currentUser.value)==null?void 0:w.role,userId:(x=currentUser.value)==null?void 0:x.uid}),k("Error loading backups","error")}},p=async()=>{if(e.value.length===0){k("Please select at least one collection","error");return}n.value=!0,k("Creating backup...","info");try{const P={metadata:{version:"1.0",createdAt:new Date().toISOString(),createdBy:"admin",description:r.value||"Manual backup"},collections:{}};for(const S of e.value)if(S==="app_settings"){const _=Ze(ze,"app_settings","global"),A=await Jt(_);P.collections[S]=A.exists()?A.data():{}}else{const _=bt(ze,S),A=await $t(_);P.collections[S]=A.docs.map(C=>({id:C.id,...C.data()}))}const w=`backup_${Date.now()}`,x=Ze(ze,"backups",w);await Ht(x,{name:r.value||`Backup ${new Date().toLocaleDateString()}`,createdAt:new Date().toISOString(),collections:e.value,size:JSON.stringify(P).length,data:P}),r.value="",await h(),k("Backup created successfully!","success")}catch(P){console.error("Error creating backup:",P),k("Error creating backup: "+P.message,"error")}finally{n.value=!1}},m=P=>{const w=P.target.files[0];if(!w)return;i.value=w,a.value=null;const x=new FileReader;x.onload=S=>{try{const _=JSON.parse(S.target.result);_.metadata&&_.collections?(a.value=_,k("Backup file loaded successfully","success")):k("Invalid backup file format","error")}catch{k("Error parsing JSON file","error")}},x.readAsText(w)},v=async()=>{if(!i.value||!a.value){k("Please select a valid backup file","error");return}if(u.overwrite){if(!confirm("This will overwrite existing data. This action cannot be undone. Continue?"))return}else if(!confirm("This will add new data without overwriting existing records. Continue?"))return;s.value=!0,k("Restoring backup...","info");try{for(const[P,w]of Object.entries(a.value.collections))if(P==="app_settings"||P==="appSettings"){const x=Ze(ze,"app_settings","global");await Ht(x,w,{merge:!u.overwrite})}else{const x=bt(ze,P);if(Array.isArray(w))for(const S of w){const _=Ze(x,S.id);u.overwrite?await Ht(_,S):await Ht(_,S,{merge:!0})}}k("Backup restored successfully!","success"),i.value=null,a.value=null,f.value&&(f.value.value="")}catch(P){console.error("Error restoring backup:",P),k("Error restoring backup: "+P.message,"error")}finally{s.value=!1}},g=P=>{const w=JSON.stringify(P.data,null,2),x=new Blob([w],{type:"application/json"}),S=URL.createObjectURL(x),_=document.createElement("a");_.href=S,_.download=`${P.name||"backup"}.json`,_.target="_blank",_.rel="noopener noreferrer",document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(S)},y=async P=>{if(confirm("Are you sure you want to delete this backup?"))try{await ho(Ze(ze,"backups",P)),await h(),k("Backup deleted successfully","success")}catch(x){console.error("Error deleting backup:",x),k("Error deleting backup","error")}},E=P=>{if(P===0)return"0 Bytes";const w=1024,x=["Bytes","KB","MB","GB"],S=Math.floor(Math.log(P)/Math.log(w));return parseFloat((P/Math.pow(w,S)).toFixed(2))+" "+x[S]},b=P=>new Date(P).toLocaleString(),k=(P,w="info")=>{l.value=P,c.value=w,setTimeout(()=>{l.value=""},5e3)};return Ut(()=>{h()}),{collections:t,selectedCollections:e,backupName:r,isBackingUp:n,isRestoring:s,selectedFile:i,backupData:a,backups:o,statusMessage:l,statusType:c,restoreOptions:u,fileInput:f,createBackup:p,handleFileSelect:m,restoreBackup:v,downloadBackup:g,deleteBackup:y,formatFileSize:E,formatDate:b}}},uoe={class:"admin-backup-restore"},doe={class:"content"},foe={class:"section"},hoe={class:"backup-options"},poe={class:"option-group"},moe={class:"checkbox-group"},goe=["value","disabled"],voe={class:"option-group"},xoe=["disabled"],yoe=["disabled"],Eoe={key:0},_oe={key:1},boe={class:"section"},Soe={class:"restore-options"},Aoe={class:"file-upload"},Toe=["disabled"],woe={key:0,class:"file-info"},Coe={key:0,class:"option-group"},Ioe={class:"backup-info"},koe={class:"collection-name"},Doe={class:"collection-count"},Poe={key:1,class:"option-group"},Roe={class:"checkbox-group"},Foe={class:"checkbox"},Noe=["disabled"],Ooe={class:"checkbox"},Moe=["disabled"],Loe=["disabled"],Boe={key:0},Uoe={key:1},$oe={class:"section"},Voe={key:0,class:"backup-list"},Hoe={class:"backup-info"},joe={class:"admin-action-btns"},Goe=["onClick"],Woe=["onClick"],zoe={key:1,class:"no-backups"};function Koe(t,e,r,n,s,i){return N(),L("div",uoe,[e[17]||(e[17]=d("h1",null,"🔧 Admin Tools",-1)),e[18]||(e[18]=d("div",{class:"header"},[d("h1",null,"Backup & Restore"),d("p",null,"Manage database backups and restore data from JSON files")],-1)),d("div",doe,[d("div",foe,[e[9]||(e[9]=d("h2",null,"Create Backup",-1)),d("div",hoe,[d("div",poe,[e[7]||(e[7]=d("label",null,"Collections to backup:",-1)),d("div",moe,[(N(!0),L(Re,null,Ve(n.collections,a=>(N(),L("label",{key:a.id,class:"checkbox"},[we(d("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>n.selectedCollections=o),value:a.id,disabled:n.isBackingUp},null,8,goe),[[_t,n.selectedCollections]]),Ne(" "+J(a.name),1)]))),128))])]),d("div",voe,[e[8]||(e[8]=d("label",null,"Backup name (optional):",-1)),we(d("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>n.backupName=a),placeholder:"e.g., backup-2024-01-15",disabled:n.isBackingUp},null,8,xoe),[[Ye,n.backupName]])]),d("button",{onClick:e[2]||(e[2]=(...a)=>n.createBackup&&n.createBackup(...a)),disabled:n.isBackingUp||n.selectedCollections.length===0,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},[n.isBackingUp?(N(),L("span",Eoe,"Creating Backup...")):(N(),L("span",_oe,"Create Backup"))],8,yoe)])]),d("div",boe,[e[15]||(e[15]=d("h2",null,"Restore from Backup",-1)),d("div",Soe,[d("div",Aoe,[e[10]||(e[10]=d("label",null,"Select JSON backup file:",-1)),d("input",{type:"file",onChange:e[3]||(e[3]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a)),accept:".json",disabled:n.isRestoring,ref:"fileInput"},null,40,Toe),n.selectedFile?(N(),L("p",woe," Selected: "+J(n.selectedFile.name)+" ("+J(n.formatFileSize(n.selectedFile.size))+") ",1)):_e("",!0)]),n.backupData?(N(),L("div",Coe,[e[11]||(e[11]=d("label",null,"Collections in backup:",-1)),d("div",Ioe,[(N(!0),L(Re,null,Ve(n.backupData.collections,(a,o)=>(N(),L("div",{key:o,class:"collection-info"},[d("span",koe,J(o)+":",1),d("span",Doe,J(Array.isArray(a)?a.length:"1")+" items",1)]))),128))])])):_e("",!0),n.backupData?(N(),L("div",Poe,[e[14]||(e[14]=d("label",null,"Restore options:",-1)),d("div",Roe,[d("label",Foe,[we(d("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>n.restoreOptions.overwrite=a),disabled:n.isRestoring},null,8,Noe),[[_t,n.restoreOptions.overwrite]]),e[12]||(e[12]=Ne(" Overwrite existing data "))]),d("label",Ooe,[we(d("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>n.restoreOptions.validate=a),disabled:n.isRestoring},null,8,Moe),[[_t,n.restoreOptions.validate]]),e[13]||(e[13]=Ne(" Validate data before restore "))])])])):_e("",!0),d("button",{onClick:e[6]||(e[6]=(...a)=>n.restoreBackup&&n.restoreBackup(...a)),disabled:n.isRestoring||!n.selectedFile||!n.backupData,class:"admin-action-btn warning",style:{"min-width":"140px","max-width":"140px"}},[n.isRestoring?(N(),L("span",Boe,"Restoring...")):(N(),L("span",Uoe,"Restore Backup"))],8,Loe)])]),d("div",$oe,[e[16]||(e[16]=d("h2",null,"Backup History",-1)),n.backups.length>0?(N(),L("div",Voe,[(N(!0),L(Re,null,Ve(n.backups,a=>(N(),L("div",{key:a.id,class:"backup-item"},[d("div",Hoe,[d("h3",null,J(a.name||"Unnamed Backup"),1),d("p",null,"Created: "+J(n.formatDate(a.createdAt)),1),d("p",null,"Size: "+J(n.formatFileSize(a.size)),1),d("p",null,"Collections: "+J(a.collections.join(", ")),1)]),d("div",joe,[d("button",{onClick:o=>n.downloadBackup(a),class:"admin-action-btn secondary"},"Download",8,Goe),d("button",{onClick:o=>n.deleteBackup(a.id),class:"admin-action-btn delete"},"Delete",8,Woe)])]))),128))])):(N(),L("p",zoe,"No backups found"))])]),n.statusMessage?(N(),L("div",{key:0,class:Qe(["status-message",n.statusType])},J(n.statusMessage),3)):_e("",!0)])}const zk=yt(coe,[["render",Koe],["__scopeId","data-v-bc031c32"]]),qoe={class:"admin-audit-logs"},Xoe={class:"log-controls"},Yoe={class:"log-filters"},Qoe=["disabled"],Joe=["disabled"],Zoe={class:"logs-container"},ele={key:0,class:"loading-state"},tle={key:1,class:"logs-table"},rle={class:"timestamp"},nle={class:"log-type"},sle={class:"user-info"},ale={class:"user-email"},ile={class:"user-id"},ole={class:"action"},lle={class:"details"},cle={class:"details-preview"},ule={class:"actions"},dle=["onClick"],fle={key:2,class:"no-logs"},hle={key:1,class:"pagination"},ple=["disabled"],mle={class:"page-info"},gle=["disabled"],vle={class:"dialog-content"},xle={class:"log-detail-section"},yle={class:"detail-grid"},Ele={class:"detail-item"},_le={class:"detail-item"},ble={class:"detail-item"},Sle={class:"detail-item"},Ale={class:"detail-item"},Tle={class:"detail-item"},wle={class:"detail-item"},Cle={key:0,class:"log-detail-section"},Ile={class:"detail-grid"},kle={key:0,class:"detail-item"},Dle={key:1,class:"detail-item"},Ple={key:2,class:"detail-item"},Rle={key:1,class:"log-detail-section"},Fle={class:"details-content"},Nle={key:2,class:"log-detail-section"},Ole={class:"detail-grid"},Mle={key:0,class:"detail-item"},Lle={key:1,class:"detail-item"},o0=25,Ble={__name:"AdminAuditLogs",setup(t){const e=vo(),r=se([]),n=se(!1),s=se(""),i=se(!1),a=se(null),o=se("7"),l=se(""),c=se(""),u=se(""),f=se(1),h=Se(()=>{let C=r.value;if(l.value&&(C=C.filter(T=>T.type===l.value)),c.value&&(C=C.filter(T=>T.action===c.value)),u.value){const T=u.value.toLowerCase();C=C.filter(D=>D.userEmail&&D.userEmail.toLowerCase().includes(T)||D.action&&D.action.toLowerCase().includes(T)||D.details&&JSON.stringify(D.details).toLowerCase().includes(T)||D.studentId&&D.studentId.toLowerCase().includes(T))}return C}),p=Se(()=>{const C=(f.value-1)*o0,T=C+o0;return h.value.slice(C,T)}),m=Se(()=>Math.ceil(h.value.length/o0)),v=async()=>{n.value=!0,s.value="";try{const C=new Date;C.setDate(C.getDate()-parseInt(o.value));const T=nr(bt(e,"auditLogs"),Rr("timestamp",">=",C),Gr("timestamp","desc"),Ts(500)),D=await $t(T);r.value=D.docs.map(V=>({id:V.id,...V.data()})),f.value=1,S(`Loaded ${r.value.length} audit logs`,!1)}catch(C){console.error("Error loading audit logs:",C),S("Error loading audit logs: "+C.message,!0)}finally{n.value=!1}},g=async()=>{try{const C=y(h.value),T=new Blob([C],{type:"text/csv"}),D=window.URL.createObjectURL(T),V=document.createElement("a");V.href=D,V.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,V.click(),window.URL.revokeObjectURL(D),S("Audit logs exported successfully",!1)}catch(C){console.error("Error exporting logs:",C),S("Error exporting logs: "+C.message,!0)}},y=C=>{const D=[["Timestamp","Type","User Email","User ID","Action","Details","Student ID","Session ID","IP Address"].join(",")];return C.forEach(V=>{const B=[k(V.timestamp),V.type||"",V.userEmail||V.performedByEmail||"",V.userId||V.performedBy||"",V.action||"",JSON.stringify(V.details||"").replace(/"/g,'""'),V.studentId||V.targetUserId||"",V.sessionId||"",V.ipAddress||""];D.push(B.map(R=>`"${R}"`).join(","))}),D.join(`
`)},E=C=>{a.value=C},b=()=>{a.value=null},k=C=>{if(!C)return"N/A";let T;return C.toDate?T=C.toDate():C instanceof Date?T=C:T=new Date(C),T.toLocaleString()},P=C=>({student_access:"Student Access",user_management:"User Management",system_access:"System Access",data_export:"Data Export",session_timeout:"Session Timeout"})[C]||C,w=C=>{if(C.details){const D=typeof C.details=="string"?C.details:JSON.stringify(C.details);return D.length>50?D.substring(0,50)+"...":D}const T=[];return C.studentId&&T.push(`Student: ${C.studentId}`),C.targetUserId&&T.push(`Target: ${C.targetUserId}`),C.exportType&&T.push(`Export: ${C.exportType}`),C.studentCount&&T.push(`Count: ${C.studentCount}`),T.join(", ")||"No additional details"},x=C=>{if(!C)return"No details available";if(typeof C=="string")try{const T=JSON.parse(C);return JSON.stringify(T,null,2)}catch{return C}return JSON.stringify(C,null,2)},S=(C,T=!1)=>{s.value=C,i.value=T,setTimeout(()=>{s.value="",i.value=!1},5e3)};let _=null;const A=()=>{_&&clearTimeout(_),_=setTimeout(()=>{f.value=1},300)};return Ut(()=>{v()}),(C,T)=>(N(),L("div",qoe,[T[29]||(T[29]=d("div",{class:"logs-header"},[d("h2",null,"📋 System Audit Logs"),d("p",{class:"logs-description"}," View and search system audit logs for security monitoring and compliance. ")],-1)),d("div",Xoe,[d("div",Yoe,[we(d("select",{"onUpdate:modelValue":T[0]||(T[0]=D=>o.value=D),onChange:v,class:"form-select"},T[7]||(T[7]=[d("option",{value:"1"},"Last 24 hours",-1),d("option",{value:"7"},"Last 7 days",-1),d("option",{value:"30"},"Last 30 days",-1),d("option",{value:"90"},"Last 90 days",-1)]),544),[[ur,o.value]]),we(d("select",{"onUpdate:modelValue":T[1]||(T[1]=D=>l.value=D),onChange:v,class:"form-select"},T[8]||(T[8]=[Fr('<option value="" data-v-aacc574e>All Log Types</option><option value="student_access" data-v-aacc574e>Student Access</option><option value="user_management" data-v-aacc574e>User Management</option><option value="system_access" data-v-aacc574e>System Access</option><option value="data_export" data-v-aacc574e>Data Export</option><option value="session_timeout" data-v-aacc574e>Session Timeout</option>',6)]),544),[[ur,l.value]]),we(d("select",{"onUpdate:modelValue":T[2]||(T[2]=D=>c.value=D),onChange:v,class:"form-select"},T[9]||(T[9]=[Fr('<option value="" data-v-aacc574e>All Actions</option><option value="login" data-v-aacc574e>Login</option><option value="logout" data-v-aacc574e>Logout</option><option value="create" data-v-aacc574e>Create</option><option value="edit" data-v-aacc574e>Edit</option><option value="delete" data-v-aacc574e>Delete</option><option value="view" data-v-aacc574e>View</option><option value="admin_panel_access" data-v-aacc574e>Admin Access</option>',8)]),544),[[ur,c.value]]),we(d("input",{"onUpdate:modelValue":T[3]||(T[3]=D=>u.value=D),onInput:A,type:"text",placeholder:"Search logs...",class:"form-input"},null,544),[[Ye,u.value]]),d("button",{onClick:v,class:"btn btn-secondary",disabled:n.value}," 🔄 "+J(n.value?"Loading...":"Refresh"),9,Qoe),d("button",{onClick:g,class:"btn btn-primary",disabled:n.value}," 📊 Export Logs ",8,Joe)])]),s.value?(N(),L("div",{key:0,class:Qe(["status-message",{error:i.value}])},J(s.value),3)):_e("",!0),d("div",Zoe,[n.value?(N(),L("div",ele," Loading audit logs... ")):h.value.length>0?(N(),L("table",tle,[T[10]||(T[10]=d("thead",null,[d("tr",null,[d("th",null,"Timestamp"),d("th",null,"Type"),d("th",null,"User"),d("th",null,"Action"),d("th",null,"Details"),d("th",null,"Actions")])],-1)),d("tbody",null,[(N(!0),L(Re,null,Ve(p.value,D=>(N(),L("tr",{key:D.id,class:"log-row"},[d("td",rle,J(k(D.timestamp)),1),d("td",nle,[d("span",{class:Qe(["type-badge",D.type])},J(P(D.type)),3)]),d("td",sle,[d("div",ale,J(D.userEmail||"Unknown"),1),d("div",ile,J(D.userId||D.performedBy||"N/A"),1)]),d("td",ole,J(D.action||"N/A"),1),d("td",lle,[d("div",cle,J(w(D)),1)]),d("td",ule,[d("button",{onClick:V=>E(D),class:"btn btn-sm btn-info",title:"View Details"}," 👁️ View ",8,dle)])]))),128))])])):(N(),L("div",fle,T[11]||(T[11]=[d("p",null,"No audit logs found for the selected criteria.",-1)])))]),h.value.length>o0?(N(),L("div",hle,[d("button",{onClick:T[4]||(T[4]=D=>f.value--),disabled:f.value===1,class:"btn btn-secondary"}," Previous ",8,ple),d("span",mle," Page "+J(f.value)+" of "+J(m.value)+" ("+J(h.value.length)+" logs) ",1),d("button",{onClick:T[5]||(T[5]=D=>f.value++),disabled:f.value===m.value,class:"btn btn-secondary"}," Next ",8,gle)])):_e("",!0),a.value?(N(),L("div",{key:2,class:"log-dialog-overlay",onClick:b},[d("div",{class:"log-dialog",onClick:T[6]||(T[6]=dn(()=>{},["stop"]))},[d("div",{class:"dialog-header"},[T[12]||(T[12]=d("h3",null,"📋 Audit Log Details",-1)),d("button",{onClick:b,class:"close-btn"},"✕")]),d("div",vle,[d("div",xle,[T[20]||(T[20]=d("h4",null,"Basic Information",-1)),d("div",yle,[d("div",Ele,[T[13]||(T[13]=d("label",null,"Timestamp:",-1)),d("span",null,J(k(a.value.timestamp)),1)]),d("div",_le,[T[14]||(T[14]=d("label",null,"Log Type:",-1)),d("span",{class:Qe(["type-badge",a.value.type])},J(P(a.value.type)),3)]),d("div",ble,[T[15]||(T[15]=d("label",null,"Action:",-1)),d("span",null,J(a.value.action||"N/A"),1)]),d("div",Sle,[T[16]||(T[16]=d("label",null,"User Email:",-1)),d("span",null,J(a.value.userEmail||a.value.performedByEmail||"Unknown"),1)]),d("div",Ale,[T[17]||(T[17]=d("label",null,"User ID:",-1)),d("span",null,J(a.value.userId||a.value.performedBy||"N/A"),1)]),d("div",Tle,[T[18]||(T[18]=d("label",null,"Session ID:",-1)),d("span",null,J(a.value.sessionId||"N/A"),1)]),d("div",wle,[T[19]||(T[19]=d("label",null,"IP Address:",-1)),d("span",null,J(a.value.ipAddress||"N/A"),1)])])]),a.value.studentId||a.value.targetUserId?(N(),L("div",Cle,[T[24]||(T[24]=d("h4",null,"Target Information",-1)),d("div",Ile,[a.value.studentId?(N(),L("div",kle,[T[21]||(T[21]=d("label",null,"Student ID:",-1)),d("span",null,J(a.value.studentId),1)])):_e("",!0),a.value.targetUserId?(N(),L("div",Dle,[T[22]||(T[22]=d("label",null,"Target User ID:",-1)),d("span",null,J(a.value.targetUserId),1)])):_e("",!0),a.value.studentIds?(N(),L("div",Ple,[T[23]||(T[23]=d("label",null,"Student IDs:",-1)),d("span",null,J(Array.isArray(a.value.studentIds)?a.value.studentIds.join(", "):a.value.studentIds),1)])):_e("",!0)])])):_e("",!0),a.value.details?(N(),L("div",Rle,[T[25]||(T[25]=d("h4",null,"Additional Details",-1)),d("div",Fle,[d("pre",null,J(x(a.value.details)),1)])])):_e("",!0),a.value.exportType||a.value.studentCount?(N(),L("div",Nle,[T[28]||(T[28]=d("h4",null,"Export Information",-1)),d("div",Ole,[a.value.exportType?(N(),L("div",Mle,[T[26]||(T[26]=d("label",null,"Export Type:",-1)),d("span",null,J(a.value.exportType),1)])):_e("",!0),a.value.studentCount?(N(),L("div",Lle,[T[27]||(T[27]=d("label",null,"Student Count:",-1)),d("span",null,J(a.value.studentCount),1)])):_e("",!0)])])):_e("",!0)]),d("div",{class:"dialog-actions"},[d("button",{onClick:b,class:"btn btn-secondary"},"Close")])])])):_e("",!0)]))}},Ule=yt(Ble,[["__scopeId","data-v-aacc574e"]]),$le={class:"teacher-feedback-admin"},Vle={key:0,class:"status-message loading"},Hle={key:1,class:"status-message success"},jle={key:2,class:"status-message error"},Gle={class:"quick-actions"},Wle=["disabled"],zle={class:"modal-body"},Kle={class:"form-group"},qle={class:"form-group"},Xle={class:"form-group"},Yle={class:"form-group"},Qle={class:"modal-footer"},Jle=["disabled"],Zle={key:0},ece={key:1},tce={class:"setup-section"},rce={key:0,class:"loading-state"},nce={key:1,class:"status-card"},sce={class:"status-header"},ace={class:"status-indicator"},ice={key:0,class:"status-badge success"},oce={key:1,class:"status-badge info"},lce={class:"status-details"},cce={key:0},uce={key:1},dce={key:0},fce={key:1,class:"info-note"},hce={key:0,class:"drive-actions"},pce=["href"],mce={key:2,class:"setup-options"},gce={class:"setup-card"},vce={class:"workspace-setup"},xce={class:"form-group"},yce=["disabled"],Ece=["disabled"],_ce={key:0},bce={key:1},Sce={class:"forms-list"},Ace={key:0,class:"loading"},Tce={key:1,class:"empty-state"},wce={key:2,class:"forms-grid"},Cce={class:"form-header"},Ice={class:"admin-action-btns"},kce=["onClick"],Dce=["onClick"],Pce=["onClick"],Rce={class:"form-meta"},Fce={key:0},Nce=["href"],Oce={key:1},Mce=["href"],Lce={key:2,class:"sheet-status pending"},Bce={__name:"AdminTeacherFeedback",setup(t){const{isLoading:e,error:r,successMessage:n,formsLoading:s,activeForms:i,createFeedbackFormWithUserAuth:a,deleteFeedbackForm:o,clearMessages:l}=Fx();Ua(),ya();const c=xa(),u=se(!1),f=se(""),h=se(""),p=se(""),m=se(""),v=se(null),g=se(!0),y=se(""),E=se("info"),b=se(""),k=se(!1),P=Se(()=>f.value.trim()&&p.value.trim()),w=async()=>{if(P.value)try{l();const{GoogleAuthProvider:B,signInWithPopup:R,getAuth:F}=await aa(async()=>{const{GoogleAuthProvider:X,signInWithPopup:re,getAuth:he}=await Promise.resolve().then(()=>d5);return{GoogleAuthProvider:X,signInWithPopup:re,getAuth:he}},void 0),M=F(),O=new B;O.addScope("https://www.googleapis.com/auth/drive.file"),O.addScope("https://www.googleapis.com/auth/spreadsheets");let K;try{K=await R(M,O)}catch(X){throw X.code==="auth/popup-closed-by-user"||X.message.includes("Cross-Origin-Opener-Policy")?new Error("❌ Authentication popup was blocked or closed. Please allow popups for this site and try again."):X}const H=B.credentialFromResult(K).accessToken;if(!H)throw new Error("Failed to get Google access token. Please try again.");console.log("✅ Got Google access token for feedback form creation");const W={title:f.value.trim(),description:h.value.trim(),formUrl:p.value.trim(),sheetTemplateUrl:m.value.trim(),createdBy:c.user.uid};await a(W,H),x()}catch(B){console.error("Error adding form:",B),B.code==="auth/popup-closed-by-user"?B.value="❌ Authentication cancelled. Please try again and allow Google Drive access.":B.code==="auth/popup-blocked"?B.value="❌ Popup blocked. Please allow popups for this site and try again.":B.message&&B.message.includes("Cross-Origin-Opener-Policy")?B.value="❌ Browser security policy blocked the authentication popup. Please try again or contact support.":B.value=B.message||"Failed to create feedback form"}},x=()=>{u.value=!1,f.value="",h.value="",p.value="",m.value="",l()},S=B=>{window.open(B.formUrl,"_blank","noopener,noreferrer")},_=async B=>{window.open(B.formUrl,"_blank","noopener,noreferrer")},A=async B=>{if(confirm(`Are you sure you want to delete "${B.title}"?`))try{await o(B.id)}catch(R){console.error("Error deleting form:",R)}},C=B=>B?(B.seconds?new Date(B.seconds*1e3):new Date(B)).toLocaleDateString():"N/A",T=async()=>{try{g.value=!0;const{getFunctions:B,httpsCallable:R}=await aa(async()=>{const{getFunctions:K,httpsCallable:j}=await Promise.resolve().then(()=>b0);return{getFunctions:K,httpsCallable:j}},void 0),F=B(),O=await R(F,"getUserSchool")();O.data.success&&O.data.school?v.value=O.data.school:await D()}catch(B){console.error("Error loading school info:",B),y.value="Error loading Google Drive settings",E.value="error"}finally{g.value=!1}},D=async()=>{try{const{getFunctions:B,httpsCallable:R}=await aa(async()=>{const{getFunctions:K,httpsCallable:j}=await Promise.resolve().then(()=>b0);return{getFunctions:K,httpsCallable:j}},void 0),F=B(),O=await R(F,"getOrCreateSchool")();O.data.success&&(v.value=O.data.school,O.data.school.isNew&&(y.value="Google Drive settings initialized! You can now create feedback forms.",E.value="success"))}catch(B){console.error("Error creating school:",B),y.value="Error initializing Google Drive settings: "+B.message,E.value="error"}},V=async()=>{if(b.value.trim()){k.value=!0,y.value="";try{const{getFunctions:B,httpsCallable:R}=await aa(async()=>{const{getFunctions:K,httpsCallable:j}=await Promise.resolve().then(()=>b0);return{getFunctions:K,httpsCallable:j}},void 0),F=B(),O=await R(F,"createSharedDrive")({schoolId:v.value.schoolId,driveName:b.value.trim()});if(O.data.requiresManualCreation){const K=O.data.instructions,j=O.data.serviceAccountEmail;y.value=`Google Workspace setup requires manual configuration:

1. ${K.join(`
2. `)}

Service Account Email: ${j}`,E.value="info"}else O.data.success?(y.value="Google Workspace setup completed successfully!",E.value="success",await T(),b.value=""):(y.value="Error setting up Google Workspace: "+O.data.error,E.value="error")}catch(B){console.error("Error setting up workspace:",B),y.value="Error setting up Google Workspace: "+B.message,E.value="error"}finally{k.value=!1}}};return Ut(async()=>{await T()}),(B,R)=>{var F;return N(),L("div",$le,[R[35]||(R[35]=d("div",{class:"admin-header"},[d("h2",null,"Teacher Feedback Forms"),d("p",{class:"admin-description"}," Create and manage Google Forms for collecting teacher feedback on students. Each case manager will have their own response sheet automatically created when they first use the form. ")],-1)),ee(e)?(N(),L("div",Vle," Processing... ")):_e("",!0),ee(n)?(N(),L("div",Hle,J(ee(n)),1)):_e("",!0),ee(r)?(N(),L("div",jle,J(ee(r)),1)):_e("",!0),d("div",Gle,[d("button",{onClick:R[0]||(R[0]=M=>u.value=!0),class:"primary-btn",disabled:ee(e)},R[7]||(R[7]=[d("span",null,"📝",-1),Ne(" Add Form ")]),8,Wle)]),u.value?(N(),L("div",{key:3,class:"modal-overlay",onClick:x},[d("div",{class:"modal-content",onClick:R[5]||(R[5]=dn(()=>{},["stop"]))},[d("div",{class:"modal-header"},[R[8]||(R[8]=d("h3",null,"Add Teacher Feedback Form",-1)),d("button",{onClick:x,class:"close-btn"},"×")]),d("div",zle,[d("div",Kle,[R[9]||(R[9]=d("label",null,"Form Title:",-1)),we(d("input",{type:"text","onUpdate:modelValue":R[1]||(R[1]=M=>f.value=M),placeholder:"Enter a descriptive title for this form",class:"form-input",required:""},null,512),[[Ye,f.value]])]),d("div",qle,[R[10]||(R[10]=d("label",null,"Form Description (optional):",-1)),we(d("textarea",{"onUpdate:modelValue":R[2]||(R[2]=M=>h.value=M),placeholder:"Brief description of what this form is for",class:"form-textarea",rows:"3"},null,512),[[Ye,h.value]])]),d("div",Xle,[R[11]||(R[11]=d("label",null,"Google Form URL:",-1)),we(d("input",{type:"url","onUpdate:modelValue":R[3]||(R[3]=M=>p.value=M),placeholder:"https://docs.google.com/forms/d/your-form-id/viewform",class:"form-input",required:""},null,512),[[Ye,p.value]]),R[12]||(R[12]=d("small",{class:"form-help"},"Paste the Google Form URL here (viewform link)",-1))]),d("div",Yle,[R[13]||(R[13]=d("label",null,"Google Sheet Template URL (optional):",-1)),we(d("input",{type:"url","onUpdate:modelValue":R[4]||(R[4]=M=>m.value=M),placeholder:"https://docs.google.com/spreadsheets/d/your-sheet-id/edit",class:"form-input"},null,512),[[Ye,m.value]]),R[14]||(R[14]=d("small",{class:"form-help"},"Optional: Provide a Google Sheet template that case managers can duplicate for collecting responses",-1))]),R[15]||(R[15]=d("div",{class:"form-info"},[d("h4",null,"📋 Setup Instructions:"),d("ol",null,[d("li",null,"Create your Google Form manually with the questions you want"),d("li",null,'Make sure to enable "Collect email addresses" in form settings'),d("li",null,"Copy the form's view URL and paste it above"),d("li",null,'Click "Add Form" - a Google Sheet will be automatically created for responses')]),d("p",{class:"info-note"},[d("strong",null,"✅ Automatic:"),Ne(" A Google Sheet will be created immediately when you add the form. Each case manager will get their own copy of this sheet when they use the form. ")])],-1))]),d("div",Qle,[d("button",{onClick:x,class:"secondary-btn"},"Cancel"),d("button",{onClick:w,class:"primary-btn",disabled:!P.value||ee(e)},[ee(e)?(N(),L("span",Zle,"Adding Form...")):(N(),L("span",ece,"Add Form"))],8,Jle)])])])):_e("",!0),d("div",tce,[R[25]||(R[25]=d("h3",null,"Google Drive Setup",-1)),R[26]||(R[26]=d("p",{class:"section-description"}," Configure how the system accesses Google Drive for creating feedback forms and response sheets. ",-1)),g.value?(N(),L("div",rce,R[16]||(R[16]=[d("p",null,"Loading Google Drive settings...",-1)]))):v.value?(N(),L("div",nce,[d("div",sce,[d("h4",null,J(v.value.name||"Your School"),1),d("div",ace,[v.value.sharedDriveId?(N(),L("span",ice," ✅ Google Workspace Mode ")):(N(),L("span",oce," 📁 Personal Google Drive Mode "))])]),d("div",lce,[d("p",null,[R[17]||(R[17]=d("strong",null,"Current Mode:",-1)),v.value.sharedDriveId?(N(),L("span",cce,"Google Workspace Shared Drive")):(N(),L("span",uce,"Personal Google Drive"))]),v.value.sharedDriveId?(N(),L("p",dce,[R[18]||(R[18]=d("strong",null,"Shared Drive:",-1)),Ne(" "+J(v.value.sharedDriveName||"CaseManageVue Templates"),1)])):_e("",!0),v.value.sharedDriveId?_e("",!0):(N(),L("p",fce,R[19]||(R[19]=[d("strong",null,"Note:",-1),Ne(" Files will be created in your personal Google Drive when you create forms. ")])))]),v.value.sharedDriveId?(N(),L("div",hce,[d("a",{href:`https://drive.google.com/drive/folders/${v.value.sharedDriveId}`,target:"_blank",class:"secondary-btn"}," 📂 Open Shared Drive ",8,pce)])):_e("",!0)])):_e("",!0),!g.value&&!((F=v.value)!=null&&F.sharedDriveId)?(N(),L("div",mce,[R[24]||(R[24]=d("div",{class:"setup-card"},[d("h4",null,"📁 Personal Google Drive (Recommended for Testing)"),d("p",{class:"setup-description"}," Use your personal Google account to create forms and sheets. Files will be created in your personal Drive. "),d("div",{class:"setup-note"},[d("strong",null,"✅ Ready to use:"),Ne(" No additional setup required. When you create forms, you'll be prompted to sign in with your Google account. ")])],-1)),d("div",gce,[R[22]||(R[22]=d("h4",null,"🌐 Google Workspace (For Organizations)",-1)),R[23]||(R[23]=d("p",{class:"setup-description"}," Use a Google Workspace Shared Drive for organization-wide access and management. ",-1)),d("div",vce,[d("div",xce,[R[20]||(R[20]=d("label",{for:"workspaceDriveName"},"Shared Drive Name:",-1)),we(d("input",{id:"workspaceDriveName","onUpdate:modelValue":R[6]||(R[6]=M=>b.value=M),type:"text",class:"form-input",placeholder:"e.g., CaseManageVue - School Name",disabled:k.value},null,8,yce),[[Ye,b.value]])]),d("button",{onClick:V,class:"primary-btn",disabled:k.value||!b.value.trim()},[k.value?(N(),L("span",_ce,"🔄 Setting up...")):(N(),L("span",bce,"Setup Google Workspace"))],8,Ece),R[21]||(R[21]=d("div",{class:"workspace-note"},[d("strong",null,"Note:"),Ne(" This requires Google Workspace admin permissions and manual configuration. ")],-1))])])])):_e("",!0),y.value?(N(),L("div",{key:3,class:Qe(["alert",E.value])},J(y.value),3)):_e("",!0)]),d("div",Sce,[R[34]||(R[34]=d("h3",null,"Feedback Forms",-1)),ee(s)?(N(),L("div",Ace,"Loading forms...")):ee(i).length===0?(N(),L("div",Tce,R[27]||(R[27]=[d("p",null,"No feedback forms added yet.",-1),d("p",null,'Click "Add Form" to get started.',-1)]))):(N(),L("div",wce,[(N(!0),L(Re,null,Ve(ee(i),M=>(N(),L("div",{key:M.id,class:"form-card"},[d("div",Cce,[d("h4",null,J(M.title||"Untitled Form"),1),d("div",Ice,[d("button",{onClick:O=>S(M),class:"admin-action-btn info",title:"View Form"}," 👁️ ",8,kce),d("button",{onClick:O=>_(M),class:"admin-action-btn edit",title:"Edit Form"}," ✏️ ",8,Dce),d("button",{onClick:O=>A(M),class:"admin-action-btn delete",title:"Delete Form"}," 🗑️ ",8,Pce)])]),d("div",Rce,[d("p",null,[R[28]||(R[28]=d("strong",null,"Created:",-1)),Ne(" "+J(C(M.createdAt)),1)]),M.description?(N(),L("p",Fce,[R[29]||(R[29]=d("strong",null,"Description:",-1)),Ne(" "+J(M.description),1)])):_e("",!0),d("p",null,[R[30]||(R[30]=d("strong",null,"Form URL:",-1)),R[31]||(R[31]=Ne()),d("a",{href:M.formUrl,target:"_blank",class:"form-link"},"Open Form",8,Nce)]),M.spreadsheetUrl?(N(),L("p",Oce,[R[32]||(R[32]=d("strong",null,"Response Sheet:",-1)),d("a",{href:M.spreadsheetUrl,target:"_blank",class:"form-link"},"View Responses",8,Mce),R[33]||(R[33]=d("span",{class:"sheet-status"},"✅ Auto-created",-1))])):(N(),L("p",Lce,"⏳ Sheet will be created when form is first used"))])]))),128))]))])])}}},Uce=yt(Bce,[["__scopeId","data-v-31360789"]]);function $ce(t,e,r){const{getLabel:n}=xo(),s=Se(()=>{var h;const f=((h=r.value)==null?void 0:h.numPeriods)||7;return Array.from({length:f},(p,m)=>({value:m.toString(),label:n(m+1),periodIndex:m}))}),i=Se(()=>{const f=new Set;return console.log("🔍 Finding teachers from students:",t.value.length),t.value.forEach(h=>{var p,m,v,g,y;(p=h.aeries)!=null&&p.schedule&&Object.values(h.aeries.schedule).forEach(E=>{E&&E.teacherId&&(console.log("🔍 Found teacher ID in aeries.schedule:",E.teacherId),f.add(String(E.teacherId)))}),(v=(m=h.app)==null?void 0:m.schedule)!=null&&v.periods&&Object.values(h.app.schedule.periods).forEach(E=>{E&&(console.log("🔍 Found teacher ID in app.schedule.periods:",E),f.add(String(E)))});for(let E=1;E<=7;E++){const b=`period${E}TeacherId`,k=h[b]||((g=h.aeries)==null?void 0:g[b])||((y=h.app)==null?void 0:y[b]);k&&(console.log("🔍 Found teacher ID in",b,":",k),f.add(String(k)))}}),console.log("🔍 Unique teacher IDs found:",Array.from(f)),console.log("🔍 Users available:",e.value.length),Array.from(f).map(h=>{let p=e.value.find(m=>m.id===h);return!p&&/^\d+$/.test(h)&&(p=e.value.find(m=>m.aeriesId===h)),{id:h,name:p?p.name||`${p.firstName} ${p.lastName}`:`Teacher ${h}`,actualUserId:p?p.id:null}}).sort((h,p)=>h.name.localeCompare(p.name))}),a=(f,h=[])=>{let p=-1;if(/^\d+$/.test(f))p=parseInt(f)-1;else if(f==="SH")p=6;else if(f.startsWith("Per")){const m=f.replace("Per","");/^\d+$/.test(m)&&(p=parseInt(m)-1)}return h.includes(p.toString())};return{availablePeriods:s,availableTeachers:i,getStudentsForTeachers:(f,h=[])=>t.value.filter(p=>{var v,g,y,E,b,k,P;if(!(((g=(v=p.app)==null?void 0:v.flags)==null?void 0:g.flag1)||p.flag1||!1))return!1;if((y=p.aeries)!=null&&y.schedule){const w=Object.entries(p.aeries.schedule);for(let x=0;x<w.length;x++){const[S,_]=w[x];if(_&&_.teacherId&&f.includes(String(_.teacherId))&&!a(S,h))return!0}}if((b=(E=p.app)==null?void 0:E.schedule)!=null&&b.periods){const w=Object.entries(p.app.schedule.periods);for(let x=0;x<w.length;x++){const[S,_]=w[x];if(_&&f.includes(String(_))&&!a(S,h))return!0}}for(let w=0;w<7;w++){const x=`period${w+1}TeacherId`,S=p[x]||((k=p.aeries)==null?void 0:k[x])||((P=p.app)==null?void 0:P[x]);if(S&&f.includes(String(S))&&!h.includes(w.toString()))return!0}return!1}),getStudentTeacherPeriods:(f,h,p=[])=>{var v,g,y,E,b;const m=[];if((v=f.aeries)!=null&&v.schedule){const k=Object.entries(f.aeries.schedule);for(let P=0;P<k.length;P++){const[w,x]=k[P];if(x&&x.teacherId&&h.includes(String(x.teacherId))&&!a(w,p)){let S=e.value.find(A=>A.id===String(x.teacherId));!S&&/^\d+$/.test(x.teacherId)&&(S=e.value.find(A=>A.aeriesId===String(x.teacherId)));const _=n(P+1);m.push({period:_,teacherName:S?S.name||`${S.firstName} ${S.lastName}`:`Teacher ${x.teacherId}`})}}}if((y=(g=f.app)==null?void 0:g.schedule)!=null&&y.periods){const k=Object.entries(f.app.schedule.periods);for(let P=0;P<k.length;P++){const[w,x]=k[P];if(x&&h.includes(String(x))&&!a(w,p)){const S=e.value.find(A=>A.id===String(x)),_=n(parseInt(w));m.push({period:_,teacherName:S?S.name||`${S.firstName} ${S.lastName}`:`Teacher ${x}`})}}}for(let k=0;k<7;k++){const P=`period${k+1}TeacherId`,w=f[P]||((E=f.aeries)==null?void 0:E[P])||((b=f.app)==null?void 0:b[P]);if(w&&h.includes(String(w))&&!p.includes(k.toString())){let x=e.value.find(_=>_.id===String(w));!x&&/^\d+$/.test(w)&&(x=e.value.find(_=>_.aeriesId===String(w)));const S=n(k+1);m.push({period:S,teacherName:x?x.name||`${x.firstName} ${x.lastName}`:`Teacher ${w}`})}}return m},generateCSV:()=>{const f=["Student ID","First Name","Last Name","Grade","Case Manager","Assessment Accommodations","Services"],h=t.value.map(m=>{var P,w,x,S,_;const v=ot(m,"firstName")||"",g=ot(m,"lastName")||"",y=ot(m,"grade")||"",E=m.caseManagerId||((w=(P=m.app)==null?void 0:P.studentData)==null?void 0:w.caseManagerId)||"",b=((S=(x=m.app)==null?void 0:x.accommodations)==null?void 0:S.assessment)||[],k=((_=m.app)==null?void 0:_.classServices)||[];return[m.id||"",v,g,y,E,Array.isArray(b)?b.join("; "):b,Array.isArray(k)?k.map(A=>A.name||A).join("; "):k]});return[f,...h].map(m=>m.map(v=>`"${String(v).replace(/"/g,'""')}"`).join(",")).join(`
`)},downloadCSV:(f,h)=>{const p=new Blob([f],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a");m.href=URL.createObjectURL(p),m.download=h,m.click(),URL.revokeObjectURL(m.href)},isPeriodExcluded:a}}const wg="casemanage_linked_sheet_id",l0="Student Data";function gy(){const t=se(!1),e=se(localStorage.getItem(wg)||""),r=se(""),n=se(null),s=se("idle"),i=se(""),a=se(null),o=se("");let l=null;const c=()=>new Promise((x,S)=>{var A,C,T;if((C=(A=window.google)==null?void 0:A.accounts)!=null&&C.oauth2&&((T=window.gapi)!=null&&T.client)){x();return}const _=document.createElement("script");_.src="https://accounts.google.com/gsi/client",_.onload=()=>{a.value=window.google.accounts.oauth2.initTokenClient({client_id:"756483333257-kh1cv865e0buv0cv9g0v1h7ghq7s0e70.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/spreadsheets",callback:V=>{V.access_token?(o.value=V.access_token,t.value=!0,window.gapi.client.setToken({access_token:V.access_token}),l&&(l(V),l=null)):(console.error("Failed to get access token"),l&&(l(null),l=null))}});const D=document.createElement("script");D.src="https://apis.google.com/js/api.js",D.onload=()=>{window.gapi.load("client",async()=>{await window.gapi.client.init({apiKey:"AIzaSyDx1jbQT-FzgzjASFqVA2kbAHWJ_TeUzdY",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]}),x()})},document.head.appendChild(D)},_.onerror=()=>S(new Error("Failed to load Google Identity Services")),document.head.appendChild(_)}),u=async()=>{if(!a.value)throw new Error("Google auth not initialized");if(o.value)try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:"1BxiMVs0XRA5nFMRigcZ_6g3D6P6dNTMhvBSm1x7kFNg"}),{access_token:o.value}}catch{console.log("Token expired, requesting new one"),o.value=""}return new Promise((x,S)=>{l=x;const _=setTimeout(()=>{l=null,S(new Error("Token request timed out"))},3e4),A=a.value.callback;a.value.callback=C=>{clearTimeout(_),a.value.callback=A,C.access_token?(o.value=C.access_token,t.value=!0,window.gapi.client.setToken({access_token:C.access_token}),l&&(l(C),l=null)):(console.error("Failed to get access token:",C),l&&(l(null),l=null))};try{a.value.requestAccessToken()}catch(C){clearTimeout(_),a.value.callback=A,S(C)}})},f=async(x,S=[])=>{var _;try{s.value="syncing",i.value="Creating new Google Sheet...",o.value||await u();const C=((_=Yo().currentUser)==null?void 0:_.email)||"",T=await window.gapi.client.sheets.spreadsheets.create({properties:{title:`CaseManage Student Data - ${new Date().toLocaleDateString()}`,locale:"en_US",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},sheets:[{properties:{title:l0,gridProperties:{rowCount:1e3,columnCount:9,frozenRowCount:1}}}]}),D=T.result.spreadsheetId;e.value=D,r.value=`https://docs.google.com/spreadsheets/d/${D}`,localStorage.setItem(wg,D),await h(x,S);const V=T.result.sheets[0].properties.sheetId;return await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:D,resource:{requests:[{repeatCell:{range:{sheetId:V,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:V,dimension:"COLUMNS",startIndex:0,endIndex:9}}},{addProtectedRange:{protectedRange:{range:{sheetId:V},description:`Read-only protection for ${l0}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),s.value="success",i.value="Sheet created and linked successfully!",n.value=new Date,window.open(r.value,"_blank"),{spreadsheetId:D,url:r.value}}catch(A){throw console.error("Error creating sheet:",A),s.value="error",i.value=`Failed to create sheet: ${A.message}`,A}},h=async(x,S=[])=>{if(!e.value)throw new Error("No linked sheet. Create a sheet first.");try{s.value="syncing",i.value="Updating Google Sheet...",o.value||await u();const _=x.filter(V=>{var R,F;return((F=(R=V.app)==null?void 0:R.flags)==null?void 0:F.flag1)||V.flag1||!1});console.log("🔍 Google Sheets - Original students:",x.length),console.log("🔍 Google Sheets - Filtered students (separate setting only):",_.length),console.log("🔍 Google Sheets - Students data:",_),_&&_.length>0&&console.log("🔍 Google Sheets - First student:",_[0]);const A=["Student ID","First Name","Last Name","Grade","Case Manager","Separate Setting","Assessment Accommodations","Services","Last Updated"],C=_.map(V=>{var B,R,F,M,O,K,j,H,W,X,re,he;return console.log("🔍 Processing student:",V.id,{firstName:V.firstName||((R=(B=V.app)==null?void 0:B.studentData)==null?void 0:R.firstName),lastName:V.lastName||((M=(F=V.app)==null?void 0:F.studentData)==null?void 0:M.lastName),grade:V.grade||((K=(O=V.app)==null?void 0:O.studentData)==null?void 0:K.grade)}),[V.id||"",V.firstName||((H=(j=V.app)==null?void 0:j.studentData)==null?void 0:H.firstName)||"",V.lastName||((X=(W=V.app)==null?void 0:W.studentData)==null?void 0:X.lastName)||"",V.grade||((he=(re=V.app)==null?void 0:re.studentData)==null?void 0:he.grade)||"",m(V,S)||"",y(V)||"",v(V,"assessment")||"",g(V)||"",new Date().toLocaleString()]}),T=[A,...C];console.log("🔍 Google Sheets - Data to write:",T),await window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:e.value,range:`${l0}!A:Z`});const D=await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:e.value,range:`${l0}!A1`,valueInputOption:"RAW",resource:{values:T}});console.log("🔍 Google Sheets - Update response:",D),s.value="success",i.value=`Updated ${C.length} students (separate setting only)`,n.value=new Date}catch(_){throw console.error("Error updating sheet:",_),s.value="error",i.value=`Failed to update: ${_.message}`,_.status===401&&(o.value="",await u()),_}},p=()=>{e.value="",r.value="",localStorage.removeItem(wg),s.value="idle",i.value="",n.value=null},m=(x,S=[])=>{var C,T;const _=x.caseManagerId||((T=(C=x.app)==null?void 0:C.studentData)==null?void 0:T.caseManagerId)||x.casemanager_id;if(!_)return"Not Assigned";const A=S.find(D=>D.id===_);return A&&(A.name||`${A.firstName} ${A.lastName}`||A.email)||_},v=(x,S)=>{var A,C,T;const _=((C=(A=x.app)==null?void 0:A.accommodations)==null?void 0:C[S])||((T=x.accommodations)==null?void 0:T[S])||[];return Array.isArray(_)?_.join(", "):_},g=x=>{var _;const S=((_=x.app)==null?void 0:_.classServices)||x.classServices||[];return Array.isArray(S)?S.map(A=>A.name||A).join(", "):S},y=x=>{var _,A;return((A=(_=x.app)==null?void 0:_.flags)==null?void 0:A.flag1)||x.flag1||!1?"True":"False"},E=async()=>{if(!e.value)return!1;try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:e.value}),!0}catch(x){return x.status===404&&p(),!1}},b=async(x,S,_,A=[],C=[])=>{var T;if(!e.value)throw new Error("No linked sheet. Create a sheet first.");try{o.value||await u();const V=((T=Yo().currentUser)==null?void 0:T.email)||"";console.log("🔍 Creating custom tab:",x,"for teachers:",_,"excluding periods:",C);const R=(await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.value,resource:{requests:[{addSheet:{properties:{title:x,gridProperties:{rowCount:1e3,columnCount:12,frozenRowCount:1}}}}]}})).result.replies[0].addSheet.properties.sheetId;console.log("🔍 Created sheet with ID:",R);const F=S.filter(j=>{var W,X;return((X=(W=j.app)==null?void 0:W.flags)==null?void 0:X.flag1)||j.flag1||!1});console.log("🔍 Custom tab - Original students:",S.length),console.log("🔍 Custom tab - Filtered students (separate setting only):",F.length);const M=["Student ID","First Name","Last Name","Grade","Case Manager","Period","Teacher","Subject","Separate Setting","Assessment Accommodations","Services","Last Updated"],O=[];F.forEach(j=>{const H=k(j,_,A,C);console.log("🔍 Student:",j.id,"Periods found:",H.length,"Excluded periods:",C),H.forEach(W=>{console.log("🔍 Adding row for period:",W.period,"teacher:",W.teacherName,"source:",W.source||"unknown")}),H.forEach(W=>{var X,re,he,ue,pe,q;O.push([j.id||"",j.firstName||((re=(X=j.app)==null?void 0:X.studentData)==null?void 0:re.firstName)||"",j.lastName||((ue=(he=j.app)==null?void 0:he.studentData)==null?void 0:ue.lastName)||"",j.grade||((q=(pe=j.app)==null?void 0:pe.studentData)==null?void 0:q.grade)||"",m(j,A)||"",W.period||"",W.teacherName||"",W.subject||"",y(j)||"",v(j,"assessment")||"",g(j)||"",new Date().toLocaleString()])})});const K=[M,...O];return await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:e.value,range:`${x}!A1`,valueInputOption:"RAW",resource:{values:K}}),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.value,resource:{requests:[{repeatCell:{range:{sheetId:R,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:R,dimension:"COLUMNS",startIndex:0,endIndex:12}}},{addProtectedRange:{protectedRange:{range:{sheetId:R},description:`Read-only protection for ${x}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),console.log("🔍 Custom tab created successfully with",O.length,"rows and read-only protection"),{sheetId:R,rowCount:O.length}}catch(D){throw console.error("Error creating custom tab:",D),D}},k=(x,S,_=[],A=[])=>{var D,V,B,R,F;const C=[];console.log("🔍 getStudentPeriodsForTeachers for student:",x.id,"teacherIds:",S,"excludedPeriods:",A,"excludedPeriods array:",JSON.stringify(A));const T=M=>{let O=-1;if(/^\d+$/.test(M))O=parseInt(M)-1;else if(M==="SH")O=6;else if(M.startsWith("Per")){const K=M.replace("Per","");/^\d+$/.test(K)&&(O=parseInt(K)-1)}return console.log("🔍 Period",M,"maps to index",O,"excluded?",A.includes(O.toString())),A.includes(O.toString())};if((D=x.aeries)!=null&&D.schedule){const M=Object.entries(x.aeries.schedule);console.log("🔍 Aeries schedule entries:",M.length);for(let O=0;O<M.length;O++){const[K,j]=M[O],H=T(K);console.log("🔍 Checking aeries period key:",K,"teacherId:",j==null?void 0:j.teacherId,"excluded?",H),j&&j.teacherId&&S.includes(String(j.teacherId))&&(H?console.log("🔍 Excluding aeries period",K):(console.log("🔍 Including aeries period",K),C.push({period:K.replace("period",""),teacherId:j.teacherId,teacherName:P(j.teacherId,_),subject:j.subject||"",source:"aeries"})))}}if((B=(V=x.app)==null?void 0:V.schedule)!=null&&B.periods){const M=Object.entries(x.app.schedule.periods);console.log("🔍 App schedule entries:",M.length);for(let O=0;O<M.length;O++){const[K,j]=M[O],H=T(K);console.log("🔍 Checking app period key:",K,"teacherId:",j,"excluded?",H),j&&S.includes(String(j))&&(H?console.log("🔍 Excluding app period",K):(console.log("🔍 Including app period",K),C.push({period:K,teacherId:j,teacherName:P(j,_),subject:"",source:"app"})))}}for(let M=0;M<7;M++){const O=`period${M+1}TeacherId`,K=x[O]||((R=x.aeries)==null?void 0:R[O])||((F=x.app)==null?void 0:F[O]);if(K&&S.includes(String(K))){const j=A.includes(M.toString());console.log("🔍 Checking CSV period index",M,"field:",O,"teacherId:",K,"excluded?",j),j?console.log("🔍 Excluding CSV period",M):(console.log("🔍 Including CSV period",M),C.push({period:(M+1).toString(),teacherId:K,teacherName:P(K,_),subject:"",source:"csv"}))}}return console.log("🔍 Final periods for student",x.id,":",C.length,C),C},P=(x,S=[])=>{let _=S.find(A=>A.id===x);return!_&&/^\d+$/.test(x)&&(_=S.find(A=>A.aeriesId===x)),_?_.name||`${_.firstName} ${_.lastName}`||`Teacher ${x}`:`Teacher ${x}`};return{isInitialized:t,linkedSheetId:e,linkedSheetUrl:r,lastSyncTime:n,syncStatus:s,syncMessage:i,initializeGoogleAuth:c,requestAccessToken:u,createLinkedSheet:f,updateSheetData:h,createCustomTab:b,deleteCustomTab:async x=>{if(!e.value)throw new Error("No linked sheet.");try{o.value||await u(),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.value,resource:{requests:[{deleteSheet:{sheetId:x}}]}}),console.log("🔍 Deleted custom tab with sheet ID:",x)}catch(S){throw console.error("Error deleting custom tab:",S),S}},unlinkSheet:p,checkSheetConnection:E}}const Vce=Object.freeze(Object.defineProperty({__proto__:null,useGoogleSheetsRealtime:gy},Symbol.toStringTag,{value:"Module"}));function Hce(t,e,r){const{generateCSV:n,downloadCSV:s}=r,{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeGoogleAuth:u,createLinkedSheet:f,updateSheetData:h,createCustomTab:p,deleteCustomTab:m,unlinkSheet:v,checkSheetConnection:g}=gy();let y=null,E=!1;const b=async()=>{try{const D=localStorage.getItem("casemanage_linked_sheet_id");D&&D.startsWith("1XSL0Sl7")&&(console.log("Clearing old sheet ID that was causing 403 errors"),localStorage.removeItem("casemanage_linked_sheet_id")),await u(),i.value&&await g()&&(await x(),k())}catch(D){console.error("Failed to initialize Google Auth:",D)}};Vt(()=>t.value,(D,V)=>{D&&V&&D!==V&&(E=!0,console.log("📝 Student data changed, will sync on next interval")),D!=null&&D.length},{deep:!0});const k=()=>{y&&clearInterval(y),y=setInterval(async()=>{if(i.value&&E&&l.value!=="syncing")try{console.log("🔄 Hourly auto-sync starting..."),await x(),E=!1,console.log("✅ Hourly auto-sync completed")}catch(D){console.error("❌ Hourly auto-sync failed:",D)}},36e5)},P=()=>{y&&clearInterval(y)},w=async()=>{try{await f(t.value,e.value),k()}catch(D){console.error("Failed to create linked sheet:",D),alert("Failed to create Google Sheet. Please make sure you are signed in to Google.")}},x=async()=>{if(!(!i.value||l.value==="syncing"))try{await h(t.value,e.value)}catch(D){console.error("Failed to sync sheet:",D),alert("Failed to sync sheet. Please try again.")}};return{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeIntegration:b,createLinkedGoogleSheet:w,syncNow:x,openGoogleSheet:()=>{a.value&&(window.open(a.value,"_blank","noopener,noreferrer")||(window.location.href=a.value))},unlinkSheet:v,createCustomTab:p,deleteCustomTab:m,createGoogleSheetWithData:()=>{const D=n();s(D,"student_data.csv"),window.open("https://sheets.new","_blank")},createBlankGoogleSheet:()=>{window.open("https://sheets.new","_blank")},exportToCSV:()=>{const D=n();s(D,"student_data_export.csv")},formatTime:D=>new Date(D).toLocaleString(),setupAutoSync:k,cleanupAutoSync:P}}function jce(t,e){const{getStudentsForTeachers:r}=t,{createCustomTab:n,deleteCustomTab:s}=e,i=se([]),a=se(!1),o=se(""),l=se([]),c=se([]),u=5,f=Se(()=>l.value.length===0?[]:r(l.value,c.value)),h=async g=>{if(!o.value.trim()||l.value.length===0){alert("Please enter a tab name and select at least one teacher");return}if(i.value.length>=u){alert(`Maximum of ${u} custom tabs allowed`);return}try{const y=r(l.value,c.value),E=await n(o.value.trim(),y,l.value,g,c.value),b={id:Date.now().toString(),name:o.value.trim(),teachers:[...l.value],studentCount:E.rowCount,sheetId:E.sheetId};i.value.push(b),m(),console.log("Custom tab added:",b),alert(`Custom tab "${b.name}" created successfully with ${E.rowCount} student entries!`)}catch(y){console.error("Failed to create custom tab:",y),alert("Failed to create custom tab in Google Sheet. Please try again.")}},p=async g=>{const y=i.value.find(E=>E.id===g);if(y&&confirm(`Are you sure you want to remove the "${y.name}" tab?`))try{y.sheetId&&await s(y.sheetId),i.value=i.value.filter(E=>E.id!==g),console.log("Custom tab removed:",g),alert(`Tab "${y.name}" removed successfully.`)}catch(E){console.error("Failed to delete custom tab:",E),alert("Failed to delete tab from Google Sheet. You may need to delete it manually."),i.value=i.value.filter(b=>b.id!==g)}},m=()=>{o.value="",l.value=[],c.value=[],a.value=!1};return{customTabs:i,showAddTabForm:a,newTabName:o,selectedTeachers:l,selectedExcludedPeriods:c,maxCustomTabs:u,filteredStudentsPreview:f,addCustomTab:h,removeCustomTab:p,resetForm:m,toggleAddTabForm:()=>{a.value=!a.value,a.value||m()}}}const Gce={class:"sheets-section"},Wce={key:0,class:"linked-sheet-status"},zce={class:"status-card success"},Kce={class:"sync-info"},qce={key:0},Xce={key:1,class:"syncing"},Yce={key:2,class:"success"},Qce={key:3,class:"error"},Jce={class:"sheet-actions"},Zce=["disabled"],eue={key:1,class:"create-sheet-section"},tue={class:"alternative-options"},rue={class:"button-group"},nue={__name:"GoogleSheetsConnector",props:{linkedSheetId:String,lastSyncTime:[String,Date],syncStatus:String,syncMessage:String},emits:["openGoogleSheet","syncNow","unlinkSheet","createLinkedGoogleSheet","createGoogleSheetWithData","createBlankGoogleSheet","exportToCSV"],setup(t){const e=r=>new Date(r).toLocaleString();return(r,n)=>(N(),L("div",Gce,[n[12]||(n[12]=d("h4",null,"Google Sheets Integration",-1)),t.linkedSheetId?(N(),L("div",Wce,[d("div",zce,[n[7]||(n[7]=d("h5",null,"📊 Linked Google Sheet",-1)),n[8]||(n[8]=d("p",null,"Your student data is synced to Google Sheets",-1)),d("button",{onClick:n[0]||(n[0]=s=>r.$emit("openGoogleSheet")),class:"sheet-link"}," Open Google Sheet → "),d("div",Kce,[t.lastSyncTime?(N(),L("span",qce,"Last synced: "+J(e(t.lastSyncTime)),1)):_e("",!0),t.syncStatus==="syncing"?(N(),L("span",Xce,"🔄 Syncing...")):t.syncStatus==="success"?(N(),L("span",Yce,"✅ Synced")):t.syncStatus==="error"?(N(),L("span",Qce,"❌ "+J(t.syncMessage),1)):_e("",!0)]),n[9]||(n[9]=d("div",{class:"auto-sync-info"},[d("span",{class:"auto-sync-badge"},[d("span",{class:"pulse"}),Ne(" Auto-sync enabled ")]),d("p",{class:"auto-sync-description"}," Changes to student data, accommodations, and services are automatically synced to your Google Sheet. ")],-1)),d("div",Jce,[d("button",{onClick:n[1]||(n[1]=s=>r.$emit("syncNow")),disabled:t.syncStatus==="syncing",class:"btn-sync"}," Sync Now ",8,Zce),d("button",{onClick:n[2]||(n[2]=s=>r.$emit("unlinkSheet")),class:"btn-unlink"}," Unlink Sheet ")])])])):(N(),L("div",eue,[n[10]||(n[10]=Fr('<h5 data-v-ec72cef0>Create a Linked Google Sheet</h5><p data-v-ec72cef0>Link your student data to a Google Sheet that automatically updates when changes are made.</p><div class="features-list" data-v-ec72cef0><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0>🔄</span><span data-v-ec72cef0>Auto-syncs when students are added or updated</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0>📝</span><span data-v-ec72cef0>Updates accommodations and services in real-time</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0>🔗</span><span data-v-ec72cef0>Maintains a live connection to your data</span></div></div>',3)),d("button",{onClick:n[3]||(n[3]=s=>r.$emit("createLinkedGoogleSheet")),class:"btn-primary"}," 🔗 Create & Link Google Sheet ")])),d("div",tue,[n[11]||(n[11]=d("h5",null,"Other Export Options",-1)),d("div",rue,[d("button",{onClick:n[4]||(n[4]=s=>r.$emit("createGoogleSheetWithData")),class:"btn-secondary"}," 📊 Create Google Sheet with Data (One-time) "),d("button",{onClick:n[5]||(n[5]=s=>r.$emit("createBlankGoogleSheet")),class:"btn-secondary"}," 📄 Create Blank Google Sheet "),d("button",{onClick:n[6]||(n[6]=s=>r.$emit("exportToCSV")),class:"btn-secondary"}," 💾 Export to CSV Only ")])])]))}},sue=yt(nue,[["__scopeId","data-v-ec72cef0"]]),aue={class:"preview-section"},iue={class:"preview-table"},oue={key:0},lue={key:0},cue={key:0,class:"preview-note"},Cg=5,uue={__name:"StudentPreview",props:{filteredStudents:{type:Array,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},setup(t){const e=t,r=Se(()=>e.filteredStudents.slice(0,Cg)),n=a=>{const o=ot(a,"firstName")||"",l=ot(a,"lastName")||"";return`${o} ${l}`.trim()},s=a=>ot(a,"grade")||"",i=a=>e.getStudentTeacherPeriods(a,e.selectedTeachers,e.selectedExcludedPeriods);return(a,o)=>(N(),L("div",aue,[d("h6",null,"Preview ("+J(t.filteredStudents.length)+" students)",1),d("div",iue,[d("table",null,[o[0]||(o[0]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Period"),d("th",null,"Teacher")])],-1)),d("tbody",null,[(N(!0),L(Re,null,Ve(r.value,l=>(N(),L("tr",{key:l.id},[d("td",null,J(n(l)),1),d("td",null,J(s(l)),1),d("td",null,[(N(!0),L(Re,null,Ve(i(l),(c,u)=>(N(),L("span",{key:u},[Ne(J(c.period),1),u<i(l).length-1?(N(),L("span",oue,", ")):_e("",!0)]))),128))]),d("td",null,[(N(!0),L(Re,null,Ve(i(l),(c,u)=>(N(),L("span",{key:u},[Ne(J(c.teacherName),1),u<i(l).length-1?(N(),L("span",lue,", ")):_e("",!0)]))),128))])]))),128))])]),t.filteredStudents.length>Cg?(N(),L("p",cue," ... and "+J(t.filteredStudents.length-Cg)+" more students ",1)):_e("",!0)])]))}},due=yt(uue,[["__scopeId","data-v-936b1ce9"]]),fue={class:"custom-tabs-config"},hue={class:"add-tab-controls"},pue=["disabled"],mue={key:0,class:"max-tabs-warning"},gue={key:0,class:"add-tab-form"},vue={class:"form-group"},xue=["value"],yue={class:"form-group"},Eue={class:"teacher-checkboxes"},_ue=["value","checked","onChange"],bue={class:"form-group"},Sue={class:"period-checkboxes"},Aue=["value","checked","onChange"],Tue={class:"form-actions"},wue={key:1,class:"existing-tabs"},Cue={class:"tab-teachers"},Iue=["onClick"],kue={__name:"CustomTabManager",props:{customTabs:{type:Array,required:!0},showAddTabForm:{type:Boolean,required:!0},newTabName:{type:String,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},maxCustomTabs:{type:Number,required:!0},availableTeachers:{type:Array,required:!0},availablePeriods:{type:Array,required:!0},filteredStudentsPreview:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},emits:["toggleAddTabForm","update:newTabName","updateSelectedTeachers","updateSelectedExcludedPeriods","addCustomTab","removeCustomTab","resetForm"],setup(t){return(e,r)=>(N(),L("div",fue,[r[8]||(r[8]=d("h5",null,"Custom Teacher Tabs",-1)),r[9]||(r[9]=d("p",null,"Create custom tabs with data filtered by specific teachers",-1)),d("div",hue,[d("button",{onClick:r[0]||(r[0]=n=>e.$emit("toggleAddTabForm")),disabled:t.customTabs.length>=t.maxCustomTabs,class:"btn-primary"}," + Add Custom Tab ",8,pue),t.customTabs.length>=t.maxCustomTabs?(N(),L("span",mue," Maximum of "+J(t.maxCustomTabs)+" custom tabs allowed ",1)):_e("",!0)]),t.showAddTabForm?(N(),L("div",gue,[d("div",vue,[r[4]||(r[4]=d("label",null,"Tab Name",-1)),d("input",{value:t.newTabName,onInput:r[1]||(r[1]=n=>e.$emit("update:newTabName",n.target.value)),type:"text",class:"form-input",placeholder:"e.g., Math Teachers",maxlength:"30"},null,40,xue)]),d("div",yue,[r[5]||(r[5]=d("label",null,"Select Teachers",-1)),d("div",Eue,[(N(!0),L(Re,null,Ve(t.availableTeachers,n=>(N(),L("label",{key:n.id,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.id,checked:t.selectedTeachers.includes(n.id),onChange:s=>e.$emit("updateSelectedTeachers",n.id,s.target.checked)},null,40,_ue),Ne(" "+J(n.name),1)]))),128))])]),d("div",bue,[r[6]||(r[6]=d("label",null,"Exclude Periods (Optional)",-1)),d("div",Sue,[(N(!0),L(Re,null,Ve(t.availablePeriods,n=>(N(),L("label",{key:n.value,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.value,checked:t.selectedExcludedPeriods.includes(n.value),onChange:s=>e.$emit("updateSelectedExcludedPeriods",n.value,s.target.checked)},null,40,Aue),Ne(" "+J(n.label),1)]))),128))])]),t.selectedTeachers.length>0?(N(),Kr(due,{key:0,"filtered-students":t.filteredStudentsPreview,"selected-teachers":t.selectedTeachers,"selected-excluded-periods":t.selectedExcludedPeriods,"get-student-teacher-periods":t.getStudentTeacherPeriods},null,8,["filtered-students","selected-teachers","selected-excluded-periods","get-student-teacher-periods"])):_e("",!0),d("div",Tue,[d("button",{onClick:r[2]||(r[2]=n=>e.$emit("addCustomTab")),class:"btn-primary"}," Create Tab "),d("button",{onClick:r[3]||(r[3]=n=>e.$emit("resetForm")),class:"btn-secondary"}," Cancel ")])])):_e("",!0),t.customTabs.length>0?(N(),L("div",wue,[r[7]||(r[7]=d("h6",null,"Current Custom Tabs",-1)),(N(!0),L(Re,null,Ve(t.customTabs,n=>(N(),L("div",{key:n.id,class:"tab-item"},[d("div",null,[d("strong",null,J(n.name),1),d("span",Cue,J(n.teachers.length)+" teacher(s), "+J(n.studentCount)+" students ",1)]),d("button",{onClick:s=>e.$emit("removeCustomTab",n.id),class:"btn-danger btn-small"}," Remove ",8,Iue)]))),128))])):_e("",!0)]))}},Due=yt(kue,[["__scopeId","data-v-236484db"]]),Pue={class:"export-options-section"},Rue={class:"export-grid"},Fue={class:"export-card"},Nue={class:"export-card"},Oue={class:"export-card"},Mue={__name:"TestingExportOptions",emits:["createGoogleSheetWithData","createBlankGoogleSheet","exportToCSV"],setup(t){return(e,r)=>(N(),L("div",Pue,[r[12]||(r[12]=d("h4",null,"Export Options",-1)),r[13]||(r[13]=d("p",null,"Additional ways to export and work with your student data",-1)),d("div",Rue,[d("div",Fue,[r[3]||(r[3]=d("div",{class:"export-icon"},"📊",-1)),r[4]||(r[4]=d("h5",null,"Google Sheets with Data",-1)),r[5]||(r[5]=d("p",null,"Create a new Google Sheet and populate it with current student data (one-time export)",-1)),d("button",{onClick:r[0]||(r[0]=n=>e.$emit("createGoogleSheetWithData")),class:"btn-primary"}," Create Sheet with Data ")]),d("div",Nue,[r[6]||(r[6]=d("div",{class:"export-icon"},"📄",-1)),r[7]||(r[7]=d("h5",null,"Blank Google Sheet",-1)),r[8]||(r[8]=d("p",null,"Create a new blank Google Sheet that you can customize yourself",-1)),d("button",{onClick:r[1]||(r[1]=n=>e.$emit("createBlankGoogleSheet")),class:"btn-primary"}," Create Blank Sheet ")]),d("div",Oue,[r[9]||(r[9]=d("div",{class:"export-icon"},"💾",-1)),r[10]||(r[10]=d("h5",null,"CSV Export",-1)),r[11]||(r[11]=d("p",null,"Download student data as a CSV file for use in Excel or other applications",-1)),d("button",{onClick:r[2]||(r[2]=n=>e.$emit("exportToCSV")),class:"btn-primary"}," Download CSV ")])]),r[14]||(r[14]=d("div",{class:"export-info"},[d("h5",null,"Export Information"),d("ul",null,[d("li",null,[d("strong",null,"Linked Sheets:"),Ne(" Automatically sync when data changes")]),d("li",null,[d("strong",null,"One-time Exports:"),Ne(" Snapshot of data at export time")]),d("li",null,[d("strong",null,"CSV Files:"),Ne(" Compatible with Excel, Numbers, and other spreadsheet apps")])])],-1))]))}},Lue=yt(Mue,[["__scopeId","data-v-3bc6896f"]]),Bue={class:"testing-links-container"},Uue={__name:"TestingLinks",setup(t){const{students:e,fetchStudents:r}=Ua(),{userList:n,fetchUsers:s}=ya(),{appSettings:i,loadAppSettings:a}=zs(),o=$ce(e,n,i),{availablePeriods:l,availableTeachers:c,getStudentTeacherPeriods:u}=o,f=Hce(e,n,o),{linkedSheetId:h,lastSyncTime:p,syncStatus:m,syncMessage:v,initializeIntegration:g,createLinkedGoogleSheet:y,syncNow:E,openGoogleSheet:b,unlinkSheet:k,createGoogleSheetWithData:P,createBlankGoogleSheet:w,exportToCSV:x,cleanupAutoSync:S}=f,_=jce(o,f),{customTabs:A,showAddTabForm:C,newTabName:T,selectedTeachers:D,selectedExcludedPeriods:V,maxCustomTabs:B,filteredStudentsPreview:R,addCustomTab:F,removeCustomTab:M,resetForm:O,toggleAddTabForm:K}=_,j=(X,re)=>{if(re)D.value.includes(X)||D.value.push(X);else{const he=D.value.indexOf(X);he>-1&&D.value.splice(he,1)}},H=(X,re)=>{if(re)V.value.includes(X)||V.value.push(X);else{const he=V.value.indexOf(X);he>-1&&V.value.splice(he,1)}},W=async()=>{await F(n.value)};return Ut(async()=>{try{await Promise.all([r(),s(),a()]),console.log("Students loaded:",e.value.length),console.log("Users loaded:",n.value.length),console.log("App settings loaded:",i.value),await g()}catch(X){console.error("Failed to initialize TestingLinks:",X)}}),Ba(()=>{S()}),(X,re)=>(N(),L("div",Bue,[re[1]||(re[1]=d("h3",null,"Testing Links & Google Sheets Integration",-1)),nt(sue,{"linked-sheet-id":ee(h),"last-sync-time":ee(p),"sync-status":ee(m),"sync-message":ee(v),onOpenGoogleSheet:ee(b),onSyncNow:ee(E),onUnlinkSheet:ee(k),onCreateLinkedGoogleSheet:ee(y),onCreateGoogleSheetWithData:ee(P),onCreateBlankGoogleSheet:ee(w),onExportToCsv:ee(x)},null,8,["linked-sheet-id","last-sync-time","sync-status","sync-message","onOpenGoogleSheet","onSyncNow","onUnlinkSheet","onCreateLinkedGoogleSheet","onCreateGoogleSheetWithData","onCreateBlankGoogleSheet","onExportToCsv"]),ee(h)?(N(),Kr(Due,{key:0,"custom-tabs":ee(A),"show-add-tab-form":ee(C),"new-tab-name":ee(T),"selected-teachers":ee(D),"selected-excluded-periods":ee(V),"max-custom-tabs":ee(B),"available-teachers":ee(c),"available-periods":ee(l),"filtered-students-preview":ee(R),"get-student-teacher-periods":ee(u),onToggleAddTabForm:ee(K),"onUpdate:newTabName":re[0]||(re[0]=he=>T.value=he),onUpdateSelectedTeachers:j,onUpdateSelectedExcludedPeriods:H,onAddCustomTab:W,onRemoveCustomTab:ee(M),onResetForm:ee(O)},null,8,["custom-tabs","show-add-tab-form","new-tab-name","selected-teachers","selected-excluded-periods","max-custom-tabs","available-teachers","available-periods","filtered-students-preview","get-student-teacher-periods","onToggleAddTabForm","onRemoveCustomTab","onResetForm"])):_e("",!0),nt(Lue,{onCreateGoogleSheetWithData:ee(P),onCreateBlankGoogleSheet:ee(w),onExportToCsv:ee(x)},null,8,["onCreateGoogleSheetWithData","onCreateBlankGoogleSheet","onExportToCsv"])]))}},$ue=yt(Uue,[["__scopeId","data-v-8d441fb1"]]),Vue={class:"admin-dashboard"},Hue={class:"stats-grid"},jue={class:"stat-card"},Gue={class:"stat-content"},Wue={class:"stat-card"},zue={class:"stat-content"},Kue={class:"stat-card"},que={class:"stat-content"},Xue={class:"stat-card"},Yue={class:"stat-content"},Que={class:"categories-grid"},Jue={class:"category-card"},Zue={class:"category-header"},ede={class:"category-card"},tde={class:"category-header"},rde={class:"category-card"},nde={class:"category-header"},sde={class:"category-card"},ade={class:"category-header"},ide={class:"system-status"},ode={class:"status-grid"},lde={class:"status-card"},cde={class:"sync-status"},ude={class:"sync-item"},dde={key:0,class:"sync-time"},fde={class:"sync-item"},hde={class:"sync-time"},pde={class:"status-card"},mde={class:"user-activity"},gde={class:"activity-item"},vde={class:"activity-count"},xde={class:"activity-item"},yde={class:"activity-count"},Ede={class:"quick-actions"},_de={class:"actions-grid"},bde={__name:"AdminDashboard",emits:["goToCategory","goToStudents"],setup(t){const{students:e,fetchStudents:r}=Ua(),{userList:n,fetchUsers:s}=ya(),{linkedSheetId:i,lastSyncTime:a}=gy(),o=se(12),l=se(8),c=se(!0),u=se("Connected"),f=Se(()=>{var y;return((y=e.value)==null?void 0:y.length)||0}),h=Se(()=>{var y;return((y=n.value)==null?void 0:y.length)||0}),p=Se(()=>{var y;return((y=n.value)==null?void 0:y.filter(E=>E.role==="paraeducator").length)||0}),m=Se(()=>i.value?1:0),v=Se(()=>!!i.value),g=y=>y?new Date(y).toLocaleString():"Never";return Ut(async()=>{try{await Promise.all([r(),s()])}catch(y){console.error("Error loading dashboard data:",y)}}),(y,E)=>(N(),L("div",Vue,[d("div",Hue,[d("div",jue,[E[9]||(E[9]=d("div",{class:"stat-icon"},"👥",-1)),d("div",Gue,[d("h3",null,J(f.value),1),E[8]||(E[8]=d("p",null,"Total Students",-1))])]),d("div",Wue,[E[11]||(E[11]=d("div",{class:"stat-icon"},"👨‍🏫",-1)),d("div",zue,[d("h3",null,J(h.value),1),E[10]||(E[10]=d("p",null,"System Users",-1))])]),d("div",Kue,[E[13]||(E[13]=d("div",{class:"stat-icon"},"🤝",-1)),d("div",que,[d("h3",null,J(p.value),1),E[12]||(E[12]=d("p",null,"Paraeducators",-1))])]),d("div",Xue,[E[15]||(E[15]=d("div",{class:"stat-icon"},"📊",-1)),d("div",Yue,[d("h3",null,J(m.value),1),E[14]||(E[14]=d("p",null,"Linked Sheets",-1))])])]),d("div",Que,[d("div",Jue,[d("div",Zue,[E[16]||(E[16]=d("h2",null,"👥 User & Student Management",-1)),d("button",{onClick:E[0]||(E[0]=b=>y.$emit("goToCategory","users-students")),class:"category-btn"}," Manage → ")]),E[17]||(E[17]=Fr('<div class="category-content" data-v-ecd98979><div class="feature-list" data-v-ecd98979><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>➕</span><div data-v-ecd98979><h4 data-v-ecd98979>Add Users</h4><p data-v-ecd98979>Create new user accounts with role assignments</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>✏️</span><div data-v-ecd98979><h4 data-v-ecd98979>Manage Users</h4><p data-v-ecd98979>Edit existing users, roles, and permissions</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>🎓</span><div data-v-ecd98979><h4 data-v-ecd98979>Student Administration</h4><p data-v-ecd98979>Comprehensive student data management</p></div></div></div></div>',1))]),d("div",ede,[d("div",tde,[E[18]||(E[18]=d("h2",null,"🤝 Aide Management",-1)),d("button",{onClick:E[1]||(E[1]=b=>y.$emit("goToCategory","aide-management")),class:"category-btn"}," Manage → ")]),E[19]||(E[19]=Fr('<div class="category-content" data-v-ecd98979><div class="feature-list" data-v-ecd98979><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>📋</span><div data-v-ecd98979><h4 data-v-ecd98979>Aide Assignment</h4><p data-v-ecd98979>Assign paraeducators to students and periods</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>📅</span><div data-v-ecd98979><h4 data-v-ecd98979>Aide Schedule</h4><p data-v-ecd98979>Manage paraeducator schedules and assignments</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>⏰</span><div data-v-ecd98979><h4 data-v-ecd98979>Time Table</h4><p data-v-ecd98979>Configure school periods and time slots</p></div></div></div></div>',1))]),d("div",rde,[d("div",nde,[E[20]||(E[20]=d("h2",null,"📊 Data & Integration",-1)),d("button",{onClick:E[2]||(E[2]=b=>y.$emit("goToCategory","data-integration")),class:"category-btn"}," Manage → ")]),E[21]||(E[21]=Fr('<div class="category-content" data-v-ecd98979><div class="feature-list" data-v-ecd98979><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>📥</span><div data-v-ecd98979><h4 data-v-ecd98979>SEIS Import</h4><p data-v-ecd98979>Import student data from SEIS system</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>🔗</span><div data-v-ecd98979><h4 data-v-ecd98979>Aeries API &amp; Import</h4><p data-v-ecd98979>Connect to Aeries SIS for data synchronization</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>🧪</span><div data-v-ecd98979><h4 data-v-ecd98979>Testing Links</h4><p data-v-ecd98979>Google Sheets integration and export tools</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>📝</span><div data-v-ecd98979><h4 data-v-ecd98979>Teacher Feedback</h4><p data-v-ecd98979>Manage teacher feedback forms and responses</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>💾</span><div data-v-ecd98979><h4 data-v-ecd98979>Backup &amp; Restore</h4><p data-v-ecd98979>System backup and data restoration tools</p></div></div></div></div>',1))]),d("div",sde,[d("div",ade,[E[22]||(E[22]=d("h2",null,"⚙️ System Configuration",-1)),d("button",{onClick:E[3]||(E[3]=b=>y.$emit("goToCategory","system-config")),class:"category-btn"}," Manage → ")]),E[23]||(E[23]=Fr('<div class="category-content" data-v-ecd98979><div class="feature-list" data-v-ecd98979><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>🔐</span><div data-v-ecd98979><h4 data-v-ecd98979>Permissions</h4><p data-v-ecd98979>Role-based access control and permissions matrix</p></div></div><div class="feature-item" data-v-ecd98979><span class="feature-icon" data-v-ecd98979>🔧</span><div data-v-ecd98979><h4 data-v-ecd98979>App Settings</h4><p data-v-ecd98979>Configure application settings and preferences</p></div></div></div></div>',1))])]),d("div",ide,[E[31]||(E[31]=d("h2",null,"📈 System Status",-1)),d("div",ode,[d("div",lde,[E[26]||(E[26]=d("h3",null,"🔄 Data Sync Status",-1)),d("div",cde,[d("div",ude,[d("span",{class:Qe(["sync-indicator",{active:v.value}])},null,2),E[24]||(E[24]=d("span",null,"Google Sheets",-1)),ee(a)?(N(),L("span",dde,J(g(ee(a))),1)):_e("",!0)]),d("div",fde,[d("span",{class:Qe(["sync-indicator",{active:c.value}])},null,2),E[25]||(E[25]=d("span",null,"Aeries SIS",-1)),d("span",hde,J(u.value),1)])])]),d("div",pde,[E[29]||(E[29]=d("h3",null,"👤 User Activity",-1)),d("div",mde,[d("div",gde,[E[27]||(E[27]=d("span",null,"Active Users Today",-1)),d("span",vde,J(o.value),1)]),d("div",xde,[E[28]||(E[28]=d("span",null,"Recent Logins",-1)),d("span",yde,J(l.value),1)])])]),E[30]||(E[30]=Fr('<div class="status-card" data-v-ecd98979><h3 data-v-ecd98979>📊 System Health</h3><div class="health-indicators" data-v-ecd98979><div class="health-item" data-v-ecd98979><span data-v-ecd98979>Database</span><span class="health-status healthy" data-v-ecd98979>✅ Healthy</span></div><div class="health-item" data-v-ecd98979><span data-v-ecd98979>Functions</span><span class="health-status healthy" data-v-ecd98979>✅ Operational</span></div></div></div>',1))])]),d("div",Ede,[E[36]||(E[36]=d("h2",null,"🚀 Quick Actions",-1)),d("div",_de,[d("button",{onClick:E[4]||(E[4]=b=>y.$emit("goToStudents")),class:"admin-action-btn primary",style:{"min-width":"160px","max-width":"160px",height:"60px","flex-direction":"column",gap:"8px"}},E[32]||(E[32]=[d("span",{class:"action-icon"},"👥",-1),d("span",null,"View Students",-1)])),d("button",{onClick:E[5]||(E[5]=b=>y.$emit("goToCategory","users-students")),class:"admin-action-btn success",style:{"min-width":"160px","max-width":"160px",height:"60px","flex-direction":"column",gap:"8px"}},E[33]||(E[33]=[d("span",{class:"action-icon"},"👨‍🏫",-1),d("span",null,"Manage Users",-1)])),d("button",{onClick:E[6]||(E[6]=b=>y.$emit("goToCategory","aide-management")),class:"admin-action-btn warning",style:{"min-width":"160px","max-width":"160px",height:"60px","flex-direction":"column",gap:"8px"}},E[34]||(E[34]=[d("span",{class:"action-icon"},"🤝",-1),d("span",null,"Aide Management",-1)])),d("button",{onClick:E[7]||(E[7]=b=>y.$emit("goToCategory","data-integration")),class:"admin-action-btn info",style:{"min-width":"160px","max-width":"160px",height:"60px","flex-direction":"column",gap:"8px"}},E[35]||(E[35]=[d("span",{class:"action-icon"},"📊",-1),d("span",null,"Data & Integration",-1)]))])])]))}},Sde=yt(bde,[["__scopeId","data-v-ecd98979"]]);var Ade={};class Tde{constructor(){this.encryptionKey="default-dev-key-replace-in-production",this.encryptionEnabled=!0,console.log("🔒 IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled")}setEncryptionEnabled(e){this.encryptionEnabled=e,console.log("🔒 IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled"),e||console.warn("⚠️ Warning: Encryption disabled in production environment")}encryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log("🔓 Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.encryptField(i);this.setNestedValue(n,s,a)}}),n}decryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log("🔓 Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.decryptField(i);this.setNestedValue(n,s,a)}}),n}encryptField(e){if(!this.encryptionEnabled)return e;try{const r=typeof e=="object"?JSON.stringify(e):String(e);return zi.AES.encrypt(r,this.encryptionKey).toString()}catch(r){return console.error("Encryption failed:",r),e}}decryptField(e){if(!this.encryptionEnabled)return e;try{const n=zi.AES.decrypt(e,this.encryptionKey).toString(zi.enc.Utf8);try{return JSON.parse(n)}catch{return n}}catch(r){return console.error("Decryption failed:",r),e}}getNestedValue(e,r){return r.split(".").reduce((n,s)=>n&&n[s],e)}setNestedValue(e,r,n){const s=r.split("."),i=s.pop(),a=s.reduce((o,l)=>o[l]=o[l]||{},e);return a[i]=n,e}async logAccess(e,r,n){var s,i;try{const a=Ze(bt(ze,"iepAccessLogs"));await Ht(a,{studentId:e,userId:(s=St.currentUser)==null?void 0:s.uid,userEmail:(i=St.currentUser)==null?void 0:i.email,action:r,fields:n,timestamp:Wn(),userAgent:navigator.userAgent,encryptionEnabled:this.encryptionEnabled})}catch(a){console.error("Failed to log access:",a)}}async verifyAccess(e,r="read"){var n,s,i,a,o,l;if(!St.currentUser)return!1;try{const u=(await Jt(Ze(ze,"users",St.currentUser.uid))).data();if(["admin","administrator","sped_chair"].includes(u.role))return!0;if(u.role==="case_manager"){const h=((i=(s=(n=(await Jt(Ze(ze,"students",e))).data())==null?void 0:n.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===St.currentUser.uid;return await this.logAccess(e,`access_attempt_${r}`,{success:h,role:"case_manager"}),h}if(u.role==="teacher"&&r==="read"){const h=((l=(o=(a=(await Jt(Ze(ze,"students",e))).data())==null?void 0:a.app)==null?void 0:o.schedule)==null?void 0:l.periods)||{},p=Object.values(h).includes(St.currentUser.uid);return await this.logAccess(e,`access_attempt_${r}`,{success:p,role:"teacher"}),p}return!1}catch(c){return console.error("Access verification failed:",c),!1}}async getAccessHistory(e){try{const r=nr(bt(ze,"iepAccessLogs"),Rr("studentId","==",e),Rr("timestamp",">=",new Date(Date.now()-2592e6)));return(await $t(r)).docs.map(s=>({id:s.id,...s.data()}))}catch(r){return console.error("Failed to fetch access history:",r),[]}}maskSensitiveData(e){var n,s,i;const r=JSON.parse(JSON.stringify(e));return(n=r.app)!=null&&n.accommodations&&(r.app.accommodations={assessment:"[RESTRICTED]",instruction:"[RESTRICTED]"}),(i=(s=r.app)==null?void 0:s.schedule)!=null&&i.classServices&&(r.app.schedule.classServices=["[RESTRICTED]"]),r}isEncryptionEnabled(){return this.encryptionEnabled}isValueEncrypted(e){try{return typeof e!="string"?!1:(zi.AES.decrypt(e,this.encryptionKey).toString(zi.enc.Utf8),!0)}catch{return!1}}getEncryptionStatus(){return{enabled:this.encryptionEnabled,environment:"production",keyAvailable:!!this.encryptionKey,environmentVariable:Ade.VUE_APP_ENABLE_ENCRYPTION,viteEncryptionValue:null,isViteSet:!1,viteEncryptionEnabled:this.encryptionEnabled}}}const c0=new Tde,wde={class:"debug-encryption"},Cde={class:"debug-header"},Ide={class:"encryption-status"},kde={class:"status-row"},Dde={class:"encryption-toggle"},Pde=["checked"],Rde={key:0,class:"warning"},Fde={class:"status-details"},Nde={class:"status-row"},Ode={class:"status-value"},Mde={class:"status-row"},Lde={class:"status-value"},Bde={class:"status-row"},Ude={class:"status-value"},$de={key:0,class:"env-value-set"},Vde={class:"env-guidance"},Hde={key:0,class:"dev-guidance"},jde={key:1,class:"prod-guidance"},Gde={key:1,class:"env-value-not-set"},Wde={class:"status-row"},zde={class:"status-value"},Kde={key:0,class:"debug-info"},qde={class:"field-name"},Xde={class:"field-value"},Yde={class:"value-preview"},Qde={__name:"DebugEncryption",props:{selectedStudent:{type:Object,default:null}},setup(t){const e=t,r=Se(()=>c0.getEncryptionStatus()),n=Se(()=>c0.isEncryptionEnabled()),s=Se(()=>r.value.environment),i=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],a=()=>{c0.setEncryptionEnabled(!n.value)},o=(u,f)=>f.split(".").reduce((h,p)=>h&&h[p],u),l=u=>{if(!e.selectedStudent)return!1;const f=o(e.selectedStudent,u);return f?c0.isValueEncrypted(f):!1},c=u=>{if(!e.selectedStudent)return"No data";const f=o(e.selectedStudent,u);if(!f)return"Empty";if(l(u))return f.substring(0,20)+"...";const h=typeof f=="object"?JSON.stringify(f):String(f);return h.length>40?h.substring(0,40)+"...":h};return(u,f)=>(N(),L("div",wde,[d("div",Cde,[f[0]||(f[0]=d("h3",null,"🔒 IEP Encryption Control",-1)),d("div",{class:Qe(["environment-badge",s.value])},J(s.value.toUpperCase()),3)]),d("div",Ide,[d("div",kde,[f[1]||(f[1]=d("div",{class:"status-label"},"Status:",-1)),d("div",{class:Qe(["status-value",{enabled:n.value}])},J(n.value?"🔒 Enabled":"🔓 Disabled"),3)]),d("div",Dde,[d("label",null,[d("input",{type:"checkbox",checked:n.value,onChange:a},null,40,Pde),f[2]||(f[2]=Ne(" Toggle Encryption "))]),s.value==="production"&&!n.value?(N(),L("div",Rde," ⚠️ Warning: Encryption disabled in production ")):_e("",!0)]),d("div",Fde,[d("div",Nde,[f[3]||(f[3]=d("div",{class:"status-label"},"Environment:",-1)),d("div",Ode,J(s.value),1)]),d("div",Mde,[f[4]||(f[4]=d("div",{class:"status-label"},"Encryption Key:",-1)),d("div",Lde,J(r.value.keyAvailable?"✅ Available":"❌ Missing"),1)]),d("div",Bde,[f[6]||(f[6]=d("div",{class:"status-label"},"VITE_ENABLE_ENCRYPTION:",-1)),d("div",Ude,[r.value.isViteSet?(N(),L("div",$de,[d("span",{class:Qe(["env-value",{"true-value":r.value.viteEncryptionValue==="true","false-value":r.value.viteEncryptionValue==="false"}])},J(r.value.viteEncryptionValue),3),d("div",Vde,[r.value.viteEncryptionValue==="true"?(N(),L("span",Hde,"🔧 Development mode")):r.value.viteEncryptionValue==="false"?(N(),L("span",jde,"🚀 Production mode")):_e("",!0)])])):(N(),L("div",Gde,f[5]||(f[5]=[d("span",{class:"not-set"},"Not set",-1),d("div",{class:"env-guidance"},[d("span",{class:"default-guidance"},"Defaults to enabled (secure)")],-1)])))])]),d("div",Wde,[f[7]||(f[7]=d("div",{class:"status-label"},"Legacy ENV:",-1)),d("div",zde,J(r.value.environmentVariable||"Not set"),1)])])]),t.selectedStudent?(N(),L("div",Kde,[f[8]||(f[8]=d("h4",null,"Selected Student Data:",-1)),(N(),L(Re,null,Ve(i,h=>d("div",{class:"field-status",key:h},[d("div",qde,J(h)+":",1),d("div",Xde,[d("div",{class:Qe(["encryption-status",{encrypted:l(h)}])},J(l(h)?"🔒 Encrypted":"🔓 Plain Text"),3),d("div",Yde,J(c(h)),1)])])),64))])):_e("",!0)]))}},Kk=yt(Qde,[["__scopeId","data-v-7902f511"]]),Jde={class:"session-debug"},Zde={class:"debug-info"},efe={class:"info-row"},tfe={class:"info-row"},rfe={class:"info-row"},nfe={class:"info-row"},sfe={key:0,class:"info-row"},afe={class:"countdown"},ife={class:"debug-actions"},ofe={class:"timeout-setter"},lfe={__name:"SessionTimeoutDebug",setup(t){const{isEnabled:e,timeoutMinutes:r,showWarning:n,warningCountdown:s,updateSettings:i,resetTimeout:a}=Px(),{currentUser:o}=nf(),l=se(!1),c=se(30),u=se(.17);Ut(()=>{l.value=e.value,c.value=r.value});const f=async()=>{!l.value&&!c.value&&(l.value=e.value,c.value=r.value),await i(!0,u.value),setTimeout(()=>{a()},100)},h=async()=>{await i(l.value,c.value),setTimeout(()=>{a()},100)},p=()=>{document.dispatchEvent(new Event("click"))},m=()=>{};return(v,g)=>(N(),L("div",Jde,[g[8]||(g[8]=d("h4",null,"🔒 Session Timeout Debug",-1)),d("div",Zde,[d("div",efe,[g[1]||(g[1]=d("strong",null,"Timeout Enabled:",-1)),d("span",{class:Qe({"status-active":ee(e),"status-inactive":!ee(e)})},J(ee(e)?"✅ YES":"❌ NO"),3)]),d("div",tfe,[g[2]||(g[2]=d("strong",null,"Timeout Minutes:",-1)),d("span",null,J(ee(r))+" minutes",1)]),d("div",rfe,[g[3]||(g[3]=d("strong",null,"User Logged In:",-1)),d("span",{class:Qe({"status-active":!!ee(o),"status-inactive":!ee(o)})},J(ee(o)?"✅ YES":"❌ NO"),3)]),d("div",nfe,[g[4]||(g[4]=d("strong",null,"Warning Showing:",-1)),d("span",{class:Qe({"status-warning":ee(n),"status-inactive":!ee(n)})},J(ee(n)?"⚠️ YES":"❌ NO"),3)]),ee(n)?(N(),L("div",sfe,[g[5]||(g[5]=d("strong",null,"Countdown:",-1)),d("span",afe,J(ee(s))+"s",1)])):_e("",!0)]),d("div",ife,[d("div",ofe,[d("label",null,[g[7]||(g[7]=Ne(" Set Test Timeout: ")),we(d("select",{"onUpdate:modelValue":g[0]||(g[0]=y=>u.value=y),class:"timeout-select"},g[6]||(g[6]=[Fr('<option value="0.05" data-v-bea6538b>3 seconds</option><option value="0.17" data-v-bea6538b>10 seconds</option><option value="0.5" data-v-bea6538b>30 seconds</option><option value="1" data-v-bea6538b>1 minute</option><option value="2" data-v-bea6538b>2 minutes</option><option value="5" data-v-bea6538b>5 minutes</option>',6)]),512),[[ur,u.value]])]),d("button",{onClick:f,class:"btn btn-warning"}," Apply Test Timeout ")]),d("div",{class:"admin-action-btns"},[d("button",{onClick:p,class:"admin-action-btn",style:{"min-width":"120px","max-width":"120px"}}," Trigger Activity "),d("button",{onClick:m,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Show Console Info "),d("button",{onClick:h,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Original ")])])]))}},cfe=yt(lfe,[["__scopeId","data-v-bea6538b"]]),ufe={class:"security-control-center"},dfe={class:"security-section"},ffe={class:"security-section"},hfe={class:"log-controls"},pfe={class:"log-filters"},mfe={key:0,class:"log-stats"},gfe={class:"stat-card"},vfe={class:"stat-number"},xfe={class:"stat-card"},yfe={class:"stat-number error"},Efe={class:"stat-card"},_fe={class:"stat-number"},bfe={class:"stat-card"},Sfe={class:"stat-number"},Afe={key:1,class:"log-table"},Tfe=["onClick"],wfe={class:"log-pagination"},Cfe=["disabled"],Ife=["disabled"],kfe={key:2,class:"no-logs"},Dfe={class:"security-section"},Pfe={class:"setting-group"},Rfe={key:0,class:"setting-group"},Ffe={class:"setting-group"},Nfe={class:"setting-group"},Ofe={class:"security-section"},Mfe={class:"setting-group"},Lfe={class:"setting-group"},Bfe={class:"setting-group"},Ufe={class:"security-section"},$fe={class:"ip-list"},Vfe={class:"ip-input"},Hfe={key:0,class:"ip-table"},jfe=["onClick"],Gfe={key:1,class:"no-ips"},Wfe={class:"security-section"},zfe={class:"alert-settings"},Kfe={class:"setting-group"},qfe={class:"setting-group"},Xfe={class:"setting-group"},Yfe={class:"alert-emails"},Qfe={class:"email-input"},Jfe={key:0,class:"email-list"},Zfe=["onClick"],Ig=50,e0e={__name:"SecurityControlCenter",props:{selectedStudent:{type:Object,default:null}},setup(t){const e=se([]),r=se(1),n=se(""),s=se(""),i=se(""),a=se(1),o=Se(()=>{let q=e.value;if(n.value&&(q=q.filter(G=>G.type===n.value)),s.value&&(q=q.filter(G=>G.action&&G.action.toLowerCase().includes(s.value.toLowerCase()))),i.value){const G=i.value.toLowerCase();q=q.filter(oe=>oe.userEmail&&oe.userEmail.toLowerCase().includes(G)||oe.performedByEmail&&oe.performedByEmail.toLowerCase().includes(G)||oe.action&&oe.action.toLowerCase().includes(G)||oe.studentId&&oe.studentId.toLowerCase().includes(G)||oe.targetUserId&&oe.targetUserId.toLowerCase().includes(G))}return q}),l=Se(()=>{const q=(a.value-1)*Ig,G=q+Ig;return o.value.slice(q,G)}),c=Se(()=>Math.ceil(o.value.length/Ig)),u=Se(()=>{if(e.value.length===0)return null;const q=e.value.filter(Q=>Q.action&&(Q.action.includes("failed")||Q.action.includes("error")||Q.action.includes("unauthorized")||Q.details&&Q.details.success===!1)).length,G=new Set(e.value.map(Q=>Q.userEmail||Q.performedByEmail).filter(Q=>Q)).size,oe=e.value.filter(Q=>Q.action&&(Q.action.includes("admin")||Q.type==="user_management"||Q.action.includes("delete"))).length;return{total:e.value.length,failed:q,uniqueUsers:G,adminActions:oe}}),{isEnabled:f,timeoutMinutes:h,updateSettings:p}=Px(),m=se(!1),v=se(!1),g=se(!0),y=se(!0),E=se(5),b=se([]),k=se(""),P=se({failedLogins:!0,unusualAccess:!0,bulkExport:!0}),w=se([]),x=se(""),S=async()=>{try{const q=new Date;q.setDate(q.getDate()-r.value);try{const Q=nr(bt(ze,"auditLogs"),Rr("timestamp",">=",q),Gr("timestamp","desc"),Ts(100)),Y=await $t(Q);if(e.value=Y.docs.map(Z=>({id:Z.id,...Z.data()})),e.value.length>0){console.log("📋 Loaded",e.value.length,"audit logs");return}}catch{console.log("📋 No audit logs found, trying legacy iepAccessLogs")}const G=nr(bt(ze,"iepAccessLogs"),Rr("timestamp",">=",q),Gr("timestamp","desc"),Ts(100)),oe=await $t(G);e.value=oe.docs.map(Q=>({id:Q.id,...Q.data()})),console.log("📋 Loaded",e.value.length,"legacy access logs")}catch(q){console.error("Failed to fetch logs:",q),e.value=[]}},_=q=>{if(!q)return"";const G=q.toDate();return new Intl.DateTimeFormat("en-US",{dateStyle:"short",timeStyle:"short"}).format(G)},A=q=>{switch(q){case"student_access":return"Student Access";case"user_management":return"User Management";case"system_access":return"System Access";case"data_export":return"Data Export";default:return q}},C=q=>q?q.split("_").map(G=>G.charAt(0).toUpperCase()+G.slice(1)).join(" "):"N/A",T=q=>q.studentId?`Student ID: ${q.studentId}`:q.targetUserId?`User ID: ${q.targetUserId}`:q.targetDocumentId?`Document ID: ${q.targetDocumentId}`:q.targetFileName?`File: ${q.targetFileName}`:"N/A",D=q=>q.action&&(q.action.includes("failed")||q.action.includes("error")||q.action.includes("unauthorized"))?"error":q.action&&(q.action.includes("success")||q.action.includes("created")||q.action.includes("edited")||q.action.includes("viewed"))?"success":"",V=q=>q.action&&(q.action.includes("failed")||q.action.includes("error")||q.action.includes("unauthorized"))?"Failed":q.action&&(q.action.includes("success")||q.action.includes("created")||q.action.includes("edited")||q.action.includes("viewed"))?"Success":"N/A",B=q=>q.action&&(q.action.includes("failed")||q.action.includes("error")||q.action.includes("unauthorized"))?"error-row":q.action&&(q.action.includes("success")||q.action.includes("created")||q.action.includes("edited")||q.action.includes("viewed"))?"success-row":"",R=q=>{console.log("Viewing log details:",q)},F=async()=>{try{await p(f.value,h.value)}catch(q){console.error("Failed to toggle session timeout:",q)}},M=async()=>{try{await p(f.value,h.value)}catch(q){console.error("Failed to update session timeout:",q)}},O=()=>{console.log("Password policy updated:",m.value)},K=()=>{console.log("MFA policy updated:",v.value)},j=()=>{console.log("Export policy updated:",g.value)},H=()=>{console.log("PDF policy updated:",y.value)},W=()=>{console.log("Login policy updated:",E.value)},X=()=>{k.value&&!b.value.includes(k.value)&&(b.value.push(k.value),k.value="")},re=q=>{b.value=b.value.filter(G=>G!==q)},he=()=>{console.log("Alert settings updated:",P.value)},ue=()=>{x.value&&!w.value.includes(x.value)&&(w.value.push(x.value),x.value="")},pe=q=>{w.value=w.value.filter(G=>G!==q)};return Ut(()=>{S()}),(q,G)=>(N(),L("div",ufe,[d("div",dfe,[G[19]||(G[19]=d("h3",null,"🔒 IEP Data Encryption",-1)),nt(Kk,{"selected-student":t.selectedStudent},null,8,["selected-student"])]),d("div",ffe,[G[28]||(G[28]=d("h3",null,"📋 Comprehensive Audit Logs",-1)),d("div",hfe,[d("div",pfe,[we(d("select",{"onUpdate:modelValue":G[0]||(G[0]=oe=>r.value=oe),class:"form-select"},G[20]||(G[20]=[d("option",{value:"1"},"Last 24 hours",-1),d("option",{value:"7"},"Last 7 days",-1),d("option",{value:"30"},"Last 30 days",-1),d("option",{value:"90"},"Last 90 days",-1)]),512),[[ur,r.value]]),we(d("select",{"onUpdate:modelValue":G[1]||(G[1]=oe=>n.value=oe),class:"form-select"},G[21]||(G[21]=[Fr('<option value="" data-v-7c5b56ed>All Log Types</option><option value="student_access" data-v-7c5b56ed>Student Access</option><option value="user_management" data-v-7c5b56ed>User Management</option><option value="system_access" data-v-7c5b56ed>System Access</option><option value="data_export" data-v-7c5b56ed>Data Export</option>',5)]),512),[[ur,n.value]]),we(d("select",{"onUpdate:modelValue":G[2]||(G[2]=oe=>s.value=oe),class:"form-select"},G[22]||(G[22]=[Fr('<option value="" data-v-7c5b56ed>All Actions</option><option value="login" data-v-7c5b56ed>Login</option><option value="logout" data-v-7c5b56ed>Logout</option><option value="create" data-v-7c5b56ed>Create</option><option value="edit" data-v-7c5b56ed>Edit</option><option value="delete" data-v-7c5b56ed>Delete</option><option value="view" data-v-7c5b56ed>View</option><option value="admin_panel_access" data-v-7c5b56ed>Admin Access</option>',8)]),512),[[ur,s.value]]),we(d("input",{"onUpdate:modelValue":G[3]||(G[3]=oe=>i.value=oe),type:"text",placeholder:"Search logs...",class:"form-input"},null,512),[[Ye,i.value]]),d("button",{onClick:S,class:"btn btn-secondary"}," 🔄 Refresh "),d("button",{onClick:G[4]||(G[4]=(...oe)=>q.exportLogs&&q.exportLogs(...oe)),class:"btn btn-primary"}," 📊 Export Logs ")])]),u.value?(N(),L("div",mfe,[d("div",gfe,[G[23]||(G[23]=d("h4",null,"Total Events",-1)),d("span",vfe,J(u.value.total),1)]),d("div",xfe,[G[24]||(G[24]=d("h4",null,"Failed Events",-1)),d("span",yfe,J(u.value.failed),1)]),d("div",Efe,[G[25]||(G[25]=d("h4",null,"Unique Users",-1)),d("span",_fe,J(u.value.uniqueUsers),1)]),d("div",bfe,[G[26]||(G[26]=d("h4",null,"Admin Actions",-1)),d("span",Sfe,J(u.value.adminActions),1)])])):_e("",!0),o.value.length?(N(),L("div",Afe,[d("table",null,[G[27]||(G[27]=d("thead",null,[d("tr",null,[d("th",null,"Time"),d("th",null,"Type"),d("th",null,"User"),d("th",null,"Action"),d("th",null,"Target"),d("th",null,"Status"),d("th",null,"Details")])],-1)),d("tbody",null,[(N(!0),L(Re,null,Ve(l.value,oe=>(N(),L("tr",{key:oe.id,class:Qe(B(oe))},[d("td",null,J(_(oe.timestamp)),1),d("td",null,[d("span",{class:Qe(["log-type-badge",oe.type])},J(A(oe.type)),3)]),d("td",null,J(oe.userEmail||oe.performedByEmail||"System"),1),d("td",null,J(C(oe.action)),1),d("td",null,J(T(oe)),1),d("td",null,[d("span",{class:Qe(D(oe))},J(V(oe)),3)]),d("td",null,[d("button",{onClick:Q=>R(oe),class:"btn-link"}," 👁️ View ",8,Tfe)])],2))),128))])]),d("div",wfe,[d("button",{onClick:G[5]||(G[5]=oe=>a.value--),disabled:a.value<=1,class:"btn btn-secondary"}," Previous ",8,Cfe),d("span",null,"Page "+J(a.value)+" of "+J(c.value),1),d("button",{onClick:G[6]||(G[6]=oe=>a.value++),disabled:a.value>=c.value,class:"btn btn-secondary"}," Next ",8,Ife)])])):e.value.length===0?(N(),L("div",kfe," No audit logs found for selected criteria ")):_e("",!0)]),d("div",Dfe,[G[35]||(G[35]=d("h3",null,"⏲️ Session Security",-1)),nt(cfe),d("div",Pfe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[7]||(G[7]=oe=>Tr(f)?f.value=oe:null),onChange:F},null,544),[[_t,ee(f)]]),G[29]||(G[29]=Ne(" Enable Auto Logout Timer "))]),G[30]||(G[30]=d("div",{class:"setting-description"}," Automatically log out users after a period of inactivity ",-1))]),ee(f)?(N(),L("div",Rfe,[d("label",null,[G[31]||(G[31]=Ne(" Auto Logout Timer (minutes): ")),we(d("input",{type:"number","onUpdate:modelValue":G[8]||(G[8]=oe=>Tr(h)?h.value=oe:null),min:"5",max:"120",onChange:M},null,544),[[Ye,ee(h)]])]),G[32]||(G[32]=d("div",{class:"setting-description"}," Users will be automatically logged out after this period of inactivity ",-1))])):_e("",!0),d("div",Ffe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[9]||(G[9]=oe=>m.value=oe),onChange:O},null,544),[[_t,m.value]]),G[33]||(G[33]=Ne(" Enforce Password Change Every 90 Days "))])]),d("div",Nfe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[10]||(G[10]=oe=>v.value=oe),onChange:K},null,544),[[_t,v.value]]),G[34]||(G[34]=Ne(" Require Two-Factor Authentication for Admin Access "))])])]),d("div",Ofe,[G[39]||(G[39]=d("h3",null,"🔑 Data Access Controls",-1)),d("div",Mfe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[11]||(G[11]=oe=>g.value=oe),onChange:j},null,544),[[_t,g.value]]),G[36]||(G[36]=Ne(" Restrict Data Export to Admins Only "))])]),d("div",Lfe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[12]||(G[12]=oe=>y.value=oe),onChange:H},null,544),[[_t,y.value]]),G[37]||(G[37]=Ne(" Add Watermark to Exported PDFs "))])]),d("div",Bfe,[d("label",null,[G[38]||(G[38]=Ne(" Maximum Failed Login Attempts: ")),we(d("input",{type:"number","onUpdate:modelValue":G[13]||(G[13]=oe=>E.value=oe),min:"3",max:"10",onChange:W},null,544),[[Ye,E.value]])])])]),d("div",Ufe,[G[40]||(G[40]=d("h3",null,"🌐 IP Access Control",-1)),d("div",$fe,[d("div",Vfe,[we(d("input",{type:"text","onUpdate:modelValue":G[14]||(G[14]=oe=>k.value=oe),placeholder:"Enter IP address or range"},null,512),[[Ye,k.value]]),d("button",{onClick:X,class:"btn btn-primary"}," Add IP ")]),b.value.length?(N(),L("div",Hfe,[(N(!0),L(Re,null,Ve(b.value,oe=>(N(),L("div",{key:oe,class:"ip-row"},[d("span",null,J(oe),1),d("button",{onClick:Q=>re(oe),class:"btn btn-danger btn-sm"}," Remove ",8,jfe)]))),128))])):(N(),L("div",Gfe," No IP restrictions configured "))])]),d("div",Wfe,[G[45]||(G[45]=d("h3",null,"🚨 Security Alerts",-1)),d("div",zfe,[d("div",Kfe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[15]||(G[15]=oe=>P.value.failedLogins=oe),onChange:he},null,544),[[_t,P.value.failedLogins]]),G[41]||(G[41]=Ne(" Alert on Multiple Failed Login Attempts "))])]),d("div",qfe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[16]||(G[16]=oe=>P.value.unusualAccess=oe),onChange:he},null,544),[[_t,P.value.unusualAccess]]),G[42]||(G[42]=Ne(" Alert on Unusual Access Patterns "))])]),d("div",Xfe,[d("label",null,[we(d("input",{type:"checkbox","onUpdate:modelValue":G[17]||(G[17]=oe=>P.value.bulkExport=oe),onChange:he},null,544),[[_t,P.value.bulkExport]]),G[43]||(G[43]=Ne(" Alert on Bulk Data Exports "))])]),d("div",Yfe,[G[44]||(G[44]=d("h4",null,"Alert Recipients:",-1)),d("div",Qfe,[we(d("input",{type:"email","onUpdate:modelValue":G[18]||(G[18]=oe=>x.value=oe),placeholder:"Enter email address"},null,512),[[Ye,x.value]]),d("button",{onClick:ue,class:"btn btn-primary"}," Add ")]),w.value.length?(N(),L("div",Jfe,[(N(!0),L(Re,null,Ve(w.value,oe=>(N(),L("div",{key:oe,class:"email-row"},[d("span",null,J(oe),1),d("button",{onClick:Q=>pe(oe),class:"btn btn-danger btn-sm"}," Remove ",8,Zfe)]))),128))])):_e("",!0)])])])]))}},t0e=yt(e0e,[["__scopeId","data-v-7c5b56ed"]]),r0e={class:"card-header"},n0e={class:"component-info"},s0e={class:"component-name"},a0e={class:"component-description"},i0e={class:"card-body"},o0e={class:"status-details"},l0e={class:"detail-row"},c0e={key:0,class:"detail-row"},u0e={key:1,class:"detail-row"},d0e={class:"detail-value"},f0e={key:0,class:"errors-section"},h0e={class:"errors-list"},p0e={class:"card-actions"},m0e=["disabled"],g0e={key:1,class:"details-section"},v0e={class:"details-content"},x0e={class:"detail-item"},y0e={class:"detail-item"},E0e={key:0,class:"detail-item"},_0e={class:"detail-item"},b0e={key:0,class:"loading-overlay"},S0e={__name:"ComponentHealthCard",props:{component:{type:Object,required:!0}},emits:["test","toggle"],setup(t){const e=t,r=se(!1),n=se(!1);Vt(()=>e.component.status,(u,f)=>{f==="checking"&&u!=="checking"?n.value=!1:u==="checking"&&(n.value=!0)},{immediate:!0});const s=u=>{switch(u){case"operational":return"✅";case"degraded":return"⚠️";case"down":return"❌";case"disabled":return"⏸️";case"checking":return"🔄";default:return"❓"}},i=u=>{switch(u){case"operational":return"Healthy";case"degraded":return"Issues";case"down":return"Failed";case"disabled":return"Disabled";case"checking":return"Testing...";default:return"Unknown"}},a=u=>u<100?"latency-good":u<500?"latency-ok":"latency-poor",o=u=>u?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(u):"Never",l=u=>u?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(u):"Never",c=u=>u.toLowerCase().replace(/\s+/g,"-");return(u,f)=>(N(),L("div",{class:Qe(["health-card",[t.component.status,{disabled:!t.component.enabled}]])},[d("div",r0e,[d("div",n0e,[d("h4",s0e,J(t.component.name),1),d("p",a0e,J(t.component.description),1)]),d("div",{class:Qe(["status-indicator",t.component.status])},J(s(t.component.status)),3)]),d("div",i0e,[d("div",o0e,[d("div",l0e,[f[3]||(f[3]=d("span",{class:"detail-label"},"Status:",-1)),d("span",{class:Qe(["detail-value",t.component.status])},J(i(t.component.status)),3)]),t.component.latency!==null?(N(),L("div",c0e,[f[4]||(f[4]=d("span",{class:"detail-label"},"Latency:",-1)),d("span",{class:Qe(["detail-value",a(t.component.latency)])},J(t.component.latency)+"ms ",3)])):_e("",!0),t.component.lastCheck?(N(),L("div",u0e,[f[5]||(f[5]=d("span",{class:"detail-label"},"Last Check:",-1)),d("span",d0e,J(o(t.component.lastCheck)),1)])):_e("",!0)]),t.component.errors&&t.component.errors.length?(N(),L("div",f0e,[f[6]||(f[6]=d("div",{class:"errors-header"},"⚠️ Issues:",-1)),d("ul",h0e,[(N(!0),L(Re,null,Ve(t.component.errors,h=>(N(),L("li",{key:h,class:"error-item"},J(h),1))),128))])])):_e("",!0),d("div",p0e,[d("button",{onClick:f[0]||(f[0]=h=>u.$emit("test",t.component)),disabled:n.value,class:"btn btn-primary btn-sm"},J(n.value?"🔄":"🧪")+" Test ",9,m0e),d("button",{onClick:f[1]||(f[1]=h=>u.$emit("toggle",t.component)),class:Qe(["btn btn-sm",t.component.enabled?"btn-warning":"btn-success"])},J(t.component.enabled?"⏸️ Disable":"▶️ Enable"),3),d("button",{onClick:f[2]||(f[2]=h=>r.value=!r.value),class:"btn btn-secondary btn-sm"},J(r.value?"👁️‍🗨️ Less":"👁️ More"),1)]),r.value?(N(),L("div",g0e,[d("div",v0e,[d("div",x0e,[f[7]||(f[7]=d("strong",null,"Test Function:",-1)),Ne(" "+J(t.component.testFunction||"N/A"),1)]),d("div",y0e,[f[8]||(f[8]=d("strong",null,"Enabled:",-1)),Ne(" "+J(t.component.enabled?"Yes":"No"),1)]),t.component.lastCheck?(N(),L("div",E0e,[f[9]||(f[9]=d("strong",null,"Last Test:",-1)),Ne(" "+J(l(t.component.lastCheck)),1)])):_e("",!0),d("div",_0e,[f[10]||(f[10]=d("strong",null,"Component ID:",-1)),Ne(" "+J(c(t.component.name)),1)])])])):_e("",!0)]),n.value?(N(),L("div",b0e,f[11]||(f[11]=[d("div",{class:"loading-spinner"},"🔄",-1),d("div",{class:"loading-text"},"Testing component...",-1)]))):_e("",!0)],2))}},C2=yt(S0e,[["__scopeId","data-v-18cc0437"]]),A0e={class:"health-dashboard"},T0e={class:"dashboard-header"},w0e={class:"header-controls"},C0e=["disabled"],I0e={key:0,class:"last-update"},k0e={class:"status-overview"},D0e={class:"status-icon"},P0e={class:"status-info"},R0e={class:"status-details"},F0e={class:"component-categories"},N0e={class:"category-section"},O0e={class:"components-grid"},M0e={class:"category-section"},L0e={class:"components-grid"},B0e={class:"quick-actions"},U0e={class:"admin-action-btns"},$0e=["disabled"],V0e={class:"logs-section"},H0e={class:"logs-container"},j0e={class:"log-time"},G0e={class:"log-component"},W0e={class:"log-message"},z0e={key:0,class:"no-logs"},K0e={class:"modal-header"},q0e={class:"modal-content"},X0e={__name:"ComponentHealthDashboard",setup(t){const e=se(!1),r=se(null),n=se(!1),s=se({}),i=se([]),a=se(!1),o=se([{name:"Firebase Auth",status:"operational",description:"User authentication service",lastCheck:new Date,enabled:!0,latency:150,errors:[]},{name:"Firestore Database",status:"operational",description:"Main database service",lastCheck:new Date,enabled:!0,latency:200,errors:[]},{name:"Firebase Storage",status:"operational",description:"File storage service",lastCheck:new Date,enabled:!0,latency:180,errors:[]},{name:"Cloud Functions",status:"operational",description:"Server-side functions",lastCheck:new Date,enabled:!0,latency:300,errors:[]}]),l=se([{name:"Session Timeout",status:"operational",description:"Automatic user logout system",lastCheck:new Date,enabled:!0,latency:50,errors:[]},{name:"IEP Encryption",status:"operational",description:"Sensitive data encryption",lastCheck:new Date,enabled:!0,latency:80,errors:[]},{name:"Access Control",status:"operational",description:"Role-based permissions",lastCheck:new Date,enabled:!0,latency:120,errors:[]},{name:"Audit Logging",status:"operational",description:"Activity tracking system",lastCheck:new Date,enabled:!0,latency:90,errors:[]}]),c=Se(()=>[...o.value,...l.value]),u=Se(()=>c.value.length),f=Se(()=>c.value.filter(S=>S.status==="operational").length),h=Se(()=>{const S=c.value.map(_=>_.status);return S.every(_=>_==="operational"||_==="disabled")?"operational":S.some(_=>_==="down"||_==="error")?"down":"degraded"}),p=S=>{switch(S){case"operational":return"✅";case"degraded":return"⚠️";case"down":return"❌";case"disabled":return"⏸️";default:return"🔄"}},m=S=>{switch(S){case"operational":return"All systems operational";case"degraded":return"Some issues detected";case"down":return"Critical issues found";case"checking":return"Running diagnostics...";default:return"Unknown status"}},v=S=>S?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(S):"",g=(S,_,A="info")=>{i.value.unshift({id:Date.now()+Math.random(),timestamp:new Date,component:S,message:_,type:A}),i.value.length>20&&(i.value=i.value.slice(0,20))},y=async S=>{g(S.name,"Starting component test...","info");try{const _=performance.now();await new Promise(T=>setTimeout(T,Math.random()*1e3+500));const A=Math.round(performance.now()-_),C=c.value.find(T=>T.name===S.name);C&&(C.status=Math.random()>.1?"operational":"degraded",C.latency=A,C.lastCheck=new Date,C.errors=C.status==="degraded"?["Minor performance issue detected"]:[]),g(S.name,`Test completed - ${C.status} (${A}ms)`,C.status==="operational"?"success":"warning"),s.value={component:S.name,data:{status:C.status,latency:`${A}ms`,timestamp:new Date().toISOString(),details:C.status==="operational"?"All checks passed successfully":"Minor performance issues detected"}},n.value=!0}catch(_){g(S.name,`Test failed: ${_.message}`,"error")}},E=S=>{const _=c.value.find(A=>A.name===S.name);_&&(_.enabled=!_.enabled,_.status=_.enabled?"operational":"disabled",g(S.name,`Component ${_.enabled?"enabled":"disabled"}`,"info"))},b=async()=>{if(!e.value){e.value=!0,r.value=new Date,g("System","Starting full system refresh...","info");try{const S=c.value.filter(_=>_.enabled).map(_=>y(_));await Promise.all(S),g("System","Full system refresh completed","success")}catch(S){g("System",`Refresh failed: ${S.message}`,"error")}finally{e.value=!1}}},k=async()=>{a.value=!0,g("System","Starting comprehensive system test...","info");try{await b(),g("System","Comprehensive system test completed","success")}catch(S){g("System",`System test failed: ${S.message}`,"error")}finally{a.value=!1}},P=()=>{const S={timestamp:new Date().toISOString(),overallStatus:h.value,components:c.value.map(T=>({name:T.name,status:T.status,enabled:T.enabled,latency:T.latency,lastCheck:T.lastCheck,errors:T.errors})),logs:i.value.slice(0,10)},_=new Blob([JSON.stringify(S,null,2)],{type:"application/json"}),A=URL.createObjectURL(_),C=document.createElement("a");C.href=A,C.download=`health-report-${Date.now()}.json`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(A),g("System","Health report exported","info")},w=()=>{i.value=[]},x=()=>{n.value=!1,s.value={}};return Ut(()=>{g("System","Component Health Dashboard initialized","success")}),(S,_)=>(N(),L("div",A0e,[d("div",T0e,[_[1]||(_[1]=d("h2",null,"🔧 Component Health Dashboard",-1)),d("div",w0e,[d("button",{onClick:b,disabled:e.value,class:"btn btn-primary"},J(e.value?"🔄 Refreshing...":"🔄 Refresh All"),9,C0e),r.value?(N(),L("span",I0e," Last update: "+J(v(r.value)),1)):_e("",!0)])]),d("div",k0e,[d("div",{class:Qe(["status-card overall",h.value])},[d("div",D0e,J(p(h.value)),1),d("div",P0e,[_[2]||(_[2]=d("h3",null,"System Status",-1)),d("p",null,J(m(h.value)),1),d("div",R0e,J(f.value)+"/"+J(u.value)+" components healthy ",1)])],2)]),d("div",F0e,[d("div",N0e,[_[3]||(_[3]=d("h3",null,"🔧 Core Services",-1)),d("div",O0e,[(N(!0),L(Re,null,Ve(o.value,A=>(N(),Kr(C2,{key:A.name,component:A,onTest:y,onToggle:E},null,8,["component"]))),128))])]),d("div",M0e,[_[4]||(_[4]=d("h3",null,"🔐 Authentication & Security",-1)),d("div",L0e,[(N(!0),L(Re,null,Ve(l.value,A=>(N(),Kr(C2,{key:A.name,component:A,onTest:y,onToggle:E},null,8,["component"]))),128))])])]),d("div",B0e,[_[5]||(_[5]=d("h3",null,"⚡ Quick Tests",-1)),d("div",U0e,[d("button",{onClick:k,disabled:a.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},J(a.value?"🧪 Testing...":"🧪 Full System Test"),9,$0e),d("button",{onClick:P,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," 📋 Export Report ")])]),d("div",V0e,[d("div",{class:"logs-header"},[_[6]||(_[6]=d("h3",null,"📝 Component Activity Logs",-1)),d("div",{class:"log-controls"},[d("button",{onClick:w,class:"btn btn-sm btn-secondary"},"Clear")])]),d("div",H0e,[(N(!0),L(Re,null,Ve(i.value,A=>(N(),L("div",{key:A.id,class:Qe(["log-entry",A.type])},[d("span",j0e,J(v(A.timestamp)),1),d("span",G0e,J(A.component),1),d("span",W0e,J(A.message),1)],2))),128)),i.value.length===0?(N(),L("div",z0e,' No activity logs yet. Click "Refresh All" to start monitoring. ')):_e("",!0)])]),n.value?(N(),L("div",{key:0,class:"test-modal-overlay",onClick:x},[d("div",{class:"test-modal",onClick:_[0]||(_[0]=dn(()=>{},["stop"]))},[d("div",K0e,[d("h3",null,J(s.value.component)+" Test Results",1),d("button",{onClick:x,class:"btn btn-sm btn-secondary"},"✕")]),d("div",q0e,[d("pre",null,J(JSON.stringify(s.value.data,null,2)),1)])])])):_e("",!0)]))}},Y0e=yt(X0e,[["__scopeId","data-v-106cd980"]]),Q0e={class:"admin-permissions-matrix"},J0e={class:"matrix-container"},Z0e={key:0,class:"loading-state"},ehe={key:1,class:"permissions-table"},the={key:0},rhe={class:"page-info"},nhe={class:"page-name"},she={class:"page-category"},ahe={class:"page-description"},ihe={class:"permission-cell"},ohe=["onUpdate:modelValue","disabled","onChange"],lhe={class:"permission-cell"},che=["onUpdate:modelValue","disabled","onChange"],uhe={class:"permission-cell"},dhe=["onUpdate:modelValue","disabled","onChange"],fhe={class:"matrix-actions"},hhe={class:"bulk-actions"},phe={class:"bulk-buttons"},mhe={key:0,class:"save-status"},ghe={__name:"AdminPermissionsMatrix",setup(t){const e=se(null),r=se(!0),n=Se(()=>!r.value&&s.value.length>0&&Object.keys(i).length>0),s=se([{key:"dashboard",label:"Dashboard",category:"Dashboard",description:"Main admin overview and statistics"},{key:"usersAdd",label:"Add Users",category:"User Management",description:"Create new user accounts"},{key:"usersEdit",label:"Manage Users",category:"User Management",description:"Edit existing user accounts"},{key:"students",label:"Students",category:"Student Management",description:"View and manage student records"},{key:"addStudents",label:"Add Students",category:"Student Management",description:"Bulk import student data"},{key:"aide-assignment",label:"Aide Assignment",category:"Aide Management",description:"Assign aides to students"},{key:"aide-schedule",label:"Aide Schedule",category:"Aide Management",description:"Manage aide schedules"},{key:"time-table",label:"Time Table",category:"Aide Management",description:"Configure school time periods"},{key:"seis",label:"SEIS Import",category:"Data Integration",description:"Import SEIS student data"},{key:"aeries",label:"Aeries API & Import",category:"Data Integration",description:"Connect to Aeries SIS"},{key:"testing-links",label:"Testing Links",category:"Data Integration",description:"Google Sheets integration for testing"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"Data Integration",description:"Manage teacher feedback system"},{key:"backup-restore",label:"Backup & Restore",category:"Data Integration",description:"Database backup and restore"},{key:"settings",label:"App Settings",category:"Settings",description:"Global application settings"},{key:"delete-all-users",label:"Delete All Users",category:"Bulk Actions",description:"Mass deletion of user accounts (dangerous operation)"},{key:"delete-all-students",label:"Delete All Students",category:"Bulk Actions",description:"Mass deletion of student records (dangerous operation)"},{key:"permissions",label:"Admin Panel Permissions",category:"System",description:"User role and permission management"},{key:"audit-logs",label:"Audit Logs",category:"System",description:"View and search system audit logs"},{key:"iep-security",label:"IEP Security",category:"System",description:"IEP data encryption and security"},{key:"security",label:"Security Controls",category:"System",description:"Security monitoring and controls"},{key:"component-health",label:"Component Debug",category:"System",description:"Component health and debugging"}]),i=Rs({}),a={school_admin:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!0,settings:!0,"delete-all-users":!0,"delete-all-students":!0,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1},admin_504:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1},sped_chair:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1}},o=()=>{if(!s.value||s.value.length===0){console.warn("adminPages not initialized yet");return}s.value.forEach(g=>{g&&g.key&&(i[g.key]={school_admin:a.school_admin[g.key]||!1,admin_504:a.admin_504[g.key]||!1,sped_chair:a.sped_chair[g.key]||!1})})},l=async()=>{try{const g=Ze(ze,"app_settings","admin_panel_permissions"),y=await Jt(g);if(y.exists()){const E=y.data();s.value.forEach(b=>{b&&b.key&&E[b.key]&&(i[b.key]={school_admin:E[b.key].school_admin??a.school_admin[b.key],admin_504:E[b.key].admin_504??a.admin_504[b.key],sped_chair:E[b.key].sped_chair??a.sped_chair[b.key]})}),v("Permissions loaded successfully","success")}else o(),v("Using default permissions","info")}catch(g){console.error("Error loading permissions:",g),v("Error loading permissions","error"),o()}finally{r.value=!1}},c=async()=>{try{const g=Ze(ze,"app_settings","admin_panel_permissions");await Ht(g,i),v("Permissions saved successfully","success")}catch(g){console.error("Error saving permissions:",g),v("Error saving permissions","error")}},u=async(g,y,E)=>{i[g]&&(i[g][y]=E,await c())},f=async g=>{s.value.forEach(y=>{y&&y.key&&i[y.key]&&(i[y.key][g]=!0)}),await c(),v(`All permissions granted to ${g}`,"success")},h=async()=>{s.value.forEach(g=>{g&&g.key&&i[g.key]&&(i[g.key].school_admin=!1,i[g.key].admin_504=!1,i[g.key].sped_chair=!1)}),await c(),v("All permissions revoked","warning")},p=async()=>{o(),await c(),v("Permissions reset to defaults","info")},m=(g,y)=>["permissions","iep-security","security","component-health"].includes(g)?!0:["delete-all-users","delete-all-students"].includes(g)?y!=="school_admin":y==="admin_504"?["settings"].includes(g):y==="sped_chair"?["settings"].includes(g):!1,v=(g,y)=>{e.value={message:g,type:y},setTimeout(()=>{e.value=null},3e3)};return Ut(async()=>{await l()}),(g,y)=>(N(),L("div",Q0e,[y[9]||(y[9]=d("div",{class:"matrix-header"},[d("h2",null,"🔐 Admin Panel Permissions Matrix"),d("p",{class:"matrix-description"}," Control which admin panel pages different admin roles can access. Changes are saved automatically. ")],-1)),d("div",J0e,[r.value?(N(),L("div",Z0e,y[3]||(y[3]=[d("p",null,"Loading permissions...",-1)]))):(N(),L("table",ehe,[y[7]||(y[7]=d("thead",null,[d("tr",null,[d("th",{class:"page-column"},"Admin Panel Page"),d("th",{class:"role-column"},"School Admin"),d("th",{class:"role-column"},"504 Coordinator"),d("th",{class:"role-column"},"SPED Chair")])],-1)),n.value?(N(),L("tbody",the,[(N(!0),L(Re,null,Ve(s.value,E=>(N(),L("tr",{key:E.key,class:"permission-row"},[d("td",rhe,[d("div",nhe,J(E.label),1),d("div",she,J(E.category),1),d("div",ahe,J(E.description),1)]),d("td",ihe,[d("label",{class:Qe(["permission-toggle",{disabled:m(E.key,"school_admin")}])},[we(d("input",{type:"checkbox","onUpdate:modelValue":b=>i[E.key].school_admin=b,disabled:m(E.key,"school_admin"),onChange:b=>u(E.key,"school_admin",b.target.checked)},null,40,ohe),[[_t,i[E.key].school_admin]]),y[4]||(y[4]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",lhe,[d("label",{class:Qe(["permission-toggle",{disabled:m(E.key,"admin_504")}])},[we(d("input",{type:"checkbox","onUpdate:modelValue":b=>i[E.key].admin_504=b,disabled:m(E.key,"admin_504"),onChange:b=>u(E.key,"admin_504",b.target.checked)},null,40,che),[[_t,i[E.key].admin_504]]),y[5]||(y[5]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",uhe,[d("label",{class:Qe(["permission-toggle",{disabled:m(E.key,"sped_chair")}])},[we(d("input",{type:"checkbox","onUpdate:modelValue":b=>i[E.key].sped_chair=b,disabled:m(E.key,"sped_chair"),onChange:b=>u(E.key,"sped_chair",b.target.checked)},null,40,dhe),[[_t,i[E.key].sped_chair]]),y[6]||(y[6]=d("span",{class:"toggle-slider"},null,-1))],2)])]))),128))])):_e("",!0)]))]),d("div",fhe,[d("div",hhe,[y[8]||(y[8]=d("h3",null,"Bulk Actions",-1)),d("div",phe,[d("button",{onClick:y[0]||(y[0]=E=>f("school_admin")),class:"btn btn-success"}," Grant All to School Admin "),d("button",{onClick:y[1]||(y[1]=E=>f("admin_504")),class:"btn btn-success"}," Grant All to 504 Coordinator "),d("button",{onClick:y[2]||(y[2]=E=>f("sped_chair")),class:"btn btn-success"}," Grant All to SPED Chair "),d("button",{onClick:h,class:"btn btn-warning"}," Revoke All Permissions "),d("button",{onClick:p,class:"btn btn-secondary"}," Reset to Defaults ")])])]),e.value?(N(),L("div",mhe,[d("div",{class:Qe(["status-message",e.value.type])},J(e.value.message),3)])):_e("",!0)]))}},vhe=yt(ghe,[["__scopeId","data-v-c0fae6c0"]]),xhe={class:"theme-manager"},yhe={key:0,class:"loading-state"},Ehe={key:1,class:"error-state"},_he={class:"error-message"},bhe={key:2,class:"theme-editor"},She={class:"theme-actions"},Ahe=["disabled"],The=["disabled"],whe=["disabled"],Che={class:"theme-sections"},Ihe={class:"theme-section"},khe={class:"color-grid"},Dhe={class:"color-group"},Phe={class:"color-inputs"},Rhe={class:"color-input"},Fhe={class:"color-picker-wrapper"},Nhe={class:"color-input"},Ohe={class:"color-picker-wrapper"},Mhe={class:"color-input"},Lhe={class:"color-picker-wrapper"},Bhe={class:"color-input"},Uhe={class:"color-picker-wrapper"},$he={class:"color-group"},Vhe={class:"color-inputs"},Hhe={class:"color-input"},jhe={class:"color-picker-wrapper"},Ghe={class:"color-input"},Whe={class:"color-picker-wrapper"},zhe={class:"color-group"},Khe={class:"color-inputs"},qhe={class:"color-input"},Xhe={class:"color-picker-wrapper"},Yhe={class:"color-input"},Qhe={class:"color-picker-wrapper"},Jhe={class:"color-input"},Zhe={class:"color-picker-wrapper"},epe={class:"color-input"},tpe={class:"color-picker-wrapper"},rpe={class:"theme-section"},npe={class:"color-grid"},spe={class:"color-input"},ape={class:"color-picker-wrapper"},ipe={class:"color-input"},ope={class:"color-picker-wrapper"},lpe={class:"color-input"},cpe={class:"color-picker-wrapper"},upe={class:"color-input"},dpe={class:"color-picker-wrapper"},fpe={class:"theme-section"},hpe={class:"color-grid"},ppe={class:"color-input"},mpe={class:"color-picker-wrapper"},gpe={class:"color-input"},vpe={class:"color-picker-wrapper"},xpe={class:"color-input"},ype={class:"color-picker-wrapper"},Epe={class:"color-input"},_pe={class:"color-picker-wrapper"},bpe={class:"theme-section"},Spe={class:"input-grid"},Ape={class:"input-group"},Tpe={class:"input-group"},wpe={class:"input-group"},Cpe={class:"input-group"},Ipe={class:"theme-section"},kpe={class:"input-grid"},Dpe={class:"input-group"},Ppe={class:"input-group"},Rpe={__name:"ThemeManager",setup(t){const{currentTheme:e,loading:r,error:n,loadTheme:s,saveTheme:i,resetTheme:a,updateThemeProperty:o,DEFAULT_THEME:l}=U4(),c=Rs({...l}),u=se(!1),f=se(""),h=se(!1),p=se(null);Vt(e,P=>{Object.assign(c,P)},{deep:!0});const m=(P,w=!1)=>{f.value=P,h.value=w,setTimeout(()=>{f.value="",h.value=!1},5e3)},v=async()=>{u.value=!0;try{await i(c),m("Theme saved successfully!")}catch(P){m("Error saving theme: "+P.message,!0)}finally{u.value=!1}},g=async()=>{if(confirm("Are you sure you want to reset the theme to defaults? This cannot be undone."))try{await a(),m("Theme reset to defaults")}catch(P){m("Error resetting theme: "+P.message,!0)}},y=()=>{Object.assign(c,e.value),m("Changes reverted")},E=()=>{const P=JSON.stringify(c,null,2),w=new Blob([P],{type:"application/json"}),x=URL.createObjectURL(w),S=document.createElement("a");S.href=x,S.download=`theme-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(x),m("Theme exported successfully")},b=()=>{p.value.click()},k=P=>{const w=P.target.files[0];if(!w)return;const x=new FileReader;x.onload=S=>{try{const _=JSON.parse(S.target.result);if(!Object.keys(l).every(C=>_.hasOwnProperty(C))){m("Invalid theme file format",!0);return}Object.assign(c,_),m("Theme imported successfully")}catch(_){m("Error importing theme: "+_.message,!0)}},x.readAsText(w),P.target.value=""};return Ut(async()=>{try{await s()}catch(P){console.error("Error loading theme:",P)}}),(P,w)=>(N(),L("div",xhe,[w[120]||(w[120]=d("div",{class:"theme-header"},[d("h2",null,"🎨 Theme Customization"),d("p",{class:"theme-description"}," Customize the visual appearance of the application. Changes are applied in real-time and saved to the database. ")],-1)),ee(r)?(N(),L("div",yhe,w[85]||(w[85]=[d("div",{class:"spinner"},null,-1),d("p",null,"Loading theme settings...",-1)]))):ee(n)?(N(),L("div",Ehe,[d("p",_he,J(ee(n)),1),d("button",{onClick:w[0]||(w[0]=(...x)=>ee(s)&&ee(s)(...x)),class:"btn btn-primary"},"Retry")])):(N(),L("div",bhe,[d("div",She,[d("button",{onClick:v,disabled:u.value,class:"btn btn-primary"},J(u.value?"💾 Saving...":"💾 Save Theme"),9,Ahe),d("button",{onClick:g,disabled:u.value,class:"btn btn-warning"}," 🔄 Reset to Defaults ",8,The),d("button",{onClick:y,disabled:u.value,class:"btn btn-secondary"}," ↩️ Revert Changes ",8,whe),d("button",{onClick:E,class:"btn btn-info"}," 📤 Export Theme "),d("button",{onClick:b,class:"btn btn-info"}," 📥 Import Theme ")]),f.value?(N(),L("div",{key:0,class:Qe(["status-message",{error:h.value,success:!h.value}])},J(f.value),3)):_e("",!0),d("div",Che,[d("section",Ihe,[w[99]||(w[99]=d("h3",null,"🎨 Color Palette",-1)),d("div",khe,[d("div",Dhe,[w[90]||(w[90]=d("h4",null,"Primary Colors",-1)),d("div",Phe,[d("div",Rhe,[w[86]||(w[86]=d("label",null,"Primary Color",-1)),d("div",Fhe,[we(d("input",{type:"color","onUpdate:modelValue":w[1]||(w[1]=x=>c.primaryColor=x),onInput:w[2]||(w[2]=x=>ee(o)("primaryColor",x.target.value)),class:"color-picker"},null,544),[[Ye,c.primaryColor]]),we(d("input",{type:"text","onUpdate:modelValue":w[3]||(w[3]=x=>c.primaryColor=x),onInput:w[4]||(w[4]=x=>ee(o)("primaryColor",x.target.value)),class:"color-text",placeholder:"#1976d2"},null,544),[[Ye,c.primaryColor]])])]),d("div",Nhe,[w[87]||(w[87]=d("label",null,"Primary Hover",-1)),d("div",Ohe,[we(d("input",{type:"color","onUpdate:modelValue":w[5]||(w[5]=x=>c.primaryHover=x),onInput:w[6]||(w[6]=x=>ee(o)("primaryHover",x.target.value)),class:"color-picker"},null,544),[[Ye,c.primaryHover]]),we(d("input",{type:"text","onUpdate:modelValue":w[7]||(w[7]=x=>c.primaryHover=x),onInput:w[8]||(w[8]=x=>ee(o)("primaryHover",x.target.value)),class:"color-text",placeholder:"#1565c0"},null,544),[[Ye,c.primaryHover]])])]),d("div",Mhe,[w[88]||(w[88]=d("label",null,"Primary Light",-1)),d("div",Lhe,[we(d("input",{type:"color","onUpdate:modelValue":w[9]||(w[9]=x=>c.primaryLight=x),onInput:w[10]||(w[10]=x=>ee(o)("primaryLight",x.target.value)),class:"color-picker"},null,544),[[Ye,c.primaryLight]]),we(d("input",{type:"text","onUpdate:modelValue":w[11]||(w[11]=x=>c.primaryLight=x),onInput:w[12]||(w[12]=x=>ee(o)("primaryLight",x.target.value)),class:"color-text",placeholder:"#e3f2fd"},null,544),[[Ye,c.primaryLight]])])]),d("div",Bhe,[w[89]||(w[89]=d("label",null,"Primary Dark",-1)),d("div",Uhe,[we(d("input",{type:"color","onUpdate:modelValue":w[13]||(w[13]=x=>c.primaryDark=x),onInput:w[14]||(w[14]=x=>ee(o)("primaryDark",x.target.value)),class:"color-picker"},null,544),[[Ye,c.primaryDark]]),we(d("input",{type:"text","onUpdate:modelValue":w[15]||(w[15]=x=>c.primaryDark=x),onInput:w[16]||(w[16]=x=>ee(o)("primaryDark",x.target.value)),class:"color-text",placeholder:"#0d47a1"},null,544),[[Ye,c.primaryDark]])])])])]),d("div",$he,[w[93]||(w[93]=d("h4",null,"Secondary Colors",-1)),d("div",Vhe,[d("div",Hhe,[w[91]||(w[91]=d("label",null,"Secondary Color",-1)),d("div",jhe,[we(d("input",{type:"color","onUpdate:modelValue":w[17]||(w[17]=x=>c.secondaryColor=x),onInput:w[18]||(w[18]=x=>ee(o)("secondaryColor",x.target.value)),class:"color-picker"},null,544),[[Ye,c.secondaryColor]]),we(d("input",{type:"text","onUpdate:modelValue":w[19]||(w[19]=x=>c.secondaryColor=x),onInput:w[20]||(w[20]=x=>ee(o)("secondaryColor",x.target.value)),class:"color-text",placeholder:"#6c757d"},null,544),[[Ye,c.secondaryColor]])])]),d("div",Ghe,[w[92]||(w[92]=d("label",null,"Secondary Hover",-1)),d("div",Whe,[we(d("input",{type:"color","onUpdate:modelValue":w[21]||(w[21]=x=>c.secondaryHover=x),onInput:w[22]||(w[22]=x=>ee(o)("secondaryHover",x.target.value)),class:"color-picker"},null,544),[[Ye,c.secondaryHover]]),we(d("input",{type:"text","onUpdate:modelValue":w[23]||(w[23]=x=>c.secondaryHover=x),onInput:w[24]||(w[24]=x=>ee(o)("secondaryHover",x.target.value)),class:"color-text",placeholder:"#545b62"},null,544),[[Ye,c.secondaryHover]])])])])]),d("div",zhe,[w[98]||(w[98]=d("h4",null,"Status Colors",-1)),d("div",Khe,[d("div",qhe,[w[94]||(w[94]=d("label",null,"Success",-1)),d("div",Xhe,[we(d("input",{type:"color","onUpdate:modelValue":w[25]||(w[25]=x=>c.successColor=x),onInput:w[26]||(w[26]=x=>ee(o)("successColor",x.target.value)),class:"color-picker"},null,544),[[Ye,c.successColor]]),we(d("input",{type:"text","onUpdate:modelValue":w[27]||(w[27]=x=>c.successColor=x),onInput:w[28]||(w[28]=x=>ee(o)("successColor",x.target.value)),class:"color-text",placeholder:"#28a745"},null,544),[[Ye,c.successColor]])])]),d("div",Yhe,[w[95]||(w[95]=d("label",null,"Warning",-1)),d("div",Qhe,[we(d("input",{type:"color","onUpdate:modelValue":w[29]||(w[29]=x=>c.warningColor=x),onInput:w[30]||(w[30]=x=>ee(o)("warningColor",x.target.value)),class:"color-picker"},null,544),[[Ye,c.warningColor]]),we(d("input",{type:"text","onUpdate:modelValue":w[31]||(w[31]=x=>c.warningColor=x),onInput:w[32]||(w[32]=x=>ee(o)("warningColor",x.target.value)),class:"color-text",placeholder:"#ffc107"},null,544),[[Ye,c.warningColor]])])]),d("div",Jhe,[w[96]||(w[96]=d("label",null,"Error",-1)),d("div",Zhe,[we(d("input",{type:"color","onUpdate:modelValue":w[33]||(w[33]=x=>c.errorColor=x),onInput:w[34]||(w[34]=x=>ee(o)("errorColor",x.target.value)),class:"color-picker"},null,544),[[Ye,c.errorColor]]),we(d("input",{type:"text","onUpdate:modelValue":w[35]||(w[35]=x=>c.errorColor=x),onInput:w[36]||(w[36]=x=>ee(o)("errorColor",x.target.value)),class:"color-text",placeholder:"#dc3545"},null,544),[[Ye,c.errorColor]])])]),d("div",epe,[w[97]||(w[97]=d("label",null,"Info",-1)),d("div",tpe,[we(d("input",{type:"color","onUpdate:modelValue":w[37]||(w[37]=x=>c.infoColor=x),onInput:w[38]||(w[38]=x=>ee(o)("infoColor",x.target.value)),class:"color-picker"},null,544),[[Ye,c.infoColor]]),we(d("input",{type:"text","onUpdate:modelValue":w[39]||(w[39]=x=>c.infoColor=x),onInput:w[40]||(w[40]=x=>ee(o)("infoColor",x.target.value)),class:"color-text",placeholder:"#17a2b8"},null,544),[[Ye,c.infoColor]])])])])])])]),d("section",rpe,[w[104]||(w[104]=d("h3",null,"🏞️ Background Colors",-1)),d("div",npe,[d("div",spe,[w[100]||(w[100]=d("label",null,"Primary Background",-1)),d("div",ape,[we(d("input",{type:"color","onUpdate:modelValue":w[41]||(w[41]=x=>c.bgPrimary=x),onInput:w[42]||(w[42]=x=>ee(o)("bgPrimary",x.target.value)),class:"color-picker"},null,544),[[Ye,c.bgPrimary]]),we(d("input",{type:"text","onUpdate:modelValue":w[43]||(w[43]=x=>c.bgPrimary=x),onInput:w[44]||(w[44]=x=>ee(o)("bgPrimary",x.target.value)),class:"color-text",placeholder:"#f4f6f9"},null,544),[[Ye,c.bgPrimary]])])]),d("div",ipe,[w[101]||(w[101]=d("label",null,"Secondary Background",-1)),d("div",ope,[we(d("input",{type:"color","onUpdate:modelValue":w[45]||(w[45]=x=>c.bgSecondary=x),onInput:w[46]||(w[46]=x=>ee(o)("bgSecondary",x.target.value)),class:"color-picker"},null,544),[[Ye,c.bgSecondary]]),we(d("input",{type:"text","onUpdate:modelValue":w[47]||(w[47]=x=>c.bgSecondary=x),onInput:w[48]||(w[48]=x=>ee(o)("bgSecondary",x.target.value)),class:"color-text",placeholder:"#ffffff"},null,544),[[Ye,c.bgSecondary]])])]),d("div",lpe,[w[102]||(w[102]=d("label",null,"Tertiary Background",-1)),d("div",cpe,[we(d("input",{type:"color","onUpdate:modelValue":w[49]||(w[49]=x=>c.bgTertiary=x),onInput:w[50]||(w[50]=x=>ee(o)("bgTertiary",x.target.value)),class:"color-picker"},null,544),[[Ye,c.bgTertiary]]),we(d("input",{type:"text","onUpdate:modelValue":w[51]||(w[51]=x=>c.bgTertiary=x),onInput:w[52]||(w[52]=x=>ee(o)("bgTertiary",x.target.value)),class:"color-text",placeholder:"#f8f9fa"},null,544),[[Ye,c.bgTertiary]])])]),d("div",upe,[w[103]||(w[103]=d("label",null,"Muted Background",-1)),d("div",dpe,[we(d("input",{type:"color","onUpdate:modelValue":w[53]||(w[53]=x=>c.bgMuted=x),onInput:w[54]||(w[54]=x=>ee(o)("bgMuted",x.target.value)),class:"color-picker"},null,544),[[Ye,c.bgMuted]]),we(d("input",{type:"text","onUpdate:modelValue":w[55]||(w[55]=x=>c.bgMuted=x),onInput:w[56]||(w[56]=x=>ee(o)("bgMuted",x.target.value)),class:"color-text",placeholder:"#e9ecef"},null,544),[[Ye,c.bgMuted]])])])])]),d("section",fpe,[w[109]||(w[109]=d("h3",null,"📝 Text Colors",-1)),d("div",hpe,[d("div",ppe,[w[105]||(w[105]=d("label",null,"Primary Text",-1)),d("div",mpe,[we(d("input",{type:"color","onUpdate:modelValue":w[57]||(w[57]=x=>c.textPrimary=x),onInput:w[58]||(w[58]=x=>ee(o)("textPrimary",x.target.value)),class:"color-picker"},null,544),[[Ye,c.textPrimary]]),we(d("input",{type:"text","onUpdate:modelValue":w[59]||(w[59]=x=>c.textPrimary=x),onInput:w[60]||(w[60]=x=>ee(o)("textPrimary",x.target.value)),class:"color-text",placeholder:"#333333"},null,544),[[Ye,c.textPrimary]])])]),d("div",gpe,[w[106]||(w[106]=d("label",null,"Secondary Text",-1)),d("div",vpe,[we(d("input",{type:"color","onUpdate:modelValue":w[61]||(w[61]=x=>c.textSecondary=x),onInput:w[62]||(w[62]=x=>ee(o)("textSecondary",x.target.value)),class:"color-picker"},null,544),[[Ye,c.textSecondary]]),we(d("input",{type:"text","onUpdate:modelValue":w[63]||(w[63]=x=>c.textSecondary=x),onInput:w[64]||(w[64]=x=>ee(o)("textSecondary",x.target.value)),class:"color-text",placeholder:"#666666"},null,544),[[Ye,c.textSecondary]])])]),d("div",xpe,[w[107]||(w[107]=d("label",null,"Muted Text",-1)),d("div",ype,[we(d("input",{type:"color","onUpdate:modelValue":w[65]||(w[65]=x=>c.textMuted=x),onInput:w[66]||(w[66]=x=>ee(o)("textMuted",x.target.value)),class:"color-picker"},null,544),[[Ye,c.textMuted]]),we(d("input",{type:"text","onUpdate:modelValue":w[67]||(w[67]=x=>c.textMuted=x),onInput:w[68]||(w[68]=x=>ee(o)("textMuted",x.target.value)),class:"color-text",placeholder:"#999999"},null,544),[[Ye,c.textMuted]])])]),d("div",Epe,[w[108]||(w[108]=d("label",null,"Inverse Text",-1)),d("div",_pe,[we(d("input",{type:"color","onUpdate:modelValue":w[69]||(w[69]=x=>c.textInverse=x),onInput:w[70]||(w[70]=x=>ee(o)("textInverse",x.target.value)),class:"color-picker"},null,544),[[Ye,c.textInverse]]),we(d("input",{type:"text","onUpdate:modelValue":w[71]||(w[71]=x=>c.textInverse=x),onInput:w[72]||(w[72]=x=>ee(o)("textInverse",x.target.value)),class:"color-text",placeholder:"#ffffff"},null,544),[[Ye,c.textInverse]])])])])]),d("section",bpe,[w[114]||(w[114]=d("h3",null,"🔲 Border Radius",-1)),d("div",Spe,[d("div",Ape,[w[110]||(w[110]=d("label",null,"Small Border Radius",-1)),we(d("input",{type:"text","onUpdate:modelValue":w[73]||(w[73]=x=>c.borderRadiusSm=x),onInput:w[74]||(w[74]=x=>ee(o)("borderRadiusSm",x.target.value)),placeholder:"4px"},null,544),[[Ye,c.borderRadiusSm]])]),d("div",Tpe,[w[111]||(w[111]=d("label",null,"Medium Border Radius",-1)),we(d("input",{type:"text","onUpdate:modelValue":w[75]||(w[75]=x=>c.borderRadiusMd=x),onInput:w[76]||(w[76]=x=>ee(o)("borderRadiusMd",x.target.value)),placeholder:"6px"},null,544),[[Ye,c.borderRadiusMd]])]),d("div",wpe,[w[112]||(w[112]=d("label",null,"Large Border Radius",-1)),we(d("input",{type:"text","onUpdate:modelValue":w[77]||(w[77]=x=>c.borderRadiusLg=x),onInput:w[78]||(w[78]=x=>ee(o)("borderRadiusLg",x.target.value)),placeholder:"8px"},null,544),[[Ye,c.borderRadiusLg]])]),d("div",Cpe,[w[113]||(w[113]=d("label",null,"Extra Large Border Radius",-1)),we(d("input",{type:"text","onUpdate:modelValue":w[79]||(w[79]=x=>c.borderRadiusXl=x),onInput:w[80]||(w[80]=x=>ee(o)("borderRadiusXl",x.target.value)),placeholder:"12px"},null,544),[[Ye,c.borderRadiusXl]])])])]),d("section",Ipe,[w[118]||(w[118]=d("h3",null,"🔤 Typography",-1)),d("div",kpe,[d("div",Dpe,[w[116]||(w[116]=d("label",null,"Font Family",-1)),we(d("select",{"onUpdate:modelValue":w[81]||(w[81]=x=>c.fontFamilyBase=x),onChange:w[82]||(w[82]=x=>ee(o)("fontFamilyBase",x.target.value))},w[115]||(w[115]=[Fr('<option value="&#39;Inter&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Inter (Default)</option><option value="&#39;Roboto&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Roboto</option><option value="&#39;Open Sans&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Open Sans</option><option value="&#39;Lato&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Lato</option><option value="&#39;Poppins&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Poppins</option><option value="&#39;Montserrat&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Montserrat</option><option value="&#39;Source Sans Pro&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Source Sans Pro</option><option value="&#39;Ubuntu&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-626c9c7f>Ubuntu</option>',8)]),544),[[ur,c.fontFamilyBase]])]),d("div",Ppe,[w[117]||(w[117]=d("label",null,"Base Font Size",-1)),we(d("input",{type:"text","onUpdate:modelValue":w[83]||(w[83]=x=>c.fontSizeBase=x),onInput:w[84]||(w[84]=x=>ee(o)("fontSizeBase",x.target.value)),placeholder:"1rem"},null,544),[[Ye,c.fontSizeBase]])])])]),w[119]||(w[119]=Fr('<section class="theme-section" data-v-626c9c7f><h3 data-v-626c9c7f>👁️ Live Preview</h3><div class="preview-container" data-v-626c9c7f><div class="preview-card" data-v-626c9c7f><h4 data-v-626c9c7f>Sample Card</h4><p data-v-626c9c7f>This is a sample card to preview your theme changes in real-time.</p><div class="preview-buttons" data-v-626c9c7f><button class="btn btn-primary" data-v-626c9c7f>Primary Button</button><button class="btn btn-secondary" data-v-626c9c7f>Secondary Button</button><button class="btn btn-success" data-v-626c9c7f>Success Button</button><button class="btn btn-warning" data-v-626c9c7f>Warning Button</button><button class="btn btn-error" data-v-626c9c7f>Error Button</button></div></div></div></section>',1))])])),d("input",{ref_key:"fileInput",ref:p,type:"file",accept:".json",style:{display:"none"},onChange:k},null,544)]))}},Fpe=yt(Rpe,[["__scopeId","data-v-626c9c7f"]]),Do=se({}),hu=se(!1);function Npe(){const t=async()=>{try{const s=Ze(ze,"app_settings","admin_panel_permissions"),i=await Jt(s);i.exists()?Do.value=i.data():Do.value=n(),hu.value=!0,console.log("Admin permissions loaded:",Do.value)}catch(s){console.error("Error loading admin permissions:",s),Do.value=n(),hu.value=!0}},e=(s,i)=>!hu.value||!Do.value[s]?!1:i==="admin"?!0:Do.value[s][i]===!0,r=(s,i)=>hu.value?s.filter(a=>i==="admin"?!0:e(a.key,i)):[],n=()=>({dashboard:{school_admin:!0,admin_504:!0,sped_chair:!0},usersAdd:{school_admin:!0,admin_504:!0,sped_chair:!1},usersEdit:{school_admin:!0,admin_504:!0,sped_chair:!0},students:{school_admin:!0,admin_504:!0,sped_chair:!0},addStudents:{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-assignment":{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-schedule":{school_admin:!0,admin_504:!0,sped_chair:!0},"time-table":{school_admin:!0,admin_504:!1,sped_chair:!0},seis:{school_admin:!0,admin_504:!0,sped_chair:!0},aeries:{school_admin:!0,admin_504:!0,sped_chair:!0},"testing-links":{school_admin:!0,admin_504:!1,sped_chair:!0},"teacher-feedback":{school_admin:!0,admin_504:!0,sped_chair:!0},"backup-restore":{school_admin:!0,admin_504:!1,sped_chair:!0},settings:{school_admin:!0,admin_504:!0,sped_chair:!0},permissions:{school_admin:!1,admin_504:!1,sped_chair:!1},"iep-security":{school_admin:!1,admin_504:!1,sped_chair:!1},security:{school_admin:!1,admin_504:!1,sped_chair:!1},"component-health":{school_admin:!1,admin_504:!1,sped_chair:!1}});return{adminPermissions:Se(()=>Do.value),permissionsLoaded:Se(()=>hu.value),loadPermissions:t,hasPermission:e,getPermittedTabs:r}}const Ope={name:"AdminView",components:{TabBar:gj,UserAddForm:wj,UserTable:Qj,AdminStudents:yG,StudentBulkImporter:bW,AdminPermissions:pz,SeisImport:Dz,AeriesImport:$z,AeriesAPIConnector:XK,AppSettings:jq,AdminAideAssignment:J4,AdminTimeTable:Fk,AdminAideSchedule:Wk,AdminBackupRestore:zk,AdminAuditLogs:Ule,AdminTeacherFeedback:Uce,TestingLinks:$ue,AdminDashboard:Sde,DebugEncryption:Kk,SecurityControlCenter:t0e,ComponentHealthDashboard:Y0e,AdminPermissionsMatrix:vhe,ThemeManager:Fpe},setup(){const t=wi(),e=UL(),r=se("dashboard"),n=se("dashboard"),{students:s,fetchStudents:i}=Ua(),{users:a,fetchUsers:o}=ya(),{currentUser:l}=nf(),{loadPermissions:c,getPermittedTabs:u,permissionsLoaded:f}=Npe();Ut(async()=>{try{await Promise.all([i(),o(),c()]),l.value&&await tn.logSystemAccess("admin_panel_access",{userRole:l.value.role,accessTime:new Date().toISOString(),initialCategory:e.query.category||"dashboard"});const x=e.query.category;x&&y(x)}catch(x){console.error("Error loading data:",x)}});const h=[{key:"dashboard",label:"Dashboard",category:"dashboard"},{key:"usersAdd",label:"Add Users",category:"users-students"},{key:"usersEdit",label:"Manage Users",category:"users-students"},{key:"students",label:"Students",category:"users-students"},{key:"addStudents",label:"Add Students",category:"users-students"},{key:"aide-assignment",label:"Aide Assignment",category:"aide-management"},{key:"aide-schedule",label:"Aide Schedule",category:"aide-management",status:"not-working"},{key:"time-table",label:"Time Table",category:"aide-management"},{key:"seis",label:"SEIS Import",category:"data-integration",status:"not-active"},{key:"aeries",label:"Aeries API & Import",category:"data-integration",status:"not-active"},{key:"testing-links",label:"Testing Links",category:"data-integration"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"data-integration"},{key:"backup-restore",label:"Backup & Restore",category:"data-integration"},{key:"permissions",label:"Permissions",category:"system-config"},{key:"settings",label:"App Settings",category:"system-config"},{key:"theme",label:"Theme Customization",category:"system-config"},{key:"audit-logs",label:"Audit Logs",category:"monitoring"},{key:"security",label:"Security Controls",category:"monitoring"},{key:"component-health",label:"Component Debug",category:"monitoring"}],p=[{key:"admin-permissions",label:"Admin Panel Permissions",category:"monitoring"}],m=Se(()=>{var _;const x=(_=l.value)==null?void 0:_.role;if(!f.value)return[];let S=[...h];return x==="admin"&&(S=[...S,...p]),u(S,x)}),v=x=>m.value.filter(S=>S.category===x),g=x=>v(x).length>0,y=async x=>{n.value=x;const S=v(x);S.length>0&&(r.value=S[0].key),l.value&&await tn.logSystemAccess("admin_category_access",{category:x,userRole:l.value.role,availableTabs:S.map(_=>_.key)})};return{activeTab:r,activeCategory:n,getTabsForCategory:v,categoryHasTabs:g,setActiveCategory:y,handleTabChange:async x=>{r.value=x,l.value&&await tn.logSystemAccess("admin_tab_access",{tab:x,category:n.value,userRole:l.value.role})},goToStudents:()=>{t.push("/students")},goToDashboard:()=>{t.push("/admin/dashboard")},handleGoToCategory:x=>{y(x)},handleBulkImporterClose:()=>{r.value="students"},students:s,userMap:a,currentUser:l,permissionsLoaded:f}}},Mpe={class:"admin-header"},Lpe={class:"admin-nav"},Bpe={class:"admin-actions"},Upe={key:0,class:"sub-tab-container"},$pe={class:"admin-section"},Vpe={key:0,class:"admin-section"},Hpe={key:1,class:"admin-section"},jpe={key:2,class:"admin-section"},Gpe={key:3,class:"admin-section"},Wpe={key:4,class:"admin-section"},zpe={key:5,class:"admin-section"},Kpe={key:6,class:"admin-section"},qpe={key:7,class:"admin-section"},Xpe={key:8,class:"admin-section"},Ype={key:9,class:"admin-section"},Qpe={key:10,class:"admin-section"},Jpe={key:11,class:"admin-section"},Zpe={key:12,class:"admin-section"},eme={key:13,class:"admin-section"},tme={key:14,class:"admin-section"},rme={key:15,class:"admin-section"},nme={key:16,class:"admin-section"},sme={key:17,class:"admin-section"},ame={key:18,class:"admin-section"},ime={key:19,class:"admin-section"},ome={key:20,class:"admin-section"};function lme(t,e,r,n,s,i){const a=Ar("TabBar"),o=Ar("AdminDashboard"),l=Ar("UserAddForm"),c=Ar("UserTable"),u=Ar("AdminStudents"),f=Ar("StudentBulkImporter"),h=Ar("AdminPermissions"),p=Ar("AdminAideAssignment"),m=Ar("AdminAideSchedule"),v=Ar("AdminTimeTable"),g=Ar("SeisImport"),y=Ar("AeriesAPIConnector"),E=Ar("AeriesImport"),b=Ar("AppSettings"),k=Ar("ThemeManager"),P=Ar("TestingLinks"),w=Ar("AdminTeacherFeedback"),x=Ar("AdminBackupRestore"),S=Ar("AdminAuditLogs"),_=Ar("DebugEncryption"),A=Ar("SecurityControlCenter"),C=Ar("ComponentHealthDashboard"),T=Ar("AdminPermissionsMatrix");return N(),L("div",null,[d("div",Mpe,[e[8]||(e[8]=d("h1",null,"Admin Panel",-1)),d("div",Lpe,[n.categoryHasTabs("dashboard")?(N(),L("button",{key:0,onClick:e[0]||(e[0]=D=>n.setActiveCategory("dashboard")),class:Qe([{active:n.activeCategory==="dashboard"},"category-btn"])}," Dashboard ",2)):_e("",!0),n.categoryHasTabs("users-students")?(N(),L("button",{key:1,onClick:e[1]||(e[1]=D=>n.setActiveCategory("users-students")),class:Qe([{active:n.activeCategory==="users-students"},"category-btn"])}," User & Student ",2)):_e("",!0),n.categoryHasTabs("aide-management")?(N(),L("button",{key:2,onClick:e[2]||(e[2]=D=>n.setActiveCategory("aide-management")),class:Qe([{active:n.activeCategory==="aide-management"},"category-btn"])}," Paraprofessionals ",2)):_e("",!0),n.categoryHasTabs("data-integration")?(N(),L("button",{key:3,onClick:e[3]||(e[3]=D=>n.setActiveCategory("data-integration")),class:Qe([{active:n.activeCategory==="data-integration"},"category-btn"])}," Data & Integration ",2)):_e("",!0),n.categoryHasTabs("system-config")?(N(),L("button",{key:4,onClick:e[4]||(e[4]=D=>n.setActiveCategory("system-config")),class:Qe([{active:n.activeCategory==="system-config"},"category-btn"])}," Configuration ",2)):_e("",!0),n.categoryHasTabs("monitoring")?(N(),L("button",{key:5,onClick:e[5]||(e[5]=D=>n.setActiveCategory("monitoring")),class:Qe([{active:n.activeCategory==="monitoring"},"category-btn"])}," System ",2)):_e("",!0)]),d("div",Bpe,[d("button",{onClick:e[6]||(e[6]=(...D)=>n.goToStudents&&n.goToStudents(...D)),class:"return-btn"},e[7]||(e[7]=[d("span",null,"←",-1)]))])]),n.activeCategory?(N(),L("div",Upe,[nt(a,{tabs:n.getTabsForCategory(n.activeCategory),"active-tab":n.activeTab,onTabChange:n.handleTabChange},null,8,["tabs","active-tab","onTabChange"])])):_e("",!0),d("div",$pe,[n.activeTab==="dashboard"?(N(),L("div",Vpe,[nt(o,{onGoToCategory:n.handleGoToCategory,onGoToStudents:n.goToStudents},null,8,["onGoToCategory","onGoToStudents"])])):_e("",!0),n.activeTab==="usersAdd"?(N(),L("div",Hpe,[nt(l)])):_e("",!0),n.activeTab==="usersEdit"?(N(),L("div",jpe,[nt(c)])):_e("",!0),n.activeTab==="students"?(N(),L("div",Gpe,[nt(u)])):_e("",!0),n.activeTab==="addStudents"?(N(),L("div",Wpe,[nt(f,{onClose:n.handleBulkImporterClose,onImported:t.handleStudentsImported},null,8,["onClose","onImported"])])):_e("",!0),n.activeTab==="permissions"?(N(),L("div",zpe,[nt(h)])):_e("",!0),n.activeTab==="aide-assignment"?(N(),L("div",Kpe,[nt(p)])):_e("",!0),n.activeTab==="aide-schedule"?(N(),L("div",qpe,[nt(m)])):_e("",!0),n.activeTab==="time-table"?(N(),L("div",Xpe,[nt(v)])):_e("",!0),n.activeTab==="seis"?(N(),L("div",Ype,[nt(g)])):_e("",!0),n.activeTab==="aeries"?(N(),L("div",Qpe,[nt(y),e[9]||(e[9]=d("hr",{style:{margin:"2rem 0",border:"1px solid #ddd"}},null,-1)),nt(E)])):_e("",!0),n.activeTab==="settings"?(N(),L("div",Jpe,[nt(b)])):_e("",!0),n.activeTab==="theme"?(N(),L("div",Zpe,[nt(k)])):_e("",!0),n.activeTab==="testing-links"?(N(),L("div",eme,[nt(P,{students:n.students,userMap:n.userMap},null,8,["students","userMap"])])):_e("",!0),n.activeTab==="teacher-feedback"?(N(),L("div",tme,[nt(w)])):_e("",!0),n.activeTab==="backup-restore"?(N(),L("div",rme,[nt(x)])):_e("",!0),n.activeTab==="audit-logs"?(N(),L("div",nme,[nt(S)])):_e("",!0),n.activeTab==="iep-security"?(N(),L("div",sme,[e[10]||(e[10]=d("h2",null,"IEP Data Security",-1)),nt(_,{"selected-student":t.currentStudent},null,8,["selected-student"])])):_e("",!0),n.activeTab==="security"?(N(),L("div",ame,[nt(A,{"selected-student":t.currentStudent},null,8,["selected-student"])])):_e("",!0),n.activeTab==="component-health"?(N(),L("div",ime,[nt(C)])):_e("",!0),n.activeTab==="admin-permissions"?(N(),L("div",ome,[nt(T)])):_e("",!0)])])}const cme=yt(Ope,[["render",lme],["__scopeId","data-v-329f2a52"]]),ume={class:"aide-schedule-view"},dme={class:"header"},fme={class:"user-info"},hme={class:"content"},pme={key:0,class:"error-message"},mme={key:1,class:"error-message"},gme={key:2,class:"loading"},vme={key:3,class:"schedule-container"},xme={class:"schedule-display"},yme={class:"schedule-timeline"},Eme={class:"time-info"},_me={class:"time"},bme={class:"type-badge"},Sme={class:"assignment-info"},Ame={key:0},Tme={key:1,class:"no-assignment"},wme={class:"schedule-editor"},Cme={class:"editor-content"},Ime={class:"time-block-header"},kme={class:"time"},Dme={class:"type-badge"},Pme={class:"assignment-editor"},Rme=["onUpdate:modelValue"],Fme=["value"],Nme=["value"],Ome={class:"editor-actions"},Mme=["disabled"],Lme={key:0},Bme={key:1},Ume={__name:"AideScheduleView",setup(t){const e=wi(),r=xa(),{userList:n,fetchUsers:s}=ya(),{students:i,fetchStudents:a}=Ua(),{loadAppSettings:o,saveAppSettings:l}=zs(),c=se(!0),u=se(!1),f=se({}),h=se({}),p=Se(()=>{var w;return((w=r.currentUser)==null?void 0:w.role)==="paraeducator"}),m=Se(()=>{var w;return(w=r.currentUser)==null?void 0:w.uid}),v=Se(()=>{var w;return((w=n.value)==null?void 0:w.filter(x=>x.role==="teacher"))||[]});async function g(){var w;try{const x=await Jt(Ze(ze,"app_settings","global"));if(x.exists()){const S=x.data();f.value=((w=S.timeTables)==null?void 0:w[0])||S.timeTable||{}}}catch(x){console.error("Error loading time table:",x)}}function y(){return f.value.schedule?f.value.schedule.map((w,x)=>({...w,id:w.id||`block-${x}`,assignments:h.value[w.id||`block-${x}`]||{}})):[]}function E(){return y().map(x=>{const S=x.assignments[m.value];let _="";if(S){if(S.startsWith("teacher:")){const A=S.replace("teacher:",""),C=v.value.find(T=>T.id===A);_=C?C.name||C.email:"Unknown Teacher"}else if(S.startsWith("student:")){const A=S.replace("student:",""),C=i.value.find(T=>T.id===A);_=C?`${ot(C,"firstName")} ${ot(C,"lastName")}`:"Unknown Student"}}return{...x,assignment:_}})}async function b(){try{u.value=!0;const w=await o(),x={...w.detailedAideSchedule};y().forEach(_=>{x[_.id]||(x[_.id]={}),x[_.id][m.value]=_.assignments[m.value]});const S={...w,detailedAideSchedule:x};await l(S),console.log("My schedule saved successfully")}catch(w){console.error("Error saving my schedule:",w)}finally{u.value=!1}}function k(){r.logout(),e.push("/login")}async function P(){try{c.value=!0,await Promise.all([s(),a(),o(),g()]);const w=await Jt(Ze(ze,"app_settings","global"));if(w.exists()){const x=w.data();h.value=x.detailedAideSchedule||{}}c.value=!1}catch(w){console.error("Error loading aide schedule data:",w),c.value=!1}}return Ut(P),(w,x)=>{var S,_;return N(),L("div",ume,[d("div",dme,[x[2]||(x[2]=d("h1",null,"My Schedule",-1)),d("div",fme,[d("span",null,J(((S=ee(r).currentUser)==null?void 0:S.name)||((_=ee(r).currentUser)==null?void 0:_.email)),1),d("button",{onClick:k,class:"btn btn-secondary"}," Logout ")])]),d("div",hme,[ee(r).currentUser?p.value?c.value?(N(),L("div",gme," Loading your schedule... ")):(N(),L("div",vme,[d("div",xme,[x[7]||(x[7]=d("h2",null,"My Daily Schedule",-1)),d("div",yme,[(N(!0),L(Re,null,Ve(E(),A=>(N(),L("div",{key:A.id,class:Qe(["time-block",A.type])},[d("div",Eme,[d("span",_me,J(A.startTime)+" - "+J(A.endTime),1),d("span",bme,J(A.type),1)]),d("div",Sme,[A.assignment?(N(),L("span",Ame,J(A.assignment),1)):(N(),L("span",Tme,"No Assignment"))])],2))),128))])]),d("div",wme,[x[9]||(x[9]=d("h2",null,"Edit My Schedule",-1)),d("div",Cme,[(N(!0),L(Re,null,Ve(y(),A=>(N(),L("div",{key:A.id,class:"time-block-editor"},[d("div",Ime,[d("span",kme,J(A.startTime)+" - "+J(A.endTime),1),d("span",Dme,J(A.type),1)]),d("div",Pme,[we(d("select",{"onUpdate:modelValue":C=>A.assignments[m.value]=C,class:"assignment-select"},[x[8]||(x[8]=d("option",{value:""},"No Assignment",-1)),(N(!0),L(Re,null,Ve(v.value,C=>(N(),L("option",{key:C.id,value:`teacher:${C.id}`},J(C.name||C.email),9,Fme))),128)),(N(!0),L(Re,null,Ve(ee(i),C=>(N(),L("option",{key:C.id,value:`student:${C.id}`},J(ee(ot)(C,"firstName"))+" "+J(ee(ot)(C,"lastName")),9,Nme))),128))],8,Rme),[[ur,A.assignments[m.value]]])])]))),128))]),d("div",Ome,[d("button",{onClick:b,class:"btn btn-primary",disabled:u.value},[u.value?(N(),L("span",Lme,"💾")):(N(),L("span",Bme,"💾")),Ne(" "+J(u.value?"Saving...":"Save My Schedule"),1)],8,Mme)])])])):(N(),L("div",mme,[x[5]||(x[5]=d("h2",null,"Access Denied",-1)),x[6]||(x[6]=d("p",null,"This page is only available to paraeducators.",-1)),d("button",{onClick:x[1]||(x[1]=A=>ee(e).push("/")),class:"btn btn-primary"},"Go Home")])):(N(),L("div",pme,[x[3]||(x[3]=d("h2",null,"Authentication Required",-1)),x[4]||(x[4]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:x[0]||(x[0]=A=>ee(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])])}}},$me=yt(Ume,[["__scopeId","data-v-f2c7a0cd"]]),Vme={class:"secure-pdf-test"},Hme={class:"test-section"},jme={class:"status-grid"},Gme={class:"status-item"},Wme={class:"status-value"},zme={class:"status-item"},Kme={class:"status-value"},qme={class:"status-item"},Xme={class:"status-value"},Yme={class:"status-item"},Qme={class:"status-value"},Jme={class:"test-section"},Zme=["disabled"],ege=["disabled"],tge={class:"test-section"},rge=["disabled"],nge={key:0,class:"error-message"},sge={key:1,class:"success-message"},age={key:0,class:"test-section"},ige=["disabled"],oge={key:0,class:"error-message"},lge={key:1,class:"success-message"},cge={class:"test-section"},uge=["disabled"],dge={key:0,class:"error-message"},fge={key:1,class:"success-message"},hge={class:"test-section"},pge=["disabled"],mge={key:0,class:"error-message"},gge={key:1,class:"success-message"},vge={__name:"SecurePdfTest",setup(t){const e=se(null),r=se("test-student-123"),n=se(null),s=se(!1),i=se(!1),a=se(!1),o=se(null),l=se(null),c=se(!1),u=se(null),f=se(null),h=se("Checking..."),p=se("Checking..."),m=se("Checking..."),v=se("Checking..."),g=se(null),y=se(null),E=se(null),b=se(null),{uploadPdf:k,downloadPdf:P,isUploading:w,isDownloading:x}=Lx();Se(()=>{var R,F,M;return((R=St.currentUser)==null?void 0:R.role)||((M=(F=St.currentUser)==null?void 0:F.claims)==null?void 0:M.role)||"unknown"});const S=R=>{const F=R.target.files[0];if(F){if(F.type!=="application/pdf"){alert("Please select a PDF file"),R.target.value="";return}e.value=F,y.value=null,g.value=null,o.value=null,l.value=null}},_=async()=>{var R,F;if(!r.value){alert("Please enter a student ID");return}try{s.value=!0;const M=St.currentUser;if(M){const j=await M.getIdTokenResult();console.log("🔍 User token result:",j),console.log("🔍 User role from token:",j.claims.role)}const O=Ze(ze,"students",r.value);(await Jt(O)).exists()?alert("ℹ️ Test student already exists"):(await Ht(O,{app:{studentData:{firstName:"Test",lastName:"Student",grade:"7",plan:"IEP",caseManagerId:((R=St.currentUser)==null?void 0:R.uid)||"test-case-manager"},staffIds:[((F=St.currentUser)==null?void 0:F.uid)||"test-user"],schedule:{periods:{},classServices:[]},providers:{},accommodations:{instruction:"",assessment:""},flags:{flag1:!1,flag2:!1}},createdAt:Wn()}),alert("✅ Test student created successfully!"))}catch(M){alert(`❌ Error creating test student: ${M.message}`),console.error("Error creating test student:",M),M.message.includes("permissions")&&alert("⚠️ Admin permissions required. Try using an existing student ID instead.")}finally{s.value=!1}},A=async()=>{var R,F,M,O;try{i.value=!0;const K=bt(ze,"students"),j=nr(K,Ts(5)),H=await $t(j);if(H.empty)alert("❌ No students found in database");else{const W=H.docs.map(re=>({id:re.id,...re.data()}));console.log("📋 Available students:",W);const X=W[0];r.value=X.id,alert(`✅ Found student: ${((F=(R=X.app)==null?void 0:R.studentData)==null?void 0:F.firstName)||"Unknown"} ${((O=(M=X.app)==null?void 0:M.studentData)==null?void 0:O.lastName)||"Student"} (ID: ${X.id})`)}}catch(K){alert(`❌ Error finding student: ${K.message}`),console.error("Error finding student:",K)}finally{i.value=!1}},C=async()=>{if(!e.value||!r.value){alert("Please select a file and enter a student ID");return}try{y.value=null,g.value=null;const R=await k(e.value,r.value);g.value=R,console.log("✅ Test PDF uploaded successfully:",R)}catch(R){y.value=R.message,console.error("❌ Test PDF upload failed:",R)}},T=async()=>{if(!g.value||!r.value){alert("Please upload a PDF first");return}try{E.value=null,b.value=null,await P(g.value,r.value,"test-document.pdf"),b.value=!0,console.log("✅ Test PDF downloaded successfully")}catch(R){E.value=R.message,console.error("❌ Test PDF download failed:",R)}},D=async()=>{if(!e.value){alert("Please select a file first");return}try{a.value=!0,o.value=null,l.value=null;const R=fh(Tc,`public/test-${Date.now()}.pdf`);await m4(R,e.value),l.value=!0,console.log("✅ Direct upload successful")}catch(R){o.value=R.message,console.error("❌ Direct upload failed:",R)}finally{a.value=!1}},V=async()=>{if(!r.value){alert("Please enter a student ID first");return}try{c.value=!0,u.value=null,f.value=null;const{getFunctions:R,httpsCallable:F}=await aa(async()=>{const{getFunctions:W,httpsCallable:X}=await Promise.resolve().then(()=>b0);return{getFunctions:W,httpsCallable:X}},void 0),M=R(),O=F(M,"getStudentFileUrl"),K="test-document.pdf";console.log(`🔍 Testing cloud function with studentId: ${r.value}, fileName: ${K}`);const j=await O({studentId:r.value,fileName:K});console.log("✅ Cloud function result:",j.data),f.value=!0;const H=j.data.url;H&&!H.includes("token=")?console.log("✅ URL is private (no download token)"):console.warn("⚠️ URL may not be private")}catch(R){u.value=R.message,console.error("❌ Cloud function test failed:",R)}finally{c.value=!1}},B=async()=>{try{const R=T0.encryptionKey;h.value=R&&R!=="your-dev-key-here"?"✅ Configured":"⚠️ Using default key";try{const F=fh(Tc,"public/test-access");await v4(F),p.value="✅ Accessible"}catch(F){F.code==="storage/unauthorized"?p.value="⚠️ Limited access (expected)":p.value="❌ Access denied"}try{const F=Ze(ze,"test","test");await Jt(F),m.value="✅ Accessible"}catch{m.value="❌ Access denied"}try{const F=St.currentUser;if(F){const M=await F.getIdTokenResult();v.value=M.claims.role||"unknown",console.log("🔍 User role detected:",v.value)}else v.value="not authenticated"}catch(F){v.value="error reading role",console.error("Error reading user role:",F)}}catch(R){console.error("Error checking system status:",R)}};return Ut(()=>{B()}),(R,F)=>(N(),L("div",Vme,[F[16]||(F[16]=d("h2",null,"🔒 Secure PDF System Test",-1)),d("div",Hme,[F[5]||(F[5]=d("h3",null,"System Status",-1)),d("div",jme,[d("div",Gme,[F[1]||(F[1]=d("span",{class:"status-label"},"Encryption Key:",-1)),d("span",Wme,J(h.value),1)]),d("div",zme,[F[2]||(F[2]=d("span",{class:"status-label"},"Storage Access:",-1)),d("span",Kme,J(p.value),1)]),d("div",qme,[F[3]||(F[3]=d("span",{class:"status-label"},"Firestore Access:",-1)),d("span",Xme,J(m.value),1)]),d("div",Yme,[F[4]||(F[4]=d("span",{class:"status-label"},"User Role:",-1)),d("span",Qme,J(v.value),1)])])]),d("div",Jme,[F[6]||(F[6]=d("h3",null,"Test Student ID",-1)),we(d("input",{"onUpdate:modelValue":F[0]||(F[0]=M=>r.value=M),placeholder:"Enter test student ID",class:"student-id-input"},null,512),[[Ye,r.value]]),F[7]||(F[7]=d("p",{class:"help-text"},"Enter a student ID to test with. You can:",-1)),F[8]||(F[8]=d("ul",{class:"help-text"},[d("li",null,"Use an existing student ID from your database"),d("li",null,"Create a new test student (requires admin permissions)"),d("li",null,'Use "test-student-123" for testing')],-1)),d("button",{onClick:_,disabled:s.value,class:"btn btn-secondary"},J(s.value?"Creating...":"Create Test Student"),9,Zme),d("button",{onClick:A,disabled:i.value,class:"btn btn-secondary"},J(i.value?"Finding...":"Find Existing Student"),9,ege)]),d("div",tge,[F[9]||(F[9]=d("h3",null,"Upload Test PDF",-1)),d("input",{type:"file",accept:"application/pdf",onChange:S,ref_key:"fileInput",ref:n},null,544),d("button",{onClick:C,disabled:!e.value||ee(w)},J(ee(w)?"🔄 Uploading...":"📤 Upload PDF"),9,rge),y.value?(N(),L("div",nge,J(y.value),1)):_e("",!0),g.value?(N(),L("div",sge," ✅ PDF uploaded successfully! Secure filename: "+J(g.value),1)):_e("",!0)]),g.value?(N(),L("div",age,[F[10]||(F[10]=d("h3",null,"Download Test PDF",-1)),d("button",{onClick:T,disabled:ee(x)},J(ee(x)?"🔄 Downloading...":"📥 Download PDF"),9,ige),E.value?(N(),L("div",oge,J(E.value),1)):_e("",!0),b.value?(N(),L("div",lge," ✅ PDF downloaded successfully! ")):_e("",!0)])):_e("",!0),d("div",cge,[F[11]||(F[11]=d("h3",null,"Alternative Test: Direct Storage Upload",-1)),F[12]||(F[12]=d("p",{class:"help-text"},"This test bypasses the secure PDF system and uploads directly to storage for comparison.",-1)),d("button",{onClick:D,disabled:!e.value||a.value},J(a.value?"🔄 Uploading...":"📤 Test Direct Upload"),9,uge),o.value?(N(),L("div",dge,J(o.value),1)):_e("",!0),l.value?(N(),L("div",fge," ✅ Direct upload successful! This confirms storage permissions are working. ")):_e("",!0)]),d("div",hge,[F[14]||(F[14]=d("h3",null,"Test Cloud Function: Private URL Generation",-1)),F[15]||(F[15]=d("p",{class:"help-text"},"Test if the cloud function can generate private URLs for existing files.",-1)),d("button",{onClick:V,disabled:c.value},J(c.value?"🔄 Testing...":"🔗 Test Cloud Function"),9,pge),u.value?(N(),L("div",mge,J(u.value),1)):_e("",!0),f.value?(N(),L("div",gge,F[13]||(F[13]=[Ne(" ✅ Cloud function working! Private URL generated successfully. "),d("br",null,null,-1),d("small",null,"URL expires in 5 minutes",-1)]))):_e("",!0)])]))}},xge=yt(vge,[["__scopeId","data-v-4c041459"]]);async function yge(){var t;console.log("Starting student ID migration...");try{const e=bt(ze,"students"),r=await $t(e);console.log(`Found ${r.size} students to migrate`);let n=0,s=0;for(const i of r.docs){const a=i.data(),o=i.id;if(!/^\d+$/.test(o)){console.log(`Student ${o} already uses auto-generated ID, skipping`);continue}const l=o;try{const c=Ze(bt(ze,"students")),u={...a,app:{...a.app,studentData:{...(t=a.app)==null?void 0:t.studentData,ssid:l}},migratedFrom:o,migratedAt:new Date().toISOString()};await Ht(c,u),await ho(Ze(ze,"students",o)),console.log(`✅ Migrated student ${o} → ${c.id}`),n++}catch(c){console.error(`❌ Failed to migrate student ${o}:`,c),s++}}return console.log(`Migration complete: ${n} migrated, ${s} errors`),{migratedCount:n,errorCount:s}}catch(e){throw console.error("Migration failed:",e),e}}async function Ege(){var t,e;console.log("Verifying migration...");try{const r=bt(ze,"students"),n=await $t(r);let s=0,i=0;for(const a of n.docs){const o=a.data(),l=a.id,c=(e=(t=o.app)==null?void 0:t.studentData)==null?void 0:e.ssid;c?(console.log(`✅ Student ${l} has SSID: ${c}`),s++):(console.warn(`⚠️ Student ${l} missing SSID in app data`),i++)}return console.log(`Verification complete: ${s} verified, ${i} issues`),{verifiedCount:s,issuesCount:i}}catch(r){throw console.error("Verification failed:",r),r}}async function _ge(){var s,i,a,o;console.log("🔄 Starting period label migration...");const{getNumber:t}=xo();let e=0,r=0,n=[];try{const l=bt(ze,"students"),c=await $t(l);e=c.size,console.log(`📊 Found ${e} students to check`);for(const u of c.docs)try{const f=u.data();let h=!1,p={};const m=((i=(s=f.app)==null?void 0:s.schedule)==null?void 0:i.periods)||f.schedule||{};if(Object.entries(m).forEach(([v,g])=>{if(isNaN(parseInt(v))){const y=t(v);if(y)p[y]=g,h=!0,console.log(`🔧 Converting "${v}" → ${y} for student ${u.id}`);else{const E=v.match(/^(?:period|per)(\d+)$/i);E?(p[parseInt(E[1])]=g,h=!0,console.log(`🔧 Converting "${v}" → ${E[1]} for student ${u.id}`)):(console.warn(`⚠️ Could not convert period key "${v}" for student ${u.id}`),p[v]=g)}}else p[v]=g}),h){const v={};(o=(a=f.app)==null?void 0:a.schedule)!=null&&o.periods?v["app.schedule.periods"]=p:f.schedule&&(v.schedule=p),Object.keys(v).length>0&&(await Cp(Ze(ze,"students",u.id),v),r++,console.log(`✅ Updated student ${u.id}`))}}catch(f){console.error(`❌ Error processing student ${u.id}:`,f),n.push({studentId:u.id,error:f.message})}return console.log("🎉 Migration completed!"),console.log("📈 Results:"),console.log(`   - Total students checked: ${e}`),console.log(`   - Students migrated: ${r}`),console.log(`   - Errors: ${n.length}`),n.length>0&&(console.warn("⚠️ Errors encountered:"),n.forEach(({studentId:u,error:f})=>{console.warn(`   - ${u}: ${f}`)})),{success:!0,totalStudents:e,migratedStudents:r,errors:n}}catch(l){return console.error("💥 Migration failed:",l),{success:!1,error:l.message,totalStudents:e,migratedStudents:r,errors:n}}}async function bge(){var n,s;console.log("👀 Starting migration preview...");const{getNumber:t}=xo();let e=0,r=[];try{const i=bt(ze,"students"),a=await $t(i);e=a.size;for(const o of a.docs){const l=o.data(),c=((s=(n=l.app)==null?void 0:n.schedule)==null?void 0:s.periods)||l.schedule||{};let u=[];Object.keys(c).forEach(f=>{if(isNaN(parseInt(f))){const h=t(f);if(h)u.push({from:f,to:h});else{const p=f.match(/^(?:period|per)(\d+)$/i);p&&u.push({from:f,to:parseInt(p[1])})}}}),u.length>0&&r.push({id:o.id,name:`${l.firstName||""} ${l.lastName||""}`.trim(),changes:u})}return console.log("📋 Migration Preview Results:"),console.log(`   - Total students: ${e}`),console.log(`   - Students needing migration: ${r.length}`),r.length>0&&(console.log("   - Changes needed:"),r.forEach(o=>{console.log(`     📝 ${o.name} (${o.id}):`),o.changes.forEach(l=>{console.log(`        "${l.from}" → ${l.to}`)})})),{totalStudents:e,studentsNeedingMigration:r,changesNeeded:r.length>0}}catch(i){return console.error("💥 Preview failed:",i),{error:i.message,totalStudents:0,studentsNeedingMigration:[],changesNeeded:!1}}}const Sge={class:"testing-view"},Age={class:"test-section"},Tge={class:"status-grid"},wge={class:"status-item"},Cge={class:"status-item"},Ige={class:"status-item"},kge={key:0,class:"test-section"},Dge={class:"settings-display"},Pge={class:"setting-group"},Rge={class:"setting-values"},Fge={class:"setting-group"},Nge={class:"setting-values"},Oge={class:"setting-group"},Mge={class:"setting-values"},Lge={class:"setting-group"},Bge={class:"setting-values"},Uge={class:"test-section"},$ge={class:"admin-action-btns"},Vge=["disabled"],Hge=["disabled"],jge={class:"test-section"},Gge={class:"integration-test"},Wge={key:0,class:"test-form-container"},zge={class:"test-section"},Kge={class:"admin-action-btns"},qge=["disabled"],Xge=["disabled"],Yge={key:0,class:"migration-result"},Qge={class:"test-section"},Jge={class:"period-migration-controls"},Zge=["disabled"],eve=["disabled"],tve={key:0,class:"migration-result"},rve={class:"test-section"},nve={class:"ssid-test-controls"},sve=["disabled"],ave={key:0,class:"ssid-test-result"},ive={class:"test-section"},ove={__name:"TestingView",setup(t){const{appSettings:e,loadAppSettings:r,resetAppSettings:n,loading:s,error:i}=zs(),{labels:a}=xo(),o=se(!1),l=se(!1),c=se(!1),u=se(null),f=se(!1),h=se(null),p=se(!1),m=se(null);Ut(async()=>{console.log("TestingView: Component mounted, checking app settings...")});const v=async()=>{try{await r(),console.log("TestingView: Settings reloaded successfully")}catch(S){console.error("TestingView: Error reloading settings:",S)}},g=async()=>{try{await n(),console.log("TestingView: Settings reset successfully")}catch(S){console.error("TestingView: Error resetting settings:",S)}},y=S=>{console.log("TestingView: Test student saved:",S),o.value=!1},E=async()=>{l.value=!0,u.value=null;try{const S=await yge();u.value=S,console.log("Migration completed:",S)}catch(S){u.value={error:S.message},console.error("Migration failed:",S)}finally{l.value=!1}},b=async()=>{c.value=!0,u.value=null;try{const S=await Ege();u.value=S,console.log("Verification completed:",S)}catch(S){u.value={error:S.message},console.error("Verification failed:",S)}finally{c.value=!1}},k=async()=>{f.value=!0,h.value=null;try{const S=[{sourcedId:"123456789",givenName:"John",familyName:"Doe",specialEducation:"true"},{SSID:"987654321",FirstName:"Jane",LastName:"Smith",IEP:"Yes"},{ssid:"555666777",FirstName:"Bob",LastName:"Johnson",iep:"1"},{StateStudentID:"111222333",FirstName:"Alice",LastName:"Brown",504:"true"}],_={aeriesMapping:{},seisMapping:{},ssidExtraction:{},fieldMapping:{}};S.forEach((C,T)=>{const D={};Object.keys(C).forEach(V=>{D[V]=Iv(V)}),_.aeriesMapping[`row_${T}`]=D}),S.forEach((C,T)=>{const D={};Object.keys(C).forEach(V=>{D[V]=kv(V)}),_.seisMapping[`row_${T}`]=D}),S.forEach((C,T)=>{var V;const D=(V=C.sourcedId||C.SSID||C.ssid||C.StateStudentID||C.stateStudentId)==null?void 0:V.trim();_.ssidExtraction[`row_${T}`]={original:C,extractedSSID:D,success:!!D}});const A=["specialEducation","iep","IEP","plan504","504","disabilities","accommodations"];_.fieldMapping={aeries:A.map(C=>({field:C,mapped:Iv(C)})),seis:A.map(C=>({field:C,mapped:kv(C)}))},h.value={success:!0,message:"SSID resolution test completed successfully",results:_},console.log("SSID resolution test completed:",_)}catch(S){h.value={success:!1,error:S.message,message:"SSID resolution test failed"},console.error("SSID resolution test failed:",S)}finally{f.value=!1}},P=()=>{h.value=null},w=async()=>{p.value=!0,m.value=null;try{console.log("Starting period label migration preview...");const S=await bge();S.error?m.value=`Preview failed: ${S.error}`:S.changesNeeded?m.value=`Preview completed: ${S.studentsNeedingMigration.length} students need migration (see console for details)`:m.value="No migration needed - all students already use numeric period keys"}catch(S){console.error("Period migration preview failed:",S),m.value=`Preview error: ${S.message}`}finally{p.value=!1}},x=async()=>{if(confirm("This will update period keys from labels to numbers for all students. Continue?")){p.value=!0,m.value=null;try{console.log("Starting period label migration...");const S=await _ge();S.success?(m.value=`Migration completed: ${S.migratedStudents}/${S.totalStudents} students updated`,S.errors.length>0&&(m.value+=` (${S.errors.length} errors - see console)`)):m.value=`Migration failed: ${S.error}`}catch(S){console.error("Period migration failed:",S),m.value=`Migration error: ${S.message}`}finally{p.value=!1}}};return(S,_)=>{var A,C,T,D,V,B;return N(),L("div",Sge,[_[21]||(_[21]=d("h2",null,"App Settings Testing",-1)),d("div",Age,[_[5]||(_[5]=d("h3",null,"App Settings Status",-1)),d("div",Tge,[d("div",wge,[_[2]||(_[2]=d("strong",null,"Loading:",-1)),Ne(" "+J(ee(s)?"Yes":"No"),1)]),d("div",Cge,[_[3]||(_[3]=d("strong",null,"Error:",-1)),Ne(" "+J(ee(i)||"None"),1)]),d("div",Ige,[_[4]||(_[4]=d("strong",null,"Loaded:",-1)),Ne(" "+J(ee(e)&&Object.keys(ee(e)).length>0?"Yes":"No"),1)])])]),ee(e)?(N(),L("div",kge,[_[10]||(_[10]=d("h3",null,"Current Settings",-1)),d("div",Dge,[d("div",Pge,[d("h4",null,"Grades ("+J(((A=ee(e).grades)==null?void 0:A.length)||0)+")",1),d("div",Rge,J(((C=ee(e).grades)==null?void 0:C.join(", "))||"None configured"),1)]),d("div",Fge,[d("h4",null,"Class Services ("+J(((T=ee(e).classServices)==null?void 0:T.length)||0)+")",1),d("div",Nge,[(N(!0),L(Re,null,Ve(ee(e).classServices,R=>{var F;return N(),L("div",{key:R.name,class:"service-item"},[d("strong",null,J(R.name)+":",1),Ne(" "+J(((F=R.enabledSubcategories)==null?void 0:F.join(", "))||"None enabled"),1)])}),128))])]),d("div",Oge,[d("h4",null,"Service Providers ("+J(((D=ee(e).serviceProviders)==null?void 0:D.length)||0)+")",1),d("div",Mge,J(((V=ee(e).serviceProviders)==null?void 0:V.join(", "))||"None configured"),1)]),d("div",Lge,[_[9]||(_[9]=d("h4",null,"Periods",-1)),d("div",Bge,[_[6]||(_[6]=d("strong",null,"Number:",-1)),Ne(" "+J(ee(e).numPeriods||0),1),_[7]||(_[7]=d("br",null,null,-1)),_[8]||(_[8]=d("strong",null,"Labels:",-1)),Ne(" "+J(((B=ee(a))==null?void 0:B.join(", "))||"None"),1)])])])])):_e("",!0),d("div",Uge,[_[11]||(_[11]=d("h3",null,"Test Actions",-1)),d("div",$ge,[d("button",{onClick:v,disabled:ee(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},J(ee(s)?"Loading...":"Reload Settings"),9,Vge),d("button",{onClick:g,disabled:ee(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Defaults ",8,Hge)])]),d("div",jge,[_[13]||(_[13]=d("h3",null,"Component Integration Test",-1)),d("div",Gge,[_[12]||(_[12]=d("p",null,"This section tests if the StudentForm can access app settings:",-1)),d("button",{onClick:_[0]||(_[0]=R=>o.value=!o.value),class:"btn btn-primary"},J(o.value?"Hide":"Show")+" Test Student Form ",1),o.value?(N(),L("div",Wge,[nt(Bx,{users:{userRoles:{}},mode:"new",onClose:_[1]||(_[1]=R=>o.value=!1),onSaved:y})])):_e("",!0)])]),d("div",zge,[_[15]||(_[15]=d("h3",null,"Migration Tools",-1)),d("div",Kge,[d("button",{onClick:E,disabled:l.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},J(l.value?"Migrating...":"Migrate Student IDs"),9,qge),d("button",{onClick:b,disabled:c.value,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},J(c.value?"Verifying...":"Verify Migration"),9,Xge)]),u.value?(N(),L("div",Yge,[_[14]||(_[14]=d("h4",null,"Migration Result:",-1)),d("pre",null,J(JSON.stringify(u.value,null,2)),1)])):_e("",!0)]),d("div",Qge,[_[17]||(_[17]=d("h3",null,"Period Label Migration",-1)),d("div",Jge,[d("button",{onClick:w,disabled:p.value,class:"btn btn-secondary"},J(p.value?"Previewing...":"Preview Period Migration"),9,Zge),d("button",{onClick:x,disabled:p.value,class:"btn btn-warning"},J(p.value?"Migrating...":"Run Period Migration"),9,eve)]),m.value?(N(),L("div",tve,[_[16]||(_[16]=d("h4",null,"Period Migration Result:",-1)),d("p",null,J(m.value),1)])):_e("",!0)]),d("div",rve,[_[19]||(_[19]=d("h3",null,"SSID Resolution Test",-1)),d("div",nve,[d("button",{onClick:k,disabled:f.value,class:"btn btn-primary"},J(f.value?"Testing...":"Test SSID Resolution"),9,sve),d("button",{onClick:P,class:"btn btn-secondary"}," Clear Results ")]),h.value?(N(),L("div",ave,[_[18]||(_[18]=d("h4",null,"SSID Resolution Test Result:",-1)),d("pre",null,J(JSON.stringify(h.value,null,2)),1)])):_e("",!0)]),d("div",ive,[_[20]||(_[20]=d("h3",null,"🔒 Secure PDF System Test",-1)),nt(xge)])])}}},lve=yt(ove,[["__scopeId","data-v-16ace2fd"]]),cve=t=>{console.log("Router guards setup completed")},uve=[{path:"/login",name:"Login",component:dj},{path:"/",name:"Home",redirect:"/students"},{path:"/students",name:"Students",component:lj,meta:{requiresAuth:!0,allowedRoles:HL}},{path:"/admin",name:"Admin",component:cme,meta:{requiresAuth:!0,allowedRoles:au}},{path:"/admin/aide-assignment",name:"AdminAideAssignment",component:J4,meta:{requiresAuth:!0,allowedRoles:au}},{path:"/admin/time-table",name:"AdminTimeTable",component:Fk,meta:{requiresAuth:!0,allowedRoles:au}},{path:"/admin/aide-schedule",name:"AdminAideSchedule",component:Wk,meta:{requiresAuth:!0,allowedRoles:au}},{path:"/admin/backup-restore",name:"AdminBackupRestore",component:zk,meta:{requiresAuth:!0,allowedRoles:au}},{path:"/aide-schedule",name:"AideSchedule",component:$me,meta:{requiresAuth:!0,allowedRoles:["paraeducator"]}},{path:"/testing",name:"Testing",component:lve,meta:{requiresAuth:!0,allowedRoles:["admin","school_admin","sped_chair","admin_504"]}}],dve=LL({history:fL("/"),routes:uve});cve();const vy=z0(SB),fve=HR();vy.use(dve);vy.use(fve);vy.mount("#app");
//# sourceMappingURL=index-xT0yY0P_.js.map
