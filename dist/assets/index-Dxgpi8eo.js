(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Hh(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const Jt={},Zl=[],js=()=>{},jD=()=>!1,Bd=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),i1=t=>t.startsWith("onUpdate:"),xr=Object.assign,o1=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},GD=Object.prototype.hasOwnProperty,ur=(t,e)=>GD.call(t,e),ft=Array.isArray,ec=t=>Mc(t)==="[object Map]",dl=t=>Mc(t)==="[object Set]",g2=t=>Mc(t)==="[object Date]",WD=t=>Mc(t)==="[object RegExp]",Tt=t=>typeof t=="function",Tr=t=>typeof t=="string",ga=t=>typeof t=="symbol",gr=t=>t!==null&&typeof t=="object",l1=t=>(gr(t)||Tt(t))&&Tt(t.then)&&Tt(t.catch),QS=Object.prototype.toString,Mc=t=>QS.call(t),zD=t=>Mc(t).slice(8,-1),jh=t=>Mc(t)==="[object Object]",c1=t=>Tr(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,tc=Hh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Gh=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},KD=/-(\w)/g,Rn=Gh(t=>t.replace(KD,(e,r)=>r?r.toUpperCase():"")),qD=/\B([A-Z])/g,bs=Gh(t=>t.replace(qD,"-$1").toLowerCase()),Ud=Gh(t=>t.charAt(0).toUpperCase()+t.slice(1)),Pu=Gh(t=>t?`on${Ud(t)}`:""),ls=(t,e)=>!Object.is(t,e),rc=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},Ug=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},$0=t=>{const e=parseFloat(t);return isNaN(e)?t:e},V0=t=>{const e=Tr(t)?Number(t):NaN;return isNaN(e)?t:e};let v2;const Wh=()=>v2||(v2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),XD="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",YD=Hh(XD);function Nr(t){if(ft(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],s=Tr(n)?e3(n):Nr(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(Tr(t)||gr(t))return t}const QD=/;(?![^(]*\))/g,JD=/:([^]+)/,ZD=/\/\*[^]*?\*\//g;function e3(t){const e={};return t.replace(ZD,"").split(QD).forEach(r=>{if(r){const n=r.split(JD);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Ye(t){let e="";if(Tr(t))e=t;else if(ft(t))for(let r=0;r<t.length;r++){const n=Ye(t[r]);n&&(e+=n+" ")}else if(gr(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function t3(t){if(!t)return null;let{class:e,style:r}=t;return e&&!Tr(e)&&(t.class=Ye(e)),r&&(t.style=Nr(r)),t}const r3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",n3=Hh(r3);function JS(t){return!!t||t===""}function s3(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=io(t[n],e[n]);return r}function io(t,e){if(t===e)return!0;let r=g2(t),n=g2(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=ga(t),n=ga(e),r||n)return t===e;if(r=ft(t),n=ft(e),r||n)return r&&n?s3(t,e):!1;if(r=gr(t),n=gr(e),r||n){if(!r||!n)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const a in t){const o=t.hasOwnProperty(a),l=e.hasOwnProperty(a);if(o&&!l||!o&&l||!io(t[a],e[a]))return!1}}return String(t)===String(e)}function zh(t,e){return t.findIndex(r=>io(r,e))}const ZS=t=>!!(t&&t.__v_isRef===!0),Q=t=>Tr(t)?t:t==null?"":ft(t)||gr(t)&&(t.toString===QS||!Tt(t.toString))?ZS(t)?Q(t.value):JSON.stringify(t,eA,2):String(t),eA=(t,e)=>ZS(e)?eA(t,e.value):ec(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,s],i)=>(r[Jp(n,i)+" =>"]=s,r),{})}:dl(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>Jp(r))}:ga(e)?Jp(e):gr(e)&&!ft(e)&&!jh(e)?String(e):e,Jp=(t,e="")=>{var r;return ga(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let jn;class u1{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=jn,!e&&jn&&(this.index=(jn.scopes||(jn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=jn;try{return jn=this,e()}finally{jn=r}}}on(){++this._on===1&&(this.prevScope=jn,jn=this)}off(){this._on>0&&--this._on===0&&(jn=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function d1(t){return new u1(t)}function f1(){return jn}function tA(t,e=!1){jn&&jn.cleanups.push(t)}let _r;const Zp=new WeakSet;class cd{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,jn&&jn.active&&jn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Zp.has(this)&&(Zp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||nA(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,y2(this),sA(this);const e=_r,r=ha;_r=this,ha=!0;try{return this.fn()}finally{aA(this),_r=e,ha=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)m1(e);this.deps=this.depsTail=void 0,y2(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Zp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){$g(this)&&this.run()}get dirty(){return $g(this)}}let rA=0,Ru,Fu;function nA(t,e=!1){if(t.flags|=8,e){t.next=Fu,Fu=t;return}t.next=Ru,Ru=t}function h1(){rA++}function p1(){if(--rA>0)return;if(Fu){let e=Fu;for(Fu=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;Ru;){let e=Ru;for(Ru=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=r}}if(t)throw t}function sA(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function aA(t){let e,r=t.depsTail,n=r;for(;n;){const s=n.prevDep;n.version===-1?(n===r&&(r=s),m1(n),a3(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}t.deps=e,t.depsTail=r}function $g(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(iA(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function iA(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===ud)||(t.globalVersion=ud,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!$g(t))))return;t.flags|=2;const e=t.dep,r=_r,n=ha;_r=t,ha=!0;try{sA(t);const s=t.fn(t._value);(e.version===0||ls(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{_r=r,ha=n,aA(t),t.flags&=-3}}function m1(t,e=!1){const{dep:r,prevSub:n,nextSub:s}=t;if(n&&(n.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=n,t.nextSub=void 0),r.subs===t&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)m1(i,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function a3(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}function i3(t,e){t.effect instanceof cd&&(t=t.effect.fn);const r=new cd(t);e&&xr(r,e);try{r.run()}catch(s){throw r.stop(),s}const n=r.run.bind(r);return n.effect=r,n}function o3(t){t.effect.stop()}let ha=!0;const oA=[];function vi(){oA.push(ha),ha=!1}function yi(){const t=oA.pop();ha=t===void 0?!0:t}function y2(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=_r;_r=void 0;try{e()}finally{_r=r}}}let ud=0,l3=class{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Kh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!_r||!ha||_r===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==_r)r=this.activeLink=new l3(_r,this),_r.deps?(r.prevDep=_r.depsTail,_r.depsTail.nextDep=r,_r.depsTail=r):_r.deps=_r.depsTail=r,lA(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=_r.depsTail,r.nextDep=void 0,_r.depsTail.nextDep=r,_r.depsTail=r,_r.deps===r&&(_r.deps=n)}return r}trigger(e){this.version++,ud++,this.notify(e)}notify(e){h1();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{p1()}}}function lA(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)lA(n)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const H0=new WeakMap,Vo=Symbol(""),Vg=Symbol(""),dd=Symbol("");function zn(t,e,r){if(ha&&_r){let n=H0.get(t);n||H0.set(t,n=new Map);let s=n.get(r);s||(n.set(r,s=new Kh),s.map=n,s.key=r),s.track()}}function ei(t,e,r,n,s,i){const a=H0.get(t);if(!a){ud++;return}const o=l=>{l&&l.trigger()};if(h1(),e==="clear")a.forEach(o);else{const l=ft(t),c=l&&c1(r);if(l&&r==="length"){const u=Number(n);a.forEach((f,h)=>{(h==="length"||h===dd||!ga(h)&&h>=u)&&o(f)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),c&&o(a.get(dd)),e){case"add":l?c&&o(a.get("length")):(o(a.get(Vo)),ec(t)&&o(a.get(Vg)));break;case"delete":l||(o(a.get(Vo)),ec(t)&&o(a.get(Vg)));break;case"set":ec(t)&&o(a.get(Vo));break}}p1()}function c3(t,e){const r=H0.get(t);return r&&r.get(e)}function Rl(t){const e=Xt(t);return e===t?e:(zn(e,"iterate",dd),Ns(t)?e:e.map(Dn))}function qh(t){return zn(t=Xt(t),"iterate",dd),t}const u3={__proto__:null,[Symbol.iterator](){return em(this,Symbol.iterator,Dn)},concat(...t){return Rl(this).concat(...t.map(e=>ft(e)?Rl(e):e))},entries(){return em(this,"entries",t=>(t[1]=Dn(t[1]),t))},every(t,e){return Ya(this,"every",t,e,void 0,arguments)},filter(t,e){return Ya(this,"filter",t,e,r=>r.map(Dn),arguments)},find(t,e){return Ya(this,"find",t,e,Dn,arguments)},findIndex(t,e){return Ya(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ya(this,"findLast",t,e,Dn,arguments)},findLastIndex(t,e){return Ya(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ya(this,"forEach",t,e,void 0,arguments)},includes(...t){return tm(this,"includes",t)},indexOf(...t){return tm(this,"indexOf",t)},join(t){return Rl(this).join(t)},lastIndexOf(...t){return tm(this,"lastIndexOf",t)},map(t,e){return Ya(this,"map",t,e,void 0,arguments)},pop(){return nu(this,"pop")},push(...t){return nu(this,"push",t)},reduce(t,...e){return x2(this,"reduce",t,e)},reduceRight(t,...e){return x2(this,"reduceRight",t,e)},shift(){return nu(this,"shift")},some(t,e){return Ya(this,"some",t,e,void 0,arguments)},splice(...t){return nu(this,"splice",t)},toReversed(){return Rl(this).toReversed()},toSorted(t){return Rl(this).toSorted(t)},toSpliced(...t){return Rl(this).toSpliced(...t)},unshift(...t){return nu(this,"unshift",t)},values(){return em(this,"values",Dn)}};function em(t,e,r){const n=qh(t),s=n[e]();return n!==t&&!Ns(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=r(i.value)),i}),s}const d3=Array.prototype;function Ya(t,e,r,n,s,i){const a=qh(t),o=a!==t&&!Ns(t),l=a[e];if(l!==d3[e]){const f=l.apply(t,i);return o?Dn(f):f}let c=r;a!==t&&(o?c=function(f,h){return r.call(this,Dn(f),h,t)}:r.length>2&&(c=function(f,h){return r.call(this,f,h,t)}));const u=l.call(a,c,n);return o&&s?s(u):u}function x2(t,e,r,n){const s=qh(t);let i=r;return s!==t&&(Ns(t)?r.length>3&&(i=function(a,o,l){return r.call(this,a,o,l,t)}):i=function(a,o,l){return r.call(this,a,Dn(o),l,t)}),s[e](i,...n)}function tm(t,e,r){const n=Xt(t);zn(n,"iterate",dd);const s=n[e](...r);return(s===-1||s===!1)&&Qh(r[0])?(r[0]=Xt(r[0]),n[e](...r)):s}function nu(t,e,r=[]){vi(),h1();const n=Xt(t)[e].apply(t,r);return p1(),yi(),n}const f3=Hh("__proto__,__v_isRef,__isVue"),cA=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ga));function h3(t){ga(t)||(t=String(t));const e=Xt(this);return zn(e,"has",t),e.hasOwnProperty(t)}class uA{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){if(r==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(s?i?gA:mA:i?pA:hA).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=ft(e);if(!s){let l;if(a&&(l=u3[r]))return l;if(r==="hasOwnProperty")return h3}const o=Reflect.get(e,r,Cr(e)?e:n);return(ga(r)?cA.has(r):f3(r))||(s||zn(e,"get",r),i)?o:Cr(o)?a&&c1(r)?o:o.value:gr(o)?s?nc(o):As(o):o}}class dA extends uA{constructor(e=!1){super(!1,e)}set(e,r,n,s){let i=e[r];if(!this._isShallow){const l=xi(i);if(!Ns(n)&&!xi(n)&&(i=Xt(i),n=Xt(n)),!ft(e)&&Cr(i)&&!Cr(n))return l?!1:(i.value=n,!0)}const a=ft(e)&&c1(r)?Number(r)<e.length:ur(e,r),o=Reflect.set(e,r,n,Cr(e)?e:s);return e===Xt(s)&&(a?ls(n,i)&&ei(e,"set",r,n):ei(e,"add",r,n)),o}deleteProperty(e,r){const n=ur(e,r);e[r];const s=Reflect.deleteProperty(e,r);return s&&n&&ei(e,"delete",r,void 0),s}has(e,r){const n=Reflect.has(e,r);return(!ga(r)||!cA.has(r))&&zn(e,"has",r),n}ownKeys(e){return zn(e,"iterate",ft(e)?"length":Vo),Reflect.ownKeys(e)}}class fA extends uA{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const p3=new dA,m3=new fA,g3=new dA(!0),v3=new fA(!0),Hg=t=>t,kf=t=>Reflect.getPrototypeOf(t);function y3(t,e,r){return function(...n){const s=this.__v_raw,i=Xt(s),a=ec(i),o=t==="entries"||t===Symbol.iterator&&a,l=t==="keys"&&a,c=s[t](...n),u=r?Hg:e?j0:Dn;return!e&&zn(i,"iterate",l?Vg:Vo),{next(){const{value:f,done:h}=c.next();return h?{value:f,done:h}:{value:o?[u(f[0]),u(f[1])]:u(f),done:h}},[Symbol.iterator](){return this}}}}function Df(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function x3(t,e){const r={get(s){const i=this.__v_raw,a=Xt(i),o=Xt(s);t||(ls(s,o)&&zn(a,"get",s),zn(a,"get",o));const{has:l}=kf(a),c=e?Hg:t?j0:Dn;if(l.call(a,s))return c(i.get(s));if(l.call(a,o))return c(i.get(o));i!==a&&i.get(s)},get size(){const s=this.__v_raw;return!t&&zn(Xt(s),"iterate",Vo),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,a=Xt(i),o=Xt(s);return t||(ls(s,o)&&zn(a,"has",s),zn(a,"has",o)),s===o?i.has(s):i.has(s)||i.has(o)},forEach(s,i){const a=this,o=a.__v_raw,l=Xt(o),c=e?Hg:t?j0:Dn;return!t&&zn(l,"iterate",Vo),o.forEach((u,f)=>s.call(i,c(u),c(f),a))}};return xr(r,t?{add:Df("add"),set:Df("set"),delete:Df("delete"),clear:Df("clear")}:{add(s){!e&&!Ns(s)&&!xi(s)&&(s=Xt(s));const i=Xt(this);return kf(i).has.call(i,s)||(i.add(s),ei(i,"add",s,s)),this},set(s,i){!e&&!Ns(i)&&!xi(i)&&(i=Xt(i));const a=Xt(this),{has:o,get:l}=kf(a);let c=o.call(a,s);c||(s=Xt(s),c=o.call(a,s));const u=l.call(a,s);return a.set(s,i),c?ls(i,u)&&ei(a,"set",s,i):ei(a,"add",s,i),this},delete(s){const i=Xt(this),{has:a,get:o}=kf(i);let l=a.call(i,s);l||(s=Xt(s),l=a.call(i,s)),o&&o.call(i,s);const c=i.delete(s);return l&&ei(i,"delete",s,void 0),c},clear(){const s=Xt(this),i=s.size!==0,a=s.clear();return i&&ei(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=y3(s,t,e)}),r}function Xh(t,e){const r=x3(t,e);return(n,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?n:Reflect.get(ur(r,s)&&s in n?r:n,s,i)}const E3={get:Xh(!1,!1)},b3={get:Xh(!1,!0)},_3={get:Xh(!0,!1)},S3={get:Xh(!0,!0)},hA=new WeakMap,pA=new WeakMap,mA=new WeakMap,gA=new WeakMap;function A3(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function T3(t){return t.__v_skip||!Object.isExtensible(t)?0:A3(zD(t))}function As(t){return xi(t)?t:Yh(t,!1,p3,E3,hA)}function g1(t){return Yh(t,!1,g3,b3,pA)}function nc(t){return Yh(t,!0,m3,_3,mA)}function w3(t){return Yh(t,!0,v3,S3,gA)}function Yh(t,e,r,n,s){if(!gr(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=T3(t);if(i===0)return t;const a=s.get(t);if(a)return a;const o=new Proxy(t,i===2?n:r);return s.set(t,o),o}function Fa(t){return xi(t)?Fa(t.__v_raw):!!(t&&t.__v_isReactive)}function xi(t){return!!(t&&t.__v_isReadonly)}function Ns(t){return!!(t&&t.__v_isShallow)}function Qh(t){return t?!!t.__v_raw:!1}function Xt(t){const e=t&&t.__v_raw;return e?Xt(e):t}function Jh(t){return!ur(t,"__v_skip")&&Object.isExtensible(t)&&Ug(t,"__v_skip",!0),t}const Dn=t=>gr(t)?As(t):t,j0=t=>gr(t)?nc(t):t;function Cr(t){return t?t.__v_isRef===!0:!1}function se(t){return vA(t,!1)}function v1(t){return vA(t,!0)}function vA(t,e){return Cr(t)?t:new C3(t,e)}class C3{constructor(e,r){this.dep=new Kh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:Xt(e),this._value=r?e:Dn(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,n=this.__v_isShallow||Ns(e)||xi(e);e=n?e:Xt(e),ls(e,r)&&(this._rawValue=e,this._value=n?e:Dn(e),this.dep.trigger())}}function I3(t){t.dep&&t.dep.trigger()}function q(t){return Cr(t)?t.value:t}function k3(t){return Tt(t)?t():q(t)}const D3={get:(t,e,r)=>e==="__v_raw"?t:q(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const s=t[e];return Cr(s)&&!Cr(r)?(s.value=r,!0):Reflect.set(t,e,r,n)}};function y1(t){return Fa(t)?t:new Proxy(t,D3)}class P3{constructor(e){this.__v_isRef=!0,this._value=void 0;const r=this.dep=new Kh,{get:n,set:s}=e(r.track.bind(r),r.trigger.bind(r));this._get=n,this._set=s}get value(){return this._value=this._get()}set value(e){this._set(e)}}function yA(t){return new P3(t)}function xA(t){const e=ft(t)?new Array(t.length):{};for(const r in t)e[r]=EA(t,r);return e}class R3{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return c3(Xt(this._object),this._key)}}class F3{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function N3(t,e,r){return Cr(t)?t:Tt(t)?new F3(t):gr(t)&&arguments.length>1?EA(t,e,r):se(t)}function EA(t,e,r){const n=t[e];return Cr(n)?n:new R3(t,e,r)}class O3{constructor(e,r,n){this.fn=e,this.setter=r,this._value=void 0,this.dep=new Kh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ud-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&_r!==this)return nA(this,!0),!0}get value(){const e=this.dep.track();return iA(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function M3(t,e,r=!1){let n,s;return Tt(t)?n=t:(n=t.get,s=t.set),new O3(n,s,r)}const L3={GET:"get",HAS:"has",ITERATE:"iterate"},B3={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},Pf={},G0=new WeakMap;let Hi;function U3(){return Hi}function bA(t,e=!1,r=Hi){if(r){let n=G0.get(r);n||G0.set(r,n=[]),n.push(t)}}function $3(t,e,r=Jt){const{immediate:n,deep:s,once:i,scheduler:a,augmentJob:o,call:l}=r,c=T=>s?T:Ns(T)||s===!1||s===0?ti(T,1):ti(T);let u,f,h,p,g=!1,y=!1;if(Cr(t)?(f=()=>t.value,g=Ns(t)):Fa(t)?(f=()=>c(t),g=!0):ft(t)?(y=!0,g=t.some(T=>Fa(T)||Ns(T)),f=()=>t.map(T=>{if(Cr(T))return T.value;if(Fa(T))return c(T);if(Tt(T))return l?l(T,2):T()})):Tt(t)?e?f=l?()=>l(t,2):t:f=()=>{if(h){vi();try{h()}finally{yi()}}const T=Hi;Hi=u;try{return l?l(t,3,[p]):t(p)}finally{Hi=T}}:f=js,e&&s){const T=f,D=s===!0?1/0:s;f=()=>ti(T(),D)}const _=f1(),x=()=>{u.stop(),_&&_.active&&o1(_.effects,u)};if(i&&e){const T=e;e=(...D)=>{T(...D),x()}}let b=y?new Array(t.length).fill(Pf):Pf;const v=T=>{if(!(!(u.flags&1)||!u.dirty&&!T))if(e){const D=u.run();if(s||g||(y?D.some((k,S)=>ls(k,b[S])):ls(D,b))){h&&h();const k=Hi;Hi=u;try{const S=[D,b===Pf?void 0:y&&b[0]===Pf?[]:b,p];b=D,l?l(e,3,S):e(...S)}finally{Hi=k}}}else u.run()};return o&&o(v),u=new cd(f),u.scheduler=a?()=>a(v,!1):v,p=T=>bA(T,!1,u),h=u.onStop=()=>{const T=G0.get(u);if(T){if(l)l(T,4);else for(const D of T)D();G0.delete(u)}},e?n?v(!0):b=u.run():a?a(v.bind(null,!0),!0):u.run(),x.pause=u.pause.bind(u),x.resume=u.resume.bind(u),x.stop=x,x}function ti(t,e=1/0,r){if(e<=0||!gr(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,Cr(t))ti(t.value,e,r);else if(ft(t))for(let n=0;n<t.length;n++)ti(t[n],e,r);else if(dl(t)||ec(t))t.forEach(n=>{ti(n,e,r)});else if(jh(t)){for(const n in t)ti(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&ti(t[n],e,r)}return t}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const _A=[];function V3(t){_A.push(t)}function H3(){_A.pop()}function j3(t,e){}const G3={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},W3={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function Lc(t,e,r,n){try{return n?t(...n):t()}catch(s){fl(s,e,r)}}function zs(t,e,r,n){if(Tt(t)){const s=Lc(t,e,r,n);return s&&l1(s)&&s.catch(i=>{fl(i,e,r)}),s}if(ft(t)){const s=[];for(let i=0;i<t.length;i++)s.push(zs(t[i],e,r,n));return s}}function fl(t,e,r,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||Jt;if(e){let o=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](t,l,c)===!1)return}o=o.parent}if(i){vi(),Lc(i,null,10,[t,l,c]),yi();return}}z3(t,r,s,n,a)}function z3(t,e,r,n=!0,s=!1){if(s)throw t;console.error(t)}const cs=[];let ka=-1;const sc=[];let ji=null,$l=0;const SA=Promise.resolve();let W0=null;function hl(t){const e=W0||SA;return t?e.then(this?t.bind(this):t):e}function K3(t){let e=ka+1,r=cs.length;for(;e<r;){const n=e+r>>>1,s=cs[n],i=hd(s);i<t||i===t&&s.flags&2?e=n+1:r=n}return e}function x1(t){if(!(t.flags&1)){const e=hd(t),r=cs[cs.length-1];!r||!(t.flags&2)&&e>=hd(r)?cs.push(t):cs.splice(K3(e),0,t),t.flags|=1,AA()}}function AA(){W0||(W0=SA.then(TA))}function fd(t){ft(t)?sc.push(...t):ji&&t.id===-1?ji.splice($l+1,0,t):t.flags&1||(sc.push(t),t.flags|=1),AA()}function E2(t,e,r=ka+1){for(;r<cs.length;r++){const n=cs[r];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;cs.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function z0(t){if(sc.length){const e=[...new Set(sc)].sort((r,n)=>hd(r)-hd(n));if(sc.length=0,ji){ji.push(...e);return}for(ji=e,$l=0;$l<ji.length;$l++){const r=ji[$l];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}ji=null,$l=0}}const hd=t=>t.id==null?t.flags&2?-1:1/0:t.id;function TA(t){try{for(ka=0;ka<cs.length;ka++){const e=cs[ka];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Lc(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ka<cs.length;ka++){const e=cs[ka];e&&(e.flags&=-2)}ka=-1,cs.length=0,z0(),W0=null,(cs.length||sc.length)&&TA()}}let Vl,Rf=[];function wA(t,e){var r,n;Vl=t,Vl?(Vl.enabled=!0,Rf.forEach(({event:s,args:i})=>Vl.emit(s,...i)),Rf=[]):typeof window<"u"&&window.HTMLElement&&!((n=(r=window.navigator)==null?void 0:r.userAgent)!=null&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{wA(i,e)}),setTimeout(()=>{Vl||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Rf=[])},3e3)):Rf=[]}let fn=null,Zh=null;function pd(t){const e=fn;return fn=t,Zh=t&&t.type.__scopeId||null,e}function q3(t){Zh=t}function X3(){Zh=null}const Y3=t=>ep;function ep(t,e=fn,r){if(!e||t._n)return t;const n=(...s)=>{n._d&&Yg(-1);const i=pd(e);let a;try{a=t(...s)}finally{pd(i),n._d&&Yg(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Oe(t,e){if(fn===null)return t;const r=jd(fn),n=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,a,o,l=Jt]=e[s];i&&(Tt(i)&&(i={mounted:i,updated:i}),i.deep&&ti(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:o,modifiers:l}))}return t}function Da(t,e,r,n){const s=t.dirs,i=e&&e.dirs;for(let a=0;a<s.length;a++){const o=s[a];i&&(o.oldValue=i[a].value);let l=o.dir[n];l&&(vi(),zs(l,r,8,[t.el,o,t,e]),yi())}}const CA=Symbol("_vte"),IA=t=>t.__isTeleport,Nu=t=>t&&(t.disabled||t.disabled===""),b2=t=>t&&(t.defer||t.defer===""),_2=t=>typeof SVGElement<"u"&&t instanceof SVGElement,S2=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,jg=(t,e)=>{const r=t&&t.to;return Tr(r)?e?e(r):null:r},kA={name:"Teleport",__isTeleport:!0,process(t,e,r,n,s,i,a,o,l,c){const{mc:u,pc:f,pbc:h,o:{insert:p,querySelector:g,createText:y,createComment:_}}=c,x=Nu(e.props);let{shapeFlag:b,children:v,dynamicChildren:T}=e;if(t==null){const D=e.el=y(""),k=e.anchor=y("");p(D,r,n),p(k,r,n);const S=(m,A)=>{b&16&&(s&&s.isCE&&(s.ce._teleportTarget=m),u(v,m,A,s,i,a,o,l))},E=()=>{const m=e.target=jg(e.props,g),A=DA(m,e,y,p);m&&(a!=="svg"&&_2(m)?a="svg":a!=="mathml"&&S2(m)&&(a="mathml"),x||(S(m,A),y0(e,!1)))};x&&(S(r,k),y0(e,!0)),b2(e.props)?(e.el.__isMounted=!1,cn(()=>{E(),delete e.el.__isMounted},i)):E()}else{if(b2(e.props)&&t.el.__isMounted===!1){cn(()=>{kA.process(t,e,r,n,s,i,a,o,l,c)},i);return}e.el=t.el,e.targetStart=t.targetStart;const D=e.anchor=t.anchor,k=e.target=t.target,S=e.targetAnchor=t.targetAnchor,E=Nu(t.props),m=E?r:k,A=E?D:S;if(a==="svg"||_2(k)?a="svg":(a==="mathml"||S2(k))&&(a="mathml"),T?(h(t.dynamicChildren,T,m,s,i,a,o),P1(t,e,!0)):l||f(t,e,m,A,s,i,a,o,!1),x)E?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Ff(e,r,D,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const I=e.target=jg(e.props,g);I&&Ff(e,I,null,c,0)}else E&&Ff(e,k,S,c,1);y0(e,x)}},remove(t,e,r,{um:n,o:{remove:s}},i){const{shapeFlag:a,children:o,anchor:l,targetStart:c,targetAnchor:u,target:f,props:h}=t;if(f&&(s(c),s(u)),i&&s(l),a&16){const p=i||!Nu(h);for(let g=0;g<o.length;g++){const y=o[g];n(y,e,r,p,!!y.dynamicChildren)}}},move:Ff,hydrate:Q3};function Ff(t,e,r,{o:{insert:n},m:s},i=2){i===0&&n(t.targetAnchor,e,r);const{el:a,anchor:o,shapeFlag:l,children:c,props:u}=t,f=i===2;if(f&&n(a,e,r),(!f||Nu(u))&&l&16)for(let h=0;h<c.length;h++)s(c[h],e,r,2);f&&n(o,e,r)}function Q3(t,e,r,n,s,i,{o:{nextSibling:a,parentNode:o,querySelector:l,insert:c,createText:u}},f){const h=e.target=jg(e.props,l);if(h){const p=Nu(e.props),g=h._lpa||h.firstChild;if(e.shapeFlag&16)if(p)e.anchor=f(a(t),e,o(t),r,n,s,i),e.targetStart=g,e.targetAnchor=g&&a(g);else{e.anchor=a(t);let y=g;for(;y;){if(y&&y.nodeType===8){if(y.data==="teleport start anchor")e.targetStart=y;else if(y.data==="teleport anchor"){e.targetAnchor=y,h._lpa=e.targetAnchor&&a(e.targetAnchor);break}}y=a(y)}e.targetAnchor||DA(h,e,u,c),f(g&&a(g),e,h,r,n,s,i)}y0(e,p)}return e.anchor&&a(e.anchor)}const J3=kA;function y0(t,e){const r=t.ctx;if(r&&r.ut){let n,s;for(e?(n=t.el,s=t.anchor):(n=t.targetStart,s=t.targetAnchor);n&&n!==s;)n.nodeType===1&&n.setAttribute("data-v-owner",r.uid),n=n.nextSibling;r.ut()}}function DA(t,e,r,n){const s=e.targetStart=r(""),i=e.targetAnchor=r("");return s[CA]=i,t&&(n(s,t),n(i,t)),i}const Gi=Symbol("_leaveCb"),Nf=Symbol("_enterCb");function E1(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Wt(()=>{t.isMounted=!0}),sp(()=>{t.isUnmounting=!0}),t}const Ls=[Function,Array],b1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ls,onEnter:Ls,onAfterEnter:Ls,onEnterCancelled:Ls,onBeforeLeave:Ls,onLeave:Ls,onAfterLeave:Ls,onLeaveCancelled:Ls,onBeforeAppear:Ls,onAppear:Ls,onAfterAppear:Ls,onAppearCancelled:Ls},PA=t=>{const e=t.subTree;return e.component?PA(e.component):e},Z3={name:"BaseTransition",props:b1,setup(t,{slots:e}){const r=Xs(),n=E1();return()=>{const s=e.default&&tp(e.default(),!0);if(!s||!s.length)return;const i=RA(s),a=Xt(t),{mode:o}=a;if(n.isLeaving)return rm(i);const l=A2(i);if(!l)return rm(i);let c=yc(l,a,n,r,f=>c=f);l.type!==Xr&&Ei(l,c);let u=r.subTree&&A2(r.subTree);if(u&&u.type!==Xr&&!ia(l,u)&&PA(r).type!==Xr){let f=yc(u,a,n,r);if(Ei(u,f),o==="out-in"&&l.type!==Xr)return n.isLeaving=!0,f.afterLeave=()=>{n.isLeaving=!1,r.job.flags&8||r.update(),delete f.afterLeave,u=void 0},rm(i);o==="in-out"&&l.type!==Xr?f.delayLeave=(h,p,g)=>{const y=NA(n,u);y[String(u.key)]=u,h[Gi]=()=>{p(),h[Gi]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{g(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function RA(t){let e=t[0];if(t.length>1){for(const r of t)if(r.type!==Xr){e=r;break}}return e}const FA=Z3;function NA(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function yc(t,e,r,n,s){const{appear:i,mode:a,persisted:o=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:f,onBeforeLeave:h,onLeave:p,onAfterLeave:g,onLeaveCancelled:y,onBeforeAppear:_,onAppear:x,onAfterAppear:b,onAppearCancelled:v}=e,T=String(t.key),D=NA(r,t),k=(m,A)=>{m&&zs(m,n,9,A)},S=(m,A)=>{const I=A[1];k(m,A),ft(m)?m.every(C=>C.length<=1)&&I():m.length<=1&&I()},E={mode:a,persisted:o,beforeEnter(m){let A=l;if(!r.isMounted)if(i)A=_||l;else return;m[Gi]&&m[Gi](!0);const I=D[T];I&&ia(t,I)&&I.el[Gi]&&I.el[Gi](),k(A,[m])},enter(m){let A=c,I=u,C=f;if(!r.isMounted)if(i)A=x||c,I=b||u,C=v||f;else return;let F=!1;const W=m[Nf]=P=>{F||(F=!0,P?k(C,[m]):k(I,[m]),E.delayedLeave&&E.delayedLeave(),m[Nf]=void 0)};A?S(A,[m,W]):W()},leave(m,A){const I=String(t.key);if(m[Nf]&&m[Nf](!0),r.isUnmounting)return A();k(h,[m]);let C=!1;const F=m[Gi]=W=>{C||(C=!0,A(),W?k(y,[m]):k(g,[m]),m[Gi]=void 0,D[I]===t&&delete D[I])};D[I]=t,p?S(p,[m,F]):F()},clone(m){const A=yc(m,e,r,n,s);return s&&s(A),A}};return E}function rm(t){if(Vd(t))return t=Ba(t),t.children=null,t}function A2(t){if(!Vd(t))return IA(t.type)&&t.children?RA(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:r}=t;if(r){if(e&16)return r[0];if(e&32&&Tt(r.default))return r.default()}}function Ei(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Ei(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function tp(t,e=!1,r){let n=[],s=0;for(let i=0;i<t.length;i++){let a=t[i];const o=r==null?a.key:String(r)+String(a.key!=null?a.key:i);a.type===ke?(a.patchFlag&128&&s++,n=n.concat(tp(a.children,e,o))):(e||a.type!==Xr)&&n.push(o!=null?Ba(a,{key:o}):a)}if(s>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function $d(t,e){return Tt(t)?xr({name:t.name},e,{setup:t}):t}function eP(){const t=Xs();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function _1(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function tP(t){const e=Xs(),r=v1(null);if(e){const s=e.refs===Jt?e.refs={}:e.refs;Object.defineProperty(s,t,{enumerable:!0,get:()=>r.value,set:i=>r.value=i})}return r}function ac(t,e,r,n,s=!1){if(ft(t)){t.forEach((g,y)=>ac(g,e&&(ft(e)?e[y]:e),r,n,s));return}if(to(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&ac(t,e,r,n.component.subTree);return}const i=n.shapeFlag&4?jd(n.component):n.el,a=s?null:i,{i:o,r:l}=t,c=e&&e.r,u=o.refs===Jt?o.refs={}:o.refs,f=o.setupState,h=Xt(f),p=f===Jt?()=>!1:g=>ur(h,g);if(c!=null&&c!==l&&(Tr(c)?(u[c]=null,p(c)&&(f[c]=null)):Cr(c)&&(c.value=null)),Tt(l))Lc(l,o,12,[a,u]);else{const g=Tr(l),y=Cr(l);if(g||y){const _=()=>{if(t.f){const x=g?p(l)?f[l]:u[l]:l.value;s?ft(x)&&o1(x,i):ft(x)?x.includes(i)||x.push(i):g?(u[l]=[i],p(l)&&(f[l]=u[l])):(l.value=[i],t.k&&(u[t.k]=l.value))}else g?(u[l]=a,p(l)&&(f[l]=a)):y&&(l.value=a,t.k&&(u[t.k]=a))};a?(_.id=-1,cn(_,r)):_()}}}let T2=!1;const Fl=()=>{T2||(console.error("Hydration completed but contains mismatches."),T2=!0)},rP=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",nP=t=>t.namespaceURI.includes("MathML"),Of=t=>{if(t.nodeType===1){if(rP(t))return"svg";if(nP(t))return"mathml"}},Xl=t=>t.nodeType===8;function sP(t){const{mt:e,p:r,o:{patchProp:n,createText:s,nextSibling:i,parentNode:a,remove:o,insert:l,createComment:c}}=t,u=(v,T)=>{if(!T.hasChildNodes()){r(null,v,T),z0(),T._vnode=v;return}f(T.firstChild,v,null,null,null),z0(),T._vnode=v},f=(v,T,D,k,S,E=!1)=>{E=E||!!T.dynamicChildren;const m=Xl(v)&&v.data==="[",A=()=>y(v,T,D,k,S,m),{type:I,ref:C,shapeFlag:F,patchFlag:W}=T;let P=v.nodeType;T.el=v,W===-2&&(E=!1,T.dynamicChildren=null);let R=null;switch(I){case ro:P!==3?T.children===""?(l(T.el=s(""),a(v),v),R=v):R=A():(v.data!==T.children&&(Fl(),v.data=T.children),R=i(v));break;case Xr:b(v)?(R=i(v),x(T.el=v.content.firstChild,v,D)):P!==8||m?R=A():R=i(v);break;case jo:if(m&&(v=i(v),P=v.nodeType),P===1||P===3){R=v;const N=!T.children.length;for(let L=0;L<T.staticCount;L++)N&&(T.children+=R.nodeType===1?R.outerHTML:R.data),L===T.staticCount-1&&(T.anchor=R),R=i(R);return m?i(R):R}else A();break;case ke:m?R=g(v,T,D,k,S,E):R=A();break;default:if(F&1)(P!==1||T.type.toLowerCase()!==v.tagName.toLowerCase())&&!b(v)?R=A():R=h(v,T,D,k,S,E);else if(F&6){T.slotScopeIds=S;const N=a(v);if(m?R=_(v):Xl(v)&&v.data==="teleport start"?R=_(v,v.data,"teleport end"):R=i(v),e(T,N,null,D,k,Of(N),E),to(T)&&!T.type.__asyncResolved){let L;m?(L=Re(ke),L.anchor=R?R.previousSibling:N.lastChild):L=v.nodeType===3?we(""):Re("div"),L.el=v,T.component.subTree=L}}else F&64?P!==8?R=A():R=T.type.hydrate(v,T,D,k,S,E,t,p):F&128&&(R=T.type.hydrate(v,T,D,k,Of(a(v)),S,E,t,f))}return C!=null&&ac(C,null,k,T),R},h=(v,T,D,k,S,E)=>{E=E||!!T.dynamicChildren;const{type:m,props:A,patchFlag:I,shapeFlag:C,dirs:F,transition:W}=T,P=m==="input"||m==="option";if(P||I!==-1){F&&Da(T,null,D,"created");let R=!1;if(b(v)){R=iT(null,W)&&D&&D.vnode.props&&D.vnode.props.appear;const L=v.content.firstChild;if(R){const O=L.getAttribute("class");O&&(L.$cls=O),W.beforeEnter(L)}x(L,v,D),T.el=v=L}if(C&16&&!(A&&(A.innerHTML||A.textContent))){let L=p(v.firstChild,T,v,D,k,S,E);for(;L;){Mf(v,1)||Fl();const O=L;L=L.nextSibling,o(O)}}else if(C&8){let L=T.children;L[0]===`
`&&(v.tagName==="PRE"||v.tagName==="TEXTAREA")&&(L=L.slice(1)),v.textContent!==L&&(Mf(v,0)||Fl(),v.textContent=T.children)}if(A){if(P||!E||I&48){const L=v.tagName.includes("-");for(const O in A)(P&&(O.endsWith("value")||O==="indeterminate")||Bd(O)&&!tc(O)||O[0]==="."||L)&&n(v,O,null,A[O],void 0,D)}else if(A.onClick)n(v,"onClick",null,A.onClick,void 0,D);else if(I&4&&Fa(A.style))for(const L in A.style)A.style[L]}let N;(N=A&&A.onVnodeBeforeMount)&&ys(N,D,T),F&&Da(T,null,D,"beforeMount"),((N=A&&A.onVnodeMounted)||F||R)&&mT(()=>{N&&ys(N,D,T),R&&W.enter(v),F&&Da(T,null,D,"mounted")},k)}return v.nextSibling},p=(v,T,D,k,S,E,m)=>{m=m||!!T.dynamicChildren;const A=T.children,I=A.length;for(let C=0;C<I;C++){const F=m?A[C]:A[C]=Es(A[C]),W=F.type===ro;v?(W&&!m&&C+1<I&&Es(A[C+1]).type===ro&&(l(s(v.data.slice(F.children.length)),D,i(v)),v.data=F.children),v=f(v,F,k,S,E,m)):W&&!F.children?l(F.el=s(""),D):(Mf(D,1)||Fl(),r(null,F,D,null,k,S,Of(D),E))}return v},g=(v,T,D,k,S,E)=>{const{slotScopeIds:m}=T;m&&(S=S?S.concat(m):m);const A=a(v),I=p(i(v),T,A,D,k,S,E);return I&&Xl(I)&&I.data==="]"?i(T.anchor=I):(Fl(),l(T.anchor=c("]"),A,I),I)},y=(v,T,D,k,S,E)=>{if(Mf(v.parentElement,1)||Fl(),T.el=null,E){const I=_(v);for(;;){const C=i(v);if(C&&C!==I)o(C);else break}}const m=i(v),A=a(v);return o(v),r(null,T,A,m,D,k,Of(A),S),D&&(D.vnode.el=T.el,ip(D,T.el)),m},_=(v,T="[",D="]")=>{let k=0;for(;v;)if(v=i(v),v&&Xl(v)&&(v.data===T&&k++,v.data===D)){if(k===0)return i(v);k--}return v},x=(v,T,D)=>{const k=T.parentNode;k&&k.replaceChild(v,T);let S=D;for(;S;)S.vnode.el===T&&(S.vnode.el=S.subTree.el=v),S=S.parent},b=v=>v.nodeType===1&&v.tagName==="TEMPLATE";return[u,f]}const w2="data-allow-mismatch",aP={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function Mf(t,e){if(e===0||e===1)for(;t&&!t.hasAttribute(w2);)t=t.parentElement;const r=t&&t.getAttribute(w2);if(r==null)return!1;if(r==="")return!0;{const n=r.split(",");return e===0&&n.includes("children")?!0:n.includes(aP[e])}}const iP=Wh().requestIdleCallback||(t=>setTimeout(t,1)),oP=Wh().cancelIdleCallback||(t=>clearTimeout(t)),lP=(t=1e4)=>e=>{const r=iP(e,{timeout:t});return()=>oP(r)};function cP(t){const{top:e,left:r,bottom:n,right:s}=t.getBoundingClientRect(),{innerHeight:i,innerWidth:a}=window;return(e>0&&e<i||n>0&&n<i)&&(r>0&&r<a||s>0&&s<a)}const uP=t=>(e,r)=>{const n=new IntersectionObserver(s=>{for(const i of s)if(i.isIntersecting){n.disconnect(),e();break}},t);return r(s=>{if(s instanceof Element){if(cP(s))return e(),n.disconnect(),!1;n.observe(s)}}),()=>n.disconnect()},dP=t=>e=>{if(t){const r=matchMedia(t);if(r.matches)e();else return r.addEventListener("change",e,{once:!0}),()=>r.removeEventListener("change",e)}},fP=(t=[])=>(e,r)=>{Tr(t)&&(t=[t]);let n=!1;const s=a=>{n||(n=!0,i(),e(),a.target.dispatchEvent(new a.constructor(a.type,a)))},i=()=>{r(a=>{for(const o of t)a.removeEventListener(o,s)})};return r(a=>{for(const o of t)a.addEventListener(o,s,{once:!0})}),i};function hP(t,e){if(Xl(t)&&t.data==="["){let r=1,n=t.nextSibling;for(;n;){if(n.nodeType===1){if(e(n)===!1)break}else if(Xl(n))if(n.data==="]"){if(--r===0)break}else n.data==="["&&r++;n=n.nextSibling}}else e(t)}const to=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function pP(t){Tt(t)&&(t={loader:t});const{loader:e,loadingComponent:r,errorComponent:n,delay:s=200,hydrate:i,timeout:a,suspensible:o=!0,onError:l}=t;let c=null,u,f=0;const h=()=>(f++,c=null,p()),p=()=>{let g;return c||(g=c=e().catch(y=>{if(y=y instanceof Error?y:new Error(String(y)),l)return new Promise((_,x)=>{l(y,()=>_(h()),()=>x(y),f+1)});throw y}).then(y=>g!==c&&c?c:(y&&(y.__esModule||y[Symbol.toStringTag]==="Module")&&(y=y.default),u=y,y)))};return $d({name:"AsyncComponentWrapper",__asyncLoader:p,__asyncHydrate(g,y,_){const x=i?()=>{const v=i(()=>{_()},T=>hP(g,T));v&&(y.bum||(y.bum=[])).push(v),(y.u||(y.u=[])).push(()=>!0)}:_;u?x():p().then(()=>!y.isUnmounted&&x())},get __asyncResolved(){return u},setup(){const g=dn;if(_1(g),u)return()=>nm(u,g);const y=v=>{c=null,fl(v,g,13,!n)};if(o&&g.suspense||xc)return p().then(v=>()=>nm(v,g)).catch(v=>(y(v),()=>n?Re(n,{error:v}):null));const _=se(!1),x=se(),b=se(!!s);return s&&setTimeout(()=>{b.value=!1},s),a!=null&&setTimeout(()=>{if(!_.value&&!x.value){const v=new Error(`Async component timed out after ${a}ms.`);y(v),x.value=v}},a),p().then(()=>{_.value=!0,g.parent&&Vd(g.parent.vnode)&&g.parent.update()}).catch(v=>{y(v),x.value=v}),()=>{if(_.value&&u)return nm(u,g);if(x.value&&n)return Re(n,{error:x.value});if(r&&!b.value)return Re(r)}}})}function nm(t,e){const{ref:r,props:n,children:s,ce:i}=e.vnode,a=Re(t,n,s);return a.ref=r,a.ce=i,delete e.vnode.ce,a}const Vd=t=>t.type.__isKeepAlive,mP={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const r=Xs(),n=r.ctx;if(!n.renderer)return()=>{const b=e.default&&e.default();return b&&b.length===1?b[0]:b};const s=new Map,i=new Set;let a=null;const o=r.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:f}}}=n,h=f("div");n.activate=(b,v,T,D,k)=>{const S=b.component;c(b,v,T,0,o),l(S.vnode,b,v,T,S,o,D,b.slotScopeIds,k),cn(()=>{S.isDeactivated=!1,S.a&&rc(S.a);const E=b.props&&b.props.onVnodeMounted;E&&ys(E,S.parent,b)},o)},n.deactivate=b=>{const v=b.component;q0(v.m),q0(v.a),c(b,h,null,1,o),cn(()=>{v.da&&rc(v.da);const T=b.props&&b.props.onVnodeUnmounted;T&&ys(T,v.parent,b),v.isDeactivated=!0},o)};function p(b){sm(b),u(b,r,o,!0)}function g(b){s.forEach((v,T)=>{const D=tv(v.type);D&&!b(D)&&y(T)})}function y(b){const v=s.get(b);v&&(!a||!ia(v,a))?p(v):a&&sm(a),s.delete(b),i.delete(b)}Ht(()=>[t.include,t.exclude],([b,v])=>{b&&g(T=>vu(b,T)),v&&g(T=>!vu(v,T))},{flush:"post",deep:!0});let _=null;const x=()=>{_!=null&&(X0(r.subTree.type)?cn(()=>{s.set(_,Lf(r.subTree))},r.subTree.suspense):s.set(_,Lf(r.subTree)))};return Wt(x),np(x),sp(()=>{s.forEach(b=>{const{subTree:v,suspense:T}=r,D=Lf(v);if(b.type===D.type&&b.key===D.key){sm(D);const k=D.component.da;k&&cn(k,T);return}p(b)})}),()=>{if(_=null,!e.default)return a=null;const b=e.default(),v=b[0];if(b.length>1)return a=null,b;if(!bi(v)||!(v.shapeFlag&4)&&!(v.shapeFlag&128))return a=null,v;let T=Lf(v);if(T.type===Xr)return a=null,T;const D=T.type,k=tv(to(T)?T.type.__asyncResolved||{}:D),{include:S,exclude:E,max:m}=t;if(S&&(!k||!vu(S,k))||E&&k&&vu(E,k))return T.shapeFlag&=-257,a=T,v;const A=T.key==null?D:T.key,I=s.get(A);return T.el&&(T=Ba(T),v.shapeFlag&128&&(v.ssContent=T)),_=A,I?(T.el=I.el,T.component=I.component,T.transition&&Ei(T,T.transition),T.shapeFlag|=512,i.delete(A),i.add(A)):(i.add(A),m&&i.size>parseInt(m,10)&&y(i.values().next().value)),T.shapeFlag|=256,a=T,X0(v.type)?v:T}}},gP=mP;function vu(t,e){return ft(t)?t.some(r=>vu(r,e)):Tr(t)?t.split(",").includes(e):WD(t)?(t.lastIndex=0,t.test(e)):!1}function OA(t,e){LA(t,"a",e)}function MA(t,e){LA(t,"da",e)}function LA(t,e,r=dn){const n=t.__wdc||(t.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(rp(e,n,r),r){let s=r.parent;for(;s&&s.parent;)Vd(s.parent.vnode)&&vP(n,e,r,s),s=s.parent}}function vP(t,e,r,n){const s=rp(e,t,n,!0);ja(()=>{o1(n[e],s)},r)}function sm(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Lf(t){return t.shapeFlag&128?t.ssContent:t}function rp(t,e,r=dn,n=!1){if(r){const s=r[t]||(r[t]=[]),i=e.__weh||(e.__weh=(...a)=>{vi();const o=Zo(r),l=zs(e,r,t,a);return o(),yi(),l});return n?s.unshift(i):s.push(i),i}}const Ii=t=>(e,r=dn)=>{(!xc||t==="sp")&&rp(t,(...n)=>e(...n),r)},BA=Ii("bm"),Wt=Ii("m"),S1=Ii("bu"),np=Ii("u"),sp=Ii("bum"),ja=Ii("um"),UA=Ii("sp"),$A=Ii("rtg"),VA=Ii("rtc");function HA(t,e=dn){rp("ec",t,e)}const A1="components",yP="directives";function br(t,e){return w1(A1,t,!0,e)||t}const jA=Symbol.for("v-ndc");function T1(t){return Tr(t)?w1(A1,t,!1)||t:t||jA}function xP(t){return w1(yP,t)}function w1(t,e,r=!0,n=!1){const s=fn||dn;if(s){const i=s.type;if(t===A1){const o=tv(i,!1);if(o&&(o===e||o===Rn(e)||o===Ud(Rn(e))))return i}const a=C2(s[t]||i[t],e)||C2(s.appContext[t],e);return!a&&n?i:a}}function C2(t,e){return t&&(t[e]||t[Rn(e)]||t[Ud(Rn(e))])}function He(t,e,r,n){let s;const i=r&&r[n],a=ft(t);if(a||Tr(t)){const o=a&&Fa(t);let l=!1,c=!1;o&&(l=!Ns(t),c=xi(t),t=qh(t)),s=new Array(t.length);for(let u=0,f=t.length;u<f;u++)s[u]=e(l?c?j0(Dn(t[u])):Dn(t[u]):t[u],u,void 0,i&&i[u])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(gr(t))if(t[Symbol.iterator])s=Array.from(t,(o,l)=>e(o,l,void 0,i&&i[l]));else{const o=Object.keys(t);s=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const u=o[l];s[l]=e(t[u],u,l,i&&i[l])}}else s=[];return r&&(r[n]=s),s}function EP(t,e){for(let r=0;r<e.length;r++){const n=e[r];if(ft(n))for(let s=0;s<n.length;s++)t[n[s].name]=n[s].fn;else n&&(t[n.name]=n.key?(...s)=>{const i=n.fn(...s);return i&&(i.key=n.key),i}:n.fn)}return t}function GA(t,e,r={},n,s){if(fn.ce||fn.parent&&to(fn.parent)&&fn.parent.ce)return e!=="default"&&(r.name=e),M(),Qt(ke,null,[Re("slot",r,n&&n())],64);let i=t[e];i&&i._c&&(i._d=!1),M();const a=i&&C1(i(r)),o=r.key||a&&a.key,l=Qt(ke,{key:(o&&!ga(o)?o:`_${e}`)+(!a&&n?"_fb":"")},a||(n?n():[]),a&&t._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function C1(t){return t.some(e=>bi(e)?!(e.type===Xr||e.type===ke&&!C1(e.children)):!0)?t:null}function bP(t,e){const r={};for(const n in t)r[e&&/[A-Z]/.test(n)?`on:${n}`:Pu(n)]=t[n];return r}const Gg=t=>t?_T(t)?jd(t):Gg(t.parent):null,Ou=xr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Gg(t.parent),$root:t=>Gg(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>I1(t),$forceUpdate:t=>t.f||(t.f=()=>{x1(t.update)}),$nextTick:t=>t.n||(t.n=hl.bind(t.proxy)),$watch:t=>JP.bind(t)}),am=(t,e)=>t!==Jt&&!t.__isScriptSetup&&ur(t,e),Wg={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:o,appContext:l}=t;let c;if(e[0]!=="$"){const p=a[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return s[e];case 4:return r[e];case 3:return i[e]}else{if(am(n,e))return a[e]=1,n[e];if(s!==Jt&&ur(s,e))return a[e]=2,s[e];if((c=t.propsOptions[0])&&ur(c,e))return a[e]=3,i[e];if(r!==Jt&&ur(r,e))return a[e]=4,r[e];zg&&(a[e]=0)}}const u=Ou[e];let f,h;if(u)return e==="$attrs"&&zn(t.attrs,"get",""),u(t);if((f=o.__cssModules)&&(f=f[e]))return f;if(r!==Jt&&ur(r,e))return a[e]=4,r[e];if(h=l.config.globalProperties,ur(h,e))return h[e]},set({_:t},e,r){const{data:n,setupState:s,ctx:i}=t;return am(s,e)?(s[e]=r,!0):n!==Jt&&ur(n,e)?(n[e]=r,!0):ur(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:s,propsOptions:i}},a){let o;return!!r[a]||t!==Jt&&ur(t,a)||am(e,a)||(o=i[0])&&ur(o,a)||ur(n,a)||ur(Ou,a)||ur(s.config.globalProperties,a)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:ur(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}},_P=xr({},Wg,{get(t,e){if(e!==Symbol.unscopables)return Wg.get(t,e,t)},has(t,e){return e[0]!=="_"&&!YD(e)}});function SP(){return null}function AP(){return null}function TP(t){}function wP(t){}function CP(){return null}function IP(){}function kP(t,e){return null}function DP(){return WA().slots}function PP(){return WA().attrs}function WA(){const t=Xs();return t.setupContext||(t.setupContext=TT(t))}function md(t){return ft(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}function RP(t,e){const r=md(t);for(const n in e){if(n.startsWith("__skip"))continue;let s=r[n];s?ft(s)||Tt(s)?s=r[n]={type:s,default:e[n]}:s.default=e[n]:s===null&&(s=r[n]={default:e[n]}),s&&e[`__skip_${n}`]&&(s.skipFactory=!0)}return r}function FP(t,e){return!t||!e?t||e:ft(t)&&ft(e)?t.concat(e):xr({},md(t),md(e))}function NP(t,e){const r={};for(const n in t)e.includes(n)||Object.defineProperty(r,n,{enumerable:!0,get:()=>t[n]});return r}function OP(t){const e=Xs();let r=t();return Jg(),l1(r)&&(r=r.catch(n=>{throw Zo(e),n})),[r,()=>Zo(e)]}let zg=!0;function MP(t){const e=I1(t),r=t.proxy,n=t.ctx;zg=!1,e.beforeCreate&&I2(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:f,mounted:h,beforeUpdate:p,updated:g,activated:y,deactivated:_,beforeDestroy:x,beforeUnmount:b,destroyed:v,unmounted:T,render:D,renderTracked:k,renderTriggered:S,errorCaptured:E,serverPrefetch:m,expose:A,inheritAttrs:I,components:C,directives:F,filters:W}=e;if(c&&LP(c,n,null),a)for(const N in a){const L=a[N];Tt(L)&&(n[N]=L.bind(r))}if(s){const N=s.call(r,r);gr(N)&&(t.data=As(N))}if(zg=!0,i)for(const N in i){const L=i[N],O=Tt(L)?L.bind(r,r):Tt(L.get)?L.get.bind(r,r):js,V=!Tt(L)&&Tt(L.set)?L.set.bind(r):js,z=_e({get:O,set:V});Object.defineProperty(n,N,{enumerable:!0,configurable:!0,get:()=>z.value,set:U=>z.value=U})}if(o)for(const N in o)zA(o[N],n,r,N);if(l){const N=Tt(l)?l.call(r):l;Reflect.ownKeys(N).forEach(L=>{Mu(L,N[L])})}u&&I2(u,t,"c");function R(N,L){ft(L)?L.forEach(O=>N(O.bind(r))):L&&N(L.bind(r))}if(R(BA,f),R(Wt,h),R(S1,p),R(np,g),R(OA,y),R(MA,_),R(HA,E),R(VA,k),R($A,S),R(sp,b),R(ja,T),R(UA,m),ft(A))if(A.length){const N=t.exposed||(t.exposed={});A.forEach(L=>{Object.defineProperty(N,L,{get:()=>r[L],set:O=>r[L]=O})})}else t.exposed||(t.exposed={});D&&t.render===js&&(t.render=D),I!=null&&(t.inheritAttrs=I),C&&(t.components=C),F&&(t.directives=F),m&&_1(t)}function LP(t,e,r=js){ft(t)&&(t=Kg(t));for(const n in t){const s=t[n];let i;gr(s)?"default"in s?i=Os(s.from||n,s.default,!0):i=Os(s.from||n):i=Os(s),Cr(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):e[n]=i}}function I2(t,e,r){zs(ft(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function zA(t,e,r,n){let s=n.includes(".")?dT(r,n):()=>r[n];if(Tr(t)){const i=e[t];Tt(i)&&Ht(s,i)}else if(Tt(t))Ht(s,t.bind(r));else if(gr(t))if(ft(t))t.forEach(i=>zA(i,e,r,n));else{const i=Tt(t.handler)?t.handler.bind(r):e[t.handler];Tt(i)&&Ht(s,i,t)}}function I1(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=t.appContext,o=i.get(e);let l;return o?l=o:!s.length&&!r&&!n?l=e:(l={},s.length&&s.forEach(c=>K0(l,c,a,!0)),K0(l,e,a)),gr(e)&&i.set(e,l),l}function K0(t,e,r,n=!1){const{mixins:s,extends:i}=e;i&&K0(t,i,r,!0),s&&s.forEach(a=>K0(t,a,r,!0));for(const a in e)if(!(n&&a==="expose")){const o=BP[a]||r&&r[a];t[a]=o?o(t[a],e[a]):e[a]}return t}const BP={data:k2,props:D2,emits:D2,methods:yu,computed:yu,beforeCreate:as,created:as,beforeMount:as,mounted:as,beforeUpdate:as,updated:as,beforeDestroy:as,beforeUnmount:as,destroyed:as,unmounted:as,activated:as,deactivated:as,errorCaptured:as,serverPrefetch:as,components:yu,directives:yu,watch:$P,provide:k2,inject:UP};function k2(t,e){return e?t?function(){return xr(Tt(t)?t.call(this,this):t,Tt(e)?e.call(this,this):e)}:e:t}function UP(t,e){return yu(Kg(t),Kg(e))}function Kg(t){if(ft(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function as(t,e){return t?[...new Set([].concat(t,e))]:e}function yu(t,e){return t?xr(Object.create(null),t,e):e}function D2(t,e){return t?ft(t)&&ft(e)?[...new Set([...t,...e])]:xr(Object.create(null),md(t),md(e??{})):e}function $P(t,e){if(!t)return e;if(!e)return t;const r=xr(Object.create(null),t);for(const n in e)r[n]=as(t[n],e[n]);return r}function KA(){return{app:null,config:{isNativeTag:jD,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let VP=0;function HP(t,e){return function(n,s=null){Tt(n)||(n=xr({},n)),s!=null&&!gr(s)&&(s=null);const i=KA(),a=new WeakSet,o=[];let l=!1;const c=i.app={_uid:VP++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:CT,get config(){return i.config},set config(u){},use(u,...f){return a.has(u)||(u&&Tt(u.install)?(a.add(u),u.install(c,...f)):Tt(u)&&(a.add(u),u(c,...f))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,f){return f?(i.components[u]=f,c):i.components[u]},directive(u,f){return f?(i.directives[u]=f,c):i.directives[u]},mount(u,f,h){if(!l){const p=c._ceVNode||Re(n,s);return p.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),f&&e?e(p,u):t(p,u,h),l=!0,c._container=u,u.__vue_app__=c,jd(p.component)}},onUnmount(u){o.push(u)},unmount(){l&&(zs(o,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,f){return i.provides[u]=f,c},runWithContext(u){const f=Ho;Ho=c;try{return u()}finally{Ho=f}}};return c}}let Ho=null;function Mu(t,e){if(dn){let r=dn.provides;const n=dn.parent&&dn.parent.provides;n===r&&(r=dn.provides=Object.create(n)),r[t]=e}}function Os(t,e,r=!1){const n=dn||fn;if(n||Ho){let s=Ho?Ho._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return r&&Tt(e)?e.call(n&&n.proxy):e}}function qA(){return!!(dn||fn||Ho)}const XA={},YA=()=>Object.create(XA),QA=t=>Object.getPrototypeOf(t)===XA;function jP(t,e,r,n=!1){const s={},i=YA();t.propsDefaults=Object.create(null),JA(t,e,s,i);for(const a in t.propsOptions[0])a in s||(s[a]=void 0);r?t.props=n?s:g1(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function GP(t,e,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=t,o=Xt(s),[l]=t.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=t.vnode.dynamicProps;for(let f=0;f<u.length;f++){let h=u[f];if(ap(t.emitsOptions,h))continue;const p=e[h];if(l)if(ur(i,h))p!==i[h]&&(i[h]=p,c=!0);else{const g=Rn(h);s[g]=qg(l,o,g,p,t,!1)}else p!==i[h]&&(i[h]=p,c=!0)}}}else{JA(t,e,s,i)&&(c=!0);let u;for(const f in o)(!e||!ur(e,f)&&((u=bs(f))===f||!ur(e,u)))&&(l?r&&(r[f]!==void 0||r[u]!==void 0)&&(s[f]=qg(l,o,f,void 0,t,!0)):delete s[f]);if(i!==o)for(const f in i)(!e||!ur(e,f))&&(delete i[f],c=!0)}c&&ei(t.attrs,"set","")}function JA(t,e,r,n){const[s,i]=t.propsOptions;let a=!1,o;if(e)for(let l in e){if(tc(l))continue;const c=e[l];let u;s&&ur(s,u=Rn(l))?!i||!i.includes(u)?r[u]=c:(o||(o={}))[u]=c:ap(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(i){const l=Xt(r),c=o||Jt;for(let u=0;u<i.length;u++){const f=i[u];r[f]=qg(s,l,f,c[f],t,!ur(c,f))}}return a}function qg(t,e,r,n,s,i){const a=t[r];if(a!=null){const o=ur(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&Tt(l)){const{propsDefaults:c}=s;if(r in c)n=c[r];else{const u=Zo(s);n=c[r]=l.call(null,e),u()}}else n=l;s.ce&&s.ce._setProp(r,n)}a[0]&&(i&&!o?n=!1:a[1]&&(n===""||n===bs(r))&&(n=!0))}return n}const WP=new WeakMap;function ZA(t,e,r=!1){const n=r?WP:e.propsCache,s=n.get(t);if(s)return s;const i=t.props,a={},o=[];let l=!1;if(!Tt(t)){const u=f=>{l=!0;const[h,p]=ZA(f,e,!0);xr(a,h),p&&o.push(...p)};!r&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!l)return gr(t)&&n.set(t,Zl),Zl;if(ft(i))for(let u=0;u<i.length;u++){const f=Rn(i[u]);P2(f)&&(a[f]=Jt)}else if(i)for(const u in i){const f=Rn(u);if(P2(f)){const h=i[u],p=a[f]=ft(h)||Tt(h)?{type:h}:xr({},h),g=p.type;let y=!1,_=!0;if(ft(g))for(let x=0;x<g.length;++x){const b=g[x],v=Tt(b)&&b.name;if(v==="Boolean"){y=!0;break}else v==="String"&&(_=!1)}else y=Tt(g)&&g.name==="Boolean";p[0]=y,p[1]=_,(y||ur(p,"default"))&&o.push(f)}}const c=[a,o];return gr(t)&&n.set(t,c),c}function P2(t){return t[0]!=="$"&&!tc(t)}const k1=t=>t[0]==="_"||t==="$stable",D1=t=>ft(t)?t.map(Es):[Es(t)],zP=(t,e,r)=>{if(e._n)return e;const n=ep((...s)=>D1(e(...s)),r);return n._c=!1,n},eT=(t,e,r)=>{const n=t._ctx;for(const s in t){if(k1(s))continue;const i=t[s];if(Tt(i))e[s]=zP(s,i,n);else if(i!=null){const a=D1(i);e[s]=()=>a}}},tT=(t,e)=>{const r=D1(e);t.slots.default=()=>r},rT=(t,e,r)=>{for(const n in e)(r||!k1(n))&&(t[n]=e[n])},KP=(t,e,r)=>{const n=t.slots=YA();if(t.vnode.shapeFlag&32){const s=e.__;s&&Ug(n,"__",s,!0);const i=e._;i?(rT(n,e,r),r&&Ug(n,"_",i,!0)):eT(e,n)}else e&&tT(t,e)},qP=(t,e,r)=>{const{vnode:n,slots:s}=t;let i=!0,a=Jt;if(n.shapeFlag&32){const o=e._;o?r&&o===1?i=!1:rT(s,e,r):(i=!e.$stable,eT(e,s)),a=e}else e&&(tT(t,e),a={default:1});if(i)for(const o in s)!k1(o)&&a[o]==null&&delete s[o]},cn=mT;function nT(t){return aT(t)}function sT(t){return aT(t,sP)}function aT(t,e){const r=Wh();r.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:h,setScopeId:p=js,insertStaticContent:g}=t,y=(K,Y,fe,ye=null,ie=null,ue=null,Ee=void 0,Ce=null,Pe=!!Y.dynamicChildren)=>{if(K===Y)return;K&&!ia(K,Y)&&(ye=ne(K),U(K,ie,ue,!0),K=null),Y.patchFlag===-2&&(Pe=!1,Y.dynamicChildren=null);const{type:Te,ref:ze,shapeFlag:Ie}=Y;switch(Te){case ro:_(K,Y,fe,ye);break;case Xr:x(K,Y,fe,ye);break;case jo:K==null&&b(Y,fe,ye,Ee);break;case ke:C(K,Y,fe,ye,ie,ue,Ee,Ce,Pe);break;default:Ie&1?D(K,Y,fe,ye,ie,ue,Ee,Ce,Pe):Ie&6?F(K,Y,fe,ye,ie,ue,Ee,Ce,Pe):(Ie&64||Ie&128)&&Te.process(K,Y,fe,ye,ie,ue,Ee,Ce,Pe,J)}ze!=null&&ie?ac(ze,K&&K.ref,ue,Y||K,!Y):ze==null&&K&&K.ref!=null&&ac(K.ref,null,ue,K,!0)},_=(K,Y,fe,ye)=>{if(K==null)n(Y.el=o(Y.children),fe,ye);else{const ie=Y.el=K.el;Y.children!==K.children&&c(ie,Y.children)}},x=(K,Y,fe,ye)=>{K==null?n(Y.el=l(Y.children||""),fe,ye):Y.el=K.el},b=(K,Y,fe,ye)=>{[K.el,K.anchor]=g(K.children,Y,fe,ye,K.el,K.anchor)},v=({el:K,anchor:Y},fe,ye)=>{let ie;for(;K&&K!==Y;)ie=h(K),n(K,fe,ye),K=ie;n(Y,fe,ye)},T=({el:K,anchor:Y})=>{let fe;for(;K&&K!==Y;)fe=h(K),s(K),K=fe;s(Y)},D=(K,Y,fe,ye,ie,ue,Ee,Ce,Pe)=>{Y.type==="svg"?Ee="svg":Y.type==="math"&&(Ee="mathml"),K==null?k(Y,fe,ye,ie,ue,Ee,Ce,Pe):m(K,Y,ie,ue,Ee,Ce,Pe)},k=(K,Y,fe,ye,ie,ue,Ee,Ce)=>{let Pe,Te;const{props:ze,shapeFlag:Ie,transition:be,dirs:Me}=K;if(Pe=K.el=a(K.type,ue,ze&&ze.is,ze),Ie&8?u(Pe,K.children):Ie&16&&E(K.children,Pe,null,ye,ie,im(K,ue),Ee,Ce),Me&&Da(K,null,ye,"created"),S(Pe,K,K.scopeId,Ee,ye),ze){for(const qe in ze)qe!=="value"&&!tc(qe)&&i(Pe,qe,null,ze[qe],ue,ye);"value"in ze&&i(Pe,"value",null,ze.value,ue),(Te=ze.onVnodeBeforeMount)&&ys(Te,ye,K)}Me&&Da(K,null,ye,"beforeMount");const Ke=iT(ie,be);Ke&&be.beforeEnter(Pe),n(Pe,Y,fe),((Te=ze&&ze.onVnodeMounted)||Ke||Me)&&cn(()=>{Te&&ys(Te,ye,K),Ke&&be.enter(Pe),Me&&Da(K,null,ye,"mounted")},ie)},S=(K,Y,fe,ye,ie)=>{if(fe&&p(K,fe),ye)for(let ue=0;ue<ye.length;ue++)p(K,ye[ue]);if(ie){let ue=ie.subTree;if(Y===ue||X0(ue.type)&&(ue.ssContent===Y||ue.ssFallback===Y)){const Ee=ie.vnode;S(K,Ee,Ee.scopeId,Ee.slotScopeIds,ie.parent)}}},E=(K,Y,fe,ye,ie,ue,Ee,Ce,Pe=0)=>{for(let Te=Pe;Te<K.length;Te++){const ze=K[Te]=Ce?Wi(K[Te]):Es(K[Te]);y(null,ze,Y,fe,ye,ie,ue,Ee,Ce)}},m=(K,Y,fe,ye,ie,ue,Ee)=>{const Ce=Y.el=K.el;let{patchFlag:Pe,dynamicChildren:Te,dirs:ze}=Y;Pe|=K.patchFlag&16;const Ie=K.props||Jt,be=Y.props||Jt;let Me;if(fe&&Io(fe,!1),(Me=be.onVnodeBeforeUpdate)&&ys(Me,fe,Y,K),ze&&Da(Y,K,fe,"beforeUpdate"),fe&&Io(fe,!0),(Ie.innerHTML&&be.innerHTML==null||Ie.textContent&&be.textContent==null)&&u(Ce,""),Te?A(K.dynamicChildren,Te,Ce,fe,ye,im(Y,ie),ue):Ee||L(K,Y,Ce,null,fe,ye,im(Y,ie),ue,!1),Pe>0){if(Pe&16)I(Ce,Ie,be,fe,ie);else if(Pe&2&&Ie.class!==be.class&&i(Ce,"class",null,be.class,ie),Pe&4&&i(Ce,"style",Ie.style,be.style,ie),Pe&8){const Ke=Y.dynamicProps;for(let qe=0;qe<Ke.length;qe++){const Se=Ke[qe],xe=Ie[Se],Ae=be[Se];(Ae!==xe||Se==="value")&&i(Ce,Se,xe,Ae,ie,fe)}}Pe&1&&K.children!==Y.children&&u(Ce,Y.children)}else!Ee&&Te==null&&I(Ce,Ie,be,fe,ie);((Me=be.onVnodeUpdated)||ze)&&cn(()=>{Me&&ys(Me,fe,Y,K),ze&&Da(Y,K,fe,"updated")},ye)},A=(K,Y,fe,ye,ie,ue,Ee)=>{for(let Ce=0;Ce<Y.length;Ce++){const Pe=K[Ce],Te=Y[Ce],ze=Pe.el&&(Pe.type===ke||!ia(Pe,Te)||Pe.shapeFlag&198)?f(Pe.el):fe;y(Pe,Te,ze,null,ye,ie,ue,Ee,!0)}},I=(K,Y,fe,ye,ie)=>{if(Y!==fe){if(Y!==Jt)for(const ue in Y)!tc(ue)&&!(ue in fe)&&i(K,ue,Y[ue],null,ie,ye);for(const ue in fe){if(tc(ue))continue;const Ee=fe[ue],Ce=Y[ue];Ee!==Ce&&ue!=="value"&&i(K,ue,Ce,Ee,ie,ye)}"value"in fe&&i(K,"value",Y.value,fe.value,ie)}},C=(K,Y,fe,ye,ie,ue,Ee,Ce,Pe)=>{const Te=Y.el=K?K.el:o(""),ze=Y.anchor=K?K.anchor:o("");let{patchFlag:Ie,dynamicChildren:be,slotScopeIds:Me}=Y;Me&&(Ce=Ce?Ce.concat(Me):Me),K==null?(n(Te,fe,ye),n(ze,fe,ye),E(Y.children||[],fe,ze,ie,ue,Ee,Ce,Pe)):Ie>0&&Ie&64&&be&&K.dynamicChildren?(A(K.dynamicChildren,be,fe,ie,ue,Ee,Ce),(Y.key!=null||ie&&Y===ie.subTree)&&P1(K,Y,!0)):L(K,Y,fe,ze,ie,ue,Ee,Ce,Pe)},F=(K,Y,fe,ye,ie,ue,Ee,Ce,Pe)=>{Y.slotScopeIds=Ce,K==null?Y.shapeFlag&512?ie.ctx.activate(Y,fe,ye,Ee,Pe):W(Y,fe,ye,ie,ue,Ee,Pe):P(K,Y,Pe)},W=(K,Y,fe,ye,ie,ue,Ee)=>{const Ce=K.component=bT(K,ye,ie);if(Vd(K)&&(Ce.ctx.renderer=J),ST(Ce,!1,Ee),Ce.asyncDep){if(ie&&ie.registerDep(Ce,R,Ee),!K.el){const Pe=Ce.subTree=Re(Xr);x(null,Pe,Y,fe)}}else R(Ce,K,Y,fe,ie,ue,Ee)},P=(K,Y,fe)=>{const ye=Y.component=K.component;if(sR(K,Y,fe))if(ye.asyncDep&&!ye.asyncResolved){N(ye,Y,fe);return}else ye.next=Y,ye.update();else Y.el=K.el,ye.vnode=Y},R=(K,Y,fe,ye,ie,ue,Ee)=>{const Ce=()=>{if(K.isMounted){let{next:Ie,bu:be,u:Me,parent:Ke,vnode:qe}=K;{const We=oT(K);if(We){Ie&&(Ie.el=qe.el,N(K,Ie,Ee)),We.asyncDep.then(()=>{K.isUnmounted||Ce()});return}}let Se=Ie,xe;Io(K,!1),Ie?(Ie.el=qe.el,N(K,Ie,Ee)):Ie=qe,be&&rc(be),(xe=Ie.props&&Ie.props.onVnodeBeforeUpdate)&&ys(xe,Ke,Ie,qe),Io(K,!0);const Ae=x0(K),Le=K.subTree;K.subTree=Ae,y(Le,Ae,f(Le.el),ne(Le),K,ie,ue),Ie.el=Ae.el,Se===null&&ip(K,Ae.el),Me&&cn(Me,ie),(xe=Ie.props&&Ie.props.onVnodeUpdated)&&cn(()=>ys(xe,Ke,Ie,qe),ie)}else{let Ie;const{el:be,props:Me}=Y,{bm:Ke,m:qe,parent:Se,root:xe,type:Ae}=K,Le=to(Y);if(Io(K,!1),Ke&&rc(Ke),!Le&&(Ie=Me&&Me.onVnodeBeforeMount)&&ys(Ie,Se,Y),Io(K,!0),be&&te){const We=()=>{K.subTree=x0(K),te(be,K.subTree,K,ie,null)};Le&&Ae.__asyncHydrate?Ae.__asyncHydrate(be,K,We):We()}else{xe.ce&&xe.ce._def.shadowRoot!==!1&&xe.ce._injectChildStyle(Ae);const We=K.subTree=x0(K);y(null,We,fe,ye,K,ie,ue),Y.el=We.el}if(qe&&cn(qe,ie),!Le&&(Ie=Me&&Me.onVnodeMounted)){const We=Y;cn(()=>ys(Ie,Se,We),ie)}(Y.shapeFlag&256||Se&&to(Se.vnode)&&Se.vnode.shapeFlag&256)&&K.a&&cn(K.a,ie),K.isMounted=!0,Y=fe=ye=null}};K.scope.on();const Pe=K.effect=new cd(Ce);K.scope.off();const Te=K.update=Pe.run.bind(Pe),ze=K.job=Pe.runIfDirty.bind(Pe);ze.i=K,ze.id=K.uid,Pe.scheduler=()=>x1(ze),Io(K,!0),Te()},N=(K,Y,fe)=>{Y.component=K;const ye=K.vnode.props;K.vnode=Y,K.next=null,GP(K,Y.props,ye,fe),qP(K,Y.children,fe),vi(),E2(K),yi()},L=(K,Y,fe,ye,ie,ue,Ee,Ce,Pe=!1)=>{const Te=K&&K.children,ze=K?K.shapeFlag:0,Ie=Y.children,{patchFlag:be,shapeFlag:Me}=Y;if(be>0){if(be&128){V(Te,Ie,fe,ye,ie,ue,Ee,Ce,Pe);return}else if(be&256){O(Te,Ie,fe,ye,ie,ue,Ee,Ce,Pe);return}}Me&8?(ze&16&&ae(Te,ie,ue),Ie!==Te&&u(fe,Ie)):ze&16?Me&16?V(Te,Ie,fe,ye,ie,ue,Ee,Ce,Pe):ae(Te,ie,ue,!0):(ze&8&&u(fe,""),Me&16&&E(Ie,fe,ye,ie,ue,Ee,Ce,Pe))},O=(K,Y,fe,ye,ie,ue,Ee,Ce,Pe)=>{K=K||Zl,Y=Y||Zl;const Te=K.length,ze=Y.length,Ie=Math.min(Te,ze);let be;for(be=0;be<Ie;be++){const Me=Y[be]=Pe?Wi(Y[be]):Es(Y[be]);y(K[be],Me,fe,null,ie,ue,Ee,Ce,Pe)}Te>ze?ae(K,ie,ue,!0,!1,Ie):E(Y,fe,ye,ie,ue,Ee,Ce,Pe,Ie)},V=(K,Y,fe,ye,ie,ue,Ee,Ce,Pe)=>{let Te=0;const ze=Y.length;let Ie=K.length-1,be=ze-1;for(;Te<=Ie&&Te<=be;){const Me=K[Te],Ke=Y[Te]=Pe?Wi(Y[Te]):Es(Y[Te]);if(ia(Me,Ke))y(Me,Ke,fe,null,ie,ue,Ee,Ce,Pe);else break;Te++}for(;Te<=Ie&&Te<=be;){const Me=K[Ie],Ke=Y[be]=Pe?Wi(Y[be]):Es(Y[be]);if(ia(Me,Ke))y(Me,Ke,fe,null,ie,ue,Ee,Ce,Pe);else break;Ie--,be--}if(Te>Ie){if(Te<=be){const Me=be+1,Ke=Me<ze?Y[Me].el:ye;for(;Te<=be;)y(null,Y[Te]=Pe?Wi(Y[Te]):Es(Y[Te]),fe,Ke,ie,ue,Ee,Ce,Pe),Te++}}else if(Te>be)for(;Te<=Ie;)U(K[Te],ie,ue,!0),Te++;else{const Me=Te,Ke=Te,qe=new Map;for(Te=Ke;Te<=be;Te++){const xt=Y[Te]=Pe?Wi(Y[Te]):Es(Y[Te]);xt.key!=null&&qe.set(xt.key,Te)}let Se,xe=0;const Ae=be-Ke+1;let Le=!1,We=0;const $e=new Array(Ae);for(Te=0;Te<Ae;Te++)$e[Te]=0;for(Te=Me;Te<=Ie;Te++){const xt=K[Te];if(xe>=Ae){U(xt,ie,ue,!0);continue}let Vt;if(xt.key!=null)Vt=qe.get(xt.key);else for(Se=Ke;Se<=be;Se++)if($e[Se-Ke]===0&&ia(xt,Y[Se])){Vt=Se;break}Vt===void 0?U(xt,ie,ue,!0):($e[Vt-Ke]=Te+1,Vt>=We?We=Vt:Le=!0,y(xt,Y[Vt],fe,null,ie,ue,Ee,Ce,Pe),xe++)}const dt=Le?XP($e):Zl;for(Se=dt.length-1,Te=Ae-1;Te>=0;Te--){const xt=Ke+Te,Vt=Y[xt],pt=xt+1<ze?Y[xt+1].el:ye;$e[Te]===0?y(null,Vt,fe,pt,ie,ue,Ee,Ce,Pe):Le&&(Se<0||Te!==dt[Se]?z(Vt,fe,pt,2):Se--)}}},z=(K,Y,fe,ye,ie=null)=>{const{el:ue,type:Ee,transition:Ce,children:Pe,shapeFlag:Te}=K;if(Te&6){z(K.component.subTree,Y,fe,ye);return}if(Te&128){K.suspense.move(Y,fe,ye);return}if(Te&64){Ee.move(K,Y,fe,J);return}if(Ee===ke){n(ue,Y,fe);for(let Ie=0;Ie<Pe.length;Ie++)z(Pe[Ie],Y,fe,ye);n(K.anchor,Y,fe);return}if(Ee===jo){v(K,Y,fe);return}if(ye!==2&&Te&1&&Ce)if(ye===0)Ce.beforeEnter(ue),n(ue,Y,fe),cn(()=>Ce.enter(ue),ie);else{const{leave:Ie,delayLeave:be,afterLeave:Me}=Ce,Ke=()=>{K.ctx.isUnmounted?s(ue):n(ue,Y,fe)},qe=()=>{Ie(ue,()=>{Ke(),Me&&Me()})};be?be(ue,Ke,qe):qe()}else n(ue,Y,fe)},U=(K,Y,fe,ye=!1,ie=!1)=>{const{type:ue,props:Ee,ref:Ce,children:Pe,dynamicChildren:Te,shapeFlag:ze,patchFlag:Ie,dirs:be,cacheIndex:Me}=K;if(Ie===-2&&(ie=!1),Ce!=null&&(vi(),ac(Ce,null,fe,K,!0),yi()),Me!=null&&(Y.renderCache[Me]=void 0),ze&256){Y.ctx.deactivate(K);return}const Ke=ze&1&&be,qe=!to(K);let Se;if(qe&&(Se=Ee&&Ee.onVnodeBeforeUnmount)&&ys(Se,Y,K),ze&6)ee(K.component,fe,ye);else{if(ze&128){K.suspense.unmount(fe,ye);return}Ke&&Da(K,null,Y,"beforeUnmount"),ze&64?K.type.remove(K,Y,fe,J,ye):Te&&!Te.hasOnce&&(ue!==ke||Ie>0&&Ie&64)?ae(Te,Y,fe,!1,!0):(ue===ke&&Ie&384||!ie&&ze&16)&&ae(Pe,Y,fe),ye&&G(K)}(qe&&(Se=Ee&&Ee.onVnodeUnmounted)||Ke)&&cn(()=>{Se&&ys(Se,Y,K),Ke&&Da(K,null,Y,"unmounted")},fe)},G=K=>{const{type:Y,el:fe,anchor:ye,transition:ie}=K;if(Y===ke){j(fe,ye);return}if(Y===jo){T(K);return}const ue=()=>{s(fe),ie&&!ie.persisted&&ie.afterLeave&&ie.afterLeave()};if(K.shapeFlag&1&&ie&&!ie.persisted){const{leave:Ee,delayLeave:Ce}=ie,Pe=()=>Ee(fe,ue);Ce?Ce(K.el,ue,Pe):Pe()}else ue()},j=(K,Y)=>{let fe;for(;K!==Y;)fe=h(K),s(K),K=fe;s(Y)},ee=(K,Y,fe)=>{const{bum:ye,scope:ie,job:ue,subTree:Ee,um:Ce,m:Pe,a:Te,parent:ze,slots:{__:Ie}}=K;q0(Pe),q0(Te),ye&&rc(ye),ze&&ft(Ie)&&Ie.forEach(be=>{ze.renderCache[be]=void 0}),ie.stop(),ue&&(ue.flags|=8,U(Ee,K,Y,fe)),Ce&&cn(Ce,Y),cn(()=>{K.isUnmounted=!0},Y),Y&&Y.pendingBranch&&!Y.isUnmounted&&K.asyncDep&&!K.asyncResolved&&K.suspenseId===Y.pendingId&&(Y.deps--,Y.deps===0&&Y.resolve())},ae=(K,Y,fe,ye=!1,ie=!1,ue=0)=>{for(let Ee=ue;Ee<K.length;Ee++)U(K[Ee],Y,fe,ye,ie)},ne=K=>{if(K.shapeFlag&6)return ne(K.component.subTree);if(K.shapeFlag&128)return K.suspense.next();const Y=h(K.anchor||K.el),fe=Y&&Y[CA];return fe?h(fe):Y};let le=!1;const Z=(K,Y,fe)=>{K==null?Y._vnode&&U(Y._vnode,null,null,!0):y(Y._vnode||null,K,Y,null,null,null,fe),Y._vnode=K,le||(le=!0,E2(),z0(),le=!1)},J={p:y,um:U,m:z,r:G,mt:W,mc:E,pc:L,pbc:A,n:ne,o:t};let ge,te;return e&&([ge,te]=e(J)),{render:Z,hydrate:ge,createApp:HP(Z,ge)}}function im({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function Io({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function iT(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function P1(t,e,r=!1){const n=t.children,s=e.children;if(ft(n)&&ft(s))for(let i=0;i<n.length;i++){const a=n[i];let o=s[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[i]=Wi(s[i]),o.el=a.el),!r&&o.patchFlag!==-2&&P1(a,o)),o.type===ro&&(o.el=a.el),o.type===Xr&&!o.el&&(o.el=a.el)}}function XP(t){const e=t.slice(),r=[0];let n,s,i,a,o;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(s=r[r.length-1],t[s]<c){e[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)o=i+a>>1,t[r[o]]<c?i=o+1:a=o;c<t[r[i]]&&(i>0&&(e[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=e[a];return r}function oT(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:oT(e)}function q0(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const lT=Symbol.for("v-scx"),cT=()=>Os(lT);function YP(t,e){return Hd(t,null,e)}function QP(t,e){return Hd(t,null,{flush:"post"})}function uT(t,e){return Hd(t,null,{flush:"sync"})}function Ht(t,e,r){return Hd(t,e,r)}function Hd(t,e,r=Jt){const{immediate:n,deep:s,flush:i,once:a}=r,o=xr({},r),l=e&&n||!e&&i!=="post";let c;if(xc){if(i==="sync"){const p=cT();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=js,p.resume=js,p.pause=js,p}}const u=dn;o.call=(p,g,y)=>zs(p,u,g,y);let f=!1;i==="post"?o.scheduler=p=>{cn(p,u&&u.suspense)}:i!=="sync"&&(f=!0,o.scheduler=(p,g)=>{g?p():x1(p)}),o.augmentJob=p=>{e&&(p.flags|=4),f&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const h=$3(t,e,o);return xc&&(c?c.push(h):l&&h()),h}function JP(t,e,r){const n=this.proxy,s=Tr(t)?t.includes(".")?dT(n,t):()=>n[t]:t.bind(n,n);let i;Tt(e)?i=e:(i=e.handler,r=e);const a=Zo(this),o=Hd(s,i.bind(n),r);return a(),o}function dT(t,e){const r=e.split(".");return()=>{let n=t;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}function ZP(t,e,r=Jt){const n=Xs(),s=Rn(e),i=bs(e),a=fT(t,s),o=yA((l,c)=>{let u,f=Jt,h;return uT(()=>{const p=t[s];ls(u,p)&&(u=p,c())}),{get(){return l(),r.get?r.get(u):u},set(p){const g=r.set?r.set(p):p;if(!ls(g,u)&&!(f!==Jt&&ls(p,f)))return;const y=n.vnode.props;y&&(e in y||s in y||i in y)&&(`onUpdate:${e}`in y||`onUpdate:${s}`in y||`onUpdate:${i}`in y)||(u=p,c()),n.emit(`update:${e}`,g),ls(p,g)&&ls(p,f)&&!ls(g,h)&&c(),f=p,h=g}}});return o[Symbol.iterator]=()=>{let l=0;return{next(){return l<2?{value:l++?a||Jt:o,done:!1}:{done:!0}}}},o}const fT=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Rn(e)}Modifiers`]||t[`${bs(e)}Modifiers`];function eR(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||Jt;let s=r;const i=e.startsWith("update:"),a=i&&fT(n,e.slice(7));a&&(a.trim&&(s=r.map(u=>Tr(u)?u.trim():u)),a.number&&(s=r.map($0)));let o,l=n[o=Pu(e)]||n[o=Pu(Rn(e))];!l&&i&&(l=n[o=Pu(bs(e))]),l&&zs(l,t,6,s);const c=n[o+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,zs(c,t,6,s)}}function hT(t,e,r=!1){const n=e.emitsCache,s=n.get(t);if(s!==void 0)return s;const i=t.emits;let a={},o=!1;if(!Tt(t)){const l=c=>{const u=hT(c,e,!0);u&&(o=!0,xr(a,u))};!r&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!o?(gr(t)&&n.set(t,null),null):(ft(i)?i.forEach(l=>a[l]=null):xr(a,i),gr(t)&&n.set(t,a),a)}function ap(t,e){return!t||!Bd(e)?!1:(e=e.slice(2).replace(/Once$/,""),ur(t,e[0].toLowerCase()+e.slice(1))||ur(t,bs(e))||ur(t,e))}function x0(t){const{type:e,vnode:r,proxy:n,withProxy:s,propsOptions:[i],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:f,data:h,setupState:p,ctx:g,inheritAttrs:y}=t,_=pd(t);let x,b;try{if(r.shapeFlag&4){const T=s||n,D=T;x=Es(c.call(D,T,u,f,p,h,g)),b=o}else{const T=e;x=Es(T.length>1?T(f,{attrs:o,slots:a,emit:l}):T(f,null)),b=e.props?o:rR(o)}}catch(T){Lu.length=0,fl(T,t,1),x=Re(Xr)}let v=x;if(b&&y!==!1){const T=Object.keys(b),{shapeFlag:D}=v;T.length&&D&7&&(i&&T.some(i1)&&(b=nR(b,i)),v=Ba(v,b,!1,!0))}return r.dirs&&(v=Ba(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(r.dirs):r.dirs),r.transition&&Ei(v,r.transition),x=v,pd(_),x}function tR(t,e=!0){let r;for(let n=0;n<t.length;n++){const s=t[n];if(bi(s)){if(s.type!==Xr||s.children==="v-if"){if(r)return;r=s}}else return}return r}const rR=t=>{let e;for(const r in t)(r==="class"||r==="style"||Bd(r))&&((e||(e={}))[r]=t[r]);return e},nR=(t,e)=>{const r={};for(const n in t)(!i1(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function sR(t,e,r){const{props:n,children:s,component:i}=t,{props:a,children:o,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?R2(n,a,c):!!a;if(l&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const h=u[f];if(a[h]!==n[h]&&!ap(c,h))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?R2(n,a,c):!0:!!a;return!1}function R2(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==t[i]&&!ap(r,i))return!0}return!1}function ip({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const X0=t=>t.__isSuspense;let Xg=0;const aR={name:"Suspense",__isSuspense:!0,process(t,e,r,n,s,i,a,o,l,c){if(t==null)oR(e,r,n,s,i,a,o,l,c);else{if(i&&i.deps>0&&!t.suspense.isInFallback){e.suspense=t.suspense,e.suspense.vnode=e,e.el=t.el;return}lR(t,e,r,n,s,a,o,l,c)}},hydrate:cR,normalize:uR},iR=aR;function gd(t,e){const r=t.props&&t.props[e];Tt(r)&&r()}function oR(t,e,r,n,s,i,a,o,l){const{p:c,o:{createElement:u}}=l,f=u("div"),h=t.suspense=pT(t,s,n,e,f,r,i,a,o,l);c(null,h.pendingBranch=t.ssContent,f,null,n,h,i,a),h.deps>0?(gd(t,"onPending"),gd(t,"onFallback"),c(null,t.ssFallback,e,r,n,null,i,a),ic(h,t.ssFallback)):h.resolve(!1,!0)}function lR(t,e,r,n,s,i,a,o,{p:l,um:c,o:{createElement:u}}){const f=e.suspense=t.suspense;f.vnode=e,e.el=t.el;const h=e.ssContent,p=e.ssFallback,{activeBranch:g,pendingBranch:y,isInFallback:_,isHydrating:x}=f;if(y)f.pendingBranch=h,ia(h,y)?(l(y,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():_&&(x||(l(g,p,r,n,s,null,i,a,o),ic(f,p)))):(f.pendingId=Xg++,x?(f.isHydrating=!1,f.activeBranch=y):c(y,s,f),f.deps=0,f.effects.length=0,f.hiddenContainer=u("div"),_?(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():(l(g,p,r,n,s,null,i,a,o),ic(f,p))):g&&ia(h,g)?(l(g,h,r,n,s,f,i,a,o),f.resolve(!0)):(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0&&f.resolve()));else if(g&&ia(h,g))l(g,h,r,n,s,f,i,a,o),ic(f,h);else if(gd(e,"onPending"),f.pendingBranch=h,h.shapeFlag&512?f.pendingId=h.component.suspenseId:f.pendingId=Xg++,l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0)f.resolve();else{const{timeout:b,pendingId:v}=f;b>0?setTimeout(()=>{f.pendingId===v&&f.fallback(p)},b):b===0&&f.fallback(p)}}function pT(t,e,r,n,s,i,a,o,l,c,u=!1){const{p:f,m:h,um:p,n:g,o:{parentNode:y,remove:_}}=c;let x;const b=dR(t);b&&e&&e.pendingBranch&&(x=e.pendingId,e.deps++);const v=t.props?V0(t.props.timeout):void 0,T=i,D={vnode:t,parent:e,parentComponent:r,namespace:a,container:n,hiddenContainer:s,deps:0,pendingId:Xg++,timeout:typeof v=="number"?v:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(k=!1,S=!1){const{vnode:E,activeBranch:m,pendingBranch:A,pendingId:I,effects:C,parentComponent:F,container:W}=D;let P=!1;D.isHydrating?D.isHydrating=!1:k||(P=m&&A.transition&&A.transition.mode==="out-in",P&&(m.transition.afterLeave=()=>{I===D.pendingId&&(h(A,W,i===T?g(m):i,0),fd(C))}),m&&(y(m.el)===W&&(i=g(m)),p(m,F,D,!0)),P||h(A,W,i,0)),ic(D,A),D.pendingBranch=null,D.isInFallback=!1;let R=D.parent,N=!1;for(;R;){if(R.pendingBranch){R.effects.push(...C),N=!0;break}R=R.parent}!N&&!P&&fd(C),D.effects=[],b&&e&&e.pendingBranch&&x===e.pendingId&&(e.deps--,e.deps===0&&!S&&e.resolve()),gd(E,"onResolve")},fallback(k){if(!D.pendingBranch)return;const{vnode:S,activeBranch:E,parentComponent:m,container:A,namespace:I}=D;gd(S,"onFallback");const C=g(E),F=()=>{D.isInFallback&&(f(null,k,A,C,m,null,I,o,l),ic(D,k))},W=k.transition&&k.transition.mode==="out-in";W&&(E.transition.afterLeave=F),D.isInFallback=!0,p(E,m,null,!0),W||F()},move(k,S,E){D.activeBranch&&h(D.activeBranch,k,S,E),D.container=k},next(){return D.activeBranch&&g(D.activeBranch)},registerDep(k,S,E){const m=!!D.pendingBranch;m&&D.deps++;const A=k.vnode.el;k.asyncDep.catch(I=>{fl(I,k,0)}).then(I=>{if(k.isUnmounted||D.isUnmounted||D.pendingId!==k.suspenseId)return;k.asyncResolved=!0;const{vnode:C}=k;Zg(k,I,!1),A&&(C.el=A);const F=!A&&k.subTree.el;S(k,C,y(A||k.subTree.el),A?null:g(k.subTree),D,a,E),F&&_(F),ip(k,C.el),m&&--D.deps===0&&D.resolve()})},unmount(k,S){D.isUnmounted=!0,D.activeBranch&&p(D.activeBranch,r,k,S),D.pendingBranch&&p(D.pendingBranch,r,k,S)}};return D}function cR(t,e,r,n,s,i,a,o,l){const c=e.suspense=pT(e,n,r,t.parentNode,document.createElement("div"),null,s,i,a,o,!0),u=l(t,c.pendingBranch=e.ssContent,r,c,i,a);return c.deps===0&&c.resolve(!1,!0),u}function uR(t){const{shapeFlag:e,children:r}=t,n=e&32;t.ssContent=F2(n?r.default:r),t.ssFallback=n?F2(r.fallback):Re(Xr)}function F2(t){let e;if(Tt(t)){const r=Jo&&t._c;r&&(t._d=!1,M()),t=t(),r&&(t._d=!0,e=Yn,gT())}return ft(t)&&(t=tR(t)),t=Es(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(r=>r!==t)),t}function mT(t,e){e&&e.pendingBranch?ft(t)?e.effects.push(...t):e.effects.push(t):fd(t)}function ic(t,e){t.activeBranch=e;const{vnode:r,parentComponent:n}=t;let s=e.el;for(;!s&&e.component;)e=e.component.subTree,s=e.el;r.el=s,n&&n.subTree===r&&(n.vnode.el=s,ip(n,s))}function dR(t){const e=t.props&&t.props.suspensible;return e!=null&&e!==!1}const ke=Symbol.for("v-fgt"),ro=Symbol.for("v-txt"),Xr=Symbol.for("v-cmt"),jo=Symbol.for("v-stc"),Lu=[];let Yn=null;function M(t=!1){Lu.push(Yn=t?null:[])}function gT(){Lu.pop(),Yn=Lu[Lu.length-1]||null}let Jo=1;function Yg(t,e=!1){Jo+=t,t<0&&Yn&&e&&(Yn.hasOnce=!0)}function vT(t){return t.dynamicChildren=Jo>0?Yn||Zl:null,gT(),Jo>0&&Yn&&Yn.push(t),t}function B(t,e,r,n,s,i){return vT(d(t,e,r,n,s,i,!0))}function Qt(t,e,r,n,s){return vT(Re(t,e,r,n,s,!0))}function bi(t){return t?t.__v_isVNode===!0:!1}function ia(t,e){return t.type===e.type&&t.key===e.key}function fR(t){}const yT=({key:t})=>t??null,E0=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?Tr(t)||Cr(t)||Tt(t)?{i:fn,r:t,k:e,f:!!r}:t:null);function d(t,e=null,r=null,n=0,s=null,i=t===ke?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&yT(e),ref:e&&E0(e),scopeId:Zh,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:fn};return o?(R1(l,r),i&128&&t.normalize(l)):r&&(l.shapeFlag|=Tr(r)?8:16),Jo>0&&!a&&Yn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Yn.push(l),l}const Re=hR;function hR(t,e=null,r=null,n=0,s=null,i=!1){if((!t||t===jA)&&(t=Xr),bi(t)){const o=Ba(t,e,!0);return r&&R1(o,r),Jo>0&&!i&&Yn&&(o.shapeFlag&6?Yn[Yn.indexOf(t)]=o:Yn.push(o)),o.patchFlag=-2,o}if(ER(t)&&(t=t.__vccOpts),e){e=xT(e);let{class:o,style:l}=e;o&&!Tr(o)&&(e.class=Ye(o)),gr(l)&&(Qh(l)&&!ft(l)&&(l=xr({},l)),e.style=Nr(l))}const a=Tr(t)?1:X0(t)?128:IA(t)?64:gr(t)?4:Tt(t)?2:0;return d(t,e,r,n,s,a,i,!0)}function xT(t){return t?Qh(t)||QA(t)?xr({},t):t:null}function Ba(t,e,r=!1,n=!1){const{props:s,ref:i,patchFlag:a,children:o,transition:l}=t,c=e?ET(s||{},e):s,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&yT(c),ref:e&&e.ref?r&&i?ft(i)?i.concat(E0(e)):[i,E0(e)]:E0(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ke?a===-1?16:a|16:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ba(t.ssContent),ssFallback:t.ssFallback&&Ba(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&Ei(u,l.clone(u)),u}function we(t=" ",e=0){return Re(ro,null,t,e)}function En(t,e){const r=Re(jo,null,t);return r.staticCount=e,r}function ve(t="",e=!1){return e?(M(),Qt(Xr,null,t)):Re(Xr,null,t)}function Es(t){return t==null||typeof t=="boolean"?Re(Xr):ft(t)?Re(ke,null,t.slice()):bi(t)?Wi(t):Re(ro,null,String(t))}function Wi(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ba(t)}function R1(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(ft(e))r=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),R1(t,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!QA(e)?e._ctx=fn:s===3&&fn&&(fn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Tt(e)?(e={default:e,_ctx:fn},r=32):(e=String(e),n&64?(r=16,e=[we(e)]):r=8);t.children=e,t.shapeFlag|=r}function ET(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=Ye([e.class,n.class]));else if(s==="style")e.style=Nr([e.style,n.style]);else if(Bd(s)){const i=e[s],a=n[s];a&&i!==a&&!(ft(i)&&i.includes(a))&&(e[s]=i?[].concat(i,a):a)}else s!==""&&(e[s]=n[s])}return e}function ys(t,e,r,n=null){zs(t,e,7,[r,n])}const pR=KA();let mR=0;function bT(t,e,r){const n=t.type,s=(e?e.appContext:t.appContext)||pR,i={uid:mR++,vnode:t,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new u1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ZA(n,s),emitsOptions:hT(n,s),emit:null,emitted:null,propsDefaults:Jt,inheritAttrs:n.inheritAttrs,ctx:Jt,data:Jt,props:Jt,attrs:Jt,slots:Jt,refs:Jt,setupState:Jt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=eR.bind(null,i),t.ce&&t.ce(i),i}let dn=null;const Xs=()=>dn||fn;let Y0,Qg;{const t=Wh(),e=(r,n)=>{let s;return(s=t[r])||(s=t[r]=[]),s.push(n),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};Y0=e("__VUE_INSTANCE_SETTERS__",r=>dn=r),Qg=e("__VUE_SSR_SETTERS__",r=>xc=r)}const Zo=t=>{const e=dn;return Y0(t),t.scope.on(),()=>{t.scope.off(),Y0(e)}},Jg=()=>{dn&&dn.scope.off(),Y0(null)};function _T(t){return t.vnode.shapeFlag&4}let xc=!1;function ST(t,e=!1,r=!1){e&&Qg(e);const{props:n,children:s}=t.vnode,i=_T(t);jP(t,n,i,e),KP(t,s,r||e);const a=i?gR(t,e):void 0;return e&&Qg(!1),a}function gR(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Wg);const{setup:n}=r;if(n){vi();const s=t.setupContext=n.length>1?TT(t):null,i=Zo(t),a=Lc(n,t,0,[t.props,s]),o=l1(a);if(yi(),i(),(o||t.sp)&&!to(t)&&_1(t),o){if(a.then(Jg,Jg),e)return a.then(l=>{Zg(t,l,e)}).catch(l=>{fl(l,t,0)});t.asyncDep=a}else Zg(t,a,e)}else AT(t,e)}function Zg(t,e,r){Tt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:gr(e)&&(t.setupState=y1(e)),AT(t,r)}let Q0,ev;function vR(t){Q0=t,ev=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,_P))}}const yR=()=>!Q0;function AT(t,e,r){const n=t.type;if(!t.render){if(!e&&Q0&&!n.render){const s=n.template||I1(t).template;if(s){const{isCustomElement:i,compilerOptions:a}=t.appContext.config,{delimiters:o,compilerOptions:l}=n,c=xr(xr({isCustomElement:i,delimiters:o},a),l);n.render=Q0(s,c)}}t.render=n.render||js,ev&&ev(t)}{const s=Zo(t);vi();try{MP(t)}finally{yi(),s()}}}const xR={get(t,e){return zn(t,"get",""),t[e]}};function TT(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,xR),slots:t.slots,emit:t.emit,expose:e}}function jd(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(y1(Jh(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in Ou)return Ou[r](t)},has(e,r){return r in e||r in Ou}})):t.proxy}function tv(t,e=!0){return Tt(t)?t.displayName||t.name:t.name||e&&t.__name}function ER(t){return Tt(t)&&"__vccOpts"in t}const _e=(t,e)=>M3(t,e,xc);function el(t,e,r){const n=arguments.length;return n===2?gr(e)&&!ft(e)?bi(e)?Re(t,null,[e]):Re(t,e):Re(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&bi(r)&&(r=[r]),Re(t,e,r))}function bR(){}function _R(t,e,r,n){const s=r[n];if(s&&wT(s,t))return s;const i=e();return i.memo=t.slice(),i.cacheIndex=n,r[n]=i}function wT(t,e){const r=t.memo;if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(ls(r[n],e[n]))return!1;return Jo>0&&Yn&&Yn.push(t),!0}const CT="3.5.17",SR=js,AR=W3,TR=Vl,wR=wA,CR={createComponentInstance:bT,setupComponent:ST,renderComponentRoot:x0,setCurrentRenderingInstance:pd,isVNode:bi,normalizeVNode:Es,getComponentPublicInstance:jd,ensureValidVNode:C1,pushWarningContext:V3,popWarningContext:H3},IR=CR,kR=null,DR=null,PR=null;/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let rv;const N2=typeof window<"u"&&window.trustedTypes;if(N2)try{rv=N2.createPolicy("vue",{createHTML:t=>t})}catch{}const IT=rv?t=>rv.createHTML(t):t=>t,RR="http://www.w3.org/2000/svg",FR="http://www.w3.org/1998/Math/MathML",Za=typeof document<"u"?document:null,O2=Za&&Za.createElement("template"),NR={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const s=e==="svg"?Za.createElementNS(RR,t):e==="mathml"?Za.createElementNS(FR,t):r?Za.createElement(t,{is:r}):Za.createElement(t);return t==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:t=>Za.createTextNode(t),createComment:t=>Za.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Za.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,s,i){const a=r?r.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{O2.innerHTML=IT(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const o=O2.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},Mi="transition",su="animation",Ec=Symbol("_vtc"),kT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},DT=xr({},b1,kT),OR=t=>(t.displayName="Transition",t.props=DT,t),MR=OR((t,{slots:e})=>el(FA,PT(t),e)),ko=(t,e=[])=>{ft(t)?t.forEach(r=>r(...e)):t&&t(...e)},M2=t=>t?ft(t)?t.some(e=>e.length>1):t.length>1:!1;function PT(t){const e={};for(const C in t)C in kT||(e[C]=t[C]);if(t.css===!1)return e;const{name:r="v",type:n,duration:s,enterFromClass:i=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:o=`${r}-enter-to`,appearFromClass:l=i,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:f=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:p=`${r}-leave-to`}=t,g=LR(s),y=g&&g[0],_=g&&g[1],{onBeforeEnter:x,onEnter:b,onEnterCancelled:v,onLeave:T,onLeaveCancelled:D,onBeforeAppear:k=x,onAppear:S=b,onAppearCancelled:E=v}=e,m=(C,F,W,P)=>{C._enterCancelled=P,$i(C,F?u:o),$i(C,F?c:a),W&&W()},A=(C,F)=>{C._isLeaving=!1,$i(C,f),$i(C,p),$i(C,h),F&&F()},I=C=>(F,W)=>{const P=C?S:b,R=()=>m(F,C,W);ko(P,[F,R]),L2(()=>{$i(F,C?l:i),Ca(F,C?u:o),M2(P)||B2(F,n,y,R)})};return xr(e,{onBeforeEnter(C){ko(x,[C]),Ca(C,i),Ca(C,a)},onBeforeAppear(C){ko(k,[C]),Ca(C,l),Ca(C,c)},onEnter:I(!1),onAppear:I(!0),onLeave(C,F){C._isLeaving=!0;const W=()=>A(C,F);Ca(C,f),C._enterCancelled?(Ca(C,h),nv()):(nv(),Ca(C,h)),L2(()=>{C._isLeaving&&($i(C,f),Ca(C,p),M2(T)||B2(C,n,_,W))}),ko(T,[C,W])},onEnterCancelled(C){m(C,!1,void 0,!0),ko(v,[C])},onAppearCancelled(C){m(C,!0,void 0,!0),ko(E,[C])},onLeaveCancelled(C){A(C),ko(D,[C])}})}function LR(t){if(t==null)return null;if(gr(t))return[om(t.enter),om(t.leave)];{const e=om(t);return[e,e]}}function om(t){return V0(t)}function Ca(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t[Ec]||(t[Ec]=new Set)).add(e)}function $i(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const r=t[Ec];r&&(r.delete(e),r.size||(t[Ec]=void 0))}function L2(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let BR=0;function B2(t,e,r,n){const s=t._endId=++BR,i=()=>{s===t._endId&&n()};if(r!=null)return setTimeout(i,r);const{type:a,timeout:o,propCount:l}=RT(t,e);if(!a)return n();const c=a+"end";let u=0;const f=()=>{t.removeEventListener(c,h),i()},h=p=>{p.target===t&&++u>=l&&f()};setTimeout(()=>{u<l&&f()},o+1),t.addEventListener(c,h)}function RT(t,e){const r=window.getComputedStyle(t),n=g=>(r[g]||"").split(", "),s=n(`${Mi}Delay`),i=n(`${Mi}Duration`),a=U2(s,i),o=n(`${su}Delay`),l=n(`${su}Duration`),c=U2(o,l);let u=null,f=0,h=0;e===Mi?a>0&&(u=Mi,f=a,h=i.length):e===su?c>0&&(u=su,f=c,h=l.length):(f=Math.max(a,c),u=f>0?a>c?Mi:su:null,h=u?u===Mi?i.length:l.length:0);const p=u===Mi&&/\b(transform|all)(,|$)/.test(n(`${Mi}Property`).toString());return{type:u,timeout:f,propCount:h,hasTransform:p}}function U2(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>$2(r)+$2(t[n])))}function $2(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function nv(){return document.body.offsetHeight}function UR(t,e,r){const n=t[Ec];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const J0=Symbol("_vod"),FT=Symbol("_vsh"),NT={beforeMount(t,{value:e},{transition:r}){t[J0]=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):au(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:n}){!e!=!r&&(n?e?(n.beforeEnter(t),au(t,!0),n.enter(t)):n.leave(t,()=>{au(t,!1)}):au(t,e))},beforeUnmount(t,{value:e}){au(t,e)}};function au(t,e){t.style.display=e?t[J0]:"none",t[FT]=!e}function $R(){NT.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const OT=Symbol("");function VR(t){const e=Xs();if(!e)return;const r=e.ut=(s=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(i=>Z0(i,s))},n=()=>{const s=t(e.proxy);e.ce?Z0(e.ce,s):sv(e.subTree,s),r(s)};S1(()=>{fd(n)}),Wt(()=>{Ht(n,js,{flush:"post"});const s=new MutationObserver(n);s.observe(e.subTree.el.parentNode,{childList:!0}),ja(()=>s.disconnect())})}function sv(t,e){if(t.shapeFlag&128){const r=t.suspense;t=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{sv(r.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)Z0(t.el,e);else if(t.type===ke)t.children.forEach(r=>sv(r,e));else if(t.type===jo){let{el:r,anchor:n}=t;for(;r&&(Z0(r,e),r!==n);)r=r.nextSibling}}function Z0(t,e){if(t.nodeType===1){const r=t.style;let n="";for(const s in e)r.setProperty(`--${s}`,e[s]),n+=`--${s}: ${e[s]};`;r[OT]=n}}const HR=/(^|;)\s*display\s*:/;function jR(t,e,r){const n=t.style,s=Tr(r);let i=!1;if(r&&!s){if(e)if(Tr(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&b0(n,o,"")}else for(const a in e)r[a]==null&&b0(n,a,"");for(const a in r)a==="display"&&(i=!0),b0(n,a,r[a])}else if(s){if(e!==r){const a=n[OT];a&&(r+=";"+a),n.cssText=r,i=HR.test(r)}}else e&&t.removeAttribute("style");J0 in t&&(t[J0]=i?n.display:"",t[FT]&&(n.display="none"))}const V2=/\s*!important$/;function b0(t,e,r){if(ft(r))r.forEach(n=>b0(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=GR(t,e);V2.test(r)?t.setProperty(bs(n),r.replace(V2,""),"important"):t[n]=r}}const H2=["Webkit","Moz","ms"],lm={};function GR(t,e){const r=lm[e];if(r)return r;let n=Rn(e);if(n!=="filter"&&n in t)return lm[e]=n;n=Ud(n);for(let s=0;s<H2.length;s++){const i=H2[s]+n;if(i in t)return lm[e]=i}return e}const j2="http://www.w3.org/1999/xlink";function G2(t,e,r,n,s,i=n3(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(j2,e.slice(6,e.length)):t.setAttributeNS(j2,e,r):r==null||i&&!JS(r)?t.removeAttribute(e):t.setAttribute(e,i?"":ga(r)?String(r):r)}function W2(t,e,r,n,s){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?IT(r):r);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const o=i==="OPTION"?t.getAttribute("value")||"":t.value,l=r==null?t.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in t))&&(t.value=l),r==null&&t.removeAttribute(e),t._value=r;return}let a=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=JS(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{t[e]=r}catch{}a&&t.removeAttribute(s||e)}function ri(t,e,r,n){t.addEventListener(e,r,n)}function WR(t,e,r,n){t.removeEventListener(e,r,n)}const z2=Symbol("_vei");function zR(t,e,r,n,s=null){const i=t[z2]||(t[z2]={}),a=i[e];if(n&&a)a.value=n;else{const[o,l]=KR(e);if(n){const c=i[e]=YR(n,s);ri(t,o,c,l)}else a&&(WR(t,o,a,l),i[e]=void 0)}}const K2=/(?:Once|Passive|Capture)$/;function KR(t){let e;if(K2.test(t)){e={};let n;for(;n=t.match(K2);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):bs(t.slice(2)),e]}let cm=0;const qR=Promise.resolve(),XR=()=>cm||(qR.then(()=>cm=0),cm=Date.now());function YR(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;zs(QR(n,r.value),e,5,[n])};return r.value=t,r.attached=XR(),r}function QR(t,e){if(ft(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const q2=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,JR=(t,e,r,n,s,i)=>{const a=s==="svg";e==="class"?UR(t,n,a):e==="style"?jR(t,r,n):Bd(e)?i1(e)||zR(t,e,r,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):ZR(t,e,n,a))?(W2(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&G2(t,e,n,a,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Tr(n))?W2(t,Rn(e),n,i,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),G2(t,e,n,a))};function ZR(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&q2(e)&&Tt(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return q2(e)&&Tr(r)?!1:e in t}const X2={};/*! #__NO_SIDE_EFFECTS__ */function MT(t,e,r){const n=$d(t,e);jh(n)&&xr(n,e);class s extends op{constructor(a){super(n,a,r)}}return s.def=n,s}/*! #__NO_SIDE_EFFECTS__ */const eF=(t,e)=>MT(t,e,KT),tF=typeof HTMLElement<"u"?HTMLElement:class{};class op extends tF{constructor(e,r={},n=th){super(),this._def=e,this._props=r,this._createApp=n,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&n!==th?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this}connectedCallback(){if(!this.isConnected)return;!this.shadowRoot&&!this._resolved&&this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof op){this._parent=e;break}this._instance||(this._resolved?this._mount(this._def):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._inheritParentContext(e))}_inheritParentContext(e=this._parent){e&&this._app&&Object.setPrototypeOf(this._app._context.provides,e._instance.provides)}disconnectedCallback(){this._connected=!1,hl(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);this._ob=new MutationObserver(n=>{for(const s of n)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(n,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:i,styles:a}=n;let o;if(i&&!ft(i))for(const l in i){const c=i[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=V0(this._props[l])),(o||(o=Object.create(null)))[Rn(l)]=!0)}this._numberProps=o,this._resolveProps(n),this.shadowRoot&&this._applyStyles(a),this._mount(n)},r=this._def.__asyncLoader;r?this._pendingResolve=r().then(n=>{n.configureApp=this._def.configureApp,e(this._def=n,!0)}):e(this._def)}_mount(e){this._app=this._createApp(e),this._inheritParentContext(),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const r=this._instance&&this._instance.exposed;if(r)for(const n in r)ur(this,n)||Object.defineProperty(this,n,{get:()=>q(r[n])})}_resolveProps(e){const{props:r}=e,n=ft(r)?r:Object.keys(r||{});for(const s of Object.keys(this))s[0]!=="_"&&n.includes(s)&&this._setProp(s,this[s]);for(const s of n.map(Rn))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(i){this._setProp(s,i,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const r=this.hasAttribute(e);let n=r?this.getAttribute(e):X2;const s=Rn(e);r&&this._numberProps&&this._numberProps[s]&&(n=V0(n)),this._setProp(s,n,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,r,n=!0,s=!1){if(r!==this._props[e]&&(r===X2?delete this._props[e]:(this._props[e]=r,e==="key"&&this._app&&(this._app._ceVNode.key=r)),s&&this._instance&&this._update(),n)){const i=this._ob;i&&i.disconnect(),r===!0?this.setAttribute(bs(e),""):typeof r=="string"||typeof r=="number"?this.setAttribute(bs(e),r+""):r||this.removeAttribute(bs(e)),i&&i.observe(this,{attributes:!0})}}_update(){const e=this._createVNode();this._app&&(e.appContext=this._app._context),zT(e,this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const r=Re(this._def,xr(e,this._props));return this._instance||(r.ce=n=>{this._instance=n,n.ce=this,n.isCE=!0;const s=(i,a)=>{this.dispatchEvent(new CustomEvent(i,jh(a[0])?xr({detail:a},a[0]):{detail:a}))};n.emit=(i,...a)=>{s(i,a),bs(i)!==i&&s(bs(i),a)},this._setParent()}),r}_applyStyles(e,r){if(!e)return;if(r){if(r===this._def||this._styleChildren.has(r))return;this._styleChildren.add(r)}const n=this._nonce;for(let s=e.length-1;s>=0;s--){const i=document.createElement("style");n&&i.setAttribute("nonce",n),i.textContent=e[s],this.shadowRoot.prepend(i)}}_parseSlots(){const e=this._slots={};let r;for(;r=this.firstChild;){const n=r.nodeType===1&&r.getAttribute("slot")||"default";(e[n]||(e[n]=[])).push(r),this.removeChild(r)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),r=this._instance.type.__scopeId;for(let n=0;n<e.length;n++){const s=e[n],i=s.getAttribute("name")||"default",a=this._slots[i],o=s.parentNode;if(a)for(const l of a){if(r&&l.nodeType===1){const c=r+"-s",u=document.createTreeWalker(l,1);l.setAttribute(c,"");let f;for(;f=u.nextNode();)f.setAttribute(c,"")}o.insertBefore(l,s)}else for(;s.firstChild;)o.insertBefore(s.firstChild,s);o.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}function LT(t){const e=Xs(),r=e&&e.ce;return r||null}function rF(){const t=LT();return t&&t.shadowRoot}function nF(t="$style"){{const e=Xs();if(!e)return Jt;const r=e.type.__cssModules;if(!r)return Jt;const n=r[t];return n||Jt}}const BT=new WeakMap,UT=new WeakMap,eh=Symbol("_moveCb"),Y2=Symbol("_enterCb"),sF=t=>(delete t.props.mode,t),aF=sF({name:"TransitionGroup",props:xr({},DT,{tag:String,moveClass:String}),setup(t,{slots:e}){const r=Xs(),n=E1();let s,i;return np(()=>{if(!s.length)return;const a=t.moveClass||`${t.name||"v"}-move`;if(!uF(s[0].el,r.vnode.el,a)){s=[];return}s.forEach(oF),s.forEach(lF);const o=s.filter(cF);nv(),o.forEach(l=>{const c=l.el,u=c.style;Ca(c,a),u.transform=u.webkitTransform=u.transitionDuration="";const f=c[eh]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",f),c[eh]=null,$i(c,a))};c.addEventListener("transitionend",f)}),s=[]}),()=>{const a=Xt(t),o=PT(a);let l=a.tag||ke;if(s=[],i)for(let c=0;c<i.length;c++){const u=i[c];u.el&&u.el instanceof Element&&(s.push(u),Ei(u,yc(u,o,n,r)),BT.set(u,u.el.getBoundingClientRect()))}i=e.default?tp(e.default()):[];for(let c=0;c<i.length;c++){const u=i[c];u.key!=null&&Ei(u,yc(u,o,n,r))}return Re(l,null,i)}}}),iF=aF;function oF(t){const e=t.el;e[eh]&&e[eh](),e[Y2]&&e[Y2]()}function lF(t){UT.set(t,t.el.getBoundingClientRect())}function cF(t){const e=BT.get(t),r=UT.get(t),n=e.left-r.left,s=e.top-r.top;if(n||s){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${n}px,${s}px)`,i.transitionDuration="0s",t}}function uF(t,e,r){const n=t.cloneNode(),s=t[Ec];s&&s.forEach(o=>{o.split(/\s+/).forEach(l=>l&&n.classList.remove(l))}),r.split(/\s+/).forEach(o=>o&&n.classList.add(o)),n.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(n);const{hasTransform:a}=RT(n);return i.removeChild(n),a}const oo=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ft(e)?r=>rc(e,r):e};function dF(t){t.target.composing=!0}function Q2(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Gs=Symbol("_assign"),ht={created(t,{modifiers:{lazy:e,trim:r,number:n}},s){t[Gs]=oo(s);const i=n||s.props&&s.props.type==="number";ri(t,e?"change":"input",a=>{if(a.target.composing)return;let o=t.value;r&&(o=o.trim()),i&&(o=$0(o)),t[Gs](o)}),r&&ri(t,"change",()=>{t.value=t.value.trim()}),e||(ri(t,"compositionstart",dF),ri(t,"compositionend",Q2),ri(t,"change",Q2))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:n,trim:s,number:i}},a){if(t[Gs]=oo(a),t.composing)return;const o=(i||t.type==="number")&&!/^0\d/.test(t.value)?$0(t.value):t.value,l=e??"";o!==l&&(document.activeElement===t&&t.type!=="range"&&(n&&e===r||s&&t.value.trim()===l)||(t.value=l))}},_t={deep:!0,created(t,e,r){t[Gs]=oo(r),ri(t,"change",()=>{const n=t._modelValue,s=bc(t),i=t.checked,a=t[Gs];if(ft(n)){const o=zh(n,s),l=o!==-1;if(i&&!l)a(n.concat(s));else if(!i&&l){const c=[...n];c.splice(o,1),a(c)}}else if(dl(n)){const o=new Set(n);i?o.add(s):o.delete(s),a(o)}else a($T(t,i))})},mounted:J2,beforeUpdate(t,e,r){t[Gs]=oo(r),J2(t,e,r)}};function J2(t,{value:e,oldValue:r},n){t._modelValue=e;let s;if(ft(e))s=zh(e,n.props.value)>-1;else if(dl(e))s=e.has(n.props.value);else{if(e===r)return;s=io(e,$T(t,!0))}t.checked!==s&&(t.checked=s)}const Ss={created(t,{value:e},r){t.checked=io(e,r.props.value),t[Gs]=oo(r),ri(t,"change",()=>{t[Gs](bc(t))})},beforeUpdate(t,{value:e,oldValue:r},n){t[Gs]=oo(n),e!==r&&(t.checked=io(e,n.props.value))}},sr={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const s=dl(e);ri(t,"change",()=>{const i=Array.prototype.filter.call(t.options,a=>a.selected).map(a=>r?$0(bc(a)):bc(a));t[Gs](t.multiple?s?new Set(i):i:i[0]),t._assigning=!0,hl(()=>{t._assigning=!1})}),t[Gs]=oo(n)},mounted(t,{value:e}){Z2(t,e)},beforeUpdate(t,e,r){t[Gs]=oo(r)},updated(t,{value:e}){t._assigning||Z2(t,e)}};function Z2(t,e){const r=t.multiple,n=ft(e);if(!(r&&!n&&!dl(e))){for(let s=0,i=t.options.length;s<i;s++){const a=t.options[s],o=bc(a);if(r)if(n){const l=typeof o;l==="string"||l==="number"?a.selected=e.some(c=>String(c)===String(o)):a.selected=zh(e,o)>-1}else a.selected=e.has(o);else if(io(bc(a),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function bc(t){return"_value"in t?t._value:t.value}function $T(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const VT={created(t,e,r){Bf(t,e,r,null,"created")},mounted(t,e,r){Bf(t,e,r,null,"mounted")},beforeUpdate(t,e,r,n){Bf(t,e,r,n,"beforeUpdate")},updated(t,e,r,n){Bf(t,e,r,n,"updated")}};function HT(t,e){switch(t){case"SELECT":return sr;case"TEXTAREA":return ht;default:switch(e){case"checkbox":return _t;case"radio":return Ss;default:return ht}}}function Bf(t,e,r,n,s){const a=HT(t.tagName,r.props&&r.props.type)[s];a&&a(t,e,r,n)}function fF(){ht.getSSRProps=({value:t})=>({value:t}),Ss.getSSRProps=({value:t},e)=>{if(e.props&&io(e.props.value,t))return{checked:!0}},_t.getSSRProps=({value:t},e)=>{if(ft(t)){if(e.props&&zh(t,e.props.value)>-1)return{checked:!0}}else if(dl(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},VT.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const r=HT(e.type.toUpperCase(),e.props&&e.props.type);if(r.getSSRProps)return r.getSSRProps(t,e)}}const hF=["ctrl","shift","alt","meta"],pF={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>hF.some(r=>t[`${r}Key`]&&!e.includes(r))},Yr=(t,e)=>{const r=t._withMods||(t._withMods={}),n=e.join(".");return r[n]||(r[n]=(s,...i)=>{for(let a=0;a<e.length;a++){const o=pF[e[a]];if(o&&o(s,e))return}return t(s,...i)})},mF={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},F1=(t,e)=>{const r=t._withKeys||(t._withKeys={}),n=e.join(".");return r[n]||(r[n]=s=>{if(!("key"in s))return;const i=bs(s.key);if(e.some(a=>a===i||mF[a]===i))return t(s)})},jT=xr({patchProp:JR},NR);let Bu,eE=!1;function GT(){return Bu||(Bu=nT(jT))}function WT(){return Bu=eE?Bu:sT(jT),eE=!0,Bu}const zT=(...t)=>{GT().render(...t)},gF=(...t)=>{WT().hydrate(...t)},th=(...t)=>{const e=GT().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=XT(n);if(!s)return;const i=e._component;!Tt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=r(s,!1,qT(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},e},KT=(...t)=>{const e=WT().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=XT(n);if(s)return r(s,!0,qT(s))},e};function qT(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function XT(t){return Tr(t)?document.querySelector(t):t}let tE=!1;const vF=()=>{tE||(tE=!0,fF(),$R())};/**
* vue v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const yF=()=>{},xF=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:FA,BaseTransitionPropsValidators:b1,Comment:Xr,DeprecationTypes:PR,EffectScope:u1,ErrorCodes:G3,ErrorTypeStrings:AR,Fragment:ke,KeepAlive:gP,ReactiveEffect:cd,Static:jo,Suspense:iR,Teleport:J3,Text:ro,TrackOpTypes:L3,Transition:MR,TransitionGroup:iF,TriggerOpTypes:B3,VueElement:op,assertNumber:j3,callWithAsyncErrorHandling:zs,callWithErrorHandling:Lc,camelize:Rn,capitalize:Ud,cloneVNode:Ba,compatUtils:DR,compile:yF,computed:_e,createApp:th,createBlock:Qt,createCommentVNode:ve,createElementBlock:B,createElementVNode:d,createHydrationRenderer:sT,createPropsRestProxy:NP,createRenderer:nT,createSSRApp:KT,createSlots:EP,createStaticVNode:En,createTextVNode:we,createVNode:Re,customRef:yA,defineAsyncComponent:pP,defineComponent:$d,defineCustomElement:MT,defineEmits:AP,defineExpose:TP,defineModel:IP,defineOptions:wP,defineProps:SP,defineSSRCustomElement:eF,defineSlots:CP,devtools:TR,effect:i3,effectScope:d1,getCurrentInstance:Xs,getCurrentScope:f1,getCurrentWatcher:U3,getTransitionRawChildren:tp,guardReactiveProps:xT,h:el,handleError:fl,hasInjectionContext:qA,hydrate:gF,hydrateOnIdle:lP,hydrateOnInteraction:fP,hydrateOnMediaQuery:dP,hydrateOnVisible:uP,initCustomFormatter:bR,initDirectivesForSSR:vF,inject:Os,isMemoSame:wT,isProxy:Qh,isReactive:Fa,isReadonly:xi,isRef:Cr,isRuntimeOnly:yR,isShallow:Ns,isVNode:bi,markRaw:Jh,mergeDefaults:RP,mergeModels:FP,mergeProps:ET,nextTick:hl,normalizeClass:Ye,normalizeProps:t3,normalizeStyle:Nr,onActivated:OA,onBeforeMount:BA,onBeforeUnmount:sp,onBeforeUpdate:S1,onDeactivated:MA,onErrorCaptured:HA,onMounted:Wt,onRenderTracked:VA,onRenderTriggered:$A,onScopeDispose:tA,onServerPrefetch:UA,onUnmounted:ja,onUpdated:np,onWatcherCleanup:bA,openBlock:M,popScopeId:X3,provide:Mu,proxyRefs:y1,pushScopeId:q3,queuePostFlushCb:fd,reactive:As,readonly:nc,ref:se,registerRuntimeCompiler:vR,render:zT,renderList:He,renderSlot:GA,resolveComponent:br,resolveDirective:xP,resolveDynamicComponent:T1,resolveFilter:kR,resolveTransitionHooks:yc,setBlockTracking:Yg,setDevtoolsHook:wR,setTransitionHooks:Ei,shallowReactive:g1,shallowReadonly:w3,shallowRef:v1,ssrContextKey:lT,ssrUtils:IR,stop:o3,toDisplayString:Q,toHandlerKey:Pu,toHandlers:bP,toRaw:Xt,toRef:N3,toRefs:xA,toValue:k3,transformVNodeArgs:fR,triggerRef:I3,unref:q,useAttrs:PP,useCssModule:nF,useCssVars:VR,useHost:LT,useId:eP,useModel:ZP,useSSRContext:cT,useShadowRoot:rF,useSlots:DP,useTemplateRef:tP,useTransitionState:E1,vModelCheckbox:_t,vModelDynamic:VT,vModelRadio:Ss,vModelSelect:sr,vModelText:ht,vShow:NT,version:CT,warn:SR,watch:Ht,watchEffect:YP,watchPostEffect:QP,watchSyncEffect:uT,withAsyncContext:OP,withCtx:ep,withDefaults:kP,withDirectives:Oe,withKeys:F1,withMemo:_R,withModifiers:Yr,withScopeId:Y3},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let YT;const lp=t=>YT=t,QT=Symbol();function av(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Uu;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Uu||(Uu={}));function EF(){const t=d1(!0),e=t.run(()=>se({}));let r=[],n=[];const s=Jh({install(i){lp(s),s._a=i,i.provide(QT,s),i.config.globalProperties.$pinia=s,n.forEach(a=>r.push(a)),n=[]},use(i){return this._a?r.push(i):n.push(i),this},_p:r,_a:null,_e:t,_s:new Map,state:e});return s}const JT=()=>{};function rE(t,e,r,n=JT){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),n())};return!r&&f1()&&tA(s),s}function Nl(t,...e){t.slice().forEach(r=>{r(...e)})}const bF=t=>t(),nE=Symbol(),um=Symbol();function iv(t,e){t instanceof Map&&e instanceof Map?e.forEach((r,n)=>t.set(n,r)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const r in e){if(!e.hasOwnProperty(r))continue;const n=e[r],s=t[r];av(s)&&av(n)&&t.hasOwnProperty(r)&&!Cr(n)&&!Fa(n)?t[r]=iv(s,n):t[r]=n}return t}const _F=Symbol();function SF(t){return!av(t)||!t.hasOwnProperty(_F)}const{assign:Vi}=Object;function AF(t){return!!(Cr(t)&&t.effect)}function TF(t,e,r,n){const{state:s,actions:i,getters:a}=e,o=r.state.value[t];let l;function c(){o||(r.state.value[t]=s?s():{});const u=xA(r.state.value[t]);return Vi(u,i,Object.keys(a||{}).reduce((f,h)=>(f[h]=Jh(_e(()=>{lp(r);const p=r._s.get(t);return a[h].call(p,p)})),f),{}))}return l=ZT(t,c,e,r,n,!0),l}function ZT(t,e,r={},n,s,i){let a;const o=Vi({actions:{}},r),l={deep:!0};let c,u,f=[],h=[],p;const g=n.state.value[t];!i&&!g&&(n.state.value[t]={}),se({});let y;function _(E){let m;c=u=!1,typeof E=="function"?(E(n.state.value[t]),m={type:Uu.patchFunction,storeId:t,events:p}):(iv(n.state.value[t],E),m={type:Uu.patchObject,payload:E,storeId:t,events:p});const A=y=Symbol();hl().then(()=>{y===A&&(c=!0)}),u=!0,Nl(f,m,n.state.value[t])}const x=i?function(){const{state:m}=r,A=m?m():{};this.$patch(I=>{Vi(I,A)})}:JT;function b(){a.stop(),f=[],h=[],n._s.delete(t)}const v=(E,m="")=>{if(nE in E)return E[um]=m,E;const A=function(){lp(n);const I=Array.from(arguments),C=[],F=[];function W(N){C.push(N)}function P(N){F.push(N)}Nl(h,{args:I,name:A[um],store:D,after:W,onError:P});let R;try{R=E.apply(this&&this.$id===t?this:D,I)}catch(N){throw Nl(F,N),N}return R instanceof Promise?R.then(N=>(Nl(C,N),N)).catch(N=>(Nl(F,N),Promise.reject(N))):(Nl(C,R),R)};return A[nE]=!0,A[um]=m,A},T={_p:n,$id:t,$onAction:rE.bind(null,h),$patch:_,$reset:x,$subscribe(E,m={}){const A=rE(f,E,m.detached,()=>I()),I=a.run(()=>Ht(()=>n.state.value[t],C=>{(m.flush==="sync"?u:c)&&E({storeId:t,type:Uu.direct,events:p},C)},Vi({},l,m)));return A},$dispose:b},D=As(T);n._s.set(t,D);const S=(n._a&&n._a.runWithContext||bF)(()=>n._e.run(()=>(a=d1()).run(()=>e({action:v}))));for(const E in S){const m=S[E];if(Cr(m)&&!AF(m)||Fa(m))i||(g&&SF(m)&&(Cr(m)?m.value=g[E]:iv(m,g[E])),n.state.value[t][E]=m);else if(typeof m=="function"){const A=v(m,E);S[E]=A,o.actions[E]=m}}return Vi(D,S),Vi(Xt(D),S),Object.defineProperty(D,"$state",{get:()=>n.state.value[t],set:E=>{_(m=>{Vi(m,E)})}}),n._p.forEach(E=>{Vi(D,a.run(()=>E({store:D,app:n._a,pinia:n,options:o})))}),g&&i&&r.hydrate&&r.hydrate(D.$state,g),c=!0,u=!0,D}/*! #__NO_SIDE_EFFECTS__ */function ew(t,e,r){let n,s;const i=typeof e=="function";typeof t=="string"?(n=t,s=i?r:e):(s=t,n=t.id);function a(o,l){const c=qA();return o=o||(c?Os(QT,null):null),o&&lp(o),o=YT,o._s.has(n)||(i?ZT(n,e,s,o):TF(n,s,o)),o._s.get(n)}return a.$id=n,a}var sE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},wF=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},rw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,f=(i&3)<<4|o>>4;let h=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(h=64)),n.push(r[u],r[f],r[h],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(tw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):wF(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const f=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||f==null)throw new CF;const h=i<<2|o>>4;if(n.push(h),c!==64){const p=o<<4&240|c>>2;if(n.push(p),f!==64){const g=c<<6&192|f;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class CF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const IF=function(t){const e=tw(t);return rw.encodeByteArray(e,!0)},rh=function(t){return IF(t).replace(/\./g,"")},nw=function(t){try{return rw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF=()=>kF().__FIREBASE_DEFAULTS__,PF=()=>{if(typeof process>"u"||typeof sE>"u")return;const t=sE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},RF=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&nw(t[1]);return e&&JSON.parse(e)},cp=()=>{try{return DF()||PF()||RF()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sw=t=>{var e,r;return(r=(e=cp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},N1=t=>{const e=sw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},aw=()=>{var t;return(t=cp())===null||t===void 0?void 0:t.config},iw=t=>{var e;return(e=cp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[rh(JSON.stringify(r)),rh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NF(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ts())}function OF(){var t;const e=(t=cp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function MF(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function LF(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function BF(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UF(){const t=ts();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function $F(){return!OF()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function VF(){try{return typeof indexedDB=="object"}catch{return!1}}function HF(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF="FirebaseError";class Ea extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=jF,Object.setPrototypeOf(this,Ea.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gd.prototype.create)}}class Gd{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?GF(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Ea(s,o,n)}}function GF(t,e){return t.replace(WF,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const WF=/\{\$([^}]+)}/g;function zF(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function nh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(aE(i)&&aE(a)){if(!nh(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function aE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wd(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function KF(t,e){const r=new qF(t,e);return r.subscribe.bind(r)}class qF{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");XF(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=dm),s.error===void 0&&(s.error=dm),s.complete===void 0&&(s.complete=dm);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XF(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function dm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class _i{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new FF;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(JF(e))try{this.getOrInitializeService({instanceIdentifier:No})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=No){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=No){return this.instances.has(e)}getOptions(e=No){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:QF(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=No){return this.component?this.component.multipleInstances?e:No:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function QF(t){return t===No?void 0:t}function JF(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new YF(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Yt||(Yt={}));const e8={debug:Yt.DEBUG,verbose:Yt.VERBOSE,info:Yt.INFO,warn:Yt.WARN,error:Yt.ERROR,silent:Yt.SILENT},t8=Yt.INFO,r8={[Yt.DEBUG]:"log",[Yt.VERBOSE]:"log",[Yt.INFO]:"info",[Yt.WARN]:"warn",[Yt.ERROR]:"error"},n8=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=r8[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class O1{constructor(e){this.name=e,this._logLevel=t8,this._logHandler=n8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?e8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Yt.DEBUG,...e),this._logHandler(this,Yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Yt.VERBOSE,...e),this._logHandler(this,Yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Yt.INFO,...e),this._logHandler(this,Yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Yt.WARN,...e),this._logHandler(this,Yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Yt.ERROR,...e),this._logHandler(this,Yt.ERROR,...e)}}const s8=(t,e)=>e.some(r=>t instanceof r);let iE,oE;function a8(){return iE||(iE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function i8(){return oE||(oE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lw=new WeakMap,ov=new WeakMap,cw=new WeakMap,fm=new WeakMap,M1=new WeakMap;function o8(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(no(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&lw.set(r,t)}).catch(()=>{}),M1.set(e,t),e}function l8(t){if(ov.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});ov.set(t,e)}let lv={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return ov.get(t);if(e==="objectStoreNames")return t.objectStoreNames||cw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return no(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function c8(t){lv=t(lv)}function u8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(hm(this),e,...r);return cw.set(n,e.sort?e.sort():[e]),no(n)}:i8().includes(t)?function(...e){return t.apply(hm(this),e),no(lw.get(this))}:function(...e){return no(t.apply(hm(this),e))}}function d8(t){return typeof t=="function"?u8(t):(t instanceof IDBTransaction&&l8(t),s8(t,a8())?new Proxy(t,lv):t)}function no(t){if(t instanceof IDBRequest)return o8(t);if(fm.has(t))return fm.get(t);const e=d8(t);return e!==t&&(fm.set(t,e),M1.set(e,t)),e}const hm=t=>M1.get(t);function f8(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=no(a);return n&&a.addEventListener("upgradeneeded",l=>{n(no(a.result),l.oldVersion,l.newVersion,no(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const h8=["get","getKey","getAll","getAllKeys","count"],p8=["put","add","delete","clear"],pm=new Map;function lE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(pm.get(e))return pm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=p8.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||h8.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return pm.set(e,i),i}c8(t=>({...t,get:(e,r,n)=>lE(e,r)||t.get(e,r,n),has:(e,r)=>!!lE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(g8(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function g8(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cv="@firebase/app",cE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new O1("@firebase/app"),v8="@firebase/app-compat",y8="@firebase/analytics-compat",x8="@firebase/analytics",E8="@firebase/app-check-compat",b8="@firebase/app-check",_8="@firebase/auth",S8="@firebase/auth-compat",A8="@firebase/database",T8="@firebase/data-connect",w8="@firebase/database-compat",C8="@firebase/functions",I8="@firebase/functions-compat",k8="@firebase/installations",D8="@firebase/installations-compat",P8="@firebase/messaging",R8="@firebase/messaging-compat",F8="@firebase/performance",N8="@firebase/performance-compat",O8="@firebase/remote-config",M8="@firebase/remote-config-compat",L8="@firebase/storage",B8="@firebase/storage-compat",U8="@firebase/firestore",$8="@firebase/vertexai-preview",V8="@firebase/firestore-compat",H8="firebase",j8="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="[DEFAULT]",G8={[cv]:"fire-core",[v8]:"fire-core-compat",[x8]:"fire-analytics",[y8]:"fire-analytics-compat",[b8]:"fire-app-check",[E8]:"fire-app-check-compat",[_8]:"fire-auth",[S8]:"fire-auth-compat",[A8]:"fire-rtdb",[T8]:"fire-data-connect",[w8]:"fire-rtdb-compat",[C8]:"fire-fn",[I8]:"fire-fn-compat",[k8]:"fire-iid",[D8]:"fire-iid-compat",[P8]:"fire-fcm",[R8]:"fire-fcm-compat",[F8]:"fire-perf",[N8]:"fire-perf-compat",[O8]:"fire-rc",[M8]:"fire-rc-compat",[L8]:"fire-gcs",[B8]:"fire-gcs-compat",[U8]:"fire-fst",[V8]:"fire-fst-compat",[$8]:"fire-vertex","fire-js":"fire-js",[H8]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=new Map,W8=new Map,dv=new Map;function uE(t,e){try{t.container.addComponent(e)}catch(r){Si.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function lo(t){const e=t.name;if(dv.has(e))return Si.debug(`There were multiple attempts to register component ${e}.`),!1;dv.set(e,t);for(const r of sh.values())uE(r,t);for(const r of W8.values())uE(r,t);return!0}function zd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function oi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},so=new Gd("app","Firebase",z8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K8{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw so.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl=j8;function uw(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:uv,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw so.create("bad-app-name",{appName:String(s)});if(r||(r=aw()),!r)throw so.create("no-options");const i=sh.get(s);if(i){if(nh(r,i.options)&&nh(n,i.config))return i;throw so.create("duplicate-app",{appName:s})}const a=new ZF(s);for(const l of dv.values())a.addComponent(l);const o=new K8(r,n,a);return sh.set(s,o),o}function Kd(t=uv){const e=sh.get(t);if(!e&&t===uv&&aw())return uw();if(!e)throw so.create("no-app",{appName:t});return e}function Ws(t,e,r){var n;let s=(n=G8[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Si.warn(o.join(" "));return}lo(new _i(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q8="firebase-heartbeat-database",X8=1,vd="firebase-heartbeat-store";let mm=null;function dw(){return mm||(mm=f8(q8,X8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(vd)}catch(r){console.warn(r)}}}}).catch(t=>{throw so.create("idb-open",{originalErrorMessage:t.message})})),mm}async function Y8(t){try{const r=(await dw()).transaction(vd),n=await r.objectStore(vd).get(fw(t));return await r.done,n}catch(e){if(e instanceof Ea)Si.warn(e.message);else{const r=so.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Si.warn(r.message)}}}async function dE(t,e){try{const n=(await dw()).transaction(vd,"readwrite");await n.objectStore(vd).put(e,fw(t)),await n.done}catch(r){if(r instanceof Ea)Si.warn(r.message);else{const n=so.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Si.warn(n.message)}}}function fw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q8=1024,J8=30*24*60*60*1e3;class Z8{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new t6(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=fE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=J8}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Si.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=fE(),{heartbeatsToSend:n,unsentEntries:s}=e6(this._heartbeatsCache.heartbeats),i=rh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Si.warn(r),""}}}function fE(){return new Date().toISOString().substring(0,10)}function e6(t,e=Q8){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),hE(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),hE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class t6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VF()?HF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Y8(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return dE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return dE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function hE(t){return rh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r6(t){lo(new _i("platform-logger",e=>new m8(e),"PRIVATE")),lo(new _i("heartbeat",e=>new Z8(e),"PRIVATE")),Ws(cv,cE,t),Ws(cv,cE,"esm2017"),Ws("fire-js","")}r6("");function L1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function hw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pw=hw,mw=new Gd("auth","Firebase",hw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah=new O1("@firebase/auth");function n6(t,...e){ah.logLevel<=Yt.WARN&&ah.warn(`Auth (${pl}): ${t}`,...e)}function _0(t,...e){ah.logLevel<=Yt.ERROR&&ah.error(`Auth (${pl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(t,...e){throw U1(t,...e)}function pa(t,...e){return U1(t,...e)}function B1(t,e,r){const n=Object.assign(Object.assign({},pw()),{[e]:r});return new Gd("auth","Firebase",n).create(e,{appName:t.name})}function Go(t){return B1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function s6(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Ua(t,"argument-error"),B1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function U1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return mw.create(t,...e)}function Dt(t,e,...r){if(!t)throw U1(e,...r)}function li(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _0(e),new Error(e)}function Ai(t,e){t||li(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function a6(){return pE()==="http:"||pE()==="https:"}function pE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(a6()||LF()||"connection"in navigator)?navigator.onLine:!0}function o6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ai(r>e,"Short delay should be less than long delay!"),this.isMobile=NF()||BF()}get(){return i6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(t,e){Ai(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c6=new qd(3e4,6e4);function V1(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Bc(t,e,r,n,s={}){return vw(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=Wd(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return MF()||(c.referrerPolicy="no-referrer"),gw.fetch()(yw(t,t.config.apiHost,r,o),c)})}async function vw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},l6),e);try{const s=new d6(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Uf(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Uf(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Uf(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Uf(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw B1(t,u,c);Ua(t,u)}}catch(s){if(s instanceof Ea)throw s;Ua(t,"network-request-failed",{message:String(s)})}}async function u6(t,e,r,n,s={}){const i=await Bc(t,e,r,n,s);return"mfaPendingCredential"in i&&Ua(t,"multi-factor-auth-required",{_serverResponse:i}),i}function yw(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?$1(t.config,s):`${t.config.apiScheme}://${s}`}class d6{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(pa(this.auth,"network-request-failed")),c6.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Uf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=pa(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f6(t,e){return Bc(t,"POST","/v1/accounts:delete",e)}async function xw(t,e){return Bc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hv(t,e=!1){return dr(t).getIdToken(e)}async function Ew(t,e=!1){const r=dr(t),n=await r.getIdToken(e),s=H1(n);Dt(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:$u(gm(s.auth_time)),issuedAtTime:$u(gm(s.iat)),expirationTime:$u(gm(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function gm(t){return Number(t)*1e3}function H1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return _0("JWT malformed, contained fewer than 3 sections"),null;try{const s=nw(r);return s?JSON.parse(s):(_0("Failed to decode base64 JWT payload"),null)}catch(s){return _0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function mE(t){const e=H1(t);return Dt(e,"internal-error"),Dt(typeof e.exp<"u","internal-error"),Dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yd(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ea&&h6(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function h6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=$u(this.lastLoginAt),this.creationTime=$u(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ih(t){var e;const r=t.auth,n=await t.getIdToken(),s=await yd(t,xw(r,{idToken:n}));Dt(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?_w(i.providerUserInfo):[],o=m6(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new pv(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function bw(t){const e=dr(t);await ih(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function m6(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function _w(t){return t.map(e=>{var{providerId:r}=e,n=L1(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g6(t,e){const r=await vw(t,{},async()=>{const n=Wd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=yw(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",gw.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function v6(t,e){return Bc(t,"POST","/v2/accounts:revokeToken",V1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Dt(e.idToken,"internal-error"),Dt(typeof e.idToken<"u","internal-error"),Dt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):mE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Dt(e.length!==0,"internal-error");const r=mE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await g6(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new oc;return n&&(Dt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Dt(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Dt(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new oc,this.toJSON())}_performRefresh(){return li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(t,e){Dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ci{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=L1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new p6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new pv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await yd(this,this.stsTokenManager.getToken(this.auth,e));return Dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Ew(this,e)}reload(){return bw(this)}_assign(e){this!==e&&(Dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ci(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ih(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oi(this.auth.app))return Promise.reject(Go(this.auth));const e=await this.getIdToken();return await yd(this,f6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(s=r.email)!==null&&s!==void 0?s:void 0,p=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,g=(a=r.photoURL)!==null&&a!==void 0?a:void 0,y=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=r.createdAt)!==null&&c!==void 0?c:void 0,b=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:v,emailVerified:T,isAnonymous:D,providerData:k,stsTokenManager:S}=r;Dt(v&&S,e,"internal-error");const E=oc.fromJSON(this.name,S);Dt(typeof v=="string",e,"internal-error"),Li(f,e.name),Li(h,e.name),Dt(typeof T=="boolean",e,"internal-error"),Dt(typeof D=="boolean",e,"internal-error"),Li(p,e.name),Li(g,e.name),Li(y,e.name),Li(_,e.name),Li(x,e.name),Li(b,e.name);const m=new ci({uid:v,auth:e,email:h,emailVerified:T,displayName:f,isAnonymous:D,photoURL:g,phoneNumber:p,tenantId:y,stsTokenManager:E,createdAt:x,lastLoginAt:b});return k&&Array.isArray(k)&&(m.providerData=k.map(A=>Object.assign({},A))),_&&(m._redirectEventId=_),m}static async _fromIdTokenResponse(e,r,n=!1){const s=new oc;s.updateFromServerResponse(r);const i=new ci({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await ih(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Dt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?_w(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new oc;o.updateFromIdToken(n);const l=new ci({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new pv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE=new Map;function ui(t){Ai(t instanceof Function,"Expected a class definition");let e=gE.get(t);return e?(Ai(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,gE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Sw.type="NONE";const mv=Sw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(t,e,r){return`firebase:${t}:${e}:${r}`}class lc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=S0(this.userKey,s.apiKey,i),this.fullPersistenceKey=S0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ci._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new lc(ui(mv),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||ui(mv);const a=S0(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=ci._fromJSON(e,u);c!==i&&(o=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new lc(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new lc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Cw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Aw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kw(e))return"Blackberry";if(Dw(e))return"Webos";if(Tw(e))return"Safari";if((e.includes("chrome/")||ww(e))&&!e.includes("edge/"))return"Chrome";if(Iw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Aw(t=ts()){return/firefox\//i.test(t)}function Tw(t=ts()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ww(t=ts()){return/crios\//i.test(t)}function Cw(t=ts()){return/iemobile/i.test(t)}function Iw(t=ts()){return/android/i.test(t)}function kw(t=ts()){return/blackberry/i.test(t)}function Dw(t=ts()){return/webos/i.test(t)}function j1(t=ts()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function y6(t=ts()){var e;return j1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function x6(){return UF()&&document.documentMode===10}function Pw(t=ts()){return j1(t)||Iw(t)||Dw(t)||kw(t)||/windows phone/i.test(t)||Cw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(t,e=[]){let r;switch(t){case"Browser":r=vE(ts());break;case"Worker":r=`${vE(ts())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${pl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b6(t,e={}){return Bc(t,"GET","/v2/passwordPolicy",V1(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6=6;class S6{constructor(e){var r,n,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:_6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yE(this),this.idTokenSubscription=new yE(this),this.beforeStateQueue=new E6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ui(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await lc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await xw(this,{idToken:e}),n=await ci._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(oi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ih(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=o6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oi(this.app))return Promise.reject(Go(this));const r=e?dr(e):null;return r&&Dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oi(this.app)?Promise.reject(Go(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oi(this.app)?Promise.reject(Go(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ui(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await b6(this),r=new S6(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Gd("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await v6(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ui(e)||this._popupRedirectResolver;Dt(r,this,"argument-error"),this.redirectPersistenceManager=await lc.create(this,[ui(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Dt(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Rw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&n6(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function up(t){return dr(t)}class yE{constructor(e){this.auth=e,this.observer=null,this.addObserver=KF(r=>this.observer=r)}get next(){return Dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function T6(t){G1=t}function w6(t){return G1.loadJS(t)}function C6(){return G1.gapiScript}function I6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(t,e){const r=zd(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(nh(i,e??{}))return s;Ua(s,"already-initialized")}return r.initialize({options:e})}function k6(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ui);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function Nw(t,e,r){const n=up(t);Dt(n._canInitEmulator,n,"emulator-config-failed"),Dt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Ow(e),{host:a,port:o}=D6(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${i}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),P6()}function Ow(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function D6(t){const e=Ow(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:xE(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:xE(a)}}}function xE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function P6(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return li("not implemented")}_getIdTokenResponse(e){return li("not implemented")}_linkToIdToken(e,r){return li("not implemented")}_getReauthenticationResolver(e){return li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cc(t,e){return u6(t,"POST","/v1/accounts:signInWithIdp",V1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R6="http://localhost";class co extends W1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new co(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ua("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=L1(r,["providerId","signInMethod"]);if(!n||!s)return null;const a=new co(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return cc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,cc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,cc(e,r)}buildRequest(){const e={requestUri:R6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Wd(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends z1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends Xd{constructor(){super("facebook.com")}static credential(e){return co._fromParams({providerId:ni.PROVIDER_ID,signInMethod:ni.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ni.credentialFromTaggedObject(e)}static credentialFromError(e){return ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ni.credential(e.oauthAccessToken)}catch{return null}}}ni.FACEBOOK_SIGN_IN_METHOD="facebook.com";ni.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa extends Xd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return co._fromParams({providerId:oa.PROVIDER_ID,signInMethod:oa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return oa.credentialFromTaggedObject(e)}static credentialFromError(e){return oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return oa.credential(r,n)}catch{return null}}}oa.GOOGLE_SIGN_IN_METHOD="google.com";oa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si extends Xd{constructor(){super("github.com")}static credential(e){return co._fromParams({providerId:si.PROVIDER_ID,signInMethod:si.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return si.credentialFromTaggedObject(e)}static credentialFromError(e){return si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return si.credential(e.oauthAccessToken)}catch{return null}}}si.GITHUB_SIGN_IN_METHOD="github.com";si.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends Xd{constructor(){super("twitter.com")}static credential(e,r){return co._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ai.credential(r,n)}catch{return null}}}ai.TWITTER_SIGN_IN_METHOD="twitter.com";ai.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await ci._fromIdTokenResponse(e,n,s),a=EE(n);return new _c({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=EE(n);return new _c({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function EE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh extends Ea{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,oh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new oh(e,r,n,s)}}function Mw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?oh._fromErrorAndOperation(t,i,e,n):i})}async function F6(t,e,r=!1){const n=await yd(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return _c._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N6(t,e,r=!1){const{auth:n}=t;if(oi(n.app))return Promise.reject(Go(n));const s="reauthenticate";try{const i=await yd(t,Mw(n,s,e,t),r);Dt(i.idToken,n,"internal-error");const a=H1(i.idToken);Dt(a,n,"internal-error");const{sub:o}=a;return Dt(t.uid===o,n,"user-mismatch"),_c._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ua(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O6(t,e,r=!1){if(oi(t.app))return Promise.reject(Go(t));const n="signIn",s=await Mw(t,n,e),i=await _c._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function Lw(t,e,r,n){return dr(t).onIdTokenChanged(e,r,n)}function Bw(t,e,r){return dr(t).beforeAuthStateChanged(e,r)}function K1(t,e,r,n){return dr(t).onAuthStateChanged(e,r,n)}function dp(t){return dr(t).signOut()}const lh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(lh,"1"),this.storage.removeItem(lh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M6=1e3,L6=10;class $w extends Uw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Pw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);x6()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,L6):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},M6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}$w.type="LOCAL";const q1=$w;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw extends Uw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Vw.type="SESSION";const X1=Vw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new fp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await B6(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}fp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=Y1("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(h.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(){return window}function $6(t){Na().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(){return typeof Na().WorkerGlobalScope<"u"&&typeof Na().importScripts=="function"}async function V6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function H6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function j6(){return Hw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw="firebaseLocalStorageDb",G6=1,ch="firebaseLocalStorage",Gw="fbase_key";class Yd{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function hp(t,e){return t.transaction([ch],e?"readwrite":"readonly").objectStore(ch)}function W6(){const t=indexedDB.deleteDatabase(jw);return new Yd(t).toPromise()}function gv(){const t=indexedDB.open(jw,G6);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ch,{keyPath:Gw})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ch)?e(n):(n.close(),await W6(),e(await gv()))})})}async function bE(t,e,r){const n=hp(t,!0).put({[Gw]:e,value:r});return new Yd(n).toPromise()}async function z6(t,e){const r=hp(t,!1).get(e),n=await new Yd(r).toPromise();return n===void 0?null:n.value}function _E(t,e){const r=hp(t,!0).delete(e);return new Yd(r).toPromise()}const K6=800,q6=3;class Ww{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gv(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>q6)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=fp._getInstance(j6()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await V6(),!this.activeServiceWorker)return;this.sender=new U6(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||H6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gv();return await bE(e,lh,"1"),await _E(e,lh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>bE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>z6(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>_E(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=hp(s,!1).getAll();return new Yd(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),K6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ww.type="LOCAL";const zw=Ww;new qd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(t,e){return e?ui(e):(Dt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1 extends W1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return cc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return cc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return cc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function X6(t){return O6(t.auth,new Q1(t),t.bypassAuthState)}function Y6(t){const{auth:e,user:r}=t;return Dt(r,e,"internal-error"),N6(r,new Q1(t),t.bypassAuthState)}async function Q6(t){const{auth:e,user:r}=t;return Dt(r,e,"internal-error"),F6(r,new Q1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return X6;case"linkViaPopup":case"linkViaRedirect":return Q6;case"reauthViaPopup":case"reauthViaRedirect":return Y6;default:Ua(this.auth,"internal-error")}}resolve(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J6=new qd(2e3,1e4);async function J1(t,e,r){if(oi(t.app))return Promise.reject(pa(t,"operation-not-supported-in-this-environment"));const n=up(t);s6(t,e,z1);const s=Kw(n,r);return new Lo(n,"signInViaPopup",e,s).executeNotNull()}class Lo extends qw{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Lo.currentPopupAction&&Lo.currentPopupAction.cancel(),Lo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Dt(e,this.auth,"internal-error"),e}async onExecution(){Ai(this.filter.length===1,"Popup operations only handle one event");const e=Y1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(pa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(pa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,J6.get())};e()}}Lo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z6="pendingRedirect",A0=new Map;class e5 extends qw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=A0.get(this.auth._key());if(!e){try{const n=await t5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}A0.set(this.auth._key(),e)}return this.bypassAuthState||A0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function t5(t,e){const r=s5(e),n=n5(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function r5(t,e){A0.set(t._key(),e)}function n5(t){return ui(t._redirectPersistence)}function s5(t){return S0(Z6,t.config.apiKey,t.name)}async function a5(t,e,r=!1){if(oi(t.app))return Promise.reject(Go(t));const n=up(t),s=Kw(n,e),a=await new e5(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i5=10*60*1e3;class o5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!l5(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!Xw(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(pa(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i5&&this.cachedEventUids.clear(),this.cachedEventUids.has(SE(e))}saveEventToCache(e){this.cachedEventUids.add(SE(e)),this.lastProcessedEventTime=Date.now()}}function SE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Xw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function l5(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Xw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c5(t,e={}){return Bc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,d5=/^https?/;async function f5(t){if(t.config.emulator)return;const{authorizedDomains:e}=await c5(t);for(const r of e)try{if(h5(r))return}catch{}Ua(t,"unauthorized-domain")}function h5(t){const e=fv(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!d5.test(r))return!1;if(u5.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p5=new qd(3e4,6e4);function AE(){const t=Na().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function m5(t){return new Promise((e,r)=>{var n,s,i;function a(){AE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{AE(),r(pa(t,"network-request-failed"))},timeout:p5.get()})}if(!((s=(n=Na().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Na().gapi)===null||i===void 0)&&i.load)a();else{const o=I6("iframefcb");return Na()[o]=()=>{gapi.load?a():r(pa(t,"network-request-failed"))},w6(`${C6()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw T0=null,e})}let T0=null;function g5(t){return T0=T0||m5(t),T0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5=new qd(5e3,15e3),y5="__/auth/iframe",x5="emulator/auth/iframe",E5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},b5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _5(t){const e=t.config;Dt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?$1(e,x5):`https://${t.config.authDomain}/${y5}`,n={apiKey:e.apiKey,appName:t.name,v:pl},s=b5.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Wd(n).slice(1)}`}async function S5(t){const e=await g5(t),r=Na().gapi;return Dt(r,t,"internal-error"),e.open({where:document.body,url:_5(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:E5,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=pa(t,"network-request-failed"),o=Na().setTimeout(()=>{i(a)},v5.get());function l(){Na().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},T5=500,w5=600,C5="_blank",I5="http://localhost";class TE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function k5(t,e,r,n=T5,s=w5){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},A5),{width:n.toString(),height:s.toString(),top:i,left:a}),c=ts().toLowerCase();r&&(o=ww(c)?C5:r),Aw(c)&&(e=e||I5,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[p,g])=>`${h}${p}=${g},`,"");if(y6(c)&&o!=="_self")return D5(e||"",o),new TE(null);const f=window.open(e||"",o,u);Dt(f,t,"popup-blocked");try{f.focus()}catch{}return new TE(f)}function D5(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P5="__/auth/handler",R5="emulator/auth/handler",F5=encodeURIComponent("fac");async function wE(t,e,r,n,s,i){Dt(t.config.authDomain,t,"auth-domain-config-required"),Dt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:pl,eventId:s};if(e instanceof z1){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",zF(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries({}))a[u]=f}if(e instanceof Xd){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${F5}=${encodeURIComponent(l)}`:"";return`${N5(t)}?${Wd(o).slice(1)}${c}`}function N5({config:t}){return t.emulator?$1(t,R5):`https://${t.authDomain}/${P5}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm="webStorageSupport";class O5{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X1,this._completeRedirectFn=a5,this._overrideRedirectResult=r5}async _openPopup(e,r,n,s){var i;Ai((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await wE(e,r,n,fv(),s);return k5(e,a,Y1())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await wE(e,r,n,fv(),s);return $6(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Ai(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await S5(e),n=new o5(e);return r.register("authEvent",s=>(Dt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(vm,{type:vm},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[vm];a!==void 0&&r(!!a),Ua(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=f5(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Pw()||Tw()||j1()}}const Yw=O5;var CE="@firebase/auth",IE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B5(t){lo(new _i("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Dt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Rw(t)},c=new A6(n,s,i,l);return k6(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),lo(new _i("auth-internal",e=>{const r=up(e.getProvider("auth").getImmediate());return(n=>new M5(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ws(CE,IE,L5(t)),Ws(CE,IE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5=5*60,$5=iw("authIdTokenMaxAge")||U5;let kE=null;const V5=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>$5)return;const s=r==null?void 0:r.token;kE!==s&&(kE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function uo(t=Kd()){const e=zd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Fw(t,{popupRedirectResolver:Yw,persistence:[zw,q1,X1]}),n=iw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=V5(i.toString());Bw(r,a,()=>a(r.currentUser)),Lw(r,o=>a(o))}}const s=sw("auth");return s&&Nw(r,`http://${s}`),r}function H5(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}T6({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=pa("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",H5().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B5("Browser");const j5=Object.freeze(Object.defineProperty({__proto__:null,AuthCredential:W1,FacebookAuthProvider:ni,GithubAuthProvider:si,GoogleAuthProvider:oa,OAuthCredential:co,TwitterAuthProvider:ai,beforeAuthStateChanged:Bw,browserLocalPersistence:q1,browserPopupRedirectResolver:Yw,browserSessionPersistence:X1,connectAuthEmulator:Nw,getAuth:uo,getIdToken:hv,getIdTokenResult:Ew,inMemoryPersistence:mv,indexedDBLocalPersistence:zw,initializeAuth:Fw,onAuthStateChanged:K1,onIdTokenChanged:Lw,prodErrorMap:pw,reload:bw,signInWithPopup:J1,signOut:dp},Symbol.toStringTag,{value:"Module"}));var DE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wo,Qw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,E){function m(){}m.prototype=E.prototype,S.D=E.prototype,S.prototype=new m,S.prototype.constructor=S,S.C=function(A,I,C){for(var F=Array(arguments.length-2),W=2;W<arguments.length;W++)F[W-2]=arguments[W];return E.prototype[I].apply(A,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,E,m){m||(m=0);var A=Array(16);if(typeof E=="string")for(var I=0;16>I;++I)A[I]=E.charCodeAt(m++)|E.charCodeAt(m++)<<8|E.charCodeAt(m++)<<16|E.charCodeAt(m++)<<24;else for(I=0;16>I;++I)A[I]=E[m++]|E[m++]<<8|E[m++]<<16|E[m++]<<24;E=S.g[0],m=S.g[1],I=S.g[2];var C=S.g[3],F=E+(C^m&(I^C))+A[0]+3614090360&4294967295;E=m+(F<<7&4294967295|F>>>25),F=C+(I^E&(m^I))+A[1]+3905402710&4294967295,C=E+(F<<12&4294967295|F>>>20),F=I+(m^C&(E^m))+A[2]+606105819&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(E^I&(C^E))+A[3]+3250441966&4294967295,m=I+(F<<22&4294967295|F>>>10),F=E+(C^m&(I^C))+A[4]+4118548399&4294967295,E=m+(F<<7&4294967295|F>>>25),F=C+(I^E&(m^I))+A[5]+1200080426&4294967295,C=E+(F<<12&4294967295|F>>>20),F=I+(m^C&(E^m))+A[6]+2821735955&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(E^I&(C^E))+A[7]+4249261313&4294967295,m=I+(F<<22&4294967295|F>>>10),F=E+(C^m&(I^C))+A[8]+1770035416&4294967295,E=m+(F<<7&4294967295|F>>>25),F=C+(I^E&(m^I))+A[9]+2336552879&4294967295,C=E+(F<<12&4294967295|F>>>20),F=I+(m^C&(E^m))+A[10]+4294925233&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(E^I&(C^E))+A[11]+2304563134&4294967295,m=I+(F<<22&4294967295|F>>>10),F=E+(C^m&(I^C))+A[12]+1804603682&4294967295,E=m+(F<<7&4294967295|F>>>25),F=C+(I^E&(m^I))+A[13]+4254626195&4294967295,C=E+(F<<12&4294967295|F>>>20),F=I+(m^C&(E^m))+A[14]+2792965006&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(E^I&(C^E))+A[15]+1236535329&4294967295,m=I+(F<<22&4294967295|F>>>10),F=E+(I^C&(m^I))+A[1]+4129170786&4294967295,E=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(E^m))+A[6]+3225465664&4294967295,C=E+(F<<9&4294967295|F>>>23),F=I+(E^m&(C^E))+A[11]+643717713&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^E&(I^C))+A[0]+3921069994&4294967295,m=I+(F<<20&4294967295|F>>>12),F=E+(I^C&(m^I))+A[5]+3593408605&4294967295,E=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(E^m))+A[10]+38016083&4294967295,C=E+(F<<9&4294967295|F>>>23),F=I+(E^m&(C^E))+A[15]+3634488961&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^E&(I^C))+A[4]+3889429448&4294967295,m=I+(F<<20&4294967295|F>>>12),F=E+(I^C&(m^I))+A[9]+568446438&4294967295,E=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(E^m))+A[14]+3275163606&4294967295,C=E+(F<<9&4294967295|F>>>23),F=I+(E^m&(C^E))+A[3]+4107603335&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^E&(I^C))+A[8]+1163531501&4294967295,m=I+(F<<20&4294967295|F>>>12),F=E+(I^C&(m^I))+A[13]+2850285829&4294967295,E=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(E^m))+A[2]+4243563512&4294967295,C=E+(F<<9&4294967295|F>>>23),F=I+(E^m&(C^E))+A[7]+1735328473&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^E&(I^C))+A[12]+2368359562&4294967295,m=I+(F<<20&4294967295|F>>>12),F=E+(m^I^C)+A[5]+4294588738&4294967295,E=m+(F<<4&4294967295|F>>>28),F=C+(E^m^I)+A[8]+2272392833&4294967295,C=E+(F<<11&4294967295|F>>>21),F=I+(C^E^m)+A[11]+1839030562&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^E)+A[14]+4259657740&4294967295,m=I+(F<<23&4294967295|F>>>9),F=E+(m^I^C)+A[1]+2763975236&4294967295,E=m+(F<<4&4294967295|F>>>28),F=C+(E^m^I)+A[4]+1272893353&4294967295,C=E+(F<<11&4294967295|F>>>21),F=I+(C^E^m)+A[7]+4139469664&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^E)+A[10]+3200236656&4294967295,m=I+(F<<23&4294967295|F>>>9),F=E+(m^I^C)+A[13]+681279174&4294967295,E=m+(F<<4&4294967295|F>>>28),F=C+(E^m^I)+A[0]+3936430074&4294967295,C=E+(F<<11&4294967295|F>>>21),F=I+(C^E^m)+A[3]+3572445317&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^E)+A[6]+76029189&4294967295,m=I+(F<<23&4294967295|F>>>9),F=E+(m^I^C)+A[9]+3654602809&4294967295,E=m+(F<<4&4294967295|F>>>28),F=C+(E^m^I)+A[12]+3873151461&4294967295,C=E+(F<<11&4294967295|F>>>21),F=I+(C^E^m)+A[15]+530742520&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^E)+A[2]+3299628645&4294967295,m=I+(F<<23&4294967295|F>>>9),F=E+(I^(m|~C))+A[0]+4096336452&4294967295,E=m+(F<<6&4294967295|F>>>26),F=C+(m^(E|~I))+A[7]+1126891415&4294967295,C=E+(F<<10&4294967295|F>>>22),F=I+(E^(C|~m))+A[14]+2878612391&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~E))+A[5]+4237533241&4294967295,m=I+(F<<21&4294967295|F>>>11),F=E+(I^(m|~C))+A[12]+1700485571&4294967295,E=m+(F<<6&4294967295|F>>>26),F=C+(m^(E|~I))+A[3]+2399980690&4294967295,C=E+(F<<10&4294967295|F>>>22),F=I+(E^(C|~m))+A[10]+4293915773&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~E))+A[1]+2240044497&4294967295,m=I+(F<<21&4294967295|F>>>11),F=E+(I^(m|~C))+A[8]+1873313359&4294967295,E=m+(F<<6&4294967295|F>>>26),F=C+(m^(E|~I))+A[15]+4264355552&4294967295,C=E+(F<<10&4294967295|F>>>22),F=I+(E^(C|~m))+A[6]+2734768916&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~E))+A[13]+1309151649&4294967295,m=I+(F<<21&4294967295|F>>>11),F=E+(I^(m|~C))+A[4]+4149444226&4294967295,E=m+(F<<6&4294967295|F>>>26),F=C+(m^(E|~I))+A[11]+3174756917&4294967295,C=E+(F<<10&4294967295|F>>>22),F=I+(E^(C|~m))+A[2]+718787259&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~E))+A[9]+3951481745&4294967295,S.g[0]=S.g[0]+E&4294967295,S.g[1]=S.g[1]+(I+(F<<21&4294967295|F>>>11))&4294967295,S.g[2]=S.g[2]+I&4294967295,S.g[3]=S.g[3]+C&4294967295}n.prototype.u=function(S,E){E===void 0&&(E=S.length);for(var m=E-this.blockSize,A=this.B,I=this.h,C=0;C<E;){if(I==0)for(;C<=m;)s(this,S,C),C+=this.blockSize;if(typeof S=="string"){for(;C<E;)if(A[I++]=S.charCodeAt(C++),I==this.blockSize){s(this,A),I=0;break}}else for(;C<E;)if(A[I++]=S[C++],I==this.blockSize){s(this,A),I=0;break}}this.h=I,this.o+=E},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var E=1;E<S.length-8;++E)S[E]=0;var m=8*this.o;for(E=S.length-8;E<S.length;++E)S[E]=m&255,m/=256;for(this.u(S),S=Array(16),E=m=0;4>E;++E)for(var A=0;32>A;A+=8)S[m++]=this.g[E]>>>A&255;return S};function i(S,E){var m=o;return Object.prototype.hasOwnProperty.call(m,S)?m[S]:m[S]=E(S)}function a(S,E){this.h=E;for(var m=[],A=!0,I=S.length-1;0<=I;I--){var C=S[I]|0;A&&C==E||(m[I]=C,A=!1)}this.g=m}var o={};function l(S){return-128<=S&&128>S?i(S,function(E){return new a([E|0],0>E?-1:0)}):new a([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return f;if(0>S)return _(c(-S));for(var E=[],m=1,A=0;S>=m;A++)E[A]=S/m|0,m*=4294967296;return new a(E,0)}function u(S,E){if(S.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(S.charAt(0)=="-")return _(u(S.substring(1),E));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var m=c(Math.pow(E,8)),A=f,I=0;I<S.length;I+=8){var C=Math.min(8,S.length-I),F=parseInt(S.substring(I,I+C),E);8>C?(C=c(Math.pow(E,C)),A=A.j(C).add(c(F))):(A=A.j(m),A=A.add(c(F)))}return A}var f=l(0),h=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(y(this))return-_(this).m();for(var S=0,E=1,m=0;m<this.g.length;m++){var A=this.i(m);S+=(0<=A?A:4294967296+A)*E,E*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(g(this))return"0";if(y(this))return"-"+_(this).toString(S);for(var E=c(Math.pow(S,6)),m=this,A="";;){var I=T(m,E).g;m=x(m,I.j(E));var C=((0<m.g.length?m.g[0]:m.h)>>>0).toString(S);if(m=I,g(m))return C+A;for(;6>C.length;)C="0"+C;A=C+A}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function g(S){if(S.h!=0)return!1;for(var E=0;E<S.g.length;E++)if(S.g[E]!=0)return!1;return!0}function y(S){return S.h==-1}t.l=function(S){return S=x(this,S),y(S)?-1:g(S)?0:1};function _(S){for(var E=S.g.length,m=[],A=0;A<E;A++)m[A]=~S.g[A];return new a(m,~S.h).add(h)}t.abs=function(){return y(this)?_(this):this},t.add=function(S){for(var E=Math.max(this.g.length,S.g.length),m=[],A=0,I=0;I<=E;I++){var C=A+(this.i(I)&65535)+(S.i(I)&65535),F=(C>>>16)+(this.i(I)>>>16)+(S.i(I)>>>16);A=F>>>16,C&=65535,F&=65535,m[I]=F<<16|C}return new a(m,m[m.length-1]&-2147483648?-1:0)};function x(S,E){return S.add(_(E))}t.j=function(S){if(g(this)||g(S))return f;if(y(this))return y(S)?_(this).j(_(S)):_(_(this).j(S));if(y(S))return _(this.j(_(S)));if(0>this.l(p)&&0>S.l(p))return c(this.m()*S.m());for(var E=this.g.length+S.g.length,m=[],A=0;A<2*E;A++)m[A]=0;for(A=0;A<this.g.length;A++)for(var I=0;I<S.g.length;I++){var C=this.i(A)>>>16,F=this.i(A)&65535,W=S.i(I)>>>16,P=S.i(I)&65535;m[2*A+2*I]+=F*P,b(m,2*A+2*I),m[2*A+2*I+1]+=C*P,b(m,2*A+2*I+1),m[2*A+2*I+1]+=F*W,b(m,2*A+2*I+1),m[2*A+2*I+2]+=C*W,b(m,2*A+2*I+2)}for(A=0;A<E;A++)m[A]=m[2*A+1]<<16|m[2*A];for(A=E;A<2*E;A++)m[A]=0;return new a(m,0)};function b(S,E){for(;(S[E]&65535)!=S[E];)S[E+1]+=S[E]>>>16,S[E]&=65535,E++}function v(S,E){this.g=S,this.h=E}function T(S,E){if(g(E))throw Error("division by zero");if(g(S))return new v(f,f);if(y(S))return E=T(_(S),E),new v(_(E.g),_(E.h));if(y(E))return E=T(S,_(E)),new v(_(E.g),E.h);if(30<S.g.length){if(y(S)||y(E))throw Error("slowDivide_ only works with positive integers.");for(var m=h,A=E;0>=A.l(S);)m=D(m),A=D(A);var I=k(m,1),C=k(A,1);for(A=k(A,2),m=k(m,2);!g(A);){var F=C.add(A);0>=F.l(S)&&(I=I.add(m),C=F),A=k(A,1),m=k(m,1)}return E=x(S,I.j(E)),new v(I,E)}for(I=f;0<=S.l(E);){for(m=Math.max(1,Math.floor(S.m()/E.m())),A=Math.ceil(Math.log(m)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),C=c(m),F=C.j(E);y(F)||0<F.l(S);)m-=A,C=c(m),F=C.j(E);g(C)&&(C=h),I=I.add(C),S=x(S,F)}return new v(I,S)}t.A=function(S){return T(this,S).h},t.and=function(S){for(var E=Math.max(this.g.length,S.g.length),m=[],A=0;A<E;A++)m[A]=this.i(A)&S.i(A);return new a(m,this.h&S.h)},t.or=function(S){for(var E=Math.max(this.g.length,S.g.length),m=[],A=0;A<E;A++)m[A]=this.i(A)|S.i(A);return new a(m,this.h|S.h)},t.xor=function(S){for(var E=Math.max(this.g.length,S.g.length),m=[],A=0;A<E;A++)m[A]=this.i(A)^S.i(A);return new a(m,this.h^S.h)};function D(S){for(var E=S.g.length+1,m=[],A=0;A<E;A++)m[A]=S.i(A)<<1|S.i(A-1)>>>31;return new a(m,S.h)}function k(S,E){var m=E>>5;E%=32;for(var A=S.g.length-m,I=[],C=0;C<A;C++)I[C]=0<E?S.i(C+m)>>>E|S.i(C+m+1)<<32-E:S.i(C+m);return new a(I,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Qw=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Wo=a}).apply(typeof DE<"u"?DE:typeof self<"u"?self:typeof window<"u"?window:{});var $f=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Jw,xu,Zw,w0,vv,eC,tC,rC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,H,X){return w==Array.prototype||w==Object.prototype||(w[H]=X.value),w};function r(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof $f=="object"&&$f];for(var H=0;H<w.length;++H){var X=w[H];if(X&&X.Math==Math)return X}throw Error("Cannot find global object")}var n=r(this);function s(w,H){if(H)e:{var X=n;w=w.split(".");for(var oe=0;oe<w.length-1;oe++){var De=w[oe];if(!(De in X))break e;X=X[De]}w=w[w.length-1],oe=X[w],H=H(oe),H!=oe&&H!=null&&e(X,w,{configurable:!0,writable:!0,value:H})}}function i(w,H){w instanceof String&&(w+="");var X=0,oe=!1,De={next:function(){if(!oe&&X<w.length){var Ve=X++;return{value:H(Ve,w[Ve]),done:!1}}return oe=!0,{done:!0,value:void 0}}};return De[Symbol.iterator]=function(){return De},De}s("Array.prototype.values",function(w){return w||function(){return i(this,function(H,X){return X})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(w){var H=typeof w;return H=H!="object"?H:w?Array.isArray(w)?"array":H:"null",H=="array"||H=="object"&&typeof w.length=="number"}function c(w){var H=typeof w;return H=="object"&&w!=null||H=="function"}function u(w,H,X){return w.call.apply(w.bind,arguments)}function f(w,H,X){if(!w)throw Error();if(2<arguments.length){var oe=Array.prototype.slice.call(arguments,2);return function(){var De=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(De,oe),w.apply(H,De)}}return function(){return w.apply(H,arguments)}}function h(w,H,X){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,h.apply(null,arguments)}function p(w,H){var X=Array.prototype.slice.call(arguments,1);return function(){var oe=X.slice();return oe.push.apply(oe,arguments),w.apply(this,oe)}}function g(w,H){function X(){}X.prototype=H.prototype,w.aa=H.prototype,w.prototype=new X,w.prototype.constructor=w,w.Qb=function(oe,De,Ve){for(var rt=Array(arguments.length-2),yr=2;yr<arguments.length;yr++)rt[yr-2]=arguments[yr];return H.prototype[De].apply(oe,rt)}}function y(w){const H=w.length;if(0<H){const X=Array(H);for(let oe=0;oe<H;oe++)X[oe]=w[oe];return X}return[]}function _(w,H){for(let X=1;X<arguments.length;X++){const oe=arguments[X];if(l(oe)){const De=w.length||0,Ve=oe.length||0;w.length=De+Ve;for(let rt=0;rt<Ve;rt++)w[De+rt]=oe[rt]}else w.push(oe)}}class x{constructor(H,X){this.i=H,this.j=X,this.h=0,this.g=null}get(){let H;return 0<this.h?(this.h--,H=this.g,this.g=H.next,H.next=null):H=this.i(),H}}function b(w){return/^[\s\xa0]*$/.test(w)}function v(){var w=o.navigator;return w&&(w=w.userAgent)?w:""}function T(w){return T[" "](w),w}T[" "]=function(){};var D=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function k(w,H,X){for(const oe in w)H.call(X,w[oe],oe,w)}function S(w,H){for(const X in w)H.call(void 0,w[X],X,w)}function E(w){const H={};for(const X in w)H[X]=w[X];return H}const m="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(w,H){let X,oe;for(let De=1;De<arguments.length;De++){oe=arguments[De];for(X in oe)w[X]=oe[X];for(let Ve=0;Ve<m.length;Ve++)X=m[Ve],Object.prototype.hasOwnProperty.call(oe,X)&&(w[X]=oe[X])}}function I(w){var H=1;w=w.split(":");const X=[];for(;0<H&&w.length;)X.push(w.shift()),H--;return w.length&&X.push(w.join(":")),X}function C(w){o.setTimeout(()=>{throw w},0)}function F(){var w=O;let H=null;return w.g&&(H=w.g,w.g=w.g.next,w.g||(w.h=null),H.next=null),H}class W{constructor(){this.h=this.g=null}add(H,X){const oe=P.get();oe.set(H,X),this.h?this.h.next=oe:this.g=oe,this.h=oe}}var P=new x(()=>new R,w=>w.reset());class R{constructor(){this.next=this.g=this.h=null}set(H,X){this.h=H,this.g=X,this.next=null}reset(){this.next=this.g=this.h=null}}let N,L=!1,O=new W,V=()=>{const w=o.Promise.resolve(void 0);N=()=>{w.then(z)}};var z=()=>{for(var w;w=F();){try{w.h.call(w.g)}catch(X){C(X)}var H=P;H.j(w),100>H.h&&(H.h++,w.next=H.g,H.g=w)}L=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(w,H){this.type=w,this.g=this.target=H,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var w=!1,H=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const X=()=>{};o.addEventListener("test",X,H),o.removeEventListener("test",X,H)}catch{}return w}();function ee(w,H){if(G.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var X=this.type=w.type,oe=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=H,H=w.relatedTarget){if(D){e:{try{T(H.nodeName);var De=!0;break e}catch{}De=!1}De||(H=null)}}else X=="mouseover"?H=w.fromElement:X=="mouseout"&&(H=w.toElement);this.relatedTarget=H,oe?(this.clientX=oe.clientX!==void 0?oe.clientX:oe.pageX,this.clientY=oe.clientY!==void 0?oe.clientY:oe.pageY,this.screenX=oe.screenX||0,this.screenY=oe.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:ae[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&ee.aa.h.call(this)}}g(ee,G);var ae={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),le=0;function Z(w,H,X,oe,De){this.listener=w,this.proxy=null,this.src=H,this.type=X,this.capture=!!oe,this.ha=De,this.key=++le,this.da=this.fa=!1}function J(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function ge(w){this.src=w,this.g={},this.h=0}ge.prototype.add=function(w,H,X,oe,De){var Ve=w.toString();w=this.g[Ve],w||(w=this.g[Ve]=[],this.h++);var rt=K(w,H,oe,De);return-1<rt?(H=w[rt],X||(H.fa=!1)):(H=new Z(H,this.src,Ve,!!oe,De),H.fa=X,w.push(H)),H};function te(w,H){var X=H.type;if(X in w.g){var oe=w.g[X],De=Array.prototype.indexOf.call(oe,H,void 0),Ve;(Ve=0<=De)&&Array.prototype.splice.call(oe,De,1),Ve&&(J(H),w.g[X].length==0&&(delete w.g[X],w.h--))}}function K(w,H,X,oe){for(var De=0;De<w.length;++De){var Ve=w[De];if(!Ve.da&&Ve.listener==H&&Ve.capture==!!X&&Ve.ha==oe)return De}return-1}var Y="closure_lm_"+(1e6*Math.random()|0),fe={};function ye(w,H,X,oe,De){if(Array.isArray(H)){for(var Ve=0;Ve<H.length;Ve++)ye(w,H[Ve],X,oe,De);return null}return X=be(X),w&&w[ne]?w.K(H,X,c(oe)?!!oe.capture:!1,De):ie(w,H,X,!1,oe,De)}function ie(w,H,X,oe,De,Ve){if(!H)throw Error("Invalid event type");var rt=c(De)?!!De.capture:!!De,yr=ze(w);if(yr||(w[Y]=yr=new ge(w)),X=yr.add(H,X,oe,rt,Ve),X.proxy)return X;if(oe=ue(),X.proxy=oe,oe.src=w,oe.listener=X,w.addEventListener)j||(De=rt),De===void 0&&(De=!1),w.addEventListener(H.toString(),oe,De);else if(w.attachEvent)w.attachEvent(Pe(H.toString()),oe);else if(w.addListener&&w.removeListener)w.addListener(oe);else throw Error("addEventListener and attachEvent are unavailable.");return X}function ue(){function w(X){return H.call(w.src,w.listener,X)}const H=Te;return w}function Ee(w,H,X,oe,De){if(Array.isArray(H))for(var Ve=0;Ve<H.length;Ve++)Ee(w,H[Ve],X,oe,De);else oe=c(oe)?!!oe.capture:!!oe,X=be(X),w&&w[ne]?(w=w.i,H=String(H).toString(),H in w.g&&(Ve=w.g[H],X=K(Ve,X,oe,De),-1<X&&(J(Ve[X]),Array.prototype.splice.call(Ve,X,1),Ve.length==0&&(delete w.g[H],w.h--)))):w&&(w=ze(w))&&(H=w.g[H.toString()],w=-1,H&&(w=K(H,X,oe,De)),(X=-1<w?H[w]:null)&&Ce(X))}function Ce(w){if(typeof w!="number"&&w&&!w.da){var H=w.src;if(H&&H[ne])te(H.i,w);else{var X=w.type,oe=w.proxy;H.removeEventListener?H.removeEventListener(X,oe,w.capture):H.detachEvent?H.detachEvent(Pe(X),oe):H.addListener&&H.removeListener&&H.removeListener(oe),(X=ze(H))?(te(X,w),X.h==0&&(X.src=null,H[Y]=null)):J(w)}}}function Pe(w){return w in fe?fe[w]:fe[w]="on"+w}function Te(w,H){if(w.da)w=!0;else{H=new ee(H,this);var X=w.listener,oe=w.ha||w.src;w.fa&&Ce(w),w=X.call(oe,H)}return w}function ze(w){return w=w[Y],w instanceof ge?w:null}var Ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(w){return typeof w=="function"?w:(w[Ie]||(w[Ie]=function(H){return w.handleEvent(H)}),w[Ie])}function Me(){U.call(this),this.i=new ge(this),this.M=this,this.F=null}g(Me,U),Me.prototype[ne]=!0,Me.prototype.removeEventListener=function(w,H,X,oe){Ee(this,w,H,X,oe)};function Ke(w,H){var X,oe=w.F;if(oe)for(X=[];oe;oe=oe.F)X.push(oe);if(w=w.M,oe=H.type||H,typeof H=="string")H=new G(H,w);else if(H instanceof G)H.target=H.target||w;else{var De=H;H=new G(oe,w),A(H,De)}if(De=!0,X)for(var Ve=X.length-1;0<=Ve;Ve--){var rt=H.g=X[Ve];De=qe(rt,oe,!0,H)&&De}if(rt=H.g=w,De=qe(rt,oe,!0,H)&&De,De=qe(rt,oe,!1,H)&&De,X)for(Ve=0;Ve<X.length;Ve++)rt=H.g=X[Ve],De=qe(rt,oe,!1,H)&&De}Me.prototype.N=function(){if(Me.aa.N.call(this),this.i){var w=this.i,H;for(H in w.g){for(var X=w.g[H],oe=0;oe<X.length;oe++)J(X[oe]);delete w.g[H],w.h--}}this.F=null},Me.prototype.K=function(w,H,X,oe){return this.i.add(String(w),H,!1,X,oe)},Me.prototype.L=function(w,H,X,oe){return this.i.add(String(w),H,!0,X,oe)};function qe(w,H,X,oe){if(H=w.i.g[String(H)],!H)return!0;H=H.concat();for(var De=!0,Ve=0;Ve<H.length;++Ve){var rt=H[Ve];if(rt&&!rt.da&&rt.capture==X){var yr=rt.listener,An=rt.ha||rt.src;rt.fa&&te(w.i,rt),De=yr.call(An,oe)!==!1&&De}}return De&&!oe.defaultPrevented}function Se(w,H,X){if(typeof w=="function")X&&(w=h(w,X));else if(w&&typeof w.handleEvent=="function")w=h(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(H)?-1:o.setTimeout(w,H||0)}function xe(w){w.g=Se(()=>{w.g=null,w.i&&(w.i=!1,xe(w))},w.l);const H=w.h;w.h=null,w.m.apply(null,H)}class Ae extends U{constructor(H,X){super(),this.m=H,this.l=X,this.h=null,this.i=!1,this.g=null}j(H){this.h=arguments,this.g?this.i=!0:xe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Le(w){U.call(this),this.h=w,this.g={}}g(Le,U);var We=[];function $e(w){k(w.g,function(H,X){this.g.hasOwnProperty(X)&&Ce(H)},w),w.g={}}Le.prototype.N=function(){Le.aa.N.call(this),$e(this)},Le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dt=o.JSON.stringify,xt=o.JSON.parse,Vt=class{stringify(w){return o.JSON.stringify(w,void 0)}parse(w){return o.JSON.parse(w,void 0)}};function pt(){}pt.prototype.h=null;function ct(w){return w.h||(w.h=w.i())}function mt(){}var Ct={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Rt(){G.call(this,"d")}g(Rt,G);function mr(){G.call(this,"c")}g(mr,G);var mn={},Qs=null;function ms(){return Qs=Qs||new Me}mn.La="serverreachability";function wl(w){G.call(this,mn.La,w)}g(wl,G);function za(w){const H=ms();Ke(H,new wl(H))}mn.STAT_EVENT="statevent";function So(w,H){G.call(this,mn.STAT_EVENT,w),this.stat=H}g(So,G);function ln(w){const H=ms();Ke(H,new So(H,w))}mn.Ma="timingevent";function Ao(w,H){G.call(this,mn.Ma,w),this.size=H}g(Ao,G);function Rr(w,H){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){w()},H)}function Ln(){this.g=!0}Ln.prototype.xa=function(){this.g=!1};function Cl(w,H,X,oe,De,Ve){w.info(function(){if(w.g)if(Ve)for(var rt="",yr=Ve.split("&"),An=0;An<yr.length;An++){var or=yr[An].split("=");if(1<or.length){var Bn=or[0];or=or[1];var Un=Bn.split("_");rt=2<=Un.length&&Un[1]=="type"?rt+(Bn+"="+or+"&"):rt+(Bn+"=redacted&")}}else rt=null;else rt=Ve;return"XMLHTTP REQ ("+oe+") [attempt "+De+"]: "+H+`
`+X+`
`+rt})}function Xc(w,H,X,oe,De,Ve,rt){w.info(function(){return"XMLHTTP RESP ("+oe+") [ attempt "+De+"]: "+H+`
`+X+`
`+Ve+" "+rt})}function re(w,H,X,oe){w.info(function(){return"XMLHTTP TEXT ("+H+"): "+ce(w,X)+(oe?" "+oe:"")})}function he(w,H){w.info(function(){return"TIMEOUT: "+H})}Ln.prototype.info=function(){};function ce(w,H){if(!w.g)return H;if(!H)return null;try{var X=JSON.parse(H);if(X){for(w=0;w<X.length;w++)if(Array.isArray(X[w])){var oe=X[w];if(!(2>oe.length)){var De=oe[1];if(Array.isArray(De)&&!(1>De.length)){var Ve=De[0];if(Ve!="noop"&&Ve!="stop"&&Ve!="close")for(var rt=1;rt<De.length;rt++)De[rt]=""}}}}return dt(X)}catch{return H}}var de={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},me;function Fe(){}g(Fe,pt),Fe.prototype.g=function(){return new XMLHttpRequest},Fe.prototype.i=function(){return{}},me=new Fe;function je(w,H,X,oe){this.j=w,this.i=H,this.l=X,this.R=oe||1,this.U=new Le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ne}function Ne(){this.i=null,this.g="",this.h=!1}var Be={},Ue={};function Je(w,H,X){w.L=1,w.v=Ef(qa(H)),w.m=X,w.P=!0,tt(w,null)}function tt(w,H){w.F=Date.now(),it(w),w.A=qa(w.v);var X=w.A,oe=w.R;Array.isArray(oe)||(oe=[String(oe)]),qx(X.i,"t",oe),w.C=0,X=w.j.J,w.h=new Ne,w.g=f2(w.j,X?H:null,!w.m),0<w.O&&(w.M=new Ae(h(w.Y,w,w.g),w.O)),H=w.U,X=w.g,oe=w.ca;var De="readystatechange";Array.isArray(De)||(De&&(We[0]=De.toString()),De=We);for(var Ve=0;Ve<De.length;Ve++){var rt=ye(X,De[Ve],oe||H.handleEvent,!1,H.h||H);if(!rt)break;H.g[rt.key]=rt}H=w.H?E(w.H):{},w.m?(w.u||(w.u="POST"),H["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,H)):(w.u="GET",w.g.ea(w.A,w.u,null,H)),za(),Cl(w.i,w.u,w.A,w.l,w.R,w.m)}je.prototype.ca=function(w){w=w.target;const H=this.M;H&&Xa(w)==3?H.j():this.Y(w)},je.prototype.Y=function(w){try{if(w==this.g)e:{const Un=Xa(this.g);var H=this.g.Ba();const Pl=this.g.Z();if(!(3>Un)&&(Un!=3||this.g&&(this.h.h||this.g.oa()||t2(this.g)))){this.J||Un!=4||H==7||(H==8||0>=Pl?za(3):za(2)),vr(this);var X=this.g.Z();this.X=X;t:if(ut(this)){var oe=t2(this.g);w="";var De=oe.length,Ve=Xa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ir(this),hr(this);var rt="";break t}this.h.i=new o.TextDecoder}for(H=0;H<De;H++)this.h.h=!0,w+=this.h.i.decode(oe[H],{stream:!(Ve&&H==De-1)});oe.length=0,this.h.g+=w,this.C=0,rt=this.h.g}else rt=this.g.oa();if(this.o=X==200,Xc(this.i,this.u,this.A,this.l,this.R,Un,X),this.o){if(this.T&&!this.K){t:{if(this.g){var yr,An=this.g;if((yr=An.g?An.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(yr)){var or=yr;break t}}or=null}if(X=or)re(this.i,this.l,X,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ka(this,X);else{this.o=!1,this.s=3,ln(12),Ir(this),hr(this);break e}}if(this.P){X=!0;let Js;for(;!this.J&&this.C<rt.length;)if(Js=Ze(this,rt),Js==Ue){Un==4&&(this.s=4,ln(14),X=!1),re(this.i,this.l,null,"[Incomplete Response]");break}else if(Js==Be){this.s=4,ln(15),re(this.i,this.l,rt,"[Invalid Chunk]"),X=!1;break}else re(this.i,this.l,Js,null),Ka(this,Js);if(ut(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Un!=4||rt.length!=0||this.h.h||(this.s=1,ln(16),X=!1),this.o=this.o&&X,!X)re(this.i,this.l,rt,"[Invalid Chunked Response]"),Ir(this),hr(this);else if(0<rt.length&&!this.W){this.W=!0;var Bn=this.j;Bn.g==this&&Bn.ba&&!Bn.M&&(Bn.j.info("Great, no buffering proxy detected. Bytes received: "+rt.length),Yp(Bn),Bn.M=!0,ln(11))}}else re(this.i,this.l,rt,null),Ka(this,rt);Un==4&&Ir(this),this.o&&!this.J&&(Un==4?l2(this.j,this):(this.o=!1,it(this)))}else VD(this.g),X==400&&0<rt.indexOf("Unknown SID")?(this.s=3,ln(12)):(this.s=0,ln(13)),Ir(this),hr(this)}}}catch{}finally{}};function ut(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function Ze(w,H){var X=w.C,oe=H.indexOf(`
`,X);return oe==-1?Ue:(X=Number(H.substring(X,oe)),isNaN(X)?Be:(oe+=1,oe+X>H.length?Ue:(H=H.slice(oe,oe+X),w.C=oe+X,H)))}je.prototype.cancel=function(){this.J=!0,Ir(this)};function it(w){w.S=Date.now()+w.I,kt(w,w.I)}function kt(w,H){if(w.B!=null)throw Error("WatchDog timer not null");w.B=Rr(h(w.ba,w),H)}function vr(w){w.B&&(o.clearTimeout(w.B),w.B=null)}je.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(he(this.i,this.A),this.L!=2&&(za(),ln(17)),Ir(this),this.s=2,hr(this)):kt(this,this.S-w)};function hr(w){w.j.G==0||w.J||l2(w.j,w)}function Ir(w){vr(w);var H=w.M;H&&typeof H.ma=="function"&&H.ma(),w.M=null,$e(w.U),w.g&&(H=w.g,w.g=null,H.abort(),H.ma())}function Ka(w,H){try{var X=w.j;if(X.G!=0&&(X.g==w||ws(X.h,w))){if(!w.K&&ws(X.h,w)&&X.G==3){try{var oe=X.Da.g.parse(H)}catch{oe=null}if(Array.isArray(oe)&&oe.length==3){var De=oe;if(De[0]==0){e:if(!X.u){if(X.g)if(X.g.F+3e3<w.F)wf(X),Af(X);else break e;Xp(X),ln(18)}}else X.za=De[1],0<X.za-X.T&&37500>De[2]&&X.F&&X.v==0&&!X.C&&(X.C=Rr(h(X.Za,X),6e3));if(1>=Il(X.h)&&X.ca){try{X.ca()}catch{}X.ca=void 0}}else Co(X,11)}else if((w.K||X.g==w)&&wf(X),!b(H))for(De=X.Da.g.parse(H),H=0;H<De.length;H++){let or=De[H];if(X.T=or[0],or=or[1],X.G==2)if(or[0]=="c"){X.K=or[1],X.ia=or[2];const Bn=or[3];Bn!=null&&(X.la=Bn,X.j.info("VER="+X.la));const Un=or[4];Un!=null&&(X.Aa=Un,X.j.info("SVER="+X.Aa));const Pl=or[5];Pl!=null&&typeof Pl=="number"&&0<Pl&&(oe=1.5*Pl,X.L=oe,X.j.info("backChannelRequestTimeoutMs_="+oe)),oe=X;const Js=w.g;if(Js){const If=Js.g?Js.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(If){var Ve=oe.h;Ve.g||If.indexOf("spdy")==-1&&If.indexOf("quic")==-1&&If.indexOf("h2")==-1||(Ve.j=Ve.l,Ve.g=new Set,Ve.h&&(zp(Ve,Ve.h),Ve.h=null))}if(oe.D){const Qp=Js.g?Js.g.getResponseHeader("X-HTTP-Session-Id"):null;Qp&&(oe.ya=Qp,wr(oe.I,oe.D,Qp))}}X.G=3,X.l&&X.l.ua(),X.ba&&(X.R=Date.now()-w.F,X.j.info("Handshake RTT: "+X.R+"ms")),oe=X;var rt=w;if(oe.qa=d2(oe,oe.J?oe.ia:null,oe.W),rt.K){$x(oe.h,rt);var yr=rt,An=oe.L;An&&(yr.I=An),yr.B&&(vr(yr),it(yr)),oe.g=rt}else i2(oe);0<X.i.length&&Tf(X)}else or[0]!="stop"&&or[0]!="close"||Co(X,7);else X.G==3&&(or[0]=="stop"||or[0]=="close"?or[0]=="stop"?Co(X,7):qp(X):or[0]!="noop"&&X.l&&X.l.ta(or),X.v=0)}}za(4)}catch{}}var To=class{constructor(w,H){this.g=w,this.map=H}};function Fi(w){this.l=w||10,o.PerformanceNavigationTiming?(w=o.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Sa(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function Il(w){return w.h?1:w.g?w.g.size:0}function ws(w,H){return w.h?w.h==H:w.g?w.g.has(H):!1}function zp(w,H){w.g?w.g.add(H):w.h=H}function $x(w,H){w.h&&w.h==H?w.h=null:w.g&&w.g.has(H)&&w.g.delete(H)}Fi.prototype.cancel=function(){if(this.i=Vx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Vx(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let H=w.i;for(const X of w.g.values())H=H.concat(X.D);return H}return y(w.i)}function wD(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map<"u"&&w instanceof Map||typeof Set<"u"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(l(w)){for(var H=[],X=w.length,oe=0;oe<X;oe++)H.push(w[oe]);return H}H=[],X=0;for(oe in w)H[X++]=w[oe];return H}function CD(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map<"u"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set<"u"&&w instanceof Set)){if(l(w)||typeof w=="string"){var H=[];w=w.length;for(var X=0;X<w;X++)H.push(X);return H}H=[],X=0;for(const oe in w)H[X++]=oe;return H}}}function Hx(w,H){if(w.forEach&&typeof w.forEach=="function")w.forEach(H,void 0);else if(l(w)||typeof w=="string")Array.prototype.forEach.call(w,H,void 0);else for(var X=CD(w),oe=wD(w),De=oe.length,Ve=0;Ve<De;Ve++)H.call(void 0,oe[Ve],X&&X[Ve],w)}var jx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ID(w,H){if(w){w=w.split("&");for(var X=0;X<w.length;X++){var oe=w[X].indexOf("="),De=null;if(0<=oe){var Ve=w[X].substring(0,oe);De=w[X].substring(oe+1)}else Ve=w[X];H(Ve,De?decodeURIComponent(De.replace(/\+/g," ")):"")}}}function wo(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof wo){this.h=w.h,yf(this,w.j),this.o=w.o,this.g=w.g,xf(this,w.s),this.l=w.l;var H=w.i,X=new Jc;X.i=H.i,H.g&&(X.g=new Map(H.g),X.h=H.h),Gx(this,X),this.m=w.m}else w&&(H=String(w).match(jx))?(this.h=!1,yf(this,H[1]||"",!0),this.o=Yc(H[2]||""),this.g=Yc(H[3]||"",!0),xf(this,H[4]),this.l=Yc(H[5]||"",!0),Gx(this,H[6]||"",!0),this.m=Yc(H[7]||"")):(this.h=!1,this.i=new Jc(null,this.h))}wo.prototype.toString=function(){var w=[],H=this.j;H&&w.push(Qc(H,Wx,!0),":");var X=this.g;return(X||H=="file")&&(w.push("//"),(H=this.o)&&w.push(Qc(H,Wx,!0),"@"),w.push(encodeURIComponent(String(X)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),X=this.s,X!=null&&w.push(":",String(X))),(X=this.l)&&(this.g&&X.charAt(0)!="/"&&w.push("/"),w.push(Qc(X,X.charAt(0)=="/"?PD:DD,!0))),(X=this.i.toString())&&w.push("?",X),(X=this.m)&&w.push("#",Qc(X,FD)),w.join("")};function qa(w){return new wo(w)}function yf(w,H,X){w.j=X?Yc(H,!0):H,w.j&&(w.j=w.j.replace(/:$/,""))}function xf(w,H){if(H){if(H=Number(H),isNaN(H)||0>H)throw Error("Bad port number "+H);w.s=H}else w.s=null}function Gx(w,H,X){H instanceof Jc?(w.i=H,ND(w.i,w.h)):(X||(H=Qc(H,RD)),w.i=new Jc(H,w.h))}function wr(w,H,X){w.i.set(H,X)}function Ef(w){return wr(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function Yc(w,H){return w?H?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Qc(w,H,X){return typeof w=="string"?(w=encodeURI(w).replace(H,kD),X&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function kD(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var Wx=/[#\/\?@]/g,DD=/[#\?:]/g,PD=/[#\?]/g,RD=/[#\?@]/g,FD=/#/g;function Jc(w,H){this.h=this.g=null,this.i=w||null,this.j=!!H}function Ni(w){w.g||(w.g=new Map,w.h=0,w.i&&ID(w.i,function(H,X){w.add(decodeURIComponent(H.replace(/\+/g," ")),X)}))}t=Jc.prototype,t.add=function(w,H){Ni(this),this.i=null,w=kl(this,w);var X=this.g.get(w);return X||this.g.set(w,X=[]),X.push(H),this.h+=1,this};function zx(w,H){Ni(w),H=kl(w,H),w.g.has(H)&&(w.i=null,w.h-=w.g.get(H).length,w.g.delete(H))}function Kx(w,H){return Ni(w),H=kl(w,H),w.g.has(H)}t.forEach=function(w,H){Ni(this),this.g.forEach(function(X,oe){X.forEach(function(De){w.call(H,De,oe,this)},this)},this)},t.na=function(){Ni(this);const w=Array.from(this.g.values()),H=Array.from(this.g.keys()),X=[];for(let oe=0;oe<H.length;oe++){const De=w[oe];for(let Ve=0;Ve<De.length;Ve++)X.push(H[oe])}return X},t.V=function(w){Ni(this);let H=[];if(typeof w=="string")Kx(this,w)&&(H=H.concat(this.g.get(kl(this,w))));else{w=Array.from(this.g.values());for(let X=0;X<w.length;X++)H=H.concat(w[X])}return H},t.set=function(w,H){return Ni(this),this.i=null,w=kl(this,w),Kx(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[H]),this.h+=1,this},t.get=function(w,H){return w?(w=this.V(w),0<w.length?String(w[0]):H):H};function qx(w,H,X){zx(w,H),0<X.length&&(w.i=null,w.g.set(kl(w,H),y(X)),w.h+=X.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],H=Array.from(this.g.keys());for(var X=0;X<H.length;X++){var oe=H[X];const Ve=encodeURIComponent(String(oe)),rt=this.V(oe);for(oe=0;oe<rt.length;oe++){var De=Ve;rt[oe]!==""&&(De+="="+encodeURIComponent(String(rt[oe]))),w.push(De)}}return this.i=w.join("&")};function kl(w,H){return H=String(H),w.j&&(H=H.toLowerCase()),H}function ND(w,H){H&&!w.j&&(Ni(w),w.i=null,w.g.forEach(function(X,oe){var De=oe.toLowerCase();oe!=De&&(zx(this,oe),qx(this,De,X))},w)),w.j=H}function OD(w,H){const X=new Ln;if(o.Image){const oe=new Image;oe.onload=p(Oi,X,"TestLoadImage: loaded",!0,H,oe),oe.onerror=p(Oi,X,"TestLoadImage: error",!1,H,oe),oe.onabort=p(Oi,X,"TestLoadImage: abort",!1,H,oe),oe.ontimeout=p(Oi,X,"TestLoadImage: timeout",!1,H,oe),o.setTimeout(function(){oe.ontimeout&&oe.ontimeout()},1e4),oe.src=w}else H(!1)}function MD(w,H){const X=new Ln,oe=new AbortController,De=setTimeout(()=>{oe.abort(),Oi(X,"TestPingServer: timeout",!1,H)},1e4);fetch(w,{signal:oe.signal}).then(Ve=>{clearTimeout(De),Ve.ok?Oi(X,"TestPingServer: ok",!0,H):Oi(X,"TestPingServer: server error",!1,H)}).catch(()=>{clearTimeout(De),Oi(X,"TestPingServer: error",!1,H)})}function Oi(w,H,X,oe,De){try{De&&(De.onload=null,De.onerror=null,De.onabort=null,De.ontimeout=null),oe(X)}catch{}}function LD(){this.g=new Vt}function BD(w,H,X){const oe=X||"";try{Hx(w,function(De,Ve){let rt=De;c(De)&&(rt=dt(De)),H.push(oe+Ve+"="+encodeURIComponent(rt))})}catch(De){throw H.push(oe+"type="+encodeURIComponent("_badmap")),De}}function bf(w){this.l=w.Ub||null,this.j=w.eb||!1}g(bf,pt),bf.prototype.g=function(){return new _f(this.l,this.j)},bf.prototype.i=function(w){return function(){return w}}({});function _f(w,H){Me.call(this),this.D=w,this.o=H,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(_f,Me),t=_f.prototype,t.open=function(w,H){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=H,this.readyState=1,eu(this)},t.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const H={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(H.body=w),(this.D||o).fetch(new Request(this.A,H)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zc(this)),this.readyState=0},t.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,eu(this)),this.g&&(this.readyState=3,eu(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Xx(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function Xx(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}t.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var H=w.value?w.value:new Uint8Array(0);(H=this.v.decode(H,{stream:!w.done}))&&(this.response=this.responseText+=H)}w.done?Zc(this):eu(this),this.readyState==3&&Xx(this)}},t.Ra=function(w){this.g&&(this.response=this.responseText=w,Zc(this))},t.Qa=function(w){this.g&&(this.response=w,Zc(this))},t.ga=function(){this.g&&Zc(this)};function Zc(w){w.readyState=4,w.l=null,w.j=null,w.v=null,eu(w)}t.setRequestHeader=function(w,H){this.u.append(w,H)},t.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],H=this.h.entries();for(var X=H.next();!X.done;)X=X.value,w.push(X[0]+": "+X[1]),X=H.next();return w.join(`\r
`)};function eu(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(_f.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function Yx(w){let H="";return k(w,function(X,oe){H+=oe,H+=":",H+=X,H+=`\r
`}),H}function Kp(w,H,X){e:{for(oe in X){var oe=!1;break e}oe=!0}oe||(X=Yx(X),typeof w=="string"?X!=null&&encodeURIComponent(String(X)):wr(w,H,X))}function Mr(w){Me.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Mr,Me);var UD=/^https?$/i,$D=["POST","PUT"];t=Mr.prototype,t.Ha=function(w){this.J=w},t.ea=function(w,H,X,oe){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);H=H?H.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():me.g(),this.v=this.o?ct(this.o):ct(me),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(H,String(w),!0),this.B=!1}catch(Ve){Qx(this,Ve);return}if(w=X||"",X=new Map(this.headers),oe)if(Object.getPrototypeOf(oe)===Object.prototype)for(var De in oe)X.set(De,oe[De]);else if(typeof oe.keys=="function"&&typeof oe.get=="function")for(const Ve of oe.keys())X.set(Ve,oe.get(Ve));else throw Error("Unknown input type for opt_headers: "+String(oe));oe=Array.from(X.keys()).find(Ve=>Ve.toLowerCase()=="content-type"),De=o.FormData&&w instanceof o.FormData,!(0<=Array.prototype.indexOf.call($D,H,void 0))||oe||De||X.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ve,rt]of X)this.g.setRequestHeader(Ve,rt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{e2(this),this.u=!0,this.g.send(w),this.u=!1}catch(Ve){Qx(this,Ve)}};function Qx(w,H){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=H,w.m=5,Jx(w),Sf(w)}function Jx(w){w.A||(w.A=!0,Ke(w,"complete"),Ke(w,"error"))}t.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,Ke(this,"complete"),Ke(this,"abort"),Sf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Sf(this,!0)),Mr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Zx(this):this.bb())},t.bb=function(){Zx(this)};function Zx(w){if(w.h&&typeof a<"u"&&(!w.v[1]||Xa(w)!=4||w.Z()!=2)){if(w.u&&Xa(w)==4)Se(w.Ea,0,w);else if(Ke(w,"readystatechange"),Xa(w)==4){w.h=!1;try{const rt=w.Z();e:switch(rt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var H=!0;break e;default:H=!1}var X;if(!(X=H)){var oe;if(oe=rt===0){var De=String(w.D).match(jx)[1]||null;!De&&o.self&&o.self.location&&(De=o.self.location.protocol.slice(0,-1)),oe=!UD.test(De?De.toLowerCase():"")}X=oe}if(X)Ke(w,"complete"),Ke(w,"success");else{w.m=6;try{var Ve=2<Xa(w)?w.g.statusText:""}catch{Ve=""}w.l=Ve+" ["+w.Z()+"]",Jx(w)}}finally{Sf(w)}}}}function Sf(w,H){if(w.g){e2(w);const X=w.g,oe=w.v[0]?()=>{}:null;w.g=null,w.v=null,H||Ke(w,"ready");try{X.onreadystatechange=oe}catch{}}}function e2(w){w.I&&(o.clearTimeout(w.I),w.I=null)}t.isActive=function(){return!!this.g};function Xa(w){return w.g?w.g.readyState:0}t.Z=function(){try{return 2<Xa(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(w){if(this.g){var H=this.g.responseText;return w&&H.indexOf(w)==0&&(H=H.substring(w.length)),xt(H)}};function t2(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function VD(w){const H={};w=(w.g&&2<=Xa(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let oe=0;oe<w.length;oe++){if(b(w[oe]))continue;var X=I(w[oe]);const De=X[0];if(X=X[1],typeof X!="string")continue;X=X.trim();const Ve=H[De]||[];H[De]=Ve,Ve.push(X)}S(H,function(oe){return oe.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function tu(w,H,X){return X&&X.internalChannelParams&&X.internalChannelParams[w]||H}function r2(w){this.Aa=0,this.i=[],this.j=new Ln,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=tu("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=tu("baseRetryDelayMs",5e3,w),this.cb=tu("retryDelaySeedMs",1e4,w),this.Wa=tu("forwardChannelMaxRetries",2,w),this.wa=tu("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new Fi(w&&w.concurrentRequestLimit),this.Da=new LD,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=r2.prototype,t.la=8,t.G=1,t.connect=function(w,H,X,oe){ln(0),this.W=w,this.H=H||{},X&&oe!==void 0&&(this.H.OSID=X,this.H.OAID=oe),this.F=this.X,this.I=d2(this,null,this.W),Tf(this)};function qp(w){if(n2(w),w.G==3){var H=w.U++,X=qa(w.I);if(wr(X,"SID",w.K),wr(X,"RID",H),wr(X,"TYPE","terminate"),ru(w,X),H=new je(w,w.j,H),H.L=2,H.v=Ef(qa(X)),X=!1,o.navigator&&o.navigator.sendBeacon)try{X=o.navigator.sendBeacon(H.v.toString(),"")}catch{}!X&&o.Image&&(new Image().src=H.v,X=!0),X||(H.g=f2(H.j,null),H.g.ea(H.v)),H.F=Date.now(),it(H)}u2(w)}function Af(w){w.g&&(Yp(w),w.g.cancel(),w.g=null)}function n2(w){Af(w),w.u&&(o.clearTimeout(w.u),w.u=null),wf(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&o.clearTimeout(w.s),w.s=null)}function Tf(w){if(!Sa(w.h)&&!w.s){w.s=!0;var H=w.Ga;N||V(),L||(N(),L=!0),O.add(H,w),w.B=0}}function HD(w,H){return Il(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=H.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=Rr(h(w.Ga,w,H),c2(w,w.B)),w.B++,!0)}t.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const De=new je(this,this.j,w);let Ve=this.o;if(this.S&&(Ve?(Ve=E(Ve),A(Ve,this.S)):Ve=this.S),this.m!==null||this.O||(De.H=Ve,Ve=null),this.P)e:{for(var H=0,X=0;X<this.i.length;X++){t:{var oe=this.i[X];if("__data__"in oe.map&&(oe=oe.map.__data__,typeof oe=="string")){oe=oe.length;break t}oe=void 0}if(oe===void 0)break;if(H+=oe,4096<H){H=X;break e}if(H===4096||X===this.i.length-1){H=X+1;break e}}H=1e3}else H=1e3;H=a2(this,De,H),X=qa(this.I),wr(X,"RID",w),wr(X,"CVER",22),this.D&&wr(X,"X-HTTP-Session-Id",this.D),ru(this,X),Ve&&(this.O?H="headers="+encodeURIComponent(String(Yx(Ve)))+"&"+H:this.m&&Kp(X,this.m,Ve)),zp(this.h,De),this.Ua&&wr(X,"TYPE","init"),this.P?(wr(X,"$req",H),wr(X,"SID","null"),De.T=!0,Je(De,X,null)):Je(De,X,H),this.G=2}}else this.G==3&&(w?s2(this,w):this.i.length==0||Sa(this.h)||s2(this))};function s2(w,H){var X;H?X=H.l:X=w.U++;const oe=qa(w.I);wr(oe,"SID",w.K),wr(oe,"RID",X),wr(oe,"AID",w.T),ru(w,oe),w.m&&w.o&&Kp(oe,w.m,w.o),X=new je(w,w.j,X,w.B+1),w.m===null&&(X.H=w.o),H&&(w.i=H.D.concat(w.i)),H=a2(w,X,1e3),X.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),zp(w.h,X),Je(X,oe,H)}function ru(w,H){w.H&&k(w.H,function(X,oe){wr(H,oe,X)}),w.l&&Hx({},function(X,oe){wr(H,oe,X)})}function a2(w,H,X){X=Math.min(w.i.length,X);var oe=w.l?h(w.l.Na,w.l,w):null;e:{var De=w.i;let Ve=-1;for(;;){const rt=["count="+X];Ve==-1?0<X?(Ve=De[0].g,rt.push("ofs="+Ve)):Ve=0:rt.push("ofs="+Ve);let yr=!0;for(let An=0;An<X;An++){let or=De[An].g;const Bn=De[An].map;if(or-=Ve,0>or)Ve=Math.max(0,De[An].g-100),yr=!1;else try{BD(Bn,rt,"req"+or+"_")}catch{oe&&oe(Bn)}}if(yr){oe=rt.join("&");break e}}}return w=w.i.splice(0,X),H.D=w,oe}function i2(w){if(!w.g&&!w.u){w.Y=1;var H=w.Fa;N||V(),L||(N(),L=!0),O.add(H,w),w.v=0}}function Xp(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=Rr(h(w.Fa,w),c2(w,w.v)),w.v++,!0)}t.Fa=function(){if(this.u=null,o2(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=Rr(h(this.ab,this),w)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ln(10),Af(this),o2(this))};function Yp(w){w.A!=null&&(o.clearTimeout(w.A),w.A=null)}function o2(w){w.g=new je(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var H=qa(w.qa);wr(H,"RID","rpc"),wr(H,"SID",w.K),wr(H,"AID",w.T),wr(H,"CI",w.F?"0":"1"),!w.F&&w.ja&&wr(H,"TO",w.ja),wr(H,"TYPE","xmlhttp"),ru(w,H),w.m&&w.o&&Kp(H,w.m,w.o),w.L&&(w.g.I=w.L);var X=w.g;w=w.ia,X.L=1,X.v=Ef(qa(H)),X.m=null,X.P=!0,tt(X,w)}t.Za=function(){this.C!=null&&(this.C=null,Af(this),Xp(this),ln(19))};function wf(w){w.C!=null&&(o.clearTimeout(w.C),w.C=null)}function l2(w,H){var X=null;if(w.g==H){wf(w),Yp(w),w.g=null;var oe=2}else if(ws(w.h,H))X=H.D,$x(w.h,H),oe=1;else return;if(w.G!=0){if(H.o)if(oe==1){X=H.m?H.m.length:0,H=Date.now()-H.F;var De=w.B;oe=ms(),Ke(oe,new Ao(oe,X)),Tf(w)}else i2(w);else if(De=H.s,De==3||De==0&&0<H.X||!(oe==1&&HD(w,H)||oe==2&&Xp(w)))switch(X&&0<X.length&&(H=w.h,H.i=H.i.concat(X)),De){case 1:Co(w,5);break;case 4:Co(w,10);break;case 3:Co(w,6);break;default:Co(w,2)}}}function c2(w,H){let X=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(X*=2),X*H}function Co(w,H){if(w.j.info("Error code "+H),H==2){var X=h(w.fb,w),oe=w.Xa;const De=!oe;oe=new wo(oe||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||yf(oe,"https"),Ef(oe),De?OD(oe.toString(),X):MD(oe.toString(),X)}else ln(2);w.G=0,w.l&&w.l.sa(H),u2(w),n2(w)}t.fb=function(w){w?(this.j.info("Successfully pinged google.com"),ln(2)):(this.j.info("Failed to ping google.com"),ln(1))};function u2(w){if(w.G=0,w.ka=[],w.l){const H=Vx(w.h);(H.length!=0||w.i.length!=0)&&(_(w.ka,H),_(w.ka,w.i),w.h.i.length=0,y(w.i),w.i.length=0),w.l.ra()}}function d2(w,H,X){var oe=X instanceof wo?qa(X):new wo(X);if(oe.g!="")H&&(oe.g=H+"."+oe.g),xf(oe,oe.s);else{var De=o.location;oe=De.protocol,H=H?H+"."+De.hostname:De.hostname,De=+De.port;var Ve=new wo(null);oe&&yf(Ve,oe),H&&(Ve.g=H),De&&xf(Ve,De),X&&(Ve.l=X),oe=Ve}return X=w.D,H=w.ya,X&&H&&wr(oe,X,H),wr(oe,"VER",w.la),ru(w,oe),oe}function f2(w,H,X){if(H&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return H=w.Ca&&!w.pa?new Mr(new bf({eb:X})):new Mr(w.pa),H.Ha(w.J),H}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function h2(){}t=h2.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Cf(){}Cf.prototype.g=function(w,H){return new Cs(w,H)};function Cs(w,H){Me.call(this),this.g=new r2(H),this.l=w,this.h=H&&H.messageUrlParams||null,w=H&&H.messageHeaders||null,H&&H.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=H&&H.initMessageHeaders||null,H&&H.messageContentType&&(w?w["X-WebChannel-Content-Type"]=H.messageContentType:w={"X-WebChannel-Content-Type":H.messageContentType}),H&&H.va&&(w?w["X-WebChannel-Client-Profile"]=H.va:w={"X-WebChannel-Client-Profile":H.va}),this.g.S=w,(w=H&&H.Sb)&&!b(w)&&(this.g.m=w),this.v=H&&H.supportsCrossDomainXhr||!1,this.u=H&&H.sendRawJson||!1,(H=H&&H.httpSessionIdParam)&&!b(H)&&(this.g.D=H,w=this.h,w!==null&&H in w&&(w=this.h,H in w&&delete w[H])),this.j=new Dl(this)}g(Cs,Me),Cs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cs.prototype.close=function(){qp(this.g)},Cs.prototype.o=function(w){var H=this.g;if(typeof w=="string"){var X={};X.__data__=w,w=X}else this.u&&(X={},X.__data__=dt(w),w=X);H.i.push(new To(H.Ya++,w)),H.G==3&&Tf(H)},Cs.prototype.N=function(){this.g.l=null,delete this.j,qp(this.g),delete this.g,Cs.aa.N.call(this)};function p2(w){Rt.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var H=w.__sm__;if(H){e:{for(const X in H){w=X;break e}w=void 0}(this.i=w)&&(w=this.i,H=H!==null&&w in H?H[w]:void 0),this.data=H}else this.data=w}g(p2,Rt);function m2(){mr.call(this),this.status=1}g(m2,mr);function Dl(w){this.g=w}g(Dl,h2),Dl.prototype.ua=function(){Ke(this.g,"a")},Dl.prototype.ta=function(w){Ke(this.g,new p2(w))},Dl.prototype.sa=function(w){Ke(this.g,new m2)},Dl.prototype.ra=function(){Ke(this.g,"b")},Cf.prototype.createWebChannel=Cf.prototype.g,Cs.prototype.send=Cs.prototype.o,Cs.prototype.open=Cs.prototype.m,Cs.prototype.close=Cs.prototype.close,rC=function(){return new Cf},tC=function(){return ms()},eC=mn,vv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},de.NO_ERROR=0,de.TIMEOUT=8,de.HTTP_ERROR=6,w0=de,pe.COMPLETE="complete",Zw=pe,mt.EventType=Ct,Ct.OPEN="a",Ct.CLOSE="b",Ct.ERROR="c",Ct.MESSAGE="d",Me.prototype.listen=Me.prototype.K,xu=mt,Mr.prototype.listenOnce=Mr.prototype.L,Mr.prototype.getLastError=Mr.prototype.Ka,Mr.prototype.getLastErrorCode=Mr.prototype.Ba,Mr.prototype.getStatus=Mr.prototype.Z,Mr.prototype.getResponseJson=Mr.prototype.Oa,Mr.prototype.getResponseText=Mr.prototype.oa,Mr.prototype.send=Mr.prototype.ea,Mr.prototype.setWithCredentials=Mr.prototype.Ha,Jw=Mr}).apply(typeof $f<"u"?$f:typeof self<"u"?self:typeof window<"u"?window:{});const PE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Gn.UNAUTHENTICATED=new Gn(null),Gn.GOOGLE_CREDENTIALS=new Gn("google-credentials-uid"),Gn.FIRST_PARTY=new Gn("first-party-uid"),Gn.MOCK_USER=new Gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=new O1("@firebase/firestore");function iu(){return tl.logLevel}function gt(t,...e){if(tl.logLevel<=Yt.DEBUG){const r=e.map(Z1);tl.debug(`Firestore (${Uc}): ${t}`,...r)}}function Ti(t,...e){if(tl.logLevel<=Yt.ERROR){const r=e.map(Z1);tl.error(`Firestore (${Uc}): ${t}`,...r)}}function rl(t,...e){if(tl.logLevel<=Yt.WARN){const r=e.map(Z1);tl.warn(`Firestore (${Uc}): ${t}`,...r)}}function Z1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t="Unexpected state"){const e=`FIRESTORE (${Uc}) INTERNAL ASSERTION FAILED: `+t;throw Ti(e),new Error(e)}function pr(t,e){t||Pt()}function Lt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class st extends Ea{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Gn.UNAUTHENTICATED))}shutdown(){}}class G5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class W5{constructor(e){this.t=e,this.currentUser=Gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){pr(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new fi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new fi,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{gt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(gt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new fi)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(gt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pr(typeof n.accessToken=="string"),new nC(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pr(e===null||typeof e=="string"),new Gn(e)}}class z5{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Gn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class K5{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new z5(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Gn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class q5{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class X5{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){pr(this.o===void 0);const n=i=>{i.error!=null&&gt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,gt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{gt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):gt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(pr(typeof r.token=="string"),this.R=r.token,new q5(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=Y5(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function cr(t,e){return t<e?-1:t>e?1:0}function Sc(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new st(Ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new st(Ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new st(Ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new st(Ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return on.fromMillis(Date.now())}static fromDate(e){return on.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new on(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?cr(this.nanoseconds,e.nanoseconds):cr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ot(e)}static min(){return new Ot(new on(0,0))}static max(){return new Ot(new on(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r,n){r===void 0?r=0:r>e.length&&Pt(),n===void 0?n=e.length-r:n>e.length-r&&Pt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return xd.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof xd?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),a=r.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Sr extends xd{construct(e,r,n){return new Sr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new st(Ge.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Sr(r)}static emptyPath(){return new Sr([])}}const Q5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends xd{construct(e,r,n){return new xn(e,r,n)}static isValidIdentifier(e){return Q5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new xn(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new st(Ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new st(Ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new st(Ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new st(Ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(r)}static emptyPath(){return new xn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.path=e}static fromPath(e){return new Et(Sr.fromString(e))}static fromName(e){return new Et(Sr.fromString(e).popFirst(5))}static empty(){return new Et(Sr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Sr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Sr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Et(new Sr(e.slice()))}}function J5(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ot.fromTimestamp(n===1e9?new on(r+1,0):new on(r,n));return new fo(s,Et.empty(),e)}function Z5(t){return new fo(t.readTime,t.key,-1)}class fo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new fo(Ot.min(),Et.empty(),-1)}static max(){return new fo(Ot.max(),Et.empty(),-1)}}function eN(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Et.comparator(t.documentKey,e.documentKey),r!==0?r:cr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qd(t){if(t.code!==Ge.FAILED_PRECONDITION||t.message!==tN)throw t;gt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Pt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Qe((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Qe?r:Qe.resolve(r)}catch(r){return Qe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Qe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Qe.reject(r)}static resolve(e){return new Qe((r,n)=>{r(e)})}static reject(e){return new Qe((r,n)=>{n(e)})}static waitFor(e){return new Qe((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=Qe.resolve(!1);for(const n of e)r=r.next(s=>s?Qe.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new Qe((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===i&&n(a)},u=>s(u))}})}static doWhile(e,r){return new Qe((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function nN(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Jd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ty.oe=-1;function pp(t){return t==null}function uh(t){return t===0&&1/t==-1/0}function sN(t){return typeof t=="number"&&Number.isInteger(t)&&!uh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ml(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function aC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,r){this.comparator=e,this.root=r||In.EMPTY}insert(e,r){return new Or(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,In.BLACK,null,null))}remove(e){return new Or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,In.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vf(this.root,e,this.comparator,!0)}}class Vf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class In{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??In.RED,this.left=s??In.EMPTY,this.right=i??In.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new In(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return In.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return In.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,In.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,In.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Pt();const e=this.left.check();if(e!==this.right.check())throw Pt();return e+(this.isRed()?0:1)}}In.EMPTY=null,In.RED=!0,In.BLACK=!1;In.EMPTY=new class{constructor(){this.size=0}get key(){throw Pt()}get value(){throw Pt()}get color(){throw Pt()}get left(){throw Pt()}get right(){throw Pt()}copy(e,r,n,s,i){return this}insert(e,r,n){return new In(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.comparator=e,this.data=new Or(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new FE(this.data.getIterator())}getIteratorFrom(e){return new FE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Fn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Fn(this.comparator);return r.data=e,r}}class FE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new Rs([])}unionWith(e){let r=new Fn(xn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Rs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Sc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new iC("Invalid base64 string: "+i):i}}(e);return new _n(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new _n(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return cr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const aN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(t){if(pr(!!t),typeof t=="string"){let e=0;const r=aN.exec(t);if(pr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Kr(t.seconds),nanos:Kr(t.nanos)}}function Kr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function nl(t){return typeof t=="string"?_n.fromBase64String(t):_n.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function ry(t){const e=t.mapValue.fields.__previous_value__;return mp(e)?ry(e):e}function Ed(t){const e=ho(t.mapValue.fields.__local_write_time__.timestampValue);return new on(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,r,n,s,i,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Ac{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Ac("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ac&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf={mapValue:{}};function sl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?mp(t)?4:lN(t)?9007199254740991:oN(t)?10:11:Pt()}function $a(t,e){if(t===e)return!0;const r=sl(t);if(r!==sl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ed(t).isEqual(Ed(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=ho(s.timestampValue),o=ho(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return nl(s.bytesValue).isEqual(nl(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Kr(s.geoPointValue.latitude)===Kr(i.geoPointValue.latitude)&&Kr(s.geoPointValue.longitude)===Kr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Kr(s.integerValue)===Kr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Kr(s.doubleValue),o=Kr(i.doubleValue);return a===o?uh(a)===uh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Sc(t.arrayValue.values||[],e.arrayValue.values||[],$a);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(RE(a)!==RE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!$a(a[l],o[l])))return!1;return!0}(t,e);default:return Pt()}}function bd(t,e){return(t.values||[]).find(r=>$a(r,e))!==void 0}function Tc(t,e){if(t===e)return 0;const r=sl(t),n=sl(e);if(r!==n)return cr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return cr(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=Kr(i.integerValue||i.doubleValue),l=Kr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return NE(t.timestampValue,e.timestampValue);case 4:return NE(Ed(t),Ed(e));case 5:return cr(t.stringValue,e.stringValue);case 6:return function(i,a){const o=nl(i),l=nl(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=cr(o[c],l[c]);if(u!==0)return u}return cr(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=cr(Kr(i.latitude),Kr(a.latitude));return o!==0?o:cr(Kr(i.longitude),Kr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return OE(t.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,c,u;const f=i.fields||{},h=a.fields||{},p=(o=f.value)===null||o===void 0?void 0:o.arrayValue,g=(l=h.value)===null||l===void 0?void 0:l.arrayValue,y=cr(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return y!==0?y:OE(p,g)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Hf.mapValue&&a===Hf.mapValue)return 0;if(i===Hf.mapValue)return 1;if(a===Hf.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const h=cr(l[f],u[f]);if(h!==0)return h;const p=Tc(o[l[f]],c[u[f]]);if(p!==0)return p}return cr(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Pt()}}function NE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return cr(t,e);const r=ho(t),n=ho(e),s=cr(r.seconds,n.seconds);return s!==0?s:cr(r.nanos,n.nanos)}function OE(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Tc(r[s],n[s]);if(i)return i}return cr(r.length,n.length)}function wc(t){return yv(t)}function yv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ho(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return nl(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Et.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=yv(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${yv(r.fields[a])}`;return s+"}"}(t.mapValue):Pt()}function dh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function xv(t){return!!t&&"integerValue"in t}function ny(t){return!!t&&"arrayValue"in t}function ME(t){return!!t&&"nullValue"in t}function LE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function C0(t){return!!t&&"mapValue"in t}function oN(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Vu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ml(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Vu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Vu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function lN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.value=e}static empty(){return new _s({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!C0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vu(r)}setAll(e){let r=xn.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=Vu(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());C0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return $a(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];C0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){ml(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new _s(Vu(this.value))}}function oC(t){const e=[];return ml(t.fields,(r,n)=>{const s=new xn([r]);if(C0(n)){const i=oC(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Rs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Kn(e,0,Ot.min(),Ot.min(),Ot.min(),_s.empty(),0)}static newFoundDocument(e,r,n,s){return new Kn(e,1,r,Ot.min(),n,s,0)}static newNoDocument(e,r){return new Kn(e,2,r,Ot.min(),Ot.min(),_s.empty(),0)}static newUnknownDocument(e,r){return new Kn(e,3,r,Ot.min(),Ot.min(),_s.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_s.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_s.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ot.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,r){this.position=e,this.inclusive=r}}function BE(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Et.comparator(Et.fromName(a.referenceValue),r.key):n=Tc(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function UE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!$a(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,r="asc"){this.field=e,this.dir=r}}function cN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{}class sn extends lC{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new dN(e,r,n):r==="array-contains"?new pN(e,n):r==="in"?new mN(e,n):r==="not-in"?new gN(e,n):r==="array-contains-any"?new vN(e,n):new sn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new fN(e,n):new hN(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Tc(r,this.value)):r!==null&&sl(this.value)===sl(r)&&this.matchesComparison(Tc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class va extends lC{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new va(e,r)}matches(e){return cC(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function cC(t){return t.op==="and"}function uC(t){return uN(t)&&cC(t)}function uN(t){for(const e of t.filters)if(e instanceof va)return!1;return!0}function Ev(t){if(t instanceof sn)return t.field.canonicalString()+t.op.toString()+wc(t.value);if(uC(t))return t.filters.map(e=>Ev(e)).join(",");{const e=t.filters.map(r=>Ev(r)).join(",");return`${t.op}(${e})`}}function dC(t,e){return t instanceof sn?function(n,s){return s instanceof sn&&n.op===s.op&&n.field.isEqual(s.field)&&$a(n.value,s.value)}(t,e):t instanceof va?function(n,s){return s instanceof va&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&dC(a,s.filters[o]),!0):!1}(t,e):void Pt()}function fC(t){return t instanceof sn?function(r){return`${r.field.canonicalString()} ${r.op} ${wc(r.value)}`}(t):t instanceof va?function(r){return r.op.toString()+" {"+r.getFilters().map(fC).join(" ,")+"}"}(t):"Filter"}class dN extends sn{constructor(e,r,n){super(e,r,n),this.key=Et.fromName(n.referenceValue)}matches(e){const r=Et.comparator(e.key,this.key);return this.matchesComparison(r)}}class fN extends sn{constructor(e,r){super(e,"in",r),this.keys=hC("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class hN extends sn{constructor(e,r){super(e,"not-in",r),this.keys=hC("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function hC(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Et.fromName(n.referenceValue))}class pN extends sn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return ny(r)&&bd(r.arrayValue,this.value)}}class mN extends sn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&bd(this.value.arrayValue,r)}}class gN extends sn{constructor(e,r){super(e,"not-in",r)}matches(e){if(bd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!bd(this.value.arrayValue,r)}}class vN extends sn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!ny(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>bd(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function $E(t,e=null,r=[],n=[],s=null,i=null,a=null){return new yN(t,e,r,n,s,i,a)}function sy(t){const e=Lt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Ev(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),pp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>wc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>wc(n)).join(",")),e.ue=r}return e.ue}function ay(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!cN(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!dC(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!UE(t.startAt,e.startAt)&&UE(t.endAt,e.endAt)}function bv(t){return Et.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function xN(t,e,r,n,s,i,a,o){return new gl(t,e,r,n,s,i,a,o)}function gp(t){return new gl(t)}function VE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function iy(t){return t.collectionGroup!==null}function uc(t){const e=Lt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Fn(xn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new _d(i,n))}),r.has(xn.keyField().canonicalString())||e.ce.push(new _d(xn.keyField(),n))}return e.ce}function Oa(t){const e=Lt(t);return e.le||(e.le=EN(e,uc(t))),e.le}function EN(t,e){if(t.limitType==="F")return $E(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new _d(s.field,i)});const r=t.endAt?new Cc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Cc(t.startAt.position,t.startAt.inclusive):null;return $E(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function _v(t,e){const r=t.filters.concat([e]);return new gl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function fh(t,e,r){return new gl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function vp(t,e){return ay(Oa(t),Oa(e))&&t.limitType===e.limitType}function pC(t){return`${sy(Oa(t))}|lt:${t.limitType}`}function Hl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>fC(s)).join(", ")}]`),pp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>wc(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>wc(s)).join(",")),`Target(${n})`}(Oa(t))}; limitType=${t.limitType})`}function yp(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Et.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of uc(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=BE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,uc(n),s)||n.endAt&&!function(a,o,l){const c=BE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,uc(n),s))}(t,e)}function bN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function mC(t){return(e,r)=>{let n=!1;for(const s of uc(t)){const i=_N(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function _N(t,e,r){const n=t.field.isKeyField()?Et.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?Tc(l,c):Pt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Pt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ml(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return aC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=new Or(Et.comparator);function wi(){return SN}const gC=new Or(Et.comparator);function Eu(...t){let e=gC;for(const r of t)e=e.insert(r.key,r);return e}function vC(t){let e=gC;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Bo(){return Hu()}function yC(){return Hu()}function Hu(){return new $c(t=>t.toString(),(t,e)=>t.isEqual(e))}const AN=new Or(Et.comparator),TN=new Fn(Et.comparator);function qt(...t){let e=TN;for(const r of t)e=e.add(r);return e}const wN=new Fn(cr);function CN(){return wN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uh(e)?"-0":e}}function xC(t){return{integerValue:""+t}}function IN(t,e){return sN(e)?xC(e):oy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(){this._=void 0}}function kN(t,e,r){return t instanceof Sd?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&mp(i)&&(i=ry(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(r,e):t instanceof Ad?bC(t,e):t instanceof Td?_C(t,e):function(s,i){const a=EC(s,i),o=HE(a)+HE(s.Pe);return xv(a)&&xv(s.Pe)?xC(o):oy(s.serializer,o)}(t,e)}function DN(t,e,r){return t instanceof Ad?bC(t,e):t instanceof Td?_C(t,e):r}function EC(t,e){return t instanceof hh?function(n){return xv(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Sd extends xp{}class Ad extends xp{constructor(e){super(),this.elements=e}}function bC(t,e){const r=SC(e);for(const n of t.elements)r.some(s=>$a(s,n))||r.push(n);return{arrayValue:{values:r}}}class Td extends xp{constructor(e){super(),this.elements=e}}function _C(t,e){let r=SC(e);for(const n of t.elements)r=r.filter(s=>!$a(s,n));return{arrayValue:{values:r}}}class hh extends xp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function HE(t){return Kr(t.integerValue||t.doubleValue)}function SC(t){return ny(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e,r){this.field=e,this.transform=r}}function RN(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Ad&&s instanceof Ad||n instanceof Td&&s instanceof Td?Sc(n.elements,s.elements,$a):n instanceof hh&&s instanceof hh?$a(n.Pe,s.Pe):n instanceof Sd&&s instanceof Sd}(t.transform,e.transform)}class FN{constructor(e,r){this.version=e,this.transformResults=r}}class fs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new fs}static exists(e){return new fs(void 0,e)}static updateTime(e){return new fs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function I0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ep{}function AC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new bp(t.key,fs.none()):new Zd(t.key,t.data,fs.none());{const r=t.data,n=_s.empty();let s=new Fn(xn.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new yo(t.key,n,new Rs(s.toArray()),fs.none())}}function NN(t,e,r){t instanceof Zd?function(s,i,a){const o=s.value.clone(),l=GE(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof yo?function(s,i,a){if(!I0(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=GE(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(TC(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function ju(t,e,r,n){return t instanceof Zd?function(i,a,o,l){if(!I0(i.precondition,a))return o;const c=i.value.clone(),u=WE(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof yo?function(i,a,o,l){if(!I0(i.precondition,a))return o;const c=WE(i.fieldTransforms,l,a),u=a.data;return u.setAll(TC(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(i,a,o){return I0(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function ON(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=EC(n.transform,s||null);i!=null&&(r===null&&(r=_s.empty()),r.set(n.field,i))}return r||null}function jE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Sc(n,s,(i,a)=>RN(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Zd extends Ep{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class yo extends Ep{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function TC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function GE(t,e,r){const n=new Map;pr(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,DN(a,o,r[s]))}return n}function WE(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,kN(i,a,e))}return n}class bp extends Ep{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class MN extends Ep{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&NN(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=ju(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=ju(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=yC();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=AC(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Ot.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qt())}isEqual(e){return this.batchId===e.batchId&&Sc(this.mutations,e.mutations,(r,n)=>jE(r,n))&&Sc(this.baseMutations,e.baseMutations,(r,n)=>jE(r,n))}}class ly{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){pr(e.mutations.length===n.length);let s=function(){return AN}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new ly(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zr,rr;function $N(t){switch(t){default:return Pt();case Ge.CANCELLED:case Ge.UNKNOWN:case Ge.DEADLINE_EXCEEDED:case Ge.RESOURCE_EXHAUSTED:case Ge.INTERNAL:case Ge.UNAVAILABLE:case Ge.UNAUTHENTICATED:return!1;case Ge.INVALID_ARGUMENT:case Ge.NOT_FOUND:case Ge.ALREADY_EXISTS:case Ge.PERMISSION_DENIED:case Ge.FAILED_PRECONDITION:case Ge.ABORTED:case Ge.OUT_OF_RANGE:case Ge.UNIMPLEMENTED:case Ge.DATA_LOSS:return!0}}function wC(t){if(t===void 0)return Ti("GRPC error has no .code"),Ge.UNKNOWN;switch(t){case Zr.OK:return Ge.OK;case Zr.CANCELLED:return Ge.CANCELLED;case Zr.UNKNOWN:return Ge.UNKNOWN;case Zr.DEADLINE_EXCEEDED:return Ge.DEADLINE_EXCEEDED;case Zr.RESOURCE_EXHAUSTED:return Ge.RESOURCE_EXHAUSTED;case Zr.INTERNAL:return Ge.INTERNAL;case Zr.UNAVAILABLE:return Ge.UNAVAILABLE;case Zr.UNAUTHENTICATED:return Ge.UNAUTHENTICATED;case Zr.INVALID_ARGUMENT:return Ge.INVALID_ARGUMENT;case Zr.NOT_FOUND:return Ge.NOT_FOUND;case Zr.ALREADY_EXISTS:return Ge.ALREADY_EXISTS;case Zr.PERMISSION_DENIED:return Ge.PERMISSION_DENIED;case Zr.FAILED_PRECONDITION:return Ge.FAILED_PRECONDITION;case Zr.ABORTED:return Ge.ABORTED;case Zr.OUT_OF_RANGE:return Ge.OUT_OF_RANGE;case Zr.UNIMPLEMENTED:return Ge.UNIMPLEMENTED;case Zr.DATA_LOSS:return Ge.DATA_LOSS;default:return Pt()}}(rr=Zr||(Zr={}))[rr.OK=0]="OK",rr[rr.CANCELLED=1]="CANCELLED",rr[rr.UNKNOWN=2]="UNKNOWN",rr[rr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rr[rr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rr[rr.NOT_FOUND=5]="NOT_FOUND",rr[rr.ALREADY_EXISTS=6]="ALREADY_EXISTS",rr[rr.PERMISSION_DENIED=7]="PERMISSION_DENIED",rr[rr.UNAUTHENTICATED=16]="UNAUTHENTICATED",rr[rr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rr[rr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rr[rr.ABORTED=10]="ABORTED",rr[rr.OUT_OF_RANGE=11]="OUT_OF_RANGE",rr[rr.UNIMPLEMENTED=12]="UNIMPLEMENTED",rr[rr.INTERNAL=13]="INTERNAL",rr[rr.UNAVAILABLE=14]="UNAVAILABLE",rr[rr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN=new Wo([4294967295,4294967295],0);function zE(t){const e=VN().encode(t),r=new Qw;return r.update(e),new Uint8Array(r.digest())}function KE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Wo([r,n],0),new Wo([s,i],0)]}class cy{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new bu(`Invalid padding: ${r}`);if(n<0)throw new bu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new bu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new bu(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Wo.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Wo.fromNumber(n)));return s.compare(HN)===1&&(s=new Wo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=zE(e),[n,s]=KE(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);if(!this.de(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new cy(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=zE(e),[n,s]=KE(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class bu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,ef.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new _p(Ot.min(),s,new Or(cr),wi(),qt())}}class ef{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new ef(n,r,qt(),qt(),qt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class CC{constructor(e,r){this.targetId=e,this.me=r}}class IC{constructor(e,r,n=_n.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class qE{constructor(){this.fe=0,this.ge=YE(),this.pe=_n.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=qt(),r=qt(),n=qt();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Pt()}}),new ef(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=YE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,pr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class jN{constructor(e){this.Le=e,this.Be=new Map,this.ke=wi(),this.qe=XE(),this.Qe=new Or(cr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Pt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(bv(i))if(n===0){const a=new Et(i.path);this.Ue(r,a,Kn.newNoDocument(a,Ot.min()))}else pr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=nl(n).toUint8Array()}catch(l){if(l instanceof iC)return rl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new cy(a,s,i)}catch(l){return rl(l instanceof bu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&bv(o.target)){const l=new Et(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Kn.newNoDocument(l,e))}i.be&&(r.set(a,i.ve()),i.Ce())}});let n=qt();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new _p(e,r,this.Qe,this.ke,n);return this.ke=wi(),this.qe=XE(),this.Qe=new Or(cr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new qE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Fn(cr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||gt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new qE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function XE(){return new Or(Et.comparator)}function YE(){return new Or(Et.comparator)}const GN={asc:"ASCENDING",desc:"DESCENDING"},WN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zN={and:"AND",or:"OR"};class KN{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Sv(t,e){return t.useProto3Json||pp(e)?e:{value:e}}function ph(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function qN(t,e){return ph(t,e.toTimestamp())}function Ma(t){return pr(!!t),Ot.fromTimestamp(function(r){const n=ho(r);return new on(n.seconds,n.nanos)}(t))}function uy(t,e){return Av(t,e).canonicalString()}function Av(t,e){const r=function(s){return new Sr(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function DC(t){const e=Sr.fromString(t);return pr(OC(e)),e}function Tv(t,e){return uy(t.databaseId,e.path)}function ym(t,e){const r=DC(e);if(r.get(1)!==t.databaseId.projectId)throw new st(Ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new st(Ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Et(RC(r))}function PC(t,e){return uy(t.databaseId,e)}function XN(t){const e=DC(t);return e.length===4?Sr.emptyPath():RC(e)}function wv(t){return new Sr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function RC(t){return pr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function QE(t,e,r){return{name:Tv(t,e),fields:r.value.mapValue.fields}}function YN(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Pt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(pr(u===void 0||typeof u=="string"),_n.fromBase64String(u||"")):(pr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),_n.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?Ge.UNKNOWN:wC(c.code);return new st(u,c.message||"")}(a);r=new IC(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=ym(t,n.document.name),i=Ma(n.document.updateTime),a=n.document.createTime?Ma(n.document.createTime):Ot.min(),o=new _s({mapValue:{fields:n.document.fields}}),l=Kn.newFoundDocument(s,i,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new k0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=ym(t,n.document),i=n.readTime?Ma(n.readTime):Ot.min(),a=Kn.newNoDocument(s,i),o=n.removedTargetIds||[];r=new k0([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=ym(t,n.document),i=n.removedTargetIds||[];r=new k0([],i,s,null)}else{if(!("filter"in e))return Pt();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new UN(s,i),o=n.targetId;r=new CC(o,a)}}return r}function QN(t,e){let r;if(e instanceof Zd)r={update:QE(t,e.key,e.value)};else if(e instanceof bp)r={delete:Tv(t,e.key)};else if(e instanceof yo)r={update:QE(t,e.key,e.data),updateMask:iO(e.fieldMask)};else{if(!(e instanceof MN))return Pt();r={verify:Tv(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof Sd)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ad)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Td)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof hh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Pt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:qN(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Pt()}(t,e.precondition)),r}function JN(t,e){return t&&t.length>0?(pr(e!==void 0),t.map(r=>function(s,i){let a=s.updateTime?Ma(s.updateTime):Ma(i);return a.isEqual(Ot.min())&&(a=Ma(i)),new FN(a,s.transformResults||[])}(r,e))):[]}function ZN(t,e){return{documents:[PC(t,e.path)]}}function eO(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=PC(t,s);const i=function(c){if(c.length!==0)return NC(va.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:jl(h.field),direction:nO(h.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Sv(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:s}}function tO(t){let e=XN(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){pr(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(f){const h=FC(f);return h instanceof va&&uC(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(h=>function(g){return new _d(Gl(g.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(f){let h;return h=typeof f=="object"?f.value:f,pp(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(f){const h=!!f.before,p=f.values||[];return new Cc(p,h)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const h=!f.before,p=f.values||[];return new Cc(p,h)}(r.endAt)),xN(e,s,a,i,o,"F",l,c)}function rO(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function FC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Gl(r.unaryFilter.field);return sn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Gl(r.unaryFilter.field);return sn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Gl(r.unaryFilter.field);return sn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Gl(r.unaryFilter.field);return sn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Pt()}}(t):t.fieldFilter!==void 0?function(r){return sn.create(Gl(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Pt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return va.create(r.compositeFilter.filters.map(n=>FC(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Pt()}}(r.compositeFilter.op))}(t):Pt()}function nO(t){return GN[t]}function sO(t){return WN[t]}function aO(t){return zN[t]}function jl(t){return{fieldPath:t.canonicalString()}}function Gl(t){return xn.fromServerFormat(t.fieldPath)}function NC(t){return t instanceof sn?function(r){if(r.op==="=="){if(LE(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NAN"}};if(ME(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(LE(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NOT_NAN"}};if(ME(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jl(r.field),op:sO(r.op),value:r.value}}}(t):t instanceof va?function(r){const n=r.getFilters().map(s=>NC(s));return n.length===1?n[0]:{compositeFilter:{op:aO(r.op),filters:n}}}(t):Pt()}function iO(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function OC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,r,n,s,i=Ot.min(),a=Ot.min(),o=_n.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e){this.ct=e}}function lO(t){const e=tO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?fh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(){this.un=new uO}addToCollectionParentIndex(e,r){return this.un.add(r),Qe.resolve()}getCollectionParents(e,r){return Qe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Qe.resolve()}deleteFieldIndex(e,r){return Qe.resolve()}deleteAllFieldIndexes(e){return Qe.resolve()}createTargetIndexes(e,r){return Qe.resolve()}getDocumentsMatchingTarget(e,r){return Qe.resolve(null)}getIndexType(e,r){return Qe.resolve(0)}getFieldIndexes(e,r){return Qe.resolve([])}getNextCollectionGroupToUpdate(e){return Qe.resolve(null)}getMinOffset(e,r){return Qe.resolve(fo.min())}getMinOffsetFromCollectionGroup(e,r){return Qe.resolve(fo.min())}updateCollectionGroup(e,r,n){return Qe.resolve()}updateIndexEntries(e,r){return Qe.resolve()}}class uO{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Fn(Sr.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Fn(Sr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ic(0)}static kn(){return new Ic(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.changes=new $c(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Kn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Qe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&ju(n.mutation,s,Rs.empty(),on.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qt()){const s=Bo();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Eu();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Bo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qt()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=wi();const a=Hu(),o=function(){return Hu()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof yo)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),ju(u.mutation,c,u.mutation.getFieldMask(),on.now())):a.set(c.key,Rs.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var f;return o.set(c,new fO(u,(f=a.get(c))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Hu();let s=new Or((a,o)=>a-o),i=qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Rs.empty();u=o.applyToLocalView(c,u),n.set(l,u);const f=(s.get(o.batchId)||qt()).add(l);s=s.insert(o.batchId,f)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,f=yC();u.forEach(h=>{if(!i.has(h)){const p=AC(r.get(h),n.get(h));p!==null&&f.set(h,p),i=i.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,f))}return Qe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Et.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):iy(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Qe.resolve(Bo());let o=-1,l=i;return a.next(c=>Qe.forEach(c,(u,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),i.get(u)?Qe.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,qt())).next(u=>({batchId:o,changes:vC(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Et(r)).next(n=>{let s=Eu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Eu();return this.indexManager.getCollectionParents(e,i).next(o=>Qe.forEach(o,l=>{const c=function(f,h){return new gl(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((f,h)=>{a=a.insert(f,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Kn.newInvalidDocument(u)))});let o=Eu();return a.forEach((l,c)=>{const u=i.get(l);u!==void 0&&ju(u.mutation,c,Rs.empty(),on.now()),yp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Qe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ma(s.createTime)}}(r)),Qe.resolve()}getNamedQuery(e,r){return Qe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:lO(s.bundledQuery),readTime:Ma(s.readTime)}}(r)),Qe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(){this.overlays=new Or(Et.comparator),this.Ir=new Map}getOverlay(e,r){return Qe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Bo();return Qe.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),Qe.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),Qe.resolve()}getOverlaysForCollection(e,r,n){const s=Bo(),i=r.length+1,a=new Et(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return Qe.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Or((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Bo(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Bo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return Qe.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new BN(r,n));let i=this.Ir.get(r);i===void 0&&(i=qt(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return Qe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Qe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(){this.Tr=new Fn(gn.Er),this.dr=new Fn(gn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new gn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new gn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Et(new Sr([])),n=new gn(r,e),s=new gn(r,e+1),i=[];return this.dr.forEachInRange([n,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Et(new Sr([])),n=new gn(r,e),s=new gn(r,e+1);let i=qt();return this.dr.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new gn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class gn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Et.comparator(e.key,r.key)||cr(e.wr,r.wr)}static Ar(e,r){return cr(e.wr,r.wr)||Et.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Fn(gn.Er)}checkEmpty(e){return Qe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new LN(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new gn(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Qe.resolve(a)}lookupMutationBatch(e,r){return Qe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return Qe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Qe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Qe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new gn(r,0),s=new gn(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],a=>{const o=this.Dr(a.wr);i.push(o)}),Qe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Fn(cr);return r.forEach(s=>{const i=new gn(s,0),a=new gn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{n=n.add(o.wr)})}),Qe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Et.isDocumentKey(i)||(i=i.child(""));const a=new gn(new Et(i),0);let o=new Fn(cr);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},a),Qe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){pr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Qe.forEach(r.mutations,s=>{const i=new gn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new gn(r,0),s=this.br.firstAfterOrEqual(n);return Qe.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Qe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e){this.Mr=e,this.docs=function(){return new Or(Et.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Qe.resolve(n?n.document.mutableCopy():Kn.newInvalidDocument(r))}getEntries(e,r){let n=wi();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Kn.newInvalidDocument(s))}),Qe.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=wi();const a=r.path,o=new Et(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||eN(Z5(u),n)<=0||(s.has(u.key)||yp(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return Qe.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Pt()}Or(e,r){return Qe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new xO(this)}getSize(e){return Qe.resolve(this.size)}}class xO extends dO{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),Qe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e){this.persistence=e,this.Nr=new $c(r=>sy(r),ay),this.lastRemoteSnapshotVersion=Ot.min(),this.highestTargetId=0,this.Lr=0,this.Br=new dy,this.targetCount=0,this.kr=Ic.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),Qe.resolve()}getLastRemoteSnapshotVersion(e){return Qe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Qe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Qe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Qe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ic(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Qe.resolve()}updateTargetData(e,r){return this.Kn(r),Qe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Qe.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),Qe.waitFor(i).next(()=>s)}getTargetCount(e){return Qe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Qe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Qe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),Qe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Qe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Qe.resolve(n)}containsKey(e,r){return Qe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e,r){this.qr={},this.overlays={},this.Qr=new ty(0),this.Kr=!1,this.Kr=!0,this.$r=new gO,this.referenceDelegate=e(this),this.Ur=new EO(this),this.indexManager=new cO,this.remoteDocumentCache=function(s){return new yO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new oO(r),this.Gr=new pO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new mO,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new vO(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){gt("MemoryPersistence","Starting transaction:",e);const s=new _O(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return Qe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class _O extends rN{constructor(e){super(),this.currentSequenceNumber=e}}class fy{constructor(e){this.persistence=e,this.Jr=new dy,this.Yr=null}static Zr(e){return new fy(e)}get Xr(){if(this.Yr)return this.Yr;throw Pt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Qe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Qe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Qe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qe.forEach(this.Xr,n=>{const s=Et.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,Ot.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Qe.or([()=>Qe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=qt(),s=qt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hy(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return $F()?8:nN(ts())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new SO;return this.Xi(e,r,a).next(o=>{if(i.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(iu()<=Yt.DEBUG&&gt("QueryEngine","SDK will not create cache indexes for query:",Hl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Qe.resolve()):(iu()<=Yt.DEBUG&&gt("QueryEngine","Query:",Hl(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(iu()<=Yt.DEBUG&&gt("QueryEngine","The SDK decides to create cache indexes for query:",Hl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Oa(r))):Qe.resolve())}Yi(e,r){if(VE(r))return Qe.resolve(null);let n=Oa(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=fh(r,null,"F"),n=Oa(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=qt(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,fh(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,s){return VE(r)||s.isEqual(Ot.min())?Qe.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const a=this.ts(r,i);return this.ns(r,a,n,s)?Qe.resolve(null):(iu()<=Yt.DEBUG&&gt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Hl(r)),this.rs(e,a,r,J5(s,-1)).next(o=>o))})}ts(e,r){let n=new Fn(mC(e));return r.forEach((s,i)=>{yp(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return iu()<=Yt.DEBUG&&gt("QueryEngine","Using full collection scan to execute query:",Hl(r)),this.Ji.getDocumentsMatchingQuery(e,r,fo.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Or(cr),this._s=new $c(i=>sy(i),ay),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function wO(t,e,r,n){return new TO(t,e,r,n)}async function MC(t,e){const r=Lt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=qt();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function CO(t,e){const r=Lt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const f=c.batch,h=f.keys();let p=Qe.resolve();return h.forEach(g=>{p=p.next(()=>u.getEntry(l,g)).next(y=>{const _=c.docVersions.get(g);pr(_!==null),y.version.compareTo(_)<0&&(f.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),u.addEntry(y)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=qt();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function LC(t){const e=Lt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function IO(t,e){const r=Lt(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((u,f)=>{const h=s.get(f);if(!h)return;o.push(r.Ur.removeMatchingKeys(i,u.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(i,u.addedDocuments,f)));let p=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(_n.EMPTY_BYTE_STRING,Ot.min()).withLastLimboFreeSnapshotVersion(Ot.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(f,p),function(y,_,x){return y.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(h,p,u)&&o.push(r.Ur.updateTargetData(i,p))});let l=wi(),c=qt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),o.push(kO(i,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ot.min())){const u=r.Ur.getLastRemoteSnapshotVersion(i).next(f=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(u)}return Qe.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.os=s,i))}function kO(t,e,r){let n=qt(),s=qt();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=wi();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ot.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):gt("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function DO(t,e){const r=Lt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function PO(t,e){const r=Lt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,Qe.resolve(s)):r.Ur.allocateTargetId(n).next(a=>(s=new Qi(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Cv(t,e,r){const n=Lt(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Jd(a))throw a;gt("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function JE(t,e,r){const n=Lt(t);let s=Ot.min(),i=qt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const f=Lt(l),h=f._s.get(u);return h!==void 0?Qe.resolve(f.os.get(h)):f.Ur.getTargetData(c,u)}(n,a,Oa(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?s:Ot.min(),r?i:qt())).next(o=>(RO(n,bN(e),o),{documents:o,Ts:i})))}function RO(t,e,r){let n=t.us.get(e)||Ot.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class ZE{constructor(){this.activeTargetIds=CN()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class FO{constructor(){this.so=new ZE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ZE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){gt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){gt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jf=null;function xm(){return jf===null?jf=function(){return 268435456+Math.round(2147483648*Math.random())}():jf++,"0x"+jf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="WebChannelConnection";class LO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,a){const o=xm(),l=this.xo(r,n.toUriEncodedString());gt("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,a),this.No(r,l,c,s).then(u=>(gt("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw rl("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,i,a,o){return this.Mo(r,n,s,i,a)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Uc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>r[a]=i),s&&s.headers.forEach((i,a)=>r[a]=i)}xo(r,n){const s=OO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=xm();return new Promise((a,o)=>{const l=new Jw;l.setWithCredentials(!0),l.listenOnce(Zw.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case w0.NO_ERROR:const u=l.getResponseJson();gt($n,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),a(u);break;case w0.TIMEOUT:gt($n,`RPC '${e}' ${i} timed out`),o(new st(Ge.DEADLINE_EXCEEDED,"Request time out"));break;case w0.HTTP_ERROR:const f=l.getStatus();if(gt($n,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const g=function(_){const x=_.toLowerCase().replace(/_/g,"-");return Object.values(Ge).indexOf(x)>=0?x:Ge.UNKNOWN}(p.status);o(new st(g,p.message))}else o(new st(Ge.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new st(Ge.UNAVAILABLE,"Connection failed."));break;default:Pt()}}finally{gt($n,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);gt($n,`RPC '${e}' ${i} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const s=xm(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=rC(),o=tC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=i.join("");gt($n,`Creating RPC '${e}' stream ${s}: ${u}`,l);const f=a.createWebChannel(u,l);let h=!1,p=!1;const g=new MO({Io:_=>{p?gt($n,`Not sending because RPC '${e}' stream ${s} is closed:`,_):(h||(gt($n,`Opening RPC '${e}' stream ${s} transport.`),f.open(),h=!0),gt($n,`RPC '${e}' stream ${s} sending:`,_),f.send(_))},To:()=>f.close()}),y=(_,x,b)=>{_.listen(x,v=>{try{b(v)}catch(T){setTimeout(()=>{throw T},0)}})};return y(f,xu.EventType.OPEN,()=>{p||(gt($n,`RPC '${e}' stream ${s} transport opened.`),g.yo())}),y(f,xu.EventType.CLOSE,()=>{p||(p=!0,gt($n,`RPC '${e}' stream ${s} transport closed`),g.So())}),y(f,xu.EventType.ERROR,_=>{p||(p=!0,rl($n,`RPC '${e}' stream ${s} transport errored:`,_),g.So(new st(Ge.UNAVAILABLE,"The operation could not be completed")))}),y(f,xu.EventType.MESSAGE,_=>{var x;if(!p){const b=_.data[0];pr(!!b);const v=b,T=v.error||((x=v[0])===null||x===void 0?void 0:x.error);if(T){gt($n,`RPC '${e}' stream ${s} received error:`,T);const D=T.status;let k=function(m){const A=Zr[m];if(A!==void 0)return wC(A)}(D),S=T.message;k===void 0&&(k=Ge.INTERNAL,S="Unknown error status: "+D+" with message "+T.message),p=!0,g.So(new st(k,S)),f.close()}else gt($n,`RPC '${e}' stream ${s} received:`,b),g.bo(b)}}),y(o,eC.STAT_EVENT,_=>{_.stat===vv.PROXY?gt($n,`RPC '${e}' stream ${s} detected buffering proxy`):_.stat===vv.NOPROXY&&gt($n,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function Em(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sp(t){return new KN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&gt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,r,n,s,i,a,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new BC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Ge.RESOURCE_EXHAUSTED?(Ti(r.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new st(Ge.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return gt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(gt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class BO extends UC{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=YN(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ot.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ot.min():a.readTime?Ma(a.readTime):Ot.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=wv(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=bv(l)?{documents:ZN(i,l)}:{query:eO(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=kC(i,a.resumeToken);const c=Sv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ot.min())>0){o.readTime=ph(i,a.snapshotVersion.toTimestamp());const c=Sv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=rO(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=wv(this.serializer),r.removeTarget=e,this.a_(r)}}class UO extends UC{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return pr(!!e.streamToken),this.lastStreamToken=e.streamToken,pr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){pr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=JN(e.writeResults,e.commitTime),n=Ma(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=wv(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>QN(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new st(Ge.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Av(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new st(Ge.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Av(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new st(Ge.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class VO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ti(r),this.D_=!1):gt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{n.enqueueAndForget(async()=>{vl(this)&&(gt("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Lt(l);c.L_.add(4),await tf(c),c.q_.set("Unknown"),c.L_.delete(4),await Ap(c)}(this))})}),this.q_=new VO(n,s)}}async function Ap(t){if(vl(t))for(const e of t.B_)await e(!0)}async function tf(t){for(const e of t.B_)await e(!1)}function $C(t,e){const r=Lt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),vy(r)?gy(r):Vc(r).r_()&&my(r,e))}function py(t,e){const r=Lt(t),n=Vc(r);r.N_.delete(e),n.r_()&&VC(r,e),r.N_.size===0&&(n.r_()?n.o_():vl(r)&&r.q_.set("Unknown"))}function my(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ot.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Vc(t).A_(e)}function VC(t,e){t.Q_.xe(e),Vc(t).R_(e)}function gy(t){t.Q_=new jN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Vc(t).start(),t.q_.v_()}function vy(t){return vl(t)&&!Vc(t).n_()&&t.N_.size>0}function vl(t){return Lt(t).L_.size===0}function HC(t){t.Q_=void 0}async function jO(t){t.q_.set("Online")}async function GO(t){t.N_.forEach((e,r)=>{my(t,e)})}async function WO(t,e){HC(t),vy(t)?(t.q_.M_(e),gy(t)):t.q_.set("Unknown")}async function zO(t,e,r){if(t.q_.set("Online"),e instanceof IC&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){gt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await mh(t,n)}else if(e instanceof k0?t.Q_.Ke(e):e instanceof CC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ot.min()))try{const n=await LC(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(_n.EMPTY_BYTE_STRING,u.snapshotVersion)),VC(i,l);const f=new Qi(u.target,l,c,u.sequenceNumber);my(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){gt("RemoteStore","Failed to raise snapshot:",n),await mh(t,n)}}async function mh(t,e,r){if(!Jd(e))throw e;t.L_.add(1),await tf(t),t.q_.set("Offline"),r||(r=()=>LC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{gt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Ap(t)})}function jC(t,e){return e().catch(r=>mh(t,r,e))}async function Tp(t){const e=Lt(t),r=po(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;KO(e);)try{const s=await DO(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,qO(e,s)}catch(s){await mh(e,s)}GC(e)&&WC(e)}function KO(t){return vl(t)&&t.O_.length<10}function qO(t,e){t.O_.push(e);const r=po(t);r.r_()&&r.V_&&r.m_(e.mutations)}function GC(t){return vl(t)&&!po(t).n_()&&t.O_.length>0}function WC(t){po(t).start()}async function XO(t){po(t).p_()}async function YO(t){const e=po(t);for(const r of t.O_)e.m_(r.mutations)}async function QO(t,e,r){const n=t.O_.shift(),s=ly.from(n,e,r);await jC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Tp(t)}async function JO(t,e){e&&po(t).V_&&await async function(n,s){if(function(a){return $N(a)&&a!==Ge.ABORTED}(s.code)){const i=n.O_.shift();po(n).s_(),await jC(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Tp(n)}}(t,e),GC(t)&&WC(t)}async function tb(t,e){const r=Lt(t);r.asyncQueue.verifyOperationInProgress(),gt("RemoteStore","RemoteStore received new credentials");const n=vl(r);r.L_.add(3),await tf(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Ap(r)}async function ZO(t,e){const r=Lt(t);e?(r.L_.delete(2),await Ap(r)):e||(r.L_.add(2),await tf(r),r.q_.set("Unknown"))}function Vc(t){return t.K_||(t.K_=function(r,n,s){const i=Lt(r);return i.w_(),new BO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:jO.bind(null,t),Ro:GO.bind(null,t),mo:WO.bind(null,t),d_:zO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),vy(t)?gy(t):t.q_.set("Unknown")):(await t.K_.stop(),HC(t))})),t.K_}function po(t){return t.U_||(t.U_=function(r,n,s){const i=Lt(r);return i.w_(),new UO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:XO.bind(null,t),mo:JO.bind(null,t),f_:YO.bind(null,t),g_:QO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Tp(t)):(await t.U_.stop(),t.O_.length>0&&(gt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new yy(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new st(Ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xy(t,e){if(Ti("AsyncQueue",`${e}: ${t}`),Jd(t))return new st(Ge.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Et.comparator(r.key,n.key):(r,n)=>Et.comparator(r.key,n.key),this.keyedMap=Eu(),this.sortedSet=new Or(this.comparator)}static emptySet(e){return new dc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof dc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new dc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(){this.W_=new Or(Et.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Pt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class kc{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new kc(e,r,dc.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class t7{constructor(){this.queries=nb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Lt(r),i=s.queries;s.queries=nb(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new st(Ge.ABORTED,"Firestore shutting down"))}}function nb(){return new $c(t=>pC(t),vp)}async function Ey(t,e){const r=Lt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new e7,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=xy(a,`Initialization of query '${Hl(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&_y(r)}async function by(t,e){const r=Lt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function r7(t,e){const r=Lt(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(n=!0);a.z_=s}}n&&_y(r)}function n7(t,e,r){const n=Lt(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function _y(t){t.Y_.forEach(e=>{e.next()})}var Iv,sb;(sb=Iv||(Iv={})).ea="default",sb.Cache="cache";class Sy{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new kc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=kc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Iv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e){this.key=e}}class KC{constructor(e){this.key=e}}class s7{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=qt(),this.mutatedKeys=qt(),this.Aa=mC(e),this.Ra=new dc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new rb,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const h=s.get(u),p=yp(this.query,f)?f:null,g=!!h&&this.mutatedKeys.has(h.key),y=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;h&&p?h.data.isEqual(p.data)?g!==y&&(n.track({type:3,doc:p}),_=!0):this.ga(h,p)||(n.track({type:2,doc:p}),_=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!h&&p?(n.track({type:0,doc:p}),_=!0):h&&!p&&(n.track({type:1,doc:h}),_=!0,(l||c)&&(o=!0)),_&&(p?(a=a.add(p),i=y?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,f)=>function(p,g){const y=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pt()}};return y(p)-y(g)}(u.type,f.type)||this.Aa(u.doc,f.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new kc(this.query,e.Ra,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new rb,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=qt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new KC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new zC(n))}),r}ba(e){this.Ta=e.Ts,this.da=qt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return kc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class a7{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class i7{constructor(e){this.key=e,this.va=!1}}class o7{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new $c(o=>pC(o),vp),this.Ma=new Map,this.xa=new Set,this.Oa=new Or(Et.comparator),this.Na=new Map,this.La=new dy,this.Ba={},this.ka=new Map,this.qa=Ic.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function l7(t,e,r=!0){const n=ZC(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await qC(n,e,r,!0),s}async function c7(t,e){const r=ZC(t);await qC(r,e,!0,!1)}async function qC(t,e,r,n){const s=await PO(t.localStore,Oa(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await u7(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&$C(t.remoteStore,s),o}async function u7(t,e,r,n,s){t.Ka=(f,h,p)=>async function(y,_,x,b){let v=_.view.ma(x);v.ns&&(v=await JE(y.localStore,_.query,!1).then(({documents:S})=>_.view.ma(S,v)));const T=b&&b.targetChanges.get(_.targetId),D=b&&b.targetMismatches.get(_.targetId)!=null,k=_.view.applyChanges(v,y.isPrimaryClient,T,D);return ib(y,_.targetId,k.wa),k.snapshot}(t,f,h,p);const i=await JE(t.localStore,e,!0),a=new s7(e,i.Ts),o=a.ma(i.documents),l=ef.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);ib(t,r,c.wa);const u=new a7(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function d7(t,e,r){const n=Lt(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(a=>!vp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Cv(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&py(n.remoteStore,s.targetId),kv(n,s.targetId)}).catch(Qd)):(kv(n,s.targetId),await Cv(n.localStore,s.targetId,!0))}async function f7(t,e){const r=Lt(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),py(r.remoteStore,n.targetId))}async function h7(t,e,r){const n=E7(t);try{const s=await function(a,o){const l=Lt(a),c=on.now(),u=o.reduce((p,g)=>p.add(g.key),qt());let f,h;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=wi(),y=qt();return l.cs.getEntries(p,u).next(_=>{g=_,g.forEach((x,b)=>{b.isValidDocument()||(y=y.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(_=>{f=_;const x=[];for(const b of o){const v=ON(b,f.get(b.key).overlayedDocument);v!=null&&x.push(new yo(b.key,v,oC(v.value.mapValue),fs.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,x,o)}).next(_=>{h=_;const x=_.applyToLocalDocumentSet(f,y);return l.documentOverlayCache.saveOverlays(p,_.batchId,x)})}).then(()=>({batchId:h.batchId,changes:vC(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Or(cr)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,s.batchId,r),await rf(n,s.changes),await Tp(n.remoteStore)}catch(s){const i=xy(s,"Failed to persist write");r.reject(i)}}async function XC(t,e){const r=Lt(t);try{const n=await IO(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Na.get(i);a&&(pr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?pr(a.va):s.removedDocuments.size>0&&(pr(a.va),a.va=!1))}),await rf(r,n,e)}catch(n){await Qd(n)}}function ab(t,e,r){const n=Lt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Lt(a);l.onlineState=o;let c=!1;l.queries.forEach((u,f)=>{for(const h of f.j_)h.Z_(o)&&(c=!0)}),c&&_y(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function p7(t,e,r){const n=Lt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let a=new Or(Et.comparator);a=a.insert(i,Kn.newNoDocument(i,Ot.min()));const o=qt().add(i),l=new _p(Ot.min(),new Map,new Or(cr),a,o);await XC(n,l),n.Oa=n.Oa.remove(i),n.Na.delete(e),Ay(n)}else await Cv(n.localStore,e,!1).then(()=>kv(n,e,r)).catch(Qd)}async function m7(t,e){const r=Lt(t),n=e.batch.batchId;try{const s=await CO(r.localStore,e);QC(r,n,null),YC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await rf(r,s)}catch(s){await Qd(s)}}async function g7(t,e,r){const n=Lt(t);try{const s=await function(a,o){const l=Lt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(f=>(pr(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);QC(n,e,r),YC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await rf(n,s)}catch(s){await Qd(s)}}function YC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function QC(t,e,r){const n=Lt(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function kv(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||JC(t,n)})}function JC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(py(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Ay(t))}function ib(t,e,r){for(const n of r)n instanceof zC?(t.La.addReference(n.key,e),v7(t,n)):n instanceof KC?(gt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||JC(t,n.key)):Pt()}function v7(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(gt("SyncEngine","New document in limbo: "+r),t.xa.add(n),Ay(t))}function Ay(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Et(Sr.fromString(e)),n=t.qa.next();t.Na.set(n,new i7(r)),t.Oa=t.Oa.insert(r,n),$C(t.remoteStore,new Qi(Oa(gp(r.path)),n,"TargetPurposeLimboResolution",ty.oe))}}async function rf(t,e,r){const n=Lt(t),s=[],i=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const f=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=hy.Wi(l.targetId,c);i.push(f)}}))}),await Promise.all(a),n.Ca.d_(s),await async function(l,c){const u=Lt(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Qe.forEach(c,h=>Qe.forEach(h.$i,p=>u.persistence.referenceDelegate.addReference(f,h.targetId,p)).next(()=>Qe.forEach(h.Ui,p=>u.persistence.referenceDelegate.removeReference(f,h.targetId,p)))))}catch(f){if(!Jd(f))throw f;gt("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const h=f.targetId;if(!f.fromCache){const p=u.os.get(h),g=p.snapshotVersion,y=p.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(h,y)}}}(n.localStore,i))}async function y7(t,e){const r=Lt(t);if(!r.currentUser.isEqual(e)){gt("SyncEngine","User change. New user:",e.toKey());const n=await MC(r.localStore,e);r.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new st(Ge.CANCELLED,a))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await rf(r,n.hs)}}function x7(t,e){const r=Lt(t),n=r.Na.get(e);if(n&&n.va)return qt().add(n.key);{let s=qt();const i=r.Ma.get(e);if(!i)return s;for(const a of i){const o=r.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function ZC(t){const e=Lt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=XC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=x7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=p7.bind(null,e),e.Ca.d_=r7.bind(null,e.eventManager),e.Ca.$a=n7.bind(null,e.eventManager),e}function E7(t){const e=Lt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=m7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=g7.bind(null,e),e}class gh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Sp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return wO(this.persistence,new AO,e.initialUser,this.serializer)}Ga(e){return new bO(fy.Zr,this.serializer)}Wa(e){return new FO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gh.provider={build:()=>new gh};class Dv{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ab(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=y7.bind(null,this.syncEngine),await ZO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new t7}()}createDatastore(e){const r=Sp(e.databaseInfo.databaseId),n=function(i){return new LO(i)}(e.databaseInfo);return function(i,a,o,l){return new $O(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new HO(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>ab(this.syncEngine,r,0),function(){return eb.D()?new eb:new NO}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,u){const f=new o7(s,i,a,o,l,c);return u&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Lt(s);gt("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await tf(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Dv.provider={build:()=>new Dv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ti("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Gn.UNAUTHENTICATED,this.clientId=ey.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{gt("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(gt("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=xy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function bm(t,e){t.asyncQueue.verifyOperationInProgress(),gt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await MC(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ob(t,e){t.asyncQueue.verifyOperationInProgress();const r=await _7(t);gt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>tb(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>tb(e.remoteStore,s)),t._onlineComponents=e}async function _7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){gt("FirestoreClient","Using user provided OfflineComponentProvider");try{await bm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===Ge.FAILED_PRECONDITION||s.code===Ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;rl("Error using user provided cache. Falling back to memory cache: "+r),await bm(t,new gh)}}else gt("FirestoreClient","Using default OfflineComponentProvider"),await bm(t,new gh);return t._offlineComponents}async function eI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(gt("FirestoreClient","Using user provided OnlineComponentProvider"),await ob(t,t._uninitializedComponentsProvider._online)):(gt("FirestoreClient","Using default OnlineComponentProvider"),await ob(t,new Dv))),t._onlineComponents}function S7(t){return eI(t).then(e=>e.syncEngine)}async function vh(t){const e=await eI(t),r=e.eventManager;return r.onListen=l7.bind(null,e.syncEngine),r.onUnlisten=d7.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=c7.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=f7.bind(null,e.syncEngine),r}function A7(t,e,r={}){const n=new fi;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new Ty({next:h=>{u.Za(),a.enqueueAndForget(()=>by(i,f));const p=h.docs.has(o);!p&&h.fromCache?c.reject(new st(Ge.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&h.fromCache&&l&&l.source==="server"?c.reject(new st(Ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new Sy(gp(o.path),u,{includeMetadataChanges:!0,_a:!0});return Ey(i,f)}(await vh(t),t.asyncQueue,e,r,n)),n.promise}function T7(t,e,r={}){const n=new fi;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new Ty({next:h=>{u.Za(),a.enqueueAndForget(()=>by(i,f)),h.fromCache&&l.source==="server"?c.reject(new st(Ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new Sy(o,u,{includeMetadataChanges:!0,_a:!0});return Ey(i,f)}(await vh(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rI(t,e,r){if(!r)throw new st(Ge.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nI(t,e,r,n){if(e===!0&&n===!0)throw new st(Ge.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function cb(t){if(!Et.isDocumentKey(t))throw new st(Ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ub(t){if(Et.isDocumentKey(t))throw new st(Ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function wp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Pt()}function Zn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new st(Ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=wp(t);throw new st(Ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function w7(t,e){if(e<=0)throw new st(Ge.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new st(Ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new st(Ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tI((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new st(Ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new st(Ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new st(Ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cp{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new db({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new st(Ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new st(Ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new db(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new sC;switch(n.type){case"firstParty":return new K5(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new st(Ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=lb.get(r);n&&(gt("ComponentProvider","Removing Datastore"),lb.delete(r),n.terminate())}(this),Promise.resolve()}}function sI(t,e,r,n={}){var s;const i=(t=Zn(t,Cp))._getSettings(),a=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&rl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Gn.MOCK_USER;else{o=ow(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new st(Ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Gn(c)}t._authCredentials=new G5(new nC(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ba(this.firestore,e,this._query)}}class Nn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nn(this.firestore,e,this._key)}}class hi extends ba{constructor(e,r,n){super(e,r,gp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nn(this.firestore,null,new Et(e))}withConverter(e){return new hi(this.firestore,e,this._path)}}function At(t,e,...r){if(t=dr(t),rI("collection","path",e),t instanceof Cp){const n=Sr.fromString(e,...r);return ub(n),new hi(t,null,n)}{if(!(t instanceof Nn||t instanceof hi))throw new st(Ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Sr.fromString(e,...r));return ub(n),new hi(t.firestore,null,n)}}function et(t,e,...r){if(t=dr(t),arguments.length===1&&(e=ey.newId()),rI("doc","path",e),t instanceof Cp){const n=Sr.fromString(e,...r);return cb(n),new Nn(t,null,new Et(n))}{if(!(t instanceof Nn||t instanceof hi))throw new st(Ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Sr.fromString(e,...r));return cb(n),new Nn(t.firestore,t instanceof hi?t.converter:null,new Et(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new BC(this,"async_queue_retry"),this.Vu=()=>{const n=Em();n&&gt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Em();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Em();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new fi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Jd(e))throw e;gt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Ti("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=yy.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Pt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function hb(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ya extends Cp{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new fb,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new fb(e),this._firestoreClient=void 0,await e}}}function xo(t,e){const r=typeof t=="object"?t:Kd(),n=typeof t=="string"?t:"(default)",s=zd(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=N1("firestore");i&&sI(s,...i)}return s}function Hc(t){if(t._terminated)throw new st(Ge.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||C7(t),t._firestoreClient}function C7(t){var e,r,n;const s=t._freezeSettings(),i=function(o,l,c,u){return new iN(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,tI(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new b7(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this._byteString=e}static fromBase64String(e){try{return new al(_n.fromBase64String(e))}catch(r){throw new st(Ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new al(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new st(Ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new st(Ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new st(Ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return cr(this._lat,e._lat)||cr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I7=/^__.*__$/;class k7{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,r,this.fieldTransforms):new Zd(e,this.data,r,this.fieldTransforms)}}class aI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new yo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function iI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pt()}}class wy{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new wy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(iI(this.Cu)&&I7.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class D7{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Sp(e)}Qu(e,r,n,s=!1){return new wy({Cu:e,methodName:r,qu:n,path:xn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gc(t){const e=t._freezeSettings(),r=Sp(t._databaseId);return new D7(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Cy(t,e,r,n,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);ky("Data must be an object, but it was:",a,n);const o=uI(n,a);let l,c;if(i.merge)l=new Rs(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const h=Pv(e,f,r);if(!a.contains(h))throw new st(Ge.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);fI(u,h)||u.push(h)}l=new Rs(u),c=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=a.fieldTransforms;return new k7(new _s(o),l,c)}class sf extends nf{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sf}}class Iy extends nf{_toFieldTransform(e){return new PN(e.path,new Sd)}isEqual(e){return e instanceof Iy}}function oI(t,e,r,n){const s=t.Qu(1,e,r);ky("Data must be an object, but it was:",s,n);const i=[],a=_s.empty();ml(n,(l,c)=>{const u=Dy(e,l,r);c=dr(c);const f=s.Nu(u);if(c instanceof sf)i.push(u);else{const h=af(c,f);h!=null&&(i.push(u),a.set(u,h))}});const o=new Rs(i);return new aI(a,o,s.fieldTransforms)}function lI(t,e,r,n,s,i){const a=t.Qu(1,e,r),o=[Pv(e,n,r)],l=[s];if(i.length%2!=0)throw new st(Ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(Pv(e,i[h])),l.push(i[h+1]);const c=[],u=_s.empty();for(let h=o.length-1;h>=0;--h)if(!fI(c,o[h])){const p=o[h];let g=l[h];g=dr(g);const y=a.Nu(p);if(g instanceof sf)c.push(p);else{const _=af(g,y);_!=null&&(c.push(p),u.set(p,_))}}const f=new Rs(c);return new aI(u,f,a.fieldTransforms)}function cI(t,e,r,n=!1){return af(r,t.Qu(n?4:3,e))}function af(t,e){if(dI(t=dr(t)))return ky("Unsupported field value:",e,t),uI(t,e);if(t instanceof nf)return function(n,s){if(!iI(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=af(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=dr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return IN(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=on.fromDate(n);return{timestampValue:ph(s.serializer,i)}}if(n instanceof on){const i=new on(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ph(s.serializer,i)}}if(n instanceof Ip)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof al)return{bytesValue:kC(s.serializer,n._byteString)};if(n instanceof Nn){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:uy(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof kp)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return oy(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${wp(n)}`)}(t,e)}function uI(t,e){const r={};return aC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ml(t,(n,s)=>{const i=af(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function dI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof on||t instanceof Ip||t instanceof al||t instanceof Nn||t instanceof nf||t instanceof kp)}function ky(t,e,r){if(!dI(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=wp(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Pv(t,e,r){if((e=dr(e))instanceof jc)return e._internalPath;if(typeof e=="string")return Dy(t,e);throw yh("Field path arguments must be of type string or ",t,!1,void 0,r)}const P7=new RegExp("[~\\*/\\[\\]]");function Dy(t,e,r){if(e.search(P7)>=0)throw yh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new jc(...e.split("."))._internalPath}catch{throw yh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function yh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new st(Ge.INVALID_ARGUMENT,o+t+l)}function fI(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new R7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Dp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class R7 extends Py{data(){return super.data()}}function Dp(t,e){return typeof e=="string"?Dy(t,e):e instanceof jc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new st(Ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ry{}class of extends Ry{}function lr(t,e,...r){let n=[];e instanceof Ry&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof Pp).length,o=i.filter(l=>l instanceof lf).length;if(a>1||a>0&&o>0)throw new st(Ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class lf extends of{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new lf(e,r,n)}_apply(e){const r=this._parse(e);return pI(e._query,r),new ba(e.firestore,e.converter,_v(e._query,r))}_parse(e){const r=Gc(e.firestore);return function(i,a,o,l,c,u,f){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new st(Ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){mb(f,u);const p=[];for(const g of f)p.push(pb(l,i,g));h={arrayValue:{values:p}}}else h=pb(l,i,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||mb(f,u),h=cI(o,a,f,u==="in"||u==="not-in");return sn.create(c,u,h)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ur(t,e,r){const n=e,s=Dp("where",t);return lf._create(s,n,r)}class Pp extends Ry{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Pp(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:va.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)pI(a,l),a=_v(a,l)}(e._query,r),new ba(e.firestore,e.converter,_v(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Rp extends of{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Rp(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new st(Ge.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new st(Ge.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _d(i,a)}(e._query,this._field,this._direction);return new ba(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new gl(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function vn(t,e="asc"){const r=e,n=Dp("orderBy",t);return Rp._create(n,r)}class Fp extends of{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Fp(e,r,n)}_apply(e){return new ba(e.firestore,e.converter,fh(e._query,this._limit,this._limitType))}}function la(t){return w7("limit",t),Fp._create("limit",t,"F")}class Np extends of{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new Np(e,r,n)}_apply(e){const r=F7(e,this.type,this._docOrFields,this._inclusive);return new ba(e.firestore,e.converter,function(s,i){return new gl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,r))}}function xh(...t){return Np._create("startAfter",t,!1)}function F7(t,e,r,n){if(r[0]=dr(r[0]),r[0]instanceof Py)return function(i,a,o,l,c){if(!l)throw new st(Ge.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const f of uc(i))if(f.field.isKeyField())u.push(dh(a,l.key));else{const h=l.data.field(f.field);if(mp(h))throw new st(Ge.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const p=f.field.canonicalString();throw new st(Ge.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}u.push(h)}return new Cc(u,c)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const s=Gc(t.firestore);return function(a,o,l,c,u,f){const h=a.explicitOrderBy;if(u.length>h.length)throw new st(Ge.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let g=0;g<u.length;g++){const y=u[g];if(h[g].field.isKeyField()){if(typeof y!="string")throw new st(Ge.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof y}`);if(!iy(a)&&y.indexOf("/")!==-1)throw new st(Ge.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${y}' contains a slash.`);const _=a.path.child(Sr.fromString(y));if(!Et.isDocumentKey(_))throw new st(Ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);const x=new Et(_);p.push(dh(o,x))}else{const _=cI(l,c,y);p.push(_)}}return new Cc(p,f)}(t._query,t.firestore._databaseId,s,e,r,n)}}function pb(t,e,r){if(typeof(r=dr(r))=="string"){if(r==="")throw new st(Ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iy(e)&&r.indexOf("/")!==-1)throw new st(Ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Sr.fromString(r));if(!Et.isDocumentKey(n))throw new st(Ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return dh(t,new Et(n))}if(r instanceof Nn)return dh(t,r._key);throw new st(Ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wp(r)}.`)}function mb(t,e){if(!Array.isArray(t)||t.length===0)throw new st(Ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pI(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new st(Ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new st(Ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class mI{convertValue(e,r="none"){switch(sl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(nl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Pt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ml(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(a=>Kr(a.doubleValue));return new kp(i)}convertGeoPoint(e){return new Ip(Kr(e.latitude),Kr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ry(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ed(e));default:return null}}convertTimestamp(e){const r=ho(e);return new on(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Sr.fromString(e);pr(OC(n));const s=new Ac(n.get(1),n.get(3)),i=new Et(n.popFirst(5));return s.isEqual(r)||Ti(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ny extends Py{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Gu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Dp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Gu extends Ny{data(e={}){return super.data(e)}}class Oy{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Yl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Gu(this._firestore,this._userDataWriter,n.key,n,new Yl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new st(Ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new Gu(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Yl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new Gu(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Yl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:N7(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function N7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t){t=Zn(t,Nn);const e=Zn(t.firestore,ya);return A7(Hc(e),t._key).then(r=>vI(e,t,r))}class My extends mI{constructor(e){super(),this.firestore=e}convertBytes(e){return new al(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Nn(this.firestore,null,r)}}function Gt(t){t=Zn(t,ba);const e=Zn(t.firestore,ya),r=Hc(e),n=new My(e);return hI(t._query),T7(r,t._query).then(s=>new Oy(e,n,t,s))}function $t(t,e,r){t=Zn(t,Nn);const n=Zn(t.firestore,ya),s=Fy(t.converter,e,r);return Wc(n,[Cy(Gc(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,fs.none())])}function Op(t,e,r,...n){t=Zn(t,Nn);const s=Zn(t.firestore,ya),i=Gc(s);let a;return a=typeof(e=dr(e))=="string"||e instanceof jc?lI(i,"updateDoc",t._key,e,r,n):oI(i,"updateDoc",t._key,e),Wc(s,[a.toMutation(t._key,fs.exists(!0))])}function mo(t){return Wc(Zn(t.firestore,ya),[new bp(t._key,fs.none())])}function gI(t,e){const r=Zn(t.firestore,ya),n=et(t),s=Fy(t.converter,e);return Wc(r,[Cy(Gc(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,fs.exists(!1))]).then(()=>n)}function cf(t,...e){var r,n,s;t=dr(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||hb(e[a])||(i=e[a],a++);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(hb(e[a])){const f=e[a];e[a]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[a+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[a+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,u;if(t instanceof Nn)c=Zn(t.firestore,ya),u=gp(t._key.path),l={next:f=>{e[a]&&e[a](vI(c,t,f))},error:e[a+1],complete:e[a+2]};else{const f=Zn(t,ba);c=Zn(f.firestore,ya),u=f._query;const h=new My(c);l={next:p=>{e[a]&&e[a](new Oy(c,h,f,p))},error:e[a+1],complete:e[a+2]},hI(t._query)}return function(h,p,g,y){const _=new Ty(y),x=new Sy(p,_,g);return h.asyncQueue.enqueueAndForget(async()=>Ey(await vh(h),x)),()=>{_.Za(),h.asyncQueue.enqueueAndForget(async()=>by(await vh(h),x))}}(Hc(c),u,o,l)}function Wc(t,e){return function(n,s){const i=new fi;return n.asyncQueue.enqueueAndForget(async()=>h7(await S7(n),s,i)),i.promise}(Hc(t),e)}function vI(t,e,r){const n=r.docs.get(e._key),s=new My(t);return new Ny(t,s,e._key,n,new Yl(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Gc(e)}set(e,r,n){this._verifyNotCommitted();const s=_m(e,this._firestore),i=Fy(s.converter,r,n),a=Cy(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,fs.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=_m(e,this._firestore);let a;return a=typeof(r=dr(r))=="string"||r instanceof jc?lI(this._dataReader,"WriteBatch.update",i._key,r,n,s):oI(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,fs.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=_m(e,this._firestore);return this._mutations=this._mutations.concat(new bp(r._key,fs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new st(Ge.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _m(t,e){if((t=dr(t)).firestore!==e)throw new st(Ge.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(){return new sf("deleteField")}function Pn(){return new Iy("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ly(t){return Hc(t=Zn(t,ya)),new yI(t,e=>Wc(t,e))}(function(e,r=!0){(function(s){Uc=s})(pl),lo(new _i("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new ya(new W5(n.getProvider("auth-internal")),new X5(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new st(Ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ac(c.options.projectId,u)}(a,s),a);return i=Object.assign({useFetchStreams:r},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Ws(PE,"4.7.3",e),Ws(PE,"4.7.3","esm2017")})();const O7=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:mI,Bytes:al,CollectionReference:hi,DocumentReference:Nn,DocumentSnapshot:Ny,FieldPath:jc,FieldValue:nf,Firestore:ya,FirestoreError:st,GeoPoint:Ip,Query:ba,QueryCompositeFilterConstraint:Pp,QueryConstraint:of,QueryDocumentSnapshot:Gu,QueryFieldFilterConstraint:lf,QueryLimitConstraint:Fp,QueryOrderByConstraint:Rp,QuerySnapshot:Oy,QueryStartAtConstraint:Np,SnapshotMetadata:Yl,Timestamp:on,VectorValue:kp,WriteBatch:yI,_AutoId:ey,_ByteString:_n,_DatabaseId:Ac,_DocumentKey:Et,_EmptyAuthCredentialsProvider:sC,_FieldPath:xn,_cast:Zn,_logWarn:rl,_validateIsNotUsedTogether:nI,addDoc:gI,collection:At,connectFirestoreEmulator:sI,deleteDoc:mo,deleteField:xI,doc:et,ensureFirestoreConfigured:Hc,executeWrite:Wc,getDoc:er,getDocs:Gt,getFirestore:xo,limit:la,onSnapshot:cf,orderBy:vn,query:lr,serverTimestamp:Pn,setDoc:$t,startAfter:xh,updateDoc:Op,where:Ur,writeBatch:Ly},Symbol.toStringTag,{value:"Module"}));var M7="firebase",L7="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ws(M7,L7,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI="firebasestorage.googleapis.com",bI="storageBucket",B7=2*60*1e3,U7=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Ea{constructor(e,r,n=0){super(Sm(e),`Firebase Storage: ${r} (${Sm(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Wr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Sm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var jr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(jr||(jr={}));function Sm(t){return"storage/"+t}function By(){const t="An unknown error occurred, please check the error payload for server response.";return new Wr(jr.UNKNOWN,t)}function $7(t){return new Wr(jr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function V7(t){return new Wr(jr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function H7(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Wr(jr.UNAUTHENTICATED,t)}function j7(){return new Wr(jr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function G7(t){return new Wr(jr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function W7(){return new Wr(jr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function z7(){return new Wr(jr.CANCELED,"User canceled the upload/download.")}function K7(t){return new Wr(jr.INVALID_URL,"Invalid URL '"+t+"'.")}function q7(t){return new Wr(jr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function X7(){return new Wr(jr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+bI+"' property when initializing the app?")}function Y7(){return new Wr(jr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Q7(t){return new Wr(jr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Eh(t){return new Wr(jr.INVALID_ARGUMENT,t)}function _I(){return new Wr(jr.APP_DELETED,"The Firebase app was deleted.")}function SI(t){return new Wr(jr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Wu(t,e){return new Wr(jr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ou(t){throw new Wr(jr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Qn.makeFromUrl(e,r)}catch{return new Qn(e,"")}if(n.path==="")return n;throw q7(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function c(T){T.path_=decodeURIComponent(T.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${u}/b/${s}/o${h}`,"i"),g={bucket:1,path:3},y=r===EI?"(?:storage.googleapis.com|storage.cloud.google.com)":r,_="([^?#]*)",x=new RegExp(`^https?://${y}/${s}/${_}`,"i"),v=[{regex:o,indices:l,postModify:i},{regex:p,indices:g,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let T=0;T<v.length;T++){const D=v[T],k=D.regex.exec(e);if(k){const S=k[D.indices.bucket];let E=k[D.indices.path];E||(E=""),n=new Qn(S,E),D.postModify(n);break}}if(n==null)throw K7(e);return n}}class J7{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z7(t,e,r){let n=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(..._){c||(c=!0,e.apply(null,_))}function f(_){s=setTimeout(()=>{s=null,t(p,l())},_)}function h(){i&&clearTimeout(i)}function p(_,...x){if(c){h();return}if(_){h(),u.call(null,_,...x);return}if(l()||a){h(),u.call(null,_,...x);return}n<64&&(n*=2);let v;o===1?(o=2,v=0):v=(n+Math.random())*1e3,f(v)}let g=!1;function y(_){g||(g=!0,h(),!c&&(s!==null?(_||(o=2),clearTimeout(s),f(0)):_||(o=1)))}return f(0),i=setTimeout(()=>{a=!0,y(!0)},r),y}function e9(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t9(t){return t!==void 0}function r9(t){return typeof t=="object"&&!Array.isArray(t)}function AI(t){return typeof t=="string"||t instanceof String}function gb(t){return Uy()&&t instanceof Blob}function Uy(){return typeof Blob<"u"}function Rv(t,e,r,n){if(n<e)throw Eh(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw Eh(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function n9(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var zo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(zo||(zo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s9(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a9{constructor(e,r,n,s,i,a,o,l,c,u,f,h=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Gf(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===zo.NO_ERROR,l=i.getStatus();if(!o||s9(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===zo.ABORT;n(!1,new Gf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Gf(c,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());t9(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=By();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?_I():z7();a(l)}else{const l=W7();a(l)}};this.canceled_?r(!1,new Gf(!1,null,!0)):this.backoffId_=Z7(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&e9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gf{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function i9(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function o9(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function l9(t,e){e&&(t["X-Firebase-GMPID"]=e)}function c9(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function u9(t,e,r,n,s,i,a=!0){const o=n9(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return l9(c,e),i9(c,r),o9(c,i),c9(c,n),new a9(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d9(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function f9(...t){const e=d9();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(Uy())return new Blob(t);throw new Wr(jr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function h9(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p9(t){if(typeof atob>"u")throw Q7("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Am{constructor(e,r){this.data=e,this.contentType=r||null}}function Vy(t,e){switch(t){case Hs.RAW:return new Am(TI(e));case Hs.BASE64:case Hs.BASE64URL:return new Am(wI(t,e));case Hs.DATA_URL:return new Am(g9(e),v9(e))}throw By()}function TI(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const i=n,a=t.charCodeAt(++r);n=65536|(i&1023)<<10|a&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function m9(t){let e;try{e=decodeURIComponent(t)}catch{throw Wu(Hs.DATA_URL,"Malformed data URL.")}return TI(e)}function wI(t,e){switch(t){case Hs.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Wu(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Hs.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Wu(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=p9(e)}catch(s){throw s.message.includes("polyfill")?s:Wu(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class CI{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Wu(Hs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=y9(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function g9(t){const e=new CI(t);return e.base64?wI(Hs.BASE64,e.rest):m9(e.rest)}function v9(t){return new CI(t).contentType}function y9(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,r){let n=0,s="";gb(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,r){if(gb(this.data_)){const n=this.data_,s=h9(n,e,r);return s===null?null:new ii(s)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new ii(n,!0)}}static getBlob(...e){if(Uy()){const r=e.map(n=>n instanceof ii?n.data_:n);return new ii(f9.apply(null,r))}else{const r=e.map(a=>AI(a)?Vy(Hs.RAW,a).data:a.data_);let n=0;r.forEach(a=>{n+=a.byteLength});const s=new Uint8Array(n);let i=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)s[i++]=a[o]}),new ii(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function II(t){let e;try{e=JSON.parse(t)}catch{return null}return r9(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x9(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function E9(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function kI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b9(t,e){return e}class ss{constructor(e,r,n,s){this.server=e,this.local=r||e,this.writable=!!n,this.xform=s||b9}}let Wf=null;function _9(t){return!AI(t)||t.length<2?t:kI(t)}function S9(){if(Wf)return Wf;const t=[];t.push(new ss("bucket")),t.push(new ss("generation")),t.push(new ss("metageneration")),t.push(new ss("name","fullPath",!0));function e(i,a){return _9(a)}const r=new ss("name");r.xform=e,t.push(r);function n(i,a){return a!==void 0?Number(a):a}const s=new ss("size");return s.xform=n,t.push(s),t.push(new ss("timeCreated")),t.push(new ss("updated")),t.push(new ss("md5Hash",null,!0)),t.push(new ss("cacheControl",null,!0)),t.push(new ss("contentDisposition",null,!0)),t.push(new ss("contentEncoding",null,!0)),t.push(new ss("contentLanguage",null,!0)),t.push(new ss("contentType",null,!0)),t.push(new ss("metadata","customMetadata",!0)),Wf=t,Wf}function A9(t,e){function r(){const n=t.bucket,s=t.fullPath,i=new Qn(n,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:r})}function T9(t,e,r){const n={};n.type="file";const s=r.length;for(let i=0;i<s;i++){const a=r[i];n[a.local]=a.xform(n,e[a.server])}return A9(n,t),n}function w9(t,e,r){const n=II(e);return n===null?null:T9(t,n,r)}function C9(t,e){const r={},n=e.length;for(let s=0;s<n;s++){const i=e[s];i.writable&&(r[i.server]=t[i.local])}return JSON.stringify(r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb="prefixes",yb="items";function I9(t,e,r){const n={prefixes:[],items:[],nextPageToken:r.nextPageToken};if(r[vb])for(const s of r[vb]){const i=s.replace(/\/$/,""),a=t._makeStorageReference(new Qn(e,i));n.prefixes.push(a)}if(r[yb])for(const s of r[yb]){const i=t._makeStorageReference(new Qn(e,s.name));n.items.push(i)}return n}function k9(t,e,r){const n=II(r);return n===null?null:I9(t,e,n)}class Hy{constructor(e,r,n,s){this.url=e,this.method=r,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t){if(!t)throw By()}function D9(t,e){function r(n,s){const i=w9(t,s,e);return DI(i!==null),i}return r}function P9(t,e){function r(n,s){const i=k9(t,e,s);return DI(i!==null),i}return r}function jy(t){function e(r,n){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=j7():s=H7():r.getStatus()===402?s=V7(t.bucket):r.getStatus()===403?s=G7(t.path):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}return e}function R9(t){const e=jy(t);function r(n,s){let i=e(n,s);return n.getStatus()===404&&(i=$7(t.path)),i.serverResponse=s.serverResponse,i}return r}function F9(t,e,r,n,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",r.length>0&&(i.delimiter=r),n&&(i.pageToken=n),s&&(i.maxResults=s);const a=e.bucketOnlyServerUrl(),o=$y(a,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new Hy(o,l,P9(t,e.bucket),c);return u.urlParams=i,u.errorHandler=jy(e),u}function N9(t,e){const r=e.fullServerUrl(),n=$y(r,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(l,c){}const o=new Hy(n,s,a,i);return o.successCodes=[200,204],o.errorHandler=R9(e),o}function O9(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function M9(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=O9(null,e)),n}function L9(t,e,r,n,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let v="";for(let T=0;T<2;T++)v=v+Math.random().toString().slice(2);return v}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=M9(e,n,s),u=C9(c,r),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",p=ii.getBlob(f,n,h);if(p===null)throw Y7();const g={name:c.fullPath},y=$y(i,t.host,t._protocol),_="POST",x=t.maxUploadRetryTime,b=new Hy(y,_,D9(t,r),x);return b.urlParams=g,b.headers=a,b.body=p.uploadData(),b.errorHandler=jy(e),b}class B9{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,s){if(this.sent_)throw ou("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ou("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ou("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ou("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ou("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class U9 extends B9{initXhr(){this.xhr_.responseType="text"}}function Gy(){return new U9}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,r){this._service=e,r instanceof Qn?this._location=r:this._location=Qn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new il(e,r)}get root(){const e=new Qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kI(this._location.path)}get storage(){return this._service}get parent(){const e=x9(this._location.path);if(e===null)return null;const r=new Qn(this._location.bucket,e);return new il(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw SI(e)}}function PI(t,e,r){t._throwIfRoot("uploadBytes");const n=L9(t.storage,t._location,S9(),new ii(e,!0),r);return t.storage.makeRequestWithTokens(n,Gy).then(s=>({metadata:s,ref:t}))}function $9(t,e,r=Hs.RAW,n){t._throwIfRoot("uploadString");const s=Vy(r,e),i=Object.assign({},n);return i.contentType==null&&s.contentType!=null&&(i.contentType=s.contentType),PI(t,s.data,i)}function V9(t){const e={prefixes:[],items:[]};return RI(t,e).then(()=>e)}async function RI(t,e,r){const s=await H9(t,{pageToken:r});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await RI(t,e,s.nextPageToken)}function H9(t,e){e!=null&&typeof e.maxResults=="number"&&Rv("options.maxResults",1,1e3,e.maxResults);const r=e||{},n=F9(t.storage,t._location,"/",r.pageToken,r.maxResults);return t.storage.makeRequestWithTokens(n,Gy)}function j9(t){t._throwIfRoot("deleteObject");const e=N9(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Gy)}function G9(t,e){const r=E9(t._location.path,e),n=new Qn(t._location.bucket,r);return new il(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W9(t){return/^[A-Za-z]+:\/\//.test(t)}function z9(t,e){return new il(t,e)}function FI(t,e){if(t instanceof Wy){const r=t;if(r._bucket==null)throw X7();const n=new il(r,r._bucket);return e!=null?FI(n,e):n}else return e!==void 0?G9(t,e):t}function K9(t,e){if(e&&W9(e)){if(t instanceof Wy)return z9(t,e);throw Eh("To use ref(service, url), the first argument must be a Storage instance.")}else return FI(t,e)}function xb(t,e){const r=e==null?void 0:e[bI];return r==null?null:Qn.makeFromBucketSpec(r,t)}function q9(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:ow(s,t.app.options.projectId))}class Wy{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=EI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=B7,this._maxUploadRetryTime=U7,this._requests=new Set,s!=null?this._bucket=Qn.makeFromBucketSpec(s,this._host):this._bucket=xb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qn.makeFromBucketSpec(this._url,e):this._bucket=xb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Rv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Rv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new il(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new J7(_I());{const a=u9(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const Eb="@firebase/storage",bb="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="storage";function OI(t,e,r){return t=dr(t),PI(t,e,r)}function MI(t,e,r,n){return t=dr(t),$9(t,e,r,n)}function LI(t){return t=dr(t),V9(t)}function Fv(t){return t=dr(t),j9(t)}function bh(t,e){return t=dr(t),K9(t,e)}function BI(t=Kd(),e){t=dr(t);const n=zd(t,NI).getImmediate({identifier:e}),s=N1("storage");return s&&UI(n,...s),n}function UI(t,e,r,n={}){q9(t,e,r,n)}function X9(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Wy(r,n,s,e,pl)}function Y9(){lo(new _i(NI,X9,"PUBLIC").setMultipleInstances(!0)),Ws(Eb,bb,""),Ws(Eb,bb,"esm2017")}Y9();const Q9=Object.freeze(Object.defineProperty({__proto__:null,StorageError:Wr,get StorageErrorCode(){return jr},StringFormat:Hs,_FbsBlob:ii,_Location:Qn,_dataFromString:Vy,_invalidArgument:Eh,_invalidRootOperation:SI,connectStorageEmulator:UI,deleteObject:Fv,getStorage:BI,listAll:LI,ref:bh,uploadBytes:OI,uploadString:MI},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9="type.googleapis.com/google.protobuf.Int64Value",Z9="type.googleapis.com/google.protobuf.UInt64Value";function $I(t,e){const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}function Nv(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Nv(e));if(typeof t=="function"||typeof t=="object")return $I(t,e=>Nv(e));throw new Error("Data cannot be encoded in JSON: "+t)}function _h(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case J9:case Z9:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>_h(e)):typeof t=="function"||typeof t=="object"?$I(t,e=>_h(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fc extends Ea{constructor(e,r,n){super(`${zy}/${e}`,r||""),this.details=n}}function eM(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function tM(t,e){let r=eM(t),n=r,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!_b[a])return new fc("internal","internal");r=_b[a],n=a}const o=i.message;typeof o=="string"&&(n=o),s=i.details,s!==void 0&&(s=_h(s))}}catch{}return r==="ok"?null:new fc(r,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov="us-central1";function nM(t){let e=null;return{promise:new Promise((r,n)=>{e=setTimeout(()=>{n(new fc("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class sM{constructor(e,r,n,s,i=Ov,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new rM(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(i);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Ov}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function aM(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}function iM(t,e,r){return n=>lM(t,e,n,r||{})}async function oM(t,e,r,n){r["Content-Type"]="application/json";let s;try{s=await n(t,{method:"POST",body:JSON.stringify(e),headers:r})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function lM(t,e,r,n){const s=t._url(e);return cM(t,s,r,n)}async function cM(t,e,r,n){r=Nv(r);const s={data:r},i={},a=await t.contextProvider.getContext(n.limitedUseAppCheckTokens);a.authToken&&(i.Authorization="Bearer "+a.authToken),a.messagingToken&&(i["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=a.appCheckToken);const o=n.timeout||7e4,l=nM(o),c=await Promise.race([oM(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new fc("cancelled","Firebase Functions instance was deleted.");const u=tM(c.status,c.json);if(u)throw u;if(!c.json)throw new fc("internal","Response is not valid JSON object.");let f=c.json.data;if(typeof f>"u"&&(f=c.json.result),typeof f>"u")throw new fc("internal","Response is missing data field.");return{data:_h(f)}}const Sb="@firebase/functions",Ab="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM="auth-internal",dM="app-check-internal",fM="messaging-internal";function hM(t,e){const r=(n,{instanceIdentifier:s})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(uM),o=n.getProvider(fM),l=n.getProvider(dM);return new sM(i,a,o,l,s,t)};lo(new _i(zy,r,"PUBLIC").setMultipleInstances(!0)),Ws(Sb,Ab,e),Ws(Sb,Ab,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t=Kd(),e=Ov){const n=zd(dr(t),zy).getImmediate({identifier:e}),s=N1("functions");return s&&VI(n,...s),n}function VI(t,e,r){aM(dr(t),e,r)}function Ra(t,e,r){return iM(dr(t),e,r)}hM(fetch.bind(self));const D0=Object.freeze(Object.defineProperty({__proto__:null,connectFunctionsEmulator:VI,getFunctions:hc,httpsCallable:Ra},Symbol.toStringTag,{value:"Module"})),Ky={apiKey:"AIzaSyDx1jbQT-FzgzjASFqVA2kbAHWJ_TeUzdY",authDomain:"casemangervue.firebaseapp.com",projectId:"casemangervue",storageBucket:"casemangervue.firebasestorage.app",messagingSenderId:"756483333257",appId:"1:756483333257:web:694e2ad2415b7886563a58",measurementId:"G-YBRDQX9NFR"},Mp=uw(Ky),bt=uo(Mp);bt.setPersistence(q1).then(()=>{console.log(" Firebase auth persistence set to LOCAL - each tab maintains independent auth state")}).catch(t=>{console.error(" Error setting auth persistence:",t)});const Xe=xo(Mp),Dc=BI(Mp),HI=hc(Mp),qy=new oa,jI=async()=>{try{const t=await fetch(`https://oauth2.googleapis.com/tokeninfo?client_id=${Ky.appId.split(":")[1]}`,{method:"GET"});if(t.ok){const e=await t.json();return!e.error&&(e.aud&&!e.aud.includes("apps.googleusercontent.com")||e.client_type==="confidential")?(qy.addScope("https://www.googleapis.com/auth/gmail.compose"),console.log(" Internal OAuth detected - Gmail scope added"),!0):(console.log(" Public OAuth detected - Gmail scope not added"),!1)}}catch(t){console.warn(" Could not determine OAuth type:",t)}return!1};jI();console.log(" Connected to Firebase project:",Ky.projectId);const GI=Object.freeze(Object.defineProperty({__proto__:null,auth:bt,checkAndAddGmailScope:jI,db:Xe,functions:HI,googleProvider:qy,storage:Dc},Symbol.toStringTag,{value:"Module"}));/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Wl=typeof document<"u";function WI(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function pM(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&WI(t.default)}const fr=Object.assign;function Tm(t,e){const r={};for(const n in e){const s=e[n];r[n]=xa(s)?s.map(t):t(s)}return r}const zu=()=>{},xa=Array.isArray,zI=/#/g,mM=/&/g,gM=/\//g,vM=/=/g,yM=/\?/g,KI=/\+/g,xM=/%5B/g,EM=/%5D/g,qI=/%5E/g,bM=/%60/g,XI=/%7B/g,_M=/%7C/g,YI=/%7D/g,SM=/%20/g;function Xy(t){return encodeURI(""+t).replace(_M,"|").replace(xM,"[").replace(EM,"]")}function AM(t){return Xy(t).replace(XI,"{").replace(YI,"}").replace(qI,"^")}function Mv(t){return Xy(t).replace(KI,"%2B").replace(SM,"+").replace(zI,"%23").replace(mM,"%26").replace(bM,"`").replace(XI,"{").replace(YI,"}").replace(qI,"^")}function TM(t){return Mv(t).replace(vM,"%3D")}function wM(t){return Xy(t).replace(zI,"%23").replace(yM,"%3F")}function CM(t){return t==null?"":wM(t).replace(gM,"%2F")}function wd(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const IM=/\/$/,kM=t=>t.replace(IM,"");function wm(t,e,r="/"){let n,s={},i="",a="";const o=e.indexOf("#");let l=e.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(n=e.slice(0,l),i=e.slice(l+1,o>-1?o:e.length),s=t(i)),o>-1&&(n=n||e.slice(0,o),a=e.slice(o,e.length)),n=FM(n??e,r),{fullPath:n+(i&&"?")+i+a,path:n,query:s,hash:wd(a)}}function DM(t,e){const r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function Tb(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function PM(t,e,r){const n=e.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&Pc(e.matched[n],r.matched[s])&&QI(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function Pc(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function QI(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!RM(t[r],e[r]))return!1;return!0}function RM(t,e){return xa(t)?wb(t,e):xa(e)?wb(e,t):t===e}function wb(t,e){return xa(e)?t.length===e.length&&t.every((r,n)=>r===e[n]):t.length===1&&t[0]===e}function FM(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),n=t.split("/"),s=n[n.length-1];(s===".."||s===".")&&n.push("");let i=r.length-1,a,o;for(a=0;a<n.length;a++)if(o=n[a],o!==".")if(o==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a).join("/")}const Bi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Cd;(function(t){t.pop="pop",t.push="push"})(Cd||(Cd={}));var Ku;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Ku||(Ku={}));function NM(t){if(!t)if(Wl){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),kM(t)}const OM=/^[^#]+#/;function MM(t,e){return t.replace(OM,"#")+e}function LM(t,e){const r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-r.left-(e.left||0),top:n.top-r.top-(e.top||0)}}const Lp=()=>({left:window.scrollX,top:window.scrollY});function BM(t){let e;if("el"in t){const r=t.el,n=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=LM(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Cb(t,e){return(history.state?history.state.position-e:-1)+t}const Lv=new Map;function UM(t,e){Lv.set(t,e)}function $M(t){const e=Lv.get(t);return Lv.delete(t),e}let VM=()=>location.protocol+"//"+location.host;function JI(t,e){const{pathname:r,search:n,hash:s}=e,i=t.indexOf("#");if(i>-1){let o=s.includes(t.slice(i))?t.slice(i).length:1,l=s.slice(o);return l[0]!=="/"&&(l="/"+l),Tb(l,"")}return Tb(r,t)+n+s}function HM(t,e,r,n){let s=[],i=[],a=null;const o=({state:h})=>{const p=JI(t,location),g=r.value,y=e.value;let _=0;if(h){if(r.value=p,e.value=h,a&&a===g){a=null;return}_=y?h.position-y.position:0}else n(p);s.forEach(x=>{x(r.value,g,{delta:_,type:Cd.pop,direction:_?_>0?Ku.forward:Ku.back:Ku.unknown})})};function l(){a=r.value}function c(h){s.push(h);const p=()=>{const g=s.indexOf(h);g>-1&&s.splice(g,1)};return i.push(p),p}function u(){const{history:h}=window;h.state&&h.replaceState(fr({},h.state,{scroll:Lp()}),"")}function f(){for(const h of i)h();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function Ib(t,e,r,n=!1,s=!1){return{back:t,current:e,forward:r,replaced:n,position:window.history.length,scroll:s?Lp():null}}function jM(t){const{history:e,location:r}=window,n={value:JI(t,r)},s={value:e.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const f=t.indexOf("#"),h=f>-1?(r.host&&document.querySelector("base")?t:t.slice(f))+l:VM()+t+l;try{e[u?"replaceState":"pushState"](c,"",h),s.value=c}catch(p){console.error(p),r[u?"replace":"assign"](h)}}function a(l,c){const u=fr({},e.state,Ib(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,u,!0),n.value=l}function o(l,c){const u=fr({},s.value,e.state,{forward:l,scroll:Lp()});i(u.current,u,!0);const f=fr({},Ib(n.value,l,null),{position:u.position+1},c);i(l,f,!1),n.value=l}return{location:n,state:s,push:o,replace:a}}function GM(t){t=NM(t);const e=jM(t),r=HM(t,e.state,e.location,e.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const s=fr({location:"",base:t,go:n,createHref:MM.bind(null,t)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function WM(t){return typeof t=="string"||t&&typeof t=="object"}function ZI(t){return typeof t=="string"||typeof t=="symbol"}const e4=Symbol("");var kb;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(kb||(kb={}));function Rc(t,e){return fr(new Error,{type:t,[e4]:!0},e)}function Qa(t,e){return t instanceof Error&&e4 in t&&(e==null||!!(t.type&e))}const Db="[^/]+?",zM={sensitive:!1,strict:!1,start:!0,end:!0},KM=/[.+*?^${}()[\]/\\]/g;function qM(t,e){const r=fr({},zM,e),n=[];let s=r.start?"^":"";const i=[];for(const c of t){const u=c.length?[]:[90];r.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const h=c[f];let p=40+(r.sensitive?.25:0);if(h.type===0)f||(s+="/"),s+=h.value.replace(KM,"\\$&"),p+=40;else if(h.type===1){const{value:g,repeatable:y,optional:_,regexp:x}=h;i.push({name:g,repeatable:y,optional:_});const b=x||Db;if(b!==Db){p+=10;try{new RegExp(`(${b})`)}catch(T){throw new Error(`Invalid custom RegExp for param "${g}" (${b}): `+T.message)}}let v=y?`((?:${b})(?:/(?:${b}))*)`:`(${b})`;f||(v=_&&c.length<2?`(?:/${v})`:"/"+v),_&&(v+="?"),s+=v,p+=20,_&&(p+=-8),y&&(p+=-20),b===".*"&&(p+=-50)}u.push(p)}n.push(u)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function o(c){const u=c.match(a),f={};if(!u)return null;for(let h=1;h<u.length;h++){const p=u[h]||"",g=i[h-1];f[g.name]=p&&g.repeatable?p.split("/"):p}return f}function l(c){let u="",f=!1;for(const h of t){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const p of h)if(p.type===0)u+=p.value;else if(p.type===1){const{value:g,repeatable:y,optional:_}=p,x=g in c?c[g]:"";if(xa(x)&&!y)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const b=xa(x)?x.join("/"):x;if(!b)if(_)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);u+=b}}return u||"/"}return{re:a,score:n,keys:i,parse:o,stringify:l}}function XM(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=e[r]-t[r];if(n)return n;r++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function t4(t,e){let r=0;const n=t.score,s=e.score;for(;r<n.length&&r<s.length;){const i=XM(n[r],s[r]);if(i)return i;r++}if(Math.abs(s.length-n.length)===1){if(Pb(n))return 1;if(Pb(s))return-1}return s.length-n.length}function Pb(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const YM={type:0,value:""},QM=/[a-zA-Z0-9_]/;function JM(t){if(!t)return[[]];if(t==="/")return[[YM]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(p){throw new Error(`ERR (${r})/"${c}": ${p}`)}let r=0,n=r;const s=[];let i;function a(){i&&s.push(i),i=[]}let o=0,l,c="",u="";function f(){c&&(r===0?i.push({type:0,value:c}):r===1||r===2||r===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;o<t.length;){if(l=t[o++],l==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:l==="/"?(c&&f(),a()):l===":"?(f(),r=1):h();break;case 4:h(),r=n;break;case 1:l==="("?r=2:QM.test(l)?h():(f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=3:u+=l;break;case 3:f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),a(),s}function ZM(t,e,r){const n=qM(JM(t.path),r),s=fr(n,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function eL(t,e){const r=[],n=new Map;e=Ob({strict:!1,end:!0,sensitive:!1},e);function s(f){return n.get(f)}function i(f,h,p){const g=!p,y=Fb(f);y.aliasOf=p&&p.record;const _=Ob(e,f),x=[y];if("alias"in f){const T=typeof f.alias=="string"?[f.alias]:f.alias;for(const D of T)x.push(Fb(fr({},y,{components:p?p.record.components:y.components,path:D,aliasOf:p?p.record:y})))}let b,v;for(const T of x){const{path:D}=T;if(h&&D[0]!=="/"){const k=h.record.path,S=k[k.length-1]==="/"?"":"/";T.path=h.record.path+(D&&S+D)}if(b=ZM(T,h,_),p?p.alias.push(b):(v=v||b,v!==b&&v.alias.push(b),g&&f.name&&!Nb(b)&&a(f.name)),r4(b)&&l(b),y.children){const k=y.children;for(let S=0;S<k.length;S++)i(k[S],b,p&&p.children[S])}p=p||b}return v?()=>{a(v)}:zu}function a(f){if(ZI(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function o(){return r}function l(f){const h=nL(f,r);r.splice(h,0,f),f.record.name&&!Nb(f)&&n.set(f.record.name,f)}function c(f,h){let p,g={},y,_;if("name"in f&&f.name){if(p=n.get(f.name),!p)throw Rc(1,{location:f});_=p.record.name,g=fr(Rb(h.params,p.keys.filter(v=>!v.optional).concat(p.parent?p.parent.keys.filter(v=>v.optional):[]).map(v=>v.name)),f.params&&Rb(f.params,p.keys.map(v=>v.name))),y=p.stringify(g)}else if(f.path!=null)y=f.path,p=r.find(v=>v.re.test(y)),p&&(g=p.parse(y),_=p.record.name);else{if(p=h.name?n.get(h.name):r.find(v=>v.re.test(h.path)),!p)throw Rc(1,{location:f,currentLocation:h});_=p.record.name,g=fr({},h.params,f.params),y=p.stringify(g)}const x=[];let b=p;for(;b;)x.unshift(b.record),b=b.parent;return{name:_,path:y,params:g,matched:x,meta:rL(x)}}t.forEach(f=>i(f));function u(){r.length=0,n.clear()}return{addRoute:i,resolve:c,removeRoute:a,clearRoutes:u,getRoutes:o,getRecordMatcher:s}}function Rb(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function Fb(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:tL(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function tL(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(const n in t.components)e[n]=typeof r=="object"?r[n]:r;return e}function Nb(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function rL(t){return t.reduce((e,r)=>fr(e,r.meta),{})}function Ob(t,e){const r={};for(const n in t)r[n]=n in e?e[n]:t[n];return r}function nL(t,e){let r=0,n=e.length;for(;r!==n;){const i=r+n>>1;t4(t,e[i])<0?n=i:r=i+1}const s=sL(t);return s&&(n=e.lastIndexOf(s,n-1)),n}function sL(t){let e=t;for(;e=e.parent;)if(r4(e)&&t4(t,e)===0)return e}function r4({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function aL(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(KI," "),a=i.indexOf("="),o=wd(a<0?i:i.slice(0,a)),l=a<0?null:wd(i.slice(a+1));if(o in e){let c=e[o];xa(c)||(c=e[o]=[c]),c.push(l)}else e[o]=l}return e}function Mb(t){let e="";for(let r in t){const n=t[r];if(r=TM(r),n==null){n!==void 0&&(e+=(e.length?"&":"")+r);continue}(xa(n)?n.map(i=>i&&Mv(i)):[n&&Mv(n)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+r,i!=null&&(e+="="+i))})}return e}function iL(t){const e={};for(const r in t){const n=t[r];n!==void 0&&(e[r]=xa(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return e}const oL=Symbol(""),Lb=Symbol(""),Bp=Symbol(""),Yy=Symbol(""),Bv=Symbol("");function lu(){let t=[];function e(n){return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}function r(){t=[]}return{add:e,list:()=>t.slice(),reset:r}}function zi(t,e,r,n,s,i=a=>a()){const a=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((o,l)=>{const c=h=>{h===!1?l(Rc(4,{from:r,to:e})):h instanceof Error?l(h):WM(h)?l(Rc(2,{from:e,to:h})):(a&&n.enterCallbacks[s]===a&&typeof h=="function"&&a.push(h),o())},u=i(()=>t.call(n&&n.instances[s],e,r,c));let f=Promise.resolve(u);t.length<3&&(f=f.then(c)),f.catch(h=>l(h))})}function Cm(t,e,r,n,s=i=>i()){const i=[];for(const a of t)for(const o in a.components){let l=a.components[o];if(!(e!=="beforeRouteEnter"&&!a.instances[o]))if(WI(l)){const u=(l.__vccOpts||l)[e];u&&i.push(zi(u,r,n,a,o,s))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const f=pM(u)?u.default:u;a.mods[o]=u,a.components[o]=f;const p=(f.__vccOpts||f)[e];return p&&zi(p,r,n,a,o,s)()}))}}return i}function Bb(t){const e=Os(Bp),r=Os(Yy),n=_e(()=>{const l=q(t.to);return e.resolve(l)}),s=_e(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],f=r.matched;if(!u||!f.length)return-1;const h=f.findIndex(Pc.bind(null,u));if(h>-1)return h;const p=Ub(l[c-2]);return c>1&&Ub(u)===p&&f[f.length-1].path!==p?f.findIndex(Pc.bind(null,l[c-2])):h}),i=_e(()=>s.value>-1&&fL(r.params,n.value.params)),a=_e(()=>s.value>-1&&s.value===r.matched.length-1&&QI(r.params,n.value.params));function o(l={}){if(dL(l)){const c=e[q(t.replace)?"replace":"push"](q(t.to)).catch(zu);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:_e(()=>n.value.href),isActive:i,isExactActive:a,navigate:o}}function lL(t){return t.length===1?t[0]:t}const cL=$d({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Bb,setup(t,{slots:e}){const r=As(Bb(t)),{options:n}=Os(Bp),s=_e(()=>({[$b(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[$b(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=e.default&&lL(e.default(r));return t.custom?i:el("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),uL=cL;function dL(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function fL(t,e){for(const r in e){const n=e[r],s=t[r];if(typeof n=="string"){if(n!==s)return!1}else if(!xa(s)||s.length!==n.length||n.some((i,a)=>i!==s[a]))return!1}return!0}function Ub(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const $b=(t,e,r)=>t??e??r,hL=$d({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:r}){const n=Os(Bv),s=_e(()=>t.route||n.value),i=Os(Lb,0),a=_e(()=>{let c=q(i);const{matched:u}=s.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),o=_e(()=>s.value.matched[a.value]);Mu(Lb,_e(()=>a.value+1)),Mu(oL,o),Mu(Bv,s);const l=se();return Ht(()=>[l.value,o.value,t.name],([c,u,f],[h,p,g])=>{u&&(u.instances[f]=c,p&&p!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!Pc(u,p)||!h)&&(u.enterCallbacks[f]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=s.value,u=t.name,f=o.value,h=f&&f.components[u];if(!h)return Vb(r.default,{Component:h,route:c});const p=f.props[u],g=p?p===!0?c.params:typeof p=="function"?p(c):p:null,_=el(h,fr({},g,e,{onVnodeUnmounted:x=>{x.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return Vb(r.default,{Component:_,route:c})||_}}});function Vb(t,e){if(!t)return null;const r=t(e);return r.length===1?r[0]:r}const pL=hL;function mL(t){const e=eL(t.routes,t),r=t.parseQuery||aL,n=t.stringifyQuery||Mb,s=t.history,i=lu(),a=lu(),o=lu(),l=v1(Bi);let c=Bi;Wl&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Tm.bind(null,ne=>""+ne),f=Tm.bind(null,CM),h=Tm.bind(null,wd);function p(ne,le){let Z,J;return ZI(ne)?(Z=e.getRecordMatcher(ne),J=le):J=ne,e.addRoute(J,Z)}function g(ne){const le=e.getRecordMatcher(ne);le&&e.removeRoute(le)}function y(){return e.getRoutes().map(ne=>ne.record)}function _(ne){return!!e.getRecordMatcher(ne)}function x(ne,le){if(le=fr({},le||l.value),typeof ne=="string"){const Y=wm(r,ne,le.path),fe=e.resolve({path:Y.path},le),ye=s.createHref(Y.fullPath);return fr(Y,fe,{params:h(fe.params),hash:wd(Y.hash),redirectedFrom:void 0,href:ye})}let Z;if(ne.path!=null)Z=fr({},ne,{path:wm(r,ne.path,le.path).path});else{const Y=fr({},ne.params);for(const fe in Y)Y[fe]==null&&delete Y[fe];Z=fr({},ne,{params:f(Y)}),le.params=f(le.params)}const J=e.resolve(Z,le),ge=ne.hash||"";J.params=u(h(J.params));const te=DM(n,fr({},ne,{hash:AM(ge),path:J.path})),K=s.createHref(te);return fr({fullPath:te,hash:ge,query:n===Mb?iL(ne.query):ne.query||{}},J,{redirectedFrom:void 0,href:K})}function b(ne){return typeof ne=="string"?wm(r,ne,l.value.path):fr({},ne)}function v(ne,le){if(c!==ne)return Rc(8,{from:le,to:ne})}function T(ne){return S(ne)}function D(ne){return T(fr(b(ne),{replace:!0}))}function k(ne){const le=ne.matched[ne.matched.length-1];if(le&&le.redirect){const{redirect:Z}=le;let J=typeof Z=="function"?Z(ne):Z;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=b(J):{path:J},J.params={}),fr({query:ne.query,hash:ne.hash,params:J.path!=null?{}:ne.params},J)}}function S(ne,le){const Z=c=x(ne),J=l.value,ge=ne.state,te=ne.force,K=ne.replace===!0,Y=k(Z);if(Y)return S(fr(b(Y),{state:typeof Y=="object"?fr({},ge,Y.state):ge,force:te,replace:K}),le||Z);const fe=Z;fe.redirectedFrom=le;let ye;return!te&&PM(n,J,Z)&&(ye=Rc(16,{to:fe,from:J}),z(J,J,!0,!1)),(ye?Promise.resolve(ye):A(fe,J)).catch(ie=>Qa(ie)?Qa(ie,2)?ie:V(ie):L(ie,fe,J)).then(ie=>{if(ie){if(Qa(ie,2))return S(fr({replace:K},b(ie.to),{state:typeof ie.to=="object"?fr({},ge,ie.to.state):ge,force:te}),le||fe)}else ie=C(fe,J,!0,K,ge);return I(fe,J,ie),ie})}function E(ne,le){const Z=v(ne,le);return Z?Promise.reject(Z):Promise.resolve()}function m(ne){const le=j.values().next().value;return le&&typeof le.runWithContext=="function"?le.runWithContext(ne):ne()}function A(ne,le){let Z;const[J,ge,te]=gL(ne,le);Z=Cm(J.reverse(),"beforeRouteLeave",ne,le);for(const Y of J)Y.leaveGuards.forEach(fe=>{Z.push(zi(fe,ne,le))});const K=E.bind(null,ne,le);return Z.push(K),ae(Z).then(()=>{Z=[];for(const Y of i.list())Z.push(zi(Y,ne,le));return Z.push(K),ae(Z)}).then(()=>{Z=Cm(ge,"beforeRouteUpdate",ne,le);for(const Y of ge)Y.updateGuards.forEach(fe=>{Z.push(zi(fe,ne,le))});return Z.push(K),ae(Z)}).then(()=>{Z=[];for(const Y of te)if(Y.beforeEnter)if(xa(Y.beforeEnter))for(const fe of Y.beforeEnter)Z.push(zi(fe,ne,le));else Z.push(zi(Y.beforeEnter,ne,le));return Z.push(K),ae(Z)}).then(()=>(ne.matched.forEach(Y=>Y.enterCallbacks={}),Z=Cm(te,"beforeRouteEnter",ne,le,m),Z.push(K),ae(Z))).then(()=>{Z=[];for(const Y of a.list())Z.push(zi(Y,ne,le));return Z.push(K),ae(Z)}).catch(Y=>Qa(Y,8)?Y:Promise.reject(Y))}function I(ne,le,Z){o.list().forEach(J=>m(()=>J(ne,le,Z)))}function C(ne,le,Z,J,ge){const te=v(ne,le);if(te)return te;const K=le===Bi,Y=Wl?history.state:{};Z&&(J||K?s.replace(ne.fullPath,fr({scroll:K&&Y&&Y.scroll},ge)):s.push(ne.fullPath,ge)),l.value=ne,z(ne,le,Z,K),V()}let F;function W(){F||(F=s.listen((ne,le,Z)=>{if(!ee.listening)return;const J=x(ne),ge=k(J);if(ge){S(fr(ge,{replace:!0,force:!0}),J).catch(zu);return}c=J;const te=l.value;Wl&&UM(Cb(te.fullPath,Z.delta),Lp()),A(J,te).catch(K=>Qa(K,12)?K:Qa(K,2)?(S(fr(b(K.to),{force:!0}),J).then(Y=>{Qa(Y,20)&&!Z.delta&&Z.type===Cd.pop&&s.go(-1,!1)}).catch(zu),Promise.reject()):(Z.delta&&s.go(-Z.delta,!1),L(K,J,te))).then(K=>{K=K||C(J,te,!1),K&&(Z.delta&&!Qa(K,8)?s.go(-Z.delta,!1):Z.type===Cd.pop&&Qa(K,20)&&s.go(-1,!1)),I(J,te,K)}).catch(zu)}))}let P=lu(),R=lu(),N;function L(ne,le,Z){V(ne);const J=R.list();return J.length?J.forEach(ge=>ge(ne,le,Z)):console.error(ne),Promise.reject(ne)}function O(){return N&&l.value!==Bi?Promise.resolve():new Promise((ne,le)=>{P.add([ne,le])})}function V(ne){return N||(N=!ne,W(),P.list().forEach(([le,Z])=>ne?Z(ne):le()),P.reset()),ne}function z(ne,le,Z,J){const{scrollBehavior:ge}=t;if(!Wl||!ge)return Promise.resolve();const te=!Z&&$M(Cb(ne.fullPath,0))||(J||!Z)&&history.state&&history.state.scroll||null;return hl().then(()=>ge(ne,le,te)).then(K=>K&&BM(K)).catch(K=>L(K,ne,le))}const U=ne=>s.go(ne);let G;const j=new Set,ee={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:_,getRoutes:y,resolve:x,options:t,push:T,replace:D,go:U,back:()=>U(-1),forward:()=>U(1),beforeEach:i.add,beforeResolve:a.add,afterEach:o.add,onError:R.add,isReady:O,install(ne){const le=this;ne.component("RouterLink",uL),ne.component("RouterView",pL),ne.config.globalProperties.$router=le,Object.defineProperty(ne.config.globalProperties,"$route",{enumerable:!0,get:()=>q(l)}),Wl&&!G&&l.value===Bi&&(G=!0,T(s.location).catch(ge=>{}));const Z={};for(const ge in Bi)Object.defineProperty(Z,ge,{get:()=>l.value[ge],enumerable:!0});ne.provide(Bp,le),ne.provide(Yy,g1(Z)),ne.provide(Bv,l);const J=ne.unmount;j.add(ne),ne.unmount=function(){j.delete(ne),j.size<1&&(c=Bi,F&&F(),F=null,l.value=Bi,G=!1,N=!1),J()}}};function ae(ne){return ne.reduce((le,Z)=>le.then(()=>m(Z)),Promise.resolve())}return ee}function gL(t,e){const r=[],n=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let a=0;a<i;a++){const o=e.matched[a];o&&(t.matched.find(c=>Pc(c,o))?n.push(o):r.push(o));const l=t.matched[a];l&&(e.matched.find(c=>Pc(c,l))||s.push(l))}return[r,n,s]}function ki(){return Os(Bp)}function vL(t){return Os(Yy)}class yL{constructor(){this.enabled=!0}async logStudentAccess(e,r,n={}){if(!(!this.enabled||!bt.currentUser))try{const s=et(At(Xe,"auditLogs"));await $t(s,{type:"student_access",studentId:e,userId:bt.currentUser.uid,userEmail:bt.currentUser.email,action:r,details:n,timestamp:Pn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logUserManagement(e,r,n={}){if(!(!this.enabled||!bt.currentUser))try{const s=et(At(Xe,"auditLogs"));await $t(s,{type:"user_management",targetUserId:e,performedBy:bt.currentUser.uid,performedByEmail:bt.currentUser.email,action:r,details:n,timestamp:Pn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logSystemAccess(e,r={}){var n,s;if(this.enabled)try{const i=et(At(Xe,"auditLogs"));await $t(i,{type:"system_access",userId:((n=bt.currentUser)==null?void 0:n.uid)||"unknown",userEmail:((s=bt.currentUser)==null?void 0:s.email)||"unknown",action:e,details:r,timestamp:Pn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(i){console.error("Audit logging failed:",i)}}async logDataExport(e,r,n={}){if(!(!this.enabled||!bt.currentUser))try{const s=et(At(Xe,"auditLogs"));await $t(s,{type:"data_export",exportType:e,studentIds:Array.isArray(r)?r:[r],studentCount:Array.isArray(r)?r.length:1,userId:bt.currentUser.uid,userEmail:bt.currentUser.email,details:n,timestamp:Pn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}getSessionId(){return sessionStorage.getItem("sessionId")||sessionStorage.setItem("sessionId",`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),sessionStorage.getItem("sessionId")}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"unknown"}}async generateAccessReport(e,r){try{const n=new Date(r.start),s=new Date(r.end);return{studentId:e,accessCount:0,uniqueUsers:[],actions:[],timeRange:r}}catch(n){return console.error("Report generation failed:",n),null}}}const an=new yL,Qr=ew("auth",()=>{const t=se(null),e=se(""),r=se(!0),n=ki(),s=()=>{K1(bt,async g=>{if(r.value=!0,g)try{const y=await er(et(Xe,"users",g.uid));y.exists()?(t.value={uid:g.uid,email:g.email,name:g.displayName,...y.data()},a()):t.value=null}catch(y){console.error(" Error fetching user data:",y),console.error(" This might be due to expired token - user will be logged out"),t.value=null}else t.value=null,o(),typeof window<"u"&&window.location.pathname!=="/login"&&(window.location.href="/login");r.value=!1})};let i=null;const a=()=>{o(),i=setInterval(async()=>{if(bt.currentUser)try{await f()||(console.error(" Failed to refresh token - logging user out for security"),await c())}catch(g){console.error(" Token refresh threw an error:",g),await c()}},45*60*1e3)},o=()=>{i&&(clearInterval(i),i=null)},l=async()=>{e.value="";try{const g=new oa,_=(await J1(bt,g)).user,x=await er(et(Xe,"users",_.uid));if(!x.exists()){e.value=" User not found in system.";return}t.value={uid:_.uid,email:_.email,name:_.displayName,...x.data()},n.push("/")}catch(g){console.error(" Login error:",g),e.value=g.message||"Authentication failed."}},c=async()=>{try{t.value&&await an.logSystemAccess("logout",{userRole:t.value.role,success:!0}),await dp(bt),t.value=null,n.push("/login")}catch(g){console.error(" Logout error:",g),await an.logSystemAccess("logout_error",{error:g.message,success:!1})}},u=g=>{t.value=g},f=async()=>{if(bt.currentUser)try{return await hv(bt.currentUser,!0),!0}catch(g){return console.error(" Error refreshing token:",g),console.error(" Error details:",g.code,g.message),!1}return!1},h=async()=>{if(!bt.currentUser)return!1;try{return await hv(bt.currentUser,!1),!0}catch(g){return console.error(" Current token is invalid:",g),!1}},p=_e(()=>t.value);return s(),{currentUser:t,user:p,errorMsg:e,isLoading:r,loginWithGoogle:l,logout:c,setUser:u,refreshToken:f,setupTokenRefresh:a,clearTokenRefresh:o,checkTokenValidity:h}}),xL=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:Qr},Symbol.toStringTag,{value:"Module"})),Ko=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],EL=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],cu=["admin","school_admin","admin_504","sped_chair"],ot={VIEW_USERS:"view_users",EDIT_USER:"edit_user",DELETE_USER:"delete_user",VIEW_STUDENTS:"view_students",EDIT_STUDENT_CM:"edit_student_CM",EDIT_STUDENT_ALL:"edit_student_All",ACCESS_ADMIN_PANEL:"access_admin_panel",MANAGE_AIDES:"manage_aides",MANAGE_SYSTEM_SETTINGS:"manage_system_settings",MANAGE_TEACHER_FEEDBACK:"manage_teacher_feedback",MANAGE_IMPORTS:"manage_imports",MANAGE_BACKUPS:"manage_backups"},n4={admin:[ot.VIEW_USERS,ot.EDIT_USER,ot.DELETE_USER,ot.VIEW_STUDENTS,ot.EDIT_STUDENT_ALL,ot.ACCESS_ADMIN_PANEL,ot.MANAGE_AIDES,ot.MANAGE_SYSTEM_SETTINGS,ot.MANAGE_TEACHER_FEEDBACK,ot.MANAGE_IMPORTS,ot.MANAGE_BACKUPS],school_admin:[ot.VIEW_USERS,ot.EDIT_USER,ot.DELETE_USER,ot.VIEW_STUDENTS,ot.EDIT_STUDENT_ALL,ot.ACCESS_ADMIN_PANEL,ot.MANAGE_AIDES,ot.MANAGE_TEACHER_FEEDBACK,ot.MANAGE_IMPORTS,ot.MANAGE_BACKUPS],staff_view:[ot.VIEW_USERS,ot.VIEW_STUDENTS],staff_edit:[ot.VIEW_USERS,ot.VIEW_STUDENTS,ot.EDIT_STUDENT_ALL],admin_504:[ot.VIEW_USERS,ot.EDIT_USER,ot.DELETE_USER,ot.VIEW_STUDENTS,ot.EDIT_STUDENT_ALL,ot.ACCESS_ADMIN_PANEL,ot.MANAGE_AIDES,ot.MANAGE_TEACHER_FEEDBACK],sped_chair:[ot.VIEW_USERS,ot.EDIT_USER,ot.DELETE_USER,ot.VIEW_STUDENTS,ot.EDIT_STUDENT_ALL,ot.ACCESS_ADMIN_PANEL,ot.MANAGE_AIDES,ot.MANAGE_TEACHER_FEEDBACK],case_manager:[ot.VIEW_USERS,ot.VIEW_STUDENTS,ot.EDIT_STUDENT_CM,ot.MANAGE_TEACHER_FEEDBACK],teacher:[ot.VIEW_USERS,ot.VIEW_STUDENTS],service_provider:[ot.VIEW_USERS,ot.VIEW_STUDENTS,ot.EDIT_STUDENT_CM],paraeducator:[ot.VIEW_USERS,ot.VIEW_STUDENTS]};function Hb(t){return Ko.includes(t)}const bL={admin:"System Administrator - Full access to all features and settings",school_admin:"School Administrator - Manage students, aides, and users (no system settings)",staff_view:"Staff Viewer - IEP access for counselors, nurses, intervention specialists",staff_edit:"Staff Editor - Edit all students, no admin panel access",admin_504:"504 Plan Coordinator - Manage 504 plans, students, and aides",sped_chair:"Special Education Chair - Manage special education programs",case_manager:"Case Manager - Manage assigned student caseload only",teacher:"Teacher - View students in assigned classes",service_provider:"Service Provider - Manage students receiving services",paraeducator:"Paraeducator - View assigned students only"},Qy=ew("permission",()=>{const t=Qr(),e=se([]),r=se({}),n=se({}),s=se(!1),i=async()=>{n.value=n4,s.value=!0,console.log("Using static permissions matrix:",n.value),e.value.length>0&&(r.value=a(e.value))};function a(c){const u={};return console.log("Deriving permissions for roles:",c),console.log("Current permissions matrix:",n.value),console.log("Matrix loaded:",s.value),c.forEach(f=>{const h=n.value[f]||[];console.log(`Role ${f} has permissions:`,h),h.forEach(p=>u[p]=!0)}),console.log("Final derived permissions:",u),u}let o=null;return Ht(()=>{var c;return(c=t.currentUser)==null?void 0:c.uid},()=>{var c;if(o&&o(),(c=t.currentUser)!=null&&c.uid){const u=et(Xe,"users",t.currentUser.uid);o=cf(u,f=>{const h=f.data()||{};e.value=h.role?[h.role]:[],console.log("User roles updated:",e.value),t.currentUser&&(t.currentUser.value={...t.currentUser.value,...h},console.log(" Updated auth store user data:",t.currentUser.value)),s.value&&(r.value=a(e.value))})}else e.value=[],r.value={}},{immediate:!0}),i(),{userRoles:e,userPermissions:r,permissionsMatrix:n,matrixLoaded:s,hasRole:c=>e.value.includes(c),can:c=>r.value[c]===!0,loadPermissionsMatrix:i}});function _L(){const t=Qy(),e=_e(()=>t.hasRole("admin")),r=_e(()=>t.can("manage_users")),n=s=>t.can(s);return{isAdmin:e,canManageUsers:r,hasRole:t.hasRole,can:t.can,hasPermission:n}}const St=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r},SL={name:"UserRoleSwitcher",setup(){const t=Qr();_L();const e=se(!1),r=se(""),n=se({}),s=se(!1),i=_e(()=>t.user),a=[{value:"admin",label:"Admin"},{value:"school_admin",label:"School Admin"},{value:"admin_504",label:"504 Coordinator"},{value:"sped_chair",label:"SPED Chair"},{value:"staff_view",label:"Staff (View)"},{value:"staff_edit",label:"Staff (Edit)"},{value:"case_manager",label:"Case Manager"},{value:"teacher",label:"Teacher"},{value:"service_provider",label:"Service Provider"},{value:"paraeducator",label:"Paraeducator"}],o=[{uid:"test-admin",name:"Test Admin",email:"admin@test.com",role:"admin"},{uid:"test-school-admin",name:"Test School Admin",email:"schooladmin@test.com",role:"school_admin"},{uid:"test-admin-504",name:"Test 504 Coordinator",email:"admin504@test.com",role:"admin_504"},{uid:"test-sped-chair",name:"Test SPED Chair",email:"spedchair@test.com",role:"sped_chair"},{uid:"test-case-manager",name:"Test Case Manager",email:"cm@test.com",role:"case_manager"},{uid:"test-paraeducator",name:"Test Paraeducator",email:"para@test.com",role:"paraeducator"},{uid:"test-teacher",name:"Test Teacher",email:"teacher@test.com",role:"teacher"},{uid:"test-service-provider",name:"Test Service Provider",email:"service@test.com",role:"service_provider"}],l=async()=>{s.value=!0;try{const x=et(Xe,"config","permissions_matrix"),b=await er(x);b.exists()?n.value=b.data():(console.warn("Permissions matrix not found in database"),n.value={})}catch(x){console.error("Error loading permissions matrix:",x),n.value={}}finally{s.value=!1}},c=_e(()=>{var T;const x=[{action:ot.VIEW_USERS,label:"View Users"},{action:ot.EDIT_USER,label:"Edit User"},{action:ot.DELETE_USER,label:"Delete User"},{action:ot.MANAGE_SUBJECTS,label:"Manage Subjects"},{action:ot.MANAGE_ROLES,label:"Manage Roles"},{action:ot.VIEW_STUDENTS,label:"View Students"},{action:ot.EDIT_STUDENT_CM,label:"Edit Students (Own Caseload)"},{action:ot.EDIT_STUDENT_ALL,label:"Edit All Students"},{action:ot.TESTING,label:"Testing"}],b=(T=i.value)==null?void 0:T.role,v=n.value[b]||[];return x.map(D=>({...D,granted:v.includes(D.action)}))}),u=()=>{e.value=!e.value},f=()=>{if(!r.value)return;const x={uid:`test-${r.value}-${Date.now()}`,email:`${r.value}@test.com`,name:`Test ${r.value.charAt(0).toUpperCase()+r.value.slice(1)}`,role:r.value,lastSyncTrigger:new Date().toISOString()};t.setUser(x),localStorage.setItem("debug-user",JSON.stringify(x)),r.value=""},h=x=>{t.setUser(x),localStorage.setItem("debug-user",JSON.stringify(x))},p=()=>{localStorage.removeItem("debug-user"),window.location.reload()},g=()=>{window.location.reload()};return Wt(async()=>{await l();const x=localStorage.getItem("debug-user");if(x)try{const b=JSON.parse(x);t.setUser(b)}catch(b){console.error("Error parsing debug user:",b),localStorage.removeItem("debug-user")}return()=>{}}),{canSwitchRoles:_e(()=>{var b;const x=(b=i.value)==null?void 0:b.role;return["admin","administrator"].includes(x)}),hideRoleSwitcher:()=>{console.log("Role switcher hidden")},isExpanded:e,selectedRole:r,currentUser:i,availableRoles:a,testUsers:o,currentPermissions:c,loadingPermissions:s,toggleExpanded:u,switchRole:f,switchToUser:h,resetToRealUser:p,refreshPage:g}}},AL=["title"],TL={key:0,class:"debug-label"},wL={key:0,class:"switcher-content"},CL={class:"current-user-info"},IL={class:"role-selector"},kL=["value"],DL={class:"test-users"},PL={class:"test-user-buttons"},RL=["onClick"],FL={class:"permission-info"},NL={key:0,class:"loading-permissions"},OL={key:1,class:"permission-list"},ML={class:"permission-icon"},LL={class:"actions"};function BL(t,e,r,n,s,i){var a,o,l,c,u;return n.canSwitchRoles?(M(),B("div",{key:0,class:Ye(["user-role-switcher",{collapsed:!n.isExpanded}])},[d("div",{class:"switcher-header",onClick:e[1]||(e[1]=(...f)=>n.toggleExpanded&&n.toggleExpanded(...f)),title:n.isExpanded?"Collapse Debug Panel":"Expand Debug Panel"},[e[6]||(e[6]=d("span",{class:"debug-icon"},"",-1)),n.isExpanded?(M(),B("span",TL,"Debug Role Switcher")):ve("",!0),e[7]||(e[7]=d("span",{class:"beta-label"},"BETA",-1)),d("button",{onClick:e[0]||(e[0]=Yr((...f)=>n.hideRoleSwitcher&&n.hideRoleSwitcher(...f),["stop"])),class:"close-debug-btn",title:"Close Role Switcher"},"")],8,AL),n.isExpanded?(M(),B("div",wL,[e[18]||(e[18]=d("div",{class:"beta-warning"},[d("strong",null," BETA WARNING:"),we(" This debug tool is not working correctly and should be used with caution. It may not properly switch roles or could cause unexpected behavior. ")],-1)),d("div",CL,[e[8]||(e[8]=d("strong",null,"Current User:",-1)),we(" "+Q(((a=n.currentUser)==null?void 0:a.name)||((o=n.currentUser)==null?void 0:o.email)||"Unknown")+" ",1),e[9]||(e[9]=d("br",null,null,-1)),e[10]||(e[10]=d("strong",null,"Role:",-1)),e[11]||(e[11]=we()),d("span",{class:Ye("role-"+((l=n.currentUser)==null?void 0:l.role))},Q(((c=n.currentUser)==null?void 0:c.role)||"None"),3),e[12]||(e[12]=d("br",null,null,-1)),e[13]||(e[13]=d("strong",null,"UID:",-1)),we(" "+Q(((u=n.currentUser)==null?void 0:u.uid)||"None"),1)]),d("div",IL,[e[15]||(e[15]=d("label",{for:"role-select"},"Switch to Role:",-1)),Oe(d("select",{id:"role-select","onUpdate:modelValue":e[2]||(e[2]=f=>n.selectedRole=f),onChange:e[3]||(e[3]=(...f)=>n.switchRole&&n.switchRole(...f))},[e[14]||(e[14]=d("option",{value:""},"-- Select Role --",-1)),(M(!0),B(ke,null,He(n.availableRoles,f=>(M(),B("option",{key:f.value,value:f.value},Q(f.label),9,kL))),128))],544),[[sr,n.selectedRole]])]),d("div",DL,[e[16]||(e[16]=d("h5",null,"Quick Test Users:",-1)),d("div",PL,[(M(!0),B(ke,null,He(n.testUsers,f=>{var h;return M(),B("button",{key:f.uid,onClick:p=>n.switchToUser(f),class:Ye(["test-user-btn",{active:((h=n.currentUser)==null?void 0:h.uid)===f.uid}])},[we(Q(f.name)+" ",1),d("small",null,"("+Q(f.role)+")",1)],10,RL)}),128))])]),d("div",FL,[e[17]||(e[17]=d("h5",null,"Current Permissions:",-1)),n.loadingPermissions?(M(),B("div",NL," Loading permissions... ")):(M(),B("div",OL,[(M(!0),B(ke,null,He(n.currentPermissions,f=>(M(),B("div",{key:f.action,class:Ye(["permission-item",{granted:f.granted}])},[d("span",ML,Q(f.granted?"":""),1),we(" "+Q(f.label),1)],2))),128))]))]),e[19]||(e[19]=En('<div class="testing-scenarios" data-v-26d536da><h5 data-v-26d536da> Testing Scenarios:</h5><div class="scenario-list" data-v-26d536da><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Students Page:</strong><ul data-v-26d536da><li data-v-26d536da> Can view students</li><li data-v-26d536da> Can edit own caseload (CM)</li><li data-v-26d536da> Can edit all students (Admin)</li><li data-v-26d536da> Paraeducator filter works</li></ul></div><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Admin Panel:</strong><ul data-v-26d536da><li data-v-26d536da> Users management</li><li data-v-26d536da> Permissions matrix</li><li data-v-26d536da> Aide assignments</li><li data-v-26d536da> App settings</li></ul></div><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Navigation:</strong><ul data-v-26d536da><li data-v-26d536da> Admin button visibility</li><li data-v-26d536da> My Schedule button (Para)</li><li data-v-26d536da> Role-based menu items</li></ul></div></div></div>',1)),d("div",LL,[d("button",{onClick:e[4]||(e[4]=(...f)=>n.resetToRealUser&&n.resetToRealUser(...f)),class:"reset-btn"},"  Reset to Real User "),d("button",{onClick:e[5]||(e[5]=(...f)=>n.refreshPage&&n.refreshPage(...f)),class:"refresh-btn"},"  Refresh Page ")])])):ve("",!0)],2)):ve("",!0)}const UL=St(SL,[["render",BL],["__scopeId","data-v-26d536da"]]),$L={key:0,class:"debug-access-info"},VL={__name:"DebugAccessInfo",setup(t){const e=Qr(),r=se(!1),n=_e(()=>e.currentUser),s=_e(()=>{var o;const a=(o=n.value)==null?void 0:o.role;return["admin","administrator"].includes(a)}),i=()=>{r.value=!1,localStorage.setItem("debug-info-hidden","true")};return Wt(()=>{const a=localStorage.getItem("debug-info-hidden");s.value&&!a&&setTimeout(()=>{r.value=!0},3e3)}),(a,o)=>r.value?(M(),B("div",$L,[d("div",{class:"debug-info-content"},[o[0]||(o[0]=d("span",{class:"debug-info-icon"},"",-1)),o[1]||(o[1]=d("span",{class:"debug-info-text"},[we("Debug tools available - Press "),d("kbd",null,"Ctrl+Shift+D")],-1)),d("button",{onClick:i,class:"debug-info-close"},"")])])):ve("",!0)}},HL=St(VL,[["__scopeId","data-v-358a31dd"]]);class jL{constructor(){this.timeoutId=null,this.warningTimeoutId=null,this.isEnabled=se(!1),this.timeoutMinutes=se(30),this.showWarning=se(!1),this.warningCountdown=se(0),this.lastActivity=Date.now(),this.lastLogTime=null,this.router=null,this.unsubscribeSettings=null,this.activityEvents=["mousedown","keypress","scroll","touchstart","click","keydown"],this.init()}init(){console.log(" Session timeout system initialization STARTED"),this.loadSettings(),this.setupActivityListeners(),this.setupAuthWatcher()}setupAuthWatcher(){K1(bt,e=>{e?(console.log(" User logged in, starting session timeout system"),setTimeout(()=>{this.resetTimeout()},2e3)):(console.log(" User logged out, clearing session timeouts"),this.clearTimeouts(),this.hideWarning())})}async loadSettings(){try{const e=et(Xe,"app_settings","security");this.unsubscribeSettings=cf(e,r=>{if(r.exists()){const n=r.data(),s=n.sessionTimeoutEnabled!==!1,i=n.sessionTimeoutMinutes||30;console.log(` Session timeout settings updated: enabled=${s}, timeout=${i}min`),this.isEnabled.value=s,this.timeoutMinutes.value=i,bt.currentUser&&this.resetTimeout()}else{console.log(" No session timeout settings found, creating with defaults");const n={sessionTimeoutEnabled:!0,sessionTimeoutMinutes:30,createdAt:new Date().toISOString(),createdBy:"system_auto_create"};$t(e,n,{merge:!0}).catch(s=>{console.error("Failed to create default session timeout settings:",s)}),this.isEnabled.value=!0,this.timeoutMinutes.value=30}},r=>{console.error("Failed to load session timeout settings:",r),this.isEnabled.value=!0,this.timeoutMinutes.value=30;const n={sessionTimeoutEnabled:!0,sessionTimeoutMinutes:30,createdAt:new Date().toISOString(),createdBy:"system_error_recovery"};$t(e,n,{merge:!0}).catch(s=>{console.error("Failed to create session timeout settings during error recovery:",s)})})}catch(e){console.error("Failed to setup session timeout settings listener:",e),this.isEnabled.value=!0,this.timeoutMinutes.value=30}}async updateSettings(e,r){var n;try{const s=et(Xe,"app_settings","security");await $t(s,{sessionTimeoutEnabled:e,sessionTimeoutMinutes:r,updatedAt:new Date().toISOString(),updatedBy:(n=bt.currentUser)==null?void 0:n.uid},{merge:!0}),this.isEnabled.value=e,this.timeoutMinutes.value=r,console.log(` Session timeout settings updated: enabled=${e}, timeout=${r}min`),bt.currentUser&&this.resetTimeout()}catch(s){console.error("Failed to update session timeout settings:",s)}}setupActivityListeners(){this.boundActivityHandler=this.handleActivity.bind(this),this.activityEvents.forEach(e=>{document.addEventListener(e,this.boundActivityHandler,!0)})}handleActivity(){if(!this.isEnabled.value||!bt.currentUser)return;const e=Date.now();if(e-this.lastActivity<1e4){this.lastActivity=e;return}this.lastActivity=e,console.log(" Activity detected - resetting session timeout"),this.resetTimeout(),this.showWarning.value&&this.hideWarning()}resetTimeout(){if(!this.isEnabled.value||!bt.currentUser){console.log(" Session timeout disabled or no user - skipping reset");return}this.clearTimeouts();const e=Math.round(this.timeoutMinutes.value*60*1e3),r=Math.max(5e3,e-2*60*1e3);console.log(` Session timeout reset: ${this.timeoutMinutes.value} minutes (${e}ms), warning in ${r}ms`),this.warningTimeoutId=setTimeout(()=>{console.log(" Showing session warning"),this.showSessionWarning()},r),this.timeoutId=setTimeout(()=>{console.log(" Session timeout triggered - logging out user"),this.handleSessionTimeout()},e)}showSessionWarning(){if(this.showWarning.value)return;this.showWarning.value=!0,this.warningCountdown.value=Math.min(120,Math.floor(this.timeoutMinutes.value*60/2)),console.log(` Session warning displayed, countdown: ${this.warningCountdown.value} seconds`);const e=setInterval(()=>{this.warningCountdown.value--,this.warningCountdown.value<=0&&(clearInterval(e),this.handleSessionTimeout())},1e3);this.countdownInterval=e}hideWarning(){this.showWarning.value=!1,this.warningCountdown.value=0,this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}async handleSessionTimeout(){console.log(" Handling session timeout");try{if(bt.currentUser){const e=et(Xe,"auditLogs",`timeout_${Date.now()}_${bt.currentUser.uid}`);await $t(e,{type:"session_timeout",userId:bt.currentUser.uid,userEmail:bt.currentUser.email,timeoutMinutes:this.timeoutMinutes.value,lastActivity:new Date(this.lastActivity),timestamp:new Date,userAgent:navigator.userAgent})}this.clearTimeouts(),this.hideWarning(),console.log(" SESSION TIMEOUT LOGOUT: About to call signOut()"),console.log(" Session timeout stack trace:",new Error().stack),await dp(bt),console.log(" User signed out due to session timeout"),this.router?this.router.push("/login"):window.location.href="/login"}catch(e){console.error("Error during session timeout:",e),window.location.href="/login"}}extendSession(){this.hideWarning(),this.resetTimeout()}clearTimeouts(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.warningTimeoutId&&(clearTimeout(this.warningTimeoutId),this.warningTimeoutId=null)}setRouter(e){this.router=e}destroy(){this.clearTimeouts(),this.hideWarning(),this.boundActivityHandler&&this.activityEvents.forEach(e=>{document.removeEventListener(e,this.boundActivityHandler,!0)}),this.unsubscribeSettings&&(this.unsubscribeSettings(),this.unsubscribeSettings=null)}}const Zs=new jL;function Jy(){const t=ki();return Zs.setRouter(t),{isEnabled:Zs.isEnabled,timeoutMinutes:Zs.timeoutMinutes,showWarning:Zs.showWarning,warningCountdown:Zs.warningCountdown,updateSettings:Zs.updateSettings.bind(Zs),extendSession:Zs.extendSession.bind(Zs),resetTimeout:Zs.resetTimeout.bind(Zs)}}/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jb=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),GL=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),WL=t=>{const e=GL(t);return e.charAt(0).toUpperCase()+e.slice(1)},zL=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=({size:t,strokeWidth:e=2,absoluteStrokeWidth:r,color:n,iconNode:s,name:i,class:a,...o},{slots:l})=>el("svg",{...zf,width:t||zf.width,height:t||zf.height,stroke:n||zf.stroke,"stroke-width":r?Number(e)*24/Number(t):e,class:zL("lucide",...i?[`lucide-${jb(WL(i))}-icon`,`lucide-${jb(i)}`]:["lucide-icon"]),...o},[...s.map(c=>el(...c)),...l.default?[l.default()]:[]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=(t,e)=>(r,{slots:n})=>el(KL,{...r,iconNode:e,name:t},n);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qL=yt("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=yt("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=yt("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YL=yt("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=yt("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=yt("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=yt("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=yt("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=yt("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=yt("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=yt("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=yt("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=yt("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=yt("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=yt("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=yt("columns-2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=yt("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=yt("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=yt("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=yt("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=yt("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=yt("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=yt("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=yt("hand-heart",[["path",{d:"M11 14h2a2 2 0 0 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1v1a37"}],["path",{d:"m14.45 13.39 5.05-4.694C20.196 8 21 6.85 21 5.75a2.75 2.75 0 0 0-4.797-1.837.276.276 0 0 1-.406 0A2.75 2.75 0 0 0 11 5.75c0 1.2.802 2.248 1.5 2.946L16 11.95",key:"fhfbnt"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a1 1 0 0 0-2.75-2.91",key:"1x6kdw"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=yt("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=yt("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=yt("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=yt("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=yt("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=yt("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=yt("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=yt("monitor-speaker",[["path",{d:"M5.5 20H8",key:"1k40s5"}],["path",{d:"M17 9h.01",key:"1j24nn"}],["rect",{width:"10",height:"16",x:"12",y:"4",rx:"2",key:"ixliua"}],["path",{d:"M8 6H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h4",key:"1mp6e1"}],["circle",{cx:"17",cy:"15",r:"1",key:"tqvash"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=yt("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=yt("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=yt("presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=yt("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=yt("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=yt("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=yt("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=yt("school",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=yt("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=yt("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=yt("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=yt("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=yt("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=yt("test-tube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=yt("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=yt("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=yt("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=yt("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=yt("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=yt("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=yt("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=yt("user-search",[["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}],["path",{d:"M10.3 15H7a4 4 0 0 0-4 4v2",key:"3bnktk"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["path",{d:"m21 21-1.9-1.9",key:"1g2n9r"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hv=yt("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=yt("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=yt("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=yt("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=yt("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),wB={key:0,class:"session-timeout-overlay"},CB={class:"session-timeout-dialog"},IB={class:"dialog-header"},kB={class:"dialog-content"},DB={class:"countdown-section"},PB={class:"countdown-time"},RB={class:"info-note"},FB={class:"dialog-actions"},NB={__name:"SessionTimeoutDialog",setup(t){const e=ki(),{showWarning:r,warningCountdown:n,extendSession:s}=Jy(),i=o=>{const l=Math.floor(o/60),c=o%60;return`${l}:${c.toString().padStart(2,"0")}`},a=async()=>{try{await dp(bt),e.push("/login")}catch(o){console.error("Error signing out:",o)}};return(o,l)=>q(r)?(M(),B("div",wB,[d("div",CB,[d("div",IB,[Re(q(i4),{class:"header-icon",size:24}),l[1]||(l[1]=d("h3",null,"Session Timeout",-1))]),d("div",kB,[d("div",DB,[d("div",PB,Q(i(q(n))),1),l[2]||(l[2]=d("p",{class:"countdown-label"},"until automatic logout",-1))]),d("div",RB,[Re(q(cB),{size:16}),l[3]||(l[3]=d("span",null,"Any activity will extend your session",-1))])]),d("div",FB,[d("button",{onClick:l[0]||(l[0]=(...c)=>q(s)&&q(s)(...c)),class:"btn btn-primary"},[Re(q(P0),{size:16}),l[4]||(l[4]=we(" Stay Logged In "))]),d("button",{onClick:a,class:"btn btn-secondary"},[Re(q(fB),{size:16}),l[5]||(l[5]=we(" Logout Now "))])])])])):ve("",!0)}},OB=St(NB,[["__scopeId","data-v-9d2333fd"]]),uu={primaryColor:"#1976d2",primaryHover:"#1565c0",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",secondaryColor:"#6c757d",secondaryHover:"#545b62",secondaryLight:"#f8f9fa",secondaryDark:"#495057",bgPrimary:"#f4f6f9",bgSecondary:"#ffffff",bgTertiary:"#f8f9fa",bgMuted:"#e9ecef",textPrimary:"#333333",textSecondary:"#666666",textMuted:"#999999",textInverse:"#ffffff",headerTextColor:"#1a1a1a",accentColor:"#e3f2fd",borderColor:"#dee2e6",borderLight:"#e9ecef",borderDark:"#adb5bd",borderFocus:"#1976d2",successColor:"#28a745",successHover:"#218838",successLight:"#d4edda",warningColor:"#ffc107",warningHover:"#e0a800",warningLight:"#fff3cd",errorColor:"#dc3545",errorHover:"#c82333",errorLight:"#f8d7da",infoColor:"#17a2b8",infoHover:"#138496",infoLight:"#d1ecf1",adminTabBg:"#f8f9fa",adminTabActive:"#2a79c9",adminTabHover:"#e3eaf6",tableHeaderBg:"#dfe7f3",tableStripeBg:"#f8fafd",tableBorder:"#d1d1d1",tableHover:"#f0f0f0",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",shadowSm:"0 1px 2px rgba(0, 0, 0, 0.05)",shadowMd:"0 2px 4px rgba(0, 0, 0, 0.1)",shadowLg:"0 4px 6px rgba(0, 0, 0, 0.1)",shadowXl:"0 4px 20px rgba(0, 0, 0, 0.3)",fontFamilyBase:"'Inter', 'Segoe UI', 'Arial', sans-serif",fontSizeXs:"0.75rem",fontSizeSm:"0.875rem",fontSizeBase:"1rem",fontSizeLg:"1.125rem",fontSizeXl:"1.25rem",fontSizeXxl:"1.5rem",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"standard",lineHeight:"1.5"},zb={primaryColor:"--primary-color",primaryHover:"--primary-hover",primaryLight:"--primary-light",primaryDark:"--primary-dark",secondaryColor:"--secondary-color",secondaryHover:"--secondary-hover",secondaryLight:"--secondary-light",secondaryDark:"--secondary-dark",bgPrimary:"--bg-primary",bgSecondary:"--bg-secondary",bgTertiary:"--bg-tertiary",bgMuted:"--bg-muted",textPrimary:"--text-primary",textSecondary:"--text-secondary",textMuted:"--text-muted",textInverse:"--text-inverse",headerTextColor:"--header-text-color",accentColor:"--accent-color",borderColor:"--border-color",borderLight:"--border-light",borderDark:"--border-dark",borderFocus:"--border-focus",successColor:"--success-color",successHover:"--success-hover",successLight:"--success-light",warningColor:"--warning-color",warningHover:"--warning-hover",warningLight:"--warning-light",errorColor:"--error-color",errorHover:"--error-hover",errorLight:"--error-light",infoColor:"--info-color",infoHover:"--info-hover",infoLight:"--info-light",adminTabBg:"--admin-tab-bg",adminTabActive:"--admin-tab-active",adminTabHover:"--admin-tab-hover",tableHeaderBg:"--table-header-bg",tableStripeBg:"--table-stripe-bg",tableBorder:"--table-border",tableHover:"--table-hover",borderRadiusSm:"--border-radius-sm",borderRadiusMd:"--border-radius-md",borderRadiusLg:"--border-radius-lg",borderRadiusXl:"--border-radius-xl",shadowSm:"--shadow-sm",shadowMd:"--shadow-md",shadowLg:"--shadow-lg",shadowXl:"--shadow-xl",fontFamilyBase:"--font-family-base",fontSizeXs:"--font-size-xs",fontSizeSm:"--font-size-sm",fontSizeBase:"--font-size-base",fontSizeLg:"--font-size-lg",fontSizeXl:"--font-size-xl",fontSizeXxl:"--font-size-xxl",lineHeight:"--line-height-base"};function p4(){const t=se({...uu}),e=se(!1),r=se(null),n=se(!1),s=async()=>{if(e.value)return t.value;e.value=!0,r.value=null;try{const g=et(Xe,"app_settings","theme"),y=await er(g);if(y.exists()){const _=y.data();t.value={...uu,..._},console.log("Theme loaded from database:",t.value)}else t.value={...uu},console.log("No saved theme found, using defaults");return n.value=!0,a(t.value),t.value}catch(g){throw r.value=g.message,console.error("Error loading theme:",g),g}finally{e.value=!1}},i=async(g=t.value)=>{e.value=!0,r.value=null;try{const y=et(Xe,"app_settings","theme");return await $t(y,{...g,lastUpdated:new Date().toISOString()}),t.value={...g},a(g),console.log("Theme saved successfully"),!0}catch(y){throw r.value=y.message,console.error("Error saving theme:",y),y}finally{e.value=!1}},a=g=>{const y=document.documentElement;Object.entries(zb).forEach(([_,x])=>{g[_]!==void 0&&y.style.setProperty(x,g[_])})},o=(g,y)=>{t.value[g]=y,a(t.value)},l=async()=>{t.value={...uu},a(t.value),await i(t.value)},c=g=>{a(g)},u=()=>{a(t.value)},f=g=>getComputedStyle(document.documentElement).getPropertyValue(g),h=g=>/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$|^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)$/.test(g),p=g=>({light:g,dark:g,hover:g});return Wt(()=>{n.value||s()}),{currentTheme:t,loading:e,error:r,isInitialized:n,loadTheme:s,saveTheme:i,applyTheme:a,updateThemeProperty:o,resetTheme:l,previewTheme:c,revertTheme:u,getCssVariableValue:f,validateColor:h,generateColorVariations:p,CSS_VARIABLE_MAP:zb,DEFAULT_THEME:uu}}function MB(){const{loadTheme:t,currentTheme:e,isInitialized:r}=p4();return Wt(async()=>{if(!r.value)try{await t(),console.log("Theme initialized successfully")}catch(n){console.error("Failed to initialize theme:",n)}}),{currentTheme:e,isInitialized:r}}const LB={id:"app"},BB={id:"main-content"},UB={__name:"App",setup(t){const e=se(!1);MB();const r=n=>{n.ctrlKey&&n.shiftKey&&n.key==="D"&&(n.preventDefault(),e.value=!e.value,console.log("Debug Role Switcher:",e.value?"Shown":"Hidden"))};return Wt(()=>{document.addEventListener("keydown",r)}),ja(()=>{document.removeEventListener("keydown",r)}),(n,s)=>{const i=br("router-view");return M(),B("div",LB,[d("div",BB,[Re(i)]),e.value?(M(),Qt(UL,{key:0})):ve("",!0),Re(HL),Re(OB)])}}},$B="modulepreload",VB=function(t){return"/"+t},Kb={},ua=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=VB(l),l in Kb)return;Kb[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":$B,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function qr(t,e=255){return typeof t!="string"?"":t.trim().replace(/\0/g,"").replace(/[<>'"&]/g,"").substring(0,e)}function HB(t){return typeof t!="string"?"":t.trim().toLowerCase().substring(0,255)}function qb(t,e=0,r=999999){const n=parseFloat(t);return isNaN(n)?0:Math.max(e,Math.min(r,n))}function F0(t,e){return!t||typeof t=="string"&&t.trim()===""?{isValid:!1,error:`${e} is required`}:{isValid:!0}}function jB(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}}function Id(t,e,r=0,n=255){return typeof t!="string"?{isValid:!1,error:`${e} must be a string`}:t.length<r?{isValid:!1,error:`${e} must be at least ${r} characters`}:t.length>n?{isValid:!1,error:`${e} must be no more than ${n} characters`}:{isValid:!0}}function GB(t){return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"].includes(t)?{isValid:!0}:{isValid:!1,error:"Invalid role"}}function WB(t,e=[],r=10*1024*1024){return t?e.length>0&&!e.includes(t.type)?{isValid:!1,error:`Invalid file type. Allowed: ${e.join(", ")}`}:t.size>r?{isValid:!1,error:`File too large. Maximum size: ${r/(1024*1024)}MB`}:[/\.exe$/i,/\.bat$/i,/\.cmd$/i,/\.scr$/i,/\.vbs$/i,/\.js$/i,/\.jar$/i].some(s=>s.test(t.name))?{isValid:!1,error:"Suspicious file type detected"}:{isValid:!0}:{isValid:!1,error:"No file selected"}}function Hr(t){if(typeof t!="string")return{isSafe:!0,threats:[]};const e=[];return/<script|javascript:|vbscript:|onload=|onerror=/i.test(t)&&e.push("Script injection attempt"),/(\bunion\b|\bselect\b|\binsert\b|\bupdate\b|\bdelete\b|\bdrop\b).*(\bfrom\b|\binto\b|\bwhere\b)/i.test(t)&&e.push("SQL injection pattern"),/\.\.\/|\.\.\\|%2e%2e%2f|%2e%2e%5c/i.test(t)&&e.push("Path traversal attempt"),/<[^>]*>/i.test(t)&&e.push("HTML injection attempt"),/\0/.test(t)&&e.push("Null byte injection"),{isSafe:e.length===0,threats:e}}const Ol={};function Fs(t,e=10,r=6e4){const n=Date.now(),s=`${t}_${Math.floor(n/r)}`;return Ol[s]||(Ol[s]=0),Ol[s]++,Ol[s]>e?{allowed:!1,error:`Rate limit exceeded. Maximum ${e} requests per ${r/1e3} seconds.`}:(Object.keys(Ol).forEach(i=>{const a=parseInt(i.split("_").pop())*r;n-a>r*2&&delete Ol[i]}),{allowed:!0})}function m4(t,e={}){const r=[],{isNew:n=!1}=e;if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid student data"]};if(!t.app||!t.app.studentData)return r.push("Student data structure is invalid"),{isValid:!1,errors:r};const s=t.app.studentData;return[{field:"firstName",name:"First Name"},{field:"lastName",name:"Last Name"},{field:"caseManagerId",name:"Case Manager"}].forEach(({field:l,name:c})=>{const u=F0(s[l],c);u.isValid||r.push(u.error)}),[{field:"firstName",name:"First Name",maxLength:100},{field:"lastName",name:"Last Name",maxLength:100},{field:"studentId",name:"Student ID",maxLength:50},{field:"grade",name:"Grade",maxLength:10}].forEach(({field:l,name:c,maxLength:u})=>{if(s[l]){const f=Id(s[l],c,1,u);f.isValid||r.push(f.error)}}),["firstName","lastName","studentId","grade"].forEach(l=>{if(s[l]){const c=Hr(s[l]);c.isSafe||r.push(`Security threat detected in ${l}: ${c.threats.join(", ")}`)}}),t.app.accommodations&&typeof t.app.accommodations!="string"&&t.app.accommodations!==null&&r.push("Accommodations must be encrypted string or null"),t.app.classServices&&typeof t.app.classServices!="string"&&t.app.classServices!==null&&r.push("Class services must be encrypted string or null"),s.plan&&typeof s.plan!="string"&&s.plan!==null&&r.push("Student plan must be encrypted string or null"),{isValid:r.length===0,errors:r}}function zB(t){const e=[];if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid user data"]};const r=F0(t.name,"Name");r.isValid||e.push(r.error);const n=F0(t.email,"Email");n.isValid||e.push(n.error);const s=F0(t.role,"Role");if(s.isValid||e.push(s.error),t.email){const a=jB(t.email);a.isValid||e.push(a.error)}if(t.role){const a=GB(t.role);a.isValid||e.push(a.error)}if(t.name){const a=Id(t.name,"Name",1,100);a.isValid||e.push(a.error)}if(t.email){const a=Id(t.email,"Email",1,255);a.isValid||e.push(a.error)}return["name","email"].forEach(a=>{if(t[a]){const o=Hr(t[a]);o.isSafe||e.push(`Security threat detected in ${a}: ${o.threats.join(", ")}`)}}),{isValid:e.length===0,errors:e}}function g4(t){const e={...t};if(e.app&&e.app.studentData){const r=e.app.studentData;["firstName","lastName","studentId","grade"].forEach(s=>{r[s]&&(r[s]=qr(r[s],100))})}else["firstName","lastName","studentId","grade"].forEach(n=>{e[n]&&(e[n]=qr(e[n],100))});return e}function KB(t){const e={...t};return e.name&&(e.name=qr(e.name,100)),e.email&&(e.email=HB(e.email)),e}const qB=async(t,e,r=100,n=1e3)=>{const s=[];for(let a=0;a<t.length;a+=r)s.push(t.slice(a,a+r));const i=[];for(let a=0;a<s.length;a++)try{const o=await e(s[a]);i.push(o),a<s.length-1&&await new Promise(l=>setTimeout(l,n))}catch(o){throw console.error(`Error in batch ${a+1}:`,o),o}return i},ol=WB;function Ah(t){if(!t||typeof t!="object")return t;if(t.toJSON&&typeof t.toJSON=="function")return t.toJSON();if(Array.isArray(t))return t.map(Ah);const e={};for(const[r,n]of Object.entries(t)){if(r.toLowerCase().includes("schedule")&&typeof n=="object"&&n!==null)for(const[s,i]of Object.entries(n))i&&typeof i=="object"&&i.teacherId!==void 0&&(n[s].teacherId=String(i.teacherId));e[r]=Ah(n)}return e}const ea=se([]);let Dm=null;function Di(){async function t(){if(!Dm)try{const{useGoogleSheetsRealtime:o}=await ua(async()=>{const{useGoogleSheetsRealtime:l}=await Promise.resolve().then(()=>kfe);return{useGoogleSheetsRealtime:l}},void 0);Dm=o()}catch(o){console.error("Failed to load Google Sheets sync:",o)}return Dm}async function e(){const o=await Gt(At(Xe,"students"));ea.value=o.docs.map(l=>{const c=l.data(),u=Ah(c);return{id:l.id,...u}})}function r(o){ea.value=o.map(l=>{const c=Ah(l);return{id:l.id,...c}})}async function n(){return(await Gt(At(Xe,"students"))).docs.map(l=>({id:l.id,...l.data()}))}async function s(o,l){await Op(et(Xe,"students",o),l);try{const c=await t();if(c&&c.linkedSheetId.value){const u=ea.value.findIndex(f=>f.id===o);u!==-1&&(ea.value[u]={...ea.value[u],...l}),await c.updateSheetData(ea.value)}}catch(c){console.error("Failed to sync to Google Sheets:",c)}}async function i(o){var c,u,f,h,p,g,y;const l=ea.value.find(_=>_.id===o);await mo(et(Xe,"students",o)),await an.logStudentAccess(o,"delete",{studentName:l?`${((u=(c=l.app)==null?void 0:c.studentData)==null?void 0:u.firstName)||""} ${((h=(f=l.app)==null?void 0:f.studentData)==null?void 0:h.lastName)||""}`.trim():"Unknown",ssid:(g=(p=l==null?void 0:l.app)==null?void 0:p.studentData)==null?void 0:g.ssid,deletedFields:l?Object.keys(((y=l.app)==null?void 0:y.studentData)||{}):[]});try{const _=await t();_&&_.linkedSheetId.value&&(ea.value=ea.value.filter(x=>x.id!==o),await _.updateSheetData(ea.value))}catch(_){console.error("Failed to sync to Google Sheets:",_)}}return{students:ea,fetchStudents:e,setStudents:r,fetchAllStudents:n,updateStudent:s,deleteStudent:i,deleteAllStudents:async()=>{try{const l=(await Gt(At(Xe,"students"))).docs;return await an.logStudentAccess("bulk_operation","delete_all",{studentCount:l.length,operation:"bulk_delete_all_students",deletedStudentIds:l.map(c=>c.id)}),await qB(l,async c=>{const u=Ly(Xe);c.forEach(f=>{u.delete(f.ref)}),await u.commit()},50,2e3),{success:!0}}catch(o){throw console.error("Error deleting all students:",o),await an.logStudentAccess("bulk_operation","delete_all_failed",{error:o.message,operation:"bulk_delete_all_students_failed"}),o}}}}function _a(){const t=se({}),e=se([]);async function r(){console.log(" USERS DEBUG: Starting fetchUsers()");try{const a=await Gt(At(Xe,"users"));console.log(" USERS DEBUG: Retrieved",a.size,"users from database");const o={},l=[];a.forEach(u=>{const f=u.data();o[u.id]={id:u.id,...f},l.push({id:u.id,...f})}),t.value=o,e.value=l,console.log(" USERS DEBUG: Processed users by role:");const c={};l.forEach(u=>{c[u.role]=(c[u.role]||0)+1}),console.log(" USERS DEBUG: Role counts:",c),console.log(" USERS DEBUG: All users list:",l.map(u=>({id:u.id,name:u.name,email:u.email,role:u.role}))),console.log(" USERS DEBUG: fetchUsers() completed successfully")}catch(a){throw console.error(" USERS DEBUG: Error in fetchUsers():",a),a}}const n=_e(()=>{const a=o=>o.sort((l,c)=>{const u=f=>{const h=f.name||f.email||f.id,p=h.split(" ");return p.length>1?p[p.length-1]:h};return u(l).localeCompare(u(c))});return{teachers:a(e.value.filter(o=>["teacher","case_manager","sped_chair"].includes(o.role))),caseManagers:a(e.value.filter(o=>["case_manager","sped_chair","admin_504"].includes(o.role))),speech:a(e.value.filter(o=>o.provider==="SLP")),ot:a(e.value.filter(o=>o.provider==="OT")),mh:a(e.value.filter(o=>o.provider==="MH")),pt:a(e.value.filter(o=>o.provider==="PT")),sc:a(e.value.filter(o=>o.provider==="SC")),tr:a(e.value.filter(o=>o.provider==="TR")),aud:a(e.value.filter(o=>o.provider==="AUD")),vi:a(e.value.filter(o=>o.provider==="VI")),at:a(e.value.filter(o=>o.provider==="AT")),dhh:a(e.value.filter(o=>o.provider==="DHH")),om:a(e.value.filter(o=>o.provider==="O&M")),bis:a(e.value.filter(o=>o.provider==="BIS")),hn:a(e.value.filter(o=>o.provider==="HN")),sw:a(e.value.filter(o=>o.provider==="SW"))}}),s=_e(()=>e.value.filter(a=>["case_manager","sped_chair","admin_504"].includes(a.role)).sort((a,o)=>{const l=c=>{const u=c.name||c.email||c.id,f=u.split(" ");return f.length>1?f[f.length-1]:u};return l(a).localeCompare(l(o))})),i=_e(()=>e.value.filter(a=>["teacher","case_manager","sped_chair"].includes(a.role)).sort((a,o)=>{const l=c=>{const u=c.name||c.email||c.id,f=u.split(" ");return f.length>1?f[f.length-1]:u};return l(a).localeCompare(l(o))}));return{users:t,userList:e,fetchUsers:r,caseManagers:s,teacherList:i,userRoles:n}}function ex(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const h=await Gt(At(Xe,"aideSchedules")),p={};h.forEach(g=>{p[g.id]=g.data()}),t.value=p}catch(h){console.error("Error loading aide assignments:",h),t.value={}}finally{e.value=!1}}async function n(h){if(!h){console.warn("loadAideAssignment called without aideId");return}e.value=!0;try{const p=await er(et(Xe,"aideSchedules",h));p.exists()?t.value[h]=p.data():t.value[h]={classAssignment:{},directAssignment:[]}}catch(p){console.error("Error loading aide assignment:",p),t.value[h]={classAssignment:{},directAssignment:[]}}finally{e.value=!1}}async function s(h,p){try{const g=JSON.parse(JSON.stringify(p));await $t(et(Xe,"aideSchedules",h),g,{merge:!0}),t.value[h]=g}catch(g){throw console.error("Error saving aide assignment:",g),g}}async function i(){try{const h=Object.entries(t.value);for(const[p,g]of h){const y=JSON.parse(JSON.stringify(g));await $t(et(Xe,"aideSchedules",p),y,{merge:!0})}}catch(h){throw console.error("Error saving all aide assignments:",h),h}}function a(h,p){const g=[];return Object.entries(t.value).forEach(([y,_])=>{_.classAssignment&&_.classAssignment[p]&&(Array.isArray(_.classAssignment[p])?_.classAssignment[p]:[_.classAssignment[p]]).includes(h)&&g.push(y)}),g}function o(h){var g;const p=(g=t.value[h])==null?void 0:g.directAssignment;return Array.isArray(p)?p.length>0?p[0]:null:p||null}function l(h){return Object.keys(t.value).find(g=>{var _;const y=(_=t.value[g])==null?void 0:_.directAssignment;return Array.isArray(y)?y.includes(h):y===h})||null}function c(h,p,g){const y=[],_=t.value[h];return _&&((Array.isArray(_.directAssignment)?_.directAssignment:_.directAssignment?[_.directAssignment]:[]).forEach(b=>{if(b){const v=p.find(T=>T.id===b);v&&y.push({...v,assignmentType:"direct"})}}),Object.entries(_.classAssignment||{}).forEach(([b,v])=>{v&&(Array.isArray(v)?v:[v]).forEach(D=>{D&&p.forEach(k=>{const S=f(k);if(S){const E=S[b];if((typeof E=="string"?E:E==null?void 0:E.teacherId)===D){const A=y.findIndex(I=>I.id===k.id);A===-1?y.push({...k,assignmentType:"class",period:b,teacherId:D}):(y[A].assignmentType="both",y[A].period=b,y[A].teacherId=D)}}})})})),y}function u(h,p,g,y){if(!h||!p||!g||!y)return!1;const _=g.find(k=>k.id===p);if(!_)return!1;const x=t.value[h];if(!x)return!1;if((Array.isArray(x.directAssignment)?x.directAssignment:x.directAssignment?[x.directAssignment]:[]).includes(p))return!0;const v=f(_);if(!v)return!1;const T=x.classAssignment||{};return Object.entries(v).some(([k,S])=>{const E=typeof S=="string"?S:S==null?void 0:S.teacherId,m=T[k];return!m||!E?!1:(Array.isArray(m)?m:[m]).includes(E)})}function f(h){var p,g,y,_,x;return h.schedule?h.schedule:(g=(p=h.app)==null?void 0:p.schedule)!=null&&g.periods?h.app.schedule.periods:(_=(y=h.aeries)==null?void 0:y.schedule)!=null&&_.periods?h.aeries.schedule.periods:(x=h.aeries)!=null&&x.schedule?h.aeries.schedule:null}return{aideAssignment:_e(()=>t.value),loading:_e(()=>e.value),loadAideAssignments:r,loadAideAssignment:n,saveAideAssignment:s,saveAllAideAssignments:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}function tx(){const t=se(!1),e=se(""),r=se("");let n,s,i,a;try{n=hc(),s=Ra(n,"getStudentFeedback"),i=Ra(n,"createFeedbackFormSheet"),a=Ra(n,"createFeedbackFormSheetWithUserAuth")}catch(T){console.warn("Firebase Functions not available:",T),s=()=>Promise.reject(new Error("Functions not available")),i=()=>Promise.reject(new Error("Functions not available")),a=()=>Promise.reject(new Error("Functions not available"))}const o=At(Xe,"feedbackForms"),l=se(!1),c=se([]);let u;const f=_e(()=>{var D;return(((D=c.value)==null?void 0:D.filter(k=>k.active!==!1))||[]).sort((k,S)=>{var A,I;const E=(A=k.createdAt)!=null&&A.seconds?new Date(k.createdAt.seconds*1e3):new Date(k.createdAt);return((I=S.createdAt)!=null&&I.seconds?new Date(S.createdAt.seconds*1e3):new Date(S.createdAt))-E})}),h=async T=>{try{t.value=!0,e.value="",console.log(" Creating Google Sheet with personal account for form:",T.title);const D=await i({title:T.title,description:T.description,formUrl:T.formUrl,studentId:T.studentId||null,studentName:T.studentName||null});if(!D.data.success)throw new Error("Failed to create Google Sheet: "+D.data.message);console.log(" Google Sheet created:",D.data.spreadsheetUrl);const k={title:T.title,description:T.description,formUrl:T.formUrl,spreadsheetId:D.data.spreadsheetId,spreadsheetUrl:D.data.spreadsheetUrl,userDriveId:D.data.userDriveId,parentFolderId:D.data.parentFolderId,active:!0,createdAt:new Date,createdBy:T.createdBy},S=et(o);return await $t(S,k),r.value="Feedback form and Google Sheet created successfully!",{id:S.id,...k}}catch(D){throw console.error("Error creating feedback form:",D),D.message.includes("storage quota exceeded")||D.message.includes("Service account storage quota exceeded")?D.value=' Cannot create Google Sheet: Service account has no storage quota. Please use the "Test with Personal Account" button in Google Drive Setup to use your personal Google account instead.':D.message.includes("permission")||D.message.includes("access")?D.value=" Permission denied: Please ensure the folder is shared with the service account or use your personal Google account.":D.value=D.message,D}finally{t.value=!1}},p=async(T,D)=>{try{t.value=!0,e.value="";const k=et(o,T);await $t(k,{...D,updatedAt:new Date},{merge:!0}),r.value="Feedback form updated successfully!"}catch(k){throw console.error("Error updating feedback form:",k),e.value=k.message,k}finally{t.value=!1}},g=async T=>{try{t.value=!0,e.value="";const D=et(o,T);await mo(D),r.value="Feedback form deleted successfully!"}catch(D){throw console.error("Error deleting feedback form:",D),e.value=D.message,D}finally{t.value=!1}},y=()=>{e.value="",r.value=""},_=T=>{const D=T.match(/\/forms\/d\/([a-zA-Z0-9-_]+)/);return D?D[1]:null},x=()=>{try{u=cf(o,T=>{c.value=T.docs.map(D=>({id:D.id,...D.data()})),l.value=!1},T=>{console.warn("Error listening to feedback forms:",T),l.value=!1})}catch(T){console.warn("Error initializing Firestore listeners:",T),l.value=!1}},b=()=>{u&&u()};return Wt(()=>{x()}),ja(()=>{b()}),{isLoading:t,error:e,successMessage:r,formsLoading:l,feedbackForms:c,activeForms:f,createFeedbackForm:h,updateFeedbackForm:p,deleteFeedbackForm:g,clearMessages:y,extractFormId:_,createFeedbackFormWithUserAuth:async(T,D)=>{try{t.value=!0,e.value="",console.log(" Creating Google Sheet with personal account for form:",T.title);const k=await a({title:T.title,description:T.description,formUrl:T.formUrl,studentId:T.studentId||null,studentName:T.studentName||null,accessToken:D});if(!k.data.success)throw new Error("Failed to create Google Sheet: "+k.data.message);console.log(" Google Sheet created with personal account:",k.data.spreadsheetUrl);const S={title:T.title,description:T.description,formUrl:T.formUrl,spreadsheetId:k.data.spreadsheetId,spreadsheetUrl:k.data.spreadsheetUrl,driveType:"personal",active:!0,createdAt:new Date,createdBy:T.createdBy},E=et(o);return await $t(E,S),r.value="Feedback form and Google Sheet created successfully in your personal Google Drive!",{id:E.id,...S}}catch(k){throw console.error("Error creating feedback form with user auth:",k),k.value=k.message,k}finally{t.value=!1}}}}function XB(){const t=Qr(),e=se(!1),r=se(null),n=se([]),s=se(0);_e(()=>t.user);const i=_e(()=>{var v;return(v=t.user)==null?void 0:v.role}),a=_e(()=>{var v;return(v=t.user)==null?void 0:v.uid}),o=async()=>{try{const v=lr(At(Xe,"students"),vn("app.studentData.lastName","asc"));return(await Gt(v)).docs.map(k=>({id:k.id,...k.data()}))}catch(v){console.error(" Admin query error:",v),console.error(" Admin query error details:",v.message,v.code);try{const T=lr(At(Xe,"students"));return(await Gt(T)).docs.map(S=>({id:S.id,...S.data()}))}catch(T){return console.error(" Fallback query also failed:",T),console.error(" Fallback query error details:",T.message,T.code),[]}}},l=async()=>{try{const v=lr(At(Xe,"students"),vn("app.studentData.lastName","asc"));return(await Gt(v)).docs.map(D=>({id:D.id,...D.data()}))}catch(v){console.error(" 504 Admin query error:",v);try{const T=lr(At(Xe,"students"));return(await Gt(T)).docs.map(k=>({id:k.id,...k.data()}))}catch(T){return console.error(" 504 Admin fallback query failed:",T),[]}}},c=async()=>{try{const v=lr(At(Xe,"students"),Ur("app.studentData.plan","==","IEP"),vn("app.studentData.lastName","asc"));return(await Gt(v)).docs.map(D=>({id:D.id,...D.data()}))}catch(v){console.error(" SPED Chair query error:",v);try{const T=lr(At(Xe,"students"),Ur("app.studentData.plan","==","IEP"));return(await Gt(T)).docs.map(k=>({id:k.id,...k.data()}))}catch(T){return console.error(" SPED Chair fallback query failed:",T),[]}}},u=async v=>{try{const T=lr(At(Xe,"students"),Ur("app.studentData.caseManagerId","==",v)),k=(await Gt(T)).docs.map(I=>({id:I.id,...I.data()})),S=lr(At(Xe,"students"),Ur("app.staffIds","array-contains",v)),m=(await Gt(S)).docs.map(I=>({id:I.id,...I.data()})),A=[...k];return m.forEach(I=>{A.find(C=>C.id===I.id)||A.push(I)}),A.sort((I,C)=>{var P,R,N,L;const F=((R=(P=I.app)==null?void 0:P.studentData)==null?void 0:R.lastName)||"",W=((L=(N=C.app)==null?void 0:N.studentData)==null?void 0:L.lastName)||"";return F.localeCompare(W)}),A}catch(T){return console.error(" Security: Error loading case manager students:",T),[]}},f=async v=>{try{const T=lr(At(Xe,"students"),Ur("app.staffIds","array-contains",v),vn("app.studentData.lastName","asc"));return(await Gt(T)).docs.map(k=>({id:k.id,...k.data()}))}catch(T){return console.error(" Security: Error loading teacher students:",T),[]}},h=async v=>{var T;console.log(" Service Provider query: Loading students for provider",v),console.log(" Service Provider query: userId type:",typeof v),console.log(" Service Provider query: userId value:",JSON.stringify(v));try{const D=lr(At(Xe,"students"),Ur("app.staffIds","array-contains",v));console.log(" Service Provider query: Executing staffIds query...");const k=await Gt(D);console.log(" Service Provider query: Success! Found",k.size,"students");const S=k.docs.map(E=>({id:E.id,...E.data()}));return S.sort((E,m)=>{var C,F,W,P;const A=((F=(C=E.app)==null?void 0:C.studentData)==null?void 0:F.lastName)||"",I=((P=(W=m.app)==null?void 0:W.studentData)==null?void 0:P.lastName)||"";return A.localeCompare(I)}),S}catch(D){console.error(" Service Provider query FAILED:",D);const k=uo();return console.error(" Service Provider auth mismatch - userId:",v,"authUid:",(T=k.currentUser)==null?void 0:T.uid),[]}},p=async v=>{var T;try{try{const I=lr(At(Xe,"students"),Ur("app.staffIds","array-contains",v),vn("app.studentData.lastName","asc")),C=await Gt(I);if(C.size>0)return C.docs.map(W=>({id:W.id,...W.data()}))}catch{}const D=await er(et(Xe,"aideSchedules",v));if(!D.exists())return[];const k=D.data();let S=[];if(k.studentIds&&Array.isArray(k.studentIds)?S=k.studentIds:k.directAssignment&&(S=Array.isArray(k.directAssignment)?k.directAssignment:[k.directAssignment]),S.length===0)return[];const E=S.map(async I=>{try{const C=await er(et(Xe,"students",I));return C.exists()?{id:C.id,...C.data()}:null}catch(C){return console.warn("Failed to fetch student",I,":",C.message),null}}),A=(await Promise.all(E)).filter(I=>I!==null);return A.sort((I,C)=>{var P,R,N,L;const F=((R=(P=I.app)==null?void 0:P.studentData)==null?void 0:R.lastName)||"",W=((L=(N=C.app)==null?void 0:N.studentData)==null?void 0:L.lastName)||"";return F.localeCompare(W)}),A}catch(D){console.error(" Paraeducator query FAILED:",D);const k=uo();return console.error(" Paraeducator auth mismatch - userId:",v,"authUid:",(T=k.currentUser)==null?void 0:T.uid),[]}},g=async()=>{const v=lr(At(Xe,"students"),Ur("app.flags.flag2","==",!0),vn("app.studentData.lastName","asc")),T=lr(At(Xe,"students"),Ur("app.flags.separateSetting","==",!0),vn("app.studentData.lastName","asc")),[D,k]=await Promise.all([Gt(v),Gt(T)]),S=D.docs.map(A=>({id:A.id,...A.data()})),E=k.docs.map(A=>({id:A.id,...A.data()})),m=[...S];return E.forEach(A=>{m.find(I=>I.id===A.id)||m.push(A)}),m.sort((A,I)=>{var W,P,R,N;const C=((P=(W=A.app)==null?void 0:W.studentData)==null?void 0:P.lastName)||"",F=((N=(R=I.app)==null?void 0:R.studentData)==null?void 0:N.lastName)||"";return C.localeCompare(F)})},y=async(v={})=>{if(!a.value||!i.value)return console.error(" No authenticated user or role - FAILING AUTH CHECK"),r.value="Authentication required",[];e.value=!0,r.value=null;try{let T=[];switch(i.value){case"admin":case"school_admin":case"staff_view":case"staff_edit":case"administrator":T=await o();break;case"sped_chair":T=await c();break;case"admin_504":T=await l();break;case"case_manager":T=await u(a.value);break;case"teacher":T=await f(a.value);break;case"service_provider":T=await h(a.value);break;case"paraeducator":T=await p(a.value);break;default:return console.error(" Unknown role:",i.value),r.value="Invalid user role",[]}return v.testingOnly&&(T=await g()),n.value=T,s.value=T.length,T}catch(T){return console.error(" Error loading students:",T),r.value=T.message||"Failed to load students",[]}finally{e.value=!1}},_=async v=>{if(!v)throw new Error("Student ID is required");if(!a.value||!i.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{const T=await er(et(Xe,"students",v));if(!T.exists())throw new Error("Student not found");const D={id:T.id,...T.data()};if(!await x(D,a.value,i.value))throw new Error("Access denied to this student");return D}catch(T){throw console.error(" Error getting student:",T),r.value=T.message,T}finally{e.value=!1}},x=async(v,T,D)=>{var k,S,E,m,A,I,C;if(!v||!T||!D)return!1;if(["admin","school_admin","admin_504","sped_chair"].includes(D))return!0;if(D==="case_manager")return((S=(k=v.app)==null?void 0:k.studentData)==null?void 0:S.caseManagerId)===T;if(D==="teacher"){if(!((m=(E=v.app)==null?void 0:E.schedule)!=null&&m.periods))return!1;const F=v.app.schedule.periods,W=Object.values(F);return W.includes(T)?!0:W.some(P=>{var R;return typeof P=="object"&&P!==null?P.teacherId===T||((R=P.coTeaching)==null?void 0:R.caseManagerId)===T:!1})}if(D==="service_provider"){if((A=v.app)!=null&&A.providers&&Object.values(v.app.providers).includes(T))return!0;if((C=(I=v.app)==null?void 0:I.schedule)!=null&&C.periods){const F=v.app.schedule.periods,W=Object.values(F);return W.includes(T)?!0:W.some(P=>{var R;return typeof P=="object"&&P!==null?P.teacherId===T||((R=P.coTeaching)==null?void 0:R.caseManagerId)===T:!1})}}return!1},b=async(v=50,T=null)=>{if(!a.value||!i.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{let D=lr(At(Xe,"students"),vn("app.studentData.lastName","asc"),la(v));T&&(D=lr(D,xh(T))),i.value==="case_manager"&&(D=lr(At(Xe,"students"),Ur("app.studentData.caseManagerId","==",a.value),vn("app.studentData.lastName","asc"),la(v)),T&&(D=lr(D,xh(T))));const k=await Gt(D);return{students:k.docs.map(E=>({id:E.id,...E.data()})),lastDoc:k.docs[k.docs.length-1],hasMore:k.docs.length===v}}catch(D){throw console.error(" Error loading paginated students:",D),r.value=D.message,D}finally{e.value=!1}};return{students:_e(()=>n.value),loading:_e(()=>e.value),error:_e(()=>r.value),totalCount:_e(()=>s.value),loadStudents:y,getStudent:_,verifyStudentAccess:x,loadStudentsPaginated:b,getAdminStudents:o,getAdmin504Students:l,getCaseManagerStudents:u,getTeacherStudents:f,getServiceProviderStudents:h,getParaeducatorStudents:p,getTestingStudents:g}}function YB(t,e){const r={isSecure:!0,violations:[],summary:"",studentCount:t.length,authorizedCount:0,unauthorizedCount:0};return!e||!e.role?(r.isSecure=!1,r.violations.push("No user or role provided"),r):(t.forEach((n,s)=>{var a,o,l,c;QB(n,e)?r.authorizedCount++:(r.unauthorizedCount++,r.isSecure=!1,r.violations.push({studentIndex:s,studentName:`${(o=(a=n.app)==null?void 0:a.studentData)==null?void 0:o.firstName} ${(c=(l=n.app)==null?void 0:l.studentData)==null?void 0:c.lastName}`,studentId:n.id,reason:JB(n,e)}))}),r.summary=`User ${e.role} (${e.uid}) has access to ${r.authorizedCount}/${r.studentCount} students`,r.isSecure||(r.summary+=`. SECURITY VIOLATION: ${r.unauthorizedCount} unauthorized students accessible!`),r)}function QB(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"admin":case"school_admin":case"admin_504":case"sped_chair":case"staff_view":case"staff_edit":return!0;case"case_manager":return((i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===n;case"teacher":const f=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(f).includes(n);case"service_provider":const h=((l=t.app)==null?void 0:l.providers)||{},p=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},g=Object.values(h).includes(n),y=Object.values(p).includes(n);return g||y;case"paraeducator":return!0;default:return!1}}function JB(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"case_manager":const f=(i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId;return`Case manager ${n} is not assigned to student (assigned to: ${f})`;case"teacher":const h=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{},p=Object.values(h);return`Teacher ${n} does not teach this student (teachers: ${p.join(", ")})`;case"service_provider":const g=((l=t.app)==null?void 0:l.providers)||{},y=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},_=Object.values(g).filter(b=>b),x=Object.values(y);return`Service provider ${n} is not assigned to student (providers: ${_.join(", ")}, teachers: ${x.join(", ")})`;case"paraeducator":return null;default:return`Unknown role: ${r}`}}function ZB(t){t.isSecure?console.log(" SECURITY TEST PASSED:",t.summary):(console.error(" SECURITY TEST FAILED:",t.summary),console.error("Violations:",t.violations))}function Xb(t,e){const r=YB(t,e);return ZB(r),r}const v4=(t,e)=>{console.log(` DEBUG: Schedule Operation - ${t}:`,e)};function y4(t){return v4("getTeacherIdFromPeriod",{periodData:t,type:typeof t}),t?typeof t=="string"?t:t.teacherId||null:null}function Up(t){var e;return v4("getCoTeachingCaseManagerFromPeriod",{periodData:t}),!t||typeof t!="object"?null:((e=t.coTeaching)==null?void 0:e.caseManagerId)||null}function eU(t,e={}){if(!t||!t.periods)return[];const r=new Set;return Object.values(t.periods).forEach(n=>{const s=y4(n);s&&r.add(s);const i=Up(n);if(i){const a=e[i];a&&(a.role==="teacher"||a.roles&&a.roles.includes("teacher"))&&r.add(i)}}),Array.from(r)}function tU(t){if(!t||!t.periods)return[];const e=new Set;return Object.values(t.periods).forEach(r=>{const n=Up(r);n&&e.add(n)}),Array.from(e)}function rU(t,e){var r,n;return!((n=(r=t.app)==null?void 0:r.schedule)!=null&&n.periods)||!e?!1:Object.values(t.app.schedule.periods).some(s=>Up(s)===e)}function nU(){const t=ki(),e=Qr(),{students:r,setStudents:n}=Di(),{users:s,userList:i,fetchUsers:a,caseManagers:o,teacherList:l,userRoles:c}=_a(),{loadAideAssignment:u,loadAideAssignments:f,shouldAideSeeStudent:h,aideAssignment:p}=ex(),{feedbackForms:g,formsLoading:y}=tx(),{loadStudents:_}=XB(),x=se(!1),b=se(null),v=_e(()=>e.currentUser),T=_e(()=>{var N;const R=(N=v.value)==null?void 0:N.role;return["admin","school_admin","admin_504","sped_chair"].includes(R)}),D=_e(()=>{var R;return["case_manager","admin_504","sped_chair"].includes((R=v.value)==null?void 0:R.role)}),k=_e(()=>s.value||{}),S=_e(()=>{var R;return((R=i.value)==null?void 0:R.filter(N=>N.role==="paraeducator").sort((N,L)=>{const O=V=>{const z=V.name||V.email||V.id,U=z.split(" ");return U.length>1?U[U.length-1]:z};return O(N).localeCompare(O(L))}))||[]}),E=_e(()=>{var R;return((R=i.value)==null?void 0:R.filter(N=>N.role==="service_provider").sort((N,L)=>{const O=V=>{const z=V.name||V.email||V.id,U=z.split(" ");return U.length>1?U[U.length-1]:z};return O(N).localeCompare(O(L))}))||[]}),m=_e(()=>{var R,N;return!((R=r.value)!=null&&R.length)||!((N=o.value)!=null&&N.length)?[]:o.value.map(L=>{const O=r.value.filter(z=>W(z)===L.id).length,V=L.name||L.email||L.id;return{...L,displayName:`${V} (${O})`,count:O}}).sort((L,O)=>L.displayName.localeCompare(O.displayName))}),A=async()=>{var R;x.value=!0,b.value=null;try{await a();const N=v.value;if(N){const O=await _();n(O);const V=Xb(O,N);V.isSecure||console.error(" SECURITY VIOLATION DETECTED:",V.violations)}else n([]);const L=(R=v.value)==null?void 0:R.role;if(["admin","school_admin","admin_504","sped_chair"].includes(L))await f();else if(L==="paraeducator"&&v.value.uid){await u(v.value.uid);const O=et(Xe,"aideSchedules",v.value.uid),V=cf(O,async z=>{if(z.exists()){await u(v.value.uid);const U=await _();n(U)}});ja(()=>V())}}catch(N){console.error("Error fetching data:",N),b.value=N.message||"Failed to load data"}finally{x.value=!1}},I=R=>r.value.find(N=>N.id===R)||{},C=R=>{const N=s.value[R];return N&&(N.name||N.email)||R},F=R=>{if(!R)return"N/A";const N=s.value[R];return N&&(N.name||N.email)||R},W=R=>{var N,L;return((L=(N=R.app)==null?void 0:N.studentData)==null?void 0:L.caseManagerId)||R.caseManagerId||R.casemanager_id},P=R=>{var N,L,O,V,z;return R.schedule?R.schedule:(L=(N=R.app)==null?void 0:N.schedule)!=null&&L.periods?R.app.schedule.periods:(V=(O=R.aeries)==null?void 0:O.schedule)!=null&&V.periods?R.aeries.schedule.periods:(z=R.aeries)!=null&&z.schedule?R.aeries.schedule:null};return Wt(()=>{A()}),Ht(()=>{var R;return(R=v.value)==null?void 0:R.role},async(R,N)=>{if(R&&R!==N){const L=v.value;if(L){const O=await _();n(O);const V=Xb(O,L);V.isSecure||console.error(" SECURITY VIOLATION DETECTED:",V.violations)}}},{immediate:!1}),{isLoading:x,error:b,students:r,userMap:s,userList:i,userMapObj:k,caseManagers:o,caseManagersWithCounts:m,teacherList:l,userRoles:c,aideAssignment:p,feedbackForms:g,formsLoading:y,paraeducators:S,serviceProviders:E,currentUser:v,isAdmin:T,showProviderView:D,fetchData:A,getStudentById:I,getUserName:C,getCaseManagerName:F,getCaseManagerId:W,getSchedule:P,shouldAideSeeStudent:h,getTeacherIdFromPeriod:y4,getCoTeachingCaseManagerFromPeriod:Up,getAllTeacherIdsFromSchedule:eU,getCoTeachingCaseManagersFromSchedule:tU,isCoTeachingCaseManager:rU,router:t}}function at(t,e,r=""){const n=(l,c)=>c.split(".").reduce((u,f)=>u&&u[f]!==void 0?u[f]:null,l),s=n(t.overrides,e);if(t.overrides&&s!=null&&s!=="")return s;if(t.app){if(["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(e)){const c=n(t.app,`studentData.${e}`);if(c!=null&&c!=="")return c}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const c=n(t.app,`dates.${e}`);if(c!=null&&c!=="")return c}if(["instruction","assessment"].includes(e)){const c=n(t.app,`accommodations.${e}`);if(c!=null&&c!=="")return c}const l=n(t.app,e);if(l!=null&&l!=="")return l}const i=n(t.aeries,e);if(t.aeries&&i!=null&&i!=="")return i;const a=n(t.seis,e);if(t.seis&&a!=null&&a!=="")return a;const o=n(t,e);return o!=null&&o!==""?o:r}function du(t,e){const r=(o,l)=>l.split(".").reduce((c,u)=>c&&c[u]!==void 0?c[u]:null,o),n=r(t.overrides,e);if(t.overrides&&n!=null&&n!=="")return"Override";if(t.app){if(["firstName","lastName","grade","plan"].includes(e)){const l=r(t.app,`studentData.${e}`);if(l!=null&&l!=="")return"App"}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const l=r(t.app,`dates.${e}`);if(l!=null&&l!=="")return"App"}if(["instruction","assessment"].includes(e)){const l=r(t.app,`accommodations.${e}`);if(l!=null&&l!=="")return"App"}const o=r(t.app,e);if(o!=null&&o!=="")return"App"}const s=r(t.aeries,e);if(t.aeries&&s!=null&&s!=="")return"Aeries";const i=r(t.seis,e);if(t.seis&&i!=null&&i!=="")return"SEIS";const a=r(t,e);return a!=null&&a!==""?"Top-level":""}function sU(t){return t?`<ul class="bullet-list">${t.split(/\n|\r|\d+\.\s+|\-\s+|;/).map(r=>r.trim()).filter(Boolean).map(r=>`<li>${r}</li>`).join("")}</ul>`:"<div></div>"}function aU(t){const{students:e,currentUser:r,shouldAideSeeStudent:n,userMap:s,getCaseManagerId:i,getSchedule:a,aideAssignment:o}=t,l=se(!1),c=se([]),u=As({sortBy:"firstName",cm:"all",teacher:"all",paraeducator:"all",plan:"all",serviceProvider:"all",search:"",providerView:"all",viewMode:"list"});let f=null;const h=()=>{f&&clearTimeout(f),f=setTimeout(()=>{_()},300)},p=()=>{l.value&&g(),l.value=!l.value},g=()=>{u.sortBy="firstName",u.cm="all",u.teacher="all",u.paraeducator="all",u.plan="all",u.serviceProvider="all",u.search="",u.providerView="all",u.viewMode="list",_()},y=()=>({paraeducator:u.paraeducator,teacher:u.teacher,providerView:u.providerView}),_=(x=u)=>{var D,k,S,E;console.log(" FILTER DEBUG: applyFilters called with students.value.length:",e.value.length),console.log(" FILTER DEBUG: currentUser:",(D=r.value)==null?void 0:D.role,(k=r.value)==null?void 0:k.uid);let b=e.value;const v=(S=r.value)==null?void 0:S.role,T=["admin","school_admin"];if(console.log(" FILTER DEBUG: Provider view filtering check:",{userRole:v,providerView:x.providerView,shouldSkip:T.includes(v),resultLengthBefore:b.length}),!T.includes(v)&&x.providerView==="case_manager"?(console.log(" FILTER DEBUG: Applying case_manager filter"),b=b.filter(m=>{var A;return i(m)===((A=r.value)==null?void 0:A.uid)}),console.log(" FILTER DEBUG: After case_manager filter:",b.length)):!T.includes(v)&&x.providerView==="service_provider"?(console.log(" FILTER DEBUG: Applying service_provider filter"),b=b.filter(m=>{var W;const A=a(m),I=A?Object.entries(A).some(([P,R])=>{var N,L,O,V;return typeof R=="string"?R===((N=r.value)==null?void 0:N.uid):R&&typeof R=="object"?R.teacherId===((L=r.value)==null?void 0:L.uid)||((O=R.coTeaching)==null?void 0:O.caseManagerId)===((V=r.value)==null?void 0:V.uid):!1}):!1,C=(m.services||[]).some(P=>{var R;return P.includes((R=r.value)==null?void 0:R.uid)}),F=i(m)!==((W=r.value)==null?void 0:W.uid);return(I||C)&&F}),console.log(" FILTER DEBUG: After service_provider filter:",b.length)):console.log(" FILTER DEBUG: Skipping provider view filtering for role:",v),((E=r.value)==null?void 0:E.role)==="paraeducator"&&console.log(" FILTER DEBUG: Paraeducator - using database-filtered students, no additional filtering"),x.search){const m=x.search.toLowerCase();b=b.filter(A=>{const I=at(A,"firstName")||"",C=at(A,"lastName")||"";return`${I} ${C}`.toLowerCase().includes(m)})}if(x.cm&&x.cm!=="all"&&(b=b.filter(m=>i(m)===x.cm)),x.teacher&&x.teacher!=="all"&&(b=b.filter(m=>{const A=a(m);return A?Object.entries(A).some(([I,C])=>{var F;if(typeof C=="string")return C===x.teacher;if(C&&typeof C=="object"){const W=C.teacherId===x.teacher,P=((F=C.coTeaching)==null?void 0:F.caseManagerId)===x.teacher;return W||P}return!1}):!1})),x.paraeducator&&x.paraeducator!=="all"){console.log(" FILTER DEBUG: Applying paraeducator filter for:",x.paraeducator);const m=o.value[x.paraeducator];if(m){console.log(" FILTER DEBUG: Found aide data:",m);let A=[];m.studentIds&&Array.isArray(m.studentIds)?(A=m.studentIds,console.log(" FILTER DEBUG: Using studentIds array:",A)):m.directAssignment&&(A=Array.isArray(m.directAssignment)?m.directAssignment:[m.directAssignment],console.log(" FILTER DEBUG: Using directAssignment as fallback:",A)),b=b.filter(I=>A.includes(I.id)),console.log(" FILTER DEBUG: After paraeducator filter:",b.length,"students")}else console.log(" FILTER DEBUG: No aide data found for:",x.paraeducator),b=[]}x.plan&&x.plan!=="all"&&(b=b.filter(m=>at(m,"plan")===x.plan)),x.serviceProvider&&x.serviceProvider!=="all"&&(b=b.filter(m=>{var C;const A=((C=m.app)==null?void 0:C.providers)||{};for(const[F,W]of Object.entries(A))if(W===x.serviceProvider)return!0;return["speechId","speech_id","otId","ot_id","mhId","mh_id","ptId","pt_id","scId","sc_id","trId","tr_id","audId","aud_id","viId","vi_id","atId","at_id","dhhId","dhh_id","omId","om_id","bisId","bis_id","hnId","hn_id","swId","sw_id"].some(F=>m[F]===x.serviceProvider)})),x.sortBy&&b.sort((m,A)=>{const I=at(m,x.sortBy)||"",C=at(A,x.sortBy)||"";if(["reviewDate","reevalDate","meetingDate"].includes(x.sortBy)){const F=I?new Date(I).getTime():0,W=C?new Date(C).getTime():0;return F-W}return I.toString().toLowerCase().localeCompare(C.toString().toLowerCase())}),c.value=b,console.log(" FILTER DEBUG: applyFilters completed. filteredStudents.value.length:",c.value.length)};return Ht(()=>[e.value,r.value],()=>{console.log(" FILTER DEBUG: Watcher triggered. students.value.length:",e.value.length),e.value.length>0?(console.log(" FILTER DEBUG: Calling applyFilters from watcher"),_()):console.log(" FILTER DEBUG: No students to filter")},{deep:!0}),{showFilters:l,filteredStudents:c,currentFilters:u,toggleFilters:p,clearFilters:g,applyFilters:_,debouncedApplyFilters:h,getCurrentFilters:y}}const _u={grades:[],classServices:[{name:"SDC",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Co-teach",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"RSP",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Other",subcategories:["FA","Directed Studies","DS: Reading Intv"],enabledSubcategories:["FA","Directed Studies","DS: Reading Intv"]}],sdcSubcategories:[],customClassServices:[],serviceProviders:["SLP","OT","PT","SC","MH","TR","AUD","VI","AT","DHH","O&M","BIS","HN","SW"],customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"],gmailApi:{enabled:!1,isWorkspace:!1,isInternalOAuth:!1,lastCheck:null}},Aa=se({..._u}),Ta=se(!1),Do=se(null);let qf=!1;function Ts(){const t=et(Xe,"app_settings","global"),e=async()=>{if(Ta.value)return new Promise(i=>{const a=Ht(Ta,o=>{o||(a(),i(Aa.value))})});if(qf&&!Do.value)return Aa.value;Ta.value=!0,Do.value=null;try{const i=await er(t);Aa.value=i.exists()?i.data():{..._u}}catch{Aa.value={..._u}}finally{Ta.value=!1,qf=!0}return Aa.value},r=async i=>{Ta.value=!0,Do.value=null;try{const a=et(Xe,"app_settings","global");await $t(a,i),Aa.value={...i};try{localStorage.setItem("app_settings_backup",JSON.stringify(i))}catch(o){console.warn(" Failed to save localStorage backup:",o)}}catch(a){Do.value=a.message||"Unknown error";try{localStorage.setItem("app_settings_backup",JSON.stringify(i)),console.warn(" saveAppSettings: Fell back to localStorage due to Firestore error")}catch(o){throw console.error(" Both Firestore and localStorage saves failed:",o),new Error("Failed to save settings to both Firestore and localStorage")}}finally{Ta.value=!1}},n=async()=>{Ta.value=!0,Do.value=null;try{await $t(t,{..._u}),Aa.value={..._u},qf=!0}catch(i){throw Do.value=i.message,i}finally{Ta.value=!1}};return!qf&&!Ta.value&&e(),{appSettings:Aa,loadAppSettings:e,saveAppSettings:r,resetAppSettings:n,checkGmailApiStatus:async()=>{try{console.log(" Skipping OAuth validation to avoid authentication issues");const i=!1;let a=!1,o=i;try{const c=await fetch("https://oauth2.googleapis.com/tokeninfo");if(c.ok){const u=await c.json();a=u.hd&&u.hd.includes(".")}}catch(c){console.warn("Could not get detailed OAuth info:",c)}const l={enabled:i,isWorkspace:a,isInternalOAuth:o,lastCheck:new Date().toISOString()};return Aa.value={...Aa.value,gmailApi:l},l}catch(i){return console.error("Failed to check Gmail API status:",i),{enabled:!1,isWorkspace:!1,isInternalOAuth:!1,lastCheck:new Date().toISOString(),error:i.message}}},loading:Ta,error:Do}}function Eo(){const{appSettings:t}=Ts(),e=_e(()=>{const o=t.value;return o!=null&&o.periodLabels&&(o!=null&&o.numPeriods)?[...o.periodLabels.slice(0,o.numPeriods)]:["1","2","3","4","5","6","7"]}),r=o=>{const l=parseInt(o);if(!l||l<1)return`Period ${o}`;const c=l-1;return e.value[c]||`Period ${l}`},n=o=>{const l=e.value.findIndex(c=>c===o);return l!==-1?l+1:null},s=_e(()=>{var l;const o=((l=t.value)==null?void 0:l.numPeriods)||7;return Array.from({length:o},(c,u)=>u+1)}),i=_e(()=>{const o={};return e.value.forEach((l,c)=>{o[l]=c+1}),o}),a=_e(()=>{const o={};return e.value.forEach((l,c)=>{o[c+1]=l}),o});return{labels:e,getLabel:r,getNumber:n,numericPeriods:s,labelToNumberMap:i,numberToLabelMap:a}}function x4(t,e){const{students:r,userMapObj:n,currentUser:s,getCaseManagerId:i,getSchedule:a,getUserName:o,formatDate:l}=t,{getLabel:c}=Eo(),{filteredStudents:u,currentFilters:f,applyFilters:h}=e,p=(P,R)=>{if(!P)return{periods:{},isTeacher:!1,isCoTeacher:!1};let N=!1,L=!1;const O={};return Object.entries(P).forEach(([V,z])=>{const U=typeof z=="string"?z:z==null?void 0:z.teacherId,G=typeof z=="object"?z==null?void 0:z.coTeaching:null,j=G==null?void 0:G.caseManagerId;O[V]={teacherId:U,coTeaching:G,coTeachingCM:j,teacherName:o(U),coTeacherName:j?o(j):null,label:c(V)},U===R&&(N=!0),j===R&&(L=!0)}),{periods:O,isTeacher:N,isCoTeacher:L}},g=(P,R,N)=>{if(!P||!R)return[];switch(N){case"case_manager":return P.filter(L=>i(L)===R);case"service_provider":return P.filter(L=>{const O=a(L);return O?Object.values(O).some(z=>{var U;return typeof z=="string"?z===R:z&&typeof z=="object"?z.teacherId===R||((U=z.coTeaching)==null?void 0:U.caseManagerId)===R:!1}):!1});case"all":return P;default:return console.warn(`Unknown provider view: ${N}`),[]}},y=(P,R)=>!P||!R?[]:P.filter(N=>{const{isTeacher:L,isCoTeacher:O}=p(a(N),R);return L||O}),_=(P,R)=>{const N={};return P.forEach(L=>{const O=a(L);if(!O)return;const{periods:V}=p(O,R);Object.entries(V).forEach(([z,U])=>{(U.teacherId===R||U.coTeachingCM===R)&&(N[z]||(N[z]=[]),N[z].push(L))})}),N},x=_e(()=>u.value||[]),b=P=>{const R=at(P,"firstName"),N=at(P,"lastName");return`${R} ${N}`},v=P=>({name:b(P),grade:at(P,"grade"),plan:at(P,"plan"),caseManager:o(i(P))}),T=P=>({reviewDate:l(at(P,"reviewDate")),reevalDate:l(at(P,"reevalDate")),meetingDate:l(at(P,"meetingDate"))}),D=P=>{const R=a(P);return R?Object.entries(R).reduce((N,[L,O])=>(N[L]={teacherId:O,teacherName:o(O)},N),{}):{}},k=P=>{f.search=P,h()},S=P=>{f.cm=P,h()},E=P=>{f.teacher=P,h()},m=P=>{f.viewMode=P,h()},A=_e(()=>{const P={};return x.value.forEach(R=>{const N=at(R,"grade");P[N]||(P[N]=[]),P[N].push(R)}),P}),I=_e(()=>{const P={};return x.value.forEach(R=>{const N=at(R,"plan");P[N]||(P[N]=[]),P[N].push(R)}),P}),C=_e(()=>{var N;const P=(N=s.value)==null?void 0:N.role,R=f;return["teacher","paraeducator"].includes(P)?!1:P==="case_manager"||["sped_chair"].includes(P)?R.providerView!=="service_provider"&&R.teacher==="all":["admin","school_admin","staff_view","staff_edit","administrator","admin_504","administrator_504_CM"].includes(P)?R.teacher==="all"&&R.paraeducator==="all":P==="service_provider"?R.providerView!=="service_provider":!0}),F=_e(()=>{var R;const P=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(P)}),W=_e(()=>{var R;const P=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(P)});return Ht(()=>C.value,P=>{P&&f.viewMode==="class"&&(console.log(" Auto-switching from class view to list view because class view is now disabled"),f.viewMode="list",h())},{immediate:!1}),{visibleStudents:x,currentUser:s,userMapObj:n,standardizeScheduleAccess:p,getProviderViewStudents:g,getClassViewStudents:y,groupStudentsByPeriod:_,groupStudentsByGrade:A,groupStudentsByPlan:I,canAccessFilters:W,isClassViewDisabled:C,isAdminRole:F,formatStudentName:b,formatStudentInfo:v,formatDates:T,getStudentSchedule:D,filterByName:k,filterByCaseManager:S,filterByTeacher:E,setViewMode:m,currentFilters:f,showProviderView:!1,providerViewOptions:_e(()=>[])}}const Ft={ADMIN:"admin",SCHOOL_ADMIN:"school_admin",ADMIN_504:"admin_504",SPED_CHAIR:"sped_chair",STAFF_VIEW:"staff_view",STAFF_EDIT:"staff_edit",CASE_MANAGER:"case_manager",TEACHER:"teacher",SERVICE_PROVIDER:"service_provider",PARAEDUCATOR:"paraeducator"},iU={[Ft.ADMIN]:100,[Ft.SCHOOL_ADMIN]:90,[Ft.SPED_CHAIR]:80,[Ft.ADMIN_504]:70,[Ft.STAFF_EDIT]:65,[Ft.CASE_MANAGER]:60,[Ft.SERVICE_PROVIDER]:50,[Ft.STAFF_VIEW]:45,[Ft.TEACHER]:40,[Ft.PARAEDUCATOR]:30},lt={CAN_VIEW_ALL_STUDENTS:"canViewAllStudents",CAN_EDIT_ALL_STUDENTS:"canEditAllStudents",CAN_EDIT_OWN_STUDENTS:"canEditOwnStudents",CAN_SEND_FEEDBACK:"canSendFeedback",CAN_MANAGE_USERS:"canManageUsers",CAN_MANAGE_AIDES:"canManageAides",CAN_ACCESS_TESTING:"canAccessTesting",CAN_ACCESS_FILTERS:"canAccessFilters",SHOW_PROVIDER_VIEW:"showProviderView",CAN_USE_CLASS_VIEW:"canUseClassView"},oU={[Ft.ADMIN]:[lt.CAN_VIEW_ALL_STUDENTS,lt.CAN_EDIT_ALL_STUDENTS,lt.CAN_SEND_FEEDBACK,lt.CAN_MANAGE_USERS,lt.CAN_MANAGE_AIDES,lt.CAN_ACCESS_TESTING,lt.CAN_ACCESS_FILTERS,lt.SHOW_PROVIDER_VIEW,lt.CAN_USE_CLASS_VIEW],[Ft.ADMINISTRATOR]:[lt.CAN_VIEW_ALL_STUDENTS,lt.CAN_EDIT_ALL_STUDENTS,lt.CAN_SEND_FEEDBACK,lt.CAN_MANAGE_USERS,lt.CAN_MANAGE_AIDES,lt.CAN_ACCESS_TESTING,lt.CAN_ACCESS_FILTERS,lt.SHOW_PROVIDER_VIEW,lt.CAN_USE_CLASS_VIEW],[Ft.SPED_CHAIR]:[lt.CAN_VIEW_ALL_STUDENTS,lt.CAN_EDIT_ALL_STUDENTS,lt.CAN_SEND_FEEDBACK,lt.CAN_MANAGE_AIDES,lt.CAN_ACCESS_TESTING,lt.CAN_ACCESS_FILTERS,lt.SHOW_PROVIDER_VIEW,lt.CAN_USE_CLASS_VIEW],[Ft.SCHOOL_ADMIN]:[lt.CAN_VIEW_ALL_STUDENTS,lt.CAN_EDIT_ALL_STUDENTS,lt.CAN_SEND_FEEDBACK,lt.CAN_MANAGE_USERS,lt.CAN_MANAGE_AIDES,lt.CAN_ACCESS_TESTING,lt.CAN_ACCESS_FILTERS,lt.SHOW_PROVIDER_VIEW,lt.CAN_USE_CLASS_VIEW],[Ft.STAFF_VIEW]:[lt.CAN_VIEW_ALL_STUDENTS,lt.CAN_ACCESS_TESTING,lt.CAN_ACCESS_FILTERS,lt.CAN_USE_CLASS_VIEW],[Ft.STAFF_EDIT]:[lt.CAN_VIEW_ALL_STUDENTS,lt.CAN_EDIT_ALL_STUDENTS,lt.CAN_ACCESS_TESTING,lt.CAN_ACCESS_FILTERS,lt.CAN_USE_CLASS_VIEW],[Ft.ADMINISTRATOR_504_CM]:[lt.CAN_VIEW_ALL_STUDENTS,lt.CAN_EDIT_OWN_STUDENTS,lt.CAN_SEND_FEEDBACK,lt.CAN_MANAGE_USERS,lt.CAN_ACCESS_TESTING,lt.CAN_ACCESS_FILTERS,lt.SHOW_PROVIDER_VIEW,lt.CAN_USE_CLASS_VIEW],[Ft.CASE_MANAGER]:[lt.CAN_EDIT_OWN_STUDENTS,lt.CAN_SEND_FEEDBACK,lt.CAN_ACCESS_TESTING,lt.SHOW_PROVIDER_VIEW,lt.CAN_USE_CLASS_VIEW],[Ft.TEACHER]:[lt.CAN_ACCESS_TESTING,lt.CAN_USE_CLASS_VIEW],[Ft.SERVICE_PROVIDER]:[lt.CAN_EDIT_ALL_STUDENTS,lt.CAN_ACCESS_TESTING,lt.SHOW_PROVIDER_VIEW,lt.CAN_USE_CLASS_VIEW],[Ft.PARAEDUCATOR]:[lt.CAN_ACCESS_TESTING,lt.CAN_USE_CLASS_VIEW]},lU={[Ft.SPED_CHAIR]:[{value:"all_iep",label:"*"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"},{value:"all",label:"All"}],[Ft.ADMINISTRATOR_504_CM]:[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}],admin_504:[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}],[Ft.CASE_MANAGER]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}],[Ft.SERVICE_PROVIDER]:[{value:"all",label:"All"}]},cU={[Ft.SPED_CHAIR]:"all",[Ft.ADMINISTRATOR_504_CM]:"case_manager",admin_504:"case_manager",[Ft.CASE_MANAGER]:"all",[Ft.SERVICE_PROVIDER]:"service_provider"},uU={[Ft.CASE_MANAGER]:{patterns:["case_manager","teacher"],description:"Students in their caseload and students they provide services to"},[Ft.TEACHER]:{patterns:["teacher"],description:"Students in their classes"},[Ft.SERVICE_PROVIDER]:{patterns:["teacher"],description:"Students in their classes"},[Ft.PARAEDUCATOR]:{patterns:["paraeducator"],description:"Students they are assigned to assist"},[Ft.SPED_CHAIR]:{patterns:["case_manager","teacher","all_iep"],description:"All students, with special access to IEP students"},[Ft.ADMINISTRATOR_504_CM]:{patterns:["case_manager","all_iep_504"],description:"All students, with special access to IEP/504 students"},[Ft.ADMIN]:{patterns:["all"],description:"All students"},[Ft.ADMINISTRATOR]:{patterns:["all"],description:"All students"},[Ft.SCHOOL_ADMIN]:{patterns:["all"],description:"All students"},[Ft.STAFF_VIEW]:{patterns:["all"],description:"All students (view-only)"},[Ft.STAFF_EDIT]:{patterns:["all"],description:"All students (can edit)"}},Pa={case_manager:(t,e,r)=>r.getCaseManagerId(e)===t,teacher:(t,e,r)=>{const n=r.getSchedule(e);return n?Object.values(n).some(s=>{var i;return typeof s=="string"?s===t:s&&typeof s=="object"?s.teacherId===t||((i=s.coTeaching)==null?void 0:i.caseManagerId)===t:!1}):!1},paraeducator:(t,e,r,n)=>{if(!n)return!1;const s=n[t];if(!s)return!1;if((Array.isArray(s.directAssignment)?s.directAssignment:s.directAssignment?[s.directAssignment]:[]).includes(e.id))return!0;const a=r.getSchedule(e);if(!a)return!1;const o=s.classAssignment||{};return Object.entries(a).some(([l,c])=>{const u=typeof c=="string"?c:c==null?void 0:c.teacherId,f=o[l];return!f||!u?!1:(Array.isArray(f)?f:[f]).includes(u)})},all_iep:(t,e,r)=>at(e,"plan")==="IEP",all_iep_504:(t,e,r)=>{const n=at(e,"plan");return n==="IEP"||n==="504"},all:()=>!0},dU={[Ft.CASE_MANAGER]:{canSendFeedback:(t,e,r)=>r.getCaseManagerId(e)===t,description:"Can send feedback for students in their caseload"},[Ft.SPED_CHAIR]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=Pa.teacher(t,e,r),i=Pa.all_iep(t,e,r);return n||s||i},description:"Can send feedback for students they case manage, teach, or have IEP"},[Ft.ADMINISTRATOR_504_CM]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=Pa.all_iep_504(t,e,r);return n||s},description:"Can send feedback for students they case manage or have IEP/504"},[Ft.ADMIN]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"},[Ft.ADMINISTRATOR]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"}},Cn={hasPermission:(t,e)=>(oU[t]||[]).includes(e),getProviderViewOptions:t=>lU[t]||[],getDefaultProviderView:t=>cU[t]||"all",canAccessStudent:(t,e,r,n,s=null)=>{var a;return(((a=uU[e])==null?void 0:a.patterns)||[]).some(o=>{const l=Pa[o];return l?l(t,r,n,s):!1})},canSendFeedback:(t,e,r,n)=>{const s=dU[e];return s?s.canSendFeedback(t,r,n):!1},getRoleLevel:t=>iU[t]||0,hasHigherPrivileges:(t,e)=>Cn.getRoleLevel(t)>Cn.getRoleLevel(e)};function fU(t,e){const r=x4(t,e),n=_e(()=>{var F;return(F=r.currentUser.value)==null?void 0:F.uid}),s=_e(()=>{var F;return((F=r.currentUser.value)==null?void 0:F.role)||"guest"});console.log(" UNIFIED ROLE VIEW: Composable initialized for role:",s.value);const i=_e(()=>Cn.getProviderViewOptions(s.value));Ht(i,F=>{if(F.length>0){const W=Cn.getDefaultProviderView(s.value);F.map(R=>R.value).includes(e.currentFilters.providerView)||(e.currentFilters.providerView=W,e.applyFilters())}},{immediate:!0});const a=_e(()=>{if(console.log(" UNIFIED ROLE VIEW: visibleStudents computed called for role:",s.value),!n.value)return console.log(" UNIFIED ROLE VIEW: No currentUserId, returning empty array"),[];const F=r.visibleStudents.value,W=e.currentFilters.providerView,P=s.value;if(console.log(" UNIFIED ROLE VIEW: Processing students:",{role:P,baseStudentsCount:F.length,providerView:W,currentUserId:n.value}),P==="paraeducator"||P==="teacher"||P==="service_provider")return console.log(` ${P.toUpperCase()} ROLE VIEW: Received ${F.length} students from database`),console.log(` ${P.toUpperCase()} ROLE VIEW: Student names:`,F.map(R=>{var N,L,O,V;return`${((L=(N=R.app)==null?void 0:N.studentData)==null?void 0:L.firstName)||"Unknown"} ${((V=(O=R.app)==null?void 0:O.studentData)==null?void 0:V.lastName)||"Unknown"}`})),console.log(` ${P.toUpperCase()} ROLE VIEW: Returning students directly (no provider view filtering)`),F;if(!W||W==="")return F.filter(R=>Cn.canAccessStudent(n.value,P,R,t));switch(W){case"case_manager":return F.filter(R=>Pa.case_manager(n.value,R,t));case"service_provider":return F.filter(R=>Pa.teacher(n.value,R,t));case"all":return F.filter(R=>Cn.canAccessStudent(n.value,P,R,t));case"iep_all":return P==="sped_chair"?F.filter(R=>Pa.all_iep(n.value,R,t)):[];case"all_iep":return F.filter(R=>{const N=Pa.case_manager(n.value,R,t),L=Pa.teacher(n.value,R,t);return N||L});case"iep_504_all":return P==="administrator_504_CM"||P==="admin_504"?F.filter(R=>Pa.all_iep_504(n.value,R,t)):[];default:return console.warn(`Unknown provider view: ${W}`),[]}}),o=_e(()=>Cn.hasPermission(s.value,lt.CAN_EDIT_ALL_STUDENTS)),l=_e(()=>Cn.hasPermission(s.value,lt.CAN_EDIT_OWN_STUDENTS)),c=_e(()=>Cn.hasPermission(s.value,lt.CAN_VIEW_ALL_STUDENTS)),u=_e(()=>Cn.hasPermission(s.value,lt.CAN_MANAGE_USERS)),f=_e(()=>Cn.hasPermission(s.value,lt.CAN_MANAGE_AIDES)),h=_e(()=>Cn.hasPermission(s.value,lt.CAN_ACCESS_TESTING)),p=_e(()=>h.value),g=_e(()=>h.value),y=_e(()=>Cn.hasPermission(s.value,lt.CAN_ACCESS_FILTERS)),_=_e(()=>Cn.hasPermission(s.value,lt.SHOW_PROVIDER_VIEW)),x=_e(()=>Cn.hasPermission(s.value,lt.CAN_USE_CLASS_VIEW)),b=F=>{var R,N;if(!n.value||!F)return!1;const W=s.value;return W==="paraeducator"||W==="teacher"?!1:W==="case_manager"?t.getCaseManagerId(F)===n.value:W==="service_provider"?(N=(R=F.app)==null?void 0:R.staffIds)==null?void 0:N.includes(n.value):["admin","school_admin","staff_edit","admin_504","sped_chair"].includes(W)},v=F=>!n.value||!F?!1:Cn.canSendFeedback(n.value,s.value,F,t),T=_e(()=>{if(!n.value)return{};const F=e.currentFilters.teacher;if(F&&F!=="all")return r.groupStudentsByPeriod(a.value,F);const W=e.currentFilters.paraeducator;return W&&W!=="all"?r.groupStudentsByPeriod(a.value,W):r.groupStudentsByPeriod(a.value,n.value)}),D=F=>{if(F==="class"&&!x.value){e.currentFilters.viewMode="list";return}e.currentFilters.viewMode=F},k=_e(()=>{if(s.value!=="teacher")return{instruction:[],assessment:[]};const F={instruction:[],assessment:[]};return a.value.forEach(W=>{var P,R,N,L;(R=(P=W.app)==null?void 0:P.accommodations)!=null&&R.instruction&&F.instruction.push(W),(L=(N=W.app)==null?void 0:N.accommodations)!=null&&L.assessment&&F.assessment.push(W)}),F}),S=_e(()=>{if(s.value!=="teacher")return{};const F={};return a.value.forEach(W=>{var R;const P=((R=W.app)==null?void 0:R.providers)||{};Object.entries(P).forEach(([N,L])=>{L&&(F[L]||(F[L]={provider:t.getUserName(L),providerType:N,students:[]}),F[L].students.push(W))})}),F}),E=_e(()=>s.value==="teacher"),m=_e(()=>s.value==="teacher"),A=_e(()=>s.value==="teacher"),I=_e(()=>!1),C=_e(()=>!1);return{...r,visibleStudents:a,studentsByPeriod:T,providerViewOptions:i,showProviderView:_,canEditAllStudents:o,canEditOwnStudents:l,canViewAllStudents:c,canManageUsers:u,canManageAides:f,canAccessTesting:h,canAccessTestingPartial:p,hasAnyTestingAccess:g,canAccessFilters:y,canUseClassView:x,canEditStudent:b,canSendFeedback:v,setViewMode:D,studentsByAccommodation:k,studentsByServiceProvider:S,canViewAccommodations:E,canViewBasicInfo:m,canViewServiceProviders:A,canViewDates:I,canEditStudents:C,currentRole:s,currentUserId:n}}function hU(t,e){const r=x4(t,e),n=_e(()=>{var o;return(o=r.currentUser.value)==null?void 0:o.uid}),s=_e(()=>[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}]);Ht(s,o=>{const l="case_manager";o.map(u=>u.value).includes(e.currentFilters.providerView)||(e.currentFilters.providerView=l,e.applyFilters())},{immediate:!0});const i=_e(()=>{if(!n.value)return[];const o=r.visibleStudents.value;switch(e.currentFilters.providerView){case"case_manager":return r.getProviderViewStudents(o,n.value,"case_manager");case"iep_504_all":return o.filter(c=>{const u=at(c,"plan");return u==="IEP"||u==="504"});default:return[]}}),a=_e(()=>{if(!n.value)return{};const o=e.currentFilters.teacher;if(o&&o!=="all")return r.groupStudentsByPeriod(i.value,o);const l=e.currentFilters.paraeducator;return l&&l!=="all"?r.groupStudentsByPeriod(i.value,l):r.groupStudentsByPeriod(i.value,n.value)});return{...r,visibleStudents:i,studentsByPeriod:a,providerViewOptions:s,showProviderView:!0}}function pU(t,e){var g,y,_,x;const{currentUser:r}=t;Qy();const n=_e(()=>{var b;return((b=r.value)==null?void 0:b.role)||"guest"}),i=_e(()=>{switch(n.value){case"admin_504":return hU(t,e);default:return fU(t,e)}}).value;n.value==="paraeducator"&&console.log(" ROLE-BASED VIEW: Paraeducator activeView:",{visibleStudents:((y=(g=i.visibleStudents)==null?void 0:g.value)==null?void 0:y.length)||0,providerViewOptions:((x=(_=i.providerViewOptions)==null?void 0:_.value)==null?void 0:x.length)||0,role:n.value});const a=_e(()=>{var v;const b=(v=r.value)==null?void 0:v.role;return["admin","school_admin","staff_edit","sped_chair"].includes(b)}),o=_e(()=>{var v;const b=(v=r.value)==null?void 0:v.role;return["case_manager","admin_504"].includes(b)}),l=_e(()=>{var v;const b=(v=r.value)==null?void 0:v.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(b)}),c=_e(()=>{var v;const b=(v=r.value)==null?void 0:v.role;return["admin","school_admin","admin_504","sped_chair"].includes(b)}),u=_e(()=>{var v;const b=(v=r.value)==null?void 0:v.role;return["admin","school_admin","admin_504","sped_chair"].includes(b)}),f=_e(()=>!0),h=_e(()=>!0),p=_e(()=>!0);return{...i,currentRole:n,canEditAllStudents:a,canEditOwnStudents:o,canViewAllStudents:l,canManageUsers:c,canManageAides:u,canAccessTesting:f,canAccessTestingPartial:h,hasAnyTestingAccess:p}}function mU(t){Object.entries(t).reduce((e,[r,n])=>(e[r]=n.length,e),{})}function gU(){const t=Qr(),e=se([]),r=se(!1),n=se(null),s=_e(()=>{var l;const o=((l=t.currentUser)==null?void 0:l.testingAccess)===!0;return console.log(" Testing Access Check: hasTestingAccess =",o,"user:",t.currentUser),o}),i=async()=>{if(!s.value)return console.warn(" Testing Access: User does not have testing access permission"),[];r.value=!0,n.value=null;try{console.log(" Testing Access: Fetching testing accommodations data");const o=lr(At(Xe,"testingAccommodations")),l=await Gt(o);return e.value=l.docs.map(c=>({id:c.id,...c.data()})).sort((c,u)=>{const f=c.lastName||"",h=u.lastName||"";return f.localeCompare(h)}),console.log(` Testing Access: Loaded ${e.value.length} testing students`),e.value}catch(o){return console.error(" Testing Access Error:",o),n.value=o.message,[]}finally{r.value=!1}},a=()=>{e.value=[],n.value=null};return{testingData:nc(e),loading:nc(r),error:nc(n),hasTestingAccess:s,fetchTestingData:i,clearTestingData:a}}function vU(t,e,r=null){const{aideAssignment:n,getCaseManagerId:s,getSchedule:i,standardizeScheduleAccess:a,currentUser:o}=t,{filteredStudents:l,currentFilters:c,getCurrentFilters:u}=e,f=r||l,{testingData:h,hasTestingAccess:p,fetchTestingData:g}=gU(),y=se("list");Ht(()=>c.viewMode,D=>{y.value=D||"list"});const _=_e(()=>{const D=o.value;if(!D)return[];if(["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(D.role))return f.value.filter(S=>{var E,m,A,I;return((m=(E=S.app)==null?void 0:E.flags)==null?void 0:m.flag2)||((I=(A=S.app)==null?void 0:A.flags)==null?void 0:I.separateSetting)||S.separateSetting||S.flag2||!1});if(D.testingAccess===!0){console.log(" Testing Access: User has testingAccess=true"),console.log(" Testing Access: testingData.value:",h.value),console.log(" Testing Access: testingData.value.length:",h.value.length),console.log(" Testing Access: hasTestingAccess.value:",p.value);let S=h.value;if(c.search&&c.search.trim()){const E=c.search.toLowerCase();S=S.filter(m=>{const A=at(m,"firstName","").toLowerCase(),I=at(m,"lastName","").toLowerCase();return A.includes(E)||I.includes(E)}),console.log(" Testing Access: Applied search filter, results:",S.length)}return S}return f.value.filter(S=>{var E,m,A,I;return((m=(E=S.app)==null?void 0:E.flags)==null?void 0:m.flag2)||((I=(A=S.app)==null?void 0:A.flags)==null?void 0:I.separateSetting)||S.separateSetting||S.flag2||!1})}),x=_e(()=>{var A,I,C;const D={};if(y.value!=="class")return D;const k=(A=o.value)==null?void 0:A.uid;if(!k)return console.log(" studentsByClass: No current user ID"),D;console.log(" studentsByClass: Current user ID:",k);const S=(I=t.currentUser.value)==null?void 0:I.role;S==="paraeducator"&&console.log(" studentsByClass DEBUG:",{role:S,roleBasedStudents:((C=r==null?void 0:r.value)==null?void 0:C.length)||0,aideAssignmentAvailable:!!n.value});let E;S==="case_manager"?(E=t.students.value,console.log(" studentsByClass: Case manager - using raw database students:",E.length)):S==="paraeducator"?(E=(r==null?void 0:r.value)||t.students.value,console.log(" studentsByClass: Paraeducator - using role-based students:",E.length)):(E=f.value,console.log(" studentsByClass: Other role - using provider-filtered students:",E.length));const m=u();return m.paraeducator&&m.paraeducator,E.forEach(F=>{const W=i(F)||{};Object.entries(W).forEach(([P,R])=>{var j,ee;let N,L;if(typeof R=="string")N=R;else if(R&&typeof R=="object")N=R.teacherId,L=(j=R.coTeaching)==null?void 0:j.caseManagerId;else return;let O=!1;const V=u(),z=V.teacher&&V.teacher!=="all",U=V.paraeducator&&V.paraeducator!=="all";if(S==="paraeducator"){const ae=(ee=n.value)==null?void 0:ee[k];ae!=null&&ae.classAssignment&&ae.classAssignment[P]&&(O=(Array.isArray(ae.classAssignment[P])?ae.classAssignment[P]:[ae.classAssignment[P]]).includes(N))}else if(["admin","administrator","admin_504","sped_chair"].includes(S))if(z)O=N===V.teacher||L===V.teacher;else if(U){const ae=n.value[V.paraeducator];ae!=null&&ae.classAssignment&&ae.classAssignment[P]&&(O=(Array.isArray(ae.classAssignment[P])?ae.classAssignment[P]:[ae.classAssignment[P]]).includes(N))}else S==="sped_chair"&&u().providerView==="service_provider"?O=N===k||L===k:O=!1;else O=N===k||L===k;!O||(D[P]||(D[P]=[]),D[P].some(ae=>ae.id===F.id))||D[P].push(F)})}),console.log(" studentsByClass: Final groups:",Object.keys(D).map(F=>`Period ${F}: ${D[F].length} students`)),mU(D),Object.keys(D).forEach(F=>{D[F].length===0&&delete D[F]}),Object.keys(D).sort((F,W)=>{const P=parseInt(F.replace(/\D/g,"")),R=parseInt(W.replace(/\D/g,""));return P-R}).reduce((F,W)=>(F[W]=D[W],F),{})}),b=_e(()=>{var C,F;const D=u(),k=(C=t.currentUser.value)==null?void 0:C.role,S=(F=t.currentUser.value)==null?void 0:F.uid;let E=null;if(k==="paraeducator")E=S;else{if(!(D.paraeducator&&D.paraeducator!=="all"))return[];E=D.paraeducator}if(!E)return[];const m=n.value[E];if(!m||!m.directAssignment)return console.log(" directAssignmentStudents: No aide data or direct assignment for",E),[];const A=Array.isArray(m.directAssignment)?m.directAssignment:[m.directAssignment];console.log(" directAssignmentStudents: Direct student IDs:",A),console.log(" directAssignmentStudents: Available students:",f.value.length);const I=f.value.filter(W=>A.includes(W.id));return console.log(" directAssignmentStudents: Found direct assignment students:",I.length),I}),v=_e(()=>{const D={};return f.value.forEach(k=>{const S=s(k);S&&(D[S]||(D[S]=[]),D[S].push(k))}),D});return{currentViewMode:y,studentsByClass:x,directAssignmentStudents:b,studentsByCaseManager:v,testingViewStudents:_,setViewMode:D=>{y.value=D,c.viewMode=D},fetchTestingData:g,hasTestingAccess:p}}function yU(t){const{router:e,fetchData:r}=t,n=se(null),s=se(null),i=se(!1),a=se(!1),o=se(!1),l=se(null),c=v=>{n.value=v},u=v=>{s.value=v},f=v=>{l.value=v,o.value=!0},h=()=>{console.log("Teacher feedback form sent successfully")},p=()=>{a.value=!1,r()},g=()=>{console.log("Student saved"),r()},y=()=>{e.push("/admin")},_=()=>{e.push("/aide-schedule")},x=async v=>{switch(v){case"add-student":a.value=!0;break;case"export":i.value=!0;break;case"print":window.print();break;case"admin":y();break;case"aide-schedule":_();break;case"logout":await b();break}},b=async()=>{try{const{useAuthStore:v}=await ua(async()=>{const{useAuthStore:D}=await Promise.resolve().then(()=>xL);return{useAuthStore:D}},void 0);await v().logout(),e.push("/login")}catch(v){console.error("Logout failed:",v)}};return{editingStudentId:n,emailingStudentId:s,showExport:i,showAddStudent:a,showFeedbackDialog:o,feedbackStudentId:l,editStudent:c,emailStudent:u,handleTeacherFeedback:f,handleFormSent:h,handleStudentAdded:p,handleStudentSaved:g,navigateToAdmin:y,navigateToAideSchedule:_,handleNavAction:x,handleLogout:b}}const xU={class:"student-nav-menu"},EU=["title"],bU={class:"nav-content"},_U={class:"nav-section"},SU={class:"nav-buttons"},AU={key:0,class:"nav-section"},TU={class:"nav-buttons"},wU={key:1,class:"nav-section"},CU={class:"nav-buttons"},IU={class:"nav-section"},kU={class:"user-info"},DU={class:"user-details"},PU={key:0,class:"user-role"},RU={__name:"StudentNavMenu",props:{currentUser:{type:Object,default:null},isAdmin:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:e}){const r=t,n=e,s=_e(()=>{var u;const c=(u=r.currentUser)==null?void 0:u.role;return c!=="paraeducator"&&c!=="teacher"}),i=se(!1);function a(){i.value=!i.value}function o(){i.value=!1}function l(c){n("action",c),o()}return(c,u)=>{var f,h,p,g;return M(),B("div",xU,[d("button",{onClick:a,class:Ye(["hamburger-btn",{active:i.value}]),title:i.value?"Close Menu":"Open Menu"},u[6]||(u[6]=[d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1)]),10,EU),i.value?(M(),B("div",{key:0,class:"nav-overlay",onClick:o})):ve("",!0),d("div",{class:Ye(["nav-panel",{open:i.value}])},[d("div",{class:"nav-header"},[u[7]||(u[7]=d("h3",null,"Student Management",-1)),d("button",{onClick:o,class:"close-btn"},"")]),d("div",bU,[d("div",_U,[u[11]||(u[11]=d("h4",null,"Actions",-1)),d("div",SU,[s.value?(M(),B("button",{key:0,onClick:u[0]||(u[0]=y=>l("add-student")),class:"nav-btn primary"},u[8]||(u[8]=[d("span",null,"",-1),we(" Add Student ")]))):ve("",!0),d("button",{onClick:u[1]||(u[1]=y=>l("export")),class:"nav-btn"},u[9]||(u[9]=[d("span",null,"",-1),we(" Export ")])),d("button",{onClick:u[2]||(u[2]=y=>l("print")),class:"nav-btn print-btn"},u[10]||(u[10]=[d("span",null,"",-1),we(" Print ")]))])]),t.isAdmin?(M(),B("div",AU,[u[13]||(u[13]=d("h4",null,"Admin",-1)),d("div",TU,[d("button",{onClick:u[3]||(u[3]=y=>l("admin")),class:"nav-btn"},u[12]||(u[12]=[d("span",null,"",-1),we(" Admin Panel ")]))])])):ve("",!0),((f=t.currentUser)==null?void 0:f.role)==="paraeducator"?(M(),B("div",wU,[u[15]||(u[15]=d("h4",null,"Schedule",-1)),d("div",CU,[d("button",{onClick:u[4]||(u[4]=y=>l("aide-schedule")),class:"nav-btn"},u[14]||(u[14]=[d("span",null,"",-1),we(" My Schedule ")]))])])):ve("",!0),d("div",IU,[u[17]||(u[17]=d("h4",null,"User",-1)),d("div",kU,[d("div",DU,[d("strong",null,Q(((h=t.currentUser)==null?void 0:h.name)||((p=t.currentUser)==null?void 0:p.email)||"User"),1),(g=t.currentUser)!=null&&g.role?(M(),B("span",PU,"("+Q(t.currentUser.role)+")",1)):ve("",!0)]),d("button",{onClick:u[5]||(u[5]=y=>l("logout")),class:"nav-btn danger"},u[16]||(u[16]=[d("span",null,"",-1),we(" Logout ")]))])])])],2)])}}},FU=St(RU,[["__scopeId","data-v-fd6a61ad"]]);function NU(t){const{appSettings:e,loadAppSettings:r,loading:n,error:s}=Ts();console.log(" STUDENT TABLE: appSettings after useAppSettings():",e.value);const{getLabel:i}=Eo();Wt(async()=>{var P;try{await r(),t.studentData.students.value.length>0&&await an.logStudentAccess("table_view","view",{studentCount:t.studentData.students.value.length,viewType:"student_table",hasFilters:(P=t.filterData)!=null&&P.currentFilters?Object.keys(t.filterData.currentFilters).length>0:!1})}catch(R){console.error("StudentTable: Error loading app settings:",R)}});const a=P=>{const R=t.userMap[P];return R&&(R.name||R.email)||P},o=P=>{const R=t.userMap[P];return R?R.initials?R.initials:R.name?R.name.split(" ").map(L=>L[0]).join("").toUpperCase():R.email?R.email[0].toUpperCase():"?":"?"},l=P=>{const R=t.userMap[P];if(!R)return P;if(R.name){const N=R.name.trim().split(" ");return N.length===1?N[0]:`${N[0][0]}. ${N.slice(1).join(" ")}`}return R.email?R.email[0].toUpperCase():P},c=P=>{const R=t.userMap[P];if(!R)return"";const N=[];return R.rm&&N.push(`Rm: ${R.rm}`),R.ext&&N.push(`Ext: ${R.ext}`),N.length>0?N.join(" | "):""},u=c,f=P=>{if(!P||P===""||P===null||P===void 0)return"";let R;if(typeof P=="string"&&P.match(/^\d{4}-\d{2}-\d{2}$/)){const[N,L,O]=P.split("-").map(V=>parseInt(V,10));R=new Date(N,L-1,O)}else R=new Date(P);return isNaN(R.getTime())?"":R.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},h=P=>{if(!P)return"";const R=new Date,N=new Date(P),L=Math.ceil((N-R)/(1e3*60*60*24));return L<=0?"flag-critical":L<=7?"flag-high":L<=14?"flag-medium":L<=21?"flag-mid":L<=28?"flag-low":L<=35?"flag-prep":""},p=P=>{if(!P)return"";const R=new Date,N=new Date(P),L=Math.ceil((N-R)/(1e3*60*60*24));return L<=0?"flag-critical":L<=7?"flag-high":L<=14?"flag-medium":L<=21?"flag-mid":L<=28?"flag-low":L<=60?"flag-prep-reeval":""},g=P=>h(at(P,"meetingDate")),y=P=>h(at(P,"reviewDate")),_=P=>p(at(P,"reevalDate")),x=P=>{var R,N;return((N=(R=P.app)==null?void 0:R.studentData)==null?void 0:N.caseManagerId)||P.caseManagerId||P.casemanager_id},b=(P,R)=>{var N,L;return((L=(N=P.app)==null?void 0:N.flags)==null?void 0:L[R])||P[R]||!1},v=P=>{var R;return((R=P.app)==null?void 0:R.flags)&&Object.values(P.app.flags).some(Boolean)||P.flag1||P.flag2},T=(P,R)=>{var L,O,V;return((O=(L=P.app)==null?void 0:L.documents)==null?void 0:O[R])||((V=P.app)==null?void 0:V[R])||P[R]||P[`${R}_url`]||null},D=P=>{var N,L;const R=((L=(N=P.app)==null?void 0:N.documents)==null?void 0:L.additionalDocuments)||[];return Array.isArray(R)?R:[]},k=P=>{var R,N,L,O,V;if(P.schedule)return P.schedule;if((N=(R=P.app)==null?void 0:R.schedule)!=null&&N.periods)return P.app.schedule.periods;if((O=(L=P.aeries)==null?void 0:L.schedule)!=null&&O.periods)return P.aeries.schedule.periods;if((V=P.aeries)!=null&&V.schedule){const z={};return Object.entries(P.aeries.schedule).forEach(([U,G])=>{if(G&&G.teacherId){const j=parseInt(U.replace("period","")),ee=i(j);let ae=G.teacherId;if(t.userMap){let ne=Object.values(t.userMap).find(le=>le.aeriesId===G.teacherId||le.aeriesId===parseInt(G.teacherId)||le.id===G.teacherId);if(ne||(ne=Object.values(t.userMap).find(le=>{var Z,J,ge,te;return((Z=le.aeriesId)==null?void 0:Z.toString())===((J=G.teacherId)==null?void 0:J.toString())||((ge=le.id)==null?void 0:ge.toString())===((te=G.teacherId)==null?void 0:te.toString())})),ne&&ne.name){const le=ne.name.split(" ");if(le.length>=2){const Z=le[0],J=le[le.length-1];ae=`${Z.charAt(0)}. ${J}`}else ae=ne.name}}z[ee]=ae}}),Object.keys(z).length>0?z:null}return null},S=P=>{const R=[],N=k(P);return N&&Object.entries(N).forEach(([L,O])=>{if(O&&typeof O=="object"&&O.coTeaching){const V=O.coTeaching.subject;V&&R.push(`Co-teach: ${V}`)}}),R};return{appSettings:e,appSettingsLoading:n,appSettingsError:s,getUserName:a,getUserInitials:o,getUserInitialLastName:l,getUserTooltip:c,getCaseManagerTooltip:u,formatDate:f,getMeetingUrgencyClass:g,getReviewUrgencyClass:y,getReevalUrgencyClass:_,getCaseManagerId:x,getFlagValue:b,hasFlags:v,getDocumentUrl:T,getAdditionalDocuments:D,getSchedule:k,getClassServices:P=>{var z,U;const R=((U=(z=P.app)==null?void 0:z.schedule)==null?void 0:U.classServices)||P.services||[],N=S(P),L=R.filter(G=>G&&G.startsWith&&G.startsWith("Co-teach:")),O=N.filter(G=>!L.includes(G)),V=[...R,...O];if(n.value)return Array.isArray(V)?V.filter(G=>typeof G=="string"&&G.includes(":")):[];if(s.value)return Array.isArray(V)?V.filter(G=>typeof G=="string"&&G.includes(":")):[];if(e.value&&e.value.classServices){const G=e.value.classServices.filter(j=>j.enabledSubcategories&&j.enabledSubcategories.length>0).map(j=>j.name);return Array.isArray(V)?V.filter(j=>{if(typeof j!="string"||!j.includes(":"))return!1;const ee=j.split(":")[0];return G.includes(ee)}):[]}return Array.isArray(V)?V.filter(G=>typeof G=="string"&&G.includes(":")):[]},getOtherServices:P=>{var N,L;const R=((L=(N=P.app)==null?void 0:N.schedule)==null?void 0:L.otherServices)||P.other_services||[];return Array.isArray(R)?R.filter(O=>!!O):[]},getCoTeachingServices:S,hasServiceProviders:P=>{var O;const R=((O=P.app)==null?void 0:O.providers)||{},N=Object.values(R).some(Boolean);if(n.value||s.value){const V=P.speechId||P.speech_id||P.mhId||P.mh_id||P.otId||P.ot_id||P.ptId||P.pt_id||P.scId||P.sc_id||P.trId||P.tr_id||P.audId||P.aud_id||P.viId||P.vi_id||P.atId||P.at_id||P.dhhId||P.dhh_id||P.omId||P.om_id||P.bisId||P.bis_id||P.hnId||P.hn_id||P.swId||P.sw_id;return N||V}let L=!1;if(e.value&&e.value.serviceProviders){const V=e.value.serviceProviders,z={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"};L=V.some(U=>{const G=z[U];return P[G]||P[G.replace("Id","_id")]})}else L=P.speechId||P.speech_id||P.mhId||P.mh_id||P.otId||P.ot_id||P.ptId||P.pt_id||P.scId||P.sc_id||P.trId||P.tr_id||P.audId||P.aud_id||P.viId||P.vi_id||P.atId||P.at_id||P.dhhId||P.dhh_id||P.omId||P.om_id||P.bisId||P.bis_id||P.hnId||P.hn_id||P.swId||P.sw_id;return N||L},getServiceProviderId:(P,R)=>{var L,O;let N=(O=(L=P.app)==null?void 0:L.providers)==null?void 0:O[R];return N||(N=P[R]),N||(N=P[R.replace("Id","_id")]),N||null},getProviderFieldName:P=>({SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"})[P]||`${P.toLowerCase()}Id`,isDirectAssignment:P=>{if(!t.currentUser||t.currentUser.role!=="paraeducator")return!1;const R=t.currentUser.uid;let N=t.aideSchedule[R];if(!N){const L=Object.entries(t.userMap).find(([O,V])=>V.uid===R||V.email===t.currentUser.email);if(L){const[O]=L;N=t.aideSchedule[O]}}return(N==null?void 0:N.directAssignment)===P},formatListFromText:sU,getFlagClass:P=>{const R=P.toLowerCase();return R.includes("critical")?"flag-critical":R.includes("high")?"flag-high":R.includes("medium")?"flag-medium":R.includes("mid")?"flag-mid":R.includes("low")?"flag-low":R.includes("prep")?"flag-prep":"flag-low"},getPeriodLabel:i}}let Xf;const OU=new Uint8Array(16);function MU(){if(!Xf&&(Xf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Xf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Xf(OU)}const Tn=[];for(let t=0;t<256;++t)Tn.push((t+256).toString(16).slice(1));function LU(t,e=0){return Tn[t[e+0]]+Tn[t[e+1]]+Tn[t[e+2]]+Tn[t[e+3]]+"-"+Tn[t[e+4]]+Tn[t[e+5]]+"-"+Tn[t[e+6]]+Tn[t[e+7]]+"-"+Tn[t[e+8]]+Tn[t[e+9]]+"-"+Tn[t[e+10]]+Tn[t[e+11]]+Tn[t[e+12]]+Tn[t[e+13]]+Tn[t[e+14]]+Tn[t[e+15]]}const BU=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Yb={randomUUID:BU};function UU(t,e,r){if(Yb.randomUUID&&!t)return Yb.randomUUID();t=t||{};const n=t.random||(t.rng||MU)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,LU(n)}var jt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function E4(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function rx(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var b4={exports:{}};function $U(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Pm={exports:{}};const VU={},HU=Object.freeze(Object.defineProperty({__proto__:null,default:VU},Symbol.toStringTag,{value:"Module"})),jU=rx(HU);var Qb;function tr(){return Qb||(Qb=1,function(t,e){(function(r,n){t.exports=n()})(jt,function(){var r=r||function(n,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof jt<"u"&&jt.crypto&&(i=jt.crypto),!i&&typeof $U=="function")try{i=jU}catch{}var a=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function b(){}return function(v){var T;return b.prototype=v,T=new b,b.prototype=null,T}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(b){var v=o(this);return b&&v.mixIn(b),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var b=this.extend();return b.init.apply(b,arguments),b},init:function(){},mixIn:function(b){for(var v in b)b.hasOwnProperty(v)&&(this[v]=b[v]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=c.WordArray=u.extend({init:function(b,v){b=this.words=b||[],v!=s?this.sigBytes=v:this.sigBytes=b.length*4},toString:function(b){return(b||p).stringify(this)},concat:function(b){var v=this.words,T=b.words,D=this.sigBytes,k=b.sigBytes;if(this.clamp(),D%4)for(var S=0;S<k;S++){var E=T[S>>>2]>>>24-S%4*8&255;v[D+S>>>2]|=E<<24-(D+S)%4*8}else for(var m=0;m<k;m+=4)v[D+m>>>2]=T[m>>>2];return this.sigBytes+=k,this},clamp:function(){var b=this.words,v=this.sigBytes;b[v>>>2]&=4294967295<<32-v%4*8,b.length=n.ceil(v/4)},clone:function(){var b=u.clone.call(this);return b.words=this.words.slice(0),b},random:function(b){for(var v=[],T=0;T<b;T+=4)v.push(a());return new f.init(v,b)}}),h=l.enc={},p=h.Hex={stringify:function(b){for(var v=b.words,T=b.sigBytes,D=[],k=0;k<T;k++){var S=v[k>>>2]>>>24-k%4*8&255;D.push((S>>>4).toString(16)),D.push((S&15).toString(16))}return D.join("")},parse:function(b){for(var v=b.length,T=[],D=0;D<v;D+=2)T[D>>>3]|=parseInt(b.substr(D,2),16)<<24-D%8*4;return new f.init(T,v/2)}},g=h.Latin1={stringify:function(b){for(var v=b.words,T=b.sigBytes,D=[],k=0;k<T;k++){var S=v[k>>>2]>>>24-k%4*8&255;D.push(String.fromCharCode(S))}return D.join("")},parse:function(b){for(var v=b.length,T=[],D=0;D<v;D++)T[D>>>2]|=(b.charCodeAt(D)&255)<<24-D%4*8;return new f.init(T,v)}},y=h.Utf8={stringify:function(b){try{return decodeURIComponent(escape(g.stringify(b)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(b){return g.parse(unescape(encodeURIComponent(b)))}},_=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(b){typeof b=="string"&&(b=y.parse(b)),this._data.concat(b),this._nDataBytes+=b.sigBytes},_process:function(b){var v,T=this._data,D=T.words,k=T.sigBytes,S=this.blockSize,E=S*4,m=k/E;b?m=n.ceil(m):m=n.max((m|0)-this._minBufferSize,0);var A=m*S,I=n.min(A*4,k);if(A){for(var C=0;C<A;C+=S)this._doProcessBlock(D,C);v=D.splice(0,A),T.sigBytes-=I}return new f.init(v,I)},clone:function(){var b=u.clone.call(this);return b._data=this._data.clone(),b},_minBufferSize:0});c.Hasher=_.extend({cfg:u.extend(),init:function(b){this.cfg=this.cfg.extend(b),this.reset()},reset:function(){_.reset.call(this),this._doReset()},update:function(b){return this._append(b),this._process(),this},finalize:function(b){b&&this._append(b);var v=this._doFinalize();return v},blockSize:16,_createHelper:function(b){return function(v,T){return new b.init(T).finalize(v)}},_createHmacHelper:function(b){return function(v,T){return new x.HMAC.init(b,T).finalize(v)}}});var x=l.algo={};return l}(Math);return r})}(Pm)),Pm.exports}var Rm={exports:{}},Jb;function $p(){return Jb||(Jb=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=s.x64={};l.Word=a.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=a.extend({init:function(c,u){c=this.words=c||[],u!=n?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,f=[],h=0;h<u;h++){var p=c[h];f.push(p.high),f.push(p.low)}return o.create(f,this.sigBytes)},clone:function(){for(var c=a.clone.call(this),u=c.words=this.words.slice(0),f=u.length,h=0;h<f;h++)u[h]=u[h].clone();return c}})}(),r})}(Rm)),Rm.exports}var Fm={exports:{}},Zb;function GU(){return Zb||(Zb=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,s=n.lib,i=s.WordArray,a=i.init,o=i.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],f=0;f<c;f++)u[f>>>2]|=l[f]<<24-f%4*8;a.call(this,u,c)}else a.apply(this,arguments)};o.prototype=i}}(),r.lib.WordArray})}(Fm)),Fm.exports}var Nm={exports:{}},e_;function WU(){return e_||(e_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=c[h>>>2]>>>16-h%4*8&65535;f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=l.charCodeAt(f)<<16-f%2*16;return i.create(u,c*2)}},a.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=o(c[h>>>2]>>>16-h%4*8&65535);f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=o(l.charCodeAt(f)<<16-f%2*16);return i.create(u,c*2)}};function o(l){return l<<8&4278255360|l>>>8&16711935}}(),r.enc.Utf16})}(Nm)),Nm.exports}var Om={exports:{}},t_;function yl(){return t_||(t_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,f=this._map;l.clamp();for(var h=[],p=0;p<u;p+=3)for(var g=c[p>>>2]>>>24-p%4*8&255,y=c[p+1>>>2]>>>24-(p+1)%4*8&255,_=c[p+2>>>2]>>>24-(p+2)%4*8&255,x=g<<16|y<<8|_,b=0;b<4&&p+b*.75<u;b++)h.push(f.charAt(x>>>6*(3-b)&63));var v=f.charAt(64);if(v)for(;h.length%4;)h.push(v);return h.join("")},parse:function(l){var c=l.length,u=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<u.length;h++)f[u.charCodeAt(h)]=h}var p=u.charAt(64);if(p){var g=l.indexOf(p);g!==-1&&(c=g)}return o(l,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var g=u[l.charCodeAt(p-1)]<<p%4*2,y=u[l.charCodeAt(p)]>>>6-p%4*2,_=g|y;f[h>>>2]|=_<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64})}(Om)),Om.exports}var Mm={exports:{}},r_;function zU(){return r_||(r_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,f=l.sigBytes,h=c?this._safe_map:this._map;l.clamp();for(var p=[],g=0;g<f;g+=3)for(var y=u[g>>>2]>>>24-g%4*8&255,_=u[g+1>>>2]>>>24-(g+1)%4*8&255,x=u[g+2>>>2]>>>24-(g+2)%4*8&255,b=y<<16|_<<8|x,v=0;v<4&&g+v*.75<f;v++)p.push(h.charAt(b>>>6*(3-v)&63));var T=h.charAt(64);if(T)for(;p.length%4;)p.push(T);return p.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,f=c?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var p=0;p<f.length;p++)h[f.charCodeAt(p)]=p}var g=f.charAt(64);if(g){var y=l.indexOf(g);y!==-1&&(u=y)}return o(l,u,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var g=u[l.charCodeAt(p-1)]<<p%4*2,y=u[l.charCodeAt(p)]>>>6-p%4*2,_=g|y;f[h>>>2]|=_<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64url})}(Mm)),Mm.exports}var Lm={exports:{}},n_;function xl(){return n_||(n_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[];(function(){for(var y=0;y<64;y++)c[y]=n.abs(n.sin(y+1))*4294967296|0})();var u=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,_){for(var x=0;x<16;x++){var b=_+x,v=y[b];y[b]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}var T=this._hash.words,D=y[_+0],k=y[_+1],S=y[_+2],E=y[_+3],m=y[_+4],A=y[_+5],I=y[_+6],C=y[_+7],F=y[_+8],W=y[_+9],P=y[_+10],R=y[_+11],N=y[_+12],L=y[_+13],O=y[_+14],V=y[_+15],z=T[0],U=T[1],G=T[2],j=T[3];z=f(z,U,G,j,D,7,c[0]),j=f(j,z,U,G,k,12,c[1]),G=f(G,j,z,U,S,17,c[2]),U=f(U,G,j,z,E,22,c[3]),z=f(z,U,G,j,m,7,c[4]),j=f(j,z,U,G,A,12,c[5]),G=f(G,j,z,U,I,17,c[6]),U=f(U,G,j,z,C,22,c[7]),z=f(z,U,G,j,F,7,c[8]),j=f(j,z,U,G,W,12,c[9]),G=f(G,j,z,U,P,17,c[10]),U=f(U,G,j,z,R,22,c[11]),z=f(z,U,G,j,N,7,c[12]),j=f(j,z,U,G,L,12,c[13]),G=f(G,j,z,U,O,17,c[14]),U=f(U,G,j,z,V,22,c[15]),z=h(z,U,G,j,k,5,c[16]),j=h(j,z,U,G,I,9,c[17]),G=h(G,j,z,U,R,14,c[18]),U=h(U,G,j,z,D,20,c[19]),z=h(z,U,G,j,A,5,c[20]),j=h(j,z,U,G,P,9,c[21]),G=h(G,j,z,U,V,14,c[22]),U=h(U,G,j,z,m,20,c[23]),z=h(z,U,G,j,W,5,c[24]),j=h(j,z,U,G,O,9,c[25]),G=h(G,j,z,U,E,14,c[26]),U=h(U,G,j,z,F,20,c[27]),z=h(z,U,G,j,L,5,c[28]),j=h(j,z,U,G,S,9,c[29]),G=h(G,j,z,U,C,14,c[30]),U=h(U,G,j,z,N,20,c[31]),z=p(z,U,G,j,A,4,c[32]),j=p(j,z,U,G,F,11,c[33]),G=p(G,j,z,U,R,16,c[34]),U=p(U,G,j,z,O,23,c[35]),z=p(z,U,G,j,k,4,c[36]),j=p(j,z,U,G,m,11,c[37]),G=p(G,j,z,U,C,16,c[38]),U=p(U,G,j,z,P,23,c[39]),z=p(z,U,G,j,L,4,c[40]),j=p(j,z,U,G,D,11,c[41]),G=p(G,j,z,U,E,16,c[42]),U=p(U,G,j,z,I,23,c[43]),z=p(z,U,G,j,W,4,c[44]),j=p(j,z,U,G,N,11,c[45]),G=p(G,j,z,U,V,16,c[46]),U=p(U,G,j,z,S,23,c[47]),z=g(z,U,G,j,D,6,c[48]),j=g(j,z,U,G,C,10,c[49]),G=g(G,j,z,U,O,15,c[50]),U=g(U,G,j,z,A,21,c[51]),z=g(z,U,G,j,N,6,c[52]),j=g(j,z,U,G,E,10,c[53]),G=g(G,j,z,U,P,15,c[54]),U=g(U,G,j,z,k,21,c[55]),z=g(z,U,G,j,F,6,c[56]),j=g(j,z,U,G,V,10,c[57]),G=g(G,j,z,U,I,15,c[58]),U=g(U,G,j,z,L,21,c[59]),z=g(z,U,G,j,m,6,c[60]),j=g(j,z,U,G,R,10,c[61]),G=g(G,j,z,U,S,15,c[62]),U=g(U,G,j,z,W,21,c[63]),T[0]=T[0]+z|0,T[1]=T[1]+U|0,T[2]=T[2]+G|0,T[3]=T[3]+j|0},_doFinalize:function(){var y=this._data,_=y.words,x=this._nDataBytes*8,b=y.sigBytes*8;_[b>>>5]|=128<<24-b%32;var v=n.floor(x/4294967296),T=x;_[(b+64>>>9<<4)+15]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,_[(b+64>>>9<<4)+14]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,y.sigBytes=(_.length+1)*4,this._process();for(var D=this._hash,k=D.words,S=0;S<4;S++){var E=k[S];k[S]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}return D},clone:function(){var y=o.clone.call(this);return y._hash=this._hash.clone(),y}});function f(y,_,x,b,v,T,D){var k=y+(_&x|~_&b)+v+D;return(k<<T|k>>>32-T)+_}function h(y,_,x,b,v,T,D){var k=y+(_&b|x&~b)+v+D;return(k<<T|k>>>32-T)+_}function p(y,_,x,b,v,T,D){var k=y+(_^x^b)+v+D;return(k<<T|k>>>32-T)+_}function g(y,_,x,b,v,T,D){var k=y+(x^(_|~b))+v+D;return(k<<T|k>>>32-T)+_}s.MD5=o._createHelper(u),s.HmacMD5=o._createHmacHelper(u)}(Math),r.MD5})}(Lm)),Lm.exports}var Bm={exports:{}},s_;function _4(){return s_||(s_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.Hasher,o=n.algo,l=[],c=o.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,f){for(var h=this._hash.words,p=h[0],g=h[1],y=h[2],_=h[3],x=h[4],b=0;b<80;b++){if(b<16)l[b]=u[f+b]|0;else{var v=l[b-3]^l[b-8]^l[b-14]^l[b-16];l[b]=v<<1|v>>>31}var T=(p<<5|p>>>27)+x+l[b];b<20?T+=(g&y|~g&_)+1518500249:b<40?T+=(g^y^_)+1859775393:b<60?T+=(g&y|g&_|y&_)-1894007588:T+=(g^y^_)-899497514,x=_,_=y,y=g<<30|g>>>2,g=p,p=T}h[0]=h[0]+p|0,h[1]=h[1]+g|0,h[2]=h[2]+y|0,h[3]=h[3]+_|0,h[4]=h[4]+x|0},_doFinalize:function(){var u=this._data,f=u.words,h=this._nDataBytes*8,p=u.sigBytes*8;return f[p>>>5]|=128<<24-p%32,f[(p+64>>>9<<4)+14]=Math.floor(h/4294967296),f[(p+64>>>9<<4)+15]=h,u.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c)}(),r.SHA1})}(Bm)),Bm.exports}var Um={exports:{}},a_;function nx(){return a_||(a_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[],u=[];(function(){function p(x){for(var b=n.sqrt(x),v=2;v<=b;v++)if(!(x%v))return!1;return!0}function g(x){return(x-(x|0))*4294967296|0}for(var y=2,_=0;_<64;)p(y)&&(_<8&&(c[_]=g(n.pow(y,1/2))),u[_]=g(n.pow(y,1/3)),_++),y++})();var f=[],h=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(p,g){for(var y=this._hash.words,_=y[0],x=y[1],b=y[2],v=y[3],T=y[4],D=y[5],k=y[6],S=y[7],E=0;E<64;E++){if(E<16)f[E]=p[g+E]|0;else{var m=f[E-15],A=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,I=f[E-2],C=(I<<15|I>>>17)^(I<<13|I>>>19)^I>>>10;f[E]=A+f[E-7]+C+f[E-16]}var F=T&D^~T&k,W=_&x^_&b^x&b,P=(_<<30|_>>>2)^(_<<19|_>>>13)^(_<<10|_>>>22),R=(T<<26|T>>>6)^(T<<21|T>>>11)^(T<<7|T>>>25),N=S+R+F+u[E]+f[E],L=P+W;S=k,k=D,D=T,T=v+N|0,v=b,b=x,x=_,_=N+L|0}y[0]=y[0]+_|0,y[1]=y[1]+x|0,y[2]=y[2]+b|0,y[3]=y[3]+v|0,y[4]=y[4]+T|0,y[5]=y[5]+D|0,y[6]=y[6]+k|0,y[7]=y[7]+S|0},_doFinalize:function(){var p=this._data,g=p.words,y=this._nDataBytes*8,_=p.sigBytes*8;return g[_>>>5]|=128<<24-_%32,g[(_+64>>>9<<4)+14]=n.floor(y/4294967296),g[(_+64>>>9<<4)+15]=y,p.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});s.SHA256=o._createHelper(h),s.HmacSHA256=o._createHmacHelper(h)}(Math),r.SHA256})}(Um)),Um.exports}var $m={exports:{}},i_;function KU(){return i_||(i_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),nx())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c}});n.SHA224=o._createHelper(l),n.HmacSHA224=o._createHmacHelper(l)}(),r.SHA224})}($m)),$m.exports}var Vm={exports:{}},o_;function S4(){return o_||(o_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),$p())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.Hasher,a=n.x64,o=a.Word,l=a.WordArray,c=n.algo;function u(){return o.create.apply(o,arguments)}var f=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],h=[];(function(){for(var g=0;g<80;g++)h[g]=u()})();var p=c.SHA512=i.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(g,y){for(var _=this._hash.words,x=_[0],b=_[1],v=_[2],T=_[3],D=_[4],k=_[5],S=_[6],E=_[7],m=x.high,A=x.low,I=b.high,C=b.low,F=v.high,W=v.low,P=T.high,R=T.low,N=D.high,L=D.low,O=k.high,V=k.low,z=S.high,U=S.low,G=E.high,j=E.low,ee=m,ae=A,ne=I,le=C,Z=F,J=W,ge=P,te=R,K=N,Y=L,fe=O,ye=V,ie=z,ue=U,Ee=G,Ce=j,Pe=0;Pe<80;Pe++){var Te,ze,Ie=h[Pe];if(Pe<16)ze=Ie.high=g[y+Pe*2]|0,Te=Ie.low=g[y+Pe*2+1]|0;else{var be=h[Pe-15],Me=be.high,Ke=be.low,qe=(Me>>>1|Ke<<31)^(Me>>>8|Ke<<24)^Me>>>7,Se=(Ke>>>1|Me<<31)^(Ke>>>8|Me<<24)^(Ke>>>7|Me<<25),xe=h[Pe-2],Ae=xe.high,Le=xe.low,We=(Ae>>>19|Le<<13)^(Ae<<3|Le>>>29)^Ae>>>6,$e=(Le>>>19|Ae<<13)^(Le<<3|Ae>>>29)^(Le>>>6|Ae<<26),dt=h[Pe-7],xt=dt.high,Vt=dt.low,pt=h[Pe-16],ct=pt.high,mt=pt.low;Te=Se+Vt,ze=qe+xt+(Te>>>0<Se>>>0?1:0),Te=Te+$e,ze=ze+We+(Te>>>0<$e>>>0?1:0),Te=Te+mt,ze=ze+ct+(Te>>>0<mt>>>0?1:0),Ie.high=ze,Ie.low=Te}var Ct=K&fe^~K&ie,Rt=Y&ye^~Y&ue,mr=ee&ne^ee&Z^ne&Z,mn=ae&le^ae&J^le&J,Qs=(ee>>>28|ae<<4)^(ee<<30|ae>>>2)^(ee<<25|ae>>>7),ms=(ae>>>28|ee<<4)^(ae<<30|ee>>>2)^(ae<<25|ee>>>7),wl=(K>>>14|Y<<18)^(K>>>18|Y<<14)^(K<<23|Y>>>9),za=(Y>>>14|K<<18)^(Y>>>18|K<<14)^(Y<<23|K>>>9),So=f[Pe],ln=So.high,Ao=So.low,Rr=Ce+za,Ln=Ee+wl+(Rr>>>0<Ce>>>0?1:0),Rr=Rr+Rt,Ln=Ln+Ct+(Rr>>>0<Rt>>>0?1:0),Rr=Rr+Ao,Ln=Ln+ln+(Rr>>>0<Ao>>>0?1:0),Rr=Rr+Te,Ln=Ln+ze+(Rr>>>0<Te>>>0?1:0),Cl=ms+mn,Xc=Qs+mr+(Cl>>>0<ms>>>0?1:0);Ee=ie,Ce=ue,ie=fe,ue=ye,fe=K,ye=Y,Y=te+Rr|0,K=ge+Ln+(Y>>>0<te>>>0?1:0)|0,ge=Z,te=J,Z=ne,J=le,ne=ee,le=ae,ae=Rr+Cl|0,ee=Ln+Xc+(ae>>>0<Rr>>>0?1:0)|0}A=x.low=A+ae,x.high=m+ee+(A>>>0<ae>>>0?1:0),C=b.low=C+le,b.high=I+ne+(C>>>0<le>>>0?1:0),W=v.low=W+J,v.high=F+Z+(W>>>0<J>>>0?1:0),R=T.low=R+te,T.high=P+ge+(R>>>0<te>>>0?1:0),L=D.low=L+Y,D.high=N+K+(L>>>0<Y>>>0?1:0),V=k.low=V+ye,k.high=O+fe+(V>>>0<ye>>>0?1:0),U=S.low=U+ue,S.high=z+ie+(U>>>0<ue>>>0?1:0),j=E.low=j+Ce,E.high=G+Ee+(j>>>0<Ce>>>0?1:0)},_doFinalize:function(){var g=this._data,y=g.words,_=this._nDataBytes*8,x=g.sigBytes*8;y[x>>>5]|=128<<24-x%32,y[(x+128>>>10<<5)+30]=Math.floor(_/4294967296),y[(x+128>>>10<<5)+31]=_,g.sigBytes=y.length*4,this._process();var b=this._hash.toX32();return b},clone:function(){var g=i.clone.call(this);return g._hash=this._hash.clone(),g},blockSize:1024/32});n.SHA512=i._createHelper(p),n.HmacSHA512=i._createHmacHelper(p)}(),r.SHA512})}(Vm)),Vm.exports}var Hm={exports:{}},l_;function qU(){return l_||(l_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),$p(),S4())})(jt,function(r){return function(){var n=r,s=n.x64,i=s.Word,a=s.WordArray,o=n.algo,l=o.SHA512,c=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});n.SHA384=l._createHelper(c),n.HmacSHA384=l._createHmacHelper(c)}(),r.SHA384})}(Hm)),Hm.exports}var jm={exports:{}},c_;function XU(){return c_||(c_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),$p())})(jt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.x64,c=l.Word,u=s.algo,f=[],h=[],p=[];(function(){for(var _=1,x=0,b=0;b<24;b++){f[_+5*x]=(b+1)*(b+2)/2%64;var v=x%5,T=(2*_+3*x)%5;_=v,x=T}for(var _=0;_<5;_++)for(var x=0;x<5;x++)h[_+5*x]=x+(2*_+3*x)%5*5;for(var D=1,k=0;k<24;k++){for(var S=0,E=0,m=0;m<7;m++){if(D&1){var A=(1<<m)-1;A<32?E^=1<<A:S^=1<<A-32}D&128?D=D<<1^113:D<<=1}p[k]=c.create(S,E)}})();var g=[];(function(){for(var _=0;_<25;_++)g[_]=c.create()})();var y=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var _=this._state=[],x=0;x<25;x++)_[x]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(_,x){for(var b=this._state,v=this.blockSize/2,T=0;T<v;T++){var D=_[x+2*T],k=_[x+2*T+1];D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360;var S=b[T];S.high^=k,S.low^=D}for(var E=0;E<24;E++){for(var m=0;m<5;m++){for(var A=0,I=0,C=0;C<5;C++){var S=b[m+5*C];A^=S.high,I^=S.low}var F=g[m];F.high=A,F.low=I}for(var m=0;m<5;m++)for(var W=g[(m+4)%5],P=g[(m+1)%5],R=P.high,N=P.low,A=W.high^(R<<1|N>>>31),I=W.low^(N<<1|R>>>31),C=0;C<5;C++){var S=b[m+5*C];S.high^=A,S.low^=I}for(var L=1;L<25;L++){var A,I,S=b[L],O=S.high,V=S.low,z=f[L];z<32?(A=O<<z|V>>>32-z,I=V<<z|O>>>32-z):(A=V<<z-32|O>>>64-z,I=O<<z-32|V>>>64-z);var U=g[h[L]];U.high=A,U.low=I}var G=g[0],j=b[0];G.high=j.high,G.low=j.low;for(var m=0;m<5;m++)for(var C=0;C<5;C++){var L=m+5*C,S=b[L],ee=g[L],ae=g[(m+1)%5+5*C],ne=g[(m+2)%5+5*C];S.high=ee.high^~ae.high&ne.high,S.low=ee.low^~ae.low&ne.low}var S=b[0],le=p[E];S.high^=le.high,S.low^=le.low}},_doFinalize:function(){var _=this._data,x=_.words;this._nDataBytes*8;var b=_.sigBytes*8,v=this.blockSize*32;x[b>>>5]|=1<<24-b%32,x[(n.ceil((b+1)/v)*v>>>5)-1]|=128,_.sigBytes=x.length*4,this._process();for(var T=this._state,D=this.cfg.outputLength/8,k=D/8,S=[],E=0;E<k;E++){var m=T[E],A=m.high,I=m.low;A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,S.push(I),S.push(A)}return new a.init(S,D)},clone:function(){for(var _=o.clone.call(this),x=_._state=this._state.slice(0),b=0;b<25;b++)x[b]=x[b].clone();return _}});s.SHA3=o._createHelper(y),s.HmacSHA3=o._createHmacHelper(y)}(Math),r.SHA3})}(jm)),jm.exports}var Gm={exports:{}},u_;function YU(){return u_||(u_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=a.create([0,1518500249,1859775393,2400959708,2840853838]),g=a.create([1352829926,1548603684,1836072691,2053994217,0]),y=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(k,S){for(var E=0;E<16;E++){var m=S+E,A=k[m];k[m]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var I=this._hash.words,C=p.words,F=g.words,W=c.words,P=u.words,R=f.words,N=h.words,L,O,V,z,U,G,j,ee,ae,ne;G=L=I[0],j=O=I[1],ee=V=I[2],ae=z=I[3],ne=U=I[4];for(var le,E=0;E<80;E+=1)le=L+k[S+W[E]]|0,E<16?le+=_(O,V,z)+C[0]:E<32?le+=x(O,V,z)+C[1]:E<48?le+=b(O,V,z)+C[2]:E<64?le+=v(O,V,z)+C[3]:le+=T(O,V,z)+C[4],le=le|0,le=D(le,R[E]),le=le+U|0,L=U,U=z,z=D(V,10),V=O,O=le,le=G+k[S+P[E]]|0,E<16?le+=T(j,ee,ae)+F[0]:E<32?le+=v(j,ee,ae)+F[1]:E<48?le+=b(j,ee,ae)+F[2]:E<64?le+=x(j,ee,ae)+F[3]:le+=_(j,ee,ae)+F[4],le=le|0,le=D(le,N[E]),le=le+ne|0,G=ne,ne=ae,ae=D(ee,10),ee=j,j=le;le=I[1]+V+ae|0,I[1]=I[2]+z+ne|0,I[2]=I[3]+U+G|0,I[3]=I[4]+L+j|0,I[4]=I[0]+O+ee|0,I[0]=le},_doFinalize:function(){var k=this._data,S=k.words,E=this._nDataBytes*8,m=k.sigBytes*8;S[m>>>5]|=128<<24-m%32,S[(m+64>>>9<<4)+14]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,k.sigBytes=(S.length+1)*4,this._process();for(var A=this._hash,I=A.words,C=0;C<5;C++){var F=I[C];I[C]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}return A},clone:function(){var k=o.clone.call(this);return k._hash=this._hash.clone(),k}});function _(k,S,E){return k^S^E}function x(k,S,E){return k&S|~k&E}function b(k,S,E){return(k|~S)^E}function v(k,S,E){return k&E|S&~E}function T(k,S,E){return k^(S|~E)}function D(k,S){return k<<S|k>>>32-S}s.RIPEMD160=o._createHelper(y),s.HmacRIPEMD160=o._createHmacHelper(y)}(),r.RIPEMD160})}(Gm)),Gm.exports}var Wm={exports:{}},d_;function sx(){return d_||(d_=1,function(t,e){(function(r,n){t.exports=n(tr())})(jt,function(r){(function(){var n=r,s=n.lib,i=s.Base,a=n.enc,o=a.Utf8,l=n.algo;l.HMAC=i.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=o.parse(u));var f=c.blockSize,h=f*4;u.sigBytes>h&&(u=c.finalize(u)),u.clamp();for(var p=this._oKey=u.clone(),g=this._iKey=u.clone(),y=p.words,_=g.words,x=0;x<f;x++)y[x]^=1549556828,_[x]^=909522486;p.sigBytes=g.sigBytes=h,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,f=u.finalize(c);u.reset();var h=u.finalize(this._oKey.clone().concat(f));return h}})})()})}(Wm)),Wm.exports}var zm={exports:{}},f_;function QU(){return f_||(f_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),nx(),sx())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.SHA256,c=o.HMAC,u=o.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,h){for(var p=this.cfg,g=c.create(p.hasher,f),y=a.create(),_=a.create([1]),x=y.words,b=_.words,v=p.keySize,T=p.iterations;x.length<v;){var D=g.update(h).finalize(_);g.reset();for(var k=D.words,S=k.length,E=D,m=1;m<T;m++){E=g.finalize(E),g.reset();for(var A=E.words,I=0;I<S;I++)k[I]^=A[I]}y.concat(D),b[0]++}return y.sigBytes=v*4,y}});n.PBKDF2=function(f,h,p){return u.create(p).compute(f,h)}}(),r.PBKDF2})}(zm)),zm.exports}var Km={exports:{}},h_;function bo(){return h_||(h_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),_4(),sx())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.MD5,c=o.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,f){for(var h,p=this.cfg,g=p.hasher.create(),y=a.create(),_=y.words,x=p.keySize,b=p.iterations;_.length<x;){h&&g.update(h),h=g.update(u).finalize(f),g.reset();for(var v=1;v<b;v++)h=g.finalize(h),g.reset();y.concat(h)}return y.sigBytes=x*4,y}});n.EvpKDF=function(u,f,h){return c.create(h).compute(u,f)}}(),r.EvpKDF})}(Km)),Km.exports}var qm={exports:{}},p_;function Sn(){return p_||(p_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bo())})(jt,function(r){r.lib.Cipher||function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=i.BufferedBlockAlgorithm,c=s.enc;c.Utf8;var u=c.Base64,f=s.algo,h=f.EvpKDF,p=i.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(A,I){return this.create(this._ENC_XFORM_MODE,A,I)},createDecryptor:function(A,I){return this.create(this._DEC_XFORM_MODE,A,I)},init:function(A,I,C){this.cfg=this.cfg.extend(C),this._xformMode=A,this._key=I,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var I=this._doFinalize();return I},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function A(I){return typeof I=="string"?m:k}return function(I){return{encrypt:function(C,F,W){return A(F).encrypt(I,C,F,W)},decrypt:function(C,F,W){return A(F).decrypt(I,C,F,W)}}}}()});i.StreamCipher=p.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1});var g=s.mode={},y=i.BlockCipherMode=a.extend({createEncryptor:function(A,I){return this.Encryptor.create(A,I)},createDecryptor:function(A,I){return this.Decryptor.create(A,I)},init:function(A,I){this._cipher=A,this._iv=I}}),_=g.CBC=function(){var A=y.extend();A.Encryptor=A.extend({processBlock:function(C,F){var W=this._cipher,P=W.blockSize;I.call(this,C,F,P),W.encryptBlock(C,F),this._prevBlock=C.slice(F,F+P)}}),A.Decryptor=A.extend({processBlock:function(C,F){var W=this._cipher,P=W.blockSize,R=C.slice(F,F+P);W.decryptBlock(C,F),I.call(this,C,F,P),this._prevBlock=R}});function I(C,F,W){var P,R=this._iv;R?(P=R,this._iv=n):P=this._prevBlock;for(var N=0;N<W;N++)C[F+N]^=P[N]}return A}(),x=s.pad={},b=x.Pkcs7={pad:function(A,I){for(var C=I*4,F=C-A.sigBytes%C,W=F<<24|F<<16|F<<8|F,P=[],R=0;R<F;R+=4)P.push(W);var N=o.create(P,F);A.concat(N)},unpad:function(A){var I=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=I}};i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:_,padding:b}),reset:function(){var A;p.reset.call(this);var I=this.cfg,C=I.iv,F=I.mode;this._xformMode==this._ENC_XFORM_MODE?A=F.createEncryptor:(A=F.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==A?this._mode.init(this,C&&C.words):(this._mode=A.call(F,this,C&&C.words),this._mode.__creator=A)},_doProcessBlock:function(A,I){this._mode.processBlock(A,I)},_doFinalize:function(){var A,I=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(I.pad(this._data,this.blockSize),A=this._process(!0)):(A=this._process(!0),I.unpad(A)),A},blockSize:128/32});var v=i.CipherParams=a.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),T=s.format={},D=T.OpenSSL={stringify:function(A){var I,C=A.ciphertext,F=A.salt;return F?I=o.create([1398893684,1701076831]).concat(F).concat(C):I=C,I.toString(u)},parse:function(A){var I,C=u.parse(A),F=C.words;return F[0]==1398893684&&F[1]==1701076831&&(I=o.create(F.slice(2,4)),F.splice(0,4),C.sigBytes-=16),v.create({ciphertext:C,salt:I})}},k=i.SerializableCipher=a.extend({cfg:a.extend({format:D}),encrypt:function(A,I,C,F){F=this.cfg.extend(F);var W=A.createEncryptor(C,F),P=W.finalize(I),R=W.cfg;return v.create({ciphertext:P,key:C,iv:R.iv,algorithm:A,mode:R.mode,padding:R.padding,blockSize:A.blockSize,formatter:F.format})},decrypt:function(A,I,C,F){F=this.cfg.extend(F),I=this._parse(I,F.format);var W=A.createDecryptor(C,F).finalize(I.ciphertext);return W},_parse:function(A,I){return typeof A=="string"?I.parse(A,this):A}}),S=s.kdf={},E=S.OpenSSL={execute:function(A,I,C,F,W){if(F||(F=o.random(64/8)),W)var P=h.create({keySize:I+C,hasher:W}).compute(A,F);else var P=h.create({keySize:I+C}).compute(A,F);var R=o.create(P.words.slice(I),C*4);return P.sigBytes=I*4,v.create({key:P,iv:R,salt:F})}},m=i.PasswordBasedCipher=k.extend({cfg:k.cfg.extend({kdf:E}),encrypt:function(A,I,C,F){F=this.cfg.extend(F);var W=F.kdf.execute(C,A.keySize,A.ivSize,F.salt,F.hasher);F.iv=W.iv;var P=k.encrypt.call(this,A,I,W.key,F);return P.mixIn(W),P},decrypt:function(A,I,C,F){F=this.cfg.extend(F),I=this._parse(I,F.format);var W=F.kdf.execute(C,A.keySize,A.ivSize,I.salt,F.hasher);F.iv=W.iv;var P=k.decrypt.call(this,A,I,W.key,F);return P}})}()})}(qm)),qm.exports}var Xm={exports:{}},m_;function JU(){return m_||(m_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.mode.CFB=function(){var n=r.lib.BlockCipherMode.extend();n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize;s.call(this,i,a,l,o),this._prevBlock=i.slice(a,a+l)}}),n.Decryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=i.slice(a,a+l);s.call(this,i,a,l,o),this._prevBlock=c}});function s(i,a,o,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var f=0;f<o;f++)i[a+f]^=c[f]}return n}(),r.mode.CFB})}(Xm)),Xm.exports}var Ym={exports:{}},g_;function ZU(){return g_||(g_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.mode.CTR=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var f=u.slice(0);o.encryptBlock(f,0),u[l-1]=u[l-1]+1|0;for(var h=0;h<l;h++)i[a+h]^=f[h]}});return n.Decryptor=s,n}(),r.mode.CTR})}(Ym)),Ym.exports}var Qm={exports:{}},v_;function e$(){return v_||(v_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return r.mode.CTRGladman=function(){var n=r.lib.BlockCipherMode.extend();function s(o){if((o>>24&255)===255){var l=o>>16&255,c=o>>8&255,u=o&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,o=0,o+=l<<16,o+=c<<8,o+=u}else o+=1<<24;return o}function i(o){return(o[0]=s(o[0]))===0&&(o[1]=s(o[1])),o}var a=n.Encryptor=n.extend({processBlock:function(o,l){var c=this._cipher,u=c.blockSize,f=this._iv,h=this._counter;f&&(h=this._counter=f.slice(0),this._iv=void 0),i(h);var p=h.slice(0);c.encryptBlock(p,0);for(var g=0;g<u;g++)o[l+g]^=p[g]}});return n.Decryptor=a,n}(),r.mode.CTRGladman})}(Qm)),Qm.exports}var Jm={exports:{}},y_;function t$(){return y_||(y_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.mode.OFB=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var f=0;f<l;f++)i[a+f]^=u[f]}});return n.Decryptor=s,n}(),r.mode.OFB})}(Jm)),Jm.exports}var Zm={exports:{}},x_;function r$(){return x_||(x_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.mode.ECB=function(){var n=r.lib.BlockCipherMode.extend();return n.Encryptor=n.extend({processBlock:function(s,i){this._cipher.encryptBlock(s,i)}}),n.Decryptor=n.extend({processBlock:function(s,i){this._cipher.decryptBlock(s,i)}}),n}(),r.mode.ECB})}(Zm)),Zm.exports}var eg={exports:{}},E_;function n$(){return E_||(E_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.pad.AnsiX923={pad:function(n,s){var i=n.sigBytes,a=s*4,o=a-i%a,l=i+o-1;n.clamp(),n.words[l>>>2]|=o<<24-l%4*8,n.sigBytes+=o},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Ansix923})}(eg)),eg.exports}var tg={exports:{}},b_;function s$(){return b_||(b_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.pad.Iso10126={pad:function(n,s){var i=s*4,a=i-n.sigBytes%i;n.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Iso10126})}(tg)),tg.exports}var rg={exports:{}},__;function a$(){return __||(__=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.pad.Iso97971={pad:function(n,s){n.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(n,s)},unpad:function(n){r.pad.ZeroPadding.unpad(n),n.sigBytes--}},r.pad.Iso97971})}(rg)),rg.exports}var ng={exports:{}},S_;function i$(){return S_||(S_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.pad.ZeroPadding={pad:function(n,s){var i=s*4;n.clamp(),n.sigBytes+=i-(n.sigBytes%i||i)},unpad:function(n){for(var s=n.words,i=n.sigBytes-1,i=n.sigBytes-1;i>=0;i--)if(s[i>>>2]>>>24-i%4*8&255){n.sigBytes=i+1;break}}},r.pad.ZeroPadding})}(ng)),ng.exports}var sg={exports:{}},A_;function o$(){return A_||(A_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}(sg)),sg.exports}var ag={exports:{}},T_;function l$(){return T_||(T_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Sn())})(jt,function(r){return function(n){var s=r,i=s.lib,a=i.CipherParams,o=s.enc,l=o.Hex,c=s.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var f=l.parse(u);return a.create({ciphertext:f})}}}(),r.format.Hex})}(ag)),ag.exports}var ig={exports:{}},w_;function c$(){return w_||(w_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),bo(),Sn())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo,o=[],l=[],c=[],u=[],f=[],h=[],p=[],g=[],y=[],_=[];(function(){for(var v=[],T=0;T<256;T++)T<128?v[T]=T<<1:v[T]=T<<1^283;for(var D=0,k=0,T=0;T<256;T++){var S=k^k<<1^k<<2^k<<3^k<<4;S=S>>>8^S&255^99,o[D]=S,l[S]=D;var E=v[D],m=v[E],A=v[m],I=v[S]*257^S*16843008;c[D]=I<<24|I>>>8,u[D]=I<<16|I>>>16,f[D]=I<<8|I>>>24,h[D]=I;var I=A*16843009^m*65537^E*257^D*16843008;p[S]=I<<24|I>>>8,g[S]=I<<16|I>>>16,y[S]=I<<8|I>>>24,_[S]=I,D?(D=E^v[v[v[A^E]]],k^=v[v[k]]):D=k=1}})();var x=[0,1,2,4,8,16,32,64,128,27,54],b=a.AES=i.extend({_doReset:function(){var v;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var T=this._keyPriorReset=this._key,D=T.words,k=T.sigBytes/4,S=this._nRounds=k+6,E=(S+1)*4,m=this._keySchedule=[],A=0;A<E;A++)A<k?m[A]=D[A]:(v=m[A-1],A%k?k>6&&A%k==4&&(v=o[v>>>24]<<24|o[v>>>16&255]<<16|o[v>>>8&255]<<8|o[v&255]):(v=v<<8|v>>>24,v=o[v>>>24]<<24|o[v>>>16&255]<<16|o[v>>>8&255]<<8|o[v&255],v^=x[A/k|0]<<24),m[A]=m[A-k]^v);for(var I=this._invKeySchedule=[],C=0;C<E;C++){var A=E-C;if(C%4)var v=m[A];else var v=m[A-4];C<4||A<=4?I[C]=v:I[C]=p[o[v>>>24]]^g[o[v>>>16&255]]^y[o[v>>>8&255]]^_[o[v&255]]}}},encryptBlock:function(v,T){this._doCryptBlock(v,T,this._keySchedule,c,u,f,h,o)},decryptBlock:function(v,T){var D=v[T+1];v[T+1]=v[T+3],v[T+3]=D,this._doCryptBlock(v,T,this._invKeySchedule,p,g,y,_,l);var D=v[T+1];v[T+1]=v[T+3],v[T+3]=D},_doCryptBlock:function(v,T,D,k,S,E,m,A){for(var I=this._nRounds,C=v[T]^D[0],F=v[T+1]^D[1],W=v[T+2]^D[2],P=v[T+3]^D[3],R=4,N=1;N<I;N++){var L=k[C>>>24]^S[F>>>16&255]^E[W>>>8&255]^m[P&255]^D[R++],O=k[F>>>24]^S[W>>>16&255]^E[P>>>8&255]^m[C&255]^D[R++],V=k[W>>>24]^S[P>>>16&255]^E[C>>>8&255]^m[F&255]^D[R++],z=k[P>>>24]^S[C>>>16&255]^E[F>>>8&255]^m[W&255]^D[R++];C=L,F=O,W=V,P=z}var L=(A[C>>>24]<<24|A[F>>>16&255]<<16|A[W>>>8&255]<<8|A[P&255])^D[R++],O=(A[F>>>24]<<24|A[W>>>16&255]<<16|A[P>>>8&255]<<8|A[C&255])^D[R++],V=(A[W>>>24]<<24|A[P>>>16&255]<<16|A[C>>>8&255]<<8|A[F&255])^D[R++],z=(A[P>>>24]<<24|A[C>>>16&255]<<16|A[F>>>8&255]<<8|A[W&255])^D[R++];v[T]=L,v[T+1]=O,v[T+2]=V,v[T+3]=z},keySize:256/32});n.AES=i._createHelper(b)}(),r.AES})}(ig)),ig.exports}var og={exports:{}},C_;function u$(){return C_||(C_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),bo(),Sn())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.BlockCipher,o=n.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=o.DES=a.extend({_doReset:function(){for(var x=this._key,b=x.words,v=[],T=0;T<56;T++){var D=l[T]-1;v[T]=b[D>>>5]>>>31-D%32&1}for(var k=this._subKeys=[],S=0;S<16;S++){for(var E=k[S]=[],m=u[S],T=0;T<24;T++)E[T/6|0]|=v[(c[T]-1+m)%28]<<31-T%6,E[4+(T/6|0)]|=v[28+(c[T+24]-1+m)%28]<<31-T%6;E[0]=E[0]<<1|E[0]>>>31;for(var T=1;T<7;T++)E[T]=E[T]>>>(T-1)*4+3;E[7]=E[7]<<5|E[7]>>>27}for(var A=this._invSubKeys=[],T=0;T<16;T++)A[T]=k[15-T]},encryptBlock:function(x,b){this._doCryptBlock(x,b,this._subKeys)},decryptBlock:function(x,b){this._doCryptBlock(x,b,this._invSubKeys)},_doCryptBlock:function(x,b,v){this._lBlock=x[b],this._rBlock=x[b+1],g.call(this,4,252645135),g.call(this,16,65535),y.call(this,2,858993459),y.call(this,8,16711935),g.call(this,1,1431655765);for(var T=0;T<16;T++){for(var D=v[T],k=this._lBlock,S=this._rBlock,E=0,m=0;m<8;m++)E|=f[m][((S^D[m])&h[m])>>>0];this._lBlock=S,this._rBlock=k^E}var A=this._lBlock;this._lBlock=this._rBlock,this._rBlock=A,g.call(this,1,1431655765),y.call(this,8,16711935),y.call(this,2,858993459),g.call(this,16,65535),g.call(this,4,252645135),x[b]=this._lBlock,x[b+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function g(x,b){var v=(this._lBlock>>>x^this._rBlock)&b;this._rBlock^=v,this._lBlock^=v<<x}function y(x,b){var v=(this._rBlock>>>x^this._lBlock)&b;this._lBlock^=v,this._rBlock^=v<<x}n.DES=a._createHelper(p);var _=o.TripleDES=a.extend({_doReset:function(){var x=this._key,b=x.words;if(b.length!==2&&b.length!==4&&b.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var v=b.slice(0,2),T=b.length<4?b.slice(0,2):b.slice(2,4),D=b.length<6?b.slice(0,2):b.slice(4,6);this._des1=p.createEncryptor(i.create(v)),this._des2=p.createEncryptor(i.create(T)),this._des3=p.createEncryptor(i.create(D))},encryptBlock:function(x,b){this._des1.encryptBlock(x,b),this._des2.decryptBlock(x,b),this._des3.encryptBlock(x,b)},decryptBlock:function(x,b){this._des3.decryptBlock(x,b),this._des2.encryptBlock(x,b),this._des1.decryptBlock(x,b)},keySize:192/32,ivSize:64/32,blockSize:64/32});n.TripleDES=a._createHelper(_)}(),r.TripleDES})}(og)),og.exports}var lg={exports:{}},I_;function d$(){return I_||(I_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),bo(),Sn())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=a.RC4=i.extend({_doReset:function(){for(var u=this._key,f=u.words,h=u.sigBytes,p=this._S=[],g=0;g<256;g++)p[g]=g;for(var g=0,y=0;g<256;g++){var _=g%h,x=f[_>>>2]>>>24-_%4*8&255;y=(y+p[g]+x)%256;var b=p[g];p[g]=p[y],p[y]=b}this._i=this._j=0},_doProcessBlock:function(u,f){u[f]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,f=this._i,h=this._j,p=0,g=0;g<4;g++){f=(f+1)%256,h=(h+u[f])%256;var y=u[f];u[f]=u[h],u[h]=y,p|=u[(u[f]+u[h])%256]<<24-g*8}return this._i=f,this._j=h,p}n.RC4=i._createHelper(o);var c=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});n.RC4Drop=i._createHelper(c)}(),r.RC4})}(lg)),lg.exports}var cg={exports:{}},k_;function f$(){return k_||(k_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),bo(),Sn())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.Rabbit=i.extend({_doReset:function(){for(var h=this._key.words,p=this.cfg.iv,g=0;g<4;g++)h[g]=(h[g]<<8|h[g]>>>24)&16711935|(h[g]<<24|h[g]>>>8)&4278255360;var y=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],_=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var g=0;g<4;g++)f.call(this);for(var g=0;g<8;g++)_[g]^=y[g+4&7];if(p){var x=p.words,b=x[0],v=x[1],T=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,D=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,k=T>>>16|D&4294901760,S=D<<16|T&65535;_[0]^=T,_[1]^=k,_[2]^=D,_[3]^=S,_[4]^=T,_[5]^=k,_[6]^=D,_[7]^=S;for(var g=0;g<4;g++)f.call(this)}},_doProcessBlock:function(h,p){var g=this._X;f.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var y=0;y<4;y++)o[y]=(o[y]<<8|o[y]>>>24)&16711935|(o[y]<<24|o[y]>>>8)&4278255360,h[p+y]^=o[y]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,g=0;g<8;g++)l[g]=p[g];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var g=0;g<8;g++){var y=h[g]+p[g],_=y&65535,x=y>>>16,b=((_*_>>>17)+_*x>>>15)+x*x,v=((y&4294901760)*y|0)+((y&65535)*y|0);c[g]=b^v}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.Rabbit=i._createHelper(u)}(),r.Rabbit})}(cg)),cg.exports}var ug={exports:{}},D_;function h$(){return D_||(D_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),bo(),Sn())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.RabbitLegacy=i.extend({_doReset:function(){var h=this._key.words,p=this.cfg.iv,g=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],y=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var _=0;_<4;_++)f.call(this);for(var _=0;_<8;_++)y[_]^=g[_+4&7];if(p){var x=p.words,b=x[0],v=x[1],T=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,D=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,k=T>>>16|D&4294901760,S=D<<16|T&65535;y[0]^=T,y[1]^=k,y[2]^=D,y[3]^=S,y[4]^=T,y[5]^=k,y[6]^=D,y[7]^=S;for(var _=0;_<4;_++)f.call(this)}},_doProcessBlock:function(h,p){var g=this._X;f.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var y=0;y<4;y++)o[y]=(o[y]<<8|o[y]>>>24)&16711935|(o[y]<<24|o[y]>>>8)&4278255360,h[p+y]^=o[y]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,g=0;g<8;g++)l[g]=p[g];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var g=0;g<8;g++){var y=h[g]+p[g],_=y&65535,x=y>>>16,b=((_*_>>>17)+_*x>>>15)+x*x,v=((y&4294901760)*y|0)+((y&65535)*y|0);c[g]=b^v}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.RabbitLegacy=i._createHelper(u)}(),r.RabbitLegacy})}(ug)),ug.exports}var dg={exports:{}},P_;function p$(){return P_||(P_=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),bo(),Sn())})(jt,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo;const o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function f(_,x){let b=x>>24&255,v=x>>16&255,T=x>>8&255,D=x&255,k=_.sbox[0][b]+_.sbox[1][v];return k=k^_.sbox[2][T],k=k+_.sbox[3][D],k}function h(_,x,b){let v=x,T=b,D;for(let k=0;k<o;++k)v=v^_.pbox[k],T=f(_,v)^T,D=v,v=T,T=D;return D=v,v=T,T=D,T=T^_.pbox[o],v=v^_.pbox[o+1],{left:v,right:T}}function p(_,x,b){let v=x,T=b,D;for(let k=o+1;k>1;--k)v=v^_.pbox[k],T=f(_,v)^T,D=v,v=T,T=D;return D=v,v=T,T=D,T=T^_.pbox[1],v=v^_.pbox[0],{left:v,right:T}}function g(_,x,b){for(let S=0;S<4;S++){_.sbox[S]=[];for(let E=0;E<256;E++)_.sbox[S][E]=c[S][E]}let v=0;for(let S=0;S<o+2;S++)_.pbox[S]=l[S]^x[v],v++,v>=b&&(v=0);let T=0,D=0,k=0;for(let S=0;S<o+2;S+=2)k=h(_,T,D),T=k.left,D=k.right,_.pbox[S]=T,_.pbox[S+1]=D;for(let S=0;S<4;S++)for(let E=0;E<256;E+=2)k=h(_,T,D),T=k.left,D=k.right,_.sbox[S][E]=T,_.sbox[S][E+1]=D;return!0}var y=a.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var _=this._keyPriorReset=this._key,x=_.words,b=_.sigBytes/4;g(u,x,b)}},encryptBlock:function(_,x){var b=h(u,_[x],_[x+1]);_[x]=b.left,_[x+1]=b.right},decryptBlock:function(_,x){var b=p(u,_[x],_[x+1]);_[x]=b.left,_[x+1]=b.right},blockSize:64/32,keySize:128/32,ivSize:64/32});n.Blowfish=i._createHelper(y)}(),r.Blowfish})}(dg)),dg.exports}(function(t,e){(function(r,n,s){t.exports=n(tr(),$p(),GU(),WU(),yl(),zU(),xl(),_4(),nx(),KU(),S4(),qU(),XU(),YU(),sx(),QU(),bo(),Sn(),JU(),ZU(),e$(),t$(),r$(),n$(),s$(),a$(),i$(),o$(),l$(),c$(),u$(),d$(),f$(),h$(),p$())})(jt,function(r){return r})})(b4);var m$=b4.exports;const qi=E4(m$);class g${constructor(){this.encryptionKey="your-dev-key-here"}async encryptAndUploadPdf(e,r){try{if(console.log(" Starting PDF encryption for student:",r),console.log(" File details:",{name:e.name,size:e.size,type:e.type}),(!this.encryptionKey||this.encryptionKey==="your-dev-key-here")&&console.warn(" Using default encryption key - set VITE_PDF_ENCRYPTION_KEY in production"),!bt.currentUser)throw new Error("User not authenticated");if(console.log(" Current user:",bt.currentUser.uid),r){console.log(" Checking student access for:",r);try{if(!(await er(et(Xe,"students",r))).exists())throw new Error(`Student ${r} not found`);console.log(" Student document exists")}catch(l){throw console.error(" Student access check failed:",l),new Error(`Student access check failed: ${l.message}`)}}console.log(" Reading file as ArrayBuffer...");const n=await e.arrayBuffer();console.log(" ArrayBuffer read, size:",n.byteLength),console.log(" Converting to Base64...");const s=btoa(new Uint8Array(n).reduce((l,c)=>l+String.fromCharCode(c),""));console.log(" Base64 conversion complete, length:",s.length),console.log(" Encrypting content...");const i=qi.AES.encrypt(s,this.encryptionKey).toString();console.log(" Encryption complete, length:",i.length);const a=`${UU()}.enc`;console.log(" Generated filename:",a),console.log(" Uploading to storage...");const o=bh(Dc,`students/${r}/${a}`);return console.log(" Storage path:",`students/${r}/${a}`),await MI(o,i),console.log(" Upload to storage successful"),console.log(" Storing metadata in Firestore..."),await $t(et(Xe,"pdfMetadata",a),{originalName:e.name,studentId:r,uploadedBy:bt.currentUser.uid,uploadedAt:Pn(),accessCount:0,lastAccessed:null,encryptionVersion:"1.0",fileSize:e.size,mimeType:e.type}),console.log(" Metadata stored successfully"),a}catch(n){throw console.error(" PDF encryption failed:",n),console.error(" Error details:",{message:n.message,code:n.code,stack:n.stack}),new Error(`Failed to securely store PDF: ${n.message}`)}}async downloadAndDecryptPdf(e,r){try{if(console.log(" Starting secure PDF download process..."),console.log(" Verifying user access permissions..."),!await this.verifyAccess(r))throw new Error("Access denied");console.log(" Access permissions verified"),console.log(" Getting authentication token...");const{auth:s}=await ua(async()=>{const{auth:h}=await Promise.resolve().then(()=>GI);return{auth:h}},void 0),i=await s.currentUser.getIdToken(),a=`https://downloadstudentfile-zxuytv4xtq-uc.a.run.app/downloadStudentFile?studentId=${r}&fileName=${e}`;console.log(" Downloading encrypted file via secure streaming...");const o=await fetch(a,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error(`Failed to fetch file: ${o.status} ${o.statusText}`);const l=await o.text();console.log(" Downloaded encrypted content, size:",l.length,"characters"),console.log(" Decrypting PDF content...");const c=qi.AES.decrypt(l,this.encryptionKey).toString(qi.enc.Utf8);console.log(" Converting to PDF format...");const u=atob(c),f=new Blob([new Uint8Array(u.split("").map(h=>h.charCodeAt(0)))],{type:"application/pdf"});return console.log(" PDF ready for viewing, size:",f.size,"bytes"),f}catch(n){throw console.error(" Error in downloadAndDecryptPdf:",n),new Error(`PDF download failed: ${n.message}`)}}async verifyAccess(e){var r,n,s,i,a,o,l,c,u,f;try{const h=bt.currentUser;if(!h)return!1;const g=(await er(et(Xe,"users",h.uid))).data();if(["admin","school_admin","administrator","sped_chair","admin_504"].includes(g.role)||["staff_view","staff_edit"].includes(g.role))return!0;if(g.role==="case_manager")return((s=(n=(r=(await er(et(Xe,"students",e))).data())==null?void 0:r.app)==null?void 0:n.studentData)==null?void 0:s.caseManagerId)===h.uid;if(g.role==="teacher"){const _=((o=(a=(i=(await er(et(Xe,"students",e))).data())==null?void 0:i.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(_).includes(h.uid)}return g.role==="service_provider"?(((c=(l=(await er(et(Xe,"students",e))).data())==null?void 0:l.app)==null?void 0:c.staffIds)||[]).includes(h.uid):g.role==="paraeducator"?(((f=(u=(await er(et(Xe,"students",e))).data())==null?void 0:u.app)==null?void 0:f.staffIds)||[]).includes(h.uid):!1}catch(h){return console.error("Access verification failed:",h),!1}}async logAccess(e,r){try{await $t(et(Xe,"pdfAccessLogs",`${e}_${Date.now()}`),{fileId:e,studentId:r,userId:bt.currentUser.uid,userEmail:bt.currentUser.email,accessTime:Pn(),userAgent:navigator.userAgent,accessType:"download"})}catch(n){console.error("Failed to log access:",n)}}async updateAccessMetadata(e){try{const r=et(Xe,"pdfMetadata",e),n=await er(r);n.exists()&&await $t(r,{...n.data(),accessCount:(n.data().accessCount||0)+1,lastAccessed:Pn()},{merge:!0})}catch(r){console.error("Failed to update access metadata:",r)}}async getFileAccessHistory(e){try{const r=lr(At(Xe,"pdfAccessLogs"),Ur("fileId","==",e),vn("accessTime","desc"));return(await Gt(r)).docs.map(s=>s.data())}catch(r){return console.error("Failed to fetch access history:",r),[]}}}const N0=new g$;function ax(){const t=se(!1),e=se(!1),r=se(null);return{uploadPdf:async(a,o)=>{t.value=!0,r.value=null;try{if(a.type!=="application/pdf")throw new Error("Only PDF files are allowed");if(a.size>10*1024*1024)throw new Error("File size must be less than 10MB");return await N0.encryptAndUploadPdf(a,o)}catch(l){throw r.value=l.message,l}finally{t.value=!1}},downloadPdf:async(a,o,l)=>{e.value=!0,r.value=null;try{const c=await N0.downloadAndDecryptPdf(a,o),u=window.URL.createObjectURL(c),f=window.open(u,"_blank","noopener,noreferrer");setTimeout(()=>{window.URL.revokeObjectURL(u)},5e3)}catch(c){throw r.value=c.message,c}finally{e.value=!1}},getAccessHistory:async a=>{try{return await N0.getFileAccessHistory(a)}catch(o){return r.value=o.message,[]}},isUploading:t,isDownloading:e,error:r}}const v$={class:"documents-column"},y$={class:"docs-item"},x$={key:0,class:"loading-spinner"},E$={key:0,class:"loading-spinner"},b$=["onClick"],_$={key:0,class:"loading-spinner"},S$={__name:"StudentDocsCell",props:{student:{type:Object,required:!0},getDocumentUrl:{type:Function,required:!0},getAdditionalDocuments:{type:Function,required:!0}},setup(t){const e=t,{downloadPdf:r}=ax(),n=se({ataglance:!1,bip:!1}),s=async(a,o)=>{var l,c,u,f;try{if(!a){alert("File not found.");return}n.value[o]=!0;const h=((c=(l=e.student.app)==null?void 0:l.documents)==null?void 0:c.bipFileName)||((f=(u=e.student.app)==null?void 0:u.documents)==null?void 0:f.ataglanceFileName)||"document.pdf";await r(a,e.student.id,h)}catch(h){console.error("Error opening secure file:",h),alert("Error opening file. Please try again.")}finally{n.value[o]=!1}},i=async a=>{try{if(!a.pdfUrl){alert("File not found.");return}n.value[a.id]=!0,await r(a.pdfUrl,e.student.id,a.fileName)}catch(o){console.error("Error opening additional document:",o),alert("Error opening file. Please try again.")}finally{n.value[a.id]=!1}};return(a,o)=>(M(),B("td",v$,[d("div",y$,[t.getDocumentUrl(t.student,"ataglancePdfUrl")?(M(),B("a",{key:0,href:"#",onClick:o[0]||(o[0]=Yr(l=>s(t.getDocumentUrl(t.student,"ataglancePdfUrl"),"ataglance"),["prevent"])),class:Ye(["doc-link",{loading:n.value.ataglance}])},[n.value.ataglance?(M(),B("div",x$,[Re(q(pc),{size:14,class:"spin"})])):(M(),Qt(q(qu),{key:1,size:16,class:"doc-icon"})),d("span",null,Q(n.value.ataglance?"Loading...":"At-A-Glance"),1)],2)):ve("",!0),t.getDocumentUrl(t.student,"bipPdfUrl")?(M(),B("a",{key:1,href:"#",onClick:o[1]||(o[1]=Yr(l=>s(t.getDocumentUrl(t.student,"bipPdfUrl"),"bip"),["prevent"])),class:Ye(["doc-link",{loading:n.value.bip}])},[n.value.bip?(M(),B("div",E$,[Re(q(pc),{size:14,class:"spin"})])):(M(),Qt(q(qu),{key:1,size:16,class:"doc-icon"})),d("span",null,Q(n.value.bip?"Loading...":"BIP"),1)],2)):ve("",!0),(M(!0),B(ke,null,He(t.getAdditionalDocuments(t.student),l=>(M(),B("a",{key:l.id,href:"#",onClick:Yr(c=>i(l),["prevent"]),class:Ye(["doc-link",{loading:n.value[l.id]}])},[n.value[l.id]?(M(),B("div",_$,[Re(q(pc),{size:14,class:"spin"})])):(M(),Qt(q(qu),{key:1,size:16,class:"doc-icon"})),d("span",null,Q(n.value[l.id]?"Loading...":l.title),1)],10,b$))),128)),!t.getDocumentUrl(t.student,"ataglancePdfUrl")&&!t.getDocumentUrl(t.student,"bipPdfUrl")&&t.getAdditionalDocuments(t.student).length===0?(M(),B(ke,{key:2},[we("")],64)):ve("",!0)])]))}},A$=St(S$,[["__scopeId","data-v-d8e8016d"]]),T$={class:"actions-column"},w$={class:"actions-content"},C$={class:"action-buttons"},I$=["title"],k$={__name:"StudentActionsCell",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!1},studentData:{type:Object,required:!1},getUserName:{type:Function,required:!0},formatDate:{type:Function,required:!0}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,n=_e(()=>{var o;return(o=r.student)!=null&&o.updatedBy?r.getUserName(r.student.updatedBy):null}),s=_e(()=>{var o;if(!((o=r.student)!=null&&o.updatedAt))return"";try{let l="";r.student.updatedAt.seconds?l=new Date(r.student.updatedAt.seconds*1e3).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0}):l=new Date(r.student.updatedAt).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0});const c=n.value?` by ${n.value}`:"";return`Last Updated: ${l}${c}`}catch(l){console.warn("Error formatting date in tooltip:",l);const c=new Date(r.student.updatedAt.seconds*1e3),u=n.value?` by ${n.value}`:"";return`Last Updated: ${c.toLocaleDateString()}${u}`}}),i=_e(()=>{var u,f,h,p,g;if(!((u=r.currentUser)!=null&&u.role)||!r.student)return!1;const o=r.currentUser.role,l=r.currentUser.uid;return o==="paraeducator"||o==="teacher"?!1:o==="case_manager"?((h=(f=r.student.app)==null?void 0:f.studentData)==null?void 0:h.caseManagerId)===l:o==="service_provider"?(g=(p=r.student.app)==null?void 0:p.staffIds)==null?void 0:g.includes(l):["admin","school_admin","staff_edit","admin_504","sped_chair"].includes(o)}),a=_e(()=>{var o;return!((o=r.currentUser)!=null&&o.role)||!r.student||!r.studentData?!1:Cn.canSendFeedback(r.currentUser.uid,r.currentUser.role,r.student,r.studentData)});return(o,l)=>{var c;return M(),B("td",T$,[d("div",w$,[d("div",C$,[i.value?(M(),B("button",{key:0,class:"edit-btn",onClick:l[0]||(l[0]=u=>o.$emit("edit",t.student.id)),title:"Edit Student"},[Re(q(Zy),{size:16})])):ve("",!0),d("button",{class:"email-btn",onClick:l[1]||(l[1]=u=>o.$emit("email",t.student.id)),title:"Email Student"},[Re(q(hB),{size:16})]),a.value?(M(),B("button",{key:1,class:"teacher-feedback-btn",onClick:l[2]||(l[2]=u=>o.$emit("teacher-feedback",t.student.id)),title:"Send Teacher Feedback Form"},[Re(q(o4),{size:16})])):ve("",!0)]),(c=t.student)!=null&&c.updatedAt?(M(),B("div",{key:0,class:"action-updated-date",title:s.value},Q(t.student.updatedAt.seconds?new Date(t.student.updatedAt.seconds*1e3).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}):new Date(t.student.updatedAt).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})),9,I$)):ve("",!0)])])}}},D$=St(k$,[["__scopeId","data-v-a703cbf2"]]),P$={class:"schedule-column"},R$={key:0,class:"schedule-list"},F$={class:"period-assignment"},N$={class:"primary-line"},O$={class:"period-label"},M$=["data-tooltip"],L$={key:0,class:"coteaching-info"},B$=["title","data-tooltip"],U$={key:1,class:"no-schedule"},$$={__name:"StudentScheduleCell",props:{student:{type:Object,required:!0},getSchedule:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0},getPeriodLabel:{type:Function,required:!1},getUserTooltip:{type:Function,required:!0}},setup(t){const e=r=>r&&typeof r=="object"&&r.coTeaching&&r.teacherId;return(r,n)=>(M(),B("td",P$,[t.getSchedule(t.student)?(M(),B("div",R$,[d("ul",null,[(M(!0),B(ke,null,He(t.getSchedule(t.student),(s,i)=>(M(),B("li",{key:i,class:"schedule-period"},[d("div",F$,[d("div",N$,[d("span",O$,Q(t.getPeriodLabel?t.getPeriodLabel(i):i)+":",1),d("span",{class:"primary-teacher teacher-name","data-tooltip":t.getUserTooltip(s.teacherId||s),onMouseenter:n[0]||(n[0]=a=>a.target.classList.add("tooltip-active")),onMouseleave:n[1]||(n[1]=a=>a.target.classList.remove("tooltip-active"))},Q(t.getUserInitialLastName(s.teacherId||s)),41,M$)]),e(s)?(M(),B("div",L$,[d("span",{class:"coteaching-indicator teacher-name",title:`Co-teach ${s.coTeaching.subject}`,"data-tooltip":t.getUserTooltip(s.coTeaching.caseManagerId),onMouseenter:n[2]||(n[2]=a=>a.target.classList.add("tooltip-active")),onMouseleave:n[3]||(n[3]=a=>a.target.classList.remove("tooltip-active"))},Q(t.getUserInitialLastName(s.coTeaching.caseManagerId))+" (C"+Q(s.coTeaching.subject.charAt(0))+") ",41,B$)])):ve("",!0)])]))),128))])])):(M(),B("div",U$,""))]))}},V$={class:"service-column"},H$={key:0,class:"services-section"},j$={class:"services-container"},G$={key:1,class:"services-section"},W$={class:"services-container"},z$={key:0,class:"service-provider-item"},K$={key:0,class:"service-provider-item"},q$={key:1,class:"service-provider-item"},X$={key:2,class:"service-provider-item"},Y$={key:3,class:"service-provider-item"},Q$={key:4,class:"service-provider-item"},J$={key:5,class:"service-provider-item"},Z$={key:6,class:"service-provider-item"},eV={key:7,class:"service-provider-item"},tV={key:8,class:"service-provider-item"},rV={key:9,class:"service-provider-item"},nV={key:10,class:"service-provider-item"},sV={key:11,class:"service-provider-item"},aV={key:12,class:"service-provider-item"},iV={key:13,class:"service-provider-item"},oV={__name:"StudentServicesCell",props:{student:{type:Object,required:!0},appSettings:{type:Object,required:!1},getClassServices:{type:Function,required:!0},getOtherServices:{type:Function,required:!0},hasServiceProviders:{type:Function,required:!0},getServiceProviderId:{type:Function,required:!0},getProviderFieldName:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0}},setup(t){return(e,r)=>{var n,s,i,a;return M(),B("td",V$,[t.getClassServices(t.student).length>0||t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(M(),B(ke,{key:0},[t.getClassServices(t.student).length>0?(M(),B("div",H$,[r[0]||(r[0]=d("strong",null,"Class Services:",-1)),d("div",j$,[(M(!0),B(ke,null,He(t.getClassServices(t.student),o=>(M(),B("span",{key:o,class:"service-item"},Q(o.startsWith("Other: ")?o.replace("Other: ",""):o),1))),128))])])):ve("",!0),t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(M(),B("div",G$,[r[1]||(r[1]=d("strong",null,"Related Services:",-1)),d("div",W$,[(M(!0),B(ke,null,He(t.getOtherServices(t.student),o=>(M(),B("span",{key:o,class:"service-item"},Q(o),1))),128)),t.appSettings&&t.appSettings.value&&t.appSettings.value.serviceProviders?(M(),B(ke,{key:0},[we(Q(((s=(n=t.student.app)==null?void 0:n.studentData)==null?void 0:s.firstName)==="Michael"?console.log(" MICHAEL DHH: Using dynamic providers, appSettings.value.serviceProviders:",t.appSettings.value.serviceProviders):"")+" ",1),(M(!0),B(ke,null,He(t.appSettings.value.serviceProviders,o=>{var l,c;return M(),B(ke,{key:o},[we(Q(((c=(l=t.student.app)==null?void 0:l.studentData)==null?void 0:c.firstName)==="Michael"&&o==="DHH"?console.log(" MICHAEL DHH: Processing DHH, getProviderFieldName(DHH):",t.getProviderFieldName("DHH"),"getServiceProviderId result:",t.getServiceProviderId(t.student,t.getProviderFieldName("DHH"))):"")+" ",1),t.getServiceProviderId(t.student,t.getProviderFieldName(o))?(M(),B("span",z$,Q(o)+" ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,t.getProviderFieldName(o))))+") ",1)):ve("",!0)],64)}),128))],64)):(M(),B(ke,{key:1},[we(Q(((a=(i=t.student.app)==null?void 0:i.studentData)==null?void 0:a.firstName)==="Michael"?console.log(" MICHAEL DHH: Using FALLBACK template, appSettings:",t.appSettings):"")+" ",1),t.getServiceProviderId(t.student,"speechId")?(M(),B("span",K$,"SP ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"speechId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"mhId")?(M(),B("span",q$,"MH ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"mhId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"otId")?(M(),B("span",X$,"OT ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"otId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"ptId")?(M(),B("span",Y$,"PT ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"ptId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"scId")?(M(),B("span",Q$,"SC ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"scId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"trId")?(M(),B("span",J$,"TR ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"trId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"dhhId")?(M(),B("span",Z$,"DHH ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"dhhId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"audId")?(M(),B("span",eV,"AUD ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"audId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"viId")?(M(),B("span",tV,"VI ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"viId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"atId")?(M(),B("span",rV,"AT ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"atId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"omId")?(M(),B("span",nV,"O&M ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"omId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"bisId")?(M(),B("span",sV,"BIS ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"bisId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"hnId")?(M(),B("span",aV,"HN ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"hnId")))+")",1)):ve("",!0),t.getServiceProviderId(t.student,"swId")?(M(),B("span",iV,"SW ("+Q(t.getUserInitialLastName(t.getServiceProviderId(t.student,"swId")))+")",1)):ve("",!0)],64))])])):ve("",!0)],64)):(M(),B(ke,{key:1},[we("  ")],64))])}}},lV=["innerHTML"],cV={key:2},R_={__name:"AccommodationsCell",props:{student:{type:Object,required:!0},fieldName:{type:String,required:!0},flagType:{type:String,required:!0},flagText:{type:String,required:!0},flagClass:{type:String,required:!0},getFlagValue:{type:Function,required:!0},formatListFromText:{type:Function,required:!0}},setup(t){return(e,r)=>(M(),B("td",{class:Ye([t.fieldName+"-column","instruction-cell",{"with-flag":t.getFlagValue(t.student,t.flagType)}])},[t.getFlagValue(t.student,t.flagType)?(M(),B("div",{key:0,class:Ye(["flag-overlay",t.flagClass])},Q(t.flagText),3)):ve("",!0),q(at)(t.student,t.fieldName)?(M(),B("div",{key:1,innerHTML:t.formatListFromText(q(at)(t.student,t.fieldName))},null,8,lV)):(M(),B("div",cV,""))],2))}},uV={class:"student-name"},dV={class:"std-info-subheading"},fV=["data-tooltip"],hV={key:0,class:"custom-flags"},pV=["data-tooltip"],mV={key:0,class:"schedule-list"},gV={class:"period-assignment"},vV={class:"primary-line"},yV={class:"period-label"},xV=["data-tooltip"],EV={key:0,class:"coteaching-info"},bV=["title","data-tooltip"],_V={key:1,class:"no-schedule"},SV={key:0,class:"flag-overlay flag-separate-setting"},AV={key:1,class:"bullet-list"},TV=["innerHTML"],wV={key:2},CV={class:"student-info-column"},IV={class:"student-name"},kV=["title"],DV={class:"std-info-subheading"},PV=["data-tooltip"],RV={key:0,class:"custom-flags"},FV=["data-tooltip"],NV={class:"flag-count"},OV={class:"student-dates print"},MV={key:0,class:"direct-assignment-badge"},Yf={__name:"StudentTable",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})},currentUser:{type:Object,default:null},studentData:{type:Object,default:null},testingView:{type:Boolean,default:!1},aideSchedule:{type:Object,default:()=>({})},appSettings:{type:Object,default:null}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,{appSettings:n,getUserName:s,getUserInitialLastName:i,getUserTooltip:a,getCaseManagerTooltip:o,formatDate:l,getMeetingUrgencyClass:c,getReviewUrgencyClass:u,getReevalUrgencyClass:f,getCaseManagerId:h,getFlagValue:p,getDocumentUrl:g,getSchedule:y,getClassServices:_,getOtherServices:x,hasServiceProviders:b,getServiceProviderId:v,getProviderFieldName:T,isDirectAssignment:D,formatListFromText:k,getPeriodLabel:S,getAdditionalDocuments:E}=NU(r),m=A=>A&&typeof A=="object"&&A.coTeaching&&A.teacherId;return(A,I)=>(M(),B("table",{class:Ye(["students-table",{"testing-view":t.testingView}])},[d("thead",null,[d("tr",null,[t.testingView?(M(),B(ke,{key:0},[I[8]||(I[8]=d("th",{class:"print"},"Student Info",-1)),I[9]||(I[9]=d("th",{class:"print"},"Schedule",-1)),I[10]||(I[10]=d("th",{class:"print"},"Assessment Accommodations",-1))],64)):(M(),B(ke,{key:1},[I[11]||(I[11]=d("th",{class:"print student-info-column"},"Student Info",-1)),I[12]||(I[12]=d("th",{class:"print service-column"},"Services",-1)),I[13]||(I[13]=d("th",{class:"print schedule-column"},"Schedule",-1)),I[14]||(I[14]=d("th",{class:"print instruction-column"},"Instruction Accommodations",-1)),I[15]||(I[15]=d("th",{class:"print assessment-column"},"Assessment Accommodations",-1)),I[16]||(I[16]=d("th",{class:"print documents-column"},"Docs",-1)),I[17]||(I[17]=d("th",{class:"print actions-column"},"Actions",-1))],64))])]),d("tbody",null,[(M(!0),B(ke,null,He(t.students,C=>{var F,W,P,R,N,L,O;return M(),B("tr",{key:C.id},[t.testingView?(M(),B(ke,{key:0},[d("td",null,[d("div",uV,[d("strong",null,Q(q(at)(C,"firstName"))+" "+Q(q(at)(C,"lastName")),1)]),d("div",dV,[d("div",null,"Grd: "+Q(q(at)(C,"grade"))+" | Prg: "+Q(q(at)(C,"plan")),1),d("div",null,[I[18]||(I[18]=we("CM: ")),d("span",{class:"case-manager-name","data-tooltip":q(o)(q(h)(C)),onMouseenter:I[0]||(I[0]=V=>V.target.classList.add("tooltip-active")),onMouseleave:I[1]||(I[1]=V=>V.target.classList.remove("tooltip-active"))},Q(q(s)(q(h)(C))),41,fV)]),(((W=(F=C.app)==null?void 0:F.flags)==null?void 0:W.customFlags)||[]).length?(M(),B("div",hV,[(((R=(P=C.app)==null?void 0:P.flags)==null?void 0:R.customFlags)||[]).filter(V=>V.color===A.color).length?(M(),B(ke,{key:0},He(["blue","yellow","red"],V=>{var z,U,G,j;return d("span",{key:V,class:Ye(["flag-chip",V]),"data-tooltip":(((U=(z=C.app)==null?void 0:z.flags)==null?void 0:U.customFlags)||[]).filter(ee=>ee.color===V).map(ee=>` ${ee.text}`).join(`
`)},[I[19]||(I[19]=d("span",{class:"flag-dot"},null,-1)),we(Q((((j=(G=C.app)==null?void 0:G.flags)==null?void 0:j.customFlags)||[]).filter(ee=>ee.color===V).length),1)],10,pV)}),64)):ve("",!0)])):ve("",!0)])]),d("td",null,[q(y)(C)?(M(),B("div",mV,[d("ul",null,[(M(!0),B(ke,null,He(q(y)(C),(V,z)=>(M(),B("li",{key:z,class:"schedule-period"},[d("div",gV,[d("div",vV,[d("span",yV,Q(q(S)?q(S)(z):z)+":",1),d("span",{class:"primary-teacher teacher-name","data-tooltip":q(a)(V.teacherId||V),onMouseenter:I[2]||(I[2]=U=>U.target.classList.add("tooltip-active")),onMouseleave:I[3]||(I[3]=U=>U.target.classList.remove("tooltip-active"))},Q(q(i)(V.teacherId||V)),41,xV)]),m(V)?(M(),B("div",EV,[d("span",{class:"coteaching-indicator teacher-name",title:`Co-teach ${V.coTeaching.subject}`,"data-tooltip":q(a)(V.coTeaching.caseManagerId),onMouseenter:I[4]||(I[4]=U=>U.target.classList.add("tooltip-active")),onMouseleave:I[5]||(I[5]=U=>U.target.classList.remove("tooltip-active"))},Q(q(i)(V.coTeaching.caseManagerId))+" (C"+Q(V.coTeaching.subject.charAt(0))+") ",41,bV)])):ve("",!0)])]))),128))])])):(M(),B("div",_V,""))]),d("td",{class:Ye(["instruction-cell",{"with-flag":q(p)(C,"flag2")}])},[q(p)(C,"flag2")?(M(),B("div",SV,"Separate setting")):ve("",!0),q(at)(C,"assessment")?(M(),B("div",AV,[d("div",{innerHTML:q(k)(q(at)(C,"assessment"))},null,8,TV)])):(M(),B("div",wV,""))],2)],64)):(M(),B(ke,{key:1},[d("td",CV,[d("div",IV,[d("strong",null,Q(q(at)(C,"firstName"))+" "+Q(q(at)(C,"lastName")),1),d("span",{class:"data-source",title:`Data source: ${q(du)(C,"firstName")}`},Q(q(du)(C,"firstName")==="Override"?"":q(du)(C,"firstName")==="App"?"":q(du)(C,"firstName")==="Aeries"?"":q(du)(C,"firstName")==="SEIS"?"":""),9,kV)]),d("div",DV,[d("div",null,"Grd: "+Q(q(at)(C,"grade"))+" | Prg: "+Q(q(at)(C,"plan")),1),d("div",null,[I[20]||(I[20]=we("CM: ")),d("span",{class:"case-manager-name","data-tooltip":q(o)(q(h)(C)),onMouseenter:I[6]||(I[6]=V=>V.target.classList.add("tooltip-active")),onMouseleave:I[7]||(I[7]=V=>V.target.classList.remove("tooltip-active"))},Q(q(s)(q(h)(C))),41,PV)]),(((L=(N=C.app)==null?void 0:N.flags)==null?void 0:L.customFlags)||[]).length?(M(),B("div",RV,[(M(),B(ke,null,He(["blue","yellow","red"],V=>{var z,U,G,j,ee,ae;return M(),B(ke,{key:V},[(((U=(z=C.app)==null?void 0:z.flags)==null?void 0:U.customFlags)||[]).filter(ne=>ne.color===V).length?(M(),B("span",{key:0,class:Ye(["flag-chip",`flag-${V}`]),"data-tooltip":(((j=(G=C.app)==null?void 0:G.flags)==null?void 0:j.customFlags)||[]).filter(ne=>ne.color===V).map(ne=>` ${ne.text}`).join(`
`)},[Re(q(sB),{size:16,class:"lucide-flag"}),d("span",NV,Q((((ae=(ee=C.app)==null?void 0:ee.flags)==null?void 0:ae.customFlags)||[]).filter(ne=>ne.color===V).length),1)],10,FV)):ve("",!0)],64)}),64))])):ve("",!0)]),d("div",OV,[d("span",{class:Ye(["badge badge-review plan-review",q(u)(C)])},"PR: "+Q(q(l)(q(at)(C,"reviewDate"))),3),d("span",{class:Ye(["badge badge-reeval reeval-due",q(f)(C)])},"RE: "+Q(q(l)(q(at)(C,"reevalDate"))),3),d("span",{class:Ye(["badge badge-meeting meeting-date",[q(c)(C),q(at)(C,"meetingDate")?"date-set":""]])},"  "+Q(q(l)(q(at)(C,"meetingDate"))||"Not set"),3)]),((O=t.currentUser)==null?void 0:O.role)==="paraeducator"&&q(D)(C.id)?(M(),B("div",MV,I[21]||(I[21]=[d("span",{class:"badge badge-direct"},"Direct Assignment",-1)]))):ve("",!0)]),Re(oV,{student:C,"app-settings":q(n),"get-class-services":q(_),"get-other-services":q(x),"has-service-providers":q(b),"get-service-provider-id":q(v),"get-provider-field-name":q(T),"get-user-initial-last-name":q(i)},null,8,["student","app-settings","get-class-services","get-other-services","has-service-providers","get-service-provider-id","get-provider-field-name","get-user-initial-last-name"]),Re($$,{student:C,"get-schedule":q(y),"get-user-initial-last-name":q(i),"get-period-label":q(S),"get-user-tooltip":q(a)},null,8,["student","get-schedule","get-user-initial-last-name","get-period-label","get-user-tooltip"]),Re(R_,{student:C,"field-name":"instruction","flag-type":"flag1","flag-text":"Preferential Seating","flag-class":"flag-preferential-seating","get-flag-value":q(p),"format-list-from-text":q(k)},null,8,["student","get-flag-value","format-list-from-text"]),Re(R_,{student:C,"field-name":"assessment","flag-type":"flag2","flag-text":"Separate Setting","flag-class":"flag-separate-setting","get-flag-value":q(p),"format-list-from-text":q(k)},null,8,["student","get-flag-value","format-list-from-text"]),Re(A$,{student:C,"get-document-url":q(g),"get-additional-documents":q(E)},null,8,["student","get-document-url","get-additional-documents"]),Re(D$,{student:C,"current-user":t.currentUser,"student-data":t.studentData,"get-user-name":q(s),"format-date":q(l),onEdit:V=>A.$emit("edit",C.id),onEmail:V=>A.$emit("email",C.id),onTeacherFeedback:V=>A.$emit("teacher-feedback",C.id)},null,8,["student","current-user","student-data","get-user-name","format-date","onEdit","onEmail","onTeacherFeedback"])],64))])}),128))])],2))}};function LV(t,e){const{appSettings:r,loadAppSettings:n,loading:s,error:i}=Ts(),a=Qr(),o=se(!1);Wt(async()=>{try{console.log("useStudentForm: Starting to load app settings..."),await n(),console.log("useStudentForm: App settings loaded successfully:",r.value)}catch(P){console.error("useStudentForm: Error loading app settings:",P)}});const l=_e(()=>{var R;const P=((R=r.value)==null?void 0:R.numPeriods)||7;return Array.from({length:P},(N,L)=>L+1)}),c=_e(()=>{var P;return(P=r.value)!=null&&P.grades&&r.value.grades.length>0?(console.log("useStudentForm: Using app settings grades:",r.value.grades),r.value.grades):(console.log("useStudentForm: Using fallback grades: [7, 8]"),["7","8"])}),u=_e(()=>{var P;if((P=r.value)!=null&&P.classServices&&r.value.classServices.length>0){const R=r.value.classServices.filter(N=>N.enabledSubcategories&&N.enabledSubcategories.length>0);return console.log("useStudentForm: Available class services:",R.length,"services"),R}return console.log("useStudentForm: No class services available"),[]}),f=_e(()=>{var P;return(P=r.value)!=null&&P.serviceProviders&&r.value.serviceProviders.length>0?(console.log("useStudentForm: Using app settings service providers:",r.value.serviceProviders.length,"providers"),r.value.serviceProviders):(console.log("useStudentForm: No service providers configured in app settings"),[])}),h=_e(()=>{var P;return(P=r.value)!=null&&P.customServiceProviders?r.value.customServiceProviders:[]}),p=_e(()=>{let P=t.users.userRoles?t.users.userRoles:{teachers:t.users.teachers||[],caseManagers:t.users.caseManagers||[],speech:t.users.speech||[],ot:t.users.ot||[],mh:t.users.mh||[]};return P.teachers&&(P={...P,teachers:P.teachers.map(R=>({...R,id:String(R.id)}))}),P}),g=P=>{var R,N,L,O,V,z,U,G,j,ee,ae,ne,le,Z,J,ge,te,K,Y,fe,ye,ie,ue,Ee,Ce,Pe,Te,ze,Ie,be,Me,Ke,qe,Se,xe,Ae,Le,We,$e,dt,xt,Vt,pt,ct,mt,Ct,Rt,mr,mn,Qs;return{ssid:at(P,"ssid")||P.id||"",firstName:at(P,"firstName")||"",lastName:at(P,"lastName")||"",grade:at(P,"grade")||"7",plan:at(P,"plan")||"IEP",reviewDate:at(P,"reviewDate")||"",reevalDate:at(P,"reevalDate")||"",meetingDate:at(P,"meetingDate")||"",caseManagerId:at(P,"caseManagerId")||P.caseManagerId||P.casemanager_id||"",schedule:((N=(R=P.app)==null?void 0:R.schedule)==null?void 0:N.periods)||((O=(L=P.aeries)==null?void 0:L.schedule)==null?void 0:O.periods)||P.schedule||{},services:((z=(V=P.app)==null?void 0:V.schedule)==null?void 0:z.classServices)||P.services||[],speechId:((G=(U=P.app)==null?void 0:U.providers)==null?void 0:G.speechId)||P.speechId||P.speech_id||"",otId:((ee=(j=P.app)==null?void 0:j.providers)==null?void 0:ee.otId)||P.otId||P.ot_id||"",mhId:((ne=(ae=P.app)==null?void 0:ae.providers)==null?void 0:ne.mhId)||P.mhId||P.mh_id||"",ptId:((Z=(le=P.app)==null?void 0:le.providers)==null?void 0:Z.ptId)||P.ptId||P.pt_id||"",scId:((ge=(J=P.app)==null?void 0:J.providers)==null?void 0:ge.scId)||P.scId||P.sc_id||"",trId:((K=(te=P.app)==null?void 0:te.providers)==null?void 0:K.trId)||P.trId||P.tr_id||"",audId:((fe=(Y=P.app)==null?void 0:Y.providers)==null?void 0:fe.audId)||P.audId||P.aud_id||"",viId:((ie=(ye=P.app)==null?void 0:ye.providers)==null?void 0:ie.viId)||P.viId||P.vi_id||"",atId:((Ee=(ue=P.app)==null?void 0:ue.providers)==null?void 0:Ee.atId)||P.atId||P.at_id||"",dhhId:((Pe=(Ce=P.app)==null?void 0:Ce.providers)==null?void 0:Pe.dhhId)||P.dhhId||P.dhh_id||"",omId:((ze=(Te=P.app)==null?void 0:Te.providers)==null?void 0:ze.omId)||P.omId||P.om_id||"",bisId:((be=(Ie=P.app)==null?void 0:Ie.providers)==null?void 0:be.bisId)||P.bisId||P.bis_id||"",hnId:((Ke=(Me=P.app)==null?void 0:Me.providers)==null?void 0:Ke.hnId)||P.hnId||P.hn_id||"",swId:((Se=(qe=P.app)==null?void 0:qe.providers)==null?void 0:Se.swId)||P.swId||P.sw_id||"",instruction:at(P,"instruction")||"",assessment:at(P,"assessment")||"",flag1:((Ae=(xe=P.app)==null?void 0:xe.flags)==null?void 0:Ae.flag1)||P.flag1||!1,flag2:((We=(Le=P.app)==null?void 0:Le.flags)==null?void 0:We.flag2)||P.flag2||!1,app:{flags:{customFlags:((dt=($e=P.app)==null?void 0:$e.flags)==null?void 0:dt.customFlags)||[]}},ataglancePdfUrl:((Vt=(xt=P.app)==null?void 0:xt.documents)==null?void 0:Vt.ataglancePdfUrl)||P.ataglancePdfUrl||P.ataglance_pdf_url||"",bipPdfUrl:((ct=(pt=P.app)==null?void 0:pt.documents)==null?void 0:ct.bipPdfUrl)||P.bipPdfUrl||P.bip_pdf_url||"",ataglanceFileName:((Ct=(mt=P.app)==null?void 0:mt.documents)==null?void 0:Ct.ataglanceFileName)||P.ataglanceFileName||"",bipFileName:((mr=(Rt=P.app)==null?void 0:Rt.documents)==null?void 0:mr.bipFileName)||P.bipFileName||"",bipFile:null,ataglanceFile:null,removeBipFile:!1,removeAtaglanceFile:!1,additionalDocuments:((Qs=(mn=P.app)==null?void 0:mn.documents)==null?void 0:Qs.additionalDocuments)||[]}},y=As(g(t.student||{})),_=P=>{const R=[];return P&&typeof P=="object"&&Object.entries(P).forEach(([N,L])=>{if(L&&typeof L=="object"&&L.coTeaching){const O=L.coTeaching.subject;O&&R.push(`Co-teach: ${O}`)}}),R},x=()=>{const P=_(y.schedule),R=y.services.filter(N=>!N.startsWith("Co-teach:"));y.services=[...R,...P]};Ht(()=>y.schedule,()=>{x()},{deep:!0}),Ht(()=>t.student,(P,R)=>{if(P&&Object.keys(P).length>0){const N=!R||Object.keys(R).length===0,L=P.id!==(R==null?void 0:R.id);if(N||L){console.log(" useStudentForm DEBUG - Student data changed, updating form:",P.id),console.log(" useStudentForm DEBUG - Student data:",{firstName:at(P,"firstName"),lastName:at(P,"lastName"),plan:at(P,"plan"),caseManagerId:at(P,"caseManagerId"),rawStudent:P});const O=g(P);Object.assign(y,O),x(),console.log(" useStudentForm DEBUG - Form updated:",{plan:y.plan,caseManagerId:y.caseManagerId,firstName:y.firstName,lastName:y.lastName})}}},{immediate:!0,deep:!0}),Ht(()=>r.value,P=>{console.log("useStudentForm: App settings watcher triggered:",P),P!=null&&P.grades&&P.grades.length>0&&(P.grades.includes(y.grade)||(y.grade=P.grades[0]||"7"))},{immediate:!0,deep:!0});const b=(P,R)=>{const N=P.target.files[0]||null;if(N){const L=ol(N,{allowedTypes:["pdf"],maxSize:10485760,fieldName:R==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!L.isValid){alert(L.error),P.target.value="";return}const O=Hr(N.name);if(!O.isSafe){alert(`File name contains potentially dangerous content: ${O.threats.join(", ")}`),P.target.value="";return}}y[R]=N},v=P=>{P.preventDefault(),P.stopPropagation(),y.removeBipFile=!0,y.bipFile=null},T=P=>{P.preventDefault(),P.stopPropagation(),y.removeAtaglanceFile=!0,y.ataglanceFile=null},D=P=>{if(!P||P.trim().length===0||P.trim().length>24)throw new Error("Title must be between 1 and 24 characters");if(2+y.additionalDocuments.length>=10)throw new Error("Maximum of 10 documents allowed (including BIP and At-A-Glance)");const N={id:crypto.randomUUID(),title:P.trim(),pdfUrl:"",fileName:"",toRemove:!1};return y.additionalDocuments.push(N),N.id},k=P=>{const R=y.additionalDocuments.find(N=>N.id===P);R&&(R.toRemove=!0)},S=P=>{const R=y.additionalDocuments.find(N=>N.id===P);R&&(R.toRemove=!1)},E=P=>{const R=y.additionalDocuments.findIndex(N=>N.id===P);R!==-1&&y.additionalDocuments.splice(R,1)},m={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"},A=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],I=P=>{var N;if((N=r.value)!=null&&N.serviceProviders&&Array.isArray(r.value.serviceProviders)){const L=(r.value.serviceProvidersDetails||A).find(O=>O.abbreviation===P);if(L)return L.name+" ("+P+")"}const R=A.find(L=>L.abbreviation===P);return R?R.name+" ("+P+")":P},C=P=>{const N={SLP:"speech",OT:"ot",MH:"mh",PT:"pt",SC:"sc",TR:"tr",AUD:"aud",VI:"vi",AT:"at",DHH:"dhh","O&M":"om",BIS:"bis",HN:"hn",SW:"sw"}[P]||P.toLowerCase();return p.value[N]||[]},F=()=>{const P=g4(y),R={app:{studentData:{firstName:P.firstName,lastName:P.lastName,grade:P.grade,plan:P.plan,caseManagerId:P.caseManagerId}}},N=m4(R,{isNew:t.mode==="new"});if(!N.isValid)return alert(`Please fix the following errors:

${N.errors.join(`
`)}`),!1;const L=["firstName","lastName","instruction","assessment"];for(const O of L)if(y[O]){const V=Hr(y[O]);if(!V.isSafe)return alert(`Security threat detected in ${O}: ${V.threats.join(", ")}`),!1}return Object.assign(y,P),!0};return{form:y,isSaving:o,appSettings:r,appSettingsLoading:s,appSettingsError:i,periods:l,gradeOptions:c,availableClassServices:u,serviceProviders:f,customServiceProviders:h,userRoles:p,onFileChange:b,removeBipFile:v,removeAtaglanceFile:T,addAdditionalDocument:D,removeAdditionalDocument:k,undoRemoveAdditionalDocument:S,deleteAdditionalDocument:E,providerFieldMap:m,getProviderLabel:I,getProviderUsers:C,handleSubmit:async()=>{var P,R,N,L,O,V,z;try{if(o.value){console.log("Form submission already in progress, ignoring duplicate");return}if(console.log(" Form submitted:",{plan:y.plan,caseManagerId:y.caseManagerId,firstName:y.firstName,lastName:y.lastName,mode:t.mode,studentId:(P=t.student)==null?void 0:P.id}),o.value=!0,console.log(" AUTH DEBUG - Current user:",{uid:(R=bt.currentUser)==null?void 0:R.uid,email:(N=bt.currentUser)==null?void 0:N.email,claims:await((L=bt.currentUser)==null?void 0:L.getIdTokenResult())}),!F()){o.value=!1;return}const U=y.services.filter(Z=>Z&&Z.includes(":")),G={};console.log(" FORM SCHEDULE DEBUG - Complete form.schedule:",JSON.stringify(y.schedule,null,2)),console.log(" FORM SCHEDULE DEBUG - periods.value:",l.value),l.value.forEach(Z=>{if(console.log(` FORM SCHEDULE DEBUG - Period ${Z} exists:`,!!y.schedule[Z],"Value:",y.schedule[Z]),y.schedule[Z]){const J=y.schedule[Z];console.log(` SCHEDULE DEBUG - Period ${Z}:`,{type:typeof J,data:J,hasCoTeaching:!!(J&&J.coTeaching),hasCaseManagerId:!!(J&&J.coTeaching&&J.coTeaching.caseManagerId)}),typeof J=="string"?G[Z]=J:typeof J=="object"&&J!==null&&(J.coTeaching&&J.coTeaching.caseManagerId?(console.log(` SCHEDULE DEBUG - Period ${Z} has co-teaching, preserving structure`),G[Z]={teacherId:J.teacherId,coTeaching:{caseManagerId:J.coTeaching.caseManagerId,subject:J.coTeaching.subject||""}}):(console.log(` SCHEDULE DEBUG - Period ${Z} converting to simple format`),G[Z]=J.teacherId||String(J)||J))}else console.log(` SCHEDULE DEBUG - Period ${Z} was deleted, using deleteField() for database removal`),G[Z]=xI()}),console.log(" Schedule Composition Debug:"),console.log("Form schedule before:",JSON.stringify(y.schedule,null,2)),console.log("Composed schedule after:",JSON.stringify(G,null,2)),console.log("Composed data:",{classServices:U,schedule:G});let j=y.bipPdfUrl||null,ee=y.ataglancePdfUrl||null;if(console.log(" Form submission - PDF URLs:",{bipPdfUrl:j,ataglancePdfUrl:ee,formBipPdfUrl:y.bipPdfUrl,formAtaglancePdfUrl:y.ataglancePdfUrl,bipFileName:y.bipFileName,ataglanceFileName:y.ataglanceFileName,bipFile:y.bipFile,ataglanceFile:y.ataglanceFile}),y.removeBipFile&&(console.log("Removing BIP file..."),j)){try{const Z=se(Dc,`students/${t.student.id||"temp"}/${j}`);await Fv(Z),await deleteDoc(et(Xe,"pdfMetadata",j)),console.log("Secure BIP file deleted:",j)}catch(Z){console.warn("Error deleting secure BIP file:",Z)}j=null}if(y.removeAtaglanceFile&&(console.log("Removing At-A-Glance file..."),ee)){try{const Z=se(Dc,`students/${t.student.id||"temp"}/${ee}`);await Fv(Z),await deleteDoc(et(Xe,"pdfMetadata",ee)),console.log("Secure At-A-Glance file deleted:",ee)}catch(Z){console.warn("Error deleting secure At-A-Glance file:",Z)}ee=null}const ae={studentData:{firstName:y.firstName,lastName:y.lastName,grade:y.grade,plan:y.plan,caseManagerId:y.caseManagerId},dates:{reviewDate:y.reviewDate,reevalDate:y.reevalDate,meetingDate:y.meetingDate},schedule:{periods:G,classServices:U},providers:{speechId:y.speechId,otId:y.otId,mhId:y.mhId,ptId:y.ptId,scId:y.scId,trId:y.trId,audId:y.audId,viId:y.viId,atId:y.atId,dhhId:y.dhhId,omId:y.omId,bisId:y.bisId,hnId:y.hnId,swId:y.swId},accommodations:{instruction:y.instruction,assessment:y.assessment},flags:{flag1:y.flag1,flag2:y.flag2,customFlags:((V=(O=y.app)==null?void 0:O.flags)==null?void 0:V.customFlags)||[]},documents:{ataglancePdfUrl:ee,bipPdfUrl:j,bipFileName:y.bipFileName||null,ataglanceFileName:y.ataglanceFileName||null,additionalDocuments:y.additionalDocuments.filter(Z=>!Z.toRemove&&Z.pdfUrl).map(Z=>({id:Z.id,title:Z.title,pdfUrl:Z.pdfUrl,fileName:Z.fileName,uploadDate:Z.uploadDate||new Date().toISOString()}))}};console.log(" Documents being saved:",{ataglancePdfUrl:ee,bipPdfUrl:j,bipFileName:y.bipFileName||null,ataglanceFileName:y.ataglanceFileName||null}),console.log("Saving payload:",ae);const ne={app:ae,updatedAt:Pn(),updatedBy:((z=a.currentUser)==null?void 0:z.uid)||null};console.log("Saving payload:",ne);let le=null;if(t.mode==="edit"&&t.student.id)console.log("Updating existing student:",t.student.id),await $t(et(Xe,"students",t.student.id),ne,{merge:!0}),le=t.student.id,console.log("Student updated successfully"),await an.logStudentAccess(t.student.id,"edit",{fields:Object.keys(ae.studentData||{}),hasDocuments:!!(ee||j),formMode:"edit"});else{if(console.log("Adding new student"),!y.ssid||y.ssid.trim()===""){alert("SSID is required for new students");return}const Z=y.ssid.trim();ne.app.studentData.ssid=Z;const J=et(At(Xe,"students"));ne.createdAt=Pn(),await $t(J,ne,{merge:!0}),le=J.id,ne.id=le,console.log("Student added successfully with ID:",le,"SSID:",Z),await an.logStudentAccess(le,"create",{ssid:Z,fields:Object.keys(ae.studentData||{}),hasDocuments:!!(ee||j),formMode:"create"})}e("saved",ne),e("close")}catch(U){console.error("Error saving student:",U),console.error("Error details:",{code:U.code,message:U.message,stack:U.stack}),alert(`Error saving student: ${U.message||U}. Please try again.`)}finally{o.value=!1}},validateForm:F}}const BV={class:"form-col"},UV={class:"inner-grid-3"},$V={key:0,class:"ssid-field"},VV=["value"],HV=["value"],jV={__name:"StudentBasicInfo",props:{form:{type:Object,required:!0},mode:{type:String,default:"new"},gradeOptions:{type:Array,required:!0},userRoles:{type:Object,required:!0}},setup(t){const e=t,r=_e(()=>(e.userRoles.caseManagers||[]).sort((s,i)=>{const a=o=>{const l=o.name||o.email||o.id,c=l.split(" ");return c.length>1?c[c.length-1]:l};return a(s).localeCompare(a(i))}));return(n,s)=>(M(),B("fieldset",BV,[s[21]||(s[21]=d("legend",null,"Student Info",-1)),d("div",UV,[t.mode==="new"?(M(),B("label",$V,[s[9]||(s[9]=d("span",{class:"field-label"},"SSID (State Student ID) *",-1)),Oe(d("input",{"onUpdate:modelValue":s[0]||(s[0]=i=>t.form.ssid=i),type:"text",required:"",placeholder:"Enter student SSID",class:"ssid-input"},null,512),[[ht,t.form.ssid]]),s[10]||(s[10]=d("div",{class:"field-help"},[d("strong",null,"Required:"),we(" This can be found in your Student Information System (SIS) such as Aeries, or in SEIS. The SSID is used to link student data across different systems. ")],-1))])):ve("",!0),d("label",null,[s[11]||(s[11]=we(" First Name: ")),Oe(d("input",{"onUpdate:modelValue":s[1]||(s[1]=i=>t.form.firstName=i),type:"text",required:""},null,512),[[ht,t.form.firstName]])]),d("label",null,[s[12]||(s[12]=we(" Last Name: ")),Oe(d("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>t.form.lastName=i),type:"text",required:""},null,512),[[ht,t.form.lastName]])]),d("label",null,[s[13]||(s[13]=we(" Grade: ")),Oe(d("select",{"onUpdate:modelValue":s[3]||(s[3]=i=>t.form.grade=i)},[(M(!0),B(ke,null,He(t.gradeOptions,i=>(M(),B("option",{key:i,value:i},Q(i),9,VV))),128))],512),[[sr,t.form.grade]])]),d("label",null,[s[15]||(s[15]=we(" Plan Type: ")),Oe(d("select",{"onUpdate:modelValue":s[4]||(s[4]=i=>t.form.plan=i)},s[14]||(s[14]=[d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),512),[[sr,t.form.plan]])]),d("label",null,[s[16]||(s[16]=we(" Review Date: ")),Oe(d("input",{"onUpdate:modelValue":s[5]||(s[5]=i=>t.form.reviewDate=i),type:"date"},null,512),[[ht,t.form.reviewDate]])]),d("label",null,[s[17]||(s[17]=we(" Reevaluation Date: ")),Oe(d("input",{"onUpdate:modelValue":s[6]||(s[6]=i=>t.form.reevalDate=i),type:"date"},null,512),[[ht,t.form.reevalDate]])]),d("label",null,[s[18]||(s[18]=we(" Meeting Date: ")),Oe(d("input",{"onUpdate:modelValue":s[7]||(s[7]=i=>t.form.meetingDate=i),type:"date"},null,512),[[ht,t.form.meetingDate]])]),d("label",null,[s[20]||(s[20]=we(" Case Manager: ")),Oe(d("select",{"onUpdate:modelValue":s[8]||(s[8]=i=>t.form.caseManagerId=i)},[s[19]||(s[19]=d("option",{value:""},"-- Select Case Manager --",-1)),(M(!0),B(ke,null,He(r.value,i=>(M(),B("option",{key:i.id,value:i.id},Q(i.name||i.email||i.id),9,HV))),128))],512),[[sr,t.form.caseManagerId]])])])]))}},GV=St(jV,[["__scopeId","data-v-8563a3c0"]]),WV={class:"form-col"},zV={class:"periods-container"},KV={class:"period-main"},qV={class:"period-label"},XV=["value","onChange"],YV=["value"],QV=["disabled","onClick"],JV={key:0,class:"coteaching-config"},ZV={class:"coteaching-info"},eH={class:"classroom-teacher"},tH={class:"case-manager-name"},rH={class:"config-row"},nH=["value","onChange"],sH=["value"],aH={class:"config-row"},iH=["value","onChange"],oH=["value"],lH={__name:"StudentSchedule",props:{form:{type:Object,required:!0},periods:{type:Array,required:!0},userRoles:{type:Object,required:!0},appSettings:{type:Object,default:()=>({})}},setup(t){const e=t,{getLabel:r}=Eo(),n=_e(()=>(e.userRoles.teachers||[]).sort((b,v)=>{const T=D=>{const k=D.name||D.email||D.id,S=k.split(" ");return S.length>1?S[S.length-1]:k};return T(b).localeCompare(T(v))})),s=_e(()=>(e.userRoles.caseManagers||[]).filter(b=>b.id&&(b.role==="case_manager"||b.role==="admin_504"||b.role==="administrator_504_CM"||b.role==="sped_chair"||b.roles&&b.roles.includes("case_manager"))).sort((b,v)=>{const T=D=>{const k=D.name||D.email||D.id,S=k.split(" ");return S.length>1?S[S.length-1]:k};return T(b).localeCompare(T(v))})),i=_e(()=>{var x;if((x=e.appSettings)!=null&&x.classServices){const b=e.appSettings.classServices.find(v=>v.name==="Co-teach"&&v.enabledSubcategories);if(b)return b.enabledSubcategories.sort()}return["English","Math","History","Science"]}),a=x=>{const b=e.form.schedule[x];return typeof b=="string"?b:typeof b=="object"&&b!==null&&b.teacherId||""},o=(x,b)=>{if(p("SET_TEACHER_START",{period:x,teacherId:b,isCoTeachingActive:u(x),currentValue:e.form.schedule[x]}),u(x)){const v=f(x),T=h(x);e.form.schedule[x]={teacherId:b,coTeaching:{caseManagerId:v,subject:T}},p("SET_TEACHER_COTEACHING",{period:x,newValue:e.form.schedule[x]})}else b&&b.trim()!==""&&b.trim()!=="--"?(e.form.schedule[x]=b,p("SET_TEACHER_SIMPLE",{period:x,newValue:e.form.schedule[x]})):(delete e.form.schedule[x],p("CLEAR_TEACHER",{period:x,action:"deleted_period_key"}))},l=x=>{if(!x)return"Unknown";const b=(e.userRoles.teachers||[]).find(v=>v.id===x);return b&&(b.name||b.email)||x},c=x=>{if(!x)return"Select Case Manager";const b=s.value.find(v=>v.id===x);return b&&(b.name||b.email)||x},u=x=>{var v;const b=e.form.schedule[x];return typeof b=="object"&&b!==null?!!((v=b.coTeaching)!=null&&v.caseManagerId):!1},f=x=>{var v;const b=e.form.schedule[x];return typeof b=="object"&&b!==null&&((v=b.coTeaching)==null?void 0:v.caseManagerId)||""},h=x=>{var v;const b=e.form.schedule[x];return typeof b=="object"&&b!==null&&((v=b.coTeaching)==null?void 0:v.subject)||""},p=(x,b)=>{const v=new Date().toISOString();console.log(` [${v}] Schedule Process: ${x}`,b)},g=(x,b)=>{p("UPDATE_CM_START",{period:x,caseManagerId:b,currentValue:e.form.schedule[x]});const v=a(x),T=h(x);v?(e.form.schedule[x]={teacherId:v,coTeaching:{caseManagerId:b,subject:T}},p("UPDATE_CM_COMPLETE",{period:x,newValue:e.form.schedule[x]}),console.log(" CO-TEACHING DEBUG - Case Manager Updated:",{period:x,periodType:typeof x,caseManagerId:b,teacherId:v,subject:T,finalValue:e.form.schedule[x],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):p("UPDATE_CM_BLOCKED",{reason:"No teacher ID",period:x})},y=(x,b)=>{p("UPDATE_SUBJECT_START",{period:x,subject:b,currentValue:e.form.schedule[x]});const v=a(x),T=f(x);v?(e.form.schedule[x]={teacherId:v,coTeaching:{caseManagerId:T,subject:b}},p("UPDATE_SUBJECT_COMPLETE",{period:x,newValue:e.form.schedule[x]}),console.log(" CO-TEACHING DEBUG - Subject Updated:",{period:x,periodType:typeof x,subject:b,teacherId:v,caseManagerId:T,finalValue:e.form.schedule[x],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):p("UPDATE_SUBJECT_BLOCKED",{reason:"No teacher ID",period:x})},_=x=>{var T;p("TOGGLE_START",{period:x,currentValue:e.form.schedule[x],formVersion:e.formVersion});const b=a(x);if(!b){p("TOGGLE_BLOCKED",{reason:"No teacher selected",period:x});return}const v=u(x);if(p("TOGGLE_STATE",{period:x,isActive:v,teacherId:b,beforeValue:e.form.schedule[x]}),v)e.form.schedule[x]=b;else{const D={teacherId:b,coTeaching:{caseManagerId:((T=s.value[0])==null?void 0:T.id)||"",subject:i.value[0]||""}};e.form.schedule[x]=D,setTimeout(()=>{var k;console.log(" CO-TEACHING PERSISTENCE CHECK - 100ms later:",{period:x,stillExists:!!e.form.schedule[x],currentValue:e.form.schedule[x],isObject:typeof e.form.schedule[x]=="object",hasCoTeaching:!!((k=e.form.schedule[x])!=null&&k.coTeaching)})},100),setTimeout(()=>{var k;console.log(" CO-TEACHING PERSISTENCE CHECK - 1000ms later:",{period:x,stillExists:!!e.form.schedule[x],currentValue:e.form.schedule[x],isObject:typeof e.form.schedule[x]=="object",hasCoTeaching:!!((k=e.form.schedule[x])!=null&&k.coTeaching)})},1e3)}p("TOGGLE_COMPLETE",{period:x,afterValue:e.form.schedule[x],formVersion:e.formVersion}),console.log(" CO-TEACHING DEBUG - Toggle Complete:",{period:x,periodType:typeof x,isActive:!v,finalValue:e.form.schedule[x],entireSchedule:JSON.stringify(e.form.schedule,null,2),availableCaseManagers:s.value.length,availableSubjects:i.value.length})};return Ht(()=>e.form.schedule,(x,b)=>{console.log(" SCHEDULE WATCHER - Schedule changed:",{timestamp:new Date().toISOString(),newSchedule:JSON.stringify(x,null,2),oldSchedule:JSON.stringify(b,null,2),periodsWithObjects:Object.keys(x).filter(v=>typeof x[v]=="object"),periodsWithCoTeaching:Object.keys(x).filter(v=>{var T;return(T=x[v])==null?void 0:T.coTeaching})})},{deep:!0}),(x,b)=>(M(),B("fieldset",WV,[b[7]||(b[7]=d("legend",null,"Schedule",-1)),d("div",zV,[(M(!0),B(ke,null,He(t.periods,v=>(M(),B("div",{key:v,class:"period-row"},[d("div",KV,[d("label",qV,Q(q(r)(v))+":",1),d("select",{value:a(v),onChange:T=>o(v,T.target.value),class:"teacher-select"},[b[0]||(b[0]=d("option",{value:""},"--",-1)),(M(!0),B(ke,null,He(n.value,T=>(M(),B("option",{key:T.id,value:T.id},Q(T.name||T.email||T.id),9,YV))),128))],40,XV),d("button",{type:"button",class:Ye(["coteaching-toggle",{active:u(v)}]),disabled:!a(v),onClick:T=>_(v),title:"Co-Teaching"}," C ",10,QV)]),u(v)?(M(),B("div",JV,[d("div",ZV,[b[1]||(b[1]=d("span",{class:"coteaching-label"},"Co-Teaching:",-1)),d("span",eH,Q(l(a(v))),1),b[2]||(b[2]=d("span",{class:"plus-sign"},"+",-1)),d("span",tH,Q(c(f(v))),1)]),d("div",rH,[b[4]||(b[4]=d("label",{class:"config-label"},"Subject:",-1)),d("select",{value:h(v),onChange:T=>y(v,T.target.value),class:"subject-select",required:""},[b[3]||(b[3]=d("option",{value:""},"-- Select Subject --",-1)),(M(!0),B(ke,null,He(i.value,T=>(M(),B("option",{key:T,value:T},Q(T),9,sH))),128))],40,nH)]),d("div",aH,[b[6]||(b[6]=d("label",{class:"config-label"},"Case Manager:",-1)),d("select",{value:f(v),onChange:T=>g(v,T.target.value),class:"cm-select"},[b[5]||(b[5]=d("option",{value:""},"-- Select Case Manager --",-1)),(M(!0),B(ke,null,He(s.value,T=>(M(),B("option",{key:T.id,value:T.id},Q(T.name||T.email||T.id),9,oH))),128))],40,iH)])])):ve("",!0)]))),128))])]))}},cH=St(lH,[["__scopeId","data-v-922e76d2"]]),uH={class:"checkbox-inline-group"},dH=["value","checked","onChange"],F_={__name:"ServiceCheckboxGroup",props:["label","items","modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const r=t,n=e;function s(i){const a=r.label+": "+i,o=r.modelValue?[...r.modelValue]:[],l=o.indexOf(a);l===-1?o.push(a):o.splice(l,1),n("update:modelValue",o)}return(i,a)=>(M(),B("fieldset",null,[d("legend",null,Q(t.label),1),d("div",uH,[(M(!0),B(ke,null,He(t.items,o=>(M(),B("label",{key:o},[d("input",{type:"checkbox",value:t.label+": "+o,checked:t.modelValue&&t.modelValue.includes(t.label+": "+o),onChange:l=>s(o)},null,40,dH),we(" "+Q(o),1)]))),128))])]))}},fH={class:"form-col"},hH={class:"inner-grid-3"},pH={key:0,class:"loading-message"},mH={key:1,class:"error-message"},gH={style:{display:"none"}},vH={key:3,class:"no-services-message"},yH={__name:"StudentClassServices",props:{form:{type:Object,required:!0},availableClassServices:{type:Array,required:!0},appSettingsLoading:{type:Boolean,default:!1},appSettingsError:{type:String,default:null}},setup(t){const e=t,r=_e(()=>e.availableClassServices.filter(s=>s.name!=="Co-teach")),n=_e(()=>e.availableClassServices.filter(s=>s.name==="Co-teach"));return(s,i)=>(M(),B("fieldset",fH,[i[5]||(i[5]=d("legend",null,"Services: classes",-1)),d("div",hH,[t.appSettingsLoading?(M(),B("div",pH,i[2]||(i[2]=[d("span",{class:"loading-spinner"},"",-1),we(" Loading app settings... ")]))):t.appSettingsError?(M(),B("div",mH,[i[3]||(i[3]=d("span",{class:"error-icon"},"",-1)),we(" Error loading app settings: "+Q(t.appSettingsError),1)])):t.availableClassServices.length>0?(M(),B(ke,{key:2},[(M(!0),B(ke,null,He(r.value,a=>(M(),Qt(F_,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[0]||(i[0]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128)),d("div",gH,[(M(!0),B(ke,null,He(n.value,a=>(M(),Qt(F_,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[1]||(i[1]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128))])],64)):(M(),B("div",vH,i[4]||(i[4]=[d("span",{class:"info-icon"},"",-1),we(" No class services configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},xH=St(yH,[["__scopeId","data-v-d750acb2"]]),EH=["id","value"],bH=["value"],N_={__name:"ServiceSelect",props:["id","label","list","modelValue"],emits:["update:modelValue"],setup(t){const e=t,r=_e(()=>(e.list||[]).sort((s,i)=>{const a=o=>{const l=o.name||o.email||o.id,c=l.split(" ");return c.length>1?c[c.length-1]:l};return a(s).localeCompare(a(i))}));return(n,s)=>(M(),B("label",null,[we(Q(t.label)+": ",1),d("select",{id:t.id,value:t.modelValue,onChange:s[0]||(s[0]=i=>n.$emit("update:modelValue",i.target.value))},[s[1]||(s[1]=d("option",{value:""},"--",-1)),(M(!0),B(ke,null,He(r.value,i=>(M(),B("option",{key:i.id,value:i.id},Q(i.name),9,bH))),128))],40,EH)]))}},_H={class:"inner-grid-3"},SH={key:1,class:"no-services-message"},AH={__name:"StudentProviders",props:{form:{type:Object,required:!0},serviceProviders:{type:Array,required:!0},customServiceProviders:{type:Array,required:!0},providerFieldMap:{type:Object,required:!0},getProviderLabel:{type:Function,required:!0},getProviderUsers:{type:Function,required:!0}},setup(t){return(e,r)=>(M(),B("fieldset",null,[r[1]||(r[1]=d("legend",null,"Services: providers",-1)),d("div",_H,[t.serviceProviders.length>0?(M(),B(ke,{key:0},[(M(!0),B(ke,null,He(t.serviceProviders,n=>(M(),Qt(N_,{key:n,id:n,label:t.getProviderLabel(n),list:t.getProviderUsers(n),modelValue:t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`]=s},null,8,["id","label","list","modelValue","onUpdate:modelValue"]))),128)),(M(!0),B(ke,null,He(t.customServiceProviders,n=>(M(),Qt(N_,{key:n,id:n,label:n,list:[],modelValue:t.form[`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[`${n.toLowerCase()}Id`]=s},null,8,["id","label","modelValue","onUpdate:modelValue"]))),128))],64)):(M(),B("div",SH,r[0]||(r[0]=[d("span",{class:"info-icon"},"",-1),we(" No service providers configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},TH=St(AH,[["__scopeId","data-v-faa02238"]]),wH={class:"form-col"},CH={class:"document-section"},IH={key:0,class:"current-file"},kH={key:1,class:"removed-file"},DH={key:2,class:"upload-status loading-pulse"},PH={key:3,class:"error-message"},RH={class:"document-section"},FH={key:0,class:"current-file"},NH={key:1,class:"removed-file"},OH={key:2,class:"upload-status loading-pulse"},MH={class:"additional-documents-section"},LH={class:"additional-docs-header"},BH={class:"doc-counter"},UH={class:"additional-doc-header"},$H={class:"doc-title"},VH={key:0,class:"doc-upload-area"},HH=["onChange"],jH={key:1,class:"current-file"},GH=["onClick"],WH=["onClick"],zH={key:2,class:"removed-file"},KH=["onClick"],qH={key:3,class:"upload-status loading-pulse"},XH={key:0,class:"add-document-section"},YH={key:0,class:"add-document-button-container"},QH={key:1,class:"add-document-form"},JH={class:"title-input-container"},ZH={class:"char-counter"},ej={class:"add-form-buttons"},tj=["disabled"],rj={key:1,class:"max-documents-message"},nj={__name:"StudentDocuments",props:{form:{type:Object,required:!0},student:{type:Object,default:()=>({})},mode:{type:String,default:"new"},onFileChange:{type:Function,required:!0},removeBipFile:{type:Function,required:!0},removeAtaglanceFile:{type:Function,required:!0},addAdditionalDocument:{type:Function,required:!0},removeAdditionalDocument:{type:Function,required:!0},undoRemoveAdditionalDocument:{type:Function,required:!0},deleteAdditionalDocument:{type:Function,required:!0}},emits:["loading-change"],setup(t,{emit:e}){const r=t,n=e,{uploadPdf:s,downloadPdf:i,isUploading:a,error:o}=ax(),l=se(null),c=_e(()=>a.value||l.value!==null);Ht(c,k=>{n("loading-change",k)},{immediate:!0});const u=_e(()=>{var S,E,m,A;const k=((S=r.student)==null?void 0:S.id)||((E=r.form)==null?void 0:E.id);return console.log(" StudentDocuments - studentId computed:",{studentId:(m=r.student)==null?void 0:m.id,formId:(A=r.form)==null?void 0:A.id,finalId:k}),k}),f=async(k,S)=>{const E=k.target.files[0]||null;if(E){const m=ol(E,{allowedTypes:["pdf"],maxSize:10485760,fieldName:S==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!m.isValid){alert(m.error),k.target.value="";return}const A=Hr(E.name);if(!A.isSafe){alert(`File name contains potentially dangerous content: ${A.threats.join(", ")}`),k.target.value="";return}try{if(l.value=S==="bipFile"?"bip":"ataglance",!u.value)throw new Error("Student ID is required for secure file upload");const I=S==="bipFile"?r.form.bipPdfUrl:r.form.ataglancePdfUrl;if(I){console.log(` Cleaning up old ${S} file:`,I);try{const{ref:F,deleteObject:W}=await ua(async()=>{const{ref:V,deleteObject:z}=await Promise.resolve().then(()=>Q9);return{ref:V,deleteObject:z}},void 0),{doc:P,deleteDoc:R}=await ua(async()=>{const{doc:V,deleteDoc:z}=await Promise.resolve().then(()=>O7);return{doc:V,deleteDoc:z}},void 0),{storage:N,db:L}=await ua(async()=>{const{storage:V,db:z}=await Promise.resolve().then(()=>GI);return{storage:V,db:z}},void 0),O=F(N,`students/${u.value}/${I}`);await W(O),await R(P(L,"pdfMetadata",I)),console.log(` Old ${S} file cleaned up:`,I)}catch(F){console.warn(`Failed to clean up old ${S} file:`,F.message)}}const C=await s(E,u.value);S==="bipFile"?(Object.assign(r.form,{bipPdfUrl:C,bipFileName:E.name}),console.log(" BIP file updated in form:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName})):(Object.assign(r.form,{ataglancePdfUrl:C,ataglanceFileName:E.name}),console.log(" At-A-Glance file updated in form:",{ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})),console.log(` Secure PDF uploaded: ${C}`),console.log(" Current form state:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName,ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})}catch(I){console.error("Secure PDF upload failed:",I),alert(`Failed to upload PDF: ${I.message}`)}finally{l.value=null,k.target.value=""}}r.onFileChange(k,S)},h=async k=>{try{const S=k==="bip"?r.form.bipPdfUrl:r.form.ataglancePdfUrl,E=k==="bip"?r.form.bipFileName:r.form.ataglanceFileName;if(!S||!u.value)throw new Error("File not found or student ID missing");await i(S,u.value,E)}catch(S){console.error("Secure PDF download failed:",S),alert(`Failed to download PDF: ${S.message}`)}},p=se(!1),g=se(""),y=_e(()=>r.form.additionalDocuments||[]),_=_e(()=>2+y.value.length<10),x=()=>{p.value=!0,g.value=""},b=()=>{p.value=!1,g.value=""},v=async()=>{try{if(!g.value.trim()){alert("Please enter a document title");return}const k=r.addAdditionalDocument(g.value.trim());p.value=!1,g.value=""}catch(k){alert(k.message)}},T=async(k,S)=>{const E=k.target.files[0]||null;if(E){const m=ol(E,{allowedTypes:["pdf"],maxSize:10485760,fieldName:"Additional Document"});if(!m.isValid){alert(m.error),k.target.value="";return}const A=Hr(E.name);if(!A.isSafe){alert(`File name contains potentially dangerous content: ${A.threats.join(", ")}`),k.target.value="";return}try{if(l.value=S,!u.value)throw new Error("Student ID is required for secure file upload");const I=await s(E,u.value),C=r.form.additionalDocuments.find(F=>F.id===S);C&&Object.assign(C,{pdfUrl:I,fileName:E.name,uploadDate:new Date().toISOString()}),console.log(` Additional document uploaded: ${I}`)}catch(I){console.error("Additional document upload failed:",I),alert(`Failed to upload PDF: ${I.message}`)}finally{l.value=null,k.target.value=""}}},D=async k=>{try{if(!k.pdfUrl||!u.value)throw new Error("File not found or student ID missing");await i(k.pdfUrl,u.value,k.fileName)}catch(S){console.error("Additional document download failed:",S),alert(`Failed to download PDF: ${S.message}`)}};return(k,S)=>(M(),B("fieldset",wH,[S[29]||(S[29]=d("legend",null,"Documents",-1)),d("div",CH,[d("label",null,[S[14]||(S[14]=we(" BIP: ")),d("input",{type:"file",accept:"application/pdf",onChange:S[0]||(S[0]=E=>f(E,"bipFile"))},null,32),t.form.bipPdfUrl&&!t.form.removeBipFile?(M(),B("span",IH,[S[10]||(S[10]=we(" Current: ")),d("a",{href:"#",onClick:S[1]||(S[1]=Yr(E=>h("bip"),["prevent"])),target:"_blank"},"View BIP"),d("button",{type:"button",onClick:S[2]||(S[2]=(...E)=>t.removeBipFile&&t.removeBipFile(...E)),class:"btn-remove"},[Re(q(qo),{size:16}),S[9]||(S[9]=we(" Remove "))])])):ve("",!0),t.form.removeBipFile?(M(),B("span",kH,[S[12]||(S[12]=we(" BIP file will be removed ")),d("button",{type:"button",onClick:S[3]||(S[3]=E=>t.form.removeBipFile=!1),class:"btn-undo"},[Re(q(P0),{size:16}),S[11]||(S[11]=we(" Undo "))])])):ve("",!0),q(a)&&l.value==="bip"?(M(),B("div",DH,[Re(q(pc),{size:16,class:"loading-spinner"}),S[13]||(S[13]=d("strong",null,"Loading... Uploading BIP document...",-1))])):ve("",!0),q(o)?(M(),B("div",PH,Q(q(o)),1)):ve("",!0)])]),d("div",RH,[d("label",null,[S[20]||(S[20]=we(" At-A-Glance PDF: ")),d("input",{type:"file",accept:"application/pdf",onChange:S[4]||(S[4]=E=>f(E,"ataglanceFile"))},null,32),t.form.ataglancePdfUrl&&!t.form.removeAtaglanceFile?(M(),B("span",FH,[S[16]||(S[16]=we(" Current: ")),d("a",{href:"#",onClick:S[5]||(S[5]=Yr(E=>h("ataglance"),["prevent"])),target:"_blank"},"View At-A-Glance"),d("button",{type:"button",onClick:S[6]||(S[6]=(...E)=>t.removeAtaglanceFile&&t.removeAtaglanceFile(...E)),class:"btn-remove"},[Re(q(qo),{size:16}),S[15]||(S[15]=we(" Remove "))])])):ve("",!0),t.form.removeAtaglanceFile?(M(),B("span",NH,[S[18]||(S[18]=we(" At-A-Glance file will be removed ")),d("button",{type:"button",onClick:S[7]||(S[7]=E=>t.form.removeAtaglanceFile=!1),class:"btn-undo"},[Re(q(P0),{size:16}),S[17]||(S[17]=we(" Undo "))])])):ve("",!0),q(a)&&l.value==="ataglance"?(M(),B("div",OH,[Re(q(pc),{size:16,class:"loading-spinner"}),S[19]||(S[19]=d("strong",null,"Loading... Uploading At-A-Glance document...",-1))])):ve("",!0)])]),d("div",MH,[d("div",LH,[S[21]||(S[21]=d("h4",null,"Additional Documents",-1)),d("span",BH,Q(y.value.length)+"/8 max",1)]),(M(!0),B(ke,null,He(y.value,E=>(M(),B("div",{key:E.id,class:"document-section additional-doc"},[d("div",UH,[Re(q(qu),{size:16,class:"doc-icon"}),d("span",$H,Q(E.title),1)]),!E.pdfUrl&&!E.toRemove?(M(),B("div",VH,[d("input",{type:"file",accept:"application/pdf",onChange:m=>T(m,E.id),class:"additional-doc-input"},null,40,HH)])):ve("",!0),E.pdfUrl&&!E.toRemove?(M(),B("span",jH,[S[23]||(S[23]=we(" Current: ")),d("a",{href:"#",onClick:Yr(m=>D(E),["prevent"]),target:"_blank"},"View "+Q(E.title),9,GH),d("button",{type:"button",onClick:m=>t.removeAdditionalDocument(E.id),class:"btn-remove"},[Re(q(qo),{size:16}),S[22]||(S[22]=we(" Remove "))],8,WH)])):ve("",!0),E.toRemove?(M(),B("span",zH,[we(Q(E.title)+" will be removed ",1),d("button",{type:"button",onClick:m=>t.undoRemoveAdditionalDocument(E.id),class:"btn-undo"},[Re(q(P0),{size:16}),S[24]||(S[24]=we(" Undo "))],8,KH)])):ve("",!0),q(a)&&l.value===E.id?(M(),B("div",qH,[Re(q(pc),{size:16,class:"loading-spinner"}),d("strong",null,"Loading... Uploading "+Q(E.title)+"...",1)])):ve("",!0)]))),128)),_.value?(M(),B("div",XH,[p.value?ve("",!0):(M(),B("div",YH,[d("button",{type:"button",onClick:x,class:"btn-add-document"},[Re(q(Wb),{size:16}),S[25]||(S[25]=we(" Add Document "))])])),p.value?(M(),B("div",QH,[d("div",JH,[S[26]||(S[26]=d("label",{for:"newDocTitle"},"Document Title (max 24 characters):",-1)),Oe(d("input",{id:"newDocTitle",type:"text","onUpdate:modelValue":S[8]||(S[8]=E=>g.value=E),maxlength:"24",placeholder:"Enter document title...",class:"title-input",onKeyup:F1(v,["enter"])},null,544),[[ht,g.value]]),d("span",ZH,Q(g.value.length)+"/24",1)]),d("div",ej,[d("button",{type:"button",onClick:v,disabled:!g.value.trim(),class:"btn-confirm"},[Re(q(Wb),{size:16}),S[27]||(S[27]=we(" Add "))],8,tj),d("button",{type:"button",onClick:b,class:"btn-cancel"}," Cancel ")])])):ve("",!0)])):ve("",!0),_.value?ve("",!0):(M(),B("div",rj,S[28]||(S[28]=[d("span",null,"Maximum of 10 documents reached (including BIP and At-A-Glance)",-1)])))])]))}},sj=St(nj,[["__scopeId","data-v-039d1d4d"]]),aj={class:"form-col"},ij={class:"inner-grid-2"},oj={__name:"StudentAccommodations",props:{form:{type:Object,required:!0}},setup(t){return(e,r)=>(M(),B("fieldset",aj,[r[4]||(r[4]=En('<legend data-v-5fdc1bd2>Accommodations</legend><div class="formatting-help" data-v-5fdc1bd2><p data-v-5fdc1bd2><strong data-v-5fdc1bd2> Tip:</strong> Text will display as separate list items in the student table when separated by:</p><ul class="format-examples" data-v-5fdc1bd2><li data-v-5fdc1bd2><code data-v-5fdc1bd2>New line</code> (Enter key)</li><li data-v-5fdc1bd2><code data-v-5fdc1bd2>- </code> (dash + space)</li><li data-v-5fdc1bd2><code data-v-5fdc1bd2>;</code> (semicolon)</li><li data-v-5fdc1bd2><code data-v-5fdc1bd2>1. 2. 3.</code> (numbers + period + space)</li></ul><p class="example" data-v-5fdc1bd2><strong data-v-5fdc1bd2>Example:</strong> &quot;at-a-glance&quot; = 1 item | &quot;at - a - glance&quot; = 3 items </p></div>',2)),d("div",ij,[d("label",null,[r[2]||(r[2]=we(" Instruction: ")),Oe(d("textarea",{"onUpdate:modelValue":r[0]||(r[0]=n=>t.form.instruction=n),placeholder:"Enter instructional accommodations..."},null,512),[[ht,t.form.instruction]])]),d("label",null,[r[3]||(r[3]=we(" Assessment: ")),Oe(d("textarea",{"onUpdate:modelValue":r[1]||(r[1]=n=>t.form.assessment=n),placeholder:"Enter assessment accommodations..."},null,512),[[ht,t.form.assessment]])])])]))}},lj=St(oj,[["__scopeId","data-v-5fdc1bd2"]]),cj={class:"flags-section"},uj={class:"flags-container"},dj={class:"checkbox-label"},fj={class:"checkbox-label"},hj={class:"flags-section"},pj={class:"new-flag"},mj={class:"flag-colors"},gj={class:"color-option"},vj={class:"color-option"},yj={class:"color-option"},xj=["disabled"],Ej={key:0,class:"current-flags"},bj={class:"flag-text"},_j=["onClick"],Sj={key:1,class:"no-flags"},Aj={__name:"StudentFlags",props:{form:{type:Object,required:!0}},setup(t){const e=t;e.form.app||(e.form.app={}),e.form.app.flags||(e.form.app.flags={}),e.form.app.flags.customFlags||(e.form.app.flags.customFlags=[]);const r=_e({get:()=>{var o,l;return((l=(o=e.form.app)==null?void 0:o.flags)==null?void 0:l.customFlags)||[]},set:o=>{e.form.app||(e.form.app={}),e.form.app.flags||(e.form.app.flags={}),e.form.app.flags.customFlags=o}}),n=As({text:"",color:"red"}),s=_e(()=>n.text.trim().length>0&&n.text.length<=50),i=()=>{var c;if(!s.value)return;const o=uo(),l={color:n.color,text:n.text.trim(),createdAt:new Date().toISOString(),createdBy:((c=o.currentUser)==null?void 0:c.uid)||"system"};r.value=[...r.value,l],n.text="",n.color="red"},a=o=>{const l=[...r.value];l.splice(o,1),r.value=l};return(o,l)=>(M(),B("fieldset",null,[l[16]||(l[16]=d("legend",null,"Flags",-1)),d("div",cj,[l[8]||(l[8]=d("h4",null,"System Flags",-1)),d("div",uj,[d("label",dj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=c=>t.form.flag1=c)},null,512),[[_t,t.form.flag1]]),l[6]||(l[6]=we(" Preferential seating "))]),d("label",fj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":l[1]||(l[1]=c=>t.form.flag2=c)},null,512),[[_t,t.form.flag2]]),l[7]||(l[7]=we(" Separate setting "))])])]),d("div",hj,[l[15]||(l[15]=d("h4",null,"Custom Flags",-1)),d("div",pj,[Oe(d("input",{"onUpdate:modelValue":l[2]||(l[2]=c=>n.text=c),maxlength:50,placeholder:"Enter flag note (max 50 chars)",class:"flag-input"},null,512),[[ht,n.text]]),d("div",mj,[d("label",gj,[Oe(d("input",{type:"radio",value:"blue","onUpdate:modelValue":l[3]||(l[3]=c=>n.color=c)},null,512),[[Ss,n.color]]),l[9]||(l[9]=d("span",{class:"color-dot blue"},null,-1)),l[10]||(l[10]=we(" Info "))]),d("label",vj,[Oe(d("input",{type:"radio",value:"yellow","onUpdate:modelValue":l[4]||(l[4]=c=>n.color=c)},null,512),[[Ss,n.color]]),l[11]||(l[11]=d("span",{class:"color-dot yellow"},null,-1)),l[12]||(l[12]=we(" Caution "))]),d("label",yj,[Oe(d("input",{type:"radio",value:"red","onUpdate:modelValue":l[5]||(l[5]=c=>n.color=c)},null,512),[[Ss,n.color]]),l[13]||(l[13]=d("span",{class:"color-dot red"},null,-1)),l[14]||(l[14]=we(" Alert "))])]),d("button",{type:"button",onClick:i,disabled:!s.value,class:"add-flag-btn"}," Add Flag ",8,xj)]),r.value.length?(M(),B("ul",Ej,[(M(!0),B(ke,null,He(r.value,(c,u)=>(M(),B("li",{key:u,class:Ye([c.color,"flag-item"])},[d("span",{class:Ye(["color-dot",c.color])},null,2),d("span",bj,Q(c.text),1),d("button",{type:"button",class:"remove-flag",onClick:f=>a(u),title:"Remove flag"},"",8,_j)],2))),128))])):ve("",!0),r.value.length?ve("",!0):(M(),B("div",Sj," No custom flags added yet "))])]))}},Tj=St(Aj,[["__scopeId","data-v-6a7a6f60"]]),wj={class:"dialog-backdrop"},Cj={class:"dialog"},Ij=["disabled"],kj={__name:"StudentForm",props:{student:{type:Object,default:()=>({})},users:{type:Object,required:!0},mode:{type:String,default:"new"}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{form:s,isSaving:i,appSettings:a,appSettingsLoading:o,appSettingsError:l,periods:c,gradeOptions:u,availableClassServices:f,serviceProviders:h,customServiceProviders:p,userRoles:g,onFileChange:y,removeBipFile:_,removeAtaglanceFile:x,addAdditionalDocument:b,removeAdditionalDocument:v,undoRemoveAdditionalDocument:T,deleteAdditionalDocument:D,providerFieldMap:k,getProviderLabel:S,getProviderUsers:E,handleSubmit:m}=LV(r,n),A=se(!1),I=_e(()=>i.value||A.value),C=_e(()=>A.value?"Loading files...":i.value?"Saving...":r.mode==="edit"?"Save":"Add Student"),F=W=>{A.value=W};return(W,P)=>(M(),B("div",wj,[d("div",Cj,[d("header",null,[d("h2",null,Q(t.mode==="edit"?"Edit Student":"Add Student"),1),d("button",{onClick:P[0]||(P[0]=R=>W.$emit("close")),class:"close-btn"},"")]),d("form",{onSubmit:P[2]||(P[2]=Yr((...R)=>q(m)&&q(m)(...R),["prevent"])),id:"student-form"},[Re(GV,{form:q(s),mode:t.mode,"grade-options":q(u),"user-roles":q(g)},null,8,["form","mode","grade-options","user-roles"]),Re(cH,{form:q(s),periods:q(c),"user-roles":q(g),"app-settings":q(a)},null,8,["form","periods","user-roles","app-settings"]),Re(xH,{form:q(s),"available-class-services":q(f),"app-settings-loading":q(o),"app-settings-error":q(l)},null,8,["form","available-class-services","app-settings-loading","app-settings-error"]),Re(TH,{form:q(s),"service-providers":q(h),"custom-service-providers":q(p),"provider-field-map":q(k),"get-provider-label":q(S),"get-provider-users":q(E)},null,8,["form","service-providers","custom-service-providers","provider-field-map","get-provider-label","get-provider-users"]),Re(sj,{form:q(s),student:t.student,mode:t.mode,"on-file-change":q(y),"remove-bip-file":q(_),"remove-ataglance-file":q(x),"add-additional-document":q(b),"remove-additional-document":q(v),"undo-remove-additional-document":q(T),"delete-additional-document":q(D),onLoadingChange:F},null,8,["form","student","mode","on-file-change","remove-bip-file","remove-ataglance-file","add-additional-document","remove-additional-document","undo-remove-additional-document","delete-additional-document"]),Re(lj,{form:q(s)},null,8,["form"]),Re(Tj,{form:q(s)},null,8,["form"]),d("footer",null,[d("button",{type:"button",onClick:P[1]||(P[1]=R=>W.$emit("close")),class:"btn btn-secondary"}," Cancel "),d("button",{type:"submit",class:"btn btn-primary",disabled:I.value},Q(C.value),9,Ij)])],32)])]))}},ix=St(kj,[["__scopeId","data-v-f69b1564"]]),Dj={key:0},Pj={key:1,class:"loading-dialog"},Rj={__name:"StudentEditDialog",props:{studentId:{type:String,required:!0},users:{type:Object,required:!0}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{students:s}=Di(),i=_e(()=>{const o=s.value.find(l=>l.id===r.studentId);return console.log("StudentEditDialog - studentId:",r.studentId),console.log("StudentEditDialog - found student:",o),console.log("StudentEditDialog - students count:",s.value.length),o||{}});function a(o){console.log("StudentEditDialog - student saved:",o),n("saved",o)}return(o,l)=>i.value&&Object.keys(i.value).length>0?(M(),B("div",Dj,[Re(ix,{student:i.value,users:t.users,mode:"edit",onClose:l[0]||(l[0]=c=>o.$emit("close")),onSaved:a},null,8,["student","users"])])):(M(),B("div",Pj,l[1]||(l[1]=[d("div",{class:"dialog"},[d("header",null,[d("h2",null,"Loading Student Data...")]),d("div",{class:"content"},[d("p",null,"Please wait while we load the student information.")])],-1)])))}},Fj=St(Rj,[["__scopeId","data-v-dea0919d"]]),Nj={class:"dialog-backdrop"},Oj={class:"dialog"},Mj={class:"button-group"},Lj={key:0,class:"selected-recipients"},Bj={class:"recipients-header"},Uj={class:"recipients-list"},$j={key:0,class:"recipients-note"},Vj={key:1,class:"members-list"},Hj={key:0,class:"email"},jj=["value"],Gj={key:2,class:"update-categories"},Wj={class:"checkbox-group"},zj={class:"checkbox-item"},Kj={class:"checkbox-item"},qj={class:"checkbox-item"},Xj={class:"checkbox-item"},Yj={class:"checkbox-item"},Qj={class:"checkbox-item"},Jj={class:"checkbox-item"},Zj=["disabled"],eG={key:0,class:"no-docs"},tG=["disabled"],rG=["disabled"],nG={__name:"StudentsEmailDialog",props:{student:{type:Object,required:!0},userMap:{type:Object,required:!0},currentUser:{type:Object,required:!1}},emits:["close"],setup(t,{emit:e}){const r=t,{student:n,userMap:s}=r,i=e,{appSettings:a}=Ts(),o=_e(()=>{var W;return((W=a.value.gmailApi)==null?void 0:W.enabled)??!1}),l=async W=>{try{await navigator.clipboard.writeText(W),u()}catch(P){console.error("Failed to copy:",P),alert("Failed to copy to clipboard. Please copy the email addresses manually.")}},c=se(!1),u=()=>{c.value=!0,setTimeout(()=>{c.value=!1},2e3)},f=se(""),h=se([]),p=se({studentInfo:!1,meetingDates:!1,services:!1,schedule:!1,instructionAccommodations:!1,assessmentAccommodations:!1,documents:!1}),g=_e(()=>{var P,R;if((R=(P=n.app)==null?void 0:P.schedule)!=null&&R.periods){const N=[];return Object.values(n.app.schedule.periods).forEach(L=>{var V;const O=typeof L=="string"?L:L==null?void 0:L.teacherId;O&&N.push(O),(V=L==null?void 0:L.coTeaching)!=null&&V.caseManagerId&&N.push(L.coTeaching.caseManagerId)}),N}const W=n.schedule||{};return Object.values(W).filter(Boolean)}),y=_e(()=>[...new Set(g.value)]),_=_e(()=>{var P;const W=[];(P=n.app)!=null&&P.providers&&Object.entries(n.app.providers).forEach(([R,N])=>{N&&!["caseManagerId"].includes(R)&&W.push(N)});for(const R in n)R.endsWith("_id")&&!["casemanager_id","caseManagerId"].includes(R)&&n[R]&&W.push(n[R]);return[...new Set(W)].filter(R=>!y.value.includes(R))}),x=_e(()=>y.value.map(W=>({id:W,...s[W]||{}})).filter(W=>W&&W.email)),b=_e(()=>_.value.map(W=>({id:W,...s[W]||{}})).filter(W=>W&&W.email)),v=_e(()=>{var R,N,L,O;const W=((N=(R=n.app)==null?void 0:R.studentData)==null?void 0:N.caseManagerId)||((O=(L=n.app)==null?void 0:L.providers)==null?void 0:O.caseManagerId)||n.caseManagerId||n.casemanager_id;if(!W)return null;const P=s[W];return P&&P.email?{id:W,...P}:null}),T=_e(()=>{const W=[...x.value,...b.value];return v.value&&(W.map(R=>R.id).includes(v.value.id)||W.push(v.value)),W}),D=_e(()=>{var W;return(W=r.currentUser)==null?void 0:W.uid});_e(()=>{var P;const W=(P=r.currentUser)==null?void 0:P.role;return["paraeducator","staff_view","teacher"].includes(W)});const k=_e(()=>{var R,N,L,O,V;const W=(R=r.currentUser)==null?void 0:R.uid,P=((L=(N=n.app)==null?void 0:N.studentData)==null?void 0:L.caseManagerId)||((V=(O=n.app)==null?void 0:O.providers)==null?void 0:V.caseManagerId)||n.caseManagerId||n.casemanager_id;return W&&P&&W===P}),S=_e(()=>x.value.filter(W=>W.id!==D.value)),E=_e(()=>b.value.filter(W=>W.id!==D.value)),m=_e(()=>T.value.filter(W=>W.id!==D.value)),A=_e(()=>{var W,P,R,N;return!!((P=(W=n.app)==null?void 0:W.documents)!=null&&P.ataglancePdfUrl||(N=(R=n.app)==null?void 0:R.documents)!=null&&N.bipPdfUrl||n.ataglancePdfUrl||n.ataglance_pdf_url||n.bipPdfUrl||n.bip_pdf_url)}),I=_e(()=>f.value?f.value==="Individual"?h.value.length>0:!0:!1),C=_e(()=>{let W=[];return f.value==="Teachers"?W=S.value:f.value==="TeachersAndService"?W=[...S.value,...E.value]:f.value==="CaseManager"?W=v.value?[v.value]:[]:f.value==="Individual"&&(W=m.value.filter(P=>h.value.includes(P.id))),W.map(P=>P.email).filter(Boolean).join(",")});async function F(){var j,ee,ae,ne,le,Z,J,ge;if(!o.value){alert('Gmail API features are disabled. Please use the "Copy Email Addresses" button instead.');return}if(!C.value){alert("No email addresses found for the selected recipients.");return}console.log(" Student data for email:",{student:n,firstName:n.firstName,first_name:n.first_name,lastName:n.lastName,last_name:n.last_name,appStudentData:(j=n.app)==null?void 0:j.studentData});const W=n.firstName||n.first_name||((ae=(ee=n.app)==null?void 0:ee.studentData)==null?void 0:ae.firstName)||((ne=n.app)==null?void 0:ne.firstName)||"",P=n.lastName||n.last_name||((Z=(le=n.app)==null?void 0:le.studentData)==null?void 0:Z.lastName)||((J=n.app)==null?void 0:J.lastName)||"";console.log(" Extracted names:",{firstName:W,lastName:P});const R=`${W} ${P}`.trim()||"Student",N=(((W==null?void 0:W[0])||"")+((P==null?void 0:P[0])||"")).toUpperCase()||"ST";console.log(" Final values:",{fullName:R,initials:N});const L=Object.values(p.value).some(te=>te),O=L?`${N} - Student Update`:`${N} - Student Inquiry`;let V="";if(L){V+=`Hi team,

`,V+=`${R}'s student profile has been updated in the CaseManage app.

`,V+=`Update Summary:
`,p.value.studentInfo&&(V+=` Student data has been updated
`),p.value.documents&&(V+=` Documents have been updated and are available
`),p.value.schedule&&(V+=` Schedule details have been updated
`),p.value.instructionAccommodations&&(V+=` Instruction accommodations have been updated
`),p.value.assessmentAccommodations&&(V+=` Assessment accommodations have been updated
`),p.value.services&&(V+=` Services have been updated
`),p.value.meetingDates&&(V+=` Meeting dates have been updated
`),V+=`
`,V+=`Please reach out if you have any questions.

`,V+=`To access the updated confidential information and documents:
`,V+=`Log into the CaseManage app: ${window.location.origin}
`,V+=`Navigate to the student's record to view the updates. Authentication is required.

`;const te=v.value&&(`${v.value.firstName||""} ${v.value.lastName||""}`.trim()||v.value.displayName||v.value.email)||"Case Manager";te&&te!=="Case Manager"?V+=`For questions please contact the Case Manager (${te}) directly.
`:V+=`For questions please contact the Case Manager directly.
`}else V=`Hi team,

I have a question regarding ${R}.

Please reach out if you need any additional information.

Thank you!`;console.log(" Email composition:",{subject:O,body:V});const z=(ge=r.currentUser)==null?void 0:ge.email;if(!z){console.error(" No user email found in props.currentUser:",r.currentUser),alert("Unable to send email: User email not found. Please contact your administrator.");return}console.log(" User work email:",z);const U=`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(C.value)}&su=${encodeURIComponent(O)}&body=${encodeURIComponent(V)}`;if(!confirm(`IMPORTANT: Security Check

This email MUST be sent from your school account: ${z}

Please confirm:
1. You are signed into Gmail with ${z}
2. You are NOT signed into any other Gmail accounts

Click OK only if you are using your school account.
Click Cancel to open Gmail and switch accounts.`)){window.open("https://mail.google.com","_blank","noopener");return}window.open(U,"_blank","noopener"),console.log(" Gmail compose window opened"),i("close")}return(W,P)=>(M(),B("div",Nj,[d("div",Oj,[d("header",null,[d("h2",null,"Email about "+Q(q(n).firstName||q(n).first_name)+" "+Q(q(n).lastName||q(n).last_name),1),d("button",{onClick:P[0]||(P[0]=R=>W.$emit("close")),title:"Close"},"")]),d("main",null,[d("form",{onSubmit:P[14]||(P[14]=Yr(()=>{},["prevent"]))},[d("div",Mj,[v.value?(M(),B("button",{key:0,type:"button",class:Ye(["option-button",{active:f.value==="CaseManager"}]),onClick:P[1]||(P[1]=R=>f.value="CaseManager")}," Case Manager ",2)):ve("",!0),d("button",{type:"button",class:Ye(["option-button",{active:f.value==="Teachers"}]),onClick:P[2]||(P[2]=R=>f.value="Teachers")}," Teachers ",2),d("button",{type:"button",class:Ye(["option-button",{active:f.value==="TeachersAndService"}]),onClick:P[3]||(P[3]=R=>f.value="TeachersAndService")}," Teachers and service providers ",2),d("button",{type:"button",class:Ye(["option-button",{active:f.value==="Individual"}]),onClick:P[4]||(P[4]=R=>f.value="Individual")}," Individual member of the IEP team ",2)]),C.value?(M(),B("div",Lj,[d("div",Bj,[P[17]||(P[17]=d("h4",null,"Selected Recipients:",-1)),o.value?ve("",!0):(M(),B("button",{key:0,type:"button",class:Ye(["copy-button",{copied:c.value}]),onClick:P[5]||(P[5]=R=>l(C.value))},Q(c.value?"Copied!":"Copy All"),3))]),d("div",Uj,Q(C.value),1),o.value?ve("",!0):(M(),B("div",$j,P[18]||(P[18]=[d("p",null,"Note: Gmail API features are not enabled. You can copy these email addresses to use in your email client.",-1)])))])):ve("",!0),f.value==="Individual"?(M(),B("div",Vj,[P[19]||(P[19]=d("div",null,"Select members:",-1)),(M(!0),B(ke,null,He(m.value,R=>(M(),B("div",{key:R.id},[d("label",null,[d("span",null,[we(Q(R.name||R.displayName||R.email||R.id)+" ",1),R.email?(M(),B("span",Hj,"("+Q(R.email)+")",1)):ve("",!0)]),Oe(d("input",{type:"checkbox",value:R.id,"onUpdate:modelValue":P[6]||(P[6]=N=>h.value=N)},null,8,jj),[[_t,h.value]])])]))),128))])):ve("",!0),k.value?(M(),B("div",Gj,[P[27]||(P[27]=d("h4",null,"Select what has been updated:",-1)),d("div",Wj,[d("div",zj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":P[7]||(P[7]=R=>p.value.studentInfo=R)},null,512),[[_t,p.value.studentInfo]]),P[20]||(P[20]=d("label",null,"Student information",-1))]),d("div",Kj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":P[8]||(P[8]=R=>p.value.meetingDates=R)},null,512),[[_t,p.value.meetingDates]]),P[21]||(P[21]=d("label",null,"Meeting dates",-1))]),d("div",qj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":P[9]||(P[9]=R=>p.value.services=R)},null,512),[[_t,p.value.services]]),P[22]||(P[22]=d("label",null,"Services",-1))]),d("div",Xj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":P[10]||(P[10]=R=>p.value.schedule=R)},null,512),[[_t,p.value.schedule]]),P[23]||(P[23]=d("label",null,"Schedule",-1))]),d("div",Yj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":P[11]||(P[11]=R=>p.value.instructionAccommodations=R)},null,512),[[_t,p.value.instructionAccommodations]]),P[24]||(P[24]=d("label",null,"Instruction accommodations",-1))]),d("div",Qj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":P[12]||(P[12]=R=>p.value.assessmentAccommodations=R)},null,512),[[_t,p.value.assessmentAccommodations]]),P[25]||(P[25]=d("label",null,"Assessment accommodations",-1))]),d("div",Jj,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":P[13]||(P[13]=R=>p.value.documents=R),disabled:!A.value},null,8,Zj),[[_t,p.value.documents]]),d("label",null,[P[26]||(P[26]=we(" Documents ")),A.value?ve("",!0):(M(),B("span",eG,"(No docs available)"))])])])])):ve("",!0)],32)]),d("footer",null,[d("button",{onClick:P[15]||(P[15]=R=>W.$emit("close"))},"Cancel"),o.value?(M(),B("button",{key:0,disabled:!I.value,onClick:F},"Send Email",8,tG)):(M(),B("button",{key:1,disabled:!I.value,onClick:P[16]||(P[16]=R=>l(C.value))},Q(c.value?"Copied!":"Copy Email Addresses"),9,rG))])])]))}},sG=St(nG,[["__scopeId","data-v-d498c3e5"]]),aG={class:"dialog-backdrop"},iG={class:"dialog"},oG={class:"field-groups"},lG={class:"field-group"},cG={class:"field-group"},uG={class:"field-group"},dG={class:"field-group"},fG={class:"field-group"},hG={class:"field-group"},pG=["disabled"],mG={__name:"ExportDialog",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})}},emits:["close"],setup(t,{emit:e}){const r=t,n=e,s=Qr(),i=Qy(),a=se({studentData:{firstName:!0,lastName:!0,grade:!0,plan:!0,caseManagerId:!0},dates:{reviewDate:!0,reevalDate:!0,meetingDate:!0},providers:{all:!0},accommodations:{instruction:!0,assessment:!0},schedule:{periods:!0,classServices:!0},documents:{ataglancePdfUrl:!0,bipPdfUrl:!0}}),o=["speechId","otId","mhId","ptId","scId","trId","audId","viId","atId","dhhId","omId","bisId","hnId","swId"],l=_e(()=>Object.values(a.value).some(_=>Object.values(_).some(x=>x)));function c(_){if(!_||!r.userMap[_])return"";const x=r.userMap[_];return x.name||x.email||""}function u(_){const x=i.userPermissions||[];return Array.isArray(x)&&x.includes(_)}function f(){Object.keys(a.value).forEach(_=>{Object.keys(a.value[_]).forEach(x=>{a.value[_][x]=!0})})}function h(){Object.keys(a.value).forEach(_=>{Object.keys(a.value[_]).forEach(x=>{a.value[_][x]=!1})})}function p(_){var T,D,k,S,E,m,A,I,C,F,W,P,R,N,L,O,V,z,U,G,j,ee,ae,ne,le,Z,J,ge,te,K,Y,fe;const x=s.currentUser;if((x==null?void 0:x.role)==="admin"||(x==null?void 0:x.role)==="administrator"||(x==null?void 0:x.role)==="staff_view"||(x==null?void 0:x.role)==="sped_chair"||(x==null?void 0:x.role)==="administrator_504_CM"||(x==null?void 0:x.role)==="admin_504")return g(_);const v={};return a.value.studentData.firstName&&(v.firstName=(D=(T=_.app)==null?void 0:T.studentData)==null?void 0:D.firstName),a.value.studentData.lastName&&(v.lastName=(S=(k=_.app)==null?void 0:k.studentData)==null?void 0:S.lastName),a.value.studentData.grade&&(v.grade=(m=(E=_.app)==null?void 0:E.studentData)==null?void 0:m.grade),a.value.studentData.plan&&(v.plan=(I=(A=_.app)==null?void 0:A.studentData)==null?void 0:I.plan),a.value.studentData.caseManagerId&&(v.caseManagerId=(F=(C=_.app)==null?void 0:C.studentData)==null?void 0:F.caseManagerId),u("view_student_dates")&&(a.value.dates.reviewDate&&(v.reviewDate=(P=(W=_.app)==null?void 0:W.dates)==null?void 0:P.reviewDate),a.value.dates.reevalDate&&(v.reevalDate=(N=(R=_.app)==null?void 0:R.dates)==null?void 0:N.reevalDate),a.value.dates.meetingDate&&(v.meetingDate=(O=(L=_.app)==null?void 0:L.dates)==null?void 0:O.meetingDate)),(u("view_service_providers")||((z=(V=_.app)==null?void 0:V.studentData)==null?void 0:z.caseManagerId)===(x==null?void 0:x.uid)||o.some(ye=>{var ie,ue;return((ue=(ie=_.app)==null?void 0:ie.providers)==null?void 0:ue[ye])===(x==null?void 0:x.uid)}))&&a.value.providers.all&&o.forEach(ye=>{var ie,ue;v[ye]=(ue=(ie=_.app)==null?void 0:ie.providers)==null?void 0:ue[ye]}),u("view_accommodations")&&(a.value.accommodations.instruction&&(v.instruction=(G=(U=_.app)==null?void 0:U.accommodations)==null?void 0:G.instruction),a.value.accommodations.assessment&&(v.assessment=(ee=(j=_.app)==null?void 0:j.accommodations)==null?void 0:ee.assessment)),(u("view_schedule")||Object.values(((ne=(ae=_.app)==null?void 0:ae.schedule)==null?void 0:ne.periods)||{}).includes(x==null?void 0:x.uid))&&(a.value.schedule.periods&&(v.schedule=(Z=(le=_.app)==null?void 0:le.schedule)==null?void 0:Z.periods),a.value.schedule.classServices&&(v.classServices=(ge=(J=_.app)==null?void 0:J.schedule)==null?void 0:ge.classServices)),u("view_documents")&&(a.value.documents.ataglancePdfUrl&&(v.ataglancePdfUrl=(K=(te=_.app)==null?void 0:te.documents)==null?void 0:K.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(v.bipPdfUrl=(fe=(Y=_.app)==null?void 0:Y.documents)==null?void 0:fe.bipPdfUrl)),v}function g(_){var b,v,T,D,k,S,E,m,A,I,C,F,W,P,R,N,L,O,V,z,U,G,j,ee,ae,ne,le,Z;const x={};return a.value.studentData.firstName&&(x.firstName=(v=(b=_.app)==null?void 0:b.studentData)==null?void 0:v.firstName),a.value.studentData.lastName&&(x.lastName=(D=(T=_.app)==null?void 0:T.studentData)==null?void 0:D.lastName),a.value.studentData.grade&&(x.grade=(S=(k=_.app)==null?void 0:k.studentData)==null?void 0:S.grade),a.value.studentData.plan&&(x.plan=(m=(E=_.app)==null?void 0:E.studentData)==null?void 0:m.plan),a.value.studentData.caseManagerId&&(x.caseManagerId=(I=(A=_.app)==null?void 0:A.studentData)==null?void 0:I.caseManagerId),a.value.dates.reviewDate&&(x.reviewDate=(F=(C=_.app)==null?void 0:C.dates)==null?void 0:F.reviewDate),a.value.dates.reevalDate&&(x.reevalDate=(P=(W=_.app)==null?void 0:W.dates)==null?void 0:P.reevalDate),a.value.dates.meetingDate&&(x.meetingDate=(N=(R=_.app)==null?void 0:R.dates)==null?void 0:N.meetingDate),a.value.providers.all&&o.forEach(J=>{var ge,te;x[J]=(te=(ge=_.app)==null?void 0:ge.providers)==null?void 0:te[J]}),a.value.accommodations.instruction&&(x.instruction=(O=(L=_.app)==null?void 0:L.accommodations)==null?void 0:O.instruction),a.value.accommodations.assessment&&(x.assessment=(z=(V=_.app)==null?void 0:V.accommodations)==null?void 0:z.assessment),a.value.schedule.periods&&(x.schedule=(G=(U=_.app)==null?void 0:U.schedule)==null?void 0:G.periods),a.value.schedule.classServices&&(x.classServices=(ee=(j=_.app)==null?void 0:j.schedule)==null?void 0:ee.classServices),a.value.documents.ataglancePdfUrl&&(x.ataglancePdfUrl=(ne=(ae=_.app)==null?void 0:ae.documents)==null?void 0:ne.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(x.bipPdfUrl=(Z=(le=_.app)==null?void 0:le.documents)==null?void 0:Z.bipPdfUrl),x}function y(){const _=r.students.map(E=>p(E)),x=[],b=[],v={firstName:"First Name",lastName:"Last Name",grade:"Grade",plan:"Plan Type",caseManagerId:"Case Manager",reviewDate:"Plan Review",reevalDate:"Reevaluation",meetingDate:"Meeting Date",speechId:"Speech",otId:"OT",mhId:"Mental Health",ptId:"PT",scId:"SC",trId:"TR",audId:"Audiology",viId:"Vision",atId:"AT",dhhId:"DHH",omId:"O&M",bisId:"BIS",hnId:"HN",swId:"SW",instruction:"Instructional Accommodation",assessment:"Assessment Accommodations",schedule:"Schedule",classServices:"Class Services",ataglancePdfUrl:"At-A-Glance",bipPdfUrl:"BIP"};Object.entries(a.value).forEach(([E,m])=>{Object.entries(m).forEach(([A,I])=>{I&&(A==="all"?o.forEach(C=>{x.push(v[C])}):x.push(v[A]))})}),_.forEach(E=>{const m=[];Object.entries(a.value).forEach(([A,I])=>{Object.entries(I).forEach(([C,F])=>{if(F)if(C==="all")o.forEach(W=>{const P=E[W]||"";m.push(P?c(P):"")});else{let W=E[C]||"";C.endsWith("Id")?W=W?c(W):"":C==="classServices"?W=Array.isArray(E.classServices)?E.classServices.join(", "):"":C==="schedule"&&(W=E.schedule?Object.entries(E.schedule).map(([P,R])=>`${P}: ${c(R)}`).join("; "):""),m.push(W)}})}),b.push(m)});const T=[x.join(","),...b.map(E=>E.map(m=>`"${String(m).replace(/"/g,'""')}"`).join(","))].join(`
`),D=new Blob([T],{type:"text/csv"}),k=window.URL.createObjectURL(D),S=document.createElement("a");S.href=k,S.download="students-export.csv",S.click(),window.URL.revokeObjectURL(k),n("close")}return(_,x)=>(M(),B("div",aG,[d("div",iG,[d("header",null,[x[17]||(x[17]=d("h2",null,"Export Students",-1)),d("button",{onClick:x[0]||(x[0]=b=>_.$emit("close")),class:"close-btn"},"")]),d("main",null,[d("p",null,"Export "+Q(t.students.length)+" students",1),d("div",oG,[d("div",lG,[x[23]||(x[23]=d("h4",null,"Student Info",-1)),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[1]||(x[1]=b=>a.value.studentData.firstName=b)},null,512),[[_t,a.value.studentData.firstName]]),x[18]||(x[18]=we(" First Name "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[2]||(x[2]=b=>a.value.studentData.lastName=b)},null,512),[[_t,a.value.studentData.lastName]]),x[19]||(x[19]=we(" Last Name "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[3]||(x[3]=b=>a.value.studentData.grade=b)},null,512),[[_t,a.value.studentData.grade]]),x[20]||(x[20]=we(" Grade "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[4]||(x[4]=b=>a.value.studentData.plan=b)},null,512),[[_t,a.value.studentData.plan]]),x[21]||(x[21]=we(" Plan Type "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[5]||(x[5]=b=>a.value.studentData.caseManagerId=b)},null,512),[[_t,a.value.studentData.caseManagerId]]),x[22]||(x[22]=we(" Case Manager "))])]),d("div",cG,[x[27]||(x[27]=d("h4",null,"Important Dates",-1)),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[6]||(x[6]=b=>a.value.dates.reviewDate=b)},null,512),[[_t,a.value.dates.reviewDate]]),x[24]||(x[24]=we(" Plan Review "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[7]||(x[7]=b=>a.value.dates.reevalDate=b)},null,512),[[_t,a.value.dates.reevalDate]]),x[25]||(x[25]=we(" Reevaluation "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[8]||(x[8]=b=>a.value.dates.meetingDate=b)},null,512),[[_t,a.value.dates.meetingDate]]),x[26]||(x[26]=we(" Meeting Date "))])]),d("div",uG,[x[29]||(x[29]=d("h4",null,"Related Services",-1)),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[9]||(x[9]=b=>a.value.providers.all=b)},null,512),[[_t,a.value.providers.all]]),x[28]||(x[28]=we(" All Service Providers "))])]),d("div",dG,[x[32]||(x[32]=d("h4",null,"Accommodations",-1)),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[10]||(x[10]=b=>a.value.accommodations.instruction=b)},null,512),[[_t,a.value.accommodations.instruction]]),x[30]||(x[30]=we(" Instructional "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[11]||(x[11]=b=>a.value.accommodations.assessment=b)},null,512),[[_t,a.value.accommodations.assessment]]),x[31]||(x[31]=we(" Assessment "))])]),d("div",fG,[x[35]||(x[35]=d("h4",null,"Schedule & Services",-1)),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[12]||(x[12]=b=>a.value.schedule.periods=b)},null,512),[[_t,a.value.schedule.periods]]),x[33]||(x[33]=we(" Class Schedule "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[13]||(x[13]=b=>a.value.schedule.classServices=b)},null,512),[[_t,a.value.schedule.classServices]]),x[34]||(x[34]=we(" Class Services "))])]),d("div",hG,[x[38]||(x[38]=d("h4",null,"Documents",-1)),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[14]||(x[14]=b=>a.value.documents.ataglancePdfUrl=b)},null,512),[[_t,a.value.documents.ataglancePdfUrl]]),x[36]||(x[36]=we(" At-A-Glance "))]),d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":x[15]||(x[15]=b=>a.value.documents.bipPdfUrl=b)},null,512),[[_t,a.value.documents.bipPdfUrl]]),x[37]||(x[37]=we(" BIP "))])])]),d("div",{class:"quick-select"},[d("button",{onClick:f},"Select All"),d("button",{onClick:h},"Deselect All")])]),d("footer",null,[d("button",{onClick:x[16]||(x[16]=b=>_.$emit("close")),class:"btn-secondary"},"Cancel"),d("button",{onClick:y,class:"btn-primary",disabled:!l.value},"Export",8,pG)])])]))}},gG=St(mG,[["__scopeId","data-v-08e1f384"]]),vG={class:"modal-body"},yG={class:"student-info"},xG={class:"case-manager-info"},EG={class:"form-group"},bG={key:0,class:"no-forms-message"},_G={key:1,class:"form-selection"},SG=["id","value"],AG=["for"],TG={class:"form-title"},wG={class:"form-details"},CG={key:0,class:"form-description"},IG={class:"form-date"},kG={key:0,class:"form-group"},DG={class:"teacher-selection-header"},PG={class:"teacher-actions"},RG=["title"],FG={class:"teacher-selection"},NG={key:0,class:"no-teachers-message"},OG={key:1,class:"teacher-checkboxes"},MG=["id","value"],LG=["for"],BG={class:"teacher-email"},UG={key:0,class:"selected-emails-preview"},$G={class:"email-preview"},VG={key:1,class:"form-group"},HG={class:"duplication-options"},jG={class:"option-item"},GG={key:2,class:"form-group"},WG={class:"send-history"},zG={class:"history-info"},KG={class:"history-date"},qG={class:"history-teachers"},XG={key:0,class:"history-success"},YG={key:1,class:"history-failed"},QG={key:0,class:"history-links"},JG=["href"],ZG=["href"],eW={key:0,class:"resource-links"},tW={class:"resource-section"},rW={class:"resource-note"},nW={class:"success-details"},sW={key:0,class:"student-info"},aW={class:"form-link"},iW=["href"],oW={class:"modal-footer"},lW=["disabled"],cW={key:0},uW={key:1},dW={__name:"TeacherFeedbackDialog",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!0}},emits:["close","form-sent"],setup(t,{emit:e}){const r=t,n=e,{activeForms:s}=tx(),{userList:i,fetchUsers:a}=_a(),o=se(!1),l=se(""),c=se(""),u=se(null),f=se(!1),h=se("Copy teacher emails to clipboard"),p=se(""),g=se([]),y=_e(()=>s.value||[]),_=_e(()=>{var I;return p.value&&((I=y.value)==null?void 0:I.find(C=>C.id===p.value))||null}),x=_e(()=>{if(!p.value||!r.student)return[];try{return JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]").filter(C=>C&&C.studentId===r.student.id&&C.formId===p.value).sort((C,F)=>new Date(F.sentAt)-new Date(C.sentAt))||[]}catch(I){return console.warn("Error parsing send history:",I),[]}}),b=_e(()=>{var C,F,W;if(!r.student||!i.value)return[];const I=new Set;if((F=(C=r.student.app)==null?void 0:C.schedule)!=null&&F.periods)Object.values(r.student.app.schedule.periods).forEach(P=>{var N;const R=typeof P=="string"?P:P==null?void 0:P.teacherId;R&&I.add(R),(N=P==null?void 0:P.coTeaching)!=null&&N.caseManagerId&&I.add(P.coTeaching.caseManagerId)});else{const P=r.student.schedule||{};Object.values(P).forEach(R=>{R&&I.add(R)})}return(W=r.student.aeries)!=null&&W.schedule&&Object.values(r.student.aeries.schedule).forEach(P=>{P!=null&&P.teacherId&&I.add(P.teacherId)}),Array.from(I).map(P=>(i.value||[]).find(R=>R&&R.id===P)).filter(Boolean).filter(P=>P&&P.role==="teacher")}),v=_e(()=>p.value&&(g.value||[]).length>0),T=I=>I?(I.seconds?new Date(I.seconds*1e3):new Date(I)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",D=I=>I?(I.seconds?new Date(I.seconds*1e3):new Date(I)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):"",k=()=>{g.value=[...b.value]},S=async()=>{const I=g.value.map(C=>C.email).join(", ");try{await navigator.clipboard.writeText(I),h.value=" Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch(C){console.error("Failed to copy emails:",C);const F=document.createElement("textarea");F.value=I,document.body.appendChild(F),F.select();try{document.execCommand("copy"),h.value=" Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch{h.value=" Copy failed",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}document.body.removeChild(F)}},E=async()=>{var I,C,F,W;if(v.value)try{o.value=!0,l.value="",u.value=null;const P=_.value,R=g.value.map(ae=>ae.email),N=g.value.map(ae=>ae.name||ae.email).join(", "),L=r.student.firstName||r.student.first_name||((C=(I=r.student.app)==null?void 0:I.studentData)==null?void 0:C.firstName)||"",O=r.student.lastName||r.student.last_name||((W=(F=r.student.app)==null?void 0:F.studentData)==null?void 0:W.lastName)||"",V=`${L} ${O}`.trim(),z=(((L==null?void 0:L[0])||"")+((O==null?void 0:O[0])||"")).toUpperCase()||"ST";let U=P.formUrl;U.includes("/edit")&&(U=U.replace("/edit","/copy"));const G=new URLSearchParams;z&&z!=="ST"&&G.append("title",`${z} - ${P.title}`),V&&G.append("student",V),R.length>0&&G.append("responders",R.join(", "));const j=U.includes("?")?"&":"?",ee=G.toString()?`${U}${j}${G.toString()}`:U;window.open(ee,"_blank","noopener"),l.value=`Form opened for ${N}. Student: ${z} - ${V}`,c.value="success",u.value={message:`Form opened successfully for ${z} - ${V}`,sent:R.length,failed:0,formUrl:ee,studentInitials:z,studentName:V},m(P,g.value,ee)}catch(P){console.error("Error opening form:",P),l.value="Failed to open form. Please try again.",c.value="error"}finally{o.value=!1}},m=(I,C,F=null)=>{const W=JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]"),P={id:`${I.id}_${r.student.id}_${Date.now()}`,formId:I.id,formTitle:I.title,formUrl:F||I.formUrl,sheetUrl:null,studentId:r.student.id,studentName:`${r.student.firstName} ${r.student.lastName}`,caseManagerId:r.currentUser.uid,caseManagerName:r.currentUser.name||r.currentUser.email,teachers:C.map(N=>({id:N.id,name:N.name,email:N.email})),sentAt:new Date().toISOString(),method:"gmail"},R=W.findIndex(N=>N.id===P.id);R!==-1?W[R]=P:W.push(P),localStorage.setItem("casemanage_sent_forms",JSON.stringify(W))},A=()=>{n("close")};return Wt(()=>{p.value="",g.value=[],l.value="",a()}),Ht(b,I=>{I&&I.length>0&&g.value.length===0&&(g.value=[...I])},{immediate:!0}),(I,C)=>{var F,W,P,R;return M(),B("div",{class:"modal-overlay",onClick:A},[d("div",{class:"modal-content",onClick:C[3]||(C[3]=Yr(()=>{},["stop"]))},[d("div",{class:"modal-header"},[C[4]||(C[4]=d("h3",null,"Send Teacher Feedback Form",-1)),d("button",{onClick:A,class:"close-btn"},"")]),d("div",vG,[d("div",yG,[d("h4",null,Q(t.student.firstName)+" "+Q(t.student.lastName)+" (Grade "+Q(t.student.grade)+")",1),d("p",xG,"Case Manager: "+Q(((F=t.currentUser)==null?void 0:F.name)||((W=t.currentUser)==null?void 0:W.email)),1)]),d("div",EG,[C[6]||(C[6]=d("label",null,"Select Feedback Form to Send:",-1)),y.value.length===0?(M(),B("div",bG,C[5]||(C[5]=[d("p",null,"No feedback forms available. Forms must be created in the Admin Panel first.",-1),d("p",null,[d("em",null,"Contact your administrator to create feedback forms.")],-1)]))):(M(),B("div",_G,[(M(!0),B(ke,null,He(y.value,N=>(M(),B("div",{key:N.id,class:"form-option"},[Oe(d("input",{type:"radio",id:N.id,value:N.id,"onUpdate:modelValue":C[0]||(C[0]=L=>p.value=L)},null,8,SG),[[Ss,p.value]]),d("label",{for:N.id,class:"form-option-label"},[d("div",TG,Q(N.title),1),d("div",wG,[N.description?(M(),B("span",CG,Q(N.description),1)):ve("",!0),d("span",IG,"Created: "+Q(T(N.createdAt)),1)])],8,AG)]))),128))]))]),p.value?(M(),B("div",kG,[d("div",DG,[C[7]||(C[7]=d("label",null,"Select Teachers to Send Form To:",-1)),d("div",PG,[b.value.length>0?(M(),B("button",{key:0,onClick:k,type:"button",class:"btn-select-all"}," Select All ")):ve("",!0),g.value.length>0?(M(),B("button",{key:1,onClick:S,type:"button",class:"btn-copy-emails",title:h.value},"  Copy Emails ",8,RG)):ve("",!0)])]),d("div",FG,[b.value.length===0?(M(),B("div",NG,C[8]||(C[8]=[d("p",null,"No teachers found for this student's schedule.",-1)]))):(M(),B("div",OG,[(M(!0),B(ke,null,He(b.value,N=>(M(),B("div",{key:N.id,class:"checkbox-item"},[Oe(d("input",{type:"checkbox",id:`teacher-${N.id}`,value:N,"onUpdate:modelValue":C[1]||(C[1]=L=>g.value=L)},null,8,MG),[[_t,g.value]]),d("label",{for:`teacher-${N.id}`},[we(Q(N.name||N.email)+" ",1),d("span",BG,"("+Q(N.email)+")",1)],8,LG)]))),128))]))]),g.value.length>0?(M(),B("div",UG,[C[9]||(C[9]=d("p",null,[d("strong",null,"Selected teacher emails:")],-1)),d("div",$G,Q(g.value.map(N=>N.email).join(", ")),1)])):ve("",!0)])):ve("",!0),p.value&&g.value.length>0&&((P=_.value)!=null&&P.sheetTemplateUrl)?(M(),B("div",VG,[C[11]||(C[11]=d("label",null,"Response Collection:",-1)),d("div",HG,[d("div",jG,[Oe(d("input",{type:"checkbox",id:"duplicate-sheet","onUpdate:modelValue":C[2]||(C[2]=N=>f.value=N)},null,512),[[_t,f.value]]),C[10]||(C[10]=d("label",{for:"duplicate-sheet"},[d("strong",null,"Duplicate custom sheet"),d("span",{class:"option-description"},"Create a copy of the response template sheet in your Google Drive")],-1))])])])):ve("",!0),p.value&&x.value.length>0?(M(),B("div",GG,[C[12]||(C[12]=d("label",null,"Previous Sends for this Student:",-1)),d("div",WG,[(M(!0),B(ke,null,He(x.value,N=>(M(),B("div",{key:N.id,class:"history-item"},[d("div",zG,[d("span",KG,Q(D(N.sentAt)),1),d("span",qG,Q((N.teacherEmails||[]).length)+" teacher"+Q((N.teacherEmails||[]).length===1?"":"s"),1),N.successful>0?(M(),B("span",XG," "+Q(N.successful)+" sent",1)):ve("",!0),N.failed>0?(M(),B("span",YG," "+Q(N.failed)+" failed",1)):ve("",!0)]),N.formUrl||N.sheetUrl?(M(),B("div",QG,[N.formUrl?(M(),B("a",{key:0,href:N.formUrl,target:"_blank",class:"history-link"}," Form",8,JG)):ve("",!0),N.sheetUrl?(M(),B("a",{key:1,href:N.sheetUrl,target:"_blank",class:"history-link"}," Sheet",8,ZG)):ve("",!0)])):ve("",!0)]))),128))])])):ve("",!0),l.value?(M(),B("div",{key:3,class:Ye(`status-message ${c.value}`)},[we(Q(l.value)+" ",1),c.value==="success"&&u.value?(M(),B("div",eW,[d("div",tW,[C[16]||(C[16]=d("h5",null," Form Opened Successfully!",-1)),d("p",rW,[d("strong",null,Q(u.value.message),1)]),d("div",nW,[d("p",null,[C[13]||(C[13]=we("  Form opened for ")),d("strong",null,Q(u.value.sent),1),we(" teacher"+Q(u.value.sent===1?"":"s"),1)]),u.value.studentInitials?(M(),B("p",sW,[C[14]||(C[14]=we("  Student: ")),d("strong",null,Q(u.value.studentInitials),1),we(" - "+Q(u.value.studentName),1)])):ve("",!0),d("p",aW,[C[15]||(C[15]=we("  Form Link: ")),d("a",{href:u.value.formUrl,target:"_blank"},Q((R=_.value)==null?void 0:R.title),9,iW)])])])])):ve("",!0)],2)):ve("",!0)]),d("div",oW,[d("button",{onClick:A,class:"secondary-btn"},"Cancel"),d("button",{onClick:E,class:"primary-btn",disabled:!v.value||o.value},[o.value?(M(),B("span",cW,"Creating Form...")):(M(),B("span",uW," Create New Form"))],8,lW)])])])}}},fW=St(dW,[["__scopeId","data-v-f8c1ccfe"]]),hW={class:"students-view"},pW={class:"page-header"},mW={class:"header-left"},gW={class:"search-container"},vW={class:"header-controls"},yW={class:"filter-group sort-group"},xW={key:0,class:"filter-group"},EW={class:"radio-group"},bW=["title"],_W=["value"],SW={class:"filter-group"},AW={class:"radio-group"},TW=["checked"],wW=["checked","disabled"],CW={key:0,class:"disabled-icon"},IW=["checked"],kW={key:0,class:"selected-radio-display"},DW={key:1,class:"filters-panel"},PW={class:"filters-content"},RW={class:"filter-group"},FW=["value"],NW={class:"filter-group"},OW=["value"],MW={class:"filter-group"},LW=["value"],BW={class:"filter-group"},UW={class:"filter-group"},$W=["value"],VW={class:"content"},HW={class:"print-user-name"},jW={key:0},GW={key:1,class:"view-container"},WW={key:0,class:"group-section"},zW={class:"group-header"},KW={key:2,class:"view-section"},qW={key:0,class:"testing-proctor-header"},XW={__name:"StudentsView",setup(t){var ze;const e=Qr(),r=nU(),n=aU(r),{appSettings:s}=Ts(),i=_e(()=>{const Ie=x.value;return Ie?!["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(Ie.role)&&Ie.testingAccess===!0:!1}),a=pU(r,n);console.log(" STUDENTS VIEW DEBUG: Setting up watcher, currentRole:",(ze=a.currentRole)==null?void 0:ze.value),Ht(()=>{var Ie;return(Ie=a.currentRole)==null?void 0:Ie.value},Ie=>{console.log(" STUDENTS VIEW DEBUG: Role changed to:",Ie),Ie==="paraeducator"&&(console.log(" STUDENTS VIEW DEBUG: Paraeducator role detected, setting up visibleStudents watcher"),Ht(()=>{var be;return(be=a.visibleStudents)==null?void 0:be.value},be=>{console.log(" STUDENTS VIEW: Paraeducator visibleStudents changed:",{count:(be==null?void 0:be.length)||0,studentNames:(be==null?void 0:be.map(Me=>{var Ke,qe,Se,xe;return`${((qe=(Ke=Me.app)==null?void 0:Ke.studentData)==null?void 0:qe.firstName)||"Unknown"} ${((xe=(Se=Me.app)==null?void 0:Se.studentData)==null?void 0:xe.lastName)||"Unknown"}`}))||[]})},{immediate:!0}))},{immediate:!0});const o=yU(r),{students:l,userMapObj:c,caseManagers:u,caseManagersWithCounts:f,teacherList:h,userRoles:p,aideAssignment:g,paraeducators:y,serviceProviders:_,currentUser:x,isAdmin:b,showProviderView:v,getStudentById:T}=r,{showFilters:D,filteredStudents:k,currentFilters:S,toggleFilters:E,clearFilters:m,applyFilters:A,debouncedApplyFilters:I}=n,{visibleStudents:C,canEditAllStudents:F,canEditOwnStudents:W,canViewAllStudents:P,canAccessTesting:R,canAccessTestingPartial:N,canAccessFilters:L,isClassViewDisabled:O,setViewMode:V,providerViewOptions:z}=a,U=vU(r,n,_e(()=>a.visibleStudents.value)),{currentViewMode:G,studentsByClass:j,directAssignmentStudents:ee,testingViewStudents:ae,fetchTestingData:ne}=U,{editingStudentId:le,emailingStudentId:Z,showExport:J,showAddStudent:ge,showFeedbackDialog:te,feedbackStudentId:K,editStudent:Y,emailStudent:fe,handleTeacherFeedback:ye,handleFormSent:ie,handleStudentAdded:ue,handleStudentSaved:Ee,handleNavAction:Ce}=o,Pe=Ie=>{var Me;const be=(Me=x.value)==null?void 0:Me.role;switch(Ie){case"all_iep":return"CM+SP";case"case_manager":return"Case Manager";case"service_provider":return"Service Provider";case"teacher":return"Service Provider";case"iep_504_all":return"All IEP/504 students";case"all":return be==="sped_chair"?"All students (with IEPs)":"All students";default:return"All students"}};_e(()=>{var be;return z!=null&&z.value?z.value:((be=x.value)==null?void 0:be.role)==="case_manager"?[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]});const Te=_e(()=>{var be;const Ie=[];if(S.providerView&&((be=z==null?void 0:z.value)!=null&&be.length)){const Me=Pe(S.providerView);Me&&Ie.push(Me)}if(S.viewMode){let Me="";switch(S.viewMode){case"list":Me="List view";break;case"class":Me="Class-period view";break;case"testing":Me="Separate Setting For Testing";break}Me&&Ie.push(Me)}return Ie.length>0?Ie.join(" | "):""});return Ht(()=>G.value,async Ie=>{if(Ie==="testing"){const be=x.value,Me=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"];console.log(" Testing View: Switched to testing mode"),console.log(" Testing View: User role:",be==null?void 0:be.role),console.log(" Testing View: User testingAccess:",be==null?void 0:be.testingAccess),console.log(" Testing View: Is full access role:",Me.includes(be==null?void 0:be.role)),(be==null?void 0:be.testingAccess)===!0&&!Me.includes(be.role)&&(console.log(" Testing view activated - fetching testing accommodations data"),await ne())}}),(Ie,be)=>{var Me,Ke,qe,Se,xe,Ae,Le,We;return M(),B("div",hW,[Re(FU,{"current-user":q(x),"is-admin":q(b),onAction:q(Ce)},null,8,["current-user","is-admin","onAction"]),d("div",pW,[d("div",mW,[be[25]||(be[25]=d("h1",null,"Student Management",-1)),d("div",gW,[Oe(d("input",{type:"text","onUpdate:modelValue":be[0]||(be[0]=$e=>q(S).search=$e),onInput:be[1]||(be[1]=(...$e)=>q(I)&&q(I)(...$e)),placeholder:"Search students...",class:"search-input"},null,544),[[ht,q(S).search]])])]),d("div",vW,[d("div",yW,[Re(q(XL),{size:16,class:"sort-icon"}),Oe(d("select",{"onUpdate:modelValue":be[2]||(be[2]=$e=>q(S).sortBy=$e),onChange:be[3]||(be[3]=$e=>q(A)()),class:"sort-select"},be[26]||(be[26]=[En('<option value="firstName">First Names</option><option value="lastName">Last Name</option><option value="grade">Grade</option><option value="reviewDate">Plan Review Date</option><option value="reevalDate">Re-evaluation Date</option><option value="meetingDate">Meeting Date</option>',6)]),544),[[sr,q(S).sortBy]])]),q(z)&&q(z).length?(M(),B("div",xW,[d("div",EW,[(M(!0),B(ke,null,He(q(z),$e=>(M(),B("label",{key:$e.value,class:Ye(["radio-btn icon-btn",{active:q(S).providerView===$e.value}]),title:Pe($e.value)},[Oe(d("input",{type:"radio","onUpdate:modelValue":be[4]||(be[4]=dt=>q(S).providerView=dt),value:$e.value,onChange:be[5]||(be[5]=(...dt)=>q(A)&&q(A)(...dt))},null,40,_W),[[Ss,q(S).providerView]]),$e.value==="all_iep"?(M(),Qt(q(zl),{key:0,size:16})):$e.value==="case_manager"?(M(),Qt(q(Hv),{key:1,size:16})):$e.value==="service_provider"||$e.value==="teacher"?(M(),Qt(q(gB),{key:2,size:16})):$e.value==="all"||$e.value==="iep_504_all"?(M(),Qt(q(iB),{key:3,size:16})):ve("",!0)],10,bW))),128))])])):ve("",!0),d("div",SW,[d("div",AW,[d("label",{class:Ye(["radio-btn icon-btn",{active:q(S).viewMode==="list"}]),title:"List view"},[d("input",{type:"radio",value:"list",checked:q(S).viewMode==="list",onChange:be[6]||(be[6]=$e=>q(V)("list"))},null,40,TW),Re(q(dB),{size:16})],2),d("label",{class:Ye(["radio-btn icon-btn",{active:q(S).viewMode==="class",disabled:q(O)}]),title:"Class-period view"},[d("input",{type:"radio",value:"class",checked:q(S).viewMode==="class",onChange:be[7]||(be[7]=$e=>q(V)("class")),disabled:q(O)},null,40,wW),Re(q(rB),{size:16,class:Ye({strikethrough:q(O)})},null,8,["class"]),q(O)?(M(),B("span",CW,"")):ve("",!0)],2),q(R)?(M(),B("label",{key:0,class:Ye(["radio-btn icon-btn",{active:q(S).viewMode==="testing"}]),title:"Separate Setting For Testing"},[d("input",{type:"radio",value:"testing",checked:q(S).viewMode==="testing",onChange:be[8]||(be[8]=$e=>q(V)("testing"))},null,40,IW),Re(q(Uv),{size:16})],2)):ve("",!0)])]),q(L)?(M(),B("button",{key:1,onClick:be[9]||(be[9]=(...$e)=>q(E)&&q(E)(...$e)),class:Ye(["radio-btn icon-btn filter-toggle-btn",{active:q(D)}]),title:"Toggle filters"},[Re(q(aB),{size:16})],2)):ve("",!0)])]),Te.value?(M(),B("div",kW,Q(Te.value),1)):ve("",!0),q(D)?(M(),B("div",DW,[d("div",PW,[d("div",RW,[be[28]||(be[28]=d("label",null,"Case Manager",-1)),Oe(d("select",{"onUpdate:modelValue":be[10]||(be[10]=$e=>q(S).cm=$e),onChange:be[11]||(be[11]=$e=>q(A)()),class:"filter-select"},[be[27]||(be[27]=d("option",{value:"all"},"All Case Managers",-1)),(M(!0),B(ke,null,He(q(f),$e=>(M(),B("option",{key:$e.id,value:$e.id},Q($e.displayName||$e.name||$e.email||$e.id),9,FW))),128))],544),[[sr,q(S).cm]])]),d("div",NW,[be[30]||(be[30]=d("label",null,"Teacher",-1)),Oe(d("select",{"onUpdate:modelValue":be[12]||(be[12]=$e=>q(S).teacher=$e),onChange:be[13]||(be[13]=$e=>q(A)()),class:"filter-select"},[be[29]||(be[29]=d("option",{value:"all"},"All Teachers",-1)),(M(!0),B(ke,null,He(q(h),$e=>(M(),B("option",{key:$e.id,value:$e.id},Q($e.name||$e.email||$e.id),9,OW))),128))],544),[[sr,q(S).teacher]])]),d("div",MW,[be[32]||(be[32]=d("label",null,"Paraeducator",-1)),Oe(d("select",{"onUpdate:modelValue":be[14]||(be[14]=$e=>q(S).paraeducator=$e),onChange:be[15]||(be[15]=$e=>q(A)()),class:"filter-select"},[be[31]||(be[31]=d("option",{value:"all"},"All Paraeducators",-1)),(M(!0),B(ke,null,He(q(y),$e=>(M(),B("option",{key:$e.id,value:$e.id},Q($e.name||$e.email||$e.id),9,LW))),128))],544),[[sr,q(S).paraeducator]])]),d("div",BW,[be[34]||(be[34]=d("label",null,"Plan Type",-1)),Oe(d("select",{"onUpdate:modelValue":be[16]||(be[16]=$e=>q(S).plan=$e),onChange:be[17]||(be[17]=$e=>q(A)()),class:"filter-select"},be[33]||(be[33]=[d("option",{value:"all"},"All Plans",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),544),[[sr,q(S).plan]])]),d("div",UW,[be[36]||(be[36]=d("label",null,"Service Provider",-1)),Oe(d("select",{"onUpdate:modelValue":be[18]||(be[18]=$e=>q(S).serviceProvider=$e),onChange:be[19]||(be[19]=$e=>q(A)()),class:"filter-select"},[be[35]||(be[35]=d("option",{value:"all"},"All Service Providers",-1)),(M(!0),B(ke,null,He(q(_),$e=>(M(),B("option",{key:$e.id,value:$e.id},Q($e.name||$e.email||$e.id),9,$W))),128))],544),[[sr,q(S).serviceProvider]])])])])):ve("",!0),d("div",VW,[d("div",HW,Q(((Me=q(e).currentUser)==null?void 0:Me.name)||((Ke=q(e).currentUser)==null?void 0:Ke.email)||((qe=q(e).currentUser)==null?void 0:qe.displayName)||((Se=q(x))==null?void 0:Se.name)||((xe=q(x))==null?void 0:xe.email)||"System User"),1),q(G)==="list"?(M(),B("div",jW,[Re(Yf,{students:q(C),"user-map":q(c),"current-user":q(x),"student-data":q(r),"can-edit-all":q(F),"can-edit-own":q(W),"can-view-all":q(P),"can-access-testing":q(R),"can-access-testing-partial":q(N),"aide-schedule":((Ae=q(x))==null?void 0:Ae.role)==="paraeducator"?q(g):{},"app-settings":q(s),onEdit:q(Y),onEmail:q(fe),onTeacherFeedback:q(ye)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","app-settings","onEdit","onEmail","onTeacherFeedback"])])):q(G)==="class"?(M(),B("div",GW,[q(ee).length>0?(M(),B("div",WW,[be[37]||(be[37]=d("h3",{class:"group-header direct-assignment-header"},"Direct Assignment",-1)),Re(Yf,{students:q(ee),"user-map":q(c),"current-user":q(x),"student-data":q(r),"can-edit-all":q(F),"can-edit-own":q(W),"can-view-all":q(P),"can-access-testing":q(R),"can-access-testing-partial":q(N),"aide-schedule":((Le=q(x))==null?void 0:Le.role)==="paraeducator"?q(g):{},"app-settings":q(s),onEdit:q(Y),onEmail:q(fe),onTeacherFeedback:q(ye)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","app-settings","onEdit","onEmail","onTeacherFeedback"])])):ve("",!0),(M(!0),B(ke,null,He(q(j),($e,dt)=>{var xt;return M(),B("div",{key:dt,class:"group-section"},[d("h3",zW,"Period "+Q(dt),1),Re(Yf,{students:$e,"user-map":q(c),"current-user":q(x),"student-data":q(r),"can-edit-all":q(F),"can-edit-own":q(W),"can-view-all":q(P),"can-access-testing":q(R),"can-access-testing-partial":q(N),"aide-schedule":((xt=q(x))==null?void 0:xt.role)==="paraeducator"?q(g):{},"app-settings":q(s),onEdit:q(Y),onEmail:q(fe),onTeacherFeedback:q(ye)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","app-settings","onEdit","onEmail","onTeacherFeedback"])])}),128))])):q(G)==="testing"?(M(),B("div",KW,[i.value?(M(),B("div",qW,be[38]||(be[38]=[d("h3",{class:"proctor-title"},"Test Proctor View",-1),d("p",{class:"proctor-subtitle"},"Viewing testing accommodations for students with separate settings",-1)]))):ve("",!0),Re(Yf,{students:q(ae),"user-map":q(c),"current-user":q(x),"student-data":q(r),"can-edit-all":q(F),"can-edit-own":q(W),"can-view-all":q(P),"can-access-testing":q(R),"can-access-testing-partial":q(N),"testing-view":!0,"aide-schedule":((We=q(x))==null?void 0:We.role)==="paraeducator"?q(g):{},"app-settings":q(s),onEdit:q(Y),onEmail:q(fe),onTeacherFeedback:q(ye)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","app-settings","onEdit","onEmail","onTeacherFeedback"])])):ve("",!0)]),q(le)?(M(),Qt(Fj,{key:2,"student-id":q(le),users:{userRoles:q(p)},onClose:be[20]||(be[20]=$e=>le.value=null),onSaved:q(Ee)},null,8,["student-id","users","onSaved"])):ve("",!0),q(Z)?(M(),Qt(sG,{key:3,student:q(T)(q(Z)),"user-map":q(c),"current-user":q(x),onClose:be[21]||(be[21]=$e=>Z.value=null)},null,8,["student","user-map","current-user"])):ve("",!0),q(J)?(M(),Qt(gG,{key:4,students:q(l),"user-map":q(c),onClose:be[22]||(be[22]=$e=>J.value=!1)},null,8,["students","user-map"])):ve("",!0),q(ge)?(M(),Qt(ix,{key:5,users:{userRoles:q(p)},onClose:be[23]||(be[23]=$e=>ge.value=!1),onSaved:q(ue)},null,8,["users","onSaved"])):ve("",!0),q(te)?(M(),Qt(fW,{key:6,student:q(T)(q(K)),"current-user":q(x),"user-map":q(c),onClose:be[24]||(be[24]=$e=>te.value=!1),onFormSent:q(ie)},null,8,["student","current-user","user-map","onFormSent"])):ve("",!0)])}}},YW="/assets/logo-DFbfizoa.png",QW={class:"login-container"},JW={__name:"LoginView",setup(t){const e=ki(),r=async()=>{try{const{user:n}=await J1(bt,qy),s=et(Xe,"users",n.uid);(await er(s)).exists()||await $t(s,{name:n.displayName||"",email:n.email,role:"admin"}),e.push({name:"Home"})}catch(n){console.error("Login failed:",n),alert("Login failed: "+n.message)}};return(n,s)=>(M(),B("div",QW,[s[0]||(s[0]=d("div",{class:"logo-container"},[d("img",{src:YW,alt:"CaseManageVue Logo",class:"logo"}),d("h1",null,"Case Manager Portal")],-1)),s[1]||(s[1]=d("p",null,"Please sign in with your Google account:",-1)),d("button",{onClick:r,class:"primary-btn"}," Sign in with Google ")]))}},ZW=St(JW,[["__scopeId","data-v-5930ff96"]]),ez={name:"TabBar",props:{tabs:{type:Array,required:!0,default:()=>[]},activeTab:{type:String,required:!0}},emits:["tab-change"],methods:{getStatusIcon(t){switch(t){case"not-active":return"";case"not-working":return"";default:return""}},getStatusTooltip(t){switch(t){case"not-active":return" = Not active";case"not-working":return" = Not working";default:return""}}}},tz={class:"admin-tab-bar"},rz=["onClick","title"];function nz(t,e,r,n,s,i){return M(),B("div",tz,[(M(!0),B(ke,null,He(r.tabs,a=>(M(),B("button",{key:a.key,class:Ye({active:r.activeTab===a.key}),onClick:o=>t.$emit("tab-change",a.key),title:i.getStatusTooltip(a.status)},[we(Q(a.label)+" ",1),a.status?(M(),B("span",{key:0,class:Ye(["status-indicator",a.status])},Q(i.getStatusIcon(a.status)),3)):ve("",!0)],10,rz))),128))])}const sz=St(ez,[["render",nz],["__scopeId","data-v-7e596834"]]),az={name:"UserAddForm",setup(){const t=Ra(HI,"addUserWithRole"),e=xo(),r=As({name:"",email:"",role:"",provider:"",aeriesId:"",rm:"",ext:"",testingAccess:!1}),n=se(null),s=se(""),i=se(!1),a=se(null),o=Ko,{appSettings:l,loadAppSettings:c}=Ts(),u=_e(()=>[...Ko].sort()),f=_e(()=>{if(l&&l.value&&l.value.serviceProviders){const T=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}];return l.value.serviceProviders.map(D=>T.find(k=>k.abbreviation===D)||{name:D,abbreviation:D}).sort((D,k)=>D.name.localeCompare(k.name))}return[]}),h=(T,D=!1)=>{s.value=T,i.value=D,setTimeout(()=>{s.value="",i.value=!1},5e3)},p=async(T,D,k,S,E,m,A)=>{try{const I={name:T,email:D,role:k,provider:S,aeriesId:E,rm:m,ext:A,createdAt:new Date,status:"active"},C=await gI(At(e,"users"),I);return await an.logUserManagement(C.id,"create",{userData:{name:T,email:D,role:k,provider:S,aeriesId:E,rm:m,ext:A},method:"firestore_direct"}),{success:!0,userId:C.id}}catch(I){throw await an.logUserManagement("unknown","create_failed",{error:I.message,attemptedData:{name:T,email:D,role:k,provider:S,aeriesId:E,rm:m,ext:A},method:"firestore_direct"}),I}},g=async(T,D,k,S,E,m,A)=>{var I,C;try{try{return await t({name:T,email:D,role:k,provider:S,aeriesId:E,rm:m,ext:A}),await an.logUserManagement("cloud_function_user","create",{userData:{name:T,email:D,role:k,provider:S,aeriesId:E,rm:m,ext:A},method:"cloud_function"}),{success:!0,method:"cloud-function"}}catch(F){return F.code==="functions/already-exists"||(I=F.message)!=null&&I.includes("409")||(C=F.message)!=null&&C.includes("already exists")?(console.log(`User ${D} already exists in Firebase Auth, skipping...`),await an.logUserManagement("existing_user","create_skipped",{userData:{name:T,email:D,role:k,provider:S,aeriesId:E,rm:m,ext:A},reason:"user_already_exists",method:"cloud_function"}),{success:!0,method:"already-exists",message:"User already exists"}):(await p(T,D,k,S,E,m,A),{success:!0,method:"firestore"})}}catch(F){return await an.logUserManagement("unknown","create_failed",{error:F.message,attemptedData:{name:T,email:D,role:k,provider:S,aeriesId:E,rm:m,ext:A},method:"addUserToFirestore"}),{success:!1,error:F.message}}},y=async()=>{if(!Fs("addUser",5,6e4).allowed){h("Too many requests. Please wait before adding another user.",!0);return}const D=KB(r),k=zB(D);if(!k.isValid){h(`Please fix the following errors:
${k.errors.join(`
`)}`,!0);return}const S=["name","email","aeriesId","rm","ext"];for(const m of S)if(D[m]){const A=Hr(D[m]);if(!A.isSafe){h(`Security threat detected in ${m}: ${A.threats.join(", ")}`,!0);return}}Object.assign(r,D);const E=await g(r.name,r.email,r.role,r.provider,r.aeriesId,r.rm,r.ext);E.success?(h(`User ${r.name} added successfully!`),r.name="",r.email="",r.role="",r.provider="",r.aeriesId="",r.rm="",r.ext=""):h(`Error adding user: ${E.error}`,!0)},_=T=>{const D=T.target.files[0];if(D){const k=ol(D,{allowedTypes:["csv","excel"],maxSize:5242880,fieldName:"User Import File"});if(!k.isValid){h(k.error,!0),T.target.value="";return}const S=Hr(D.name);if(!S.isSafe){h(`File name contains potentially dangerous content: ${S.threats.join(", ")}`,!0),T.target.value="";return}n.value=D}},x=async()=>{if(!n.value){h("Please select a file first",!0);return}const T=n.value.name.toLowerCase();if(!(T.endsWith(".csv")||T.endsWith(".xls")||T.endsWith(".xlsx"))){h("Unsupported file type. Please upload a .csv, .xls, or .xlsx file.",!0);return}h("Processing file...");try{T.endsWith(".csv")?await b(n.value):await v(n.value)}catch(D){h(`Error processing file: ${D.message}`,!0),console.error("Bulk upload error:",D)}},b=async T=>new Promise((D,k)=>{const S=new FileReader;S.onload=async E=>{try{const A=E.target.result.trim().split(/\r?\n/);if(A.length===0){k(new Error("The CSV file is empty."));return}const I=O=>{const V=[];let z="",U=!1;for(let G=0;G<O.length;G++){const j=O[G];j==='"'?U=!U:j===","&&!U?(V.push(z.trim()),z=""):z+=j}return V.push(z.trim()),V};let C=0;const F={name:0,email:1,role:2,provider:3,aeriesId:4,rm:5,ext:6},W=I(A[0]);W.map(O=>O.toLowerCase()).some(O=>O.includes("name")||O.includes("email")||O.includes("role"))&&(W.forEach((O,V)=>{const z=O.trim().toLowerCase();(z==="name"||z==="displayname")&&(F.name=V),z==="email"&&(F.email=V),z==="role"&&(F.role=V),(z==="provider"||z==="providertype")&&(F.provider=V),(z==="aeriesid"||z==="aeries_id"||z==="teacherid")&&(F.aeriesId=V),(z==="rm"||z==="room")&&(F.rm=V),(z==="ext"||z==="extension")&&(F.ext=V)}),C=1);let R=0;const N=[];for(let O=C;O<A.length;O++){const V=A[O].trim();if(!V)continue;const z=I(V),U=(z[F.name]||"").trim(),G=(z[F.email]||"").trim(),j=(z[F.role]||"").trim(),ee=(z[F.provider]||"").trim(),ae=(z[F.aeriesId]||"").trim(),ne=(z[F.rm]||"").trim(),le=(z[F.ext]||"").trim(),Z=U.replace(/^"|"$/g,""),J=G.replace(/^"|"$/g,""),ge=j.replace(/^"|"$/g,""),te=ee.replace(/^"|"$/g,""),K=ae.replace(/^"|"$/g,""),Y=ne.replace(/^"|"$/g,""),fe=le.replace(/^"|"$/g,"");if(!Z||!J||!ge){N.push(`Line ${O+1}: Missing name, email, or role.`);continue}if(!Hb(ge)){N.push(`Line ${O+1}: Invalid role "${ge}".`);continue}const ye=await g(Z,J,ge,te,K,Y,fe);ye.success?(R++,ye.method==="already-exists"&&console.log(`Line ${O+1}: User ${J} already exists, skipped`)):N.push(`Line ${O+1}: ${ye.error}`)}let L=`${R} users added successfully.`;N.length>0&&(L+=`
${N.length} errors:
`+N.join(`
`)),h(L,N.length>0),n.value=null,a.value&&(a.value.value=""),D()}catch(m){k(new Error(`Error processing CSV file: ${m.message}`))}},S.onerror=()=>k(new Error("Failed to read the CSV file.")),S.readAsText(T)}),v=async T=>new Promise((D,k)=>{const S=new FileReader;S.onload=async E=>{try{if(typeof XLSX>"u"){k(new Error("Excel upload requires SheetJS (XLSX) library. Please include it in your page."));return}const m=new Uint8Array(E.target.result),A=XLSX.read(m,{type:"array"}),I=A.SheetNames[0],C=A.Sheets[I],F=XLSX.utils.sheet_to_json(C,{defval:""});if(F.length===0){k(new Error("The Excel file is empty or unrecognized."));return}let W=0;const P=[];for(let N=0;N<F.length;N++){const L=F[N];let O="",V="",z="",U="",G="",j="",ee="";for(const le in L){const Z=le.toLowerCase(),J=(""+L[le]).trim();(Z==="name"||Z==="displayname")&&!O?O=J:Z==="email"&&!V?V=J:Z==="role"&&!z?z=J:(Z==="provider"||Z==="providertype")&&!U?U=J:(Z==="aeriesid"||Z==="aeries_id"||Z==="teacherid")&&!G?G=J:(Z==="rm"||Z==="room")&&!j?j=J:(Z==="ext"||Z==="extension")&&!ee&&(ee=J)}const ae=Object.values(L).map(le=>(""+le).trim());if(!O&&ae[0]&&(O=ae[0]),!V&&ae[1]&&(V=ae[1]),!z&&ae[2]&&(z=ae[2]),!U&&ae[3]&&(U=ae[3]),!G&&ae[4]&&(G=ae[4]),!j&&ae[5]&&(j=ae[5]),!ee&&ae[6]&&(ee=ae[6]),!O||!V||!z){P.push(`Row ${N+1}: Missing name, email, or role.`);continue}if(!Hb(z)){P.push(`Row ${N+1}: Invalid role "${z}".`);continue}const ne=await g(O,V,z,U,G,j,ee);ne.success?(W++,ne.method==="already-exists"&&console.log(`Row ${N+1}: User ${V} already exists, skipped`)):P.push(`Row ${N+1}: ${ne.error}`)}let R=`${W} users added successfully.`;P.length>0&&(R+=`
${P.length} errors:
`+P.join(`
`)),h(R,P.length>0),n.value=null,a.value&&(a.value.value=""),D()}catch(m){k(new Error(`Error processing Excel file: ${m.message}`))}},S.onerror=()=>k(new Error("Failed to read the Excel file.")),S.readAsArrayBuffer(T)});return Wt(async()=>{await c()}),{singleUser:r,validRoles:o,sortedValidRoles:u,providerOptions:f,addSingleUser:y,selectedFile:n,statusMessage:s,isError:i,bulkFileInput:a,handleFileSelect:_,uploadBulkUsers:x,appSettings:l}}},iz={class:"add-user-wrapper"},oz={class:"add-single"},lz=["value"],cz={key:0},uz=["value"],dz={class:"checkbox-label"},fz={class:"add-bulk"},hz=["disabled"];function pz(t,e,r,n,s,i){return M(),B("div",iz,[d("div",oz,[e[23]||(e[23]=d("h3",null,"Add Single User",-1)),d("form",{onSubmit:e[8]||(e[8]=Yr((...a)=>n.addSingleUser&&n.addSingleUser(...a),["prevent"])),class:"form-grid"},[d("div",null,[d("label",null,[e[11]||(e[11]=we(" Name: ")),Oe(d("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>n.singleUser.name=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[ht,n.singleUser.name]])])]),d("div",null,[d("label",null,[e[12]||(e[12]=we(" Email: ")),Oe(d("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>n.singleUser.email=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[ht,n.singleUser.email]])])]),d("div",null,[d("label",null,[e[14]||(e[14]=we(" Role: ")),Oe(d("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.singleUser.role=a),required:""},[e[13]||(e[13]=d("option",{value:"",disabled:""},"Select role...",-1)),(M(!0),B(ke,null,He(n.sortedValidRoles,a=>(M(),B("option",{key:a,value:a},Q(a),9,lz))),128))],512),[[sr,n.singleUser.role]])])]),n.providerOptions.length>0?(M(),B("div",cz,[d("label",null,[e[16]||(e[16]=we(" Provider Type: ")),Oe(d("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>n.singleUser.provider=a)},[e[15]||(e[15]=d("option",{value:""},"None",-1)),(M(!0),B(ke,null,He(n.providerOptions,a=>(M(),B("option",{key:a.abbreviation,value:a.abbreviation},Q(a.name)+" ("+Q(a.abbreviation)+") ",9,uz))),128))],512),[[sr,n.singleUser.provider]])])])):ve("",!0),d("div",null,[d("label",dz,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>n.singleUser.testingAccess=a)},null,512),[[_t,n.singleUser.testingAccess]]),e[17]||(e[17]=we(" Testing Access - Can view testing accommodations for all students with separate settings "))]),e[18]||(e[18]=d("small",{class:"help-text"}," Grants access to testing accommodations data for students requiring separate testing environments ",-1))]),d("div",null,[d("label",null,[e[19]||(e[19]=we(" Aeries ID: ")),Oe(d("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=a=>n.singleUser.aeriesId=a),placeholder:"Optional Aeries Teacher ID"},null,512),[[ht,n.singleUser.aeriesId]])])]),d("div",null,[d("label",null,[e[20]||(e[20]=we(" Room: ")),Oe(d("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=a=>n.singleUser.rm=a),placeholder:"Room number (e.g., 101, A-23)"},null,512),[[ht,n.singleUser.rm]])])]),d("div",null,[d("label",null,[e[21]||(e[21]=we(" Extension: ")),Oe(d("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=a=>n.singleUser.ext=a),placeholder:"Phone extension (e.g., 1234)"},null,512),[[ht,n.singleUser.ext]])])]),e[22]||(e[22]=d("button",{type:"submit"},"Add User",-1))],32)]),d("div",fz,[e[24]||(e[24]=d("h3",null,"Bulk Upload Users",-1)),d("div",null,[d("input",{type:"file",ref:"bulkFileInput",accept:".csv, .xls, .xlsx",onChange:e[9]||(e[9]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[10]||(e[10]=(...a)=>n.uploadBulkUsers&&n.uploadBulkUsers(...a)),disabled:!n.selectedFile}," Upload Users ",8,hz)]),e[25]||(e[25]=En('<h4 data-v-377f9072> Import Format &amp; Requirements</h4><div class="format-info" data-v-377f9072><p data-v-377f9072><strong data-v-377f9072> File Format:</strong> CSV, Excel (.xls, .xlsx) - First row must contain column headers</p><p data-v-377f9072><strong data-v-377f9072> Important:</strong> Column order matters! Headers must match exactly or use standard order</p></div><div class="spreadsheet-example" data-v-377f9072><h5 data-v-377f9072> Example Spreadsheet Layout</h5><div class="table-container" data-v-377f9072><table class="example-table" data-v-377f9072><thead data-v-377f9072><tr data-v-377f9072><th data-v-377f9072>Name</th><th data-v-377f9072>Email</th><th data-v-377f9072>Role</th><th data-v-377f9072>Provider</th><th data-v-377f9072>AeriesID</th><th data-v-377f9072>Room</th><th data-v-377f9072>Extension</th></tr></thead><tbody data-v-377f9072><tr data-v-377f9072><td data-v-377f9072>John Smith</td><td data-v-377f9072>john.smith@school.org</td><td data-v-377f9072><span class="role-badge teacher" data-v-377f9072>teacher</span></td><td data-v-377f9072></td><td data-v-377f9072>123456</td><td data-v-377f9072>A-101</td><td data-v-377f9072>1234</td></tr><tr data-v-377f9072><td data-v-377f9072>Jane Doe</td><td data-v-377f9072>jane.doe@school.org</td><td data-v-377f9072><span class="role-badge service-provider" data-v-377f9072>service_provider</span></td><td data-v-377f9072><span class="provider-badge" data-v-377f9072>SLP</span></td><td data-v-377f9072></td><td data-v-377f9072>B-205</td><td data-v-377f9072>5678</td></tr><tr data-v-377f9072><td data-v-377f9072>Bob Johnson</td><td data-v-377f9072>bob.johnson@school.org</td><td data-v-377f9072><span class="role-badge case-manager" data-v-377f9072>case_manager</span></td><td data-v-377f9072></td><td data-v-377f9072>789012</td><td data-v-377f9072>C-150</td><td data-v-377f9072>9101</td></tr></tbody></table></div></div><div class="reference-cards" data-v-377f9072><div class="reference-card roles-card" data-v-377f9072><div class="card-header roles-header" data-v-377f9072><h5 data-v-377f9072> Available Roles</h5><span class="card-count" data-v-377f9072>10 roles</span></div><div class="card-content" data-v-377f9072><div class="compact-grid" data-v-377f9072><div class="compact-item" data-v-377f9072><span class="role-badge admin" data-v-377f9072>admin</span><span class="compact-desc" data-v-377f9072>Full system access</span></div><div class="compact-item" data-v-377f9072><span class="role-badge school-admin" data-v-377f9072>school_admin</span><span class="compact-desc" data-v-377f9072>School-level admin</span></div><div class="compact-item" data-v-377f9072><span class="role-badge staff-view" data-v-377f9072>staff_view</span><span class="compact-desc" data-v-377f9072>View-only access</span></div><div class="compact-item" data-v-377f9072><span class="role-badge staff-edit" data-v-377f9072>staff_edit</span><span class="compact-desc" data-v-377f9072>Edit students, no admin panel</span></div><div class="compact-item" data-v-377f9072><span class="role-badge admin-504" data-v-377f9072>admin_504</span><span class="compact-desc" data-v-377f9072>504-specific admin</span></div><div class="compact-item" data-v-377f9072><span class="role-badge sped-chair" data-v-377f9072>sped_chair</span><span class="compact-desc" data-v-377f9072>SPED chair access</span></div><div class="compact-item" data-v-377f9072><span class="role-badge case-manager" data-v-377f9072>case_manager</span><span class="compact-desc" data-v-377f9072>Case manager access</span></div><div class="compact-item" data-v-377f9072><span class="role-badge teacher" data-v-377f9072>teacher</span><span class="compact-desc" data-v-377f9072>Teacher access</span></div><div class="compact-item" data-v-377f9072><span class="role-badge service-provider" data-v-377f9072>service_provider</span><span class="compact-desc" data-v-377f9072>Service provider access</span></div><div class="compact-item" data-v-377f9072><span class="role-badge paraeducator" data-v-377f9072>paraeducator</span><span class="compact-desc" data-v-377f9072>Paraeducator access</span></div></div></div></div><div class="reference-card providers-card" data-v-377f9072><div class="card-header providers-header" data-v-377f9072><h5 data-v-377f9072> Service Providers</h5><span class="card-count" data-v-377f9072>14 types</span></div><div class="card-content" data-v-377f9072><p class="card-note" data-v-377f9072><strong data-v-377f9072> Note:</strong> Use abbreviation only in import file</p><div class="compact-grid" data-v-377f9072><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>SLP</span><span class="compact-desc" data-v-377f9072>Speech-Language Therapy</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>OT</span><span class="compact-desc" data-v-377f9072>Occupational Therapy</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>PT</span><span class="compact-desc" data-v-377f9072>Physical Therapy</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>SC</span><span class="compact-desc" data-v-377f9072>School Counseling</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>MH</span><span class="compact-desc" data-v-377f9072>School-Based Mental Health</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>TR</span><span class="compact-desc" data-v-377f9072>Transportation</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>AUD</span><span class="compact-desc" data-v-377f9072>Audiology Services</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>VI</span><span class="compact-desc" data-v-377f9072>Vision Services</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>AT</span><span class="compact-desc" data-v-377f9072>Assistive Technology</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>DHH</span><span class="compact-desc" data-v-377f9072>Deaf and Hard of Hearing</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>O&amp;M</span><span class="compact-desc" data-v-377f9072>Orientation and Mobility</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>BIS</span><span class="compact-desc" data-v-377f9072>Behavioral Intervention</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>HN</span><span class="compact-desc" data-v-377f9072>Health/Nursing Services</span></div><div class="compact-item" data-v-377f9072><span class="provider-badge" data-v-377f9072>SW</span><span class="compact-desc" data-v-377f9072>Social Work Services</span></div></div></div></div><div class="reference-card aeries-card" data-v-377f9072><div class="card-header aeries-header" data-v-377f9072><h5 data-v-377f9072> Aeries ID / SIS ID</h5><span class="card-count" data-v-377f9072>6-digit numeric</span></div><div class="card-content" data-v-377f9072><div class="aeries-info" data-v-377f9072><div class="info-item" data-v-377f9072><span class="info-label" data-v-377f9072>Purpose:</span><span class="info-value" data-v-377f9072>Links teachers to classes in Aeries/SIS systems</span></div><div class="info-item" data-v-377f9072><span class="info-label" data-v-377f9072>Format:</span><span class="info-value" data-v-377f9072>123456 (6-digit numeric)</span></div><div class="info-item" data-v-377f9072><span class="info-label" data-v-377f9072>Required for:</span><span class="info-value" data-v-377f9072>Teachers &amp; service providers who teach classes</span></div><div class="info-item" data-v-377f9072><span class="info-label" data-v-377f9072>Optional for:</span><span class="info-value" data-v-377f9072>Admin roles, case managers, paraeducators</span></div></div></div></div></div><div class="troubleshooting-notes" data-v-377f9072><h5 data-v-377f9072> Troubleshooting Tips</h5><div class="tips-grid" data-v-377f9072><div class="tip-item" data-v-377f9072><strong data-v-377f9072> Column Headers:</strong><ul data-v-377f9072><li data-v-377f9072>Use exact header names: Name, Email, Role, Provider, AeriesID</li><li data-v-377f9072>Or use standard order: Name (1st), Email (2nd), Role (3rd), Provider (4th), AeriesID (5th)</li></ul></div><div class="tip-item" data-v-377f9072><strong data-v-377f9072> Validation:</strong><ul data-v-377f9072><li data-v-377f9072>All emails must be valid format</li><li data-v-377f9072>Roles must match exactly (case-sensitive)</li><li data-v-377f9072>Provider types only for service_provider role</li><li data-v-377f9072>Use provider abbreviations only (SLP, OT, PT, etc.)</li></ul></div><div class="tip-item" data-v-377f9072><strong data-v-377f9072> Common Issues:</strong><ul data-v-377f9072><li data-v-377f9072>Extra spaces in role names</li><li data-v-377f9072>Missing quotes around values with commas</li><li data-v-377f9072>Invalid email formats</li><li data-v-377f9072>Non-numeric Aeries IDs</li><li data-v-377f9072>Using full provider names instead of abbreviations</li></ul></div></div></div>',5))]),n.statusMessage?(M(),B("div",{key:0,class:Ye(["status-msg",{error:n.isError}])},Q(n.statusMessage),3)):ve("",!0)])}const mz=St(az,[["render",pz],["__scopeId","data-v-377f9072"]]),Ja=se({}),Qf=se(!1),fg=se(!1);function A4(){const t=Qr(),e=_e(()=>t.currentUser),r=async()=>{if(Qf.value||fg.value)return Ja.value;Qf.value=!0;try{const o=et(Xe,"app_settings","admin_panel_permissions"),l=await er(o);return l.exists()?Ja.value=l.data():Ja.value={},fg.value=!0,Ja.value}catch(o){return console.error("Error loading admin panel permissions:",o),Ja.value={},Ja.value}finally{Qf.value=!1}},n=_e(()=>o=>{var c,u;if(!((c=e.value)!=null&&c.role)||!Ja.value[o])return!1;const l=e.value.role;return l==="admin"?!0:((u=Ja.value[o])==null?void 0:u[l])===!0}),s=_e(()=>n.value("delete-all-users")),i=_e(()=>n.value("delete-all-students"));return{permissions:Ja,isLoading:Qf,hasPermission:n,canDeleteAllUsers:s,canDeleteAllStudents:i,loadPermissions:r,initializeIfNeeded:async()=>{fg.value||await r()}}}const gz={class:"admin-form-row"},vz={class:"search-type-radios"},yz={class:"user-admin-table striped"},xz={key:0},Ez=["data-userid"],bz=["value","disabled","onInput"],_z={key:0,class:"testing-access-full",title:"Full access role - always has testing access"},Sz=["value","onChange"],Az=["disabled","value","onChange"],Tz=["value"],wz={key:0},Cz={key:0},Iz={key:1},kz=["value","onChange"],Dz=["value"],Pz={key:1},Rz={class:"admin-action-btns"},Fz=["onClick"],Nz=["onClick"],Oz=["onClick"],Mz={class:"admin-pagination"},Lz=["disabled"],Bz=["disabled"],fu=20,Uz={__name:"UserTable",setup(t){const e=xo(),r=se([]),n=se(1),s=se("name"),i=se(""),a=se(null),o=se(""),l=se(!1),c=se(!1),u=se([]),f=se(null),h=Ko,p=Ts(),g=p.appSettings,y=p.loadAppSettings,{canDeleteAllUsers:_,initializeIfNeeded:x}=A4();let b=null;const v=()=>{b&&clearTimeout(b),b=setTimeout(()=>{E()},300)},T=_e(()=>{var O;return Array.isArray((O=g.value)==null?void 0:O.serviceProviders)&&g.value.serviceProviders.length>0}),D=_e(()=>{var O;return((O=g.value)==null?void 0:O.serviceProviders)||[]}),k=O=>["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(O),S=(O,V=!1)=>{o.value=O,l.value=V,O&&setTimeout(()=>{o.value="",l.value=!1},5e3)},E=()=>{n.value=1,m()},m=async(O="first")=>{const V=At(e,"users");let z;if(i.value&&s.value==="name"){const j=(await Gt(lr(V,vn("name"),la(1e3)))).docs.map(ee=>({id:ee.id,...ee.data()})).filter(ee=>(ee.name||"").toLowerCase().includes(i.value.toLowerCase()));a.value=null,r.value=j,c.value=!1;return}i.value&&s.value==="email"?z=lr(V,vn("email"),Ur("email",">=",i.value),Ur("email","<=",i.value+""),la(fu)):i.value?z=lr(V,vn("name"),Ur("name",">=",i.value),Ur("name","<=",i.value+""),la(fu)):z=lr(V,vn("name"),la(fu)),O==="next"&&u.value.length&&(z=lr(V,vn(s.value),xh(u.value[u.value.length-1]),la(fu)));const U=await Gt(z);u.value=U.docs,a.value=null,r.value=u.value.map(G=>({id:G.id,...G.data()})),c.value=U.size===fu},A=O=>{if(a.value)return;a.value=O;const V=r.value.find(z=>z.id===O);f.value={...V,testingAccess:V.testingAccess||!1}},I=()=>{a.value=null,f.value=null,m()},C=(O,V,z)=>{f.value&&f.value.id===O&&(f.value[V]=z)},F=async O=>{var V,z;if(!(!f.value||f.value.id!==O))try{const U=r.value.find(j=>j.id===O),G={};f.value.name!==void 0&&(G.name=((V=f.value.name)==null?void 0:V.trim())||null),f.value.title!==void 0&&(G.title=((z=f.value.title)==null?void 0:z.trim())||null),f.value.role!==void 0&&(G.role=f.value.role),f.value.provider!==void 0&&(G.provider=f.value.provider||null),f.value.testingAccess!==void 0&&(G.testingAccess=f.value.testingAccess),await Op(et(e,"users",O),G),await an.logUserManagement(O,"update",{originalData:{name:U==null?void 0:U.name,title:U==null?void 0:U.title,role:U==null?void 0:U.role,provider:U==null?void 0:U.provider,testingAccess:U==null?void 0:U.testingAccess},updatedData:G,changedFields:Object.keys(G)}),S(" User updated."),a.value=null,f.value=null,m()}catch(U){console.error("Error updating user:",U),S(` Error updating user: ${U.message}`,!0),await an.logUserManagement(O,"update_failed",{error:U.message,attemptedData:updateData})}},W=async O=>{if(confirm("Are you sure you want to delete this user?"))try{const V=r.value.find(z=>z.id===O);await mo(et(e,"users",O)),await an.logUserManagement(O,"delete",{deletedUser:{name:V==null?void 0:V.name,email:V==null?void 0:V.email,role:V==null?void 0:V.role,provider:V==null?void 0:V.provider}}),S(" User deleted."),a.value=null,f.value=null,m()}catch(V){console.error("Error deleting user:",V),S(` Error deleting user: ${V.message}`,!0),await an.logUserManagement(O,"delete_failed",{error:V.message})}},P=async()=>{if(prompt("Type DELETE ALL USERS to confirm:")==="DELETE ALL USERS")try{const V=await Gt(At(e,"users"));await Promise.all(V.docs.map(z=>mo(et(e,"users",z.id)))),S(" All users deleted."),n.value=1,m()}catch(V){console.error("Error deleting all users:",V),S(` Error deleting all users: ${V.message}`,!0)}},R=()=>{n.value++,m("next")},N=()=>{n.value>1&&(n.value--,m())},L=O=>{var j;if(!O)return"";const z=(((j=g.value)==null?void 0:j.customServiceProviders)||[]).find(ee=>ee.abbreviation===O);if(z)return`${z.name} (${z.abbreviation})`;const G=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}].find(ee=>ee.abbreviation===O);return G?`${G.name} (${G.abbreviation})`:O};return Wt(async()=>{await y(),await x(),m()}),ja(()=>{b&&clearTimeout(b)}),(O,V)=>(M(),B("div",null,[V[14]||(V[14]=d("h2",null,"Edit Users",-1)),d("div",gz,[Oe(d("input",{type:"text","onUpdate:modelValue":V[0]||(V[0]=z=>i.value=z),placeholder:"Search by name or email",class:"admin-search-input",onInput:v},null,544),[[ht,i.value]]),d("div",vz,[d("label",null,[Oe(d("input",{type:"radio","onUpdate:modelValue":V[1]||(V[1]=z=>s.value=z),value:"name",onChange:E},null,544),[[Ss,s.value]]),V[3]||(V[3]=we(" Name "))]),d("label",null,[Oe(d("input",{type:"radio","onUpdate:modelValue":V[2]||(V[2]=z=>s.value=z),value:"email",onChange:E},null,544),[[Ss,s.value]]),V[4]||(V[4]=we(" Email "))])]),q(_)?(M(),B("button",{key:0,onClick:P,class:"delete-all-btn"},[Re(q(qo),{size:16}),V[5]||(V[5]=we(" Delete All Users "))])):ve("",!0)]),o.value?(M(),B("div",{key:0,class:Ye(["admin-status-msg",{error:l.value}])},Q(o.value),3)):ve("",!0),d("div",null,[d("table",yz,[V[11]||(V[11]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Testing Access"),d("th",null,"Email"),d("th",null,"Role"),d("th",null,"Provider Type"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[r.value.length===0?(M(),B("tr",xz,V[6]||(V[6]=[d("td",{colspan:"6"},"No users found.",-1)]))):ve("",!0),(M(!0),B(ke,null,He(r.value,z=>(M(),B("tr",{key:z.id,class:Ye({"active-row":a.value===z.id}),"data-userid":z.id},[d("td",null,[d("input",{type:"text",value:z.name||"",class:"editable-input",disabled:a.value!==z.id,onInput:U=>C(z.id,"name",U.target.value)},null,40,bz)]),d("td",null,[k(z.role)?(M(),B("span",_z,[Re(q(ZL),{size:16,class:"check-icon"}),V[7]||(V[7]=we(" Always "))])):a.value===z.id?(M(),B("select",{key:1,class:"editable-select",value:f.value.testingAccess?"true":"false",onChange:U=>C(z.id,"testingAccess",U.target.value==="true")},V[8]||(V[8]=[d("option",{value:"false"},"No",-1),d("option",{value:"true"},"Yes",-1)]),40,Sz)):(M(),B("span",{key:2,class:Ye(["testing-access-badge",{active:z.testingAccess}])},Q(z.testingAccess?"Yes":"No"),3))]),d("td",null,Q(z.email),1),d("td",null,[d("select",{class:"editable-select",disabled:a.value!==z.id,value:a.value===z.id?f.value.role:z.role,onChange:U=>C(z.id,"role",U.target.value)},[(M(!0),B(ke,null,He(q(h),U=>(M(),B("option",{key:U,value:U},Q(U.replace(/_/g," ")),9,Tz))),128))],40,Az)]),T.value?(M(),B("td",wz,[a.value!==z.id?(M(),B("span",Cz,Q(L(z.provider)||""),1)):(M(),B("span",Iz,[d("select",{value:f.value.provider||"",onChange:U=>C(z.id,"provider",U.target.value)},[V[9]||(V[9]=d("option",{value:""},"None",-1)),(M(!0),B(ke,null,He(D.value,U=>(M(),B("option",{key:U,value:U},Q(L(U)),9,Dz))),128))],40,kz)]))])):(M(),B("td",Pz,V[10]||(V[10]=[d("span",null,"Loading...",-1)]))),d("td",Rz,[a.value!==z.id?(M(),B("button",{key:0,onClick:U=>A(z.id),class:"admin-action-btn edit",title:"Edit"},[Re(q(Zy),{size:16})],8,Fz)):(M(),B(ke,{key:1},[d("button",{onClick:U=>F(z.id),class:"admin-action-btn save",title:"Save"},[Re(q(l4),{size:16})],8,Nz),d("button",{onClick:I,class:"admin-action-btn cancel",title:"Cancel"},[Re(q(h4),{size:16})]),d("button",{onClick:U=>W(z.id),class:"admin-action-btn delete red",title:"Delete User"},[Re(q(qo),{size:16})],8,Oz)],64))])],10,Ez))),128))])])]),d("div",Mz,[d("button",{onClick:N,disabled:n.value===1,class:"admin-btn"},[Re(q(a4),{size:16}),V[12]||(V[12]=we(" Previous "))],8,Lz),d("span",null,"Page "+Q(n.value),1),d("button",{onClick:R,disabled:!c.value,class:"admin-btn"},[V[13]||(V[13]=we(" Next ")),Re(q(s4),{size:16})],8,Bz)])]))}},$z=St(Uz,[["__scopeId","data-v-eae954e1"]]),Vz={class:"admin-students"},Hz={class:"admin-form-row"},jz={class:"student-admin-table striped"},Gz={key:0},Wz=["data-id"],zz={style:{display:"none"}},Kz=["value","disabled","onInput"],qz=["value","disabled","onInput"],Xz=["value","disabled","onInput"],Yz=["value","disabled","onChange"],Qz=["value","disabled","onChange"],Jz=["value"],Zz=["title"],eK={class:"admin-action-btns"},tK=["onClick"],rK=["onClick"],nK=["onClick"],sK={class:"admin-pagination"},aK=["disabled"],iK=["disabled"],hg=50,oK={__name:"AdminStudents",setup(t){const e=xo(),{students:r,fetchStudents:n,deleteStudent:s}=Di(),{caseManagers:i,fetchUsers:a}=_a(),{canDeleteAllStudents:o,initializeIfNeeded:l}=A4(),c=se(""),u=se([]),f=se(1),h=se(null),p=se({}),g=se(""),y=se(!1);let _=null;const x=()=>{_&&clearTimeout(_),_=setTimeout(()=>{D()},300)},b=_e(()=>{const N=(f.value-1)*hg,L=N+hg;return u.value.slice(N,L)}),v=_e(()=>Math.ceil(u.value.length/hg)),T=(N,L=!1)=>{g.value=N,y.value=L,setTimeout(()=>{g.value="",y.value=!1},5e3)},D=()=>{if(!Fs("studentSearch",20,6e4).allowed){T("Too many search requests. Please wait before searching again.",!0);return}const L=qr(c.value,100),O=Hr(L);if(!O.isSafe){T(`Security threat detected in search: ${O.threats.join(", ")}`,!0),c.value=L;return}L!==c.value&&(c.value=L);const V=L.toLowerCase();V?u.value=r.value.filter(z=>{const U=at(z,"firstName")||"",G=at(z,"lastName")||"";return`${U} ${G}`.toLowerCase().includes(V)}):u.value=r.value,f.value=1},k=N=>{var O;if(console.log(" ADMIN EDIT DEBUG - Starting edit:",{studentId:N,activeEditId:h.value,studentExists:!!r.value.find(V=>V.id===N)}),h.value)return;const L=r.value.find(V=>V.id===N);L?(console.log(" ADMIN EDIT DEBUG - Student found:",{id:L.id,hasApp:!!L.app,appStudentData:(O=L.app)==null?void 0:O.studentData,keys:Object.keys(L)}),h.value=N,p.value=JSON.parse(JSON.stringify(L)),console.log(" ADMIN EDIT DEBUG - Edit state set:",{activeEditId:h.value,editingStudentId:p.value.id})):console.error(" ADMIN EDIT DEBUG - Student not found!")},S=()=>{h.value=null,p.value={}},E=(N,L,O)=>{if(p.value.id===N){console.log(" ADMIN UPDATE DEBUG - Updating field:",{studentId:N,field:L,value:O,currentValue:at(p.value,L)});let V=O;if(L==="caseManagerId")V=O;else if(typeof O=="string"){V=qr(O,L==="grade"?10:100);const z=Hr(V);if(!z.isSafe){T(`Security threat detected in ${L}: ${z.threats.join(", ")}`,!0);return}const U=Id(V,L,0,L==="grade"?10:100);if(!U.isValid){T(U.error,!0);return}}["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(L)?(p.value.app||(p.value.app={}),p.value.app.studentData||(p.value.app.studentData={}),p.value.app.studentData[L]=V):p.value[L]=V,console.log(" ADMIN UPDATE DEBUG - Updated field:",{field:L,newValue:V,updatedPath:["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(L)?`app.studentData.${L}`:L})}},m=async N=>{var L,O,V,z,U;try{console.log(" ADMIN SAVE DEBUG - Starting saveStudent:",{studentId:N,editingStudentId:p.value.id,editingStudentKeys:Object.keys(p.value),hasStudentInList:!!r.value.find(Y=>Y.id===N)});const G=Qr(),j=_e(()=>G.currentUser);if(console.log(" PERMISSION DEBUG:",{currentUser:j.value,userRole:(L=j.value)==null?void 0:L.role,userEmail:(O=j.value)==null?void 0:O.email,userId:(V=j.value)==null?void 0:V.uid}),!Fs("saveStudent",10,6e4).allowed){T("Too many save requests. Please wait before saving again.",!0);return}const ae={},ne=r.value.find(Y=>Y.id===N),le=["firstName","lastName","grade","plan","ssid","caseManagerId"];let Z={},J=!1;if(le.forEach(Y=>{const fe=at(p.value,Y),ye=at(ne,Y);fe!==ye&&(Z[Y]=fe,J=!0,console.log(` CHANGE DETECTED - ${Y}: "${ye}"  "${fe}"`))}),J&&(ae.app={studentData:{...(z=ne.app)==null?void 0:z.studentData,...Z}}),Object.keys(p.value).forEach(Y=>{Y!=="id"&&Y!=="app"&&p.value[Y]!==ne[Y]&&(ae[Y]=p.value[Y])}),console.log(" ADMIN SAVE DEBUG - Updates prepared:",ae),Object.keys(ae).length===0){S();return}const ge=g4(ae),te=m4(ge,{isNew:!1});if(!te.isValid){T(`Validation failed: ${te.errors.join(", ")}`,!0);return}ge.updatedAt=Pn(),ge.updatedBy=((U=j.value)==null?void 0:U.uid)||null,Object.assign(p.value,ge),console.log(" ADMIN SAVE DEBUG - Calling setDoc with merge:",{studentId:N,sanitizedUpdates:ge}),await $t(et(e,"students",N),ge,{merge:!0}),console.log(" ADMIN SAVE DEBUG - updateStudent completed successfully");const K=r.value.findIndex(Y=>Y.id===N);if(K!==-1){const Y={...r.value[K]};Object.keys(ge).forEach(fe=>{fe==="app.studentData"?(Y.app||(Y.app={}),Y.app.studentData={...Y.app.studentData,...ge[fe]}):Y[fe]=ge[fe]}),r.value[K]=Y}console.log(" ADMIN SAVE DEBUG - Local state updated"),T(" Student updated.")}catch(G){console.error(" ADMIN SAVE DEBUG - Save failed:",G),T(" Update failed.",!0),console.error("Update error:",G)}finally{S()}},A=async N=>{if(!Fs("deleteStudent",5,3e5).allowed){T("Too many delete requests. Please wait before deleting again.",!0);return}if(confirm("Are you sure you want to delete this student? This action cannot be undone."))try{await s(N),T(" Student deleted.");const O=r.value.findIndex(V=>V.id===N);O!==-1&&r.value.splice(O,1),D()}catch(O){T(" Delete failed.",!0),console.error("Delete error:",O)}},I=async()=>{if(!Fs("deleteAllStudents",1,36e5).allowed){T("Delete all operation rate limited. Please wait before trying again.",!0);return}const L=`Are you sure you want to delete ALL ${r.value.length} students? 

This action cannot be undone and will permanently remove all student data.

Type "DELETE ALL STUDENTS" to confirm:`;if(prompt(L)!=="DELETE ALL STUDENTS"){T("Delete all operation cancelled.",!1);return}try{T("Deleting all students...");const V=Ly(e);let z=0;for(const U of r.value)V.delete(et(e,"students",U.id)),z++,z>=500&&(await V.commit(),z=0);z>0&&await V.commit(),r.value=[],u.value=[],T(" All students deleted.")}catch(V){T(" Failed to delete all students.",!0),console.error("Delete all error:",V)}},C=N=>{if(!N)return"N/A";try{if(N&&typeof N.toDate=="function")return N.toDate().toLocaleDateString();const L=new Date(N);return isNaN(L.getTime())?"Invalid Date":L.toLocaleDateString()}catch{return"Invalid Date"}},F=N=>{var L;return((L=N.app)==null?void 0:L.staffIds)&&Array.isArray(N.app.staffIds)&&N.app.staffIds.length>0},W=N=>F(N)?`Staff ID Array present (${N.app.staffIds.length} staff members)`:"Staff ID Array missing or empty",P=()=>{f.value<v.value&&f.value++},R=()=>{f.value>1&&f.value--};return Wt(async()=>{try{await Promise.all([n(),a(),l()]),u.value=r.value,console.log(" ADMIN DEBUG - Case managers loaded:",i.value.length)}catch(N){T("Failed to load data.",!0),console.error("Load data error:",N)}}),ja(()=>{_&&clearTimeout(_)}),(N,L)=>(M(),B("div",Vz,[L[8]||(L[8]=d("h2",null,"Edit Students",-1)),d("div",Hz,[Oe(d("input",{type:"text","onUpdate:modelValue":L[0]||(L[0]=O=>c.value=O),onInput:x,placeholder:"Search by name",class:"admin-search-input"},null,544),[[ht,c.value]]),q(o)?(M(),B("button",{key:0,onClick:I,class:"delete-all-btn"},[Re(q(qo),{size:16}),L[1]||(L[1]=we(" Delete All Students "))])):ve("",!0)]),g.value?(M(),B("div",{key:0,class:Ye(["admin-status-msg",{error:y.value}])},Q(g.value),3)):ve("",!0),d("table",jz,[L[5]||(L[5]=d("thead",null,[d("tr",null,[d("th",null,"SSID"),d("th",{style:{display:"none"}},"Student ID"),d("th",null,"First Name"),d("th",null,"Last Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",{title:"Staff ID Array present"},"staffIdArr"),d("th",null,"Date Added"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[b.value.length?ve("",!0):(M(),B("tr",Gz,L[2]||(L[2]=[d("td",{colspan:"10"},"No students found.",-1)]))),(M(!0),B(ke,null,He(b.value,O=>(M(),B("tr",{key:O.id,class:Ye({"active-row":h.value===O.id}),"data-id":O.id},[d("td",null,Q(q(at)(O,"ssid")||O.id),1),d("td",zz,Q(O.id),1),d("td",null,[d("input",{class:"editable-input","data-field":"firstName",value:q(at)(O,"firstName")||"",disabled:h.value!==O.id,onInput:V=>E(O.id,"firstName",V.target.value)},null,40,Kz)]),d("td",null,[d("input",{class:"editable-input","data-field":"lastName",value:q(at)(O,"lastName")||"",disabled:h.value!==O.id,onInput:V=>E(O.id,"lastName",V.target.value)},null,40,qz)]),d("td",null,[d("input",{class:"editable-input","data-field":"grade",value:q(at)(O,"grade")||"",disabled:h.value!==O.id,onInput:V=>E(O.id,"grade",V.target.value)},null,40,Xz)]),d("td",null,[d("select",{class:"editable-select","data-field":"plan",value:q(at)(O,"plan")||"",disabled:h.value!==O.id,onChange:V=>E(O.id,"plan",V.target.value)},L[3]||(L[3]=[d("option",{value:""},"Select Plan",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),40,Yz)]),d("td",null,[d("select",{class:"editable-select","data-field":"caseManagerId",value:q(at)(O,"caseManagerId")||"",disabled:h.value!==O.id,onChange:V=>E(O.id,"caseManagerId",V.target.value)},[L[4]||(L[4]=d("option",{value:""},"-- Select Case Manager --",-1)),(M(!0),B(ke,null,He(q(i),V=>(M(),B("option",{key:V.id,value:V.id},Q(V.name||V.email||V.id),9,Jz))),128))],40,Qz)]),d("td",{class:"staff-id-status",title:W(O)},[d("span",{class:Ye(["status-icon",F(O)?"present":"missing"])},Q(F(O)?"":""),3)],8,Zz),d("td",null,Q(C(O.created_at)),1),d("td",eK,[h.value===O.id?(M(),B(ke,{key:0},[d("button",{onClick:V=>m(O.id),class:"admin-action-btn save",title:"Save"},[Re(q(l4),{size:16})],8,tK),d("button",{onClick:S,class:"admin-action-btn cancel",title:"Cancel"},[Re(q(h4),{size:16})]),d("button",{onClick:V=>A(O.id),class:"admin-action-btn delete red",title:"Delete Student"},[Re(q(qo),{size:16})],8,rK)],64)):(M(),B("button",{key:1,onClick:V=>k(O.id),class:"admin-action-btn edit",title:"Edit"},[Re(q(Zy),{size:16})],8,nK))])],10,Wz))),128))])]),d("div",sK,[d("button",{onClick:R,disabled:f.value===1,class:"admin-btn"},[Re(q(a4),{size:16}),L[6]||(L[6]=we(" Prev "))],8,aK),d("span",null,"Page "+Q(f.value)+" of "+Q(v.value),1),d("button",{onClick:P,disabled:f.value===v.value,class:"admin-btn"},[L[7]||(L[7]=we(" Next ")),Re(q(s4),{size:16})],8,iK)])]))}},lK=St(oK,[["__scopeId","data-v-7d623798"]]),cK={class:"bulk-importer"},uK={key:0,class:"step-container"},dK={class:"file-upload-section"},fK={class:"file-input-wrapper"},hK={for:"csv-file",class:"file-label"},pK={class:"file-text"},mK={key:0,class:"error-message"},gK={key:1,class:"file-info"},vK={key:0},yK={class:"step-actions"},xK=["disabled"],EK={key:1,class:"step-container"},bK={class:"field-mapping-section"},_K={class:"mapping-grid"},SK={class:"csv-column"},AK={class:"app-field"},TK=["onUpdate:modelValue"],wK={class:"sample-data"},CK={key:0,class:"validation-errors"},IK={class:"step-actions"},kK=["disabled"],DK={key:2,class:"step-container"},PK={class:"preview-section"},RK={class:"preview-stats"},FK={class:"stat-item"},NK={class:"stat-value"},OK={class:"stat-item"},MK={class:"stat-value valid"},LK={class:"stat-item"},BK={class:"stat-value invalid"},UK={class:"preview-table-container"},$K={class:"preview-table"},VK={key:0,class:"error-list"},HK={key:1,class:"no-errors"},jK={class:"import-options"},GK={class:"options-grid"},WK={class:"option-item"},zK={class:"option-item"},KK={class:"option-item"},qK={class:"step-actions"},XK=["disabled"],YK={key:3,class:"step-container"},QK={class:"results-section"},JK={class:"results-stats"},ZK={class:"stat-item success"},eq={class:"stat-value"},tq={class:"stat-item error"},rq={class:"stat-value"},nq={class:"stat-item"},sq={class:"stat-value"},aq={key:0,class:"import-errors"},iq={class:"results-actions"},oq={key:4,class:"loading-overlay"},lq={class:"loading-content"},cq={class:"progress-bar"},uq={__name:"StudentBulkImporter",emits:["close","imported"],setup(t,{emit:e}){const r=e,{users:n,fetchUsers:s}=_a(),i=se(1),a=se(""),o=se(""),l=se([]),c=se([]),u=se({}),f=se(""),h=se([]),p=se([]),g=se("valid-only"),y=se(!1),_=se(!1),x=se(0),b=se({successful:0,failed:0,errors:[],processingTime:0}),v=se(null),T=_e(()=>{const Z=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],J=Object.values(u.value).filter(te=>te),ge=J.includes("app.studentData.ssid");return Z.every(te=>J.includes(te))&&ge}),D=_e(()=>p.value.filter(Z=>Z.errors.length===0)),k=_e(()=>p.value.filter(Z=>Z.errors.length>0));Wt(async()=>{console.log(" StudentBulkImporter component mounted!");try{await s(),console.log(" Users loaded successfully:",Object.keys(n.value).length,"users"),console.log("First few users:",Object.values(n.value).slice(0,3).map(Z=>({id:Z.id,name:Z.name,role:Z.role})))}catch(Z){console.error(" Failed to load users:",Z)}});const S=async Z=>{const J=Z.target.files[0];if(J){if(!J.name.toLowerCase().endsWith(".csv")&&J.type!=="text/csv"){f.value="File must be a CSV file (.csv extension)";return}if(J.size>10*1024*1024){f.value="File must be smaller than 10MB";return}f.value="",a.value=J.name,o.value=V(J.size);try{const ge=await J.text();E(ge)}catch(ge){f.value="Failed to read CSV file: "+ge.message}}},E=Z=>{try{const J=Z.trim().split(`
`);if(J.length<2)throw new Error("CSV must have at least a header row and one data row");const ge=J[0].split(",").map(K=>K.trim().replace(/"/g,""));c.value=ge;const te=[];for(let K=1;K<J.length;K++){const Y={};let fe="",ye=!1,ie=0;for(let ue=0;ue<J[K].length;ue++){const Ee=J[K][ue];Ee==='"'?ye=!ye:Ee===","&&!ye?(Y[ge[ie]]=fe.trim().replace(/^"|"$/g,""),fe="",ie++):fe+=Ee}ie<ge.length&&(Y[ge[ie]]=fe.trim().replace(/^"|"$/g,"")),te.push(Y)}l.value=te,console.log("Parsed CSV data:",te.length,"records")}catch(J){f.value="Failed to parse CSV: "+J.message}},m=()=>{console.log(" DEBUG: Auto-mapping started"),console.log(" DEBUG: csvHeaders.value:",c.value);const Z={SSID:"app.studentData.ssid",FirstName:"app.studentData.firstName",LastName:"app.studentData.lastName",Grade:"app.studentData.grade",Plan:"app.studentData.plan",CaseManagerId:"app.studentData.caseManagerId",ReviewDate:"app.dates.reviewDate",ReevalDate:"app.dates.reevalDate",MeetingDate:"app.dates.meetingDate",Period1Teacher:"app.schedule.periods.1",Period2Teacher:"app.schedule.periods.2",Period3Teacher:"app.schedule.periods.3",Period4Teacher:"app.schedule.periods.4",Period5Teacher:"app.schedule.periods.5",Period6Teacher:"app.schedule.periods.6",Period7Teacher:"app.schedule.periods.7",ClassServices:"app.schedule.classServices",SpeechProvider:"app.providers.speechId",OTProvider:"app.providers.otId",PTProvider:"app.providers.ptId",ATProvider:"app.providers.atId",Audiologist:"app.providers.audId",BISProvider:"app.providers.bisId",DHHProvider:"app.providers.dhhId",HNProvider:"app.providers.hnId",MHProvider:"app.providers.mhId",OMProvider:"app.providers.omId",SCProvider:"app.providers.scId",SWProvider:"app.providers.swId",TRProvider:"app.providers.trId",VIProvider:"app.providers.viId",Flag1:"app.flags.flag1",Flag2:"app.flags.flag2",BIPPdfUrl:"app.documents.bipPdfUrl",AtAGlancePdfUrl:"app.documents.ataglancePdfUrl",Assessment:"app.accommodations.assessment",Instruction:"app.accommodations.instruction"};console.log(" DEBUG: commonMappings keys:",Object.keys(Z));let J=0;c.value.forEach(ge=>{Z[ge]?(u.value[ge]=Z[ge],J++,console.log(` DEBUG: Mapped ${ge} -> ${Z[ge]}`)):console.log(` DEBUG: No mapping for header: "${ge}"`)}),console.log(` DEBUG: Auto-mapping complete. Mapped ${J} fields.`),console.log(" DEBUG: fieldMapping.value:",u.value)},A=()=>{u.value={}},I=Z=>{const J=l.value[0];if(!J)return"";const ge=J[Z];return ge?Z==="ClassServices"&&ge.includes(",")?`"${ge}"`:ge:""},C=()=>{h.value=[];const Z=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],J=Object.values(u.value).filter(K=>K),ge=J.includes("app.studentData.ssid");Z.forEach(K=>{if(!J.includes(K)){const Y=K.split(".").pop();h.value.push(`Required field "${Y}" is not mapped`)}}),ge||h.value.push("SSID (State Student ID) must be mapped to app.studentData.ssid");const te=J.filter((K,Y)=>J.indexOf(K)!==Y);te.length>0&&h.value.push(`Duplicate field mappings: ${te.join(", ")}`)},F=()=>{p.value=l.value.map(Z=>{const J=W(Z),ge=R(J);return console.log("Row mapping:",{original:Z,mapped:J,errors:ge}),{data:J,errors:ge}})},W=Z=>{const J={app:{studentData:{},dates:{},providers:{},accommodations:{},flags:{},schedule:{periods:{},classServices:[]},documents:{}}};return Object.entries(u.value).forEach(([ge,te])=>{if(!te||!Z[ge])return;let K=Z[ge].trim();if(!K)return;if(te==="app.schedule.classServices"){K.startsWith('"')&&K.endsWith('"')&&(K=K.slice(1,-1)),J.app.schedule.classServices=K.split(",").map(ye=>ye.trim()).filter(Boolean);return}if(te.startsWith("app.schedule.periods.")){const ye=te.split(".").pop(),ie=K.trim();if(ie){const ue=j(ie);console.log(`Mapping Period ${ye} teacher:`,ie,"",ue),J.app.schedule.periods[ye]=ue}return}if(te.startsWith("app.providers.")){const ye=te.split(".").pop(),ie=K.trim();if(ie){const ue=ee(ie);console.log(`Mapping ${ye} provider:`,ie,"",ue),J.app.providers[ye]=ue}return}if(te==="app.accommodations.assessment"||te==="app.accommodations.instruction"){const ye=te.split(".").pop();J.app.accommodations[ye]=K;return}if(te.startsWith("app.flags.")){const ye=te.split(".").pop();J.app.flags[ye]=["true","1","yes","y"].includes(K.toLowerCase());return}if(te.includes("Date")){const[ye,ie,ue]=te.split(".");J[ye][ie]||(J[ye][ie]={}),J[ye][ie][ue]=L(K);return}const Y=te.split(".");let fe=J;for(let ye=0;ye<Y.length-1;ye++){const ie=Y[ye];fe[ie]||(fe[ie]={}),fe=fe[ie]}fe[Y[Y.length-1]]=K}),J},P=Z=>{const J=Object.values(n.value).find(ge=>ge.id===Z||ge.name===Z||ge.email===Z||ge.aeriesId===Z);return console.log("Mapping case manager:",Z,"to Firebase ID:",J==null?void 0:J.id),J?J.id:Z},R=Z=>{var te,K,Y,fe,ye,ie,ue,Ee,Ce,Pe,Te,ze,Ie,be,Me,Ke,qe,Se;const J=[],ge=Z.ssid||((K=(te=Z.app)==null?void 0:te.studentData)==null?void 0:K.ssid);return ge||J.push("SSID is required (either top-level or in app.studentData)"),(fe=(Y=Z.app)==null?void 0:Y.studentData)!=null&&fe.firstName||J.push("First name is required"),(ie=(ye=Z.app)==null?void 0:ye.studentData)!=null&&ie.lastName||J.push("Last name is required"),(Ee=(ue=Z.app)==null?void 0:ue.studentData)!=null&&Ee.grade||J.push("Grade is required"),ge&&!/^\d{9,10}$/.test(ge)&&J.push("SSID must be 9-10 digits"),(Pe=(Ce=Z.app)==null?void 0:Ce.studentData)!=null&&Pe.grade&&!["K","1","2","3","4","5","6","7","8","9","10","11","12"].includes(Z.app.studentData.grade)&&J.push("Grade must be K-12"),(ze=(Te=Z.app)==null?void 0:Te.studentData)!=null&&ze.plan&&!["IEP","504"].includes(Z.app.studentData.plan)&&J.push("Plan must be IEP or 504"),(be=(Ie=Z.app)==null?void 0:Ie.dates)!=null&&be.reviewDate&&!N(Z.app.dates.reviewDate)&&J.push("Invalid review date format (use YYYY-MM-DD)"),(Ke=(Me=Z.app)==null?void 0:Me.dates)!=null&&Ke.reevalDate&&!N(Z.app.dates.reevalDate)&&J.push("Invalid reevaluation date format (use YYYY-MM-DD)"),(Se=(qe=Z.app)==null?void 0:qe.dates)!=null&&Se.meetingDate&&!N(Z.app.dates.meetingDate)&&J.push("Invalid meeting date format (use YYYY-MM-DD)"),J},N=Z=>{if(!Z)return!0;const J=new Date(Z);return!isNaN(J.getTime())&&Z.match(/^\d{4}-\d{2}-\d{2}$/)},L=Z=>{if(!Z)return"";try{const J=new Date(Z);return isNaN(J.getTime())?"":J.toISOString().split("T")[0]}catch{return""}},O=Z=>{var te,K,Y,fe;const J=((K=(te=Z.app)==null?void 0:te.studentData)==null?void 0:K.firstName)||"",ge=((fe=(Y=Z.app)==null?void 0:Y.studentData)==null?void 0:fe.lastName)||"";return`${J} ${ge}`.trim()||"Missing Name"},V=Z=>{if(Z===0)return"0 Bytes";const J=1024,ge=["Bytes","KB","MB","GB"],te=Math.floor(Math.log(Z)/Math.log(J));return parseFloat((Z/Math.pow(J,te)).toFixed(2))+" "+ge[te]},z=()=>{if(i.value===2){if(C(),h.value.length>0)return;F()}i.value++},U=()=>{i.value--},G=async()=>{_.value=!0,x.value=0;const Z=Date.now(),J=g.value==="valid-only"?D.value:p.value;let ge=0,te=0;const K=[];try{for(let Y=0;Y<J.length;Y++){const fe=J[Y];try{await ne(fe.data),ge++}catch(ye){te++,K.push(`Row ${Y+1}: ${ye.message}`)}x.value=Math.round((Y+1)/J.length*100)}b.value={successful:ge,failed:te,errors:K,processingTime:Date.now()-Z},i.value=4,r("imported",{successful:ge,failed:te})}catch(Y){console.error("Import failed:",Y),K.push("Import process failed: "+Y.message),b.value={successful:ge,failed:te,errors:K,processingTime:Date.now()-Z},i.value=4}finally{_.value=!1}},j=Z=>{if(!Z)return"";console.log(" Mapping teacher ID:",Z),console.log(" Available users:",Object.values(n.value).map(te=>({name:te.name,aeriesId:te.aeriesId,id:te.id})));const J=Object.values(n.value).find(te=>{const K=String(te.aeriesId)===String(Z);return K&&console.log(" Found exact Aeries ID match:",{teacherId:Z,user:{name:te.name,aeriesId:te.aeriesId,id:te.id}}),K});if(J)return console.log(" Using Aeries ID match:",Z,"",J.id,"(",J.name,")"),J.id;const ge=Object.values(n.value).find(te=>te.id===Z);return ge?(console.log(" Using Firebase ID match:",Z,"",ge.id,"(",ge.name,")"),ge.id):(console.warn(" No user found for teacher ID:",Z),Z)},ee=Z=>{if(!Z)return"";console.log(" Mapping provider ID:",Z),console.log(" Available users:",Object.values(n.value).map(te=>({name:te.name,aeriesId:te.aeriesId,id:te.id})));const J=Object.values(n.value).find(te=>{const K=String(te.aeriesId)===String(Z);return K&&console.log(" Found exact Aeries ID match:",{providerId:Z,user:{name:te.name,aeriesId:te.aeriesId,id:te.id}}),K});if(J)return console.log(" Using Aeries ID match:",Z,"",J.id,"(",J.name,")"),J.id;const ge=Object.values(n.value).find(te=>te.id===Z);return ge?(console.log(" Using Firebase ID match:",Z,"",ge.id,"(",ge.name,")"),ge.id):(console.warn(" No user found for provider ID:",Z),Z)},ae=Z=>{try{return Z.app&&Z.app.studentData&&Z.app.studentData.ssid&&Z.app.studentData.firstName&&Z.app.studentData.lastName&&Z.app.studentData.grade&&Z.app.schedule&&Array.isArray(Z.app.schedule.classServices)}catch{return!1}},ne=async Z=>{try{const J=Z.app.studentData.ssid,ge=At(Xe,"students"),te=lr(ge,Ur("app.studentData.ssid","==",J)),K=await Gt(te);if(!K.empty&&!y.value)throw new Error(`Student with SSID ${J} already exists`);const Y={createdAt:Pn(),updatedAt:Pn(),app:{studentData:{firstName:Z.app.studentData.firstName||"",lastName:Z.app.studentData.lastName||"",grade:Z.app.studentData.grade||"",plan:Z.app.studentData.plan||"",caseManagerId:P(Z.app.studentData.caseManagerId)||"",ssid:J},dates:{reviewDate:Z.app.dates.reviewDate||"",reevalDate:Z.app.dates.reevalDate||"",meetingDate:Z.app.dates.meetingDate||""},schedule:{periods:Z.app.schedule.periods||{1:"",2:"",3:"",4:"",5:"",6:"",7:""},classServices:Array.isArray(Z.app.schedule.classServices)?Z.app.schedule.classServices:[]},providers:Z.app.providers||{speechId:"",otId:"",ptId:"",atId:"",audId:"",bisId:"",dhhId:"",hnId:"",mhId:"",omId:"",scId:"",swId:"",trId:"",viId:""},accommodations:{assessment:Z.app.accommodations.assessment||"",instruction:Z.app.accommodations.instruction||""},flags:{flag1:!!Z.app.flags.flag1,flag2:!!Z.app.flags.flag2},documents:{bipPdfUrl:Z.app.documents.bipPdfUrl||null,ataglancePdfUrl:Z.app.documents.ataglancePdfUrl||null}}};if(console.log("Saving student data:",{ssid:Y.app.studentData.ssid,schedule:Y.app.schedule.periods,providers:Y.app.providers}),!ae(Y))throw new Error("Invalid student data structure");if(!K.empty&&y.value){const fe=K.docs[0];await $t(et(Xe,"students",fe.id),Y,{merge:!0})}else{const fe=et(At(Xe,"students"));await $t(fe,Y)}}catch(J){throw console.error("Error importing student:",J),J}},le=()=>{i.value=1,a.value="",o.value="",l.value=[],c.value=[],u.value={},f.value="",h.value=[],p.value=[],b.value={successful:0,failed:0,errors:[],processingTime:0},v.value&&(v.value.value="")};return(Z,J)=>(M(),B("div",cK,[J[30]||(J[30]=d("div",{style:{background:"#e8f5e8",border:"2px solid #4caf50",padding:"10px","margin-bottom":"20px","border-radius":"4px","text-align":"center"}},[d("strong",null," StudentBulkImporter Component Loaded Successfully")],-1)),J[31]||(J[31]=d("div",{class:"importer-header"},[d("h2",null,"Add Students - Bulk Import"),d("p",{class:"description"}," Import multiple students from a CSV file. The system will map CSV fields to the app's database structure and allow you to preview and validate the data before importing. ")],-1)),i.value===1?(M(),B("div",uK,[J[8]||(J[8]=d("div",{class:"step-header"},[d("h3",null,"Step 1: Upload CSV File"),d("p",null,"Select a CSV file containing student data. The first row should contain column headers.")],-1)),d("div",dK,[d("div",fK,[d("input",{type:"file",ref_key:"fileInput",ref:v,onChange:S,accept:".csv",class:"file-input",id:"csv-file"},null,544),d("label",hK,[J[4]||(J[4]=d("span",{class:"file-icon"},"",-1)),d("span",pK,Q(a.value||"Choose CSV File"),1)])]),f.value?(M(),B("div",mK,Q(f.value),1)):ve("",!0),a.value?(M(),B("div",gK,[d("p",null,[J[5]||(J[5]=d("strong",null,"File:",-1)),we(" "+Q(a.value),1)]),d("p",null,[J[6]||(J[6]=d("strong",null,"Size:",-1)),we(" "+Q(o.value),1)]),l.value.length>0?(M(),B("p",vK,[J[7]||(J[7]=d("strong",null,"Records:",-1)),we(" "+Q(l.value.length),1)])):ve("",!0)])):ve("",!0)]),J[9]||(J[9]=En('<div class="sample-format" data-v-4b3a12b7><h4 data-v-4b3a12b7>Expected CSV Format:</h4><div class="format-example" data-v-4b3a12b7><code data-v-4b3a12b7> SSID,FirstName,LastName,Grade,Plan,CaseManagerId,ReviewDate,ReevalDate,MeetingDate,Period1Teacher,Period2Teacher,Period3Teacher,Period4Teacher,Period5Teacher,Period6Teacher,SHTeacher,ClassServices,SpeechProvider,OTProvider,PTProvider,ATProvider,Audiologist,BISProvider,DHHProvider,HNProvider,MHProvider,OMProvider,SCProvider,SWProvider,TRProvider,VIProvider,Flag1,Flag2,BIPPdfUrl,AtAGlancePdfUrl,Assessment,Instruction<br data-v-4b3a12b7> 123456789,John,Doe,9,IEP,user003,2025-07-15,2025-12-15,2025-07-10,user007,user008,user009,user010,user011,user012,user013,&quot;SDC: English,RSP: Math&quot;,user020,user021,user022,user023,user024,user025,user026,user027,user028,user029,user030,user031,user032,user033,true,false,https://example.com/bip.pdf,https://example.com/ataglance.pdf,&quot;Allow for test re-takes if the score is below average...&quot;,Divide larger projects or assignments into manageable parts... </code></div><p class="format-note" data-v-4b3a12b7><strong data-v-4b3a12b7>Required fields:</strong> SSID, FirstName, LastName, Grade<br data-v-4b3a12b7><strong data-v-4b3a12b7>App Structure:</strong> All fields map to the app data structure in your database<br data-v-4b3a12b7><strong data-v-4b3a12b7>Schedule fields:</strong> Period1Teacher through Period6Teacher and SHTeacher (Firebase user IDs like user001, user002, etc.)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Provider fields:</strong> All service provider fields (Firebase user IDs like user020, user021, etc.)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Class Services:</strong> Comma-separated list (e.g., &quot;SDC: English,RSP: Math,Co-teach: Science&quot;)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Dates:</strong> Use YYYY-MM-DD format (e.g., 2025-07-15)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Flags:</strong> Use true/false or 1/0<br data-v-4b3a12b7><strong data-v-4b3a12b7>Accommodations:</strong> Text fields for assessment and instruction<br data-v-4b3a12b7><strong data-v-4b3a12b7>Note:</strong> Teacher and provider IDs will be automatically mapped from names, emails, or Aeries IDs if user lookup is available </p></div>',1)),d("div",yK,[d("button",{onClick:z,disabled:!l.value.length,class:"btn btn-primary"}," Next: Map Fields ",8,xK)])])):ve("",!0),i.value===2?(M(),B("div",EK,[J[15]||(J[15]=d("div",{class:"step-header"},[d("h3",null,"Step 2: Map CSV Fields"),d("p",null,"Map your CSV columns to the app's database fields. Required fields are marked with *")],-1)),d("div",bK,[d("div",_K,[J[12]||(J[12]=En('<div class="mapping-header" data-v-4b3a12b7><div class="csv-column" data-v-4b3a12b7>CSV Column</div><div class="arrow" data-v-4b3a12b7></div><div class="app-field" data-v-4b3a12b7>App Database Field</div><div class="sample-data" data-v-4b3a12b7>Sample Data</div></div>',1)),(M(!0),B(ke,null,He(c.value,(ge,te)=>(M(),B("div",{key:te,class:"mapping-row"},[d("div",SK,[d("strong",null,Q(ge),1)]),J[11]||(J[11]=d("div",{class:"arrow"},"",-1)),d("div",AK,[Oe(d("select",{"onUpdate:modelValue":K=>u.value[ge]=K,class:"field-select"},J[10]||(J[10]=[En('<option value="" data-v-4b3a12b7>-- Skip this field --</option><optgroup label="Required Fields" data-v-4b3a12b7><option value="app.studentData.ssid" data-v-4b3a12b7>SSID (State Student ID) *</option><option value="app.studentData.firstName" data-v-4b3a12b7>First Name *</option><option value="app.studentData.lastName" data-v-4b3a12b7>Last Name *</option><option value="app.studentData.grade" data-v-4b3a12b7>Grade *</option></optgroup><optgroup label="Student Information" data-v-4b3a12b7><option value="app.studentData.plan" data-v-4b3a12b7>Plan Type (IEP/504/RTI/None)</option><option value="app.studentData.caseManagerId" data-v-4b3a12b7>Case Manager ID</option></optgroup><optgroup label="Important Dates" data-v-4b3a12b7><option value="app.dates.reviewDate" data-v-4b3a12b7>Review Date</option><option value="app.dates.reevalDate" data-v-4b3a12b7>Reevaluation Date</option><option value="app.dates.meetingDate" data-v-4b3a12b7>Meeting Date</option></optgroup><optgroup label="Class Schedule" data-v-4b3a12b7><option value="app.schedule.periods.1" data-v-4b3a12b7>Period 1 Teacher ID</option><option value="app.schedule.periods.2" data-v-4b3a12b7>Period 2 Teacher ID</option><option value="app.schedule.periods.3" data-v-4b3a12b7>Period 3 Teacher ID</option><option value="app.schedule.periods.4" data-v-4b3a12b7>Period 4 Teacher ID</option><option value="app.schedule.periods.5" data-v-4b3a12b7>Period 5 Teacher ID</option><option value="app.schedule.periods.6" data-v-4b3a12b7>Period 6 Teacher ID</option><option value="app.schedule.periods.7" data-v-4b3a12b7>Period 7 Teacher ID</option><option value="app.schedule.classServices" data-v-4b3a12b7>Class Services (Comma-separated)</option></optgroup><optgroup label="Service Providers" data-v-4b3a12b7><option value="app.providers.speechId" data-v-4b3a12b7>Speech Provider ID</option><option value="app.providers.otId" data-v-4b3a12b7>OT Provider ID</option><option value="app.providers.ptId" data-v-4b3a12b7>PT Provider ID</option><option value="app.providers.atId" data-v-4b3a12b7>AT Provider ID</option><option value="app.providers.audId" data-v-4b3a12b7>Audiologist ID</option><option value="app.providers.bisId" data-v-4b3a12b7>BIS Provider ID</option><option value="app.providers.dhhId" data-v-4b3a12b7>DHH Provider ID</option><option value="app.providers.hnId" data-v-4b3a12b7>HN Provider ID</option><option value="app.providers.mhId" data-v-4b3a12b7>MH Provider ID</option><option value="app.providers.omId" data-v-4b3a12b7>OM Provider ID</option><option value="app.providers.scId" data-v-4b3a12b7>SC Provider ID</option><option value="app.providers.swId" data-v-4b3a12b7>SW Provider ID</option><option value="app.providers.trId" data-v-4b3a12b7>TR Provider ID</option><option value="app.providers.viId" data-v-4b3a12b7>VI Provider ID</option></optgroup><optgroup label="Flags" data-v-4b3a12b7><option value="app.flags.flag1" data-v-4b3a12b7>Flag 1 (Boolean)</option><option value="app.flags.flag2" data-v-4b3a12b7>Flag 2 (Boolean)</option></optgroup><optgroup label="Documents" data-v-4b3a12b7><option value="app.documents.bipPdfUrl" data-v-4b3a12b7>BIP PDF URL</option><option value="app.documents.ataglancePdfUrl" data-v-4b3a12b7>At-A-Glance PDF URL</option></optgroup><optgroup label="Accommodations" data-v-4b3a12b7><option value="app.accommodations.assessment" data-v-4b3a12b7>Assessment Accommodations</option><option value="app.accommodations.instruction" data-v-4b3a12b7>Instructional Accommodations</option></optgroup>',9)]),8,TK),[[sr,u.value[ge]]])]),d("div",wK,[d("code",null,Q(I(ge)),1)])]))),128))]),d("div",{class:"auto-mapping-section"},[J[13]||(J[13]=d("h4",null,"Quick Mapping Options:",-1)),d("div",{class:"quick-actions"},[d("button",{onClick:m,class:"btn btn-secondary"}," Auto-map Common Fields "),d("button",{onClick:A,class:"btn btn-secondary"}," Clear All Mappings ")])]),h.value.length>0?(M(),B("div",CK,[J[14]||(J[14]=d("h4",null,"Mapping Issues:",-1)),d("ul",null,[(M(!0),B(ke,null,He(h.value,ge=>(M(),B("li",{key:ge,class:"error-item"},Q(ge),1))),128))])])):ve("",!0)]),d("div",IK,[d("button",{onClick:U,class:"btn btn-secondary"}," Back "),d("button",{onClick:z,disabled:!T.value,class:"btn btn-primary"}," Next: Preview Data ",8,kK)])])):ve("",!0),i.value===3?(M(),B("div",DK,[J[23]||(J[23]=d("div",{class:"step-header"},[d("h3",null,"Step 3: Preview and Validate"),d("p",null,"Review the mapped data before importing. Check for any validation errors.")],-1)),d("div",PK,[d("div",RK,[d("div",FK,[J[16]||(J[16]=d("span",{class:"stat-label"},"Total Records:",-1)),d("span",NK,Q(l.value.length),1)]),d("div",OK,[J[17]||(J[17]=d("span",{class:"stat-label"},"Valid Records:",-1)),d("span",MK,Q(D.value.length),1)]),d("div",LK,[J[18]||(J[18]=d("span",{class:"stat-label"},"Invalid Records:",-1)),d("span",BK,Q(k.value.length),1)])]),d("div",UK,[d("table",$K,[J[19]||(J[19]=d("thead",null,[d("tr",null,[d("th",null,"Status"),d("th",null,"SSID"),d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",null,"Issues")])],-1)),d("tbody",null,[(M(!0),B(ke,null,He(p.value,(ge,te)=>{var K,Y,fe,ye,ie,ue,Ee,Ce;return M(),B("tr",{key:te,class:Ye({"invalid-row":ge.errors.length>0})},[d("td",null,[d("span",{class:Ye(["status-badge",ge.errors.length>0?"error":"valid"])},Q(ge.errors.length>0?"Error":"Valid"),3)]),d("td",null,Q(ge.data.ssid||((Y=(K=ge.data.app)==null?void 0:K.studentData)==null?void 0:Y.ssid)||"Missing"),1),d("td",null,Q(O(ge.data)),1),d("td",null,Q(((ye=(fe=ge.data.app)==null?void 0:fe.studentData)==null?void 0:ye.grade)||"Missing"),1),d("td",null,Q(((ue=(ie=ge.data.app)==null?void 0:ie.studentData)==null?void 0:ue.plan)||"Not set"),1),d("td",null,Q(((Ce=(Ee=ge.data.app)==null?void 0:Ee.studentData)==null?void 0:Ce.caseManagerId)||"Not set"),1),d("td",null,[ge.errors.length>0?(M(),B("ul",VK,[(M(!0),B(ke,null,He(ge.errors,Pe=>(M(),B("li",{key:Pe,class:"error-item"},Q(Pe),1))),128))])):(M(),B("span",HK,"No issues"))])],2)}),128))])])]),d("div",jK,[J[22]||(J[22]=d("h4",null,"Import Options:",-1)),d("div",GK,[d("label",WK,[Oe(d("input",{type:"radio","onUpdate:modelValue":J[0]||(J[0]=ge=>g.value=ge),value:"valid-only"},null,512),[[Ss,g.value]]),d("span",null,"Import only valid records ("+Q(D.value.length)+" records)",1)]),d("label",zK,[Oe(d("input",{type:"radio","onUpdate:modelValue":J[1]||(J[1]=ge=>g.value=ge),value:"all"},null,512),[[Ss,g.value]]),J[20]||(J[20]=d("span",null,"Import all records (may cause errors for invalid data)",-1))]),d("label",KK,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":J[2]||(J[2]=ge=>y.value=ge)},null,512),[[_t,y.value]]),J[21]||(J[21]=d("span",null,"Update existing students if SSID already exists",-1))])])])]),d("div",qK,[d("button",{onClick:U,class:"btn btn-secondary"}," Back "),d("button",{onClick:G,disabled:_.value||g.value==="valid-only"&&D.value.length===0,class:"btn btn-primary"},Q(_.value?"Importing...":`Import ${g.value==="valid-only"?D.value.length:l.value.length} Students`),9,XK)])])):ve("",!0),i.value===4?(M(),B("div",YK,[J[28]||(J[28]=d("div",{class:"step-header"},[d("h3",null,"Step 4: Import Complete"),d("p",null,"Your bulk import has been completed. Review the results below.")],-1)),d("div",QK,[d("div",JK,[d("div",ZK,[J[24]||(J[24]=d("span",{class:"stat-label"},"Successfully Imported:",-1)),d("span",eq,Q(b.value.successful),1)]),d("div",tq,[J[25]||(J[25]=d("span",{class:"stat-label"},"Failed to Import:",-1)),d("span",rq,Q(b.value.failed),1)]),d("div",nq,[J[26]||(J[26]=d("span",{class:"stat-label"},"Total Processing Time:",-1)),d("span",sq,Q(b.value.processingTime)+"ms",1)])]),b.value.errors.length>0?(M(),B("div",aq,[J[27]||(J[27]=d("h4",null,"Import Errors:",-1)),d("ul",null,[(M(!0),B(ke,null,He(b.value.errors,ge=>(M(),B("li",{key:ge,class:"error-item"},Q(ge),1))),128))])])):ve("",!0),d("div",iq,[d("button",{onClick:le,class:"btn btn-secondary"}," Import More Students "),d("button",{onClick:J[3]||(J[3]=ge=>Z.$emit("close")),class:"btn btn-primary"}," Close ")])])])):ve("",!0),_.value?(M(),B("div",oq,[d("div",lq,[J[29]||(J[29]=d("div",{class:"loading-spinner"},null,-1)),d("p",null,"Importing students... "+Q(x.value)+"%",1),d("div",cq,[d("div",{class:"progress-fill",style:Nr({width:x.value+"%"})},null,4)])])])):ve("",!0)]))}},dq=St(uq,[["__scopeId","data-v-4b3a12b7"]]),fq={class:"permissions-overview"},hq={class:"roles-summary"},pq={class:"role-icon"},mq={class:"role-info"},gq={class:"role-stats"},vq={class:"stat"},yq={class:"stat-number"},xq={class:"stat"},Eq={class:"stat-number"},bq={class:"stat"},_q={class:"stat-number"},Sq={class:"permissions-matrix"},Aq={class:"matrix-table-container"},Tq={class:"matrix-table"},wq=["data-role"],Cq={class:"permission-info"},Iq={class:"permission-name"},kq={class:"permission-description"},Dq={class:"permission-firebase"},Pq={class:"admin-panel-access"},Rq={class:"access-grid"},Fq={class:"access-header"},Nq={class:"access-icon"},Oq={class:"role-name"},Mq={key:0,class:"access-details"},Lq={class:"access-level"},Bq={class:"access-description"},Uq={key:1,class:"no-access"},$q={__name:"PermissionsOverview",setup(t){const e=n4,r=_e(()=>Ko.slice().sort((l,c)=>{var h,p;const u=((h=e[l])==null?void 0:h.length)||0;return(((p=e[c])==null?void 0:p.length)||0)-u})),n={admin:xB,school_admin:d4,staff_view:SB,staff_edit:Vv,admin_504:c4,sped_chair:R0,case_manager:f4,teacher:Hv,paraeducator:eB,service_provider:u4},s=_e(()=>r.value.map(l=>{const c=e[l]||[],u=c.some(y=>y.includes("admin_panel"));let f="No Access",h="No admin panel access";c.includes("admin_panel_full")?(f="Full Access",h="All admin panel features including permissions management"):c.includes("admin_panel_school")?(f="School Access",h="School operations, users, aides, and students"):c.includes("admin_panel_limited")?(f="Limited Access",h="Student management, aide management, and 504-related functions"):c.includes("admin_panel_sped")&&(f="SPED Access",h="SPED program management and aide oversight");let p="Viewer";c.includes(ot.EDIT_STUDENT_ALL)?l==="admin"||l==="school_admin"?p="Admin":l==="staff_edit"?p="Editor":(l==="sped_chair"||l==="admin_504")&&(p="Admin/CM"):c.includes(ot.EDIT_STUDENT_CM)&&(l==="admin_504"?p="Admin/CM":p="CM");const g=l==="admin_504"?"504 Coordinator":l==="sped_chair"?"SPED Chair":l==="school_admin"?"School Administrator":l==="staff_view"?"Staff Viewer":l==="staff_edit"?"Staff Editor":l==="case_manager"?"Case Manager":l==="service_provider"?"Service Provider":l.charAt(0).toUpperCase()+l.slice(1);return{key:l,name:g,icon:n[l]||Hv,description:bL[l]||`${g} role`,adminAccess:u,adminLevel:f,adminDescription:h,studentAccessLevel:p,permissions:c}})),i=_e(()=>[{key:ot.VIEW_USERS,name:"View Users",description:"Can view user accounts and basic information",firebaseRule:"All authenticated users"},{key:ot.EDIT_USER,name:"Edit Users",description:"Can modify user accounts and profiles",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:ot.DELETE_USER,name:"Delete Users",description:"Can remove user accounts",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:ot.MANAGE_TEACHER_FEEDBACK,name:"Manage Teacher Feedback",description:"Can create and manage teacher feedback forms",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager"},{key:ot.MANAGE_IMPORTS,name:"Manage Data Imports",description:"Can import data from SEIS, Aeries, and other sources",firebaseRule:"Admin, School Admin"},{key:ot.MANAGE_BACKUPS,name:"Manage Backups",description:"Can create, restore, and manage database backups",firebaseRule:"Admin, School Admin"},{key:ot.VIEW_STUDENTS,name:"View Students",description:"Can view student records (role-filtered)",firebaseRule:"All authenticated users"},{key:ot.EDIT_STUDENT_CM,name:"Edit Own Caseload",description:"Can modify students on own caseload",firebaseRule:"Case Manager, Service Provider"},{key:ot.EDIT_STUDENT_ALL,name:"Edit All Students",description:"Can modify any student record",firebaseRule:"Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair"},{key:ot.ACCESS_ADMIN_PANEL,name:"Admin Panel Access",description:"Can access administrative functions",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:ot.MANAGE_AIDES,name:"Aide Management",description:"Can manage aide assignments and schedules",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:ot.MANAGE_SYSTEM_SETTINGS,name:"System Settings",description:"Can modify system-level configuration",firebaseRule:"Admin only"}].sort((c,u)=>{const f=Ko.filter(p=>{var g;return(g=e[p])==null?void 0:g.includes(c.key)}).length;return Ko.filter(p=>{var g;return(g=e[p])==null?void 0:g.includes(u.key)}).length-f})),a=(l,c)=>{var u;return((u=e[l])==null?void 0:u.includes(c))||!1},o=l=>({admin:"Admin",school_admin:"School Admin",staff_view:"Staff View",staff_edit:"Staff Edit",admin_504:"504 Coord",sped_chair:"SPED Chair",case_manager:"Case Mgr",teacher:"Teacher",service_provider:"Service",paraeducator:"Para"})[l]||l;return(l,c)=>(M(),B("div",fq,[c[7]||(c[7]=d("div",{class:"overview-header"},[d("h2",null," Permissions Overview"),d("p",{class:"overview-description"}," This a summary of the role-based permissions These permissions are hard-coded for consistency and security. ")],-1)),d("div",hq,[(M(!0),B(ke,null,He(s.value,u=>(M(),B("div",{class:"summary-card",key:u.key},[d("div",{class:Ye(["role-header",u.key])},[d("div",pq,[(M(),Qt(T1(u.icon),{class:"w-6 h-6"}))]),d("div",mq,[d("h3",null,Q(u.name),1),d("p",null,Q(u.description),1)])],2),d("div",gq,[d("div",vq,[d("span",yq,Q(u.permissions.length),1),c[0]||(c[0]=d("span",{class:"stat-label"},"Permissions",-1))]),d("div",xq,[d("span",Eq,Q(u.adminAccess?"Yes":"No"),1),c[1]||(c[1]=d("span",{class:"stat-label"},"Admin Panel",-1))]),d("div",bq,[d("span",_q,Q(u.studentAccessLevel),1),c[2]||(c[2]=d("span",{class:"stat-label"},"Student Access",-1))])])]))),128))]),d("div",Sq,[c[4]||(c[4]=d("h3",null," Detailed Permissions Matrix",-1)),c[5]||(c[5]=d("div",{class:"matrix-note"},[d("strong",null,"Note:"),we(" These permissions are synchronized with Firebase security rules and cannot be modified. They ensure consistent security across your application. ")],-1)),d("div",Aq,[d("table",Tq,[d("thead",null,[d("tr",null,[c[3]||(c[3]=d("th",{class:"permission-column"},"Permission",-1)),(M(!0),B(ke,null,He(r.value,u=>(M(),B("th",{key:u,class:Ye(`role-header ${u}`),"data-role":o(u)},null,10,wq))),128))])]),d("tbody",null,[(M(!0),B(ke,null,He(i.value,u=>(M(),B("tr",{key:u.key,class:"permission-row"},[d("td",Cq,[d("div",Iq,Q(u.name),1),d("div",kq,Q(u.description),1),d("div",Dq,Q(u.firebaseRule),1)]),(M(!0),B(ke,null,He(r.value,f=>(M(),B("td",{key:f,class:"permission-cell"},[d("span",{class:Ye(["permission-indicator",{granted:a(f,u.key)}])},Q(a(f,u.key)?"":""),3)]))),128))]))),128))])])])]),d("div",Pq,[c[6]||(c[6]=d("h3",null," Admin Panel Access",-1)),d("div",Rq,[(M(!0),B(ke,null,He(s.value,u=>(M(),B("div",{key:u.key,class:Ye(["access-card",{"has-access":u.adminAccess}])},[d("div",Fq,[d("span",Nq,Q(u.adminAccess?"":""),1),d("span",Oq,Q(u.name),1)]),u.adminAccess?(M(),B("div",Mq,[d("div",Lq,Q(u.adminLevel),1),d("div",Bq,Q(u.adminDescription),1)])):(M(),B("div",Uq," No admin panel access "))],2))),128))])]),c[8]||(c[8]=En('<div class="firebase-rules" data-v-88586d63><h3 data-v-88586d63> Firebase Security Rules Summary</h3><div class="rules-grid" data-v-88586d63><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Users Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Students Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users (role-filtered)</li><li data-v-88586d63><strong data-v-88586d63>Write (All):</strong> Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Write (Own Caseload):</strong> Case Manager, Service Provider</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> App Settings</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Audit Logs</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> All authenticated users (own actions)</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Feedback Forms</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Backups</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read/Write:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin</li></ul></div></div></div>',1))]))}},Vq=St($q,[["__scopeId","data-v-88586d63"]]),Hq={class:"admin-permissions"},jq={__name:"AdminPermissions",setup(t){return(e,r)=>(M(),B("div",Hq,[Re(Vq)]))}},Gq=St(jq,[["__scopeId","data-v-699444ca"]]);var T4={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((r,n)=>{t.exports=n()})(jt,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},s,i=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(E){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var A=D(m);A.chunkSize=parseInt(A.chunkSize),m.step||m.chunk||(A.chunkSize=null),this._handle=new y(A),(this._handle.streamer=this)._config=A}).call(this,E),this.parseChunk=function(m,A){var I=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<I){let F=this._config.newline;F||(C=this._config.quoteChar||'"',F=this._handle.guessLineEndings(m,C)),m=[...m.split(F).slice(I)].join(F)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(C=this._config.beforeFirstChunk(m))!==void 0&&(m=C),this.isFirstChunk=!1,this._halted=!1;var I=this._partialLine+m,C=(this._partialLine="",this._handle.parse(I,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(m=C.meta.cursor,I=(this._finished||(this._partialLine=I.substring(m-this._baseIndex),this._baseIndex=m),C&&C.data&&(this._rowCount+=C.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)n.postMessage({results:C,workerId:c.WORKER_ID,finished:I});else if(S(this._config.chunk)&&!A){if(this._config.chunk(C,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=C=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(C.data),this._completeResults.errors=this._completeResults.errors.concat(C.errors),this._completeResults.meta=C.meta),this._completed||!I||!S(this._config.complete)||C&&C.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),I||C&&C.meta.paused||this._nextChunk(),C}this._halted=!0},this._sendError=function(m){S(this._config.error)?this._config.error(m):a&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:m,finished:!1})}}function f(E){var m;(E=E||{}).chunkSize||(E.chunkSize=c.RemoteChunkSize),u.call(this,E),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(A){this._input=A,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),i||(m.onload=k(this._chunkLoaded,this),m.onerror=k(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var A,I=this._config.downloadRequestHeaders;for(A in I)m.setRequestHeader(A,I[A])}var C;this._config.chunkSize&&(C=this._start+this._config.chunkSize-1,m.setRequestHeader("Range","bytes="+this._start+"-"+C));try{m.send(this._config.downloadRequestBody)}catch(F){this._chunkError(F.message)}i&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize||m.responseText.length,this._finished=!this._config.chunkSize||this._start>=(A=>(A=A.getResponseHeader("Content-Range"))!==null?parseInt(A.substring(A.lastIndexOf("/")+1)):-1)(m),this.parseChunk(m.responseText)))},this._chunkError=function(A){A=m.statusText||A,this._sendError(new Error(A))}}function h(E){(E=E||{}).chunkSize||(E.chunkSize=c.LocalChunkSize),u.call(this,E);var m,A,I=typeof FileReader<"u";this.stream=function(C){this._input=C,A=C.slice||C.webkitSlice||C.mozSlice,I?((m=new FileReader).onload=k(this._chunkLoaded,this),m.onerror=k(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var C=this._input,F=(this._config.chunkSize&&(F=Math.min(this._start+this._config.chunkSize,this._input.size),C=A.call(C,this._start,F)),m.readAsText(C,this._config.encoding));I||this._chunkLoaded({target:{result:F}})},this._chunkLoaded=function(C){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(C.target.result)},this._chunkError=function(){this._sendError(m.error)}}function p(E){var m;u.call(this,E=E||{}),this.stream=function(A){return m=A,this._nextChunk()},this._nextChunk=function(){var A,I;if(!this._finished)return A=this._config.chunkSize,m=A?(I=m.substring(0,A),m.substring(A)):(I=m,""),this._finished=!m,this.parseChunk(I)}}function g(E){u.call(this,E=E||{});var m=[],A=!0,I=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(C){this._input=C,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){I&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):A=!0},this._streamData=k(function(C){try{m.push(typeof C=="string"?C:C.toString(this._config.encoding)),A&&(A=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(F){this._streamError(F)}},this),this._streamError=k(function(C){this._streamCleanUp(),this._sendError(C)},this),this._streamEnd=k(function(){this._streamCleanUp(),I=!0,this._streamData("")},this),this._streamCleanUp=k(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function y(E){var m,A,I,C,F=Math.pow(2,53),W=-F,P=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,R=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,N=this,L=0,O=0,V=!1,z=!1,U=[],G={data:[],errors:[],meta:{}};function j(le){return E.skipEmptyLines==="greedy"?le.join("").trim()==="":le.length===1&&le[0].length===0}function ee(){if(G&&I&&(ne("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),I=!1),E.skipEmptyLines&&(G.data=G.data.filter(function(te){return!j(te)})),ae()){let te=function(K,Y){S(E.transformHeader)&&(K=E.transformHeader(K,Y)),U.push(K)};var ge=te;if(G)if(Array.isArray(G.data[0])){for(var le=0;ae()&&le<G.data.length;le++)G.data[le].forEach(te);G.data.splice(0,1)}else G.data.forEach(te)}function Z(te,K){for(var Y=E.header?{}:[],fe=0;fe<te.length;fe++){var ye=fe,ie=te[fe],ie=((ue,Ee)=>(Ce=>(E.dynamicTypingFunction&&E.dynamicTyping[Ce]===void 0&&(E.dynamicTyping[Ce]=E.dynamicTypingFunction(Ce)),(E.dynamicTyping[Ce]||E.dynamicTyping)===!0))(ue)?Ee==="true"||Ee==="TRUE"||Ee!=="false"&&Ee!=="FALSE"&&((Ce=>{if(P.test(Ce)&&(Ce=parseFloat(Ce),W<Ce&&Ce<F))return 1})(Ee)?parseFloat(Ee):R.test(Ee)?new Date(Ee):Ee===""?null:Ee):Ee)(ye=E.header?fe>=U.length?"__parsed_extra":U[fe]:ye,ie=E.transform?E.transform(ie,ye):ie);ye==="__parsed_extra"?(Y[ye]=Y[ye]||[],Y[ye].push(ie)):Y[ye]=ie}return E.header&&(fe>U.length?ne("FieldMismatch","TooManyFields","Too many fields: expected "+U.length+" fields but parsed "+fe,O+K):fe<U.length&&ne("FieldMismatch","TooFewFields","Too few fields: expected "+U.length+" fields but parsed "+fe,O+K)),Y}var J;G&&(E.header||E.dynamicTyping||E.transform)&&(J=1,!G.data.length||Array.isArray(G.data[0])?(G.data=G.data.map(Z),J=G.data.length):G.data=Z(G.data,0),E.header&&G.meta&&(G.meta.fields=U),O+=J)}function ae(){return E.header&&U.length===0}function ne(le,Z,J,ge){le={type:le,code:Z,message:J},ge!==void 0&&(le.row=ge),G.errors.push(le)}S(E.step)&&(C=E.step,E.step=function(le){G=le,ae()?ee():(ee(),G.data.length!==0&&(L+=le.data.length,E.preview&&L>E.preview?A.abort():(G.data=G.data[0],C(G,N))))}),this.parse=function(le,Z,J){var ge=E.quoteChar||'"',ge=(E.newline||(E.newline=this.guessLineEndings(le,ge)),I=!1,E.delimiter?S(E.delimiter)&&(E.delimiter=E.delimiter(le),G.meta.delimiter=E.delimiter):((ge=((te,K,Y,fe,ye)=>{var ie,ue,Ee,Ce;ye=ye||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Pe=0;Pe<ye.length;Pe++){for(var Te,ze=ye[Pe],Ie=0,be=0,Me=0,Ke=(Ee=void 0,new x({comments:fe,delimiter:ze,newline:K,preview:10}).parse(te)),qe=0;qe<Ke.data.length;qe++)Y&&j(Ke.data[qe])?Me++:(Te=Ke.data[qe].length,be+=Te,Ee===void 0?Ee=Te:0<Te&&(Ie+=Math.abs(Te-Ee),Ee=Te));0<Ke.data.length&&(be/=Ke.data.length-Me),(ue===void 0||Ie<=ue)&&(Ce===void 0||Ce<be)&&1.99<be&&(ue=Ie,ie=ze,Ce=be)}return{successful:!!(E.delimiter=ie),bestDelimiter:ie}})(le,E.newline,E.skipEmptyLines,E.comments,E.delimitersToGuess)).successful?E.delimiter=ge.bestDelimiter:(I=!0,E.delimiter=c.DefaultDelimiter),G.meta.delimiter=E.delimiter),D(E));return E.preview&&E.header&&ge.preview++,m=le,A=new x(ge),G=A.parse(m,Z,J),ee(),V?{meta:{paused:!0}}:G||{meta:{paused:!1}}},this.paused=function(){return V},this.pause=function(){V=!0,A.abort(),m=S(E.chunk)?"":m.substring(A.getCharIndex())},this.resume=function(){N.streamer._halted?(V=!1,N.streamer.parseChunk(m,!0)):setTimeout(N.resume,3)},this.aborted=function(){return z},this.abort=function(){z=!0,A.abort(),G.meta.aborted=!0,S(E.complete)&&E.complete(G),m=""},this.guessLineEndings=function(te,ge){te=te.substring(0,1048576);var ge=new RegExp(_(ge)+"([^]*?)"+_(ge),"gm"),J=(te=te.replace(ge,"")).split("\r"),ge=te.split(`
`),te=1<ge.length&&ge[0].length<J[0].length;if(J.length===1||te)return`
`;for(var K=0,Y=0;Y<J.length;Y++)J[Y][0]===`
`&&K++;return K>=J.length/2?`\r
`:"\r"}}function _(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function x(E){var m=(E=E||{}).delimiter,A=E.newline,I=E.comments,C=E.step,F=E.preview,W=E.fastMode,P=null,R=!1,N=E.quoteChar==null?'"':E.quoteChar,L=N;if(E.escapeChar!==void 0&&(L=E.escapeChar),(typeof m!="string"||-1<c.BAD_DELIMITERS.indexOf(m))&&(m=","),I===m)throw new Error("Comment character same as delimiter");I===!0?I="#":(typeof I!="string"||-1<c.BAD_DELIMITERS.indexOf(I))&&(I=!1),A!==`
`&&A!=="\r"&&A!==`\r
`&&(A=`
`);var O=0,V=!1;this.parse=function(z,U,G){if(typeof z!="string")throw new Error("Input must be a string");var j=z.length,ee=m.length,ae=A.length,ne=I.length,le=S(C),Z=[],J=[],ge=[],te=O=0;if(!z)return Ie();if(W||W!==!1&&z.indexOf(N)===-1){for(var K=z.split(A),Y=0;Y<K.length;Y++){if(ge=K[Y],O+=ge.length,Y!==K.length-1)O+=A.length;else if(G)return Ie();if(!I||ge.substring(0,ne)!==I){if(le){if(Z=[],Ce(ge.split(m)),be(),V)return Ie()}else Ce(ge.split(m));if(F&&F<=Y)return Z=Z.slice(0,F),Ie(!0)}}return Ie()}for(var fe=z.indexOf(m,O),ye=z.indexOf(A,O),ie=new RegExp(_(L)+_(N),"g"),ue=z.indexOf(N,O);;)if(z[O]===N)for(ue=O,O++;;){if((ue=z.indexOf(N,ue+1))===-1)return G||J.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Z.length,index:O}),Te();if(ue===j-1)return Te(z.substring(O,ue).replace(ie,N));if(N===L&&z[ue+1]===L)ue++;else if(N===L||ue===0||z[ue-1]!==L){fe!==-1&&fe<ue+1&&(fe=z.indexOf(m,ue+1));var Ee=Pe((ye=ye!==-1&&ye<ue+1?z.indexOf(A,ue+1):ye)===-1?fe:Math.min(fe,ye));if(z.substr(ue+1+Ee,ee)===m){ge.push(z.substring(O,ue).replace(ie,N)),z[O=ue+1+Ee+ee]!==N&&(ue=z.indexOf(N,O)),fe=z.indexOf(m,O),ye=z.indexOf(A,O);break}if(Ee=Pe(ye),z.substring(ue+1+Ee,ue+1+Ee+ae)===A){if(ge.push(z.substring(O,ue).replace(ie,N)),ze(ue+1+Ee+ae),fe=z.indexOf(m,O),ue=z.indexOf(N,O),le&&(be(),V))return Ie();if(F&&Z.length>=F)return Ie(!0);break}J.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Z.length,index:O}),ue++}}else if(I&&ge.length===0&&z.substring(O,O+ne)===I){if(ye===-1)return Ie();O=ye+ae,ye=z.indexOf(A,O),fe=z.indexOf(m,O)}else if(fe!==-1&&(fe<ye||ye===-1))ge.push(z.substring(O,fe)),O=fe+ee,fe=z.indexOf(m,O);else{if(ye===-1)break;if(ge.push(z.substring(O,ye)),ze(ye+ae),le&&(be(),V))return Ie();if(F&&Z.length>=F)return Ie(!0)}return Te();function Ce(Me){Z.push(Me),te=O}function Pe(Me){var Ke=0;return Ke=Me!==-1&&(Me=z.substring(ue+1,Me))&&Me.trim()===""?Me.length:Ke}function Te(Me){return G||(Me===void 0&&(Me=z.substring(O)),ge.push(Me),O=j,Ce(ge),le&&be()),Ie()}function ze(Me){O=Me,Ce(ge),ge=[],ye=z.indexOf(A,O)}function Ie(Me){if(E.header&&!U&&Z.length&&!R){var Ke=Z[0],qe=Object.create(null),Se=new Set(Ke);let xe=!1;for(let Ae=0;Ae<Ke.length;Ae++){let Le=Ke[Ae];if(qe[Le=S(E.transformHeader)?E.transformHeader(Le,Ae):Le]){let We,$e=qe[Le];for(;We=Le+"_"+$e,$e++,Se.has(We););Se.add(We),Ke[Ae]=We,qe[Le]++,xe=!0,(P=P===null?{}:P)[We]=Le}else qe[Le]=1,Ke[Ae]=Le;Se.add(Le)}xe&&console.warn("Duplicate headers found and renamed."),R=!0}return{data:Z,errors:J,meta:{delimiter:m,linebreak:A,aborted:V,truncated:!!Me,cursor:te+(U||0),renamedHeaders:P}}}function be(){C(Ie()),Z=[],J=[]}},this.abort=function(){V=!0},this.getCharIndex=function(){return O}}function b(E){var m=E.data,A=o[m.workerId],I=!1;if(m.error)A.userError(m.error,m.file);else if(m.results&&m.results.data){var C={abort:function(){I=!0,v(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:T,resume:T};if(S(A.userStep)){for(var F=0;F<m.results.data.length&&(A.userStep({data:m.results.data[F],errors:m.results.errors,meta:m.results.meta},C),!I);F++);delete m.results}else S(A.userChunk)&&(A.userChunk(m.results,C,m.file),delete m.results)}m.finished&&!I&&v(m.workerId,m.results)}function v(E,m){var A=o[E];S(A.userComplete)&&A.userComplete(m),A.terminate(),delete o[E]}function T(){throw new Error("Not implemented.")}function D(E){if(typeof E!="object"||E===null)return E;var m,A=Array.isArray(E)?[]:{};for(m in E)A[m]=D(E[m]);return A}function k(E,m){return function(){E.apply(m,arguments)}}function S(E){return typeof E=="function"}return c.parse=function(E,m){var A=(m=m||{}).dynamicTyping||!1;if(S(A)&&(m.dynamicTypingFunction=A,A={}),m.dynamicTyping=A,m.transform=!!S(m.transform)&&m.transform,!m.worker||!c.WORKERS_SUPPORTED)return A=null,c.NODE_STREAM_INPUT,typeof E=="string"?(E=(I=>I.charCodeAt(0)!==65279?I:I.slice(1))(E),A=new(m.download?f:p)(m)):E.readable===!0&&S(E.read)&&S(E.on)?A=new g(m):(n.File&&E instanceof File||E instanceof Object)&&(A=new h(m)),A.stream(E);(A=(()=>{var I;return!!c.WORKERS_SUPPORTED&&(I=(()=>{var C=n.URL||n.webkitURL||null,F=r.toString();return c.BLOB_URL||(c.BLOB_URL=C.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",F,")();"],{type:"text/javascript"})))})(),(I=new n.Worker(I)).onmessage=b,I.id=l++,o[I.id]=I)})()).userStep=m.step,A.userChunk=m.chunk,A.userComplete=m.complete,A.userError=m.error,m.step=S(m.step),m.chunk=S(m.chunk),m.complete=S(m.complete),m.error=S(m.error),delete m.worker,A.postMessage({input:E,config:m,workerId:A.id})},c.unparse=function(E,m){var A=!1,I=!0,C=",",F=`\r
`,W='"',P=W+W,R=!1,N=null,L=!1,O=((()=>{if(typeof m=="object"){if(typeof m.delimiter!="string"||c.BAD_DELIMITERS.filter(function(U){return m.delimiter.indexOf(U)!==-1}).length||(C=m.delimiter),typeof m.quotes!="boolean"&&typeof m.quotes!="function"&&!Array.isArray(m.quotes)||(A=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(R=m.skipEmptyLines),typeof m.newline=="string"&&(F=m.newline),typeof m.quoteChar=="string"&&(W=m.quoteChar),typeof m.header=="boolean"&&(I=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");N=m.columns}m.escapeChar!==void 0&&(P=m.escapeChar+W),m.escapeFormulae instanceof RegExp?L=m.escapeFormulae:typeof m.escapeFormulae=="boolean"&&m.escapeFormulae&&(L=/^[=+\-@\t\r].*$/)}})(),new RegExp(_(W),"g"));if(typeof E=="string"&&(E=JSON.parse(E)),Array.isArray(E)){if(!E.length||Array.isArray(E[0]))return V(null,E,R);if(typeof E[0]=="object")return V(N||Object.keys(E[0]),E,R)}else if(typeof E=="object")return typeof E.data=="string"&&(E.data=JSON.parse(E.data)),Array.isArray(E.data)&&(E.fields||(E.fields=E.meta&&E.meta.fields||N),E.fields||(E.fields=Array.isArray(E.data[0])?E.fields:typeof E.data[0]=="object"?Object.keys(E.data[0]):[]),Array.isArray(E.data[0])||typeof E.data[0]=="object"||(E.data=[E.data])),V(E.fields||[],E.data||[],R);throw new Error("Unable to serialize unrecognized input");function V(U,G,j){var ee="",ae=(typeof U=="string"&&(U=JSON.parse(U)),typeof G=="string"&&(G=JSON.parse(G)),Array.isArray(U)&&0<U.length),ne=!Array.isArray(G[0]);if(ae&&I){for(var le=0;le<U.length;le++)0<le&&(ee+=C),ee+=z(U[le],le);0<G.length&&(ee+=F)}for(var Z=0;Z<G.length;Z++){var J=(ae?U:G[Z]).length,ge=!1,te=ae?Object.keys(G[Z]).length===0:G[Z].length===0;if(j&&!ae&&(ge=j==="greedy"?G[Z].join("").trim()==="":G[Z].length===1&&G[Z][0].length===0),j==="greedy"&&ae){for(var K=[],Y=0;Y<J;Y++){var fe=ne?U[Y]:Y;K.push(G[Z][fe])}ge=K.join("").trim()===""}if(!ge){for(var ye=0;ye<J;ye++){0<ye&&!te&&(ee+=C);var ie=ae&&ne?U[ye]:ye;ee+=z(G[Z][ie],ye)}Z<G.length-1&&(!j||0<J&&!te)&&(ee+=F)}}return ee}function z(U,G){var j,ee;return U==null?"":U.constructor===Date?JSON.stringify(U).slice(1,25):(ee=!1,L&&typeof U=="string"&&L.test(U)&&(U="'"+U,ee=!0),j=U.toString().replace(O,P),(ee=ee||A===!0||typeof A=="function"&&A(U,G)||Array.isArray(A)&&A[G]||((ae,ne)=>{for(var le=0;le<ne.length;le++)if(-1<ae.indexOf(ne[le]))return!0;return!1})(j,c.BAD_DELIMITERS)||-1<j.indexOf(C)||j.charAt(0)===" "||j.charAt(j.length-1)===" ")?W+j+W:j)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=x,c.ParserHandle=y,c.NetworkStreamer=f,c.FileStreamer=h,c.StringStreamer=p,c.ReadableStreamStreamer=g,n.jQuery&&((s=n.jQuery).fn.parse=function(E){var m=E.config||{},A=[];return this.each(function(F){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var W=0;W<this.files.length;W++)A.push({file:this.files[W],inputElem:this,instanceConfig:s.extend({},m)})}),I(),this;function I(){if(A.length===0)S(E.complete)&&E.complete();else{var F,W,P,R,N=A[0];if(S(E.before)){var L=E.before(N.file,N.inputElem);if(typeof L=="object"){if(L.action==="abort")return F="AbortError",W=N.file,P=N.inputElem,R=L.reason,void(S(E.error)&&E.error({name:F},W,P,R));if(L.action==="skip")return void C();typeof L.config=="object"&&(N.instanceConfig=s.extend(N.instanceConfig,L.config))}else if(L==="skip")return void C()}var O=N.instanceConfig.complete;N.instanceConfig.complete=function(V){S(O)&&O(V,N.file,N.inputElem),C()},c.parse(N.file,N.instanceConfig)}}function C(){A.splice(0,1),I()}}),a&&(n.onmessage=function(E){E=E.data,c.WORKER_ID===void 0&&E&&(c.WORKER_ID=E.workerId),typeof E.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(E.input,E.config),finished:!0}):(n.File&&E.input instanceof File||E.input instanceof Object)&&(E=c.parse(E.input,E.config))&&n.postMessage({workerId:c.WORKER_ID,results:E,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(u.prototype)).constructor=g,c})})(T4);var Wq=T4.exports;const w4=E4(Wq),Uo=xo();function C4(t){return t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(e,r)=>r.toUpperCase()).replace(/^[A-Z]/,e=>e.toLowerCase())}async function zq(t,e){if(!t)return null;const r=Object.values(e).find(n=>{var s;return n.aeriesId===t||n.aeriesId===parseInt(t)||((s=n.aeriesId)==null?void 0:s.toString())===(t==null?void 0:t.toString())});return r?r.id:(console.warn(`No Firebase user found for Aeries teacher ID: ${t}`),null)}function jv(t){return{sourcedId:"stateId",SSID:"stateId",StateStudentID:"stateId",StudentNumber:"localId",givenName:"firstName",FirstName:"firstName",familyName:"lastName",LastName:"lastName",middleName:"middleName",MiddleName:"middleName",email:"email",Email:"email",phone:"phone",Phone:"phone",dateOfBirth:"birthDate",DOB:"birthDate",sex:"gender",Gender:"gender",grade:"grade",Grade:"grade",Address:"address",City:"city",State:"state",ZipCode:"zipCode",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",AttendanceRate:"attendanceRate",attendanceRate:"attendanceRate",Period1TeacherId:"schedule.periods.1",period1TeacherId:"schedule.periods.1",Period2TeacherId:"schedule.periods.2",period2TeacherId:"schedule.periods.2",Period3TeacherId:"schedule.periods.3",period3TeacherId:"schedule.periods.3",Period4TeacherId:"schedule.periods.4",period4TeacherId:"schedule.periods.4",Period5TeacherId:"schedule.periods.5",period5TeacherId:"schedule.periods.5",Period6TeacherId:"schedule.periods.6",period6TeacherId:"schedule.periods.6",Period7TeacherId:"schedule.periods.7",period7TeacherId:"schedule.periods.7",SHTeacherId:"schedule.periods.SH",shTeacherId:"schedule.periods.SH"}[t]||C4(t)}function Gv(t){return{SSID:"ssid",FirstName:"firstName",LastName:"lastName",MiddleName:"middleName",Grade:"grade",DOB:"dob",Gender:"gender",Ethnicity:"ethnicity",School:"school",Address:"address",City:"city",State:"state",ZipCode:"zipCode",Phone:"phone",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",ELL:"ell",504:"504",IEP:"iep",CaseManager:"caseManager",Disability:"disability",ServiceMinutes:"serviceMinutes",Goals:"goals",Notes:"notes",Plan:"plan",ReviewDate:"reviewDate",ReevalDate:"reevalDate",MeetingDate:"meetingDate",SpeechProvider:"speechProvider",MHProvider:"mhProvider",OTProvider:"otProvider",ProgramAccommodations:"programAccommodations",Accommodations:"programAccommodations",IEP_Services:"iepServices"}[t]||C4(t)}async function Kq(t){return new Promise((e,r)=>{w4.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));const i=Object.keys(s[0]).map(o=>o.trim().toLowerCase());if(!(i.includes("sourcedid")||i.includes("ssid")||i.includes("statestudentid")))return r(new Error("Missing required 'sourcedId' or 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function qq(t,e){var a;let r=0;const n=At(Uo,"users"),s=await Gt(n),i={};s.forEach(o=>{i[o.id]={id:o.id,...o.data()}}),console.log(`Loaded ${Object.keys(i).length} users for teacher ID mapping`);for(const o of t){const l=(a=o.sourcedId||o.SSID||o.ssid||o.StateStudentID||o.stateStudentId)==null?void 0:a.trim();if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={firstName:"",lastName:"",grade:"",birthDate:"",gender:"",address:"",city:"",state:"",zipCode:"",phone:"",email:"",parentName:"",parentPhone:"",parentEmail:"",attendanceRate:"",schedule:{periods:{}}};for(const u of e){const f=jv(u),h=o[u],p=h!=null&&typeof h=="string"?h.trim():h!=null?String(h):null;if(f.startsWith("schedule.periods.")){const g=f.split(".")[2];if(p){const y=await zq(p,i);y?(c.schedule.periods[g]=y,console.log(`Mapped Aeries teacher ID ${p} to Firebase user ID ${y} for period ${g}`)):console.warn(`Could not map Aeries teacher ID ${p} for period ${g}`)}}else c[f]=p}c.lastAeriesImport=new Date().toISOString(),console.log("Final aeriesData.schedule structure:",JSON.stringify(c.schedule,null,2));try{const u=At(Uo,"students"),f=lr(u,Ur("app.studentData.ssid","==",l)),h=await Gt(f);if(h.empty){const p=et(At(Uo,"students")),g={app:{studentData:{ssid:l}},aeries:c,createdAt:Pn()};await $t(p,g),console.log(`Created new student ${p.id} with Aeries data for SSID ${l}`)}else{const p=h.docs[0];await $t(et(Uo,"students",p.id),{aeries:c},{merge:!0}),console.log(`Updated existing student ${p.id} with Aeries data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import Aeries data for SSID ${l}:`,u)}}return r}async function Xq(t){return new Promise((e,r)=>{w4.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));if(!Object.keys(s[0]).some(a=>a.trim().toLowerCase()==="ssid"))return r(new Error("Missing required 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function Yq(t,e){var n,s,i,a;let r=0;for(const o of t){const l=((n=o.SSID)==null?void 0:n.trim())||((s=o.ssid)==null?void 0:s.trim());if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={};for(const u of e){const f=Gv(u);u==="IEP_Services"||u==="iep_services"?c[f]=((i=o[u])==null?void 0:i.split(";").map(h=>h.trim()))||[]:u==="ProgramAccommodations"||u==="Accommodations"?c[f]=((a=o[u])==null?void 0:a.split(";").map(h=>h.trim()))||[]:c[f]=o[u]}c.lastSeisImport=new Date().toISOString();try{const u=At(Uo,"students"),f=lr(u,Ur("app.studentData.ssid","==",l)),h=await Gt(f);if(h.empty){const p=et(At(Uo,"students")),g={app:{studentData:{ssid:l}},seis:c,createdAt:Pn()};await $t(p,g),console.log(`Created new student ${p.id} with SEIS data for SSID ${l}`)}else{const p=h.docs[0];await $t(et(Uo,"students",p.id),{seis:c},{merge:!0}),console.log(`Updated existing student ${p.id} with SEIS data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import SEIS data for SSID ${l}:`,u)}}return r}const Qq={name:"SeisImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=_e(()=>r.value.length>0&&s.value.length>0),c=(p,g=!1)=>{a.value=p,o.value=g,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const g=p.target.files[0];if(g){const y=ol(g,{allowedTypes:["csv"],maxSize:10485760,fieldName:"SEIS Import File"});if(!y.isValid){c(y.error,!0),p.target.value="";return}const _=Hr(g.name);if(!_.isSafe){c(`File name contains potentially dangerous content: ${_.threats.join(", ")}`,!0),p.target.value="";return}e.value=g}},previewFile:async()=>{const p=e.value;if(!p){c(" Please select a CSV file.",!0);return}if(!Fs("seisPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const _=(await Xq(p)).map(b=>{const v={};return Object.entries(b).forEach(([T,D])=>{const k=qr(T,{trim:!0,maxLength:100,removeDangerous:!0});let S=D;if(typeof D=="string"){S=qr(D,{trim:!0,maxLength:500,removeDangerous:!0});const E=Hr(S);E.isSafe||(console.warn(`Security threat detected in SEIS data: ${E.threats.join(", ")}`),S="")}v[k]=S}),v});r.value=_,c(` Loaded ${r.value.length} rows.`);const x=Object.keys(r.value[0]||{}).filter(b=>b.length>0);n.value=x,s.value=[...x],i.value=r.value.slice(0,5)}catch(y){c(` Error: ${y.message}`,!0),console.error("SEIS Parse Error:",y)}},importData:async()=>{if(!l.value){c(" Cannot import: No data or fields selected.",!0);return}if(!Fs("seisImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} SEIS records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const g=r.value.map(_=>{const x={};return s.value.forEach(b=>{_[b]!==void 0&&(x[b]=_[b])}),x}),y=g.filter(_=>Object.values(_).some(b=>b&&typeof b=="string"&&b.trim().length>0));if(y.length===0){c(" No valid records found to import.",!0);return}if(y.length!==g.length){const _=g.length-y.length;c(` Skipping ${_} invalid records. Importing ${y.length} valid records.`)}await Yq(y,s.value),c(` Successfully imported ${y.length} SEIS records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(g){c(` Import failed: ${g.message}`,!0),console.error("SEIS Import Error:",g)}}}}}},Jq={class:"seis-import"},Zq=["disabled"],eX={key:0,id:"seis-field-options"},tX=["value"],rX={key:1,id:"seis-preview-container",style:{"margin-top":"1rem"}},nX={border:"1",cellpadding:"4"},sX=["disabled"];function aX(t,e,r,n,s,i){return M(),B("div",Jq,[e[5]||(e[5]=d("h3",null,"Upload SEIS CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,Zq),n.fieldOptions.length>0?(M(),B("div",eX,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(M(!0),B(ke,null,He(n.fieldOptions,a=>(M(),B("label",{key:a},[Oe(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,tX),[[_t,n.selectedFields]]),we(" "+Q(a),1)]))),128))])):ve("",!0),n.previewData.length>0?(M(),B("div",rX,[d("table",nX,[d("thead",null,[d("tr",null,[(M(!0),B(ke,null,He(n.fieldOptions,a=>(M(),B("th",{key:a},Q(a),1))),128))])]),d("tbody",null,[(M(!0),B(ke,null,He(n.previewData,(a,o)=>(M(),B("tr",{key:o},[(M(!0),B(ke,null,He(n.fieldOptions,l=>(M(),B("td",{key:l},Q(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+Q(n.previewData.length)+" of "+Q(n.parsedData.length)+" rows.",1)])):ve("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,sX),d("p",{class:Ye(["status-msg",{error:n.isError}])},Q(n.statusMessage),3)])}const iX=St(Qq,[["render",aX],["__scopeId","data-v-15b6b1af"]]),oX={name:"AeriesImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=_e(()=>r.value.length>0&&s.value.length>0),c=(p,g=!1)=>{a.value=p,o.value=g,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const g=p.target.files[0];if(g){const y=ol(g,{allowedTypes:["csv"],maxSize:10485760,fieldName:"Aeries Import File"});if(!y.isValid){c(y.error,!0),p.target.value="";return}const _=Hr(g.name);if(!_.isSafe){c(`File name contains potentially dangerous content: ${_.threats.join(", ")}`,!0),p.target.value="";return}e.value=g}},previewFile:async()=>{const p=e.value;if(!p){c(" Please select a CSV file.",!0);return}if(!Fs("aeriesPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const _=(await Kq(p)).map(b=>{const v={};return Object.entries(b).forEach(([T,D])=>{const k=qr(T,{trim:!0,maxLength:100,removeDangerous:!0});let S=D;if(typeof D=="string"){S=qr(D,{trim:!0,maxLength:500,removeDangerous:!0});const E=Hr(S);E.isSafe||(console.warn(`Security threat detected in Aeries data: ${E.threats.join(", ")}`),S="")}v[k]=S}),v});r.value=_,c(` Loaded ${r.value.length} rows.`);const x=Object.keys(r.value[0]||{}).filter(b=>b.length>0);n.value=x,s.value=[...x],i.value=r.value.slice(0,5)}catch(y){c(` Error: ${y.message}`,!0),console.error("Aeries Parse Error:",y)}},importData:async()=>{if(!l.value){c(" Cannot import: No data or fields selected.",!0);return}if(!Fs("aeriesImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} Aeries records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const g=r.value.map(_=>{const x={};return s.value.forEach(b=>{_[b]!==void 0&&(x[b]=_[b])}),x}),y=g.filter(_=>Object.values(_).some(b=>b&&typeof b=="string"&&b.trim().length>0));if(y.length===0){c(" No valid records found to import.",!0);return}if(y.length!==g.length){const _=g.length-y.length;c(` Skipping ${_} invalid records. Importing ${y.length} valid records.`)}await qq(y,s.value),c(` Successfully imported ${y.length} Aeries records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(g){c(` Import failed: ${g.message}`,!0),console.error("Aeries Import Error:",g)}}}}}},lX={class:"aeries-import"},cX=["disabled"],uX={key:0,id:"aeries-field-options"},dX=["value"],fX={key:1,id:"aeries-preview-container",style:{"margin-top":"1rem"}},hX={border:"1",cellpadding:"4"},pX=["disabled"];function mX(t,e,r,n,s,i){return M(),B("div",lX,[e[5]||(e[5]=d("h3",null,"Upload Aeries CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,cX),n.fieldOptions.length>0?(M(),B("div",uX,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(M(!0),B(ke,null,He(n.fieldOptions,a=>(M(),B("label",{key:a},[Oe(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,dX),[[_t,n.selectedFields]]),we(" "+Q(a),1)]))),128))])):ve("",!0),n.previewData.length>0?(M(),B("div",fX,[d("table",hX,[d("thead",null,[d("tr",null,[(M(!0),B(ke,null,He(n.fieldOptions,a=>(M(),B("th",{key:a},Q(a),1))),128))])]),d("tbody",null,[(M(!0),B(ke,null,He(n.previewData,(a,o)=>(M(),B("tr",{key:o},[(M(!0),B(ke,null,He(n.fieldOptions,l=>(M(),B("td",{key:l},Q(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+Q(n.previewData.length)+" of "+Q(n.parsedData.length)+" rows.",1)])):ve("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,pX),d("p",{class:Ye(["status-msg",{error:n.isError}])},Q(n.statusMessage),3)])}const gX=St(oX,[["render",mX],["__scopeId","data-v-f01de2a5"]]);function vX(){const t=hc(Kd()),e=se(!1),r=se(!1),n=se(""),s=se(""),i=se(!1),a=As({baseUrl:"encrypted",clientId:"encrypted",clientSecret:"encrypted",selectedSchoolId:"school123",selectedClassIds:["class1","class2"],selectedApiTypes:{oneroster:!0,nativeAeries:!0},selectedEndpoints:["/schools","/students","/api/special-education/students"]}),o=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"},{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),l=(I,C=!1)=>{s.value=I,i.value=C,setTimeout(()=>{s.value="",i.value=!1},5e3)},c=()=>{a.baseUrl="https://demo.aeries.net/aeries",a.clientId="1279e5c6b747b6d62b7c76db3a205d40eb7458e678a90493d537d5af6b953550",a.clientSecret="68019dbf8d8ba82980dd148eecc3977ac0d7f1f040d444225874c88eb80b9c1a",l("Demo credentials loaded. Click Connect to test.")},u=async()=>{if(!a.baseUrl||!a.clientId||!a.clientSecret)return l("Please fill in all connection fields.",!0),!1;r.value=!0,l("Connecting to Aeries API...");try{const F=(await Ra(t,"getAeriesToken")({baseUrl:a.baseUrl,clientId:a.clientId,clientSecret:a.clientSecret})).data;if(F.success&&F.access_token)return n.value=F.access_token,e.value=!0,l(" Successfully connected to Aeries API!"),!0;throw new Error("No access token received")}catch(I){const C=I.message||"Connection failed";return l(` Connection failed: ${C}`,!0),console.error("Aeries API Connection Error:",I),!1}finally{r.value=!1}},f=()=>{e.value=!1,n.value="",l("Disconnected from Aeries API.")},h=async I=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const W=(await Ra(t,"testAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:I,accessToken:n.value})).data;if(W.success)return l(` Successfully fetched data from ${I}`),{data:W.data,responseTime:W.responseTime};throw new Error(W.error||"API call failed")}catch(C){const F=C.message||"API call failed";return l(` API call failed: ${F}`,!0),console.error("Aeries API Test Error:",C),{error:F}}},p=async I=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const W=(await Ra(t,"testCustomAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:I,accessToken:n.value})).data;return W.success?(l(` Successfully fetched data from ${I}`),{data:W.data,responseTime:W.responseTime}):{error:W.error||"API call failed"}}catch(C){const F=C.message||"API call failed";return l(` API call failed: ${F}`,!0),console.error("Custom Aeries API Test Error:",C),{error:F}}},g=async()=>await h("/students"),y=async()=>await h("/teachers"),_=async()=>{const I=["/api/special-education/students","/api/students/special-education","/api/iep/students","/api/504/students"];for(const C of I){const F=await p(C);if(F&&!F.error)return F}return{error:"No special education endpoints found"}},x=async()=>await p("/api/special-education/ieps"),b=async()=>await p("/api/special-education/504-plans"),v=async()=>await p("/api/special-education/accommodations"),T=async()=>await p("/api/special-education/services"),D=async()=>await p("/api/special-education/case-managers"),k=async()=>{const I={},C=o.value.filter(F=>F.path.includes("special-education")||F.path.includes("iep")||F.path.includes("504"));for(const F of C)I[F.path]=await p(F.path);return I},S=async()=>{var C;const I=await h("/students");if(I&&!I.error&&I.data){const F=((C=I.data.students)==null?void 0:C[0])||I.data[0],W=F&&(F.specialEducation||F.iep||F.plan504||F.disabilities||F.accommodations);return{success:!0,hasSpecialEdFields:W,sampleStudent:F,message:W?"OneRoster includes special education data!":"OneRoster does not include special education data"}}return I},E=async()=>{const I=["?filter=specialEducation=true","?filter=iep=true","?filter=plan504=true","?filter=disabilities=*","?filter=accommodations=*"],C={};for(const F of I)C[F]=await h(`/students${F}`);return C};async function m({baseUrl:I,accessToken:C}){const F=hc(),R=await Ra(F,"testAeriesEndpoint")({baseUrl:I,endpoint:"/schools",accessToken:C});return R.data.data.orgs||R.data.data.schools||R.data.data||[]}async function A({baseUrl:I,accessToken:C,schoolId:F}){const W=hc(),P=Ra(W,"testAeriesEndpoint"),R=`/classes?filter=school.sourcedId='${F}'`,N=await P({baseUrl:I,endpoint:R,accessToken:C});return N.data.data.classes||N.data.data||[]}return{isConnected:e,isConnecting:r,accessToken:n,connectionStatus:s,isError:i,connectionConfig:a,availableEndpoints:o,showStatus:l,loadDemoCredentials:c,connect:u,disconnect:f,testEndpoint:h,testCustomEndpoint:p,fetchStudents:g,fetchTeachers:y,fetchSpecialEducationStudents:_,fetchIEPRecords:x,fetch504Plans:b,fetchAccommodations:v,fetchServices:T,fetchCaseManagers:D,testAllSpecialEducationEndpoints:k,testOneRosterForSpecialEd:S,testStudentsWithSpecialEd:E,fetchSchools:m,fetchClasses:A}}const pg=(t,e)=>{let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t.charCodeAt(n)^e.charCodeAt(n%e.length));return btoa(r)},mg=(t,e)=>{const r=atob(t);let n="";for(let s=0;s<r.length;s++)n+=String.fromCharCode(r.charCodeAt(s)^e.charCodeAt(s%e.length));return n};function yX(){const t=xo(),e=uo(),r=se(!1),n=se(null),s=()=>{const c=e.currentUser;if(!c)throw new Error("User not authenticated");return c.uid+"_aeries_config_key"};return{isLoading:r,error:n,saveAeriesConfig:async c=>{if(!e.currentUser)throw new Error("User must be authenticated to save configuration");r.value=!0,n.value=null;try{const u=e.currentUser,f=s(),h={baseUrl:pg(c.baseUrl,f),clientId:pg(c.clientId,f),clientSecret:pg(c.clientSecret,f),selectedSchoolId:c.selectedSchoolId||"",selectedClassIds:c.selectedClassIds||[],manualClassInput:c.manualClassInput||"",savedAt:new Date().toISOString(),userId:u.uid},p=et(t,"users",u.uid,"aeries_config","current");return await $t(p,h),{success:!0,message:"Configuration saved securely"}}catch(u){throw n.value=u.message,console.error("Failed to save Aeries configuration:",u),u}finally{r.value=!1}},loadAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to load configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=s(),f=et(t,"users",c.uid,"aeries_config","current"),h=await er(f);if(!h.exists())return null;const p=h.data();if(p.userId!==c.uid)throw new Error("Configuration security check failed");return{baseUrl:mg(p.baseUrl,u),clientId:mg(p.clientId,u),clientSecret:mg(p.clientSecret,u),selectedSchoolId:p.selectedSchoolId||"",selectedClassIds:p.selectedClassIds||[],manualClassInput:p.manualClassInput||"",savedAt:p.savedAt}}catch(c){throw n.value=c.message,console.error("Failed to load Aeries configuration:",c),c}finally{r.value=!1}},deleteAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to delete configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=et(t,"users",c.uid,"aeries_config","current");return await mo(u),{success:!0,message:"Configuration deleted securely"}}catch(c){throw n.value=c.message,console.error("Failed to delete Aeries configuration:",c),c}finally{r.value=!1}},hasSavedConfig:async()=>{if(!e.currentUser)return!1;try{const c=e.currentUser,u=et(t,"users",c.uid,"aeries_config","current");return(await er(u)).exists()}catch(c){return console.error("Failed to check for saved configuration:",c),!1}}}}const xX={name:"AeriesAPIConnector",setup(){const{isConnected:t,isConnecting:e,accessToken:r,connectionStatus:n,isError:s,connectionConfig:i,availableEndpoints:a,showStatus:o,loadDemoCredentials:l,connect:c,disconnect:u,testEndpoint:f,testAllSpecialEducationEndpoints:h,testOneRosterForSpecialEd:p,testStudentsWithSpecialEd:g,fetchSchools:y,fetchClasses:_}=vX(),{isLoading:x,error:b,saveAeriesConfig:v,loadAeriesConfig:T,deleteAeriesConfig:D,hasSavedConfig:k}=yX(),S=se(!1),E=se(null),m=se(""),A=se(null),I=se([]),C=se(""),F=se([]),W=se([]),P=se(!1),R=se(""),N=se(""),L=se(!1),O=se({oneroster:!1,nativeAeries:!1}),V=se([]),z=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"}]),U=se([{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),G=_e(()=>i.baseUrl&&i.clientId&&i.clientSecret),j=async()=>{if(await c())try{S.value=!0;const ue=await y({baseUrl:i.baseUrl,accessToken:r.value});I.value=ue||[],C.value=""}catch(ue){console.error("Failed to fetch schools:",ue),o("Failed to fetch schools",!0),I.value=[]}finally{S.value=!1}},ee=async ie=>{S.value=!0,m.value=ie,E.value=null,A.value=null;const ue=await f(ie);ue&&!ue.error?(E.value=ue.data,A.value=ue.responseTime):ue&&ue.error&&(E.value={error:ue.error}),S.value=!1},ae=async()=>{S.value=!0,await h(),S.value=!1},ne=async()=>{S.value=!0,m.value="/students (SPED check)",E.value=null,A.value=null;const ie=await p();ie&&!ie.error?(E.value=ie,o(ie.message)):ie&&ie.error&&(E.value={error:ie.error},o(` OneRoster test failed: ${ie.error}`,!0)),S.value=!1},le=async()=>{S.value=!0,m.value="/students (SPED filters)",E.value=null,A.value=null;const ie=await g();ie&&(E.value=ie,o("OneRoster SPED filter tests completed")),S.value=!1};Ht(C,async ie=>{if(!ie){F.value=[],W.value=[];return}P.value=!1,R.value="",S.value=!0;try{F.value=await _({baseUrl:i.baseUrl,accessToken:r.value,schoolId:ie}),W.value=[]}catch{P.value=!0,F.value=[],W.value=[]}finally{S.value=!1}});const Z=_e(()=>t.value&&I.value.length>0),J=_e(()=>Z.value&&C.value),ge=_e(()=>O.value.oneroster||O.value.nativeAeries),te=()=>{const ie=[];O.value.oneroster&&ie.push(...z.value),O.value.nativeAeries&&ie.push(...U.value),a.value=ie},K=(ie,ue=!1)=>{N.value=ie,L.value=ue,setTimeout(()=>{N.value="",L.value=!1},5e3)},Y=async()=>{try{const ie={baseUrl:i.baseUrl,clientId:i.clientId,clientSecret:i.clientSecret,selectedSchoolId:C.value,selectedClassIds:W.value,manualClassInput:R.value,selectedApiTypes:O.value,selectedEndpoints:V.value};await v(ie),K(" Configuration saved securely to Firebase!")}catch(ie){console.error("Failed to save configuration:",ie),K(` Failed to save configuration: ${ie.message}`,!0)}},fe=async()=>{try{const ie=await T();if(!ie){K(" No saved configuration found",!0);return}i.baseUrl=ie.baseUrl||"",i.clientId=ie.clientId||"",i.clientSecret=ie.clientSecret||"",C.value=ie.selectedSchoolId||"",W.value=ie.selectedClassIds||[],R.value=ie.manualClassInput||"",ie.selectedApiTypes&&(O.value=ie.selectedApiTypes),ie.selectedEndpoints&&(V.value=ie.selectedEndpoints),te();const ue=ie.savedAt?new Date(ie.savedAt).toLocaleString():"Unknown";K(` Configuration loaded securely (saved: ${ue})`)}catch(ie){console.error("Failed to load configuration:",ie),K(` Failed to load configuration: ${ie.message}`,!0)}},ye=async()=>{if(confirm("Are you sure you want to permanently delete the saved configuration? This action cannot be undone."))try{await D(),K(" Configuration permanently deleted from Firebase!")}catch(ie){console.error("Failed to clear configuration:",ie),K(` Failed to clear configuration: ${ie.message}`,!0)}};return Wt(async()=>{try{if(await k()){const ue=await T();ue&&(i.baseUrl=ue.baseUrl||"",i.clientId=ue.clientId||"",i.clientSecret=ue.clientSecret||"",ue.selectedApiTypes&&(O.value=ue.selectedApiTypes),ue.selectedEndpoints&&(V.value=ue.selectedEndpoints),te(),K(" Configuration auto-loaded securely from Firebase"))}}catch(ie){console.error("Failed to auto-load configuration:",ie)}}),{connectionConfig:i,isConnected:t,isConnecting:e,isLoading:S,connectionStatus:n,isError:s,apiResults:E,currentEndpoint:m,responseTime:A,availableEndpoints:a,canConnect:G,loadDemoCredentials:l,connect:j,disconnect:u,testEndpoint:ee,handleTestSpecialEd:ae,handleTestOneRosterSpecialEd:ne,handleTestStudentsWithSpecialEd:le,schools:I,selectedSchoolId:C,classes:F,selectedClassIds:W,classesFetchError:P,manualClassInput:R,canShowSchoolDropdown:Z,canShowClasses:J,configStatus:N,configError:L,storageLoading:x,storageError:b,saveConfiguration:Y,loadConfiguration:fe,clearConfiguration:ye,selectedApiTypes:O,selectedEndpoints:V,onerosterEndpoints:z,nativeAeriesEndpoints:U,hasSelectedApiTypes:ge,updateAvailableEndpoints:te}}},EX={class:"aeries-api-connector"},bX={class:"connection-form"},_X={class:"form-group"},SX=["disabled"],AX={class:"form-group"},TX=["disabled"],wX={class:"form-group"},CX=["disabled"],IX={class:"button-group"},kX=["disabled"],DX=["disabled"],PX={class:"api-type-selection"},RX={class:"api-type-options"},FX={class:"api-type-option"},NX={class:"checkbox-label"},OX={class:"api-type-option"},MX={class:"checkbox-label"},LX={key:0,class:"endpoint-selection"},BX={class:"endpoint-categories"},UX={key:0,class:"endpoint-category"},$X={class:"endpoint-checkboxes"},VX=["value"],HX={class:"endpoint-name"},jX={class:"endpoint-path-small"},GX={key:1,class:"endpoint-category"},WX={class:"endpoint-checkboxes"},zX=["value"],KX={class:"endpoint-name"},qX={class:"endpoint-path-small"},XX={class:"config-management"},YX={class:"config-buttons"},QX=["disabled"],JX=["disabled"],ZX=["disabled"],eY={key:1,class:"api-testing"},tY={class:"special-ed-section"},rY={class:"quick-test-buttons"},nY=["disabled"],sY=["disabled"],aY=["disabled"],iY=["disabled"],oY=["disabled"],lY=["disabled"],cY={class:"endpoint-grid"},uY={class:"endpoint-path"},dY={class:"endpoint-description"},fY=["onClick","disabled"],hY={key:0,class:"api-results"},pY={class:"results-header"},mY={class:"endpoint-tested"},gY={key:0,class:"response-time"},vY={class:"results-content"},yY={key:2,class:"form-group"},xY=["value"],EY={key:3,class:"form-group"},bY={key:0},_Y=["value"],SY={key:1};function AY(t,e,r,n,s,i){return M(),B("div",EX,[e[48]||(e[48]=En('<h3 data-v-0f37c4fc>Aeries API Connection</h3><div class="api-info-section" data-v-0f37c4fc><h4 data-v-0f37c4fc>Getting Students with IEP/504 Plans</h4><div class="info-grid" data-v-0f37c4fc><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc> OneRoster API (Limited)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> All students, basic info</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Cannot filter:</strong> Students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> You&#39;d get ALL students, not just SPED</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc> Custom Aeries API (Recommended)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Only students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Includes:</strong> Accommodations, services, case managers</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Perfect for your use case</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc> CSV Import (Fallback)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Filtered data from Aeries export</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Process:</strong> Export SPED students  Import CSV</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Works but requires manual steps</p></div></div><div class="testing-note" data-v-0f37c4fc><p data-v-0f37c4fc><strong data-v-0f37c4fc>Test the buttons below to see what your Aeries instance supports!</strong></p></div></div>',2)),d("div",bX,[d("div",_X,[e[24]||(e[24]=d("label",{for:"baseUrl"},"Base URL:",-1)),Oe(d("input",{id:"baseUrl","onUpdate:modelValue":e[0]||(e[0]=a=>n.connectionConfig.baseUrl=a),type:"url",placeholder:"https://demo.aeries.net/aeries",disabled:n.isConnected},null,8,SX),[[ht,n.connectionConfig.baseUrl]])]),d("div",AX,[e[25]||(e[25]=d("label",{for:"clientId"},"Client ID:",-1)),Oe(d("input",{id:"clientId","onUpdate:modelValue":e[1]||(e[1]=a=>n.connectionConfig.clientId=a),type:"text",placeholder:"Enter your Client ID",disabled:n.isConnected},null,8,TX),[[ht,n.connectionConfig.clientId]])]),d("div",wX,[e[26]||(e[26]=d("label",{for:"clientSecret"},"Client Secret:",-1)),Oe(d("input",{id:"clientSecret","onUpdate:modelValue":e[2]||(e[2]=a=>n.connectionConfig.clientSecret=a),type:"password",placeholder:"Enter your Client Secret",disabled:n.isConnected},null,8,CX),[[ht,n.connectionConfig.clientSecret]])]),d("div",IX,[d("button",{onClick:e[3]||(e[3]=(...a)=>n.connect&&n.connect(...a)),disabled:!n.canConnect||n.isConnecting,class:"btn-primary"},Q(n.isConnecting?"Connecting...":"Connect"),9,kX),n.isConnected?(M(),B("button",{key:0,onClick:e[4]||(e[4]=(...a)=>n.disconnect&&n.disconnect(...a)),class:"btn-secondary"}," Disconnect ")):ve("",!0),d("button",{onClick:e[5]||(e[5]=(...a)=>n.loadDemoCredentials&&n.loadDemoCredentials(...a)),disabled:n.isConnected,class:"btn-demo"}," Load Demo Credentials ",8,DX)]),d("div",PX,[e[37]||(e[37]=d("h4",null,"Select API Types",-1)),e[38]||(e[38]=d("p",{class:"api-type-description"},"Choose which Aeries API types you want to use. This determines which endpoints will be available for testing and data import.",-1)),d("div",RX,[d("div",FX,[d("label",NX,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>n.selectedApiTypes.oneroster=a),onChange:e[7]||(e[7]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[_t,n.selectedApiTypes.oneroster]]),e[27]||(e[27]=d("span",{class:"checkmark"},null,-1)),e[28]||(e[28]=d("strong",null,"OneRoster API",-1))]),e[29]||(e[29]=d("p",{class:"api-type-desc"},"Standard OneRoster endpoints for basic student, teacher, and class data",-1))]),d("div",OX,[d("label",MX,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=a=>n.selectedApiTypes.nativeAeries=a),onChange:e[9]||(e[9]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[_t,n.selectedApiTypes.nativeAeries]]),e[30]||(e[30]=d("span",{class:"checkmark"},null,-1)),e[31]||(e[31]=d("strong",null,"Native Aeries v5 API",-1))]),e[32]||(e[32]=d("p",{class:"api-type-desc"},"Aeries-specific endpoints for special education, IEP, and 504 plan data",-1))])]),n.hasSelectedApiTypes?(M(),B("div",LX,[e[35]||(e[35]=d("h5",null,"Select Endpoints to Use",-1)),e[36]||(e[36]=d("p",{class:"endpoint-description"},"Check the endpoints you want to enable for data import and testing.",-1)),d("div",BX,[n.selectedApiTypes.oneroster?(M(),B("div",UX,[e[33]||(e[33]=d("h6",null,"OneRoster Endpoints",-1)),d("div",$X,[(M(!0),B(ke,null,He(n.onerosterEndpoints,a=>(M(),B("label",{key:a.path,class:"endpoint-checkbox"},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=o=>n.selectedEndpoints=o),value:a.path},null,8,VX),[[_t,n.selectedEndpoints]]),d("span",HX,Q(a.name),1),d("span",jX,Q(a.path),1)]))),128))])])):ve("",!0),n.selectedApiTypes.nativeAeries?(M(),B("div",GX,[e[34]||(e[34]=d("h6",null,"Native Aeries v5 Endpoints",-1)),d("div",WX,[(M(!0),B(ke,null,He(n.nativeAeriesEndpoints,a=>(M(),B("label",{key:a.path,class:"endpoint-checkbox"},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=o=>n.selectedEndpoints=o),value:a.path},null,8,zX),[[_t,n.selectedEndpoints]]),d("span",KX,Q(a.name),1),d("span",qX,Q(a.path),1)]))),128))])])):ve("",!0)])])):ve("",!0)]),d("div",XX,[e[39]||(e[39]=d("h4",null,"Save/Load Configuration",-1)),e[40]||(e[40]=d("div",{class:"security-note"},[d("p",null,[d("strong",null," Security:"),we(" Your API credentials are encrypted and stored securely in Firebase. Only you can access your saved configuration.")])],-1)),d("div",YX,[d("button",{onClick:e[12]||(e[12]=(...a)=>n.saveConfiguration&&n.saveConfiguration(...a)),disabled:!n.canConnect||n.storageLoading,class:"btn-save"},Q(n.storageLoading?" Saving...":" Save Configuration"),9,QX),d("button",{onClick:e[13]||(e[13]=(...a)=>n.loadConfiguration&&n.loadConfiguration(...a)),disabled:n.storageLoading,class:"btn-load"},Q(n.storageLoading?" Loading...":" Load Saved Configuration"),9,JX),d("button",{onClick:e[14]||(e[14]=(...a)=>n.clearConfiguration&&n.clearConfiguration(...a)),disabled:n.storageLoading,class:"btn-clear"},Q(n.storageLoading?" Deleting...":" Clear Saved Configuration"),9,ZX)]),n.configStatus?(M(),B("div",{key:0,class:Ye(["config-status",{error:n.configError}])},Q(n.configStatus),3)):ve("",!0)])]),n.connectionStatus?(M(),B("div",{key:0,class:Ye(["status-message",{error:n.isError}])},Q(n.connectionStatus),3)):ve("",!0),n.isConnected?(M(),B("div",eY,[e[43]||(e[43]=d("h4",null,"Test API Endpoints",-1)),d("div",tY,[e[41]||(e[41]=d("h5",null,"Special Education Data (IEP/504)",-1)),d("div",rY,[d("button",{onClick:e[15]||(e[15]=(...a)=>n.handleTestSpecialEd&&n.handleTestSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-special"},Q(n.isLoading?"Testing...":"Test All SPED Endpoints"),9,nY),d("button",{onClick:e[16]||(e[16]=(...a)=>n.handleTestOneRosterSpecialEd&&n.handleTestOneRosterSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster for SPED Data ",8,sY),d("button",{onClick:e[17]||(e[17]=(...a)=>n.handleTestStudentsWithSpecialEd&&n.handleTestStudentsWithSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster SPED Filters ",8,aY),d("button",{onClick:e[18]||(e[18]=a=>t.handleTestEndpoint("/api/special-education/students")),disabled:n.isLoading,class:"btn-test-special"}," SPED Students ",8,iY),d("button",{onClick:e[19]||(e[19]=a=>t.handleTestEndpoint("/api/special-education/ieps")),disabled:n.isLoading,class:"btn-test-special"}," IEP Records ",8,oY),d("button",{onClick:e[20]||(e[20]=a=>t.handleTestEndpoint("/api/special-education/504-plans")),disabled:n.isLoading,class:"btn-test-special"}," 504 Plans ",8,lY)])]),d("div",cY,[(M(!0),B(ke,null,He(n.availableEndpoints,a=>(M(),B("div",{key:a.path,class:"endpoint-card"},[d("h5",null,Q(a.name),1),d("p",uY,Q(a.path),1),d("p",dY,Q(a.description),1),d("button",{onClick:o=>n.testEndpoint(a.path),disabled:n.isLoading,class:"btn-test"},Q(n.isLoading&&n.currentEndpoint===a.path?"Testing...":"Test"),9,fY)]))),128))]),n.apiResults?(M(),B("div",hY,[e[42]||(e[42]=d("h4",null,"API Response",-1)),d("div",pY,[d("span",mY,"Endpoint: "+Q(n.currentEndpoint),1),n.responseTime?(M(),B("span",gY,"Response time: "+Q(n.responseTime)+"ms",1)):ve("",!0)]),d("div",vY,[d("pre",null,Q(JSON.stringify(n.apiResults,null,2)),1)])])):ve("",!0)])):ve("",!0),n.canShowSchoolDropdown?(M(),B("div",yY,[e[45]||(e[45]=d("label",null,"School",-1)),Oe(d("select",{"onUpdate:modelValue":e[21]||(e[21]=a=>n.selectedSchoolId=a)},[e[44]||(e[44]=d("option",{value:"",disabled:""},"Select a school",-1)),(M(!0),B(ke,null,He(n.schools,a=>(M(),B("option",{key:a.sourcedId||a.id||a.schoolId,value:a.sourcedId||a.id||a.schoolId},Q(a.name||a.title||a.schoolName),9,xY))),128))],512),[[sr,n.selectedSchoolId]])])):ve("",!0),n.canShowClasses?(M(),B("div",EY,[e[47]||(e[47]=d("label",null,"Case Manager Classes",-1)),n.classesFetchError?(M(),B("div",SY,[e[46]||(e[46]=d("p",{class:"error"},"Could not fetch classes. Enter class names manually (comma separated):",-1)),Oe(d("input",{"onUpdate:modelValue":e[23]||(e[23]=a=>n.manualClassInput=a),type:"text",placeholder:"Class1, Class2, ..."},null,512),[[ht,n.manualClassInput]])])):(M(),B("div",bY,[Oe(d("select",{"onUpdate:modelValue":e[22]||(e[22]=a=>n.selectedClassIds=a),multiple:""},[(M(!0),B(ke,null,He(n.classes,a=>(M(),B("option",{key:a.sourcedId||a.id||a.classId,value:a.sourcedId||a.id||a.classId},Q(a.title||a.name||a.className),9,_Y))),128))],512),[[sr,n.selectedClassIds]])]))])):ve("",!0)])}const TY=St(xX,[["render",AY],["__scopeId","data-v-0f37c4fc"]]),wY={key:0,class:"app-settings-panel"},CY={class:"settings-section"},IY={class:"grades-checkboxes"},kY=["checked"],DY=["value"],PY={class:"settings-section"},RY={key:0,class:"class-service-fieldset"},FY={class:"checkbox-inline-group"},NY=["value"],OY={key:1,class:"class-service-fieldset"},MY={class:"checkbox-inline-group"},LY=["value"],BY={key:2,class:"class-service-fieldset"},UY={class:"checkbox-inline-group"},$Y=["value"],VY={key:3,class:"class-service-fieldset"},HY={class:"checkbox-inline-group"},jY=["value"],GY=["onClick"],WY={class:"checkbox-inline-group"},zY=["onClick"],KY=["onClick"],qY={class:"add-class-service"},XY={class:"custom-chips"},YY=["onClick"],QY={class:"settings-section"},JY={class:"service-providers-defaults"},ZY=["value"],eQ={class:"service-providers-custom"},tQ={class:"custom-provider-inputs"},rQ={class:"custom-chips"},nQ=["onClick"],sQ={class:"settings-section"},aQ={class:"periods-controls"},iQ={class:"period-number-control"},oQ=["value"],lQ={key:0,class:"period-labels"},cQ={class:"period-labels-grid"},uQ=["onUpdate:modelValue","placeholder"],dQ={key:1,class:"period-preview"},fQ={class:"settings-section"},hQ={class:"gmail-api-settings"},pQ={class:"gmail-api-status"},mQ={class:"status-indicators"},gQ={class:"status-item"},vQ={class:"status-item"},yQ={class:"status-item"},xQ={key:0,class:"status-message"},EQ={key:1,class:"last-check"},bQ={class:"gmail-api-actions"},_Q=["disabled"],SQ={class:"settings-section"},AQ={class:"admin-action-btns"},TQ=["disabled"],wQ=["disabled"],CQ=["disabled"],IQ={key:1,class:"not-admin"},kQ={__name:"AppSettings",setup(t){const{loadAppSettings:e,saveAppSettings:r,checkGmailApiStatus:n}=Ts(),s=Qr(),i=_e(()=>s.currentUser),a=_e(()=>{var G;return((G=i.value)==null?void 0:G.role)||null}),o=_e(()=>["admin","school_admin","admin_504","sped_chair"].includes(a.value)),l=[{value:"K",label:"K"},...Array.from({length:12},(G,j)=>({value:(j+1).toString(),label:(j+1).toString()}))],c=["English","Math","History","Science"],u=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],f=se(!1),h=se(!1),p=se(!1),g=se(""),y=se(!1),_=se(""),x=se(""),b=se(""),v=se(""),T=se([]),D=se({grades:["7","8"],classServices:[{name:"SDC",subcategories:[...c],enabledSubcategories:[...c]},{name:"Co-teach",subcategories:[...c],enabledSubcategories:[...c]},{name:"RSP",subcategories:[...c],enabledSubcategories:[...c]},{name:"Other",subcategories:["FA","Directed Studies","DS: Reading Intv"],enabledSubcategories:["FA","Directed Studies","DS: Reading Intv"]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:u,customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"]}),k=G=>{const j=qb(G.numPeriods,{min:1,max:15,decimals:0});if(j===null)return C("Invalid number of periods. Must be between 1 and 15.",!0),!1;G.numPeriods=j,G.numPeriods<=0&&(console.log(" Preventing save of invalid numPeriods, setting to 7"),G.numPeriods=7);for(let ee=0;ee<G.numPeriods;ee++){G.periodLabels[ee]||(G.periodLabels[ee]=`Per${ee+1}`);const ae=qr(G.periodLabels[ee],{trim:!0,maxLength:3,removeDangerous:!0}),ne=Hr(ae);if(!ne.isSafe)return C(`Security threat detected in period ${ee+1} label: ${ne.threats.join(", ")}`,!0),!1;const le=Id(ae,{max:3,fieldName:`Period ${ee+1} label`});if(!le.isValid)return C(le.error,!0),!1;G.periodLabels[ee]=ae}if(G.customServiceProviders)for(let ee=0;ee<G.customServiceProviders.length;ee++){const ae=G.customServiceProviders[ee];if(ae.name){const ne=qr(ae.name,{trim:!0,maxLength:100,removeDangerous:!0}),le=Hr(ne);if(!le.isSafe)return C(`Security threat detected in custom provider ${ee+1}: ${le.threats.join(", ")}`,!0),!1;ae.name=ne}if(ae.abbreviation){const ne=qr(ae.abbreviation,{trim:!0,maxLength:10,removeDangerous:!0}),le=Hr(ne);if(!le.isSafe)return C(`Security threat detected in custom provider abbreviation ${ee+1}: ${le.threats.join(", ")}`,!0),!1;ae.abbreviation=ne}}return!0},S=_e(()=>u),E=_e(()=>l.every(G=>D.value.grades.includes(G.value))),m=G=>{G.target.checked?D.value.grades=l.map(j=>j.value):D.value.grades=[]},A=()=>{if(!_.value.trim()||!x.value.trim()){C("Both name and abbreviation are required for custom service providers",!0);return}if(D.value.customServiceProviders.some(j=>j.abbreviation.toLowerCase()===x.value.toLowerCase())){C("A service provider with this abbreviation already exists",!0);return}D.value.customServiceProviders.push({name:_.value.trim(),abbreviation:x.value.trim()}),_.value="",x.value="",C("Custom service provider added successfully")},I=G=>{D.value.customServiceProviders.splice(G,1)};Ht(()=>D.value.numPeriods,(G,j)=>{if(h.value||p.value||f.value||G===j)return;const ee=qb(G,{min:1,max:15,decimals:0});if(ee!==null&&ee!==G){p.value=!0,D.value.numPeriods=ee,setTimeout(()=>{p.value=!1},50);return}if(ee!==null&&ee>0){const ae=["1","2","3","4","5","6","sh"],ne=[...D.value.periodLabels||[]];if(p.value=!0,ne.length<ee){for(let le=ne.length;le<ee;le++)ne.push(ae[le]||`${le+1}`);D.value.periodLabels=ne}else ne.length>ee&&(D.value.periodLabels=ne.slice(0,ee));setTimeout(()=>{p.value=!1},50)}}),Ht(()=>D.value.periodLabels,(G,j)=>{if(h.value||p.value||f.value||!G||!Array.isArray(G))return;let ee=!1;const ae=[...G];G.forEach((ne,le)=>{ne&&typeof ne=="string"&&ne.length>3&&(ae[le]=ne.substring(0,3),ee=!0)}),ee&&(p.value=!0,D.value.periodLabels=ae,setTimeout(()=>{p.value=!1},50))},{deep:!0});const C=(G,j=!1)=>{g.value=G,y.value=j,setTimeout(()=>{g.value="",y.value=!1},5e3)},F=async(G=!1)=>{f.value=!0;try{const j=await e();if(j){if(p.value=!0,D.value={...D.value,...j},(isNaN(D.value.numPeriods)||D.value.numPeriods===null||D.value.numPeriods===void 0||D.value.numPeriods<=0)&&(console.log(" Fixing invalid numPeriods, setting to 7"),D.value.numPeriods=7),Array.isArray(D.value.periodLabels)||(D.value.periodLabels=[]),!D.value.periodLabels||D.value.periodLabels.length<D.value.numPeriods){const ee=["1","2","3","4","5","6","sh"],ae=D.value.periodLabels||[],ne=[];for(let le=0;le<D.value.numPeriods;le++)ne[le]=ae[le]||ee[le]||`${le+1}`;D.value.periodLabels=ne}setTimeout(()=>{p.value=!1},100),G&&C("Settings loaded successfully")}}catch(j){console.error("Load settings error:",j),C("Error loading settings",!0)}finally{f.value=!1}},W=async()=>{if(console.log(" STEP 1: Starting save operation..."),!Fs("saveAppSettings",10,6e4).allowed){console.log(" STEP 1 FAILED: Rate limit exceeded"),C("Too many save requests. Please wait before saving again.",!0);return}console.log(" STEP 1 COMPLETE: Rate limit check passed"),console.log(" STEP 2: Preventing watchers and preparing settings..."),p.value=!0,h.value=!0;try{console.log(" STEP 3: Creating non-reactive copy for validation...");const j=JSON.parse(JSON.stringify(D.value));if(console.log(" STEP 4: Validating settings copy..."),!k(j)){console.log(" STEP 4 FAILED: Validation failed"),p.value=!1,h.value=!1;return}console.log(" STEP 4 COMPLETE: Validation passed"),console.log(" STEP 5: Calling saveAppSettings..."),await r(j),console.log(" STEP 5 COMPLETE: saveAppSettings returned successfully"),C("Settings saved successfully"),console.log(" SAVE OPERATION COMPLETED SUCCESSFULLY")}catch(j){console.error(" SAVE OPERATION FAILED at some step"),console.error(" Error:",j),console.error(" Error message:",j.message),console.error(" Error stack:",j.stack),j.message==="Save operation timed out"?C("Save operation timed out. Please try again.",!0):j.message&&j.message.includes("quota")?C("Storage quota exceeded. Please contact administrator.",!0):j.message&&j.message.includes("permission")?C("Permission denied. Please check your access rights.",!0):C("Error saving settings: "+(j.message||"Unknown error"),!0)}finally{console.log(" saveSettings: before cleanup"),console.log(" STEP 7: Cleaning up - setting saveLoading to false"),h.value=!1,setTimeout(()=>{p.value=!1},100),console.log(" saveSettings: after cleanup"),console.log(" STEP 7 COMPLETE: Cleanup finished")}},P=()=>{confirm("Are you sure you want to reset all settings to defaults? This cannot be undone.")&&(D.value={grades:["7","8"],classServices:[{name:"SDC",subcategories:[...c],enabledSubcategories:[...c]},{name:"Co-teach",subcategories:[...c],enabledSubcategories:[...c]},{name:"RSP",subcategories:[...c],enabledSubcategories:[...c]},{name:"Other",subcategories:["FA","Directed Studies","DS: Reading Intv"],enabledSubcategories:["FA","Directed Studies","DS: Reading Intv"]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:u,customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"]},C("Settings reset to defaults"))},R=G=>{const j=prompt("Enter new subcategory name:");if(j&&j.trim()){const ee=qr(j.trim(),{maxLength:18,removeDangerous:!0});ee&&(D.value.classServices[G]||(D.value.classServices[G]={name:"",subcategories:[],enabledSubcategories:[]}),D.value.classServices[G].subcategories.includes(ee)?C("Subcategory already exists",!0):(D.value.classServices[G].subcategories.push(ee),D.value.classServices[G].enabledSubcategories.push(ee),C("Subcategory added successfully")))}},N=(G,j)=>{if(confirm("Are you sure you want to remove this subcategory?")){const ee=D.value.classServices[G],ae=ee.subcategories[j];ee.subcategories.splice(j,1);const ne=ee.enabledSubcategories.indexOf(ae);ne>-1&&ee.enabledSubcategories.splice(ne,1),C("Subcategory removed successfully")}},L=()=>{if(v.value&&v.value.trim()){const G=qr(v.value.trim(),{maxLength:18,removeDangerous:!0});G&&!T.value.includes(G)?(T.value.push(G),v.value=""):T.value.includes(G)&&C("Subcategory already added",!0)}},O=G=>{T.value.splice(G,1)},V=()=>{if(!b.value||!b.value.trim()){C("Please enter a service name",!0);return}if(T.value.length===0){C("Please add at least one subcategory",!0);return}const G=qr(b.value.trim(),{maxLength:18,removeDangerous:!0});if(G){if(D.value.classServices.find(ae=>ae.name===G)){C("Service with this name already exists",!0);return}const ee={name:G,subcategories:[...T.value],enabledSubcategories:[...T.value]};D.value.classServices.push(ee),b.value="",v.value="",T.value=[],C("Class service added successfully")}},z=G=>{confirm("Are you sure you want to remove this class service?")&&(D.value.classServices.splice(G,1),C("Class service removed successfully"))},U=async()=>{f.value=!0;try{const G=await n();G.enabled?C("Gmail API is enabled and ready to use!"):C(`Gmail API status: Workspace: ${G.isWorkspace?"Yes":"No"}, Internal OAuth: ${G.isInternalOAuth?"Yes":"No"}`,!0)}catch(G){C("Failed to check Gmail API status: "+G.message,!0)}finally{f.value=!1}};return Wt(()=>{F()}),(G,j)=>{var ee,ae,ne,le,Z,J,ge,te;return o.value?(M(),B("div",wY,[j[32]||(j[32]=d("h2",null,"App Settings",-1)),d("form",{onSubmit:Yr(W,["prevent"])},[d("section",CY,[d("fieldset",null,[j[13]||(j[13]=d("legend",null,"Grades",-1)),d("div",IY,[d("label",null,[d("input",{type:"checkbox",checked:E.value,onChange:m},null,40,kY),j[12]||(j[12]=d("span",null,"Select All",-1))]),(M(),B(ke,null,He(l,K=>d("label",{key:K.value},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":j[0]||(j[0]=Y=>D.value.grades=Y),value:K.value},null,8,DY),[[_t,D.value.grades]]),d("span",null,Q(K.label),1)])),64))])])]),d("section",PY,[j[19]||(j[19]=d("h3",null,"Class Services",-1)),D.value.classServices[0]&&D.value.classServices[0].enabledSubcategories?(M(),B("div",RY,[d("fieldset",null,[j[14]||(j[14]=d("legend",null,"SDC",-1)),d("div",FY,[(M(),B(ke,null,He(c,K=>d("label",{key:K},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":j[1]||(j[1]=Y=>D.value.classServices[0].enabledSubcategories=Y),value:K},null,8,NY),[[_t,D.value.classServices[0].enabledSubcategories]]),we(" "+Q(K),1)])),64))])])])):ve("",!0),D.value.classServices[1]&&D.value.classServices[1].enabledSubcategories?(M(),B("div",OY,[d("fieldset",null,[j[15]||(j[15]=d("legend",null,"Co-teach",-1)),d("div",MY,[(M(),B(ke,null,He(c,K=>d("label",{key:K},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":j[2]||(j[2]=Y=>D.value.classServices[1].enabledSubcategories=Y),value:K},null,8,LY),[[_t,D.value.classServices[1].enabledSubcategories]]),we(" "+Q(K),1)])),64))])])])):ve("",!0),D.value.classServices[2]&&D.value.classServices[2].enabledSubcategories?(M(),B("div",BY,[d("fieldset",null,[j[16]||(j[16]=d("legend",null,"RSP",-1)),d("div",UY,[(M(),B(ke,null,He(c,K=>d("label",{key:K},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":j[3]||(j[3]=Y=>D.value.classServices[2].enabledSubcategories=Y),value:K},null,8,$Y),[[_t,D.value.classServices[2].enabledSubcategories]]),we(" "+Q(K),1)])),64))])])])):ve("",!0),D.value.classServices[3]&&D.value.classServices[3].enabledSubcategories?(M(),B("div",VY,[d("fieldset",null,[j[17]||(j[17]=d("legend",null,"Other",-1)),d("div",HY,[(M(),B(ke,null,He(["FA","Directed Studies","DS: Reading Intv"],K=>d("label",{key:K},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":j[4]||(j[4]=Y=>D.value.classServices[3].enabledSubcategories=Y),value:K},null,8,jY),[[_t,D.value.classServices[3].enabledSubcategories]]),we(" "+Q(K),1)])),64))])])])):ve("",!0),(M(!0),B(ke,null,He(D.value.classServices.slice(4),(K,Y)=>(M(),B("div",{key:K.name,class:"class-service-fieldset"},[d("fieldset",null,[d("legend",null,[we(Q(K.name)+" ",1),d("button",{type:"button",onClick:fe=>z(Y+4),title:"Remove Service"},"",8,GY)]),d("div",WY,[(M(!0),B(ke,null,He(K.subcategories,(fe,ye)=>(M(),B("label",{key:fe},[j[18]||(j[18]=d("input",{type:"checkbox",checked:!0,disabled:""},null,-1)),we(" "+Q(fe)+" ",1),d("button",{type:"button",onClick:ie=>N(Y+4,ye),title:"Remove Subcategory"},"",8,zY)]))),128)),d("button",{type:"button",onClick:fe=>R(Y+4)},"+ Add Subcategory",8,KY)])])]))),128)),d("div",qY,[Oe(d("input",{type:"text","onUpdate:modelValue":j[5]||(j[5]=K=>b.value=K),placeholder:"New Service Name",maxlength:"18"},null,512),[[ht,b.value]]),Oe(d("input",{type:"text","onUpdate:modelValue":j[6]||(j[6]=K=>v.value=K),placeholder:"Add Subcategory",maxlength:"18",onKeyup:F1(L,["enter"])},null,544),[[ht,v.value]]),d("button",{type:"button",onClick:L},"+ Add Subcategory"),d("div",XY,[(M(!0),B(ke,null,He(T.value,(K,Y)=>(M(),B("span",{key:K,class:"chip"},[we(Q(K)+" ",1),d("button",{type:"button",onClick:fe=>O(Y)},"",8,YY)]))),128))]),d("button",{type:"button",onClick:V},"+ Add Class Service")])]),d("section",QY,[d("fieldset",null,[j[21]||(j[21]=d("legend",null,"Service Providers",-1)),d("div",JY,[(M(!0),B(ke,null,He(S.value,K=>(M(),B("label",{key:K.abbreviation},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":j[7]||(j[7]=Y=>D.value.serviceProviders=Y),value:K.abbreviation},null,8,ZY),[[_t,D.value.serviceProviders]]),d("span",null,Q(K.name)+" ("+Q(K.abbreviation)+")",1)]))),128))]),d("div",eQ,[j[20]||(j[20]=d("label",null,"Add Custom Service Provider:",-1)),d("div",tQ,[Oe(d("input",{type:"text","onUpdate:modelValue":j[8]||(j[8]=K=>_.value=K),placeholder:"Full Name",maxlength:"100"},null,512),[[ht,_.value]]),Oe(d("input",{type:"text","onUpdate:modelValue":j[9]||(j[9]=K=>x.value=K),placeholder:"Abbreviation",maxlength:"10"},null,512),[[ht,x.value]]),d("button",{type:"button",onClick:A},"Add")]),d("div",rQ,[(M(!0),B(ke,null,He(D.value.customServiceProviders,(K,Y)=>(M(),B("span",{key:Y,class:"chip"},[we(Q(K.name)+" ("+Q(K.abbreviation)+") ",1),d("button",{type:"button",onClick:fe=>I(Y)},"",8,nQ)]))),128))])])])]),d("section",sQ,[d("fieldset",null,[j[25]||(j[25]=d("legend",null,"Periods",-1)),d("div",aQ,[d("div",iQ,[d("label",null,[j[22]||(j[22]=we(" Number of Periods: ")),Oe(d("select",{"onUpdate:modelValue":j[10]||(j[10]=K=>D.value.numPeriods=K),class:"period-number-select"},[(M(),B(ke,null,He(15,K=>d("option",{key:K,value:K},Q(K),9,oQ)),64))],512),[[sr,D.value.numPeriods]])])]),D.value.numPeriods>0?(M(),B("div",lQ,[j[23]||(j[23]=d("h4",null,"Period Labels (3 chars max each):",-1)),d("div",cQ,[(M(!0),B(ke,null,He(D.value.numPeriods,K=>(M(),B("div",{key:K,class:"period-label-item"},[d("label",null,[we(" Period "+Q(K)+": ",1),Oe(d("input",{type:"text","onUpdate:modelValue":Y=>D.value.periodLabels[K-1]=Y,maxlength:"3",placeholder:`Per${K}`,class:"period-label-input"},null,8,uQ),[[ht,D.value.periodLabels[K-1]]])])]))),128))])])):ve("",!0),D.value.numPeriods>0?(M(),B("div",dQ,[j[24]||(j[24]=d("strong",null,"Preview:",-1)),(M(!0),B(ke,null,He(D.value.numPeriods,K=>(M(),B("span",{key:K,class:"period-preview-item"},Q(D.value.periodLabels[K-1]||`Per${K}`),1))),128))])):ve("",!0)])])]),d("section",fQ,[d("fieldset",null,[j[31]||(j[31]=d("legend",null,"Gmail API Settings",-1)),d("div",hQ,[d("div",pQ,[j[30]||(j[30]=d("h4",null,"Status:",-1)),d("div",mQ,[d("div",gQ,[j[26]||(j[26]=d("span",{class:"status-label"},"Google Workspace:",-1)),d("span",{class:Ye(["status-value",(ee=D.value.gmailApi)!=null&&ee.isWorkspace?"enabled":"disabled"])},Q((ae=D.value.gmailApi)!=null&&ae.isWorkspace?"Yes":"No"),3)]),d("div",vQ,[j[27]||(j[27]=d("span",{class:"status-label"},"Internal OAuth:",-1)),d("span",{class:Ye(["status-value",(ne=D.value.gmailApi)!=null&&ne.isInternalOAuth?"enabled":"disabled"])},Q((le=D.value.gmailApi)!=null&&le.isInternalOAuth?"Yes":"No"),3)]),d("div",yQ,[j[28]||(j[28]=d("span",{class:"status-label"},"Gmail API:",-1)),d("span",{class:Ye(["status-value",(Z=D.value.gmailApi)!=null&&Z.enabled?"enabled":"disabled"])},Q((J=D.value.gmailApi)!=null&&J.enabled?"Enabled":"Disabled"),3)])]),(ge=D.value.gmailApi)!=null&&ge.enabled?ve("",!0):(M(),B("div",xQ,j[29]||(j[29]=[d("p",null,"Gmail API features are currently disabled. To enable them, you need:",-1),d("ul",null,[d("li",null,"A Google Workspace organization (not a personal Gmail account)"),d("li",null,'OAuth consent screen set to "Internal" in Google Cloud Console')],-1),d("p",null,"Contact your Google Workspace administrator to configure these settings.",-1)]))),(te=D.value.gmailApi)!=null&&te.lastCheck?(M(),B("div",EQ," Last checked: "+Q(new Date(D.value.gmailApi.lastCheck).toLocaleString()),1)):ve("",!0)]),d("div",bQ,[d("button",{type:"button",onClick:U,disabled:f.value}," Check Gmail API Status ",8,_Q)])])])]),d("section",SQ,[d("div",AQ,[d("button",{type:"submit",disabled:h.value||f.value,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}}," Save Settings",8,TQ),d("button",{type:"button",onClick:j[11]||(j[11]=()=>F(!0)),disabled:f.value,class:"admin-action-btn info",style:{"min-width":"100px","max-width":"100px"}}," Load",8,wQ),d("button",{type:"button",onClick:P,disabled:f.value,class:"admin-action-btn warning",style:{"min-width":"100px","max-width":"100px"}}," Reset",8,CQ)]),g.value?(M(),B("div",{key:0,class:Ye(["status-message",{error:y.value,success:!y.value}])},Q(g.value),3)):ve("",!0)])],32)])):(M(),B("div",IQ,j[33]||(j[33]=[d("h2",null,"App Settings",-1),d("p",null,"Access denied. You must be an admin to view this page.",-1)])))}}},DQ=St(kQ,[["__scopeId","data-v-01d825d5"]]),PQ={class:"admin-aide-assignment"},RQ={class:"header"},FQ={class:"header-actions"},NQ=["disabled"],OQ={key:0},MQ={key:1},LQ={class:"content"},BQ={key:0,class:"error-message"},UQ={key:1,class:"error-message"},$Q={key:2,class:"loading"},VQ={key:3,class:"schedule-container"},HQ={class:"aide-schedule-table"},jQ={class:"aide-name"},GQ=["value","onChange"],WQ=["value"],zQ={class:"assignment-buttons"},KQ=["onClick"],qQ=["onClick"],XQ={class:"direct-assignment-cell"},YQ=["value","onChange"],QQ=["value"],JQ={class:"assignment-buttons"},ZQ=["onClick"],eJ=["onClick"],tJ={__name:"AdminAideAssignment",setup(t){const e=ki(),{userList:r,fetchUsers:n}=_a(),{students:s,fetchStudents:i}=Di(),a=Qr(),{aideAssignment:o,loadAideAssignments:l,saveAllAideAssignments:c}=ex(),{appSettings:u,loadAppSettings:f}=Ts(),h=se(!0),p=se(!1),g=_e(()=>{var R;const P=(R=a.currentUser)==null?void 0:R.role;return["admin","school_admin","admin_504","sped_chair"].includes(P)}),y=_e(()=>{var P;return((P=r.value)==null?void 0:P.filter(R=>R.role==="paraeducator"))||[]}),_=_e(()=>{var P;return((P=r.value)==null?void 0:P.filter(R=>["teacher","case_manager","sped_chair"].includes(R.role)).sort((R,N)=>{const L=O=>{const V=O.name||O.email||O.id,z=V.split(" ");return z.length>1?z[z.length-1]:V};return L(R).localeCompare(L(N))}))||[]}),x=_e(()=>{var R;const P=((R=u.value)==null?void 0:R.numPeriods)||7;return Array.from({length:P},(N,L)=>L+1)});function b(P){return P.id}function v(P){return P.id}function T(P,R){if(!o.value[P])return[""];o.value[P].classAssignment||(o.value[P].classAssignment={});let N=o.value[P].classAssignment[R];return Array.isArray(N)?N.length?N:[""]:typeof N=="string"&&N!==""?[N]:[""]}function D(P){if(!o.value[P])return[""];let R=o.value[P].directAssignment;return Array.isArray(R)?R.length?R:[""]:typeof R=="string"&&R!==""?[R]:[""]}function k(P,R,N,L){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]}),o.value[P].classAssignment||(o.value[P].classAssignment={});let O=T(P,R);for(O[N]=L;O.length>1&&O[O.length-1]==="";)O.pop();o.value[P].classAssignment[R]=[...O]}function S(P,R,N){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]});let L=D(P);for(L[R]=N;L.length>1&&L[L.length-1]==="";)L.pop();o.value[P].directAssignment=[...L]}function E(P,R){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]}),o.value[P].classAssignment||(o.value[P].classAssignment={});let N=T(P,R);N.push(""),o.value[P].classAssignment[R]=[...N]}function m(P,R,N){if(!o.value[P]||!o.value[P].classAssignment)return;let L=T(P,R);L.length<=1||(L.splice(N,1),o.value[P].classAssignment[R]=[...L])}function A(P){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]});let R=D(P);R.push(""),o.value[P].directAssignment=[...R]}function I(P,R){if(!o.value[P])return;let N=D(P);N.length<=1||(N.splice(R,1),o.value[P].directAssignment=[...N])}async function C(){try{h.value=!0,await Promise.all([n(),i(),l(),f()]),h.value=!1}catch(P){console.error("Error loading data:",P),h.value=!1}}async function F(){try{p.value=!0,await c(),p.value=!1}catch(P){console.error("Error saving aide assignments:",P),p.value=!1}}function W(){e.push("/admin")}return Wt(C),(P,R)=>(M(),B("div",PQ,[d("div",RQ,[R[3]||(R[3]=d("h1",null,"Aide Assignment Management",-1)),d("div",FQ,[d("button",{onClick:F,class:"btn btn-primary",disabled:p.value},[p.value?(M(),B("span",OQ,"")):(M(),B("span",MQ,"")),we(" "+Q(p.value?"Saving...":"Save Assignments"),1)],8,NQ),d("button",{onClick:W,class:"btn btn-secondary"},R[2]||(R[2]=[d("span",null,"",-1),we(" Back ")]))])]),d("div",LQ,[q(a).currentUser?g.value?h.value?(M(),B("div",$Q," Loading aide assignments... ")):(M(),B("div",VQ,[d("table",HQ,[d("thead",null,[d("tr",null,[R[8]||(R[8]=d("th",null,"Aide Name",-1)),(M(!0),B(ke,null,He(x.value,N=>(M(),B("th",{key:N,class:"period-header"}," Period "+Q(N),1))),128)),R[9]||(R[9]=d("th",null,"Direct Assignment",-1))])]),d("tbody",null,[(M(!0),B(ke,null,He(y.value,N=>(M(),B("tr",{key:N.id,class:"aide-row"},[d("td",jQ,Q(N.name||N.email),1),(M(!0),B(ke,null,He(x.value,L=>(M(),B("td",{key:L,class:"period-cell"},[(M(!0),B(ke,null,He(T(b(N),L),(O,V)=>(M(),B("div",{key:"t-"+V,class:"assignment-row"},[d("select",{value:O,onChange:z=>k(b(N),L,V,z.target.value),class:"teacher-select"},[R[10]||(R[10]=d("option",{value:""},"No Assignment",-1)),(M(!0),B(ke,null,He(_.value,z=>(M(),B("option",{key:v(z),value:v(z)},Q(z.name||z.email),9,WQ))),128))],40,GQ),d("div",zQ,[T(b(N),L).length>1?(M(),B("button",{key:0,onClick:z=>m(b(N),L,V),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"",8,KQ)):ve("",!0),V===T(b(N),L).length-1?(M(),B("button",{key:1,onClick:z=>E(b(N),L),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,qQ)):ve("",!0)])]))),128))]))),128)),d("td",XQ,[(M(!0),B(ke,null,He(D(b(N)),(L,O)=>(M(),B("div",{key:"d-"+O,class:"assignment-row"},[d("select",{value:L,onChange:V=>S(b(N),O,V.target.value),class:"student-select"},[R[11]||(R[11]=d("option",{value:""},"No Assignment",-1)),(M(!0),B(ke,null,He(q(s),V=>(M(),B("option",{key:V.id,value:V.id},Q(q(at)(V,"firstName"))+" "+Q(q(at)(V,"lastName")),9,QQ))),128))],40,YQ),d("div",JQ,[D(b(N)).length>1?(M(),B("button",{key:0,onClick:V=>I(b(N),O),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"",8,ZQ)):ve("",!0),O===D(b(N)).length-1?(M(),B("button",{key:1,onClick:V=>A(b(N)),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,eJ)):ve("",!0)])]))),128))])]))),128))])])])):(M(),B("div",UQ,[R[6]||(R[6]=d("h2",null,"Access Denied",-1)),R[7]||(R[7]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:R[1]||(R[1]=N=>q(e).push("/")),class:"btn btn-primary"},"Go Home")])):(M(),B("div",BQ,[R[4]||(R[4]=d("h2",null,"Authentication Required",-1)),R[5]||(R[5]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:R[0]||(R[0]=N=>q(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},I4=St(tJ,[["__scopeId","data-v-a77c5b53"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var k4=1252,rJ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ox={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},lx=function(t){rJ.indexOf(t)!=-1&&(k4=ox[0]=t)};function nJ(){lx(1252)}var da=function(t){lx(t)};function D4(){da(1200),nJ()}function O_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function sJ(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function P4(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Su=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?sJ(t.slice(2)):e==254&&r==255?P4(t.slice(2)):e==65279?t.slice(1):t},Jf=function(e){return String.fromCharCode(e)},M_=function(e){return String.fromCharCode(e)},kd,Ji="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function L_(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Ji.charAt(i)+Ji.charAt(a)+Ji.charAt(o)+Ji.charAt(l);return e}function Ms(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=Ji.indexOf(t.charAt(c++)),a=Ji.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=Ji.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ji.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Zt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),El=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function go(t){return Zt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function B_(t){return Zt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ca=function(e){return Zt?El(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function bl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function cx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return cx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Xi=Zt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:El(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function aJ(t){for(var e=[],r=0,n=t.length+250,s=go(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=go(65535),n=65530)}return e.push(s.slice(0,r)),Xi(e)}var hs=/\u0000/g,Au=/[\u0001-\u0006]/g;function mc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function fa(t,e){var r=""+t;return r.length>=e?r:Vr("0",e-r.length)+r}function ux(t,e){var r=""+t;return r.length>=e?r:Vr(" ",e-r.length)+r}function Th(t,e){var r=""+t;return r.length>=e?r:r+Vr(" ",e-r.length)}function iJ(t,e){var r=""+Math.round(t);return r.length>=e?r:Vr("0",e-r.length)+r}function oJ(t,e){var r=""+t;return r.length>=e?r:Vr("0",e-r.length)+r}var U_=Math.pow(2,32);function Ml(t,e){if(t>U_||t<-U_)return iJ(t,e);var r=Math.round(t);return oJ(r,e)}function wh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var $_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lJ(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},V_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cJ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ch(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(s);c<e&&(f=Math.floor(s),o=f*a+i,u=f*c+l,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function $o(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=mJ(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var R4=new Date(1899,11,31,0,0,0),uJ=R4.getTime(),dJ=new Date(1900,2,1,0,0,0);function F4(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=dJ&&(r+=24*60*60*1e3),(r-(uJ+(t.getTimezoneOffset()-R4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function dx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fJ(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hJ(t){var e=t<0?12:11,r=dx(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function pJ(t){var e=dx(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Dd(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=hJ(t):e===10?r=t.toFixed(10).substr(0,12):r=pJ(t),dx(fJ(r.toUpperCase()))}function ll(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Dd(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ks(14,F4(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function mJ(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function gJ(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return gg[r.m-1][1];case 5:return gg[r.m-1][0];default:return gg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return $_[r.q][0];default:return $_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?fa(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=fa(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?fa(l,c):"";return u}function Zi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var N4=/%/g;function vJ(t,e,r){var n=e.replace(N4,""),s=e.length-n.length;return pi(t,n,r*Math.pow(10,2*s))+Vr("%",s)}function yJ(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function O4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+O4(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var M4=/# (\?+)( ?)\/( ?)(\d+)/;function xJ(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Vr(" ",t[1].length+1+t[4].length):ux(a,t[1].length)+t[2]+"/"+t[3]+fa(o,t[4].length))}function EJ(t,e,r){return r+(e===0?"":""+e)+Vr(" ",t[1].length+2+t[4].length)}var L4=/^#*0*\.([0#]+)/,B4=/\).*[0#]/,U4=/\(###\) ###\\?-####/;function os(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function H_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function j_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function bJ(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function _J(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function $s(t,e,r){if(t.charCodeAt(0)===40&&!e.match(B4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$s("n",n,r):"("+$s("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return yJ(t,e,r);if(e.indexOf("%")!==-1)return vJ(t,e,r);if(e.indexOf("E")!==-1)return O4(e,r);if(e.charCodeAt(0)===36)return"$"+$s(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Ml(l,e.length);if(e.match(/^[#?]+$/))return s=Ml(r,0),s==="0"&&(s=""),s.length>e.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(M4))return xJ(i,l,c);if(e.match(/^#+0+$/))return c+Ml(l,e.length-e.indexOf("0"));if(i=e.match(L4))return s=H_(r,i[1].length).replace(/^([^\.]+)$/,"$1."+os(i[1])).replace(/\.$/,"."+os(i[1])).replace(/\.(\d*)$/,function(g,y){return"."+y+Vr("0",os(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+H_(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Zi(Ml(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$s(t,e,-r):Zi(""+(Math.floor(r)+bJ(r,i[1].length)))+"."+fa(j_(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return $s(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=mc($s(t,e.replace(/[\\-]/g,""),r)),a=0,mc(mc(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(U4))return s=$s(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Ch(l,Math.pow(10,a)-1,!1),s=""+c,u=pi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Th(o[2],a),u.length<i[4].length&&(u=os(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Ch(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ux(o[1],a)+i[2]+"/"+i[3]+Th(o[2],a):Vr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Ml(r,0),e.length<=s.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return os(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=j_(r,i[1].length),r<0?"-"+$s(t,e,-r):Zi(_J(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fa(0,3-g.length):"")+g})+"."+fa(a,i[1].length);switch(e){case"###,##0.00":return $s(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Zi(Ml(l,0));return p!=="0"?c+p:"";case"###,###.00":return $s(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $s(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function SJ(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function AJ(t,e,r){var n=e.replace(N4,""),s=e.length-n.length;return pi(t,n,r*Math.pow(10,2*s))+Vr("%",s)}function $4(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+$4(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ia(t,e,r){if(t.charCodeAt(0)===40&&!e.match(B4)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ia("n",n,r):"("+Ia("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return SJ(t,e,r);if(e.indexOf("%")!==-1)return AJ(t,e,r);if(e.indexOf("E")!==-1)return $4(e,r);if(e.charCodeAt(0)===36)return"$"+Ia(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+fa(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(M4))return EJ(i,l,c);if(e.match(/^#+0+$/))return c+fa(l,e.length-e.indexOf("0"));if(i=e.match(L4))return s=(""+r).replace(/^([^\.]+)$/,"$1."+os(i[1])).replace(/\.$/,"."+os(i[1])),s=s.replace(/\.(\d*)$/,function(g,y){return"."+y+Vr("0",os(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Zi(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ia(t,e,-r):Zi(""+r)+"."+Vr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ia(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=mc(Ia(t,e.replace(/[\\-]/g,""),r)),a=0,mc(mc(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(U4))return s=Ia(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Ch(l,Math.pow(10,a)-1,!1),s=""+c,u=pi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Th(o[2],a),u.length<i[4].length&&(u=os(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Ch(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ux(o[1],a)+i[2]+"/"+i[3]+Th(o[2],a):Vr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return os(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ia(t,e,-r):Zi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fa(0,3-g.length):"")+g})+"."+fa(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Zi(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return Ia(t,e.slice(0,e.lastIndexOf(".")),r)+os(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function pi(t,e,r){return(r|0)===r?Ia(t,e,r):$s(t,e,r)}function TJ(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var V4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":wh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(V4))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function wJ(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,f,h="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!wh(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=t.charAt(++a),g=p==="("||p===")"?p:"t";s[s.length]={t:g,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=$o(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=$o(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var y={t:o,v:o};if(c==null&&(c=$o(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(y.v=c.H>=12?"P":"A"),y.t="T",h="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(y.v=c.H>=12?"PM":"AM"),y.t="T",a+=5,h="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(y.v=c.H>=12?"":""),y.t="T",a+=5,h="h"):(y.t="t",++a),c==null&&y.t==="T")return"";s[s.length]=y,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(V4)){if(c==null&&(c=$o(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",zc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var _=0,x=0,b;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=h,l="h",_<1&&(_=1);break;case"s":(b=s[a].v.match(/\.0+$/))&&(x=Math.max(x,b[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&s[a].v.match(/[Hh]/)&&(_=1),_<2&&s[a].v.match(/[Mm]/)&&(_=2),_<3&&s[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var v="",T;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=gJ(s[a].t.charCodeAt(0),s[a].v,c,x),s[a].t="t";break;case"n":case"?":for(T=a+1;s[T]!=null&&((o=s[T].t)==="?"||o==="D"||(o===" "||o==="t")&&s[T+1]!=null&&(s[T+1].t==="?"||s[T+1].t==="t"&&s[T+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[T].v==="/"||s[T].v===" "&&s[T+1]!=null&&s[T+1].t=="?"));)s[a].v+=s[T].v,s[T]={v:"",t:";"},++T;v+=s[a].v,a=T-1;break;case"G":s[a].t="t",s[a].v=ll(e,r);break}var D="",k,S;if(v.length>0){v.charCodeAt(0)==40?(k=e<0&&v.charCodeAt(0)===45?-e:e,S=pi("n",v,k)):(k=e<0&&n>1?-e:e,S=pi("n",v,k),k<0&&s[0]&&s[0].t=="t"&&(S=S.substr(1),s[0].v="-"+s[0].v)),T=S.length-1;var E=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){E=a;break}var m=s.length;if(E===s.length&&S.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(T>=s[a].v.length-1?(T-=s[a].v.length,s[a].v=S.substr(T+1,s[a].v.length)):T<0?s[a].v="":(s[a].v=S.substr(0,T+1),T=-1),s[a].t="t",m=a);T>=0&&m<s.length&&(s[m].v=S.substr(0,T+1)+s[m].v)}else if(E!==s.length&&S.indexOf("E")===-1){for(T=S.indexOf(".")-1,a=E;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")-1:s[a].v.length-1,D=s[a].v.substr(u+1);u>=0;--u)T>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(D=S.charAt(T--)+D);s[a].v=D,s[a].t="t",m=a}for(T>=0&&m<s.length&&(s[m].v=S.substr(0,T+1)+s[m].v),T=S.indexOf(".")+1,a=E;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==E)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")+1:0,D=s[a].v.substr(0,u);u<s[a].v.length;++u)T<S.length&&(D+=S.charAt(T++));s[a].v=D,s[a].t="t",m=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(k=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=pi(s[a].t,s[a].v,k),s[a].t="t");var A="";for(a=0;a!==s.length;++a)s[a]!=null&&(A+=s[a].v);return A}var G_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function W_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function CJ(t,e){var r=TJ(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(G_),o=r[1].match(G_);return W_(e,a)?[n,r[0]]:W_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Ks(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ut)[t],n==null&&(n=r.table&&r.table[V_[t]]||Ut[V_[t]]),n==null&&(n=cJ[t]||"General");break}if(wh(n,0))return ll(e,r);e instanceof Date&&(e=F4(e,r.date1904));var s=CJ(n,e);if(wh(s[1]))return ll(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return wJ(s[1],e,r,s[0])}function Xo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ut[r]==null){e<0&&(e=r);continue}if(Ut[r]==t){e=r;break}}e<0&&(e=391)}return Ut[e]=t,e}function H4(){Ut=lJ()}var IJ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},j4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function kJ(t){var e=typeof t=="number"?Ut[t]:t;return e=e.replace(j4,"(\\d+)"),new RegExp("^"+e+"$")}function DJ(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(j4)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var PJ=function(){var t={};t.version="1.2.0";function e(){for(var S=0,E=new Array(256),m=0;m!=256;++m)S=m,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[m]=S;return typeof Int32Array<"u"?new Int32Array(E):E}var r=e();function n(S){var E=0,m=0,A=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(A=0;A!=256;++A)I[A]=S[A];for(A=0;A!=256;++A)for(m=S[A],E=256+A;E<4096;E+=256)m=I[E]=m>>>8^S[m&255];var C=[];for(A=1;A!=16;++A)C[A-1]=typeof Int32Array<"u"?I.subarray(A*256,A*256+256):I.slice(A*256,A*256+256);return C}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],f=s[6],h=s[7],p=s[8],g=s[9],y=s[10],_=s[11],x=s[12],b=s[13],v=s[14];function T(S,E){for(var m=E^-1,A=0,I=S.length;A<I;)m=m>>>8^r[(m^S.charCodeAt(A++))&255];return~m}function D(S,E){for(var m=E^-1,A=S.length-15,I=0;I<A;)m=v[S[I++]^m&255]^b[S[I++]^m>>8&255]^x[S[I++]^m>>16&255]^_[S[I++]^m>>>24]^y[S[I++]]^g[S[I++]]^p[S[I++]]^h[S[I++]]^f[S[I++]]^u[S[I++]]^c[S[I++]]^l[S[I++]]^o[S[I++]]^a[S[I++]]^i[S[I++]]^r[S[I++]];for(A+=15;I<A;)m=m>>>8^r[(m^S[I++])&255];return~m}function k(S,E){for(var m=E^-1,A=0,I=S.length,C=0,F=0;A<I;)C=S.charCodeAt(A++),C<128?m=m>>>8^r[(m^C)&255]:C<2048?(m=m>>>8^r[(m^(192|C>>6&31))&255],m=m>>>8^r[(m^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,F=S.charCodeAt(A++)&1023,m=m>>>8^r[(m^(240|C>>8&7))&255],m=m>>>8^r[(m^(128|C>>2&63))&255],m=m>>>8^r[(m^(128|F>>6&15|(C&3)<<4))&255],m=m>>>8^r[(m^(128|F&63))&255]):(m=m>>>8^r[(m^(224|C>>12&15))&255],m=m>>>8^r[(m^(128|C>>6&63))&255],m=m>>>8^r[(m^(128|C&63))&255]);return~m}return t.table=r,t.bstr=T,t.buf=D,t.str=k,t}(),nr=function(){var e={};e.version="1.2.1";function r(re,he){for(var ce=re.split("/"),de=he.split("/"),pe=0,me=0,Fe=Math.min(ce.length,de.length);pe<Fe;++pe){if(me=ce[pe].length-de[pe].length)return me;if(ce[pe]!=de[pe])return ce[pe]<de[pe]?-1:1}return ce.length-de.length}function n(re){if(re.charAt(re.length-1)=="/")return re.slice(0,-1).indexOf("/")===-1?re:n(re.slice(0,-1));var he=re.lastIndexOf("/");return he===-1?re:re.slice(0,he+1)}function s(re){if(re.charAt(re.length-1)=="/")return s(re.slice(0,-1));var he=re.lastIndexOf("/");return he===-1?re:re.slice(he+1)}function i(re,he){typeof he=="string"&&(he=new Date(he));var ce=he.getHours();ce=ce<<6|he.getMinutes(),ce=ce<<5|he.getSeconds()>>>1,re.write_shift(2,ce);var de=he.getFullYear()-1980;de=de<<4|he.getMonth()+1,de=de<<5|he.getDate(),re.write_shift(2,de)}function a(re){var he=re.read_shift(2)&65535,ce=re.read_shift(2)&65535,de=new Date,pe=ce&31;ce>>>=5;var me=ce&15;ce>>>=4,de.setMilliseconds(0),de.setFullYear(ce+1980),de.setMonth(me-1),de.setDate(pe);var Fe=he&31;he>>>=5;var je=he&63;return he>>>=6,de.setHours(he),de.setMinutes(je),de.setSeconds(Fe<<1),de}function o(re){kn(re,0);for(var he={},ce=0;re.l<=re.length-4;){var de=re.read_shift(2),pe=re.read_shift(2),me=re.l+pe,Fe={};switch(de){case 21589:ce=re.read_shift(1),ce&1&&(Fe.mtime=re.read_shift(4)),pe>5&&(ce&2&&(Fe.atime=re.read_shift(4)),ce&4&&(Fe.ctime=re.read_shift(4))),Fe.mtime&&(Fe.mt=new Date(Fe.mtime*1e3));break}re.l=me,he[de]=Fe}return he}var l;function c(){return l||(l={})}function u(re,he){if(re[0]==80&&re[1]==75)return mt(re,he);if((re[0]|32)==109&&(re[1]|32)==105)return So(re,he);if(re.length<512)throw new Error("CFB file size "+re.length+" < 512");var ce=3,de=512,pe=0,me=0,Fe=0,je=0,Ne=0,Be=[],Ue=re.slice(0,512);kn(Ue,0);var Je=f(Ue);switch(ce=Je[0],ce){case 3:de=512;break;case 4:de=4096;break;case 0:if(Je[1]==0)return mt(re,he);default:throw new Error("Major Version: Expected 3 or 4 saw "+ce)}de!==512&&(Ue=re.slice(0,de),kn(Ue,28));var tt=re.slice(0,de);h(Ue,ce);var ut=Ue.read_shift(4,"i");if(ce===3&&ut!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ut);Ue.l+=4,Fe=Ue.read_shift(4,"i"),Ue.l+=4,Ue.chk("00100000","Mini Stream Cutoff Size: "),je=Ue.read_shift(4,"i"),pe=Ue.read_shift(4,"i"),Ne=Ue.read_shift(4,"i"),me=Ue.read_shift(4,"i");for(var Ze=-1,it=0;it<109&&(Ze=Ue.read_shift(4,"i"),!(Ze<0));++it)Be[it]=Ze;var kt=p(re,de);_(Ne,me,kt,de,Be);var vr=b(kt,Fe,Be,de);vr[Fe].name="!Directory",pe>0&&je!==F&&(vr[je].name="!MiniFAT"),vr[Be[0]].name="!FAT",vr.fat_addrs=Be,vr.ssz=de;var hr={},Ir=[],Ka=[],To=[];v(Fe,vr,kt,Ir,pe,hr,Ka,je),g(Ka,To,Ir),Ir.shift();var Fi={FileIndex:Ka,FullPaths:To};return he&&he.raw&&(Fi.raw={header:tt,sectors:kt}),Fi}function f(re){if(re[re.l]==80&&re[re.l+1]==75)return[0,0];re.chk(W,"Header Signature: "),re.l+=16;var he=re.read_shift(2,"u");return[re.read_shift(2,"u"),he]}function h(re,he){var ce=9;switch(re.l+=2,ce=re.read_shift(2)){case 9:if(he!=3)throw new Error("Sector Shift: Expected 9 saw "+ce);break;case 12:if(he!=4)throw new Error("Sector Shift: Expected 12 saw "+ce);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ce)}re.chk("0600","Mini Sector Shift: "),re.chk("000000000000","Reserved: ")}function p(re,he){for(var ce=Math.ceil(re.length/he)-1,de=[],pe=1;pe<ce;++pe)de[pe-1]=re.slice(pe*he,(pe+1)*he);return de[ce-1]=re.slice(ce*he),de}function g(re,he,ce){for(var de=0,pe=0,me=0,Fe=0,je=0,Ne=ce.length,Be=[],Ue=[];de<Ne;++de)Be[de]=Ue[de]=de,he[de]=ce[de];for(;je<Ue.length;++je)de=Ue[je],pe=re[de].L,me=re[de].R,Fe=re[de].C,Be[de]===de&&(pe!==-1&&Be[pe]!==pe&&(Be[de]=Be[pe]),me!==-1&&Be[me]!==me&&(Be[de]=Be[me])),Fe!==-1&&(Be[Fe]=de),pe!==-1&&de!=Be[de]&&(Be[pe]=Be[de],Ue.lastIndexOf(pe)<je&&Ue.push(pe)),me!==-1&&de!=Be[de]&&(Be[me]=Be[de],Ue.lastIndexOf(me)<je&&Ue.push(me));for(de=1;de<Ne;++de)Be[de]===de&&(me!==-1&&Be[me]!==me?Be[de]=Be[me]:pe!==-1&&Be[pe]!==pe&&(Be[de]=Be[pe]));for(de=1;de<Ne;++de)if(re[de].type!==0){if(je=de,je!=Be[je])do je=Be[je],he[de]=he[je]+"/"+he[de];while(je!==0&&Be[je]!==-1&&je!=Be[je]);Be[de]=-1}for(he[0]+="/",de=1;de<Ne;++de)re[de].type!==2&&(he[de]+="/")}function y(re,he,ce){for(var de=re.start,pe=re.size,me=[],Fe=de;ce&&pe>0&&Fe>=0;)me.push(he.slice(Fe*C,Fe*C+C)),pe-=C,Fe=Mo(ce,Fe*4);return me.length===0?un(0):Xi(me).slice(0,re.size)}function _(re,he,ce,de,pe){var me=F;if(re===F){if(he!==0)throw new Error("DIFAT chain shorter than expected")}else if(re!==-1){var Fe=ce[re],je=(de>>>2)-1;if(!Fe)return;for(var Ne=0;Ne<je&&(me=Mo(Fe,Ne*4))!==F;++Ne)pe.push(me);_(Mo(Fe,de-4),he-1,ce,de,pe)}}function x(re,he,ce,de,pe){var me=[],Fe=[];pe||(pe=[]);var je=de-1,Ne=0,Be=0;for(Ne=he;Ne>=0;){pe[Ne]=!0,me[me.length]=Ne,Fe.push(re[Ne]);var Ue=ce[Math.floor(Ne*4/de)];if(Be=Ne*4&je,de<4+Be)throw new Error("FAT boundary crossed: "+Ne+" 4 "+de);if(!re[Ue])break;Ne=Mo(re[Ue],Be)}return{nodes:me,data:tS([Fe])}}function b(re,he,ce,de){var pe=re.length,me=[],Fe=[],je=[],Ne=[],Be=de-1,Ue=0,Je=0,tt=0,ut=0;for(Ue=0;Ue<pe;++Ue)if(je=[],tt=Ue+he,tt>=pe&&(tt-=pe),!Fe[tt]){Ne=[];var Ze=[];for(Je=tt;Je>=0;){Ze[Je]=!0,Fe[Je]=!0,je[je.length]=Je,Ne.push(re[Je]);var it=ce[Math.floor(Je*4/de)];if(ut=Je*4&Be,de<4+ut)throw new Error("FAT boundary crossed: "+Je+" 4 "+de);if(!re[it]||(Je=Mo(re[it],ut),Ze[Je]))break}me[tt]={nodes:je,data:tS([Ne])}}return me}function v(re,he,ce,de,pe,me,Fe,je){for(var Ne=0,Be=de.length?2:0,Ue=he[re].data,Je=0,tt=0,ut;Je<Ue.length;Je+=128){var Ze=Ue.slice(Je,Je+128);kn(Ze,64),tt=Ze.read_shift(2),ut=gx(Ze,0,tt-Be),de.push(ut);var it={name:ut,type:Ze.read_shift(1),color:Ze.read_shift(1),L:Ze.read_shift(4,"i"),R:Ze.read_shift(4,"i"),C:Ze.read_shift(4,"i"),clsid:Ze.read_shift(16),state:Ze.read_shift(4,"i"),start:0,size:0},kt=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);kt!==0&&(it.ct=T(Ze,Ze.l-8));var vr=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);vr!==0&&(it.mt=T(Ze,Ze.l-8)),it.start=Ze.read_shift(4,"i"),it.size=Ze.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=F,it.name=""),it.type===5?(Ne=it.start,pe>0&&Ne!==F&&(he[Ne].name="!StreamData")):it.size>=4096?(it.storage="fat",he[it.start]===void 0&&(he[it.start]=x(ce,it.start,he.fat_addrs,he.ssz)),he[it.start].name=it.name,it.content=he[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:Ne!==F&&it.start!==F&&he[Ne]&&(it.content=y(it,he[Ne].data,(he[je]||{}).data))),it.content&&kn(it.content,0),me[ut]=it,Fe.push(it)}}function T(re,he){return new Date((Ds(re,he+4)/1e7*Math.pow(2,32)+Ds(re,he)/1e7-11644473600)*1e3)}function D(re,he){return c(),u(l.readFileSync(re),he)}function k(re,he){var ce=he&&he.type;switch(ce||Zt&&Buffer.isBuffer(re)&&(ce="buffer"),ce||"base64"){case"file":return D(re,he);case"base64":return u(ca(Ms(re)),he);case"binary":return u(ca(re),he)}return u(re,he)}function S(re,he){var ce=he||{},de=ce.root||"Root Entry";if(re.FullPaths||(re.FullPaths=[]),re.FileIndex||(re.FileIndex=[]),re.FullPaths.length!==re.FileIndex.length)throw new Error("inconsistent CFB structure");re.FullPaths.length===0&&(re.FullPaths[0]=de+"/",re.FileIndex[0]={name:de,type:5}),ce.CLSID&&(re.FileIndex[0].clsid=ce.CLSID),E(re)}function E(re){var he="Sh33tJ5";if(!nr.find(re,"/"+he)){var ce=un(4);ce[0]=55,ce[1]=ce[3]=50,ce[2]=54,re.FileIndex.push({name:he,type:2,content:ce,size:4,L:69,R:69,C:69}),re.FullPaths.push(re.FullPaths[0]+he),m(re)}}function m(re,he){S(re);for(var ce=!1,de=!1,pe=re.FullPaths.length-1;pe>=0;--pe){var me=re.FileIndex[pe];switch(me.type){case 0:de?ce=!0:(re.FileIndex.pop(),re.FullPaths.pop());break;case 1:case 2:case 5:de=!0,isNaN(me.R*me.L*me.C)&&(ce=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(ce=!0);break;default:ce=!0;break}}if(!(!ce&&!he)){var Fe=new Date(1987,1,19),je=0,Ne=Object.create?Object.create(null):{},Be=[];for(pe=0;pe<re.FullPaths.length;++pe)Ne[re.FullPaths[pe]]=!0,re.FileIndex[pe].type!==0&&Be.push([re.FullPaths[pe],re.FileIndex[pe]]);for(pe=0;pe<Be.length;++pe){var Ue=n(Be[pe][0]);de=Ne[Ue],de||(Be.push([Ue,{name:s(Ue).replace("/",""),type:1,clsid:R,ct:Fe,mt:Fe,content:null}]),Ne[Ue]=!0)}for(Be.sort(function(ut,Ze){return r(ut[0],Ze[0])}),re.FullPaths=[],re.FileIndex=[],pe=0;pe<Be.length;++pe)re.FullPaths[pe]=Be[pe][0],re.FileIndex[pe]=Be[pe][1];for(pe=0;pe<Be.length;++pe){var Je=re.FileIndex[pe],tt=re.FullPaths[pe];if(Je.name=s(tt).replace("/",""),Je.L=Je.R=Je.C=-(Je.color=1),Je.size=Je.content?Je.content.length:0,Je.start=0,Je.clsid=Je.clsid||R,pe===0)Je.C=Be.length>1?1:-1,Je.size=0,Je.type=5;else if(tt.slice(-1)=="/"){for(je=pe+1;je<Be.length&&n(re.FullPaths[je])!=tt;++je);for(Je.C=je>=Be.length?-1:je,je=pe+1;je<Be.length&&n(re.FullPaths[je])!=n(tt);++je);Je.R=je>=Be.length?-1:je,Je.type=1}else n(re.FullPaths[pe+1]||"")==n(tt)&&(Je.R=pe+1),Je.type=2}}}function A(re,he){var ce=he||{};if(ce.fileType=="mad")return ln(re,ce);switch(m(re),ce.fileType){case"zip":return Rt(re,ce)}var de=function(ut){for(var Ze=0,it=0,kt=0;kt<ut.FileIndex.length;++kt){var vr=ut.FileIndex[kt];if(vr.content){var hr=vr.content.length;hr>0&&(hr<4096?Ze+=hr+63>>6:it+=hr+511>>9)}}for(var Ir=ut.FullPaths.length+3>>2,Ka=Ze+7>>3,To=Ze+127>>7,Fi=Ka+it+Ir+To,Sa=Fi+127>>7,Il=Sa<=109?0:Math.ceil((Sa-109)/127);Fi+Sa+Il+127>>7>Sa;)Il=++Sa<=109?0:Math.ceil((Sa-109)/127);var ws=[1,Il,Sa,To,Ir,it,Ze,0];return ut.FileIndex[0].size=Ze<<6,ws[7]=(ut.FileIndex[0].start=ws[0]+ws[1]+ws[2]+ws[3]+ws[4]+ws[5])+(ws[6]+7>>3),ws}(re),pe=un(de[7]<<9),me=0,Fe=0;{for(me=0;me<8;++me)pe.write_shift(1,P[me]);for(me=0;me<8;++me)pe.write_shift(2,0);for(pe.write_shift(2,62),pe.write_shift(2,3),pe.write_shift(2,65534),pe.write_shift(2,9),pe.write_shift(2,6),me=0;me<3;++me)pe.write_shift(2,0);for(pe.write_shift(4,0),pe.write_shift(4,de[2]),pe.write_shift(4,de[0]+de[1]+de[2]+de[3]-1),pe.write_shift(4,0),pe.write_shift(4,4096),pe.write_shift(4,de[3]?de[0]+de[1]+de[2]-1:F),pe.write_shift(4,de[3]),pe.write_shift(-4,de[1]?de[0]-1:F),pe.write_shift(4,de[1]),me=0;me<109;++me)pe.write_shift(-4,me<de[2]?de[1]+me:-1)}if(de[1])for(Fe=0;Fe<de[1];++Fe){for(;me<236+Fe*127;++me)pe.write_shift(-4,me<de[2]?de[1]+me:-1);pe.write_shift(-4,Fe===de[1]-1?F:Fe+1)}var je=function(ut){for(Fe+=ut;me<Fe-1;++me)pe.write_shift(-4,me+1);ut&&(++me,pe.write_shift(-4,F))};for(Fe=me=0,Fe+=de[1];me<Fe;++me)pe.write_shift(-4,N.DIFSECT);for(Fe+=de[2];me<Fe;++me)pe.write_shift(-4,N.FATSECT);je(de[3]),je(de[4]);for(var Ne=0,Be=0,Ue=re.FileIndex[0];Ne<re.FileIndex.length;++Ne)Ue=re.FileIndex[Ne],Ue.content&&(Be=Ue.content.length,!(Be<4096)&&(Ue.start=Fe,je(Be+511>>9)));for(je(de[6]+7>>3);pe.l&511;)pe.write_shift(-4,N.ENDOFCHAIN);for(Fe=me=0,Ne=0;Ne<re.FileIndex.length;++Ne)Ue=re.FileIndex[Ne],Ue.content&&(Be=Ue.content.length,!(!Be||Be>=4096)&&(Ue.start=Fe,je(Be+63>>6)));for(;pe.l&511;)pe.write_shift(-4,N.ENDOFCHAIN);for(me=0;me<de[4]<<2;++me){var Je=re.FullPaths[me];if(!Je||Je.length===0){for(Ne=0;Ne<17;++Ne)pe.write_shift(4,0);for(Ne=0;Ne<3;++Ne)pe.write_shift(4,-1);for(Ne=0;Ne<12;++Ne)pe.write_shift(4,0);continue}Ue=re.FileIndex[me],me===0&&(Ue.start=Ue.size?Ue.start-1:F);var tt=me===0&&ce.root||Ue.name;if(Be=2*(tt.length+1),pe.write_shift(64,tt,"utf16le"),pe.write_shift(2,Be),pe.write_shift(1,Ue.type),pe.write_shift(1,Ue.color),pe.write_shift(-4,Ue.L),pe.write_shift(-4,Ue.R),pe.write_shift(-4,Ue.C),Ue.clsid)pe.write_shift(16,Ue.clsid,"hex");else for(Ne=0;Ne<4;++Ne)pe.write_shift(4,0);pe.write_shift(4,Ue.state||0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,Ue.start),pe.write_shift(4,Ue.size),pe.write_shift(4,0)}for(me=1;me<re.FileIndex.length;++me)if(Ue=re.FileIndex[me],Ue.size>=4096)if(pe.l=Ue.start+1<<9,Zt&&Buffer.isBuffer(Ue.content))Ue.content.copy(pe,pe.l,0,Ue.size),pe.l+=Ue.size+511&-512;else{for(Ne=0;Ne<Ue.size;++Ne)pe.write_shift(1,Ue.content[Ne]);for(;Ne&511;++Ne)pe.write_shift(1,0)}for(me=1;me<re.FileIndex.length;++me)if(Ue=re.FileIndex[me],Ue.size>0&&Ue.size<4096)if(Zt&&Buffer.isBuffer(Ue.content))Ue.content.copy(pe,pe.l,0,Ue.size),pe.l+=Ue.size+63&-64;else{for(Ne=0;Ne<Ue.size;++Ne)pe.write_shift(1,Ue.content[Ne]);for(;Ne&63;++Ne)pe.write_shift(1,0)}if(Zt)pe.l=pe.length;else for(;pe.l<pe.length;)pe.write_shift(1,0);return pe}function I(re,he){var ce=re.FullPaths.map(function(Ne){return Ne.toUpperCase()}),de=ce.map(function(Ne){var Be=Ne.split("/");return Be[Be.length-(Ne.slice(-1)=="/"?2:1)]}),pe=!1;he.charCodeAt(0)===47?(pe=!0,he=ce[0].slice(0,-1)+he):pe=he.indexOf("/")!==-1;var me=he.toUpperCase(),Fe=pe===!0?ce.indexOf(me):de.indexOf(me);if(Fe!==-1)return re.FileIndex[Fe];var je=!me.match(Au);for(me=me.replace(hs,""),je&&(me=me.replace(Au,"!")),Fe=0;Fe<ce.length;++Fe)if((je?ce[Fe].replace(Au,"!"):ce[Fe]).replace(hs,"")==me||(je?de[Fe].replace(Au,"!"):de[Fe]).replace(hs,"")==me)return re.FileIndex[Fe];return null}var C=64,F=-2,W="d0cf11e0a1b11ae1",P=[208,207,17,224,161,177,26,225],R="00000000000000000000000000000000",N={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:R,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function L(re,he,ce){c();var de=A(re,ce);l.writeFileSync(he,de)}function O(re){for(var he=new Array(re.length),ce=0;ce<re.length;++ce)he[ce]=String.fromCharCode(re[ce]);return he.join("")}function V(re,he){var ce=A(re,he);switch(he&&he.type||"buffer"){case"file":return c(),l.writeFileSync(he.filename,ce),ce;case"binary":return typeof ce=="string"?ce:O(ce);case"base64":return L_(typeof ce=="string"?ce:O(ce));case"buffer":if(Zt)return Buffer.isBuffer(ce)?ce:El(ce);case"array":return typeof ce=="string"?ca(ce):ce}return ce}var z;function U(re){try{var he=re.InflateRaw,ce=new he;if(ce._processChunk(new Uint8Array([3,0]),ce._finishFlushFlag),ce.bytesRead)z=re;else throw new Error("zlib does not expose bytesRead")}catch(de){console.error("cannot use native zlib: "+(de.message||de))}}function G(re,he){if(!z)return pt(re,he);var ce=z.InflateRaw,de=new ce,pe=de._processChunk(re.slice(re.l),de._finishFlushFlag);return re.l+=de.bytesRead,pe}function j(re){return z?z.deflateRawSync(re):xe(re)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(re){var he=(re<<1|re<<11)&139536|(re<<5|re<<15)&558144;return(he>>16|he>>8|he)&255}for(var Z=typeof Uint8Array<"u",J=Z?new Uint8Array(256):[],ge=0;ge<256;++ge)J[ge]=le(ge);function te(re,he){var ce=J[re&255];return he<=8?ce>>>8-he:(ce=ce<<8|J[re>>8&255],he<=16?ce>>>16-he:(ce=ce<<8|J[re>>16&255],ce>>>24-he))}function K(re,he){var ce=he&7,de=he>>>3;return(re[de]|(ce<=6?0:re[de+1]<<8))>>>ce&3}function Y(re,he){var ce=he&7,de=he>>>3;return(re[de]|(ce<=5?0:re[de+1]<<8))>>>ce&7}function fe(re,he){var ce=he&7,de=he>>>3;return(re[de]|(ce<=4?0:re[de+1]<<8))>>>ce&15}function ye(re,he){var ce=he&7,de=he>>>3;return(re[de]|(ce<=3?0:re[de+1]<<8))>>>ce&31}function ie(re,he){var ce=he&7,de=he>>>3;return(re[de]|(ce<=1?0:re[de+1]<<8))>>>ce&127}function ue(re,he,ce){var de=he&7,pe=he>>>3,me=(1<<ce)-1,Fe=re[pe]>>>de;return ce<8-de||(Fe|=re[pe+1]<<8-de,ce<16-de)||(Fe|=re[pe+2]<<16-de,ce<24-de)||(Fe|=re[pe+3]<<24-de),Fe&me}function Ee(re,he,ce){var de=he&7,pe=he>>>3;return de<=5?re[pe]|=(ce&7)<<de:(re[pe]|=ce<<de&255,re[pe+1]=(ce&7)>>8-de),he+3}function Ce(re,he,ce){var de=he&7,pe=he>>>3;return ce=(ce&1)<<de,re[pe]|=ce,he+1}function Pe(re,he,ce){var de=he&7,pe=he>>>3;return ce<<=de,re[pe]|=ce&255,ce>>>=8,re[pe+1]=ce,he+8}function Te(re,he,ce){var de=he&7,pe=he>>>3;return ce<<=de,re[pe]|=ce&255,ce>>>=8,re[pe+1]=ce&255,re[pe+2]=ce>>>8,he+16}function ze(re,he){var ce=re.length,de=2*ce>he?2*ce:he+5,pe=0;if(ce>=he)return re;if(Zt){var me=B_(de);if(re.copy)re.copy(me);else for(;pe<re.length;++pe)me[pe]=re[pe];return me}else if(Z){var Fe=new Uint8Array(de);if(Fe.set)Fe.set(re);else for(;pe<ce;++pe)Fe[pe]=re[pe];return Fe}return re.length=de,re}function Ie(re){for(var he=new Array(re),ce=0;ce<re;++ce)he[ce]=0;return he}function be(re,he,ce){var de=1,pe=0,me=0,Fe=0,je=0,Ne=re.length,Be=Z?new Uint16Array(32):Ie(32);for(me=0;me<32;++me)Be[me]=0;for(me=Ne;me<ce;++me)re[me]=0;Ne=re.length;var Ue=Z?new Uint16Array(Ne):Ie(Ne);for(me=0;me<Ne;++me)Be[pe=re[me]]++,de<pe&&(de=pe),Ue[me]=0;for(Be[0]=0,me=1;me<=de;++me)Be[me+16]=je=je+Be[me-1]<<1;for(me=0;me<Ne;++me)je=re[me],je!=0&&(Ue[me]=Be[je+16]++);var Je=0;for(me=0;me<Ne;++me)if(Je=re[me],Je!=0)for(je=te(Ue[me],de)>>de-Je,Fe=(1<<de+4-Je)-1;Fe>=0;--Fe)he[je|Fe<<Je]=Je&15|me<<4;return de}var Me=Z?new Uint16Array(512):Ie(512),Ke=Z?new Uint16Array(32):Ie(32);if(!Z){for(var qe=0;qe<512;++qe)Me[qe]=0;for(qe=0;qe<32;++qe)Ke[qe]=0}(function(){for(var re=[],he=0;he<32;he++)re.push(5);be(re,Ke,32);var ce=[];for(he=0;he<=143;he++)ce.push(8);for(;he<=255;he++)ce.push(9);for(;he<=279;he++)ce.push(7);for(;he<=287;he++)ce.push(8);be(ce,Me,288)})();var Se=function(){for(var he=Z?new Uint8Array(32768):[],ce=0,de=0;ce<ne.length-1;++ce)for(;de<ne[ce+1];++de)he[de]=ce;for(;de<32768;++de)he[de]=29;var pe=Z?new Uint8Array(259):[];for(ce=0,de=0;ce<ae.length-1;++ce)for(;de<ae[ce+1];++de)pe[de]=ce;function me(je,Ne){for(var Be=0;Be<je.length;){var Ue=Math.min(65535,je.length-Be),Je=Be+Ue==je.length;for(Ne.write_shift(1,+Je),Ne.write_shift(2,Ue),Ne.write_shift(2,~Ue&65535);Ue-- >0;)Ne[Ne.l++]=je[Be++]}return Ne.l}function Fe(je,Ne){for(var Be=0,Ue=0,Je=Z?new Uint16Array(32768):[];Ue<je.length;){var tt=Math.min(65535,je.length-Ue);if(tt<10){for(Be=Ee(Ne,Be,+(Ue+tt==je.length)),Be&7&&(Be+=8-(Be&7)),Ne.l=Be/8|0,Ne.write_shift(2,tt),Ne.write_shift(2,~tt&65535);tt-- >0;)Ne[Ne.l++]=je[Ue++];Be=Ne.l*8;continue}Be=Ee(Ne,Be,+(Ue+tt==je.length)+2);for(var ut=0;tt-- >0;){var Ze=je[Ue];ut=(ut<<5^Ze)&32767;var it=-1,kt=0;if((it=Je[ut])&&(it|=Ue&-32768,it>Ue&&(it-=32768),it<Ue))for(;je[it+kt]==je[Ue+kt]&&kt<250;)++kt;if(kt>2){Ze=pe[kt],Ze<=22?Be=Pe(Ne,Be,J[Ze+1]>>1)-1:(Pe(Ne,Be,3),Be+=5,Pe(Ne,Be,J[Ze-23]>>5),Be+=3);var vr=Ze<8?0:Ze-4>>2;vr>0&&(Te(Ne,Be,kt-ae[Ze]),Be+=vr),Ze=he[Ue-it],Be=Pe(Ne,Be,J[Ze]>>3),Be-=3;var hr=Ze<4?0:Ze-2>>1;hr>0&&(Te(Ne,Be,Ue-it-ne[Ze]),Be+=hr);for(var Ir=0;Ir<kt;++Ir)Je[ut]=Ue&32767,ut=(ut<<5^je[Ue])&32767,++Ue;tt-=kt-1}else Ze<=143?Ze=Ze+48:Be=Ce(Ne,Be,1),Be=Pe(Ne,Be,J[Ze]),Je[ut]=Ue&32767,++Ue}Be=Pe(Ne,Be,0)-1}return Ne.l=(Be+7)/8|0,Ne.l}return function(Ne,Be){return Ne.length<8?me(Ne,Be):Fe(Ne,Be)}}();function xe(re){var he=un(50+Math.floor(re.length*1.1)),ce=Se(re,he);return he.slice(0,ce)}var Ae=Z?new Uint16Array(32768):Ie(32768),Le=Z?new Uint16Array(32768):Ie(32768),We=Z?new Uint16Array(128):Ie(128),$e=1,dt=1;function xt(re,he){var ce=ye(re,he)+257;he+=5;var de=ye(re,he)+1;he+=5;var pe=fe(re,he)+4;he+=4;for(var me=0,Fe=Z?new Uint8Array(19):Ie(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ne=1,Be=Z?new Uint8Array(8):Ie(8),Ue=Z?new Uint8Array(8):Ie(8),Je=Fe.length,tt=0;tt<pe;++tt)Fe[ee[tt]]=me=Y(re,he),Ne<me&&(Ne=me),Be[me]++,he+=3;var ut=0;for(Be[0]=0,tt=1;tt<=Ne;++tt)Ue[tt]=ut=ut+Be[tt-1]<<1;for(tt=0;tt<Je;++tt)(ut=Fe[tt])!=0&&(je[tt]=Ue[ut]++);var Ze=0;for(tt=0;tt<Je;++tt)if(Ze=Fe[tt],Ze!=0){ut=J[je[tt]]>>8-Ze;for(var it=(1<<7-Ze)-1;it>=0;--it)We[ut|it<<Ze]=Ze&7|tt<<3}var kt=[];for(Ne=1;kt.length<ce+de;)switch(ut=We[ie(re,he)],he+=ut&7,ut>>>=3){case 16:for(me=3+K(re,he),he+=2,ut=kt[kt.length-1];me-- >0;)kt.push(ut);break;case 17:for(me=3+Y(re,he),he+=3;me-- >0;)kt.push(0);break;case 18:for(me=11+ie(re,he),he+=7;me-- >0;)kt.push(0);break;default:kt.push(ut),Ne<ut&&(Ne=ut);break}var vr=kt.slice(0,ce),hr=kt.slice(ce);for(tt=ce;tt<286;++tt)vr[tt]=0;for(tt=de;tt<30;++tt)hr[tt]=0;return $e=be(vr,Ae,286),dt=be(hr,Le,30),he}function Vt(re,he){if(re[0]==3&&!(re[1]&3))return[go(he),2];for(var ce=0,de=0,pe=B_(he||1<<18),me=0,Fe=pe.length>>>0,je=0,Ne=0;!(de&1);){if(de=Y(re,ce),ce+=3,de>>>1)de>>1==1?(je=9,Ne=5):(ce=xt(re,ce),je=$e,Ne=dt);else{ce&7&&(ce+=8-(ce&7));var Be=re[ce>>>3]|re[(ce>>>3)+1]<<8;if(ce+=32,Be>0)for(!he&&Fe<me+Be&&(pe=ze(pe,me+Be),Fe=pe.length);Be-- >0;)pe[me++]=re[ce>>>3],ce+=8;continue}for(;;){!he&&Fe<me+32767&&(pe=ze(pe,me+32767),Fe=pe.length);var Ue=ue(re,ce,je),Je=de>>>1==1?Me[Ue]:Ae[Ue];if(ce+=Je&15,Je>>>=4,!(Je>>>8&255))pe[me++]=Je;else{if(Je==256)break;Je-=257;var tt=Je<8?0:Je-4>>2;tt>5&&(tt=0);var ut=me+ae[Je];tt>0&&(ut+=ue(re,ce,tt),ce+=tt),Ue=ue(re,ce,Ne),Je=de>>>1==1?Ke[Ue]:Le[Ue],ce+=Je&15,Je>>>=4;var Ze=Je<4?0:Je-2>>1,it=ne[Je];for(Ze>0&&(it+=ue(re,ce,Ze),ce+=Ze),!he&&Fe<ut&&(pe=ze(pe,ut+100),Fe=pe.length);me<ut;)pe[me]=pe[me-it],++me}}}return he?[pe,ce+7>>>3]:[pe.slice(0,me),ce+7>>>3]}function pt(re,he){var ce=re.slice(re.l||0),de=Vt(ce,he);return re.l+=de[1],de[0]}function ct(re,he){if(re)typeof console<"u"&&console.error(he);else throw new Error(he)}function mt(re,he){var ce=re;kn(ce,0);var de=[],pe=[],me={FileIndex:de,FullPaths:pe};S(me,{root:he.root});for(var Fe=ce.length-4;(ce[Fe]!=80||ce[Fe+1]!=75||ce[Fe+2]!=5||ce[Fe+3]!=6)&&Fe>=0;)--Fe;ce.l=Fe+4,ce.l+=4;var je=ce.read_shift(2);ce.l+=6;var Ne=ce.read_shift(4);for(ce.l=Ne,Fe=0;Fe<je;++Fe){ce.l+=20;var Be=ce.read_shift(4),Ue=ce.read_shift(4),Je=ce.read_shift(2),tt=ce.read_shift(2),ut=ce.read_shift(2);ce.l+=8;var Ze=ce.read_shift(4),it=o(ce.slice(ce.l+Je,ce.l+Je+tt));ce.l+=Je+tt+ut;var kt=ce.l;ce.l=Ze+4,Ct(ce,Be,Ue,me,it),ce.l=kt}return me}function Ct(re,he,ce,de,pe){re.l+=2;var me=re.read_shift(2),Fe=re.read_shift(2),je=a(re);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var Ne=re.read_shift(4),Be=re.read_shift(4),Ue=re.read_shift(4),Je=re.read_shift(2),tt=re.read_shift(2),ut="",Ze=0;Ze<Je;++Ze)ut+=String.fromCharCode(re[re.l++]);if(tt){var it=o(re.slice(re.l,re.l+tt));(it[21589]||{}).mt&&(je=it[21589].mt),((pe||{})[21589]||{}).mt&&(je=pe[21589].mt)}re.l+=tt;var kt=re.slice(re.l,re.l+Be);switch(Fe){case 8:kt=G(re,Ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Fe)}var vr=!1;me&8&&(Ne=re.read_shift(4),Ne==134695760&&(Ne=re.read_shift(4),vr=!0),Be=re.read_shift(4),Ue=re.read_shift(4)),Be!=he&&ct(vr,"Bad compressed size: "+he+" != "+Be),Ue!=ce&&ct(vr,"Bad uncompressed size: "+ce+" != "+Ue),Rr(de,ut,kt,{unsafe:!0,mt:je})}function Rt(re,he){var ce=he||{},de=[],pe=[],me=un(1),Fe=ce.compression?8:0,je=0,Ne=0,Be=0,Ue=0,Je=0,tt=re.FullPaths[0],ut=tt,Ze=re.FileIndex[0],it=[],kt=0;for(Ne=1;Ne<re.FullPaths.length;++Ne)if(ut=re.FullPaths[Ne].slice(tt.length),Ze=re.FileIndex[Ne],!(!Ze.size||!Ze.content||ut=="Sh33tJ5")){var vr=Ue,hr=un(ut.length);for(Be=0;Be<ut.length;++Be)hr.write_shift(1,ut.charCodeAt(Be)&127);hr=hr.slice(0,hr.l),it[Je]=PJ.buf(Ze.content,0);var Ir=Ze.content;Fe==8&&(Ir=j(Ir)),me=un(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,je),me.write_shift(2,Fe),Ze.mt?i(me,Ze.mt):me.write_shift(4,0),me.write_shift(-4,it[Je]),me.write_shift(4,Ir.length),me.write_shift(4,Ze.content.length),me.write_shift(2,hr.length),me.write_shift(2,0),Ue+=me.length,de.push(me),Ue+=hr.length,de.push(hr),Ue+=Ir.length,de.push(Ir),me=un(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,je),me.write_shift(2,Fe),me.write_shift(4,0),me.write_shift(-4,it[Je]),me.write_shift(4,Ir.length),me.write_shift(4,Ze.content.length),me.write_shift(2,hr.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,vr),kt+=me.l,pe.push(me),kt+=hr.length,pe.push(hr),++Je}return me=un(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,Je),me.write_shift(2,Je),me.write_shift(4,kt),me.write_shift(4,Ue),me.write_shift(2,0),Xi([Xi(de),Xi(pe),me])}var mr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function mn(re,he){if(re.ctype)return re.ctype;var ce=re.name||"",de=ce.match(/\.([^\.]+)$/);return de&&mr[de[1]]||he&&(de=(ce=he).match(/[\.\\]([^\.\\])+$/),de&&mr[de[1]])?mr[de[1]]:"application/octet-stream"}function Qs(re){for(var he=L_(re),ce=[],de=0;de<he.length;de+=76)ce.push(he.slice(de,de+76));return ce.join(`\r
`)+`\r
`}function ms(re){var he=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Be){var Ue=Be.charCodeAt(0).toString(16).toUpperCase();return"="+(Ue.length==1?"0"+Ue:Ue)});he=he.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),he.charAt(0)==`
`&&(he="=0D"+he.slice(1)),he=he.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ce=[],de=he.split(`\r
`),pe=0;pe<de.length;++pe){var me=de[pe];if(me.length==0){ce.push("");continue}for(var Fe=0;Fe<me.length;){var je=76,Ne=me.slice(Fe,Fe+je);Ne.charAt(je-1)=="="?je--:Ne.charAt(je-2)=="="?je-=2:Ne.charAt(je-3)=="="&&(je-=3),Ne=me.slice(Fe,Fe+je),Fe+=je,Fe<me.length&&(Ne+="="),ce.push(Ne)}}return ce.join(`\r
`)}function wl(re){for(var he=[],ce=0;ce<re.length;++ce){for(var de=re[ce];ce<=re.length&&de.charAt(de.length-1)=="=";)de=de.slice(0,de.length-1)+re[++ce];he.push(de)}for(var pe=0;pe<he.length;++pe)he[pe]=he[pe].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return ca(he.join(`\r
`))}function za(re,he,ce){for(var de="",pe="",me="",Fe,je=0;je<10;++je){var Ne=he[je];if(!Ne||Ne.match(/^\s*$/))break;var Be=Ne.match(/^(.*?):\s*([^\s].*)$/);if(Be)switch(Be[1].toLowerCase()){case"content-location":de=Be[2].trim();break;case"content-type":me=Be[2].trim();break;case"content-transfer-encoding":pe=Be[2].trim();break}}switch(++je,pe.toLowerCase()){case"base64":Fe=ca(Ms(he.slice(je).join("")));break;case"quoted-printable":Fe=wl(he.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+pe)}var Ue=Rr(re,de.slice(ce.length),Fe,{unsafe:!0});me&&(Ue.ctype=me)}function So(re,he){if(O(re.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ce=he&&he.root||"",de=(Zt&&Buffer.isBuffer(re)?re.toString("binary"):O(re)).split(`\r
`),pe=0,me="";for(pe=0;pe<de.length;++pe)if(me=de[pe],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),ce||(ce=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,ce.length)!=ce))for(;ce.length>0&&(ce=ce.slice(0,ce.length-1),ce=ce.slice(0,ce.lastIndexOf("/")+1),me.slice(0,ce.length)!=ce););var Fe=(de[1]||"").match(/boundary="(.*?)"/);if(!Fe)throw new Error("MAD cannot find boundary");var je="--"+(Fe[1]||""),Ne=[],Be=[],Ue={FileIndex:Ne,FullPaths:Be};S(Ue);var Je,tt=0;for(pe=0;pe<de.length;++pe){var ut=de[pe];ut!==je&&ut!==je+"--"||(tt++&&za(Ue,de.slice(Je,pe),ce),Je=pe)}return Ue}function ln(re,he){var ce=he||{},de=ce.boundary||"SheetJS";de="------="+de;for(var pe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+de.slice(2)+'"',"","",""],me=re.FullPaths[0],Fe=me,je=re.FileIndex[0],Ne=1;Ne<re.FullPaths.length;++Ne)if(Fe=re.FullPaths[Ne].slice(me.length),je=re.FileIndex[Ne],!(!je.size||!je.content||Fe=="Sh33tJ5")){Fe=Fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(kt){return"_x"+kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(kt){return"_u"+kt.charCodeAt(0).toString(16)+"_"});for(var Be=je.content,Ue=Zt&&Buffer.isBuffer(Be)?Be.toString("binary"):O(Be),Je=0,tt=Math.min(1024,Ue.length),ut=0,Ze=0;Ze<=tt;++Ze)(ut=Ue.charCodeAt(Ze))>=32&&ut<128&&++Je;var it=Je>=tt*4/5;pe.push(de),pe.push("Content-Location: "+(ce.root||"file:///C:/SheetJS/")+Fe),pe.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),pe.push("Content-Type: "+mn(je,Fe)),pe.push(""),pe.push(it?ms(Ue):Qs(Ue))}return pe.push(de+`--\r
`),pe.join(`\r
`)}function Ao(re){var he={};return S(he,re),he}function Rr(re,he,ce,de){var pe=de&&de.unsafe;pe||S(re);var me=!pe&&nr.find(re,he);if(!me){var Fe=re.FullPaths[0];he.slice(0,Fe.length)==Fe?Fe=he:(Fe.slice(-1)!="/"&&(Fe+="/"),Fe=(Fe+he).replace("//","/")),me={name:s(he),type:2},re.FileIndex.push(me),re.FullPaths.push(Fe),pe||nr.utils.cfb_gc(re)}return me.content=ce,me.size=ce?ce.length:0,de&&(de.CLSID&&(me.clsid=de.CLSID),de.mt&&(me.mt=de.mt),de.ct&&(me.ct=de.ct)),me}function Ln(re,he){S(re);var ce=nr.find(re,he);if(ce){for(var de=0;de<re.FileIndex.length;++de)if(re.FileIndex[de]==ce)return re.FileIndex.splice(de,1),re.FullPaths.splice(de,1),!0}return!1}function Cl(re,he,ce){S(re);var de=nr.find(re,he);if(de){for(var pe=0;pe<re.FileIndex.length;++pe)if(re.FileIndex[pe]==de)return re.FileIndex[pe].name=s(ce),re.FullPaths[pe]=ce,!0}return!1}function Xc(re){m(re,!0)}return e.find=I,e.read=k,e.parse=u,e.write=V,e.writeFile=L,e.utils={cfb_new:Ao,cfb_add:Rr,cfb_del:Ln,cfb_mov:Cl,cfb_gc:Xc,ReadShift:Xu,CheckField:dk,prep_blob:kn,bconcat:Xi,use_zlib:U,_deflateRaw:xe,_inflateRaw:pt,consts:N},e}();function RJ(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Va(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function fx(t){for(var e=[],r=Va(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Ih=new Date(1899,11,30,0,0,0);function ps(t,e){var r=t.getTime(),n=Ih.getTime()+(t.getTimezoneOffset()-Ih.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var G4=new Date,FJ=Ih.getTime()+(G4.getTimezoneOffset()-Ih.getTimezoneOffset())*6e4,z_=G4.getTimezoneOffset();function Vp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+FJ),e.getTimezoneOffset()!==z_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-z_)*6e4),e}function NJ(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var K_=new Date("2017-02-19T19:06:09.000Z"),W4=isNaN(K_.getFullYear())?new Date("2/19/17"):K_,OJ=W4.getFullYear()==2017;function bn(t,e){var r=new Date(t);if(OJ)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(W4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function cl(t,e){if(Zt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return wu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return wu(P4(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return wu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return wu(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function On(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=On(t[r]));return e}function Vr(t,e){for(var r="";r.length<e;)r+=t;return r}function ma(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var MJ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&MJ.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var LJ=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function z4(t){return t?t.content&&t.type?cl(t.content,!0):t.data?Su(t.data):t.asNodeBuffer&&Zt?Su(t.asNodeBuffer().toString("binary")):t.asBinary?Su(t.asBinary()):t._data&&t._data.getContent?Su(cl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function K4(t){if(!t)return null;if(t.data)return O_(t.data);if(t.asNodeBuffer&&Zt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?O_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function BJ(t){return t&&t.name.slice(-4)===".bin"?K4(t):z4(t)}function Vs(t,e){for(var r=t.FullPaths||Va(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function hx(t,e){var r=Vs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function rn(t,e,r){if(!r)return BJ(hx(t,e));if(!e)return null;try{return rn(t,e)}catch{return null}}function Ps(t,e,r){if(!r)return z4(hx(t,e));if(!e)return null;try{return Ps(t,e)}catch{return null}}function UJ(t,e,r){return K4(hx(t,e))}function q_(t){for(var e=t.FullPaths||Va(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function $J(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Zt?n=El(r):n=aJ(r),nr.utils.cfb_add(t,e,n)}nr.utils.cfb_add(t,e,r)}else t.file(e,r)}function q4(t,e){switch(e.type){case"base64":return nr.read(t,{type:"base64"});case"binary":return nr.read(t,{type:"binary"});case"buffer":case"array":return nr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Tu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var X4=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,VJ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,X_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,HJ=/<[^>]*>/g,ns=X4.match(X_)?X_:HJ,jJ=/<\w*:/,GJ=/<(\/?)\w+:/;function It(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(VJ),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,l=f.slice(i+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ga(t){return t.replace(GJ,"<$1")}var Y4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},WJ=fx(Y4),ir=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return Y4[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),zJ=/[&<>'"]/g,KJ=/[\u0000-\u001f]/g;function px(t){var e=t+"";return e.replace(zJ,function(r){return WJ[r]}).replace(/\n/g,"<br/>").replace(KJ,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Y_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Dr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function vg(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Q_(t){var e=go(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function J_(t){return El(t,"binary").toString("utf8")}var Zf="foo bar baz",Ar=Zt&&(J_(Zf)==vg(Zf)&&J_||Q_(Zf)==vg(Zf)&&Q_)||vg,wu=Zt?function(t){return El(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Pd=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Q4=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),qJ=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),XJ=/<\/?(?:vt:)?variant>/g,YJ=/<(?:vt:)([^>]*)>([\s\S]*)</;function Z_(t,e){var r=It(t),n=t.match(qJ(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(XJ,"").match(YJ);a&&s.push({v:Ar(a[2]),t:a[1]})}),s}var QJ=/(^\s|\s$|\n)/;function JJ(t){return Va(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ZJ(t,e,r){return"<"+t+(r!=null?JJ(r):"")+(e!=null?(e.match(QJ)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function mx(t){if(Zt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ar(bl(cx(t)));throw new Error("Bad input format: expected Buffer or string")}var Rd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,eZ={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},tZ=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function rZ(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function nZ(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var eS=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},tS=Zt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:El(e)})):eS(t)}:eS,rS=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(di(t,s)));return n.join("").replace(hs,"")},gx=Zt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(hs,""):rS(t,e,r)}:rS,nS=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},J4=Zt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):nS(t,e,r)}:nS,sS=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Kl(t,s)));return n.join("")},uf=Zt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):sS(e,r,n)}:sS,Z4=function(t,e){var r=Ds(t,e);return r>0?uf(t,e+4,e+4+r-1):""},ek=Z4,tk=function(t,e){var r=Ds(t,e);return r>0?uf(t,e+4,e+4+r-1):""},rk=tk,nk=function(t,e){var r=2*Ds(t,e);return r>0?uf(t,e+4,e+4+r-1):""},sk=nk,ak=function(e,r){var n=Ds(e,r);return n>0?gx(e,r+4,r+4+n):""},ik=ak,ok=function(t,e){var r=Ds(t,e);return r>0?uf(t,e+4,e+4+r):""},lk=ok,ck=function(t,e){return rZ(t,e)},kh=ck,uk=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Zt&&(ek=function(e,r){if(!Buffer.isBuffer(e))return Z4(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},rk=function(e,r){if(!Buffer.isBuffer(e))return tk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},sk=function(e,r){if(!Buffer.isBuffer(e))return nk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},ik=function(e,r){if(!Buffer.isBuffer(e))return ak(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},lk=function(e,r){if(!Buffer.isBuffer(e))return ok(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},kh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):ck(e,r)},uk=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Kl=function(t,e){return t[e]},di=function(t,e){return t[e+1]*256+t[e]},sZ=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ds=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Mo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},aZ=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Xu(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Zt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(di(this,c)),c+=2;t*=2;break;case"utf8":r=uf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=gx(this,this.l,this.l+t);break;case"wstr":return Xu.call(this,t,"dbcs");case"lpstr-ansi":r=ek(this,this.l),t=4+Ds(this,this.l);break;case"lpstr-cp":r=rk(this,this.l),t=4+Ds(this,this.l);break;case"lpwstr":r=sk(this,this.l),t=4+2*Ds(this,this.l);break;case"lpp4":t=4+Ds(this,this.l),r=ik(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ds(this,this.l),r=lk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Kl(this,this.l+t++))!==0;)i.push(Jf(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=di(this,this.l+t))!==0;)i.push(Jf(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Kl(this,c),this.l=c+1,o=Xu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Jf(di(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Kl(this,c),this.l=c+1,o=Xu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Jf(Kl(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=Kl(this,this.l),this.l++,n;case 2:return n=(e==="i"?sZ:di)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Mo:aZ)(this,this.l),this.l+=4,n):(s=Ds(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=kh(this,this.l):s=kh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=J4(this,this.l,t);break}}return this.l+=t,r}var iZ=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},oZ=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},lZ=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function cZ(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)lZ(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,iZ(this,e,this.l);break;case 8:if(n=8,r==="f"){nZ(this,e,this.l);break}case 16:break;case-4:n=4,oZ(this,e,this.l);break}return this.l+=n,this}function dk(t,e){var r=J4(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function kn(t,e){t.l=e,t.read_shift=Xu,t.chk=dk,t.write_shift=cZ}function rs(t,e){t.l+=e}function un(t){var e=go(t);return kn(e,0),e}function Pi(t,e,r){if(t){var n,s,i;kn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Oh[o]||Oh[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var u=c.f&&c.f(t,i,r);if(t.l=l,e(u,c,o))return}}}function Wv(){var t=[],e=Zt?256:2048,r=function(c){var u=un(c);return kn(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),Xi(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function Yu(t,e,r){var n=On(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function aS(t,e,r){var n=On(t);return n.s=Yu(n.s,e.s,r),n.e=Yu(n.e,e.s,r),n}function Qu(t,e){if(t.cRel&&t.c<0)for(t=On(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=On(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Mt(t);return!t.cRel&&t.cRel!=null&&(r=fZ(r)),!t.rRel&&t.rRel!=null&&(r=uZ(r)),r}function yg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+hn(t.s.c)+":"+(t.e.cRel?"":"$")+hn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mn(t.s.r)+":"+(t.e.rRel?"":"$")+Mn(t.e.r):Qu(t.s,e.biff)+":"+Qu(t.e,e.biff)}function vx(t){return parseInt(dZ(t),10)-1}function Mn(t){return""+(t+1)}function uZ(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dZ(t){return t.replace(/\$(\d+)$/,"$1")}function yx(t){for(var e=hZ(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function hn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function fZ(t){return t.replace(/^([A-Z])/,"$$$1")}function hZ(t){return t.replace(/^\$([A-Z])/,"$1")}function pZ(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ds(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Mt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Kc(t){var e=t.indexOf(":");return e==-1?{s:ds(t),e:ds(t)}:{s:ds(t.slice(0,e)),e:ds(t.slice(e+1))}}function ar(t,e){return typeof e>"u"||typeof e=="number"?ar(t.s,t.e):(typeof t!="string"&&(t=Mt(t)),typeof e!="string"&&(e=Mt(e)),t==e?t:t+":"+e)}function Gr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function iS(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ks(t.z,r?ps(e):e)}catch{}try{return t.w=Ks((t.XF||{}).numFmtId||(r?14:0),r?ps(e):e)}catch{return""+e}}function Ci(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Al[t.v]||t.v:e==null?iS(t,t.v):iS(t,e))}function _o(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function fk(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ds(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Gr(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[f].length;++h)if(!(typeof e[f][h]>"u")){var p={v:e[f][h]},g=a+f,y=o+h;if(c.s.r>g&&(c.s.r=g),c.s.c>y&&(c.s.c=y),c.e.r<g&&(c.e.r=g),c.e.c<y&&(c.e.c=y),e[f][h]&&typeof e[f][h]=="object"&&!Array.isArray(e[f][h])&&!(e[f][h]instanceof Date))p=e[f][h];else if(Array.isArray(p.v)&&(p.f=e[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Ut[14],n.cellDates?(p.t="d",p.w=Ks(p.z,ps(p.v))):(p.t="n",p.v=ps(p.v),p.w=Ks(p.z,p.v))):p.t="s";if(s)i[g]||(i[g]=[]),i[g][y]&&i[g][y].z&&(p.z=i[g][y].z),i[g][y]=p;else{var _=Mt({c:y,r:g});i[_]&&i[_].z&&(p.z=i[_].z),i[_]=p}}}return c.s.c<1e7&&(i["!ref"]=ar(c)),i}function qc(t,e){return fk(null,t,e)}function mZ(t){return t.read_shift(4,"i")}function es(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function gZ(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function xx(t,e){var r=t.l,n=t.read_shift(1),s=es(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(gZ(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var vZ=xx;function Ys(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function _l(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var yZ=es;function Ex(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var xZ=es,zv=Ex;function bx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?kh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Mo(e,0)>>2;return r?s/100:s}function hk(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Sl=hk;function qn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function EZ(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Yo[s];c&&(e.rgb=Nd(c));break;case 2:e.rgb=Nd([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function bZ(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function pk(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function _Z(t){return pk(t,1)}function SZ(t){return pk(t,2)}var _x=2,xs=3,e0=11,oS=12,Dh=19,t0=64,AZ=65,TZ=71,wZ=4108,CZ=4126,yn=80,mk=81,IZ=[yn,mk],kZ={1:{n:"CodePage",t:_x},2:{n:"Category",t:yn},3:{n:"PresentationFormat",t:yn},4:{n:"ByteCount",t:xs},5:{n:"LineCount",t:xs},6:{n:"ParagraphCount",t:xs},7:{n:"SlideCount",t:xs},8:{n:"NoteCount",t:xs},9:{n:"HiddenCount",t:xs},10:{n:"MultimediaClipCount",t:xs},11:{n:"ScaleCrop",t:e0},12:{n:"HeadingPairs",t:wZ},13:{n:"TitlesOfParts",t:CZ},14:{n:"Manager",t:yn},15:{n:"Company",t:yn},16:{n:"LinksUpToDate",t:e0},17:{n:"CharacterCount",t:xs},19:{n:"SharedDoc",t:e0},22:{n:"HyperlinksChanged",t:e0},23:{n:"AppVersion",t:xs,p:"version"},24:{n:"DigSig",t:AZ},26:{n:"ContentType",t:yn},27:{n:"ContentStatus",t:yn},28:{n:"Language",t:yn},29:{n:"Version",t:yn},255:{},2147483648:{n:"Locale",t:Dh},2147483651:{n:"Behavior",t:Dh},1919054434:{}},DZ={1:{n:"CodePage",t:_x},2:{n:"Title",t:yn},3:{n:"Subject",t:yn},4:{n:"Author",t:yn},5:{n:"Keywords",t:yn},6:{n:"Comments",t:yn},7:{n:"Template",t:yn},8:{n:"LastAuthor",t:yn},9:{n:"RevNumber",t:yn},10:{n:"EditTime",t:t0},11:{n:"LastPrinted",t:t0},12:{n:"CreatedDate",t:t0},13:{n:"ModifiedDate",t:t0},14:{n:"PageCount",t:xs},15:{n:"WordCount",t:xs},16:{n:"CharCount",t:xs},17:{n:"Thumbnail",t:TZ},18:{n:"Application",t:yn},19:{n:"DocSecurity",t:xs},255:{},2147483648:{n:"Locale",t:Dh},2147483651:{n:"Behavior",t:Dh},1919054434:{}},lS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},PZ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function RZ(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var FZ=RZ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Yo=On(FZ),Al={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},gk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},cS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function NZ(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OZ(t){var e=NZ();if(!t||!t.match)return e;var r={};if((t.match(ns)||[]).forEach(function(n){var s=It(n);switch(s[0].replace(jJ,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[cS[s.ContentType]]!==void 0&&e[cS[s.ContentType]].push(s.PartName);break}}),e.xmlns!==eZ.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Ql={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Kv(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ju(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ns)||[]).forEach(function(s){var i=It(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Tu(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var MZ="application/vnd.oasis.opendocument.spreadsheet";function LZ(t,e){for(var r=mx(t),n,s;n=Rd.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=It(n[0],!1),s.path=="/"&&s.type!==MZ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Zu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],BZ=function(){for(var t=new Array(Zu.length),e=0;e<Zu.length;++e){var r=Zu[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function vk(t){var e={};t=Ar(t);for(var r=0;r<Zu.length;++r){var n=Zu[r],s=t.match(BZ[r]);s!=null&&s.length>0&&(e[n[1]]=ir(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=bn(e[n[1]]))}return e}var UZ=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function yk(t,e,r,n){var s=[];if(typeof t=="string")s=Z_(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(u){return{v:u}}));var a=typeof e=="string"?Z_(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function $Z(t,e,r){var n={};return e||(e={}),t=Ar(t),UZ.forEach(function(s){var i=(t.match(Pd(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=ir(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&yk(n.HeadingPairs,n.TitlesOfParts,e,r),e}var VZ=/<[^>]+>[^<]*/g;function HZ(t,e){var r={},n="",s=t.match(VZ);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=It(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ir(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ir(u);break;case"bool":r[n]=Dr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=bn(u);break;case"cy":case"error":r[n]=ir(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var jZ={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},xg;function GZ(t,e,r){xg||(xg=fx(jZ)),e=xg[e]||e,t[e]=r}function Sx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function xk(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function Ek(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function bk(t,e,r){return e===31?Ek(t):xk(t,e,r)}function qv(t,e,r){return bk(t,e,r===!1?0:4)}function WZ(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return bk(t,e,0)}function zZ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(hs,""),t.l-s&2&&(t.l+=2)}return r}function KZ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(hs,"");return r}function qZ(t){var e=t.l,r=Ph(t,mk);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Ph(t,xs);return[r,n]}function XZ(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(qZ(t));return r}function uS(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(hs,"").replace(Au,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function _k(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function YZ(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Ph(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==oS&&n!==e&&IZ.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===oS?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return xk(t,n,4).replace(hs,"");case 31:return Ek(t);case 64:return Sx(t);case 65:return _k(t);case 71:return YZ(t);case 80:return qv(t,n,!i.raw).replace(hs,"");case 81:return WZ(t,n).replace(hs,"");case 4108:return XZ(t);case 4126:case 4127:return n==4127?zZ(t):KZ(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function dS(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var u=t.read_shift(4),f=t.read_shift(4);i[a]=[u,f+r]}i.sort(function(b,v){return b[1]-v[1]});var h={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var p=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(p=!1,t.l=i[a][1]),p)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var g=e[i[a][0]];if(h[g.n]=Ph(t,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:da(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(i[a][0]===1){if(o=h.CodePage=Ph(t,_x),da(o),l!==-1){var y=t.l;t.l=i[l][1],c=uS(t,o),t.l=y}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=uS(t,o)}else{var _=c[i[a][0]],x;switch(t[t.l]){case 65:t.l+=4,x=_k(t);break;case 30:t.l+=4,x=qv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,x=qv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,x=t.read_shift(4,"i");break;case 19:t.l+=4,x=t.read_shift(4);break;case 5:t.l+=4,x=t.read_shift(8,"f");break;case 11:t.l+=4,x=zr(t,4);break;case 64:t.l+=4,x=bn(Sx(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[_]=x}}return t.l=r+n,h}function fS(t,e,r){var n=t.content;if(!n)return{};kn(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==nr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=dS(n,e),h={SystemIdentifier:c};for(var p in f)h[p]=f[p];if(h.FMTID=i,s===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=dS(n,null)}catch{}for(p in g)h[p]=g[p];return h.FMTID=[i,a],h}function Ui(t,e){return t.read_shift(e),null}function QZ(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function zr(t,e){return t.read_shift(e)===1}function nn(t){return t.read_shift(2,"u")}function Sk(t,e){return QZ(t,e,nn)}function JZ(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function df(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function ZZ(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ul(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function ff(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):ul(t,n,r)}function Tl(t,e,r){if(r.biff>5)return ff(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function eee(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function tee(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(hs,"");return n&&(t.l+=24),s}function ree(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(hs,"");return r+a}function nee(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return tee(t);case"0303000000000000c000000000000046":return ree(t);default:throw new Error("Unsupported Moniker "+r)}}function r0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(hs,""):"";return r}function see(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",u,f;s&16&&(i=r0(t,r-t.l)),s&128&&(a=r0(t,r-t.l)),(s&257)===257&&(o=r0(t,r-t.l)),(s&257)===1&&(l=nee(t,r-t.l)),s&8&&(c=r0(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(f=Sx(t)),t.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),f&&(p.time=f),i&&(p.Tooltip=i),p}function Ak(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function Tk(t,e){var r=Ak(t);return r[3]=0,r}function Wa(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function aee(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function iee(t,e,r){return e===0?"":Tl(t,e,r)}function oee(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function wk(t){var e=t.read_shift(2),r=bx(t);return[e,r]}function lee(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=df(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Hp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function Ck(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var cee=Ck;function Ik(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function uee(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function dee(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Vn(t){t.l+=2,t.l+=t.read_shift(2)}var fee={0:Vn,4:Vn,5:Vn,6:Vn,7:dee,8:Vn,9:Vn,10:Vn,11:Vn,12:Vn,13:uee,14:Vn,15:Vn,16:Vn,17:Vn,18:Vn,19:Vn,20:Vn,21:Ik};function hee(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(fee[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function n0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function pee(t,e){return e===0||t.read_shift(2),1200}function mee(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Tl(t,0,r);return t.read_shift(e+n-t.l),s}function gee(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function vee(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=df(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function yee(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(ZZ(t));return i.Count=n,i.Unique=s,i}function xee(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function Eee(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function bee(t){var e=aee(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function _ee(t){return t.read_shift(2),t.read_shift(4)}function hS(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function See(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function Aee(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function Tee(){}function wee(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=df(t,0,r),n}function Cee(t){var e=Wa(t);return e.isst=t.read_shift(4),e}function Iee(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Wa(t);r.biff==2&&t.l++;var i=ff(t,n-t.l,r);return s.val=i,s}function kee(t,e,r){var n=t.read_shift(2),s=Tl(t,0,r);return[n,s]}var Dee=Tl;function pS(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function Pee(t){var e=t.read_shift(2),r=t.read_shift(2),n=wk(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function Ree(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(wk(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function Fee(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function Nee(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=PZ[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function Oee(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=Nee(t,e,n.fStyle,r),n}function Mee(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function mS(t,e,r){var n=Wa(t);(r.biff==2||e==9)&&++t.l;var s=JZ(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Lee(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Wa(t),s=qn(t);return n.val=s,n}var gS=iee;function Bee(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=ul(t,i),o=[];n>t.l;)o.push(ff(t));return[i,s,a,o]}function vS(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=lee(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var Uee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yS(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=ul(t,a,r);s&32&&(c=Uee[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var f=n==t.l||o===0||!(u>0)?[]:Ese(t,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function kk(t,e,r){if(r.biff<8)return $ee(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(oee(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function $ee(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=df(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Vee(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=ul(t,n,r),a=ul(t,s,r);return[i,a]}function Hee(t,e,r){var n=Ck(t);t.l++;var s=t.read_shift(1);return e-=8,[bse(t,e,r),s,n]}function xS(t,e,r){var n=cee(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,yse(t,e,r)]}function jee(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Gee(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=Tl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function Wee(t,e,r){return Gee(t,e,r)}function zee(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Hp(t));return r}function Kee(t,e,r){if(r&&r.biff<8)return Xee(t,e,r);var n=Ik(t),s=hee(t,e-22,n[1]);return{cmo:n,ft:s}}var qee={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function Xee(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((qee[n]||rs)(t,e,r)),{cmo:[s,n,i],ft:a}}function Yee(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=eee(t,6,r);var o=t.read_shift(2);t.read_shift(2),nn(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],f=ul(t,t.lens[c+1]-t.lens[c]-1);if(s+=f,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function Qee(t,e){var r=Hp(t);t.l+=16;var n=see(t,e-24);return[r,n]}function Jee(t,e){t.read_shift(2);var r=Hp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(hs,""),[r,n]}function Zee(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=lS[r]||r,r=t.read_shift(2),e[1]=lS[r]||r,e}function ete(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Tk(t));return r}function tte(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Tk(t));return r}function rte(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Dk(t,e,r){if(!r.cellStyles)return rs(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function nte(t,e){var r={};return e<32||(t.l+=16,r.header=qn(t),r.footer=qn(t),t.l+=2),r}function ste(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var ate=Wa,ite=Sk,ote=ff;function lte(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function cte(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Wa(t);++t.l;var s=Tl(t,e-7,r);return n.t="str",n.val=s,n}function ute(t){var e=Wa(t);++t.l;var r=qn(t);return e.t="n",e.val=r,e}function dte(t){var e=Wa(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function fte(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function hte(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function pte(t,e,r){var n=t.l+e,s=Wa(t),i=t.read_shift(2),a=ul(t,i,r);return t.l=n,s.t="str",s.val=a,s}var mte=[2,3,48,49,131,139,140,245],ES=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=fx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=go(1);switch(l.type){case"base64":u=ca(Ms(o));break;case"binary":u=ca(o);break;case"buffer":case"array":u=o;break}kn(u,0);var f=u.read_shift(1),h=!!(f&136),p=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var y=0,_=521;f==2&&(y=u.read_shift(2)),u.l+=3,f!=2&&(y=u.read_shift(4)),y>1048576&&(y=1e6),f!=2&&(_=u.read_shift(2));var x=u.read_shift(2),b=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=t[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var v=[],T={},D=Math.min(u.length,f==2?521:_-10-(p?264:0)),k=g?32:11;u.l<D&&u[u.l]!=13;)switch(T={},T.name=kd.utils.decode(b,u.slice(u.l,u.l+k)).replace(/[\u0000\r\n].*$/g,""),u.l+=k,T.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(T.offset=u.read_shift(4)),T.len=u.read_shift(1),f==2&&(T.offset=u.read_shift(2)),T.dec=u.read_shift(1),T.name.length&&v.push(T),f!=2&&(u.l+=g?13:14),T.type){case"B":(!p||T.len!=8)&&l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var S=0,E=0;for(c[0]=[],E=0;E!=v.length;++E)c[0][E]=v[E].name;for(;y-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++S]=[],E=0,E=0;E!=v.length;++E){var m=u.slice(u.l,u.l+v[E].len);u.l+=v[E].len,kn(m,0);var A=kd.utils.decode(b,m);switch(v[E].type){case"C":A.trim().length&&(c[S][E]=A.replace(/\s+$/,""));break;case"D":A.length===8?c[S][E]=new Date(+A.slice(0,4),+A.slice(4,6)-1,+A.slice(6,8)):c[S][E]=A;break;case"F":c[S][E]=parseFloat(A.trim());break;case"+":case"I":c[S][E]=g?m.read_shift(-4,"i")^2147483648:m.read_shift(4,"i");break;case"L":switch(A.trim().toUpperCase()){case"Y":case"T":c[S][E]=!0;break;case"N":case"F":c[S][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+A+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[S][E]="##MEMO##"+(g?parseInt(A.trim(),10):m.read_shift(4));break;case"N":A=A.replace(/\u0000/g,"").trim(),A&&A!="."&&(c[S][E]=+A||0);break;case"@":c[S][E]=new Date(m.read_shift(-8,"f")-621356832e5);break;case"T":c[S][E]=new Date((m.read_shift(4)-2440588)*864e5+m.read_shift(4));break;case"Y":c[S][E]=m.read_shift(4,"i")/1e4+m.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][E]=-m.read_shift(-8,"f");break;case"B":if(p&&v[E].len==8){c[S][E]=m.read_shift(8,"f");break}case"G":case"P":m.l+=v[E].len;break;case"0":if(v[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[E].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=v,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=qc(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function s(o,l){try{return _o(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&da(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Wv(),f=e1(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),g=o["!cols"]||[],y=0,_=0,x=0,b=1;for(y=0;y<h.length;++y){if(((g[y]||{}).DBF||{}).name){h[y]=g[y].DBF.name,++x;continue}if(h[y]!=null){if(++x,typeof h[y]=="number"&&(h[y]=h[y].toString(10)),typeof h[y]!="string")throw new Error("DBF Invalid column name "+h[y]+" |"+typeof h[y]+"|");if(h.indexOf(h[y])!==y){for(_=0;_<1024;++_)if(h.indexOf(h[y]+"_"+_)==-1){h[y]+="_"+_;break}}}}var v=Gr(o["!ref"]),T=[],D=[],k=[];for(y=0;y<=v.e.c-v.s.c;++y){var S="",E="",m=0,A=[];for(_=0;_<p.length;++_)p[_][y]!=null&&A.push(p[_][y]);if(A.length==0||h[y]==null){T[y]="?";continue}for(_=0;_<A.length;++_){switch(typeof A[_]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=A[_]instanceof Date?"D":"C";break;default:E="C"}m=Math.max(m,String(A[_]).length),S=S&&S!=E?"C":E}m>250&&(m=250),E=((g[y]||{}).DBF||{}).type,E=="C"&&g[y].DBF.len>m&&(m=g[y].DBF.len),S=="B"&&E=="N"&&(S="N",k[y]=g[y].DBF.dec,m=g[y].DBF.len),D[y]=S=="C"||E=="N"?m:i[S]||0,b+=D[y],T[y]=S}var I=u.next(32);for(I.write_shift(4,318902576),I.write_shift(4,p.length),I.write_shift(2,296+32*x),I.write_shift(2,b),y=0;y<4;++y)I.write_shift(4,0);for(I.write_shift(4,0|(+e[k4]||3)<<8),y=0,_=0;y<h.length;++y)if(h[y]!=null){var C=u.next(32),F=(h[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,F,"sbcs"),C.write_shift(1,T[y]=="?"?"C":T[y],"sbcs"),C.write_shift(4,_),C.write_shift(1,D[y]||i[T[y]]||0),C.write_shift(1,k[y]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),_+=D[y]||i[T[y]]||0}var W=u.next(264);for(W.write_shift(4,13),y=0;y<65;++y)W.write_shift(4,0);for(y=0;y<p.length;++y){var P=u.next(b);for(P.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(T[_]){case"L":P.write_shift(1,p[y][_]==null?63:p[y][_]?84:70);break;case"B":P.write_shift(8,p[y][_]||0,"f");break;case"N":var R="0";for(typeof p[y][_]=="number"&&(R=p[y][_].toFixed(k[_]||0)),x=0;x<D[_]-R.length;++x)P.write_shift(1,32);P.write_shift(1,R,"sbcs");break;case"D":p[y][_]?(P.write_shift(4,("0000"+p[y][_].getFullYear()).slice(-4),"sbcs"),P.write_shift(2,("00"+(p[y][_].getMonth()+1)).slice(-2),"sbcs"),P.write_shift(2,("00"+p[y][_].getDate()).slice(-2),"sbcs")):P.write_shift(8,"00000000","sbcs");break;case"C":var N=String(p[y][_]!=null?p[y][_]:"").slice(0,D[_]);for(P.write_shift(1,N,"sbcs"),x=0;x<D[_]-N.length;++x)P.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),gte=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Va(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var g=t[p];return typeof g=="number"?M_(g):g},n=function(h,p,g){var y=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return y==59?h:M_(y)};t["|"]=254;function s(h,p){switch(p.type){case"base64":return i(Ms(h),p);case"binary":return i(h,p);case"buffer":return i(Zt&&Buffer.isBuffer(h)?h.toString("binary"):bl(h),p);case"array":return i(cl(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var g=h.split(/[\n\r]+/),y=-1,_=-1,x=0,b=0,v=[],T=[],D=null,k={},S=[],E=[],m=[],A=0,I;for(+p.codepage>=0&&da(+p.codepage);x!==g.length;++x){A=0;var C=g[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=C.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),W=F[0],P;if(C.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&T.push(C.slice(3).replace(/;;/g,";"));break;case"C":var R=!1,N=!1,L=!1,O=!1,V=-1,z=-1;for(b=1;b<F.length;++b)switch(F[b].charAt(0)){case"A":break;case"X":_=parseInt(F[b].slice(1))-1,N=!0;break;case"Y":for(y=parseInt(F[b].slice(1))-1,N||(_=0),I=v.length;I<=y;++I)v[I]=[];break;case"K":P=F[b].slice(1),P.charAt(0)==='"'?P=P.slice(1,P.length-1):P==="TRUE"?P=!0:P==="FALSE"?P=!1:isNaN(ma(P))?isNaN(Fc(P).getDate())||(P=bn(P)):(P=ma(P),D!==null&&zc(D)&&(P=Vp(P))),R=!0;break;case"E":O=!0;var U=gc(F[b].slice(1),{r:y,c:_});v[y][_]=[v[y][_],U];break;case"S":L=!0,v[y][_]=[v[y][_],"S5S"];break;case"G":break;case"R":V=parseInt(F[b].slice(1))-1;break;case"C":z=parseInt(F[b].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}if(R&&(v[y][_]&&v[y][_].length==2?v[y][_][0]=P:v[y][_]=P,D=null),L){if(O)throw new Error("SYLK shared formula cannot have own formula");var G=V>-1&&v[V][z];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");v[y][_][1]=$k(G[1],{r:y-V,c:_-z})}break;case"F":var j=0;for(b=1;b<F.length;++b)switch(F[b].charAt(0)){case"X":_=parseInt(F[b].slice(1))-1,++j;break;case"Y":for(y=parseInt(F[b].slice(1))-1,I=v.length;I<=y;++I)v[I]=[];break;case"M":A=parseInt(F[b].slice(1))/20;break;case"F":break;case"G":break;case"P":D=T[parseInt(F[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(m=F[b].slice(1).split(" "),I=parseInt(m[0],10);I<=parseInt(m[1],10);++I)A=parseInt(m[2],10),E[I-1]=A===0?{hidden:!0}:{wch:A},Nc(E[I-1]);break;case"C":_=parseInt(F[b].slice(1))-1,E[_]||(E[_]={});break;case"R":y=parseInt(F[b].slice(1))-1,S[y]||(S[y]={}),A>0?(S[y].hpt=A,S[y].hpx=Od(A)):A===0&&(S[y].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}j<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}}return S.length>0&&(k["!rows"]=S),E.length>0&&(k["!cols"]=E),p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),[v,k]}function a(h,p){var g=s(h,p),y=g[0],_=g[1],x=qc(y,p);return Va(_).forEach(function(b){x[b]=_[b]}),x}function o(h,p){return _o(a(h,p),p)}function l(h,p,g,y){var _="C;Y"+(g+1)+";X"+(y+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+rne(h.f,{r:g,c:y}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,p){p.forEach(function(g,y){var _="F;W"+(y+1)+" "+(y+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Fh(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Nh(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function u(h,p){p.forEach(function(g,y){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*Lk(g.hpx)+";"),_.length>2&&h.push(_+"R"+(y+1))})}function f(h,p){var g=["ID;PWXL;N;E"],y=[],_=Gr(h["!ref"]),x,b=Array.isArray(h),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&u(g,h["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var T=_.s.r;T<=_.e.r;++T)for(var D=_.s.c;D<=_.e.c;++D){var k=Mt({r:T,c:D});x=b?(h[T]||[])[D]:h[k],!(!x||x.v==null&&(!x.f||x.F))&&y.push(l(x,h,T,D))}return g.join(v)+v+y.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),vte=function(){function t(i,a){switch(a.type){case"base64":return e(Ms(i),a);case"binary":return e(i,a);case"buffer":return e(Zt&&Buffer.isBuffer(i)?i.toString("binary"):bl(i),a);case"array":return e(cl(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),p=h[0],g=h[1];++u;for(var y=o[u]||"";(y.match(/["]/g)||[]).length&1&&u<o.length-1;)y+=`
`+o[++u];switch(y=y.trim(),+p){case-1:if(y==="BOT"){f[++l]=[],c=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?f[l][c]=!0:y==="FALSE"?f[l][c]=!1:isNaN(ma(g))?isNaN(Fc(g).getDate())?f[l][c]=g:f[l][c]=bn(g):f[l][c]=ma(g),++c;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),f[l][c++]=y!==""?y:null;break}if(y==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(i,a){return qc(t(i,a),a)}function n(i,a){return _o(r(i,a),a)}var s=function(){var i=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Gr(l["!ref"]),f,h=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var y=Mt({r:p,c:g});if(f=h?(l[p]||[])[g]:l[y],!f){a(c,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,_,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ks(f.z||Ut[14],ps(bn(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var x=`\r
`,b=c.join(x);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),yte=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),g=-1,y=-1,_=0,x=[];_!==p.length;++_){var b=p[_].trim().split(":");if(b[0]==="cell"){var v=ds(b[1]);if(x.length<=v.r)for(g=x.length;g<=v.r;++g)x[g]||(x[g]=[]);switch(g=v.r,y=v.c,b[2]){case"t":x[g][y]=t(b[3]);break;case"v":x[g][y]=+b[3];break;case"vtf":var T=b[b.length-1];case"vtc":switch(b[3]){case"nl":x[g][y]=!!+b[4];break;default:x[g][y]=+b[4];break}b[2]=="vtf"&&(x[g][y]=[x[g][y],T])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(f,h){return qc(r(f,h),h)}function s(f,h){return _o(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],g,y="",_=Kc(f["!ref"]),x=Array.isArray(f),b=_.s.r;b<=_.e.r;++b)for(var v=_.s.c;v<=_.e.c;++v)if(y=Mt({r:b,c:v}),g=x?(f[b]||[])[v]:f[y],!(!g||g.v==null||g.t==="z")){switch(p=["cell",y,"t"],g.t){case"s":case"str":p.push(e(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=e(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var T=ps(bn(g.v));p[2]="vtc",p[3]="nd",p[4]=""+T,p[5]=g.w||Ks(g.z||Ut[14],T);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,a,o,a,c(f),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),Fd=function(){function t(u,f,h,p,g){g.raw?f[h][p]=u:u===""||(u==="TRUE"?f[h][p]=!0:u==="FALSE"?f[h][p]=!1:isNaN(ma(u))?isNaN(Fc(u).getDate())?f[h][p]=u:f[h][p]=bn(u):f[h][p]=ma(u))}function e(u,f){var h=f||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),y=g.length-1;y>=0&&g[y].length===0;)--y;for(var _=10,x=0,b=0;b<=y;++b)x=g[b].indexOf(" "),x==-1?x=g[b].length:x++,_=Math.max(_,x);for(b=0;b<=y;++b){p[b]=[];var v=0;for(t(g[b].slice(0,_).trim(),p,b,v,h),v=1;v<=(g[b].length-_)/10+1;++v)t(g[b].slice(_+(v-1)*10,_+v*10).trim(),p,b,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p]);if(!g.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p])}return g.sort(function(y,_){return y[0]-_[0]||n[y[1]]-n[_[1]]}),r[g.pop()[1]]||44}function i(u,f){var h=f||{},p="",g=h.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):h&&h.FS?p=h.FS:p=s(u.slice(0,1024));var _=0,x=0,b=0,v=0,T=0,D=p.charCodeAt(0),k=!1,S=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var m=h.dateNF!=null?kJ(h.dateNF):null;function A(){var I=u.slice(v,T),C={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)C.t="z";else if(h.raw)C.t="s",C.v=I;else if(I.trim().length===0)C.t="s",C.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(C.t="s",C.v=I.slice(2,-1).replace(/""/g,'"')):sne(I)?(C.t="n",C.f=I.slice(1)):(C.t="s",C.v=I);else if(I=="TRUE")C.t="b",C.v=!0;else if(I=="FALSE")C.t="b",C.v=!1;else if(!isNaN(b=ma(I)))C.t="n",h.cellText!==!1&&(C.w=I),C.v=b;else if(!isNaN(Fc(I).getDate())||m&&I.match(m)){C.z=h.dateNF||Ut[14];var F=0;m&&I.match(m)&&(I=DJ(I,h.dateNF,I.match(m)||[]),F=1),h.cellDates?(C.t="d",C.v=bn(I,F)):(C.t="n",C.v=ps(bn(I,F))),h.cellText!==!1&&(C.w=Ks(C.z,C.v instanceof Date?ps(C.v):C.v)),h.cellNF||delete C.z}else C.t="s",C.v=I;if(C.t=="z"||(h.dense?(g[_]||(g[_]=[]),g[_][x]=C):g[Mt({c:x,r:_})]=C),v=T+1,E=u.charCodeAt(v),y.e.c<x&&(y.e.c=x),y.e.r<_&&(y.e.r=_),S==D)++x;else if(x=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;T<u.length;++T)switch(S=u.charCodeAt(T)){case 34:E===34&&(k=!k);break;case D:case 10:case 13:if(!k&&A())break e;break}return T-v>0&&A(),g["!ref"]=ar(y),g}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):qc(e(u,f),f)}function o(u,f){var h="",p=f.type=="string"?[0,0,0,0]:Px(u,f);switch(f.type){case"base64":h=Ms(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof kd<"u"||(h=Zt&&Buffer.isBuffer(u)?u.toString("binary"):bl(u));break;case"array":h=cl(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Ar(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Ar(h):f.type=="binary"&&typeof kd<"u",h.slice(0,19)=="socialcalc:version:"?yte.to_sheet(f.type=="string"?h:Ar(h),f):a(h,f)}function l(u,f){return _o(o(u,f),f)}function c(u){for(var f=[],h=Gr(u["!ref"]),p,g=Array.isArray(u),y=h.s.r;y<=h.e.r;++y){for(var _=[],x=h.s.c;x<=h.e.c;++x){var b=Mt({r:y,c:x});if(p=g?(u[y]||[])[x]:u[b],!p||p.v==null){_.push("          ");continue}for(var v=(p.w||(Ci(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";_.push(v+(x===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function xte(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=gte.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Fd.to_workbook(t,e)}}var ed=function(){function t(U,G,j){if(U){kn(U,U.l||0);for(var ee=j.Enum||V;U.l<U.length;){var ae=U.read_shift(2),ne=ee[ae]||ee[65535],le=U.read_shift(2),Z=U.l+le,J=ne.f&&ne.f(U,le,j);if(U.l=Z,G(J,ne,ae))return}}}function e(U,G){switch(G.type){case"base64":return r(ca(Ms(U)),G);case"binary":return r(ca(U),G);case"buffer":case"array":return r(U,G)}throw"Unsupported type "+G.type}function r(U,G){if(!U)return U;var j=G||{},ee=j.dense?[]:{},ae="Sheet1",ne="",le=0,Z={},J=[],ge=[],te={s:{r:0,c:0},e:{r:0,c:0}},K=j.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)j.Enum=V,t(U,function(ie,ue,Ee){switch(Ee){case 0:j.vers=ie,ie>=4096&&(j.qpro=!0);break;case 6:te=ie;break;case 204:ie&&(ne=ie);break;case 222:ne=ie;break;case 15:case 51:j.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:Ee==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=j.dateNF||Ut[14],j.cellDates&&(ie[1].t="d",ie[1].v=Vp(ie[1].v))),j.qpro&&ie[3]>le&&(ee["!ref"]=ar(te),Z[ae]=ee,J.push(ae),ee=j.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},le=ie[3],ae=ne||"Sheet"+(le+1),ne="");var Ce=j.dense?(ee[ie[0].r]||[])[ie[0].c]:ee[Mt(ie[0])];if(Ce){Ce.t=ie[1].t,Ce.v=ie[1].v,ie[1].z!=null&&(Ce.z=ie[1].z),ie[1].f!=null&&(Ce.f=ie[1].f);break}j.dense?(ee[ie[0].r]||(ee[ie[0].r]=[]),ee[ie[0].r][ie[0].c]=ie[1]):ee[Mt(ie[0])]=ie[1];break}},j);else if(U[2]==26||U[2]==14)j.Enum=z,U[2]==14&&(j.qpro=!0,U.l=0),t(U,function(ie,ue,Ee){switch(Ee){case 204:ae=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>le&&(ee["!ref"]=ar(te),Z[ae]=ee,J.push(ae),ee=j.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},le=ie[3],ae="Sheet"+(le+1)),K>0&&ie[0].r>=K)break;j.dense?(ee[ie[0].r]||(ee[ie[0].r]=[]),ee[ie[0].r][ie[0].c]=ie[1]):ee[Mt(ie[0])]=ie[1],te.e.c<ie[0].c&&(te.e.c=ie[0].c),te.e.r<ie[0].r&&(te.e.r=ie[0].r);break;case 27:ie[14e3]&&(ge[ie[14e3][0]]=ie[14e3][1]);break;case 1537:ge[ie[0]]=ie[1],ie[0]==le&&(ae=ie[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(ee["!ref"]=ar(te),Z[ne||ae]=ee,J.push(ne||ae),!ge.length)return{SheetNames:J,Sheets:Z};for(var Y={},fe=[],ye=0;ye<ge.length;++ye)Z[J[ye]]?(fe.push(ge[ye]||J[ye]),Y[ge[ye]]=Z[ge[ye]]||Z[J[ye]]):(fe.push(ge[ye]),Y[ge[ye]]={"!ref":"A1"});return{SheetNames:fe,Sheets:Y}}function n(U,G){var j=G||{};if(+j.codepage>=0&&da(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=Wv(),ae=Gr(U["!ref"]),ne=Array.isArray(U),le=[];ra(ee,0,i(1030)),ra(ee,6,l(ae));for(var Z=Math.min(ae.e.r,8191),J=ae.s.r;J<=Z;++J)for(var ge=Mn(J),te=ae.s.c;te<=ae.e.c;++te){J===ae.s.r&&(le[te]=hn(te));var K=le[te]+ge,Y=ne?(U[J]||[])[te]:U[K];if(!(!Y||Y.t=="z"))if(Y.t=="n")(Y.v|0)==Y.v&&Y.v>=-32768&&Y.v<=32767?ra(ee,13,p(J,te,Y.v)):ra(ee,14,y(J,te,Y.v));else{var fe=Ci(Y);ra(ee,15,f(J,te,fe.slice(0,239)))}}return ra(ee,1),ee.end()}function s(U,G){var j=G||{};if(+j.codepage>=0&&da(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=Wv();ra(ee,0,a(U));for(var ae=0,ne=0;ae<U.SheetNames.length;++ae)(U.Sheets[U.SheetNames[ae]]||{})["!ref"]&&ra(ee,27,O(U.SheetNames[ae],ne++));var le=0;for(ae=0;ae<U.SheetNames.length;++ae){var Z=U.Sheets[U.SheetNames[ae]];if(!(!Z||!Z["!ref"])){for(var J=Gr(Z["!ref"]),ge=Array.isArray(Z),te=[],K=Math.min(J.e.r,8191),Y=J.s.r;Y<=K;++Y)for(var fe=Mn(Y),ye=J.s.c;ye<=J.e.c;++ye){Y===J.s.r&&(te[ye]=hn(ye));var ie=te[ye]+fe,ue=ge?(Z[Y]||[])[ye]:Z[ie];if(!(!ue||ue.t=="z"))if(ue.t=="n")ra(ee,23,A(Y,ye,le,ue.v));else{var Ee=Ci(ue);ra(ee,22,S(Y,ye,le,Ee.slice(0,239)))}}++le}}return ra(ee,1),ee.end()}function i(U){var G=un(2);return G.write_shift(2,U),G}function a(U){var G=un(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var j=0,ee=0,ae=0,ne=0;ne<U.SheetNames.length;++ne){var le=U.SheetNames[ne],Z=U.Sheets[le];if(!(!Z||!Z["!ref"])){++ae;var J=Kc(Z["!ref"]);j<J.e.r&&(j=J.e.r),ee<J.e.c&&(ee=J.e.c)}}return j>8191&&(j=8191),G.write_shift(2,j),G.write_shift(1,ae),G.write_shift(1,ee),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(U,G,j){var ee={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&j.qpro?(ee.s.c=U.read_shift(1),U.l++,ee.s.r=U.read_shift(2),ee.e.c=U.read_shift(1),U.l++,ee.e.r=U.read_shift(2),ee):(ee.s.c=U.read_shift(2),ee.s.r=U.read_shift(2),G==12&&j.qpro&&(U.l+=2),ee.e.c=U.read_shift(2),ee.e.r=U.read_shift(2),G==12&&j.qpro&&(U.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function l(U){var G=un(8);return G.write_shift(2,U.s.c),G.write_shift(2,U.s.r),G.write_shift(2,U.e.c),G.write_shift(2,U.e.r),G}function c(U,G,j){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(ee[0].c=U.read_shift(1),ee[3]=U.read_shift(1),ee[0].r=U.read_shift(2),U.l+=2):(ee[2]=U.read_shift(1),ee[0].c=U.read_shift(2),ee[0].r=U.read_shift(2)),ee}function u(U,G,j){var ee=U.l+G,ae=c(U,G,j);if(ae[1].t="s",j.vers==20768){U.l++;var ne=U.read_shift(1);return ae[1].v=U.read_shift(ne,"utf8"),ae}return j.qpro&&U.l++,ae[1].v=U.read_shift(ee-U.l,"cstr"),ae}function f(U,G,j){var ee=un(7+j.length);ee.write_shift(1,255),ee.write_shift(2,G),ee.write_shift(2,U),ee.write_shift(1,39);for(var ae=0;ae<ee.length;++ae){var ne=j.charCodeAt(ae);ee.write_shift(1,ne>=128?95:ne)}return ee.write_shift(1,0),ee}function h(U,G,j){var ee=c(U,G,j);return ee[1].v=U.read_shift(2,"i"),ee}function p(U,G,j){var ee=un(7);return ee.write_shift(1,255),ee.write_shift(2,G),ee.write_shift(2,U),ee.write_shift(2,j,"i"),ee}function g(U,G,j){var ee=c(U,G,j);return ee[1].v=U.read_shift(8,"f"),ee}function y(U,G,j){var ee=un(13);return ee.write_shift(1,255),ee.write_shift(2,G),ee.write_shift(2,U),ee.write_shift(8,j,"f"),ee}function _(U,G,j){var ee=U.l+G,ae=c(U,G,j);if(ae[1].v=U.read_shift(8,"f"),j.qpro)U.l=ee;else{var ne=U.read_shift(2);T(U.slice(U.l,U.l+ne),ae),U.l+=ne}return ae}function x(U,G,j){var ee=G&32768;return G&=-32769,G=(ee?U:0)+(G>=8192?G-16384:G),(ee?"":"$")+(j?hn(G):Mn(G))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(U,G){kn(U,0);for(var j=[],ee=0,ae="",ne="",le="",Z="";U.l<U.length;){var J=U[U.l++];switch(J){case 0:j.push(U.read_shift(8,"f"));break;case 1:ne=x(G[0].c,U.read_shift(2),!0),ae=x(G[0].r,U.read_shift(2),!1),j.push(ne+ae);break;case 2:{var ge=x(G[0].c,U.read_shift(2),!0),te=x(G[0].r,U.read_shift(2),!1);ne=x(G[0].c,U.read_shift(2),!0),ae=x(G[0].r,U.read_shift(2),!1),j.push(ge+te+":"+ne+ae)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(U.read_shift(2));break;case 6:{for(var K="";J=U[U.l++];)K+=String.fromCharCode(J);j.push('"'+K.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:Z=j.pop(),le=j.pop(),j.push(["AND","OR"][J-20]+"("+le+","+Z+")");break;default:if(J<32&&v[J])Z=j.pop(),le=j.pop(),j.push(le+v[J]+Z);else if(b[J]){if(ee=b[J][1],ee==69&&(ee=U[U.l++]),ee>j.length){console.error("WK1 bad formula parse 0x"+J.toString(16)+":|"+j.join("|")+"|");return}var Y=j.slice(-ee);j.length-=ee,j.push(b[J][0]+"("+Y.join(",")+")")}else return J<=7?console.error("WK1 invalid opcode "+J.toString(16)):J<=24?console.error("WK1 unsupported op "+J.toString(16)):J<=30?console.error("WK1 invalid opcode "+J.toString(16)):J<=115?console.error("WK1 unsupported function opcode "+J.toString(16)):console.error("WK1 unrecognized opcode "+J.toString(16))}}j.length==1?G[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function D(U){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=U.read_shift(2),G[3]=U[U.l++],G[0].c=U[U.l++],G}function k(U,G){var j=D(U);return j[1].t="s",j[1].v=U.read_shift(G-4,"cstr"),j}function S(U,G,j,ee){var ae=un(6+ee.length);ae.write_shift(2,U),ae.write_shift(1,j),ae.write_shift(1,G),ae.write_shift(1,39);for(var ne=0;ne<ee.length;++ne){var le=ee.charCodeAt(ne);ae.write_shift(1,le>=128?95:le)}return ae.write_shift(1,0),ae}function E(U,G){var j=D(U);j[1].v=U.read_shift(2);var ee=j[1].v>>1;if(j[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return j[1].v=ee,j}function m(U,G){var j=D(U),ee=U.read_shift(4),ae=U.read_shift(4),ne=U.read_shift(2);if(ne==65535)return ee===0&&ae===3221225472?(j[1].t="e",j[1].v=15):ee===0&&ae===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var le=ne&32768;return ne=(ne&32767)-16446,j[1].v=(1-le*2)*(ae*Math.pow(2,ne+32)+ee*Math.pow(2,ne)),j}function A(U,G,j,ee){var ae=un(14);if(ae.write_shift(2,U),ae.write_shift(1,j),ae.write_shift(1,G),ee==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var ne=0,le=0,Z=0,J=0;return ee<0&&(ne=1,ee=-ee),le=Math.log2(ee)|0,ee/=Math.pow(2,le-31),J=ee>>>0,J&2147483648||(ee/=2,++le,J=ee>>>0),ee-=J,J|=2147483648,J>>>=0,ee*=Math.pow(2,32),Z=ee>>>0,ae.write_shift(4,Z),ae.write_shift(4,J),le+=16383+(ne?32768:0),ae.write_shift(2,le),ae}function I(U,G){var j=m(U);return U.l+=G-14,j}function C(U,G){var j=D(U),ee=U.read_shift(4);return j[1].v=ee>>6,j}function F(U,G){var j=D(U),ee=U.read_shift(8,"f");return j[1].v=ee,j}function W(U,G){var j=F(U);return U.l+=G-10,j}function P(U,G){return U[U.l+G-1]==0?U.read_shift(G,"cstr"):""}function R(U,G){var j=U[U.l++];j>G-1&&(j=G-1);for(var ee="";ee.length<j;)ee+=String.fromCharCode(U[U.l++]);return ee}function N(U,G,j){if(!(!j.qpro||G<21)){var ee=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ae=U.read_shift(G-21,"cstr");return[ee,ae]}}function L(U,G){for(var j={},ee=U.l+G;U.l<ee;){var ae=U.read_shift(2);if(ae==14e3){for(j[ae]=[0,""],j[ae][0]=U.read_shift(2);U[U.l];)j[ae][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return j}function O(U,G){var j=un(5+U.length);j.write_shift(2,14e3),j.write_shift(2,G);for(var ee=0;ee<U.length;++ee){var ae=U.charCodeAt(ee);j[j.l++]=ae>127?95:ae}return j[j.l++]=0,j}var V={0:{n:"BOF",f:nn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:P},222:{n:"SHEETNAMELP",f:R},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:m},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:L},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:P},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:N},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function Ete(t){var e={},r=t.match(ns),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=It(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=ox[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var bte=function(){var t=Pd("t"),e=Pd("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:ir(a[1])},l=i.match(e);return l&&(o.s=Ete(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),_te=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),Ste=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ate=/<(?:\w+:)?r>/,Tte=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ax(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ir(Ar(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ar(t),r&&(n.h=px(n.t))):t.match(Ate)&&(n.r=Ar(t),n.t=ir(Ar((t.replace(Tte,"").match(Ste)||[]).join("").replace(ns,""))),r&&(n.h=_te(bte(n.r)))),n):{t:""}}var wte=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Cte=/<(?:\w+:)?(?:si|sstItem)>/g,Ite=/<\/(?:\w+:)?(?:si|sstItem)>/;function kte(t,e){var r=[],n="";if(!t)return r;var s=t.match(wte);if(s){n=s[2].replace(Cte,"").split(Ite);for(var i=0;i!=n.length;++i){var a=Ax(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=It(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Dte(t){return[t.read_shift(4),t.read_shift(4)]}function Pte(t,e){var r=[],n=!1;return Pi(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Pk(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function mi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Rte(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=mi(t,4),e.U=mi(t,4),e.W=mi(t,4),e}function Fte(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Nte(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Fte(t));return e}function Ote(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Mte(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=mi(t,4),e.U=mi(t,4),e.W=mi(t,4),e}function Lte(t){var e=Mte(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Rk(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Fk(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Bte(t){var e=mi(t);switch(e.Minor){case 2:return[e.Minor,Ute(t)];case 3:return[e.Minor,$te()];case 4:return[e.Minor,Vte(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Ute(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Rk(t,r),s=Fk(t,t.length-t.l);return{t:"Std",h:n,v:s}}function $te(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Vte(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ns,function(i){var a=It(i);switch(Ga(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function Hte(t,e){var r={},n=r.EncryptionVersionInfo=mi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=Rk(t,s),e-=s,r.EncryptionVerifier=Fk(t,e),r}function jte(t){var e={},r=e.EncryptionVersionInfo=mi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Gte(t){var e=0,r,n=Pk(t),s=n.length+1,i,a,o,l,c;for(r=go(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var Nk=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=Pk(a),l=i(o),c=o.length,u=go(16),f=0;f!=16;++f)u[f]=0;var h,p,g;for((c&1)===1&&(h=l>>8,u[c]=s(t[0],h),--c,h=l&255,p=o[o.length-1],u[c]=s(p,h));c>0;)--c,h=l>>8,u[c]=s(o[c],h),--c,h=l&255,u[c]=s(o[c],h);for(c=15,g=15-o.length;g>0;)h=l>>8,u[c]=s(t[g],h),--c,--g,h=l&255,u[c]=s(o[c],h),--c,--g;return u}}(),Wte=function(t,e,r,n,s){s||(s=e),n||(n=Nk(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},zte=function(t){var e=0,r=Nk(t);return function(n){var s=Wte("",n,e,r);return e=s[1],s[0]}};function Kte(t,e,r,n){var s={key:nn(t),verificationBytes:nn(t)};return r.password&&(s.verifier=Gte(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=zte(r.password)),s}function qte(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=jte(t):n.Data=Hte(t,e),n}function Xte(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?qte(t,e-2,n):Kte(t,r.biff>=8?e:e-2,r,n),n}var Yte=function(){function t(s,i){switch(i.type){case"base64":return e(Ms(s),i);case"binary":return e(s,i);case"buffer":return e(Zt&&Buffer.isBuffer(s)?s.toString("binary"):bl(s),i);case"array":return e(cl(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,g,y=-1;g=h.exec(u);){switch(g[0]){case"\\cell":var _=u.slice(p,h.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++y,_.length){var x={v:_,t:"s"};Array.isArray(o)?o[f][y]=x:o[Mt({r:f,c:y})]=x}break}p=h.lastIndex}y>c.e.c&&(c.e.c=y)}),o["!ref"]=ar(c),o}function r(s,i){return _o(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Gr(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Mt({r:c,c:u});o=l?(s[c]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ci(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Qte(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Nd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Jte(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function Zte(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Rh(t,e){if(e===0)return t;var r=Jte(Qte(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Nd(Zte(r))}var Ok=6,ere=15,tre=1,us=Ok;function Fh(t){return Math.floor((t+Math.round(128/us)/256)*us)}function Nh(t){return Math.floor((t-5)/us*100+.5)/100}function Xv(t){return Math.round((t*us+5)/us*256)/256}function Eg(t){return Xv(Nh(Fh(t)))}function Tx(t){var e=Math.abs(t-Eg(t)),r=us;if(e>.005)for(us=tre;us<ere;++us)Math.abs(t-Eg(t))<=e&&(e=Math.abs(t-Eg(t)),r=us);us=r}function Nc(t){t.width?(t.wpx=Fh(t.width),t.wch=Nh(t.wpx),t.MDW=us):t.wpx?(t.wch=Nh(t.wpx),t.width=Xv(t.wch),t.MDW=us):typeof t.wch=="number"&&(t.width=Xv(t.wch),t.wpx=Fh(t.width),t.MDW=us),t.customWidth&&delete t.customWidth}var rre=96,Mk=rre;function Lk(t){return t*96/Mk}function Od(t){return t*Mk/96}var nre={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function sre(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(ns)||[]).forEach(function(a){var o=It(a);switch(Ga(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Dr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Dr(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function are(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(ns)||[]).forEach(function(a){var o=It(a);switch(Ga(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function ire(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(ns)||[]).forEach(function(a){var o=It(a);switch(Ga(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Ar(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Dr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Dr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Dr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Dr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Dr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Dr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Dr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ox[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Dr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Yo[s.color.index];s.color.index==81&&(l=Yo[1]),l||(l=Yo[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Rh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function ore(t,e,r){e.NumberFmt=[];for(var n=Va(Ut),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Ut[n[s]];var i=t[0].match(ns);if(i)for(s=0;s<i.length;++s){var a=It(i[s]);switch(Ga(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ir(Ar(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Xo(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var s0=["numFmtId","fillId","fontId","borderId","xfId"],a0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function lre(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(ns)||[]).forEach(function(i){var a=It(i),o=0;switch(Ga(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<s0.length;++o)n[s0[o]]&&(n[s0[o]]=parseInt(n[s0[o]],10));for(o=0;o<a0.length;++o)n[a0[o]]&&(n[a0[o]]=Dr(n[a0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Dr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var cre=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&ore(f,u,c),(f=o.match(s))&&ire(f,u,l,c),(f=o.match(n))&&are(f,u,l,c),(f=o.match(i))&&sre(f,u,l,c),(f=o.match(r))&&lre(f,u,c),u}}();function ure(t,e){var r=t.read_shift(2),n=es(t);return[r,n]}function dre(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=bZ(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=EZ(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=es(t),n}var fre=rs;function hre(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var pre=rs;function mre(t,e,r){var n={};n.NumberFmt=[];for(var s in Ut)n.NumberFmt[s]=Ut[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return Pi(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Xo(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Rh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(u),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var gre=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function vre(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ns)||[]).forEach(function(s){var i=It(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[gre.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function yre(){}function xre(){}var Ere=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,bre=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,_re=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Sre(t,e,r){e.themeElements={};var n;[["clrScheme",Ere,vre],["fontScheme",bre,yre],["fmtScheme",_re,xre]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var Are=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Bk(t,e){(!t||t.length===0)&&(t=Tre());var r,n={};if(!(r=t.match(Are)))throw new Error("themeElements not found in theme");return Sre(r[0],n,e),n.raw=t,n}function Tre(t,e){var r=[X4];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wre(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=q4(i,{type:"array"})}catch{return}var o=Ps(a,"theme/theme/theme1.xml",!0);if(o)return Bk(o,r)}}function Cre(t){return t.read_shift(4)}function Ire(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=kre(t,4);break;case 2:e.xclrValue=Ak(t);break;case 3:e.xclrValue=Cre(t);break;case 4:t.l+=4;break}return t.l+=8,e}function kre(t,e){return rs(t,e)}function Dre(t,e){return rs(t,e)}function Pre(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ire(t);break;case 6:n[1]=Dre(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Rre(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(Pre(t,r-t.l));return{ixfe:n,ext:i}}function Fre(t,e){e.forEach(function(r){switch(r[0]){}})}function Nre(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:es(t)}}function Ore(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Mre(t){return t.l+=4,t.read_shift(4)!=0}function Lre(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return Pi(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function Bre(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(ns,function(o){var l=It(o);switch(Ga(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Ure(t){var e=[];if(!t)return e;var r=1;return(t.match(ns)||[]).forEach(function(n){var s=It(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function $re(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Mt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Vre(t,e,r){var n=[];return Pi(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Hre(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Pi(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function jre(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function bS(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=ds(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=Gr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=ar(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function Gre(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=It(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=ds(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Ax(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function Wre(t,e){var r=[],n=!1,s={},i=0;return t.replace(ns,function(o,l){var c=It(o);switch(Ga(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function zre(t,e){var r=[],n=!1;return t.replace(ns,function(i){var a=It(i);switch(Ga(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function Kre(t){var e={};e.iauthor=t.read_shift(4);var r=Sl(t);return e.rfx=r.s,e.ref=Mt(r.s),t.l+=16,e}var qre=es;function Xre(t,e){var r=[],n=[],s={},i=!1;return Pi(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Yre="application/vnd.ms-office.vbaProject";function Qre(t){var e=nr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),nr.write(e)}function Jre(){return{"!type":"dialog"}}function Zre(){return{"!type":"dialog"}}function ene(){return{"!type":"macro"}}function tne(){return{"!type":"macro"}}var gc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+hn(u)+(l?"":"$")+Mn(c)}return function(s,i){return e=i,s.replace(t,r)}}(),Uk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rne=function(){return function(e,r){return e.replace(Uk,function(n,s,i,a,o,l){var c=yx(a)-(i?0:r.c),u=vx(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":i?c+1:"["+c+"]";return s+"R"+f+"C"+h})}}();function $k(t,e){return t.replace(Uk,function(r,n,s,i,a,o){return n+(s=="$"?s+i:hn(yx(i)+e.c))+(a=="$"?a+o:Mn(vx(o)+e.r))})}function nne(t,e,r){var n=Kc(e),s=n.s,i=ds(r),a={r:i.r-s.r,c:i.c-s.c};return $k(t,a)}function sne(t){return t.length!=1}function _S(t){return t.replace(/_xlfn\./g,"")}function Jr(t){t.l+=1}function vo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Vk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Hk(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=vo(t),o=vo(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Hk(t){var e=vo(t),r=vo(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function ane(t,e,r){if(r.biff<8)return Hk(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=vo(t),a=vo(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function jk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return ine(t);var n=t.read_shift(r&&r.biff==12?4:2),s=vo(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function ine(t){var e=vo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function one(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function lne(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return cne(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function cne(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function une(t,e,r){var n=(t[t.l++]&96)>>5,s=Vk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function dne(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=Vk(t,i,r);return[n,s,a]}function fne(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function hne(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function pne(t,e,r){var n=(t[t.l++]&96)>>5,s=ane(t,e-1,r);return[n,s]}function mne(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function SS(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function gne(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function vne(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function yne(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function xne(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Ene(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Gk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function bne(t){return t.read_shift(2),Gk(t)}function _ne(t){return t.read_shift(2),Gk(t)}function Sne(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=jk(t,0,r);return[n,s]}function Ane(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=lne(t,0,r);return[n,s]}function Tne(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=jk(t,0,r);return[n,s,i]}function wne(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[Cse[s],Kk[s],n]}function Cne(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Ine(t);return[s,(i[0]===0?Kk:wse)[i[1]]]}function Ine(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function kne(t,e,r){t.l+=r&&r.biff==2?3:4}function Dne(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Pne(t){return t.l++,Al[t.read_shift(1)]}function Rne(t){return t.l++,t.read_shift(2)}function Fne(t){return t.l++,t.read_shift(1)!==0}function Nne(t){return t.l++,qn(t)}function One(t,e,r){return t.l++,df(t,e-1,r)}function Mne(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Al[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=qn(t);break;case 2:r[1]=Tl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Lne(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Sl:Hp)(t));return s}function Bne(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=Mne(t,r.biff);return a}function Une(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function $ne(t,e,r){if(r.biff==5)return Vne(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function Vne(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function Hne(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function jne(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Gne(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function Wne(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var zne=rs,Kne=rs,qne=rs;function hf(t,e,r){return t.l+=2,[one(t)]}function wx(t){return t.l+=6,[]}var Xne=hf,Yne=wx,Qne=wx,Jne=hf;function Wk(t){return t.l+=2,[nn(t),t.read_shift(2)&1]}var Zne=hf,ese=Wk,tse=wx,rse=hf,nse=hf,sse=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ase(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=sse[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function ise(t){return t.l+=2,[t.read_shift(4)]}function ose(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function lse(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function cse(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function use(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function dse(t){return t.l+=4,[0,0]}var AS={1:{n:"PtgExp",f:Dne},2:{n:"PtgTbl",f:qne},3:{n:"PtgAdd",f:Jr},4:{n:"PtgSub",f:Jr},5:{n:"PtgMul",f:Jr},6:{n:"PtgDiv",f:Jr},7:{n:"PtgPower",f:Jr},8:{n:"PtgConcat",f:Jr},9:{n:"PtgLt",f:Jr},10:{n:"PtgLe",f:Jr},11:{n:"PtgEq",f:Jr},12:{n:"PtgGe",f:Jr},13:{n:"PtgGt",f:Jr},14:{n:"PtgNe",f:Jr},15:{n:"PtgIsect",f:Jr},16:{n:"PtgUnion",f:Jr},17:{n:"PtgRange",f:Jr},18:{n:"PtgUplus",f:Jr},19:{n:"PtgUminus",f:Jr},20:{n:"PtgPercent",f:Jr},21:{n:"PtgParen",f:Jr},22:{n:"PtgMissArg",f:Jr},23:{n:"PtgStr",f:One},26:{n:"PtgSheet",f:ose},27:{n:"PtgEndSheet",f:lse},28:{n:"PtgErr",f:Pne},29:{n:"PtgBool",f:Fne},30:{n:"PtgInt",f:Rne},31:{n:"PtgNum",f:Nne},32:{n:"PtgArray",f:mne},33:{n:"PtgFunc",f:wne},34:{n:"PtgFuncVar",f:Cne},35:{n:"PtgName",f:Une},36:{n:"PtgRef",f:Sne},37:{n:"PtgArea",f:une},38:{n:"PtgMemArea",f:Hne},39:{n:"PtgMemErr",f:zne},40:{n:"PtgMemNoMem",f:Kne},41:{n:"PtgMemFunc",f:jne},42:{n:"PtgRefErr",f:Gne},43:{n:"PtgAreaErr",f:fne},44:{n:"PtgRefN",f:Ane},45:{n:"PtgAreaN",f:pne},46:{n:"PtgMemAreaN",f:cse},47:{n:"PtgMemNoMemN",f:use},57:{n:"PtgNameX",f:$ne},58:{n:"PtgRef3d",f:Tne},59:{n:"PtgArea3d",f:dne},60:{n:"PtgRefErr3d",f:Wne},61:{n:"PtgAreaErr3d",f:hne},255:{}},fse={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hse={1:{n:"PtgElfLel",f:Wk},2:{n:"PtgElfRw",f:rse},3:{n:"PtgElfCol",f:Xne},6:{n:"PtgElfRwV",f:nse},7:{n:"PtgElfColV",f:Jne},10:{n:"PtgElfRadical",f:Zne},11:{n:"PtgElfRadicalS",f:tse},13:{n:"PtgElfColS",f:Yne},15:{n:"PtgElfColSV",f:Qne},16:{n:"PtgElfRadicalLel",f:ese},25:{n:"PtgList",f:ase},29:{n:"PtgSxName",f:ise},255:{}},pse={0:{n:"PtgAttrNoop",f:dse},1:{n:"PtgAttrSemi",f:Ene},2:{n:"PtgAttrIf",f:yne},4:{n:"PtgAttrChoose",f:gne},8:{n:"PtgAttrGoto",f:vne},16:{n:"PtgAttrSum",f:kne},32:{n:"PtgAttrBaxcel",f:SS},33:{n:"PtgAttrBaxcel",f:SS},64:{n:"PtgAttrSpace",f:bne},65:{n:"PtgAttrSpaceSemi",f:_ne},128:{n:"PtgAttrIfError",f:xne},255:{}};function pf(t,e,r,n){if(n.biff<8)return rs(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=Bne(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Lne(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(rs(t,e)),i}function mf(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=AS[i]||AS[fse[i]],(i===24||i===25)&&(s=(i===24?hse:pse)[t[t.l+1]]),!s||!s.f?rs(t,e):a.push([s.n,s.f(t,e,r)]);return a}function mse(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var gse={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vse(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function zk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function TS(t,e,r){var n=zk(t,e,r);return n=="#REF"?n:vse(n,r)}function Wn(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,f=0,h=0,p,g="";if(!t[0]||!t[0][0])return"";for(var y=-1,_="",x=0,b=t[0].length;x<b;++x){var v=t[0][x];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),y>=0){switch(t[0][y][1][0]){case 0:_=Vr(" ",t[0][y][1][1]);break;case 1:_=Vr("\r",t[0][y][1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}c=c+_,y=-1}o.push(c+gse[v[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Yu(v[1][1],a,s),o.push(Qu(u,i));break;case"PtgRefN":u=r?Yu(v[1][1],r,s):v[1][1],o.push(Qu(u,i));break;case"PtgRef3d":f=v[1][1],u=Yu(v[1][2],a,s),g=TS(n,f,s),o.push(g+"!"+Qu(u,i));break;case"PtgFunc":case"PtgFuncVar":var T=v[1][0],D=v[1][1];T||(T=0),T&=127;var k=T==0?[]:o.slice(-T);o.length-=T,D==="User"&&(D=k.shift()),o.push(D+"("+k.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":p=aS(v[1][1],r?{s:r}:a,s),o.push(yg(p,s));break;case"PtgArea":p=aS(v[1][1],a,s),o.push(yg(p,s));break;case"PtgArea3d":f=v[1][1],p=v[1][2],g=TS(n,f,s),o.push(g+"!"+yg(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],E=S?S.Name:"SH33TJSNAME"+String(h);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var m=v[1][1];h=v[1][2];var A;if(s.biff<=5)m<0&&(m=-m),n[m]&&(A=n[m][h]);else{var I="";if(((n[m]||[])[0]||[])[0]==14849||(((n[m]||[])[0]||[])[0]==1025?n[m][h]&&n[m][h].itab>0&&(I=n.SheetNames[n[m][h].itab-1]+"!"):I=n.SheetNames[h-1]+"!"),n[m]&&n[m][h])I+=n[m][h].Name;else if(n[0]&&n[0][h])I+=n[0][h].Name;else{var C=(zk(n,m,s)||"").split(";;");C[h-1]?I=C[h-1]:I+="SH33TJSERRX"}o.push(I);break}A||(A={Name:"SH33TJSERRY"}),o.push(A.Name);break;case"PtgParen":var F="(",W=")";if(y>=0){switch(_="",t[0][y][1][0]){case 2:F=Vr(" ",t[0][y][1][1])+F;break;case 3:F=Vr("\r",t[0][y][1][1])+F;break;case 4:W=Vr(" ",t[0][y][1][1])+W;break;case 5:W=Vr("\r",t[0][y][1][1])+W;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}o.push(F+o.pop()+W);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var P={c:r.c,r:r.r};if(n.sharedf[Mt(u)]){var R=n.sharedf[Mt(u)];o.push(Wn(R,a,P,n,s))}else{var N=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Wn(c[1],a,P,n,s)),N=!0;break}N||o.push(v[1])}break;case"PtgArray":o.push("{"+mse(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var L=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&L.indexOf(t[0][x][0])==-1){v=t[0][y];var O=!0;switch(v[1][0]){case 4:O=!1;case 0:_=Vr(" ",v[1][1]);break;case 5:O=!1;case 1:_=Vr("\r",v[1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((O?_:"")+o.pop()+(O?"":_)),y=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function yse(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],rs(t,e-2)];var o=mf(t,a,r);return e!==a+s&&(i=pf(t,e-a-s,o,r)),t.l=n,[o,i]}function xse(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],rs(t,e-2)];var o=mf(t,a,r);return e!==a+s&&(i=pf(t,e-a-s,o,r)),t.l=n,[o,i]}function Ese(t,e,r,n){var s=t.l+e,i=mf(t,n,r),a;return s!==t.l&&(a=pf(t,s-t.l,i,r)),[i,a]}function bse(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=mf(t,i,r);return i==65535?[[],rs(t,e-2)]:(e!==i+2&&(s=pf(t,n-i-2,a,r)),[a,s])}function _se(t){var e;if(di(t,t.l+6)!==65535)return[qn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function bg(t,e,r){var n=t.l+e,s=Wa(t);r.biff==2&&++t.l;var i=_se(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=xse(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function jp(t,e,r){var n=t.read_shift(4),s=mf(t,n,r),i=t.read_shift(4),a=i>0?pf(t,i,s,r):null;return[s,a]}var Sse=jp,Gp=jp,Ase=jp,Tse=jp,wse={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Kk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Cse={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wS(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function _g(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var td={},vc={};function rd(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function qk(t,e,r,n,s,i){try{n.cellNF&&(t.z=Ut[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=bn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Ut[e]==null&&Xo(IJ[e]||"General",e),t.t==="e")t.w=t.w||Al[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Dd(t.v);else if(t.t==="d"){var a=ps(t.v);(a|0)===a?t.w=a.toString(10):t.w=Dd(a)}else{if(t.v===void 0)return"";t.w=ll(t.v,vc)}else t.t==="d"?t.w=Ks(e,ps(t.v),vc):t.w=Ks(e,t.v,vc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Rh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Rh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function Ise(t,e){var r=Gr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=ar(r))}var kse=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Dse=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Pse=/<(?:\w:)?hyperlink [^>]*>/mg,Rse=/"(\w*:\w*)"/,Fse=/<(?:\w:)?col\b[^>]*[\/]?>/g,Nse=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Ose=/<(?:\w:)?pageMargins[^>]*\/>/g,Xk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Mse=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Lse=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bse(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=t.match(Dse);f?(c=t.slice(0,f.index),u=t.slice(f.index+f[0].length)):c=u=t;var h=c.match(Xk);h?Cx(h[0],o,s,r):(h=c.match(Mse))&&Use(h[0],h[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(Rse);g&&Ise(o,g[1])}var y=c.match(Lse);y&&y[1]&&Wse(y[1],s);var _=[];if(e.cellStyles){var x=c.match(Fse);x&&Hse(_,x)}f&&zse(f[1],o,e,l,i,a);var b=u.match(Nse);b&&(o["!autofilter"]=jse(b[0]));var v=[],T=u.match(kse);if(T)for(p=0;p!=T.length;++p)v[p]=Gr(T[p].slice(T[p].indexOf('"')+1));var D=u.match(Pse);D&&$se(o,D,n);var k=u.match(Ose);if(k&&(o["!margins"]=Vse(It(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=ar(l)),e.sheetRows>0&&o["!ref"]){var S=Gr(o["!ref"]);e.sheetRows<=+S.e.r&&(S.e.r=e.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ar(S))}return _.length>0&&(o["!cols"]=_),v.length>0&&(o["!merges"]=v),o}function Cx(t,e,r,n){var s=It(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ir(Ar(s.codeName)))}function Use(t,e,r,n,s){Cx(t.slice(0,t.indexOf(">")),r,n,s)}function $se(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=It(Ar(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+ir(i.location))):(i.Target="#"+ir(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Gr(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Mt({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function Vse(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Hse(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=It(e[n],!0);s.hidden&&(s.hidden=Dr(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Tx(s.width)),Nc(s);i<=a;)t[i++]=On(s)}}function jse(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var Gse=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Wse(t,e){e.Views||(e.Views=[{}]),(t.match(Gse)||[]).forEach(function(r,n){var s=It(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Dr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var zse=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Pd("v"),a=Pd("f");return function(l,c,u,f,h,p){for(var g=0,y="",_=[],x=[],b=0,v=0,T=0,D="",k,S,E=0,m=0,A,I,C=0,F=0,W=Array.isArray(p.CellXf),P,R=[],N=[],L=Array.isArray(c),O=[],V={},z=!1,U=!!u.sheetStubs,G=l.split(e),j=0,ee=G.length;j!=ee;++j){y=G[j].trim();var ae=y.length;if(ae!==0){var ne=0;e:for(g=0;g<ae;++g)switch(y[g]){case">":if(y[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(S=It(y.slice(ne,g),!0),E=S.r!=null?parseInt(S.r,10):E+1,m=-1,u.sheetRows&&u.sheetRows<E)continue;V={},z=!1,S.ht&&(z=!0,V.hpt=parseFloat(S.ht),V.hpx=Od(V.hpt)),S.hidden=="1"&&(z=!0,V.hidden=!0),S.outlineLevel!=null&&(z=!0,V.level=+S.outlineLevel),z&&(O[E-1]=V)}break;case"<":ne=g;break}if(ne>=g)break;if(S=It(y.slice(ne,g),!0),E=S.r!=null?parseInt(S.r,10):E+1,m=-1,!(u.sheetRows&&u.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),u&&u.cellStyles&&(V={},z=!1,S.ht&&(z=!0,V.hpt=parseFloat(S.ht),V.hpx=Od(V.hpt)),S.hidden=="1"&&(z=!0,V.hidden=!0),S.outlineLevel!=null&&(z=!0,V.level=+S.outlineLevel),z&&(O[E-1]=V)),_=y.slice(g).split(t);for(var le=0;le!=_.length&&_[le].trim().charAt(0)=="<";++le);for(_=_.slice(le),g=0;g!=_.length;++g)if(y=_[g].trim(),y.length!==0){if(x=y.match(r),b=g,v=0,T=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,x!=null&&x.length===2){for(b=0,D=x[1],v=0;v!=D.length&&!((T=D.charCodeAt(v)-64)<1||T>26);++v)b=26*b+T;--b,m=b}else++m;for(v=0;v!=y.length&&y.charCodeAt(v)!==62;++v);if(++v,S=It(y.slice(0,v),!0),S.r||(S.r=Mt({r:E-1,c:m})),D=y.slice(v),k={t:""},(x=D.match(i))!=null&&x[1]!==""&&(k.v=ir(x[1])),u.cellFormula){if((x=D.match(a))!=null&&x[1]!==""){if(k.f=ir(Ar(x[1])).replace(/\r\n/g,`
`),u.xlfn||(k.f=_S(k.f)),x[0].indexOf('t="array"')>-1)k.F=(D.match(s)||[])[1],k.F.indexOf(":")>-1&&R.push([Gr(k.F),k.F]);else if(x[0].indexOf('t="shared"')>-1){I=It(x[0]);var Z=ir(Ar(x[1]));u.xlfn||(Z=_S(Z)),N[parseInt(I.si,10)]=[I,Z,S.r]}}else(x=D.match(/<f[^>]*\/>/))&&(I=It(x[0]),N[I.si]&&(k.f=nne(N[I.si][1],N[I.si][2],S.r)));var J=ds(S.r);for(v=0;v<R.length;++v)J.r>=R[v][0].s.r&&J.r<=R[v][0].e.r&&J.c>=R[v][0].s.c&&J.c<=R[v][0].e.c&&(k.F=R[v][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(U)k.t="z";else continue;else k.t=S.t||"n";switch(f.s.c>m&&(f.s.c=m),f.e.c<m&&(f.e.c=m),k.t){case"n":if(k.v==""||k.v==null){if(!U)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!U)continue;k.t="z"}else A=td[parseInt(k.v,10)],k.v=A.t,k.r=A.r,u.cellHTML&&(k.h=A.h);break;case"str":k.t="s",k.v=k.v!=null?Ar(k.v):"",u.cellHTML&&(k.h=px(k.v));break;case"inlineStr":x=D.match(n),k.t="s",x!=null&&(A=Ax(x[1]))?(k.v=A.t,u.cellHTML&&(k.h=A.h)):k.v="";break;case"b":k.v=Dr(k.v);break;case"d":u.cellDates?k.v=bn(k.v,1):(k.v=ps(bn(k.v,1)),k.t="n");break;case"e":(!u||u.cellText!==!1)&&(k.w=k.v),k.v=gk[k.v];break}if(C=F=0,P=null,W&&S.s!==void 0&&(P=p.CellXf[S.s],P!=null&&(P.numFmtId!=null&&(C=P.numFmtId),u.cellStyles&&P.fillId!=null&&(F=P.fillId))),qk(k,C,F,u,h,p),u.cellDates&&W&&k.t=="n"&&zc(Ut[C])&&(k.t="d",k.v=Vp(k.v)),S.cm&&u.xlmeta){var ge=(u.xlmeta.Cell||[])[+S.cm-1];ge&&ge.type=="XLDAPR"&&(k.D=!0)}if(L){var te=ds(S.r);c[te.r]||(c[te.r]=[]),c[te.r][te.c]=k}else c[S.r]=k}}}}O.length>0&&(c["!rows"]=O)}}();function Kse(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var qse=Sl;function Xse(){}function Yse(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=yZ(t),r}function Qse(t){var e=Ys(t);return[e]}function Jse(t){var e=_l(t);return[e]}function Zse(t){var e=Ys(t),r=t.read_shift(1);return[e,r,"b"]}function eae(t){var e=_l(t),r=t.read_shift(1);return[e,r,"b"]}function tae(t){var e=Ys(t),r=t.read_shift(1);return[e,r,"e"]}function rae(t){var e=_l(t),r=t.read_shift(1);return[e,r,"e"]}function nae(t){var e=Ys(t),r=t.read_shift(4);return[e,r,"s"]}function sae(t){var e=_l(t),r=t.read_shift(4);return[e,r,"s"]}function aae(t){var e=Ys(t),r=qn(t);return[e,r,"n"]}function Yk(t){var e=_l(t),r=qn(t);return[e,r,"n"]}function iae(t){var e=Ys(t),r=bx(t);return[e,r,"n"]}function oae(t){var e=_l(t),r=bx(t);return[e,r,"n"]}function lae(t){var e=Ys(t),r=xx(t);return[e,r,"is"]}function cae(t){var e=Ys(t),r=es(t);return[e,r,"str"]}function uae(t){var e=_l(t),r=es(t);return[e,r,"str"]}function dae(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=Gp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}function fae(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=Gp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}function hae(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=qn(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=Gp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}function pae(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=es(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=Gp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}var mae=Sl;function gae(t,e){var r=t.l+e,n=Sl(t),s=Ex(t),i=es(t),a=es(t),o=es(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function vae(){}function yae(t,e,r){var n=t.l+e,s=hk(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=Sse(t,n-t.l,r);a[1]=o}else t.l=n;return a}function xae(t,e,r){var n=t.l+e,s=Sl(t),i=[s];if(r.cellFormula){var a=Tse(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var Eae=["left","right","top","bottom","header","footer"];function bae(t){var e={};return Eae.forEach(function(r){e[r]=qn(t)}),e}function _ae(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Sae(){}function Aae(){}function Tae(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,g,y,_,x,b,v,T,D,k=[];o.biff=12,o["!row"]=0;var S=0,E=!1,m=[],A={},I=o.supbooks||s.supbooks||[[]];if(I.sharedf=A,I.arrayf=m,I.SheetNames=s.SheetNames||s.Sheets.map(function(L){return L.name}),!o.supbooks&&(o.supbooks=I,s.Names))for(var C=0;C<s.Names.length;++C)I[0][C+1]=s.Names[C];var F=[],W=[],P=!1;Oh[16]={n:"BrtShortReal",f:Yk};var R;if(Pi(t,function(O,V,z){if(!h)switch(z){case 148:c=O;break;case 0:p=O,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),T=Mn(_=p.r),o["!row"]=p.r,(O.hidden||O.hpt||O.level!=null)&&(O.hpt&&(O.hpx=Od(O.hpt)),W[O.r]=O);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:O[2]},O[2]){case"n":g.v=O[1];break;case"s":v=td[O[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!O[1];break;case"e":g.v=O[1],o.cellText!==!1&&(g.w=Al[g.v]);break;case"str":g.t="s",g.v=O[1];break;case"is":g.t="s",g.v=O[1].t;break}if((y=a.CellXf[O[0].iStyleRef])&&qk(g,y.numFmtId,null,o,i,a),x=O[0].c==-1?x+1:O[0].c,o.dense?(l[_]||(l[_]=[]),l[_][x]=g):l[hn(x)+T]=g,o.cellFormula){for(E=!1,S=0;S<m.length;++S){var U=m[S];p.r>=U[0].s.r&&p.r<=U[0].e.r&&x>=U[0].s.c&&x<=U[0].e.c&&(g.F=ar(U[0]),E=!0)}!E&&O.length>3&&(g.f=O[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>x&&(u.s.c=x),u.e.r<p.r&&(u.e.r=p.r),u.e.c<x&&(u.e.c=x),o.cellDates&&y&&g.t=="n"&&zc(Ut[y.numFmtId])){var G=$o(g.v);G&&(g.t="d",g.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}R&&(R.type=="XLDAPR"&&(g.D=!0),R=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},x=O[0].c==-1?x+1:O[0].c,o.dense?(l[_]||(l[_]=[]),l[_][x]=g):l[hn(x)+T]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>x&&(u.s.c=x),u.e.r<p.r&&(u.e.r=p.r),u.e.c<x&&(u.e.c=x),R&&(R.type=="XLDAPR"&&(g.D=!0),R=void 0);break;case 176:k.push(O);break;case 49:R=((o.xlmeta||{}).Cell||[])[O-1];break;case 494:var j=n["!id"][O.relId];for(j?(O.Target=j.Target,O.loc&&(O.Target+="#"+O.loc),O.Rel=j):O.relId==""&&(O.Target="#"+O.loc),_=O.rfx.s.r;_<=O.rfx.e.r;++_)for(x=O.rfx.s.c;x<=O.rfx.e.c;++x)o.dense?(l[_]||(l[_]=[]),l[_][x]||(l[_][x]={t:"z",v:void 0}),l[_][x].l=O):(b=Mt({c:x,r:_}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=O);break;case 426:if(!o.cellFormula)break;m.push(O),D=o.dense?l[_][x]:l[hn(x)+T],D.f=Wn(O[1],u,{r:p.r,c:x},I,o),D.F=ar(O[0]);break;case 427:if(!o.cellFormula)break;A[Mt(O[0].s)]=O[1],D=o.dense?l[_][x]:l[hn(x)+T],D.f=Wn(O[1],u,{r:p.r,c:x},I,o);break;case 60:if(!o.cellStyles)break;for(;O.e>=O.s;)F[O.e--]={width:O.w/256,hidden:!!(O.flags&1),level:O.level},P||(P=!0,Tx(O.w/256)),Nc(F[O.e+1]);break;case 161:l["!autofilter"]={ref:ar(O)};break;case 476:l["!margins"]=O;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),O.name&&(s.Sheets[r].CodeName=O.name),(O.above||O.left)&&(l["!outline"]={above:O.above,left:O.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),O.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!V.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+z.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=ar(c||u)),o.sheetRows&&l["!ref"]){var N=Gr(l["!ref"]);o.sheetRows<=+N.e.r&&(N.e.r=o.sheetRows-1,N.e.r>u.e.r&&(N.e.r=u.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>u.e.c&&(N.e.c=u.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ar(N))}return k.length>0&&(l["!merges"]=k),F.length>0&&(l["!cols"]=F),W.length>0&&(l["!rows"]=W),l}function wae(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=ir((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function Cae(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=wae(f);u.s.r=u.s.c=0,u.e.c=o,c=hn(o),h[0].forEach(function(p,g){a[c+Mn(g)]={t:"n",v:p,z:h[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=ar(u)),a}function Iae(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(Xk);return o&&Cx(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function kae(t,e){t.l+=10;var r=es(t);return{name:r}}function Dae(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Pi(t,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Qk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Pae=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Rae=[],Fae=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function CS(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Dr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function IS(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Dr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Jk(t){IS(t.WBProps,Qk),IS(t.CalcPr,Fae),CS(t.WBView,Pae),CS(t.Sheets,Rae),vc.date1904=Dr(t.WBProps.date1904)}var Nae="][*?/\\".split("");function Oae(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Nae.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Mae=/<\w+:workbook/;function Lae(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(ns,function(l,c){var u=It(l);switch(Ga(u[0])){case"<?xml":break;case"<workbook":l.match(Mae)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Qk.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Dr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Ar(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ir(Ar(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ar(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Dr(u.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=ir(Ar(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),tZ.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Jk(r),r}function Bae(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=zv(t),r.name=es(t),r}function Uae(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?es(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $ae(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Vae(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=xZ(t),a=Ase(t,0,r),o=Ex(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function Hae(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Oh[16]={n:"BrtFRTArchID$",f:$ae},Pi(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Wn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),Jk(r),r.Names=i,r.supbooks=a,r}function jae(t,e,r){return e.slice(-4)===".bin"?Hae(t,r):Lae(t,r)}function Gae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Tae(t,n,r,s,i,a,o):Bse(t,n,r,s,i,a,o)}function Wae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Dae(t,n,r,s,i):Iae(t,n,r,s,i)}function zae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?ene():tne()}function Kae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Jre():Zre()}function qae(t,e,r,n){return e.slice(-4)===".bin"?mre(t,r,n):cre(t,r,n)}function Xae(t,e,r){return Bk(t,r)}function Yae(t,e,r){return e.slice(-4)===".bin"?Pte(t,r):kte(t,r)}function Qae(t,e,r){return e.slice(-4)===".bin"?Xre(t,r):Gre(t,r)}function Jae(t,e,r){return e.slice(-4)===".bin"?Vre(t):Ure(t)}function Zae(t,e,r,n){return r.slice(-4)===".bin"?Hre(t,e,r,n):void 0}function eie(t,e,r){return e.slice(-4)===".bin"?Lre(t,e,r):Bre(t,e,r)}var Zk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,eD=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ta(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(Zk),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(eD),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function tie(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Zk),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(eD),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var nd;function rie(t,e){var r=nd[t]||ir(t);return r==="General"?ll(e):Ks(r,e)}function nie(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Dr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=bn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ir(e)]=s}function sie(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Al[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Dd(t.v):t.w=ll(t.v):t.w=rie(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=nd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&zc(n)){var s=$o(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function aie(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=nre[n.Pattern]||n.Pattern)}t[e.ID]=e}function iie(t,e,r,n,s,i,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var p=[],g=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&p.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Dr(t);break;case"String":n.t="s",n.r=Y_(ir(t)),n.v=t.indexOf("<")>-1?ir(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(bn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ir(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=gk[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Y_(e||t));break}if(sie(n,u,c),c.cellFormula!==!1)if(n.Formula){var y=ir(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=gc(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=gc("RC:RC",s):n.ArrayRange&&(n.F=gc(n.ArrayRange,s),l.push([Gr(n.F),n.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach(function(_){!h.patternType&&_.patternType&&(h.patternType=_.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function oie(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Sg(t,e){var r=e||{};H4();var n=Su(mx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ar(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=On(r);return a.type="string",Fd.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ue){s.indexOf("<"+ue)>=0&&(i=!0)}),i)return gie(n,r);nd={"General Number":"General","General Date":Ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ut[15],"Short Date":Ut[14],"Long Time":Ut[19],"Medium Time":Ut[18],"Short Time":Ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ut[2],Standard:Ut[4],Percent:Ut[10],Scientific:Ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},p="",g={},y={},_=ta('<Data ss:Type="String">'),x=0,b=0,v=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},k={},S="",E=0,m=[],A={},I={},C=0,F=[],W=[],P={},R=[],N,L=!1,O=[],V=[],z={},U=0,G=0,j={Sheets:[],WBProps:{date1904:!1}},ee={};Rd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";o=Rd.exec(n);)switch(o[3]=(ae=o[3]).toLowerCase()){case"data":if(ae=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?iie(n.slice(x,o.index),S,_,l[l.length-1][0]=="comment"?P:g,{c:b,r:v},D,R[b],y,O,r):(S="",_=ta(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(W.length>0&&(g.c=W),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][b]=g):h[hn(b)+Mn(v)]=g),g.HRef&&(g.l={Target:ir(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(U=b+(parseInt(g.MergeAcross,10)|0),G=v+(parseInt(g.MergeDown,10)|0),m.push({s:{c:b,r:v},e:{c:U,r:G}})),!r.sheetStubs)g.MergeAcross?b=U+1:++b;else if(g.MergeAcross||g.MergeDown){for(var ne=b;ne<=U;++ne)for(var le=v;le<=G;++le)(ne>b||le>v)&&(r.dense?(h[le]||(h[le]=[]),h[le][ne]={t:"z"}):h[hn(ne)+Mn(le)]={t:"z"});b=U+1}else++b;else g=tie(o[0]),g.Index&&(b=+g.Index-1),b<T.s.c&&(T.s.c=b),b>T.e.c&&(T.e.c=b),o[0].slice(-2)==="/>"&&++b,W=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<T.s.r&&(T.s.r=v),v>T.e.r&&(T.e.r=v),o[0].slice(-2)==="/>"&&(y=ta(o[0]),y.Index&&(v=+y.Index-1)),b=0,++v):(y=ta(o[0]),y.Index&&(v=+y.Index-1),z={},(y.AutoFitHeight=="0"||y.Height)&&(z.hpx=parseInt(y.Height,10),z.hpt=Lk(z.hpx),V[v]=z),y.Hidden=="1"&&(z.hidden=!0,V[v]=z));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(p),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(h["!ref"]=ar(T),r.sheetRows&&r.sheetRows<=T.e.r&&(h["!fullref"]=h["!ref"],T.e.r=r.sheetRows-1,h["!ref"]=ar(T))),m.length&&(h["!merges"]=m),R.length>0&&(h["!cols"]=R),V.length>0&&(h["!rows"]=V),u[p]=h}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=b=0,l.push([o[3],!1]),c=ta(o[0]),p=ir(c.Name),h=r.dense?[]:{},m=[],O=[],V=[],ee={name:p,Hidden:0},j.Sheets.push(ee);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),R=[],L=!1}break;case"style":o[1]==="/"?aie(D,k,r):k=ta(o[0]);break;case"numberformat":k.nf=ir(ta(o[0]).Format||"General"),nd[k.nf]&&(k.nf=nd[k.nf]);for(var Z=0;Z!=392&&Ut[Z]!=k.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(Ut[Z]==null){Xo(k.nf,Z);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(N=ta(o[0]),N.Hidden&&(N.hidden=!0,delete N.Hidden),N.Width&&(N.wpx=parseInt(N.Width,10)),!L&&N.wpx>10){L=!0,us=Ok;for(var J=0;J<R.length;++J)R[J]&&Nc(R[J])}L&&Nc(N),R[N.Index-1||R.length]=N;for(var ge=0;ge<+N.Span;++ge)R[R.length]=On(N);break;case"namedrange":if(o[1]==="/")break;j.Names||(j.Names=[]);var te=It(o[0]),K={Name:te.Name,Ref:gc(te.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(K.Sheet=j.Sheets.length-1),j.Names.push(K);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=ta(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?GZ(A,ae,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));oie(P),W.push(P)}else l.push([o[3],!1]),c=ta(o[0]),P={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Y=ta(o[0]);h["!autofilter"]={ref:gc(Y.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return NS(n,r);var fe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:fe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:fe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:fe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:fe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else C=o.index+o[0].length;break;case"header":h["!margins"]||rd(h["!margins"]={},"xlml"),isNaN(+It(o[0]).Margin)||(h["!margins"].header=+It(o[0]).Margin);break;case"footer":h["!margins"]||rd(h["!margins"]={},"xlml"),isNaN(+It(o[0]).Margin)||(h["!margins"].footer=+It(o[0]).Margin);break;case"pagemargins":var ye=It(o[0]);h["!margins"]||rd(h["!margins"]={},"xlml"),isNaN(+ye.Top)||(h["!margins"].top=+ye.Top),isNaN(+ye.Left)||(h["!margins"].left=+ye.Left),isNaN(+ye.Right)||(h["!margins"].right=+ye.Right),isNaN(+ye.Bottom)||(h["!margins"].bottom=+ye.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:fe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:fe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:fe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:fe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:fe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:fe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:fe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:fe=!1}break;case"smarttags":break;default:fe=!1;break}if(fe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?nie(I,ae,F,n.slice(C,o.index)):(F=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ie={};return!r.bookSheets&&!r.bookProps&&(ie.Sheets=u),ie.SheetNames=f,ie.Workbook=j,ie.SSF=On(Ut),ie.Props=A,ie.Custprops=I,ie}function Yv(t,e){switch(Dx(e=e||{}),e.type||"base64"){case"base64":return Sg(Ms(t),e);case"binary":case"buffer":case"file":return Sg(t,e);case"array":return Sg(bl(t),e)}}function lie(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=_Z(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=SZ(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var cie=[60,1084,2066,2165,2175];function uie(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=di(r,r.l),c=Qv[l],u=0;c!=null&&cie.indexOf(l)>-1;)i=di(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),a.push(o),r.l+=4+i,c=Qv[l=di(r,r.l)];var f=Xi(a);kn(f,0);var h=0;f.lens=[];for(var p=0;p<a.length;++p)f.lens.push(h),h+=a[p].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,s)}function wa(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ut[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Al[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Dd(t.v):t.w=ll(t.v):t.w=Ks(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&zc(Ut[n]||String(n))){var s=$o(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function i0(t,e,r){return{v:t,ixfe:e,t:r}}function die(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",u={},f,h="",p,g,y,_,x={},b=[],v,T,D=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},m=function(xe){return xe<8?Yo[xe]:xe<64&&k[xe-8]||Yo[xe]},A=function(xe,Ae,Le){var We=Ae.XF.data;if(!(!We||!We.patternType||!Le||!Le.cellStyles)){Ae.s={},Ae.s.patternType=We.patternType;var $e;($e=Nd(m(We.icvFore)))&&(Ae.s.fgColor={rgb:$e}),($e=Nd(m(We.icvBack)))&&(Ae.s.bgColor={rgb:$e})}},I=function(xe,Ae,Le){if(!(z>1)&&!(Le.sheetRows&&xe.r>=Le.sheetRows)){if(Le.cellStyles&&Ae.XF&&Ae.XF.data&&A(xe,Ae,Le),delete Ae.ixfe,delete Ae.XF,f=xe,h=Mt(xe),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),xe.r<a.s.r&&(a.s.r=xe.r),xe.c<a.s.c&&(a.s.c=xe.c),xe.r+1>a.e.r&&(a.e.r=xe.r+1),xe.c+1>a.e.c&&(a.e.c=xe.c+1),Le.cellFormula&&Ae.f){for(var We=0;We<b.length;++We)if(!(b[We][0].s.c>xe.c||b[We][0].s.r>xe.r)&&!(b[We][0].e.c<xe.c||b[We][0].e.r<xe.r)){Ae.F=ar(b[We][0]),(b[We][0].s.c!=xe.c||b[We][0].s.r!=xe.r)&&delete Ae.f,Ae.f&&(Ae.f=""+Wn(b[We][1],a,xe,O,C));break}}Le.dense?(s[xe.r]||(s[xe.r]=[]),s[xe.r][xe.c]=Ae):s[h]=Ae}},C={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(C.password=e.password);var F,W=[],P=[],R=[],N=[],L=!1,O=[];O.SheetNames=C.snames,O.sharedf=C.sharedf,O.arrayf=C.arrayf,O.names=[],O.XTI=[];var V=0,z=0,U=0,G=[],j=[],ee;C.codepage=1200,da(1200);for(var ae=!1;t.l<t.length-1;){var ne=t.l,le=t.read_shift(2);if(le===0&&V===10)break;var Z=t.l===t.length?0:t.read_shift(2),J=Qv[le];if(J&&J.f){if(e.bookSheets&&V===133&&le!==133)break;if(V=le,J.r===2||J.r==12){var ge=t.read_shift(2);if(Z-=2,!C.enc&&ge!==le&&((ge&255)<<8|ge>>8)!==le)throw new Error("rt mismatch: "+ge+"!="+le);J.r==12&&(t.l+=10,Z-=10)}var te={};if(le===10?te=J.f(t,Z,C):te=uie(le,J,t,Z,C),z==0&&[9,521,1033,2057].indexOf(V)===-1)continue;switch(le){case 34:r.opts.Date1904=S.WBProps.date1904=te;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(t.l=0),C.enc=te,!e.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=te;break;case 66:var K=Number(te);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252;break}da(C.codepage=K),ae=!0;break;case 317:C.rrtabid=te;break;case 25:C.winlocked=te;break;case 439:r.opts.RefreshAll=te;break;case 12:r.opts.CalcCount=te;break;case 16:r.opts.CalcDelta=te;break;case 17:r.opts.CalcIter=te;break;case 13:r.opts.CalcMode=te;break;case 14:r.opts.CalcPrecision=te;break;case 95:r.opts.CalcSaveRecalc=te;break;case 15:C.CalcRefMode=te;break;case 2211:r.opts.FullCalc=te;break;case 129:te.fDialog&&(s["!type"]="dialog"),te.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),te.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:D.push(te);break;case 430:O.push([te]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push(te);break;case 24:case 536:ee={Name:te.Name,Ref:Wn(te.rgce,a,null,O,C)},te.itab>0&&(ee.Sheet=te.itab-1),O.names.push(ee),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(j[te.itab-1]={ref:ar(te.rgce[0][0][1][2])});break;case 22:C.ExternCount=te;break;case 23:O.length==0&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat(te),O.XTI=O.XTI.concat(te);break;case 2196:if(C.biff<8)break;ee!=null&&(ee.Comment=te[1]);break;case 18:s["!protect"]=te;break;case 19:te!==0&&C.WTF&&console.error("Password verifier: "+te);break;case 133:i[te.pos]=te,C.snames.push(te.name);break;case 10:{if(--z)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=ar(a),e.sheetRows&&e.sheetRows<=a.e.r){var Y=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ar(a),a.e.r=Y}a.e.r++,a.e.c++}W.length>0&&(s["!merges"]=W),P.length>0&&(s["!objects"]=P),R.length>0&&(s["!cols"]=R),N.length>0&&(s["!rows"]=N),S.Sheets.push(E)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),C.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(C.biff=5,ae=!0,da(C.codepage=28591)),C.biff==8&&te.BIFFVer==0&&te.dt==16&&(C.biff=2),z++)break;if(s=e.dense?[]:{},C.biff<8&&!ae&&(ae=!0,da(C.codepage=e.codepage||1252)),C.biff<5||te.BIFFVer==0&&te.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var fe={pos:t.l-Z,name:c};i[fe.pos]=fe,C.snames.push(c)}else c=(i[ne]||{name:""}).name;te.dt==32&&(s["!type"]="chart"),te.dt==64&&(s["!type"]="macro"),W=[],P=[],C.arrayf=b=[],R=[],N=[],L=!1,E={Hidden:(i[ne]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[te.r]||[])[te.c]:s[Mt({c:te.c,r:te.r})])&&++te.c,v={ixfe:te.ixfe,XF:D[te.ixfe]||{},v:te.val,t:"n"},U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:te.c,r:te.r},v,e);break;case 5:case 517:v={ixfe:te.ixfe,XF:D[te.ixfe],v:te.val,t:te.t},U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:te.c,r:te.r},v,e);break;case 638:v={ixfe:te.ixfe,XF:D[te.ixfe],v:te.rknum,t:"n"},U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:te.c,r:te.r},v,e);break;case 189:for(var ye=te.c;ye<=te.C;++ye){var ie=te.rkrec[ye-te.c][0];v={ixfe:ie,XF:D[ie],v:te.rkrec[ye-te.c][1],t:"n"},U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ye,r:te.r},v,e)}break;case 6:case 518:case 1030:{if(te.val=="String"){o=te;break}if(v=i0(te.val,te.cell.ixfe,te.tt),v.XF=D[v.ixfe],e.cellFormula){var ue=te.formula;if(ue&&ue[0]&&ue[0][0]&&ue[0][0][0]=="PtgExp"){var Ee=ue[0][0][1][0],Ce=ue[0][0][1][1],Pe=Mt({r:Ee,c:Ce});x[Pe]?v.f=""+Wn(te.formula,a,te.cell,O,C):v.F=((e.dense?(s[Ee]||[])[Ce]:s[Pe])||{}).F}else v.f=""+Wn(te.formula,a,te.cell,O,C)}U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I(te.cell,v,e),o=te}break;case 7:case 519:if(o)o.val=te,v=i0(te,o.cell.ixfe,"s"),v.XF=D[v.ixfe],e.cellFormula&&(v.f=""+Wn(o.formula,a,o.cell,O,C)),U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I(o.cell,v,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(te);var Te=Mt(te[0].s);if(p=e.dense?(s[te[0].s.r]||[])[te[0].s.c]:s[Te],e.cellFormula&&p){if(!o||!Te||!p)break;p.f=""+Wn(te[1],a,te[0],O,C),p.F=ar(te[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!o)break;x[Mt(o.cell)]=te[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Mt(o.cell)],(p||{}).f=""+Wn(te[0],a,f,O,C)}}break;case 253:v=i0(l[te.isst].t,te.ixfe,"s"),l[te.isst].h&&(v.h=l[te.isst].h),v.XF=D[v.ixfe],U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:te.c,r:te.r},v,e);break;case 513:e.sheetStubs&&(v={ixfe:te.ixfe,XF:D[te.ixfe],t:"z"},U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:te.c,r:te.r},v,e));break;case 190:if(e.sheetStubs)for(var ze=te.c;ze<=te.C;++ze){var Ie=te.ixfe[ze-te.c];v={ixfe:Ie,XF:D[Ie],t:"z"},U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ze,r:te.r},v,e)}break;case 214:case 516:case 4:v=i0(te.val,te.ixfe,"s"),v.XF=D[v.ixfe],U>0&&(v.z=G[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:te.c,r:te.r},v,e);break;case 0:case 512:z===1&&(a=te);break;case 252:l=te;break;case 1054:if(C.biff==4){G[U++]=te[1];for(var be=0;be<U+163&&Ut[be]!=te[1];++be);be>=163&&Xo(te[1],U+163)}else Xo(te[1],te[0]);break;case 30:{G[U++]=te;for(var Me=0;Me<U+163&&Ut[Me]!=te;++Me);Me>=163&&Xo(te,U+163)}break;case 229:W=W.concat(te);break;case 93:P[te.cmo[0]]=C.lastobj=te;break;case 438:C.lastobj.TxO=te;break;case 127:C.lastobj.ImData=te;break;case 440:for(_=te[0].s.r;_<=te[0].e.r;++_)for(y=te[0].s.c;y<=te[0].e.c;++y)p=e.dense?(s[_]||[])[y]:s[Mt({c:y,r:_})],p&&(p.l=te[1]);break;case 2048:for(_=te[0].s.r;_<=te[0].e.r;++_)for(y=te[0].s.c;y<=te[0].e.c;++y)p=e.dense?(s[_]||[])[y]:s[Mt({c:y,r:_})],p&&p.l&&(p.l.Tooltip=te[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;p=e.dense?(s[te[0].r]||[])[te[0].c]:s[Mt(te[0])];var Ke=P[te[2]];p||(e.dense?(s[te[0].r]||(s[te[0].r]=[]),p=s[te[0].r][te[0].c]={t:"z"}):p=s[Mt(te[0])]={t:"z"},a.e.r=Math.max(a.e.r,te[0].r),a.s.r=Math.min(a.s.r,te[0].r),a.e.c=Math.max(a.e.c,te[0].c),a.s.c=Math.min(a.s.c,te[0].c)),p.c||(p.c=[]),g={a:te[1],t:Ke.TxO.t},p.c.push(g)}break;case 2173:Fre(D[te.ixfe],te.ext);break;case 125:{if(!C.cellStyles)break;for(;te.e>=te.s;)R[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},L||(L=!0,Tx(te.w/256)),Nc(R[te.e+1])}break;case 520:{var qe={};te.level!=null&&(N[te.r]=qe,qe.level=te.level),te.hidden&&(N[te.r]=qe,qe.hidden=!0),te.hpt&&(N[te.r]=qe,qe.hpt=te.hpt,qe.hpx=Od(te.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||rd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=te;break;case 161:s["!margins"]||rd(s["!margins"]={}),s["!margins"].header=te.header,s["!margins"].footer=te.footer;break;case 574:te.RTL&&(S.Views[0].RTL=!0);break;case 146:k=te;break;case 2198:F=te;break;case 140:T=te;break;case 442:c?E.CodeName=te||E.name:S.WBProps.CodeName=te||"ThisWorkbook";break}}else J||console.error("Missing Info for XLS Record 0x"+le.toString(16)),t.l+=Z}return r.SheetNames=Va(i).sort(function(Se,xe){return Number(Se)-Number(xe)}).map(function(Se){return i[Se].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&j.forEach(function(Se,xe){r.Sheets[r.SheetNames[xe]]["!autofilter"]=Se}),r.Strings=l,r.SSF=On(Ut),C.enc&&(r.Encryption=C.enc),F&&(r.Themes=F),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),O.names.length>0&&(S.Names=O.names),r.Workbook=S,r}var kS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function fie(t,e,r){var n=nr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=fS(n,kZ,kS.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=nr.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=fS(a,DZ,kS.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(yk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function tD(t,e){e||(e={}),Dx(e),D4(),e.codepage&&lx(e.codepage);var r,n;if(t.FullPaths){if(nr.find(t,"/encryption"))throw new Error("File is password-protected");r=nr.find(t,"!CompObj"),n=nr.find(t,"/Workbook")||nr.find(t,"/Book")}else{switch(e.type){case"base64":t=ca(Ms(t));break;case"binary":t=ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}kn(t,0),n={content:t}}var s,i;if(r&&lie(r),e.bookProps&&!e.bookSheets)s={};else{var a=Zt?"buffer":"array";if(n&&n.content)s=die(n.content,e);else if((i=nr.find(t,"PerfectOffice_MAIN"))&&i.content)s=ed.to_workbook(i.content,(e.type=a,e));else if((i=nr.find(t,"NativeContent_MAIN"))&&i.content)s=ed.to_workbook(i.content,(e.type=a,e));else throw(i=nr.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&nr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Qre(t))}var o={};return t.FullPaths&&fie(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var Oh={0:{f:Kse},1:{f:Qse},2:{f:iae},3:{f:tae},4:{f:Zse},5:{f:aae},6:{f:cae},7:{f:nae},8:{f:pae},9:{f:hae},10:{f:dae},11:{f:fae},12:{f:Jse},13:{f:oae},14:{f:rae},15:{f:eae},16:{f:Yk},17:{f:uae},18:{f:sae},19:{f:xx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Vae},40:{},42:{},43:{f:dre},44:{f:ure},45:{f:fre},46:{f:pre},47:{f:hre},48:{},49:{f:mZ},50:{},51:{f:Ore},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Dk},62:{f:lae},63:{f:$re},64:{f:Sae},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:rs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_ae},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Yse},148:{f:qse,p:16},151:{f:vae},152:{},153:{f:Uae},154:{},155:{},156:{f:Bae},157:{},158:{},159:{T:1,f:Dte},160:{T:-1},161:{T:1,f:Sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mae},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Nre},336:{T:-1},337:{f:Mre,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:kk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yae},427:{f:xae},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bae},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Xse},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qre},633:{T:1},634:{T:-1},635:{T:1,f:Kre},636:{T:-1},637:{f:vZ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kae},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Aae},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Qv={6:{f:bg},10:{f:Ui},12:{f:nn},13:{f:nn},14:{f:zr},15:{f:zr},16:{f:qn},17:{f:zr},18:{f:zr},19:{f:nn},20:{f:gS},21:{f:gS},23:{f:kk},24:{f:yS},25:{f:zr},26:{},27:{},28:{f:Wee},29:{},34:{f:zr},35:{f:vS},38:{f:qn},39:{f:qn},40:{f:qn},41:{f:qn},42:{f:zr},43:{f:zr},47:{f:Xte},49:{f:wee},51:{f:nn},60:{},61:{f:See},64:{f:zr},65:{f:Tee},66:{f:nn},77:{},80:{},81:{},82:{},85:{f:nn},89:{},90:{},91:{},92:{f:mee},93:{f:Kee},94:{},95:{f:zr},96:{},97:{},99:{f:zr},125:{f:Dk},128:{f:Mee},129:{f:gee},130:{f:nn},131:{f:zr},132:{f:zr},133:{f:vee},134:{},140:{f:Zee},141:{f:nn},144:{},146:{f:tte},151:{},152:{},153:{},154:{},155:{},156:{f:nn},157:{},158:{},160:{f:ite},161:{f:nte},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Ree},190:{f:Fee},193:{f:Ui},197:{},198:{},199:{},200:{},201:{},202:{f:zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:nn},220:{},221:{f:zr},222:{},224:{f:Oee},225:{f:pee},226:{f:Ui},227:{},229:{f:zee},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yee},253:{f:Cee},255:{f:xee},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Sk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zr},353:{f:Ui},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Bee},431:{f:zr},432:{},433:{},434:{},437:{},438:{f:Yee},439:{f:zr},440:{f:Qee},441:{},442:{f:ff},443:{},444:{f:nn},445:{},446:{},448:{f:Ui},449:{f:_ee,r:2},450:{f:Ui},512:{f:pS},513:{f:ate},515:{f:Lee},516:{f:Iee},517:{f:mS},519:{f:ote},520:{f:Eee},523:{},545:{f:xS},549:{f:hS},566:{},574:{f:Aee},638:{f:Pee},659:{},1048:{},1054:{f:kee},1084:{},1212:{f:Hee},2048:{f:Jee},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:n0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ui},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:rte,r:12},2173:{f:Rre,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Vee,r:12},2197:{},2198:{f:wre,r:12},2199:{},2200:{},2201:{},2202:{f:jee,r:12},2203:{f:Ui},2204:{},2205:{},2206:{},2207:{},2211:{f:bee},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:nn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ste},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ete},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:pS},1:{},2:{f:dte},3:{f:ute},4:{f:cte},5:{f:mS},7:{f:fte},8:{},9:{f:n0},11:{},22:{f:nn},30:{f:Dee},31:{},32:{},33:{f:xS},36:{},37:{f:hS},50:{f:hte},62:{},52:{},67:{},68:{f:nn},69:{},86:{},126:{},127:{f:lte},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pte},223:{},234:{},354:{},421:{},518:{f:bg},521:{f:n0},536:{f:yS},547:{f:vS},561:{},579:{},1030:{f:bg},1033:{f:n0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ra(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&uk(r)&&t.push(r)}}function DS(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=LJ(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<l.length;++a){var y=l[a].trim(),_=y.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(_!="<td"&&_!="<th")){var x=y.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var b=x[o].trim();if(b.match(/<t[dh]/i)){for(var v=b,T=0;v.charAt(0)=="<"&&(T=v.indexOf(">"))>-1;)v=v.slice(T+1);for(var D=0;D<g.length;++D){var k=g[D];k.s.c==u&&k.s.r<c&&c<=k.e.r&&(u=k.e.c+1,D=-1)}var S=It(b.slice(0,b.indexOf(">")));h=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||h>1)&&g.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var E=S.t||S["data-t"]||"";if(!v.length){u+=h;continue}if(v=Q4(v),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!v.length){u+=h;continue}var m={t:"s",v};r.raw||!v.trim().length||E=="s"||(v==="TRUE"?m={t:"b",v:!0}:v==="FALSE"?m={t:"b",v:!1}:isNaN(ma(v))?isNaN(Fc(v).getDate())||(m={t:"d",v:bn(v)},r.cellDates||(m={t:"n",v:ps(m.v)}),m.z=r.dateNF||Ut[14]):m={t:"n",v:ma(v)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=m):n[Mt({r:c,c:u})]=m,u+=h}}}}return n["!ref"]=ar(p),g.length&&(n["!merges"]=g),n}function hie(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Mt({r,c:a}),f=n.dense?(t[r]||[])[a]:t[u],h=f&&f.v!=null&&(f.h||px(f.w||(Ci(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,i.push(ZJ("td",h,p))}}var g="<tr>";return g+i.join("")+"</tr>"}var pie='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mie="</body></html>";function gie(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return _o(DS(r[0],e),e);var n=Rx();return r.forEach(function(s,i){Fx(n,DS(s,e),"Sheet"+(i+1))}),n}function vie(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function yie(t,e){var r=e||{},n=r.header!=null?r.header:pie,s=r.footer!=null?r.footer:mie,i=[n],a=Kc(t["!ref"]);r.dense=Array.isArray(t),i.push(vie(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(hie(t,a,o,r));return i.push("</table>"+s),i.join("")}function rD(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?ds(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var u=Kc(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var f=[],h=0,p=t["!rows"]||(t["!rows"]=[]),g=0,y=0,_=0,x=0,b=0,v=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&y<l;++g){var T=o[g];if(PS(T)){if(n.display)continue;p[y]={hidden:!0}}var D=T.children;for(_=x=0;_<D.length;++_){var k=D[_];if(!(n.display&&PS(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):Q4(k.innerHTML),E=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var m=f[h];m.s.c==x+i&&m.s.r<y+s&&y+s<=m.e.r&&(x=m.e.c+1-i,h=-1)}v=+k.getAttribute("colspan")||1,((b=+k.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:y+s,c:x+i},e:{r:y+s+(b||1)-1,c:x+i+(v||1)-1}});var A={t:"s",v:S},I=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?A.t=I||"z":n.raw||S.trim().length==0||I=="s"||(S==="TRUE"?A={t:"b",v:!0}:S==="FALSE"?A={t:"b",v:!1}:isNaN(ma(S))?isNaN(Fc(S).getDate())||(A={t:"d",v:bn(S)},n.cellDates||(A={t:"n",v:ps(A.v)}),A.z=n.dateNF||Ut[14]):A={t:"n",v:ma(S)})),A.z===void 0&&E!=null&&(A.z=E);var C="",F=k.getElementsByTagName("A");if(F&&F.length)for(var W=0;W<F.length&&!(F[W].hasAttribute("href")&&(C=F[W].getAttribute("href"),C.charAt(0)!="#"));++W);C&&C.charAt(0)!="#"&&(A.l={Target:C}),n.dense?(t[y+s]||(t[y+s]=[]),t[y+s][x+i]=A):t[Mt({c:x+i,r:y+s})]=A,c.e.c<x+i&&(c.e.c=x+i),x+=v}}++y}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,y-1+s),t["!ref"]=ar(c),y>=l&&(t["!fullref"]=ar((c.e.r=o.length-g+y-1+s,c))),t}function nD(t,e){var r=e||{},n=r.dense?[]:{};return rD(n,t,e)}function xie(t,e){return _o(nD(t,e),e)}function PS(t){var e="",r=Eie(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Eie(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function bie(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ir(e.replace(/<[^>]*>/g,""));return[r]}var RS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function sD(t,e){var r=e||{},n=mx(t),s=[],i,a,o={name:""},l="",c=0,u,f,h={},p=[],g=r.dense?[]:{},y,_,x={value:""},b="",v=0,T=[],D=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,m={},A=[],I={},C=0,F=0,W=[],P=1,R=1,N=[],L={Names:[]},O={},V=["",""],z=[],U={},G="",j=0,ee=!1,ae=!1,ne=0;for(Rd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Rd.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=ar(S):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=r.sheetRows-1,g["!ref"]=ar(S)),A.length&&(g["!merges"]=A),W.length&&(g["!rows"]=W),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),h[u.name]=g,ae=!1):y[0].charAt(y[0].length-2)!=="/"&&(u=It(y[0],!1),D=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=r.dense?[]:{},A=[],W=[],ae=!0);break;case"table-row-group":y[1]==="/"?--E:++E;break;case"table-row":case"":if(y[1]==="/"){D+=P,P=1;break}if(f=It(y[0],!1),f.?D=f.-1:D==-1&&(D=0),P=+f["number-rows-repeated"]||1,P<10)for(ne=0;ne<P;++ne)E>0&&(W[D+ne]={level:E});k=-1;break;case"covered-table-cell":y[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(g[D]||(g[D]=[]),g[D][k]={t:"z"}):g[Mt({r:D,c:k})]={t:"z"}),b="",T=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++k,x=It(y[0],!1),R=parseInt(x["number-columns-repeated"]||"1",10),_={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(_.f=wS(ir(x.formula))),(x.||x["value-type"])=="string"&&(_.t="s",_.v=ir(x["string-value"]||""),r.dense?(g[D]||(g[D]=[]),g[D][k]=_):g[Mt({r:D,c:k})]=_),k+=R-1;else if(y[1]!=="/"){++k,b="",v=0,T=[],R=1;var le=P?D+P-1:D;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),D<S.s.r&&(S.s.r=D),le>S.e.r&&(S.e.r=le),x=It(y[0],!1),z=[],U={},_={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=ir(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(C=parseInt(x["number-matrix-rows-spanned"],10)||0,F=parseInt(x["number-matrix-columns-spanned"],10)||0,I={s:{r:D,c:k},e:{r:D+C-1,c:k+F-1}},_.F=ar(I),N.push([I,_.F])),x.formula)_.f=wS(x.formula);else for(ne=0;ne<N.length;++ne)D>=N[ne][0].s.r&&D<=N[ne][0].e.r&&k>=N[ne][0].s.c&&k<=N[ne][0].e.c&&(_.F=N[ne][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(C=parseInt(x["number-rows-spanned"],10)||0,F=parseInt(x["number-columns-spanned"],10)||0,I={s:{r:D,c:k},e:{r:D+C-1,c:k+F-1}},A.push(I)),x["number-columns-repeated"]&&(R=parseInt(x["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Dr(x["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(x.value);break;case"percentage":_.t="n",_.v=parseFloat(x.value);break;case"currency":_.t="n",_.v=parseFloat(x.value);break;case"date":_.t="d",_.v=bn(x["date-value"]),r.cellDates||(_.t="n",_.v=ps(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=NJ(x["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Vp(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(x.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",x["string-value"]!=null&&(b=ir(x["string-value"]),T=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(ee=!1,_.t==="s"&&(_.v=b||"",T.length&&(_.R=T),ee=v==0),O.Target&&(_.l=O),z.length>0&&(_.c=z,z=[]),b&&r.cellText!==!1&&(_.w=b),ee&&(_.t="z",delete _.v),(!ee||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var Z=0;Z<P;++Z){if(R=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[D+Z]||(g[D+Z]=[]),g[D+Z][k]=Z==0?_:On(_);--R>0;)g[D+Z][k+R]=On(_);else for(g[Mt({r:D+Z,c:k})]=_;--R>0;)g[Mt({r:D+Z,c:k+R})]=On(_);S.e.c<=k&&(S.e.c=k)}R=parseInt(x["number-columns-repeated"]||"1",10),k+=R-1,R=0,_={},b="",T=[]}O={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i;U.t=b,T.length&&(U.R=T),U.a=G,z.push(U)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);G="",j=0,b="",v=0,T=[];break;case"creator":y[1]==="/"?G=n.slice(j,y.index):j=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);b="",v=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(m[o.name]=l,(i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(l="",o=It(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=It(y[0],!1),l+=RS[y[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=It(y[0],!1),l+=RS[y[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,y.index);break}else c=y.index+y[0].length;break;case"named-range":a=It(y[0],!1),V=_g(a["cell-range-address"]);var J={Name:a.name,Ref:V[0]+"!"+V[1]};ae&&(J.Sheet=p.length),L.Names.push(J);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!x||!x["string-value"])){var ge=bie(n.slice(v,y.index));b=(b.length>0?b+`
`:"")+ge[0]}else It(y[0],!1),v=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{V=_g(It(y[0])["target-range-address"]),h[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(O=It(y[0],!1),!O.href)break;O.Target=ir(O.href),delete O.href,O.Target.charAt(0)=="#"&&O.Target.indexOf(".")>-1?(V=_g(O.Target.slice(1)),O.Target="#"+V[0]+"!"+V[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var te={Sheets:h,SheetNames:p,Workbook:L};return r.bookSheets&&delete te.Sheets,te}function FS(t,e){e=e||{},Vs(t,"META-INF/manifest.xml")&&LZ(rn(t,"META-INF/manifest.xml"),e);var r=Ps(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=sD(Ar(r),e);return Vs(t,"meta.xml")&&(n.Props=vk(rn(t,"meta.xml"))),n}function NS(t,e){return sD(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ix(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Jv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ar(bl(t))}function Zv(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function OS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function _ie(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Md(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function pn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Jn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Md(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Md(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function kx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Sie(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Md(t,n),i=Jn(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:pn(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Jn(o.data),c=pn(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=pn(i[3][0].data)>>>0>0),r.push(a)}return r}function Aie(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Md(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Zv(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Zv(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Tie(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Aie(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Zv(e)}function wie(t,e,r,n){var s=Ix(t),i=s.getUint32(4,!0),a=(n>1?12:8)+OS(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=OS(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:e[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function Cie(t,e,r){var n=Ix(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=_ie(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return f}function Iie(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return wie(t,e,r,t[0]);case 5:return Cie(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ao(t){var e=Jn(t);return Md(e[1][0].data)}function MS(t,e){var r=Jn(e.data),n=pn(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Jn(a.data),l=pn(o[1][0].data)>>>0;switch(n){case 1:i[l]=Jv(o[3][0].data);break;case 8:{var c=t[ao(o[9][0].data)][0],u=Jn(c.data),f=t[ao(u[1][0].data)][0],h=pn(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Jn(f.data);i[l]=p[3].map(function(g){return Jv(g.data)}).join("")}break}}),i}function kie(t,e){var r,n,s,i,a,o,l,c,u,f,h,p,g,y,_=Jn(t),x=pn(_[1][0].data)>>>0,b=pn(_[2][0].data)>>>0,v=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&pn(_[8][0].data)>0||!1,T,D;if((i=(s=_[7])==null?void 0:s[0])!=null&&i.data&&e!=0)T=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,D=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=_[4])==null?void 0:u[0])!=null&&f.data&&e!=1)T=(p=(h=_[4])==null?void 0:h[0])==null?void 0:p.data,D=(y=(g=_[3])==null?void 0:g[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var k=v?4:1,S=Ix(T),E=[],m=0;m<T.length/2;++m){var A=S.getUint16(m*2,!0);A<65535&&E.push([m,A])}if(E.length!=b)throw"Expected ".concat(b," cells, found ").concat(E.length);var I=[];for(m=0;m<E.length-1;++m)I[E[m][0]]=D.subarray(E[m][1]*k,E[m+1][1]*k);return E.length>=1&&(I[E[E.length-1][0]]=D.subarray(E[E.length-1][1]*k)),{R:x,cells:I}}function Die(t,e){var r,n=Jn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?pn(n[7][0].data)>>>0>0?1:0:-1,i=kx(n[5],function(a){return kie(a,s)});return{nrows:pn(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function Pie(t,e,r){var n,s=Jn(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(pn(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(pn(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=ar(i);var a=Jn(s[4][0].data),o=MS(t,t[ao(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?MS(t,t[ao(a[17][0].data)][0]):[],c=Jn(a[3][0].data),u=0;c[1].forEach(function(f){var h=Jn(f.data),p=t[ao(h[2][0].data)][0],g=pn(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var y=Die(t,p);y.data.forEach(function(_,x){_.forEach(function(b,v){var T=Mt({r:u+x,c:v}),D=Iie(b,o,l);D&&(r[T]=D)})}),u+=y.nrows})}function Rie(t,e){var r=Jn(e.data),n={"!ref":"A1"},s=t[ao(r[2][0].data)],i=pn(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Pie(t,s[0],n),n}function Fie(t,e){var r,n=Jn(e.data),s={name:(r=n[1])!=null&&r[0]?Jv(n[1][0].data):"",sheets:[]},i=kx(n[2],ao);return i.forEach(function(a){t[a].forEach(function(o){var l=pn(o.meta[1][0].data);l==6e3&&s.sheets.push(Rie(t,o))})}),s}function Nie(t,e){var r=Rx(),n=Jn(e.data),s=kx(n[1],ao);if(s.forEach(function(i){t[i].forEach(function(a){var o=pn(a.meta[1][0].data);if(o==2){var l=Fie(t,a);l.sheets.forEach(function(c,u){Fx(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ag(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Tie(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=Sie(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&pn(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var u=pn(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Nie(i,o)}function Oie(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Dx(t){Oie([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Mie(t){return Ql.WS.indexOf(t)>-1?"sheet":t==Ql.CS?"chart":t==Ql.DS?"dialog":t==Ql.MS?"macro":t&&t.length?t:"sheet"}function Lie(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Mie(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Bie(t,e,r,n,s,i,a,o,l,c,u,f){try{i[n]=Ju(Ps(t,r,!0),e);var h=rn(t,e),p;switch(o){case"sheet":p=Gae(h,e,s,l,i[n],c,u,f);break;case"chart":if(p=Wae(h,e,s,l,i[n],c,u,f),!p||!p["!drawel"])break;var g=Tu(p["!drawel"].Target,e),y=Kv(g),_=jre(Ps(t,g,!0),Ju(Ps(t,y,!0),g)),x=Tu(_,g),b=Kv(x);p=Cae(Ps(t,x,!0),x,l,Ju(Ps(t,b,!0),x),c,p);break;case"macro":p=zae(h,e,s,l,i[n],c,u,f);break;case"dialog":p=Kae(h,e,s,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var v=[];i&&i[n]&&Va(i[n]).forEach(function(T){var D="";if(i[n][T].Type==Ql.CMNT){D=Tu(i[n][T].Target,e);var k=Qae(rn(t,D,!0),D,l);if(!k||!k.length)return;bS(p,k,!1)}i[n][T].Type==Ql.TCMNT&&(D=Tu(i[n][T].Target,e),v=v.concat(Wre(rn(t,D,!0),l)))}),v&&v.length&&bS(p,v,!0,l.people||[])}catch(T){if(l.WTF)throw T}}function Bs(t){return t.charAt(0)=="/"?t.slice(1):t}function Uie(t,e){if(H4(),e=e||{},Dx(e),Vs(t,"META-INF/manifest.xml")||Vs(t,"objectdata.xml"))return FS(t,e);if(Vs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ag<"u"){if(t.FileIndex)return Ag(t);var r=nr.utils.cfb_new();return q_(t).forEach(function(W){$J(r,W,UJ(t,W))}),Ag(r)}throw new Error("Unsupported NUMBERS file")}if(!Vs(t,"[Content_Types].xml"))throw Vs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=q_(t),s=OZ(Ps(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",rn(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!rn(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(td=[],s.sst)try{td=Yae(rn(t,Bs(s.sst)),s.sst,e)}catch(W){if(e.WTF)throw W}e.cellStyles&&s.themes.length&&(l=Xae(Ps(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=qae(rn(t,Bs(s.style)),s.style,l,e))}s.links.map(function(W){try{var P=Ju(Ps(t,Kv(Bs(W))),W);return Zae(rn(t,Bs(W)),P,W,e)}catch{}});var u=jae(rn(t,Bs(s.workbooks[0])),s.workbooks[0],e),f={},h="";s.coreprops.length&&(h=rn(t,Bs(s.coreprops[0]),!0),h&&(f=vk(h)),s.extprops.length!==0&&(h=rn(t,Bs(s.extprops[0]),!0),h&&$Z(h,f,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(h=Ps(t,Bs(s.custprops[0]),!0),h&&(p=HZ(h,e)));var g={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(P){return P.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(g.Props=f,g.Custprops=p),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var y={};e.bookDeps&&s.calcchain&&(y=Jae(rn(t,Bs(s.calcchain)),s.calcchain));var _=0,x={},b,v;{var T=u.Sheets;f.Worksheets=T.length,f.SheetNames=[];for(var D=0;D!=T.length;++D)f.SheetNames[D]=T[D].name}var k=i?"bin":"xml",S=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,S+1)+"_rels/"+s.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Vs(t,E)||(E="xl/_rels/workbook."+k+".rels");var m=Ju(Ps(t,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=eie(rn(t,Bs(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=zre(rn(t,Bs(s.people[0])),e)),m&&(m=Lie(m,u.Sheets));var A=rn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var I="sheet";if(m&&m[_]?(b="xl/"+m[_][1].replace(/[\/]?xl\//,""),Vs(t,b)||(b=m[_][1]),Vs(t,b)||(b=E.replace(/_rels\/.*$/,"")+m[_][1]),I=m[_][2]):(b="xl/worksheets/sheet"+(_+1-A)+"."+k,b=b.replace(/sheet0\./,"sheet.")),v=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var C=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==_&&(C=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==f.SheetNames[_].toLowerCase()&&(C=1);if(!C)continue e}}Bie(t,b,v,f.SheetNames[_],_,x,a,I,e,u,l,c)}return g={Directory:s,Workbook:u,Props:f,Custprops:p,Deps:y,Sheets:a,SheetNames:f.SheetNames,Strings:td,Styles:c,Themes:l,SSF:On(Ut)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(W,P){W=W.replace(/^Root Entry[\/]/,""),g.keys.push(W),g.files[W]=t.FileIndex[P]}))),e&&e.bookVBA&&(s.vba.length>0?g.vbaraw=rn(t,Bs(s.vba[0]),!0):s.defaults&&s.defaults.bin===Yre&&(g.vbaraw=rn(t,"xl/vbaProject.bin",!0))),g}function $ie(t,e){var r=e||{},n="Workbook",s=nr.find(t,n);try{if(n="/!DataSpaces/Version",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Rte(s.content),n="/!DataSpaces/DataSpaceMap",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Nte(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Ote(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Lte(s.content)}catch{}if(n="/EncryptionInfo",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Bte(s.content);if(n="/EncryptedPackage",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Px(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ms(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Vie(t,e){return nr.find(t,"EncryptedPackage")?$ie(t,e):tD(t,e)}function Hie(t,e){var r,n=t,s=e||{};return s.type||(s.type=Zt&&Buffer.isBuffer(t)?"buffer":"base64"),r=q4(n,s),Uie(r,s)}function aD(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Yv(t.slice(r),e);default:break e}return Fd.to_workbook(t,e)}function jie(t,e){var r="",n=Px(t,e);switch(e.type){case"base64":r=Ms(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=cl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ar(r)),e.type="binary",aD(r,e)}function Gie(t,e){var r=t;return e.type=="base64"&&(r=Ms(r)),r=kd.utils.decode(1200,r.slice(2),"str"),e.type="binary",aD(r,e)}function Wie(t){return t.match(/[^\x00-\x7F]/)?wu(t):t}function Tg(t,e,r,n){return n?(r.type="string",Fd.to_workbook(t,r)):Fd.to_workbook(e,r)}function Mh(t,e){D4();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Mh(new Uint8Array(t),(r=On(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vc={},r.dateNF&&(vc.dateNF=r.dateNF),r.type||(r.type=Zt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Zt?"buffer":"binary",n=RJ(t),typeof Uint8Array<"u"&&!Zt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Wie(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=On(r),r.type="array",Mh(cx(n),r)}switch((s=Px(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Vie(nr.read(n,r),r);break;case 9:if(s[1]<=8)return tD(n,r);break;case 60:return Yv(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return xte(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return vte.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Hie(n,r):Tg(t,n,r,i);case 239:return s[3]===60?Yv(n,r):Tg(t,n,r,i);case 255:if(s[1]===254)return Gie(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ed.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ed.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ES.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Yte.to_workbook(n,r);break;case 10:case 13:case 32:return jie(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return mte.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?ES.to_workbook(n,r):Tg(t,n,r,i)}function zie(t,e,r,n,s,i,a,o){var l=Mn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var g=a?t[r][p]:t[n[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;i[p]!=null&&(h[i[p]]=c);continue}var y=g.v;switch(g.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[p]!=null){if(y==null)if(g.t=="e"&&y===null)h[i[p]]=null;else if(c!==void 0)h[i[p]]=c;else if(u&&y===null)h[i[p]]=null;else continue;else h[i[p]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?y:Ci(g,y,o);y!=null&&(f=!1)}}return{row:h,isempty:f}}function e1(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Gr(u);break;case"number":l=Gr(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var f=Mn(l.s.r),h=[],p=[],g=0,y=0,_=Array.isArray(t),x=l.s.r,b=0,v={};_&&!t[x]&&(t[x]=[]);var T=c.skipHidden&&t["!cols"]||[],D=c.skipHidden&&t["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(T[b]||{}).hidden)switch(h[b]=hn(b),r=_?t[x][b]:t[h[b]+f],n){case 1:i[b]=b-l.s.c;break;case 2:i[b]=h[b];break;case 3:i[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ci(r,null,c),y=v[a]||0,!y)v[a]=1;else{do o=a+"_"+y++;while(v[o]);v[a]=y,v[o]=1}i[b]=o}for(x=l.s.r+s;x<=l.e.r;++x)if(!(D[x]||{}).hidden){var k=zie(t,l,x,h,n,i,_,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=k.row)}return p.length=g,p}var LS=/"/g;function Kie(t,e,r,n,s,i,a,o){for(var l=!0,c=[],u="",f=Mn(r),h=e.s.c;h<=e.e.c;++h)if(n[h]){var p=o.dense?(t[r]||[])[h]:t[n[h]+f];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:Ci(p,null,o));for(var g=0,y=0;g!==u.length;++g)if((y=u.charCodeAt(g))===s||y===i||y===34||o.forceQuotes){u='"'+u.replace(LS,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(LS,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function iD(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Gr(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(f[g]=hn(g));for(var y=0,_=s.s.r;_<=s.e.r;++_)(p[_]||{}).hidden||(u=Kie(t,s,_,f,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((y++?o:"")+u)));return delete n.dense,r.join("")}function qie(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=iD(t,e);return r}function Xie(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Gr(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=hn(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Mn(u),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function oD(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ds(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var f=Gr(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+e.length-1+s)}else a==-1&&(a=0,u.e.r=e.length-1+s);var h=n.header||[],p=0;e.forEach(function(y,_){Va(y).forEach(function(x){(p=h.indexOf(x))==-1&&(h[p=h.length]=x);var b=y[x],v="z",T="",D=Mt({c:o+p,r:a+_+s});c=Ld(i,D),b&&typeof b=="object"&&!(b instanceof Date)?i[D]=b:(typeof b=="number"?v="n":typeof b=="boolean"?v="b":typeof b=="string"?v="s":b instanceof Date?(v="d",n.cellDates||(v="n",b=ps(b)),T=n.dateNF||Ut[14]):b===null&&n.nullError&&(v="e",b=0),c?(c.t=v,c.v=b,delete c.w,delete c.R,T&&(c.z=T)):i[D]=c={t:v,v:b},T&&(c.z=T))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var g=Mn(a);if(s)for(p=0;p<h.length;++p)i[hn(p+o)+g]={t:"s",v:h[p]};return i["!ref"]=ar(u),i}function Yie(t,e){return oD(null,t,e)}function Ld(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ds(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ld(t,Mt(e)):Ld(t,Mt({r:e,c:r||0}))}function Qie(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Rx(){return{SheetNames:[],Sheets:{}}}function Fx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(Oae(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Jie(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Qie(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Zie(t,e){return t.z=e,t}function lD(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function eoe(t,e,r){return lD(t,"#"+e,r)}function toe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function roe(t,e,r,n){for(var s=typeof e!="string"?e:Gr(e),i=typeof e=="string"?e:ar(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=Ld(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var noe={encode_col:hn,encode_row:Mn,encode_cell:Mt,encode_range:ar,decode_col:yx,decode_row:vx,split_cell:pZ,decode_cell:ds,decode_range:Kc,format_cell:Ci,sheet_add_aoa:fk,sheet_add_json:oD,sheet_add_dom:rD,aoa_to_sheet:qc,json_to_sheet:Yie,table_to_sheet:nD,table_to_book:xie,sheet_to_csv:iD,sheet_to_txt:qie,sheet_to_json:e1,sheet_to_html:yie,sheet_to_formulae:Xie,sheet_to_row_object_array:e1,sheet_get_cell:Ld,book_new:Rx,book_append_sheet:Fx,book_set_sheet_visibility:Jie,cell_set_number_format:Zie,cell_set_hyperlink:lD,cell_set_internal_link:eoe,cell_add_comment:toe,sheet_set_array_formula:roe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const soe={class:"admin-time-table"},aoe={class:"header"},ioe={class:"admin-action-btns"},ooe=["disabled"],loe={class:"import-section"},coe={key:0,class:"import-preview"},uoe={class:"import-options"},doe={class:"import-option-group"},foe=["disabled"],hoe=["value"],poe={class:"import-option-group"},moe=["disabled"],goe={class:"import-actions"},voe=["disabled"],yoe={class:"content"},xoe={key:0,class:"loading"},Eoe={key:1,class:"time-tables-container"},boe={key:0,class:"empty-state"},_oe={key:1,class:"time-tables-list"},Soe={class:"time-table-header"},Aoe={class:"time-table-info"},Toe={class:"time-table-days"},woe={class:"admin-action-btns"},Coe=["onClick"],Ioe=["onClick"],koe={class:"time-table-schedule"},Doe={class:"schedule-item-info"},Poe={class:"item-name"},Roe={class:"item-time"},Foe={class:"schedule-item-type"},Noe={class:"dialog-header"},Ooe={class:"dialog-content"},Moe={class:"form-group"},Loe={class:"form-group"},Boe={class:"days-checkboxes"},Uoe=["value"],$oe={class:"form-group"},Voe={class:"schedule-items"},Hoe={class:"item-row"},joe=["onUpdate:modelValue"],Goe=["onUpdate:modelValue"],Woe=["onUpdate:modelValue"],zoe=["onUpdate:modelValue"],Koe=["onClick"],qoe={__name:"AdminTimeTable",setup(t){const{saveAppSettings:e}=Ts(),r=se(!0),n=se(!1),s=se([]),i=se(!1),a=se(-1),o=se({name:"",days:[],schedule:[]}),l=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],c=se(null),u=se([]),f=se([]),h=se("overwrite"),p=se(""),g=se(""),y=_e(()=>h.value==="overwrite"?p.value!=="":g.value.trim()!==""),_=()=>{const N=qr(o.value.name,{trim:!0,maxLength:100,removeDangerous:!0}),L=Hr(N);if(!L.isSafe)return alert(`Security threat detected in time table name: ${L.threats.join(", ")}`),!1;if(o.value.name=N,!o.value.name.trim())return alert("Please enter a time table name"),!1;if(o.value.days.length===0)return alert("Please select at least one day"),!1;if(o.value.schedule.length===0)return alert("Please add at least one schedule item"),!1;for(let O=0;O<o.value.schedule.length;O++){const V=o.value.schedule[O],z=qr(V.name,{trim:!0,maxLength:50,removeDangerous:!0}),U=Hr(z);if(!U.isSafe)return alert(`Security threat detected in schedule item ${O+1}: ${U.threats.join(", ")}`),!1;if(V.name=z,!V.name.trim())return alert(`Please enter a name for schedule item ${O+1}`),!1;if(!V.startTime||!V.endTime)return alert(`Please enter start and end times for ${V.name}`),!1;if(V.startTime>=V.endTime)return alert(`${V.name}: Start time must be before end time`),!1}return!0},x=N=>{const L=qr(N,{trim:!0,maxLength:100,removeDangerous:!0}),O=Hr(L);return O.isSafe?L:(alert(`Security threat detected in import name: ${O.threats.join(", ")}`),null)};async function b(){try{console.log("Loading time tables..."),r.value=!0;const N=await er(et(Xe,"app_settings","global"));if(N.exists()){const L=N.data();s.value=L.timeTables||[],console.log("Loaded time tables:",s.value)}else s.value=[],console.log("No time tables found, starting with empty array");r.value=!1}catch(N){console.error("Error loading time tables:",N),r.value=!1}}function v(){a.value=-1,o.value={name:"",days:[],schedule:[]},i.value=!0}function T(N){a.value=N,o.value=JSON.parse(JSON.stringify(s.value[N])),i.value=!0}function D(N){confirm("Are you sure you want to delete this time table?")&&s.value.splice(N,1)}function k(){o.value.schedule.push({name:"",type:"period",startTime:"",endTime:""})}function S(N){o.value.schedule.splice(N,1)}function E(){if(!_())return;if(!Fs("saveTimeTable",10,6e4).allowed){alert("Too many save requests. Please wait before saving again.");return}a.value===-1?s.value.push(JSON.parse(JSON.stringify(o.value))):s.value[a.value]=JSON.parse(JSON.stringify(o.value)),m()}function m(){i.value=!1,a.value=-1,o.value={name:"",days:[],schedule:[]}}async function A(){try{if(!Fs("saveAllTimeTables",5,3e5).allowed){alert("Too many save all requests. Please wait before saving again.");return}n.value=!0,console.log("Saving time tables:",s.value);const L=await er(et(Xe,"app_settings","global")),V={...L.exists()?L.data():{},timeTables:s.value};await e(V),n.value=!1,console.log("Time tables saved successfully")}catch(N){console.error("Error saving time tables:",N),n.value=!1}}function I(N){return N.length===0?"No days selected":N.length===7?"Every day":N.length===5&&N.includes("monday")&&N.includes("friday")?"Weekdays":N.map(L=>{const O=l.find(V=>V.value===L);return O?O.label:L}).join(", ")}function C(N){if(!N)return"";const[L,O]=N.split(":"),V=parseInt(L),z=V>=12?"PM":"AM";return`${V===0?12:V>12?V-12:V}:${O} ${z}`}function F(){c.value&&c.value.click()}function W(N){const L=N.target.files[0];if(!L)return;const O=ol(L,{allowedTypes:["csv","excel"],maxSize:5*1024*1024,fieldName:"Time Table Import File"});if(!O.isValid){alert(O.error),N.target.value="";return}const V=Hr(L.name);if(!V.isSafe){alert(`File name contains potentially dangerous content: ${V.threats.join(", ")}`),N.target.value="";return}const z=new FileReader;z.onload=U=>{try{let G=U.target.result,j;L.name.endsWith(".csv")?j=Mh(G,{type:"binary"}):j=Mh(G,{type:"binary"});const ee=j.SheetNames[0],ae=j.Sheets[ee],le=noe.sheet_to_json(ae,{defval:""}).map(Z=>{const J={};return Object.entries(Z).forEach(([ge,te])=>{const K=qr(ge,{trim:!0,maxLength:50,removeDangerous:!0}),Y=qr(String(te),{trim:!0,maxLength:100,removeDangerous:!0});J[K]=Y}),J});u.value=le,f.value=le.length?Object.keys(le[0]):[]}catch(G){alert("Error parsing file. Please check the file format and try again."),console.error("File parsing error:",G)}},z.readAsBinaryString(L)}function P(){try{if(!Fs("importTimeTable",3,3e5).allowed){alert("Too many import requests. Please wait before importing again.");return}const L=u.value.map(O=>{const V=O.name||O.Name||O.period||O.Period||O.item||O.Item||"Unknown",z=O.startTime||O["Start Time"]||O.start||O.Start||"08:00",U=O.endTime||O["End Time"]||O.end||O.End||"08:55",G=qr(V,{trim:!0,maxLength:50,removeDangerous:!0}),j=Hr(G);if(!j.isSafe)return console.warn(`Security threat detected in imported item: ${j.threats.join(", ")}`),null;let ee="period";const ae=O.type||O.Type||"",ne=G.toLowerCase();return ae.toLowerCase().includes("lunch")||ne.includes("lunch")?ee="lunch":ae.toLowerCase().includes("break")||ne.includes("break")?ee="break":(ae.toLowerCase().includes("other")||ne.includes("other"))&&(ee="other"),{name:G,type:ee,startTime:z,endTime:U}}).filter(O=>O&&O.name&&O.name!=="Unknown");if(L.length===0){alert("No valid schedule items found in the imported data. Please check your file format.");return}if(h.value==="overwrite"){if(p.value===""){alert("Please select a time table to overwrite");return}const O=parseInt(p.value);s.value[O]={...s.value[O],schedule:L}}else{const O=x(g.value);if(!O)return;const V={name:O,days:["monday","tuesday","wednesday","thursday","friday"],schedule:L};s.value.push(V)}u.value=[],f.value=[],h.value="overwrite",p.value="",g.value="",alert("Time table imported successfully!")}catch(N){console.error("Error importing time table:",N),alert("Error importing time table. Please check your file format and try again.")}}function R(){u.value=[],f.value=[],h.value="overwrite",p.value="",g.value=""}return Wt(b),(N,L)=>(M(),B("div",soe,[d("div",aoe,[L[7]||(L[7]=d("h1",null,"Time Table Management",-1)),d("div",ioe,[d("button",{onClick:A,class:"admin-action-btn primary",disabled:n.value,style:{"min-width":"160px","max-width":"160px"}},Q(n.value?"Saving...":"Save Time Tables"),9,ooe),d("button",{onClick:v,class:"admin-action-btn secondary",style:{"min-width":"140px","max-width":"140px"}}," Add Time Table ")])]),d("div",loe,[d("button",{onClick:F,class:"admin-action-btn info",style:{"min-width":"150px","max-width":"150px"}},"Import CSV/XLSX"),d("input",{ref_key:"fileInput",ref:c,type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},onChange:W},null,544),L[8]||(L[8]=d("div",{class:"import-note"}," You can export from Google Sheets or Excel as CSV, or upload your Excel file directly. ",-1))]),u.value.length?(M(),B("div",coe,[L[13]||(L[13]=d("h3",null,"Preview Imported Time Table",-1)),d("table",null,[d("thead",null,[d("tr",null,[(M(!0),B(ke,null,He(f.value,O=>(M(),B("th",{key:O},Q(O),1))),128))])]),d("tbody",null,[(M(!0),B(ke,null,He(u.value,(O,V)=>(M(),B("tr",{key:V},[(M(!0),B(ke,null,He(f.value,z=>(M(),B("td",{key:z},Q(O[z]),1))),128))]))),128))])]),d("div",uoe,[L[12]||(L[12]=d("h4",null,"Import Options",-1)),d("div",doe,[d("label",null,[Oe(d("input",{type:"radio","onUpdate:modelValue":L[0]||(L[0]=O=>h.value=O),value:"overwrite"},null,512),[[Ss,h.value]]),L[9]||(L[9]=we(" Overwrite existing time table: "))]),Oe(d("select",{"onUpdate:modelValue":L[1]||(L[1]=O=>p.value=O),disabled:h.value!=="overwrite",class:"form-select"},[L[10]||(L[10]=d("option",{value:""},"Select a time table...",-1)),(M(!0),B(ke,null,He(s.value,(O,V)=>(M(),B("option",{key:V,value:V},Q(O.name),9,hoe))),128))],8,foe),[[sr,p.value]])]),d("div",poe,[d("label",null,[Oe(d("input",{type:"radio","onUpdate:modelValue":L[2]||(L[2]=O=>h.value=O),value:"create"},null,512),[[Ss,h.value]]),L[11]||(L[11]=we(" Create new time table: "))]),Oe(d("input",{"onUpdate:modelValue":L[3]||(L[3]=O=>g.value=O),type:"text",placeholder:"Enter time table name...",disabled:h.value!=="create",class:"form-input"},null,8,moe),[[ht,g.value]])])]),d("div",goe,[d("button",{onClick:P,class:"btn btn-primary",disabled:!y.value},Q(h.value==="overwrite"?"Overwrite Time Table":"Create New Time Table"),9,voe),d("button",{onClick:R,class:"btn btn-secondary"},"Cancel")])])):ve("",!0),d("div",yoe,[r.value?(M(),B("div",xoe," Loading time tables... ")):(M(),B("div",Eoe,[s.value.length===0?(M(),B("div",boe,[L[14]||(L[14]=d("h3",null,"No Time Tables Created",-1)),L[15]||(L[15]=d("p",null,"Create your first time table to get started.",-1)),d("button",{onClick:v,class:"btn btn-primary"},"Create Time Table")])):(M(),B("div",_oe,[(M(!0),B(ke,null,He(s.value,(O,V)=>(M(),B("div",{key:V,class:"time-table-card"},[d("div",Soe,[d("div",Aoe,[d("h3",null,Q(O.name),1),d("p",Toe,Q(I(O.days)),1)]),d("div",woe,[d("button",{onClick:z=>T(V),class:"admin-action-btn edit"}," Edit ",8,Coe),d("button",{onClick:z=>D(V),class:"admin-action-btn delete"}," Delete ",8,Ioe)])]),d("div",koe,[(M(!0),B(ke,null,He(O.schedule,(z,U)=>(M(),B("div",{key:U,class:"schedule-item"},[d("div",Doe,[d("span",Poe,Q(z.name),1),d("span",Roe,Q(C(z.startTime))+" - "+Q(C(z.endTime)),1)]),d("div",Foe,[d("span",{class:Ye(["type-badge",z.type])},Q(z.type),3)])]))),128))])]))),128))]))]))]),i.value?(M(),B("div",{key:1,class:"edit-dialog-overlay",onClick:m},[d("div",{class:"edit-dialog",onClick:L[6]||(L[6]=Yr(()=>{},["stop"]))},[d("div",Noe,[d("h2",null,Q(a.value===-1?"Create Time Table":"Edit Time Table"),1),d("button",{onClick:m,class:"btn-close"},"")]),d("div",Ooe,[d("div",Moe,[L[16]||(L[16]=d("label",{for:"timeTableName"},"Time Table Name",-1)),Oe(d("input",{id:"timeTableName","onUpdate:modelValue":L[4]||(L[4]=O=>o.value.name=O),type:"text",placeholder:"e.g., Regular Schedule, Rally Day, Minimum Day",class:"form-input"},null,512),[[ht,o.value.name]])]),d("div",Loe,[L[17]||(L[17]=d("label",null,"Days This Schedule Applies",-1)),d("div",Boe,[(M(),B(ke,null,He(l,O=>d("label",{key:O.value,class:"day-checkbox"},[Oe(d("input",{type:"checkbox",value:O.value,"onUpdate:modelValue":L[5]||(L[5]=V=>o.value.days=V)},null,8,Uoe),[[_t,o.value.days]]),we(" "+Q(O.label),1)])),64))])]),d("div",$oe,[L[20]||(L[20]=d("label",null,"Schedule Items",-1)),d("div",Voe,[(M(!0),B(ke,null,He(o.value.schedule,(O,V)=>(M(),B("div",{key:V,class:"schedule-item-edit"},[d("div",Hoe,[Oe(d("input",{"onUpdate:modelValue":z=>O.name=z,type:"text",placeholder:"Period 1, Lunch, Break, etc.",class:"form-input item-name-input"},null,8,joe),[[ht,O.name]]),Oe(d("select",{"onUpdate:modelValue":z=>O.type=z,class:"form-select item-type-select"},L[18]||(L[18]=[d("option",{value:"period"},"Period",-1),d("option",{value:"break"},"Break",-1),d("option",{value:"lunch"},"Lunch",-1),d("option",{value:"other"},"Other",-1)]),8,Goe),[[sr,O.type]]),Oe(d("input",{"onUpdate:modelValue":z=>O.startTime=z,type:"time",class:"form-input time-input"},null,8,Woe),[[ht,O.startTime]]),L[19]||(L[19]=d("span",{class:"time-separator"},"to",-1)),Oe(d("input",{"onUpdate:modelValue":z=>O.endTime=z,type:"time",class:"form-input time-input"},null,8,zoe),[[ht,O.endTime]]),d("button",{onClick:z=>S(V),class:"admin-action-btn delete"}," Delete ",8,Koe)])]))),128)),d("button",{onClick:k,class:"admin-action-btn secondary",style:{"min-width":"150px","max-width":"150px"}}," Add Schedule Item ")])])]),d("div",{class:"admin-action-btns"},[d("button",{onClick:m,class:"admin-action-btn cancel",style:{"min-width":"100px","max-width":"100px"}},"Cancel"),d("button",{onClick:E,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},"Save Time Table")])])])):ve("",!0)]))}},cD=St(qoe,[["__scopeId","data-v-428c8e72"]]);function Xoe(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const f=await Gt(At(Xe,"aideSchedules")),h={};f.forEach(p=>{h[p.id]=p.data()}),t.value=h}catch(f){console.error("Error loading aide schedules:",f),t.value={}}finally{e.value=!1}}async function n(f){e.value=!0;try{const h=await er(et(Xe,"aideSchedules",f));h.exists()?t.value[f]=h.data():t.value[f]={schedule:{},directAssignment:[]}}catch(h){console.error("Error loading aide schedule:",h),t.value[f]={schedule:{},directAssignment:[]}}finally{e.value=!1}}async function s(f,h,p=!0){try{const g=JSON.parse(JSON.stringify(h));p?await $t(et(Xe,"aideSchedules",f),g,{merge:!0}):await $t(et(Xe,"aideSchedules",f),g),t.value[f]=g}catch(g){throw console.error("Error saving aide schedule:",g),g}}async function i(){try{const f=Object.entries(t.value);for(const[h,p]of f){const g=JSON.parse(JSON.stringify(p));await $t(et(Xe,"aideSchedules",h),g,{merge:!0})}}catch(f){throw console.error("Error saving all aide schedules:",f),f}}function a(f,h){const p=[];return Object.entries(t.value).forEach(([g,y])=>{y.schedule&&y.schedule[h]&&(Array.isArray(y.schedule[h])?y.schedule[h]:[y.schedule[h]]).includes(f)&&p.push(g)}),p}function o(f){var p;const h=(p=t.value[f])==null?void 0:p.directAssignment;return Array.isArray(h)?h.length>0?h[0]:null:h||null}function l(f){return Object.keys(t.value).find(p=>{var y;const g=(y=t.value[p])==null?void 0:y.directAssignment;return Array.isArray(g)?g.includes(f):g===f})||null}function c(f,h,p){const g=[],y=t.value[f];return y&&((Array.isArray(y.directAssignment)?y.directAssignment:y.directAssignment?[y.directAssignment]:[]).forEach(x=>{if(x){const b=h.find(v=>v.id===x);b&&g.push({...b,assignmentType:"direct"})}}),Object.entries(y.schedule||{}).forEach(([x,b])=>{b&&(Array.isArray(b)?b:[b]).forEach(T=>{T&&h.forEach(D=>{if(D.schedule&&D.schedule[x]===T){const k=g.findIndex(S=>S.id===D.id);k===-1?g.push({...D,assignmentType:"class",period:x,teacherId:T}):(g[k].assignmentType="both",g[k].period=x,g[k].teacherId=T)}})})})),g}function u(f,h,p,g){if(!f||!h||!p||!g)return!1;const y=p.find(T=>T.id===h);if(!y)return!1;const _=t.value[f];if(!_)return!1;if((Array.isArray(_.directAssignment)?_.directAssignment:_.directAssignment?[_.directAssignment]:[]).includes(h))return!0;if(!y.schedule)return!1;const b=_.schedule||{};return Object.entries(y.schedule).some(([T,D])=>{const k=b[T];return k?(Array.isArray(k)?k:[k]).includes(D):!1})}return{aideSchedule:_e(()=>t.value),loading:_e(()=>e.value),loadAideSchedules:r,loadAideSchedule:n,saveAideSchedule:s,saveAllAideSchedules:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}var Yoe={exports:{}};const Qoe=rx(xF);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function BS(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ha(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BS(Object(r),!0).forEach(function(n){Joe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BS(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function O0(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?O0=function(e){return typeof e}:O0=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O0(t)}function Joe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qs(){return qs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qs.apply(this,arguments)}function Zoe(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function ele(t,e){if(t==null)return{};var r=Zoe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function tle(t){return rle(t)||nle(t)||sle(t)||ale()}function rle(t){if(Array.isArray(t))return t1(t)}function nle(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function sle(t,e){if(t){if(typeof t=="string")return t1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t1(t,e)}}function t1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ale(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ile="1.14.0";function gi(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Ri=gi(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),gf=gi(/Edge/i),US=gi(/firefox/i),sd=gi(/safari/i)&&!gi(/chrome/i)&&!gi(/android/i),uD=gi(/iP(ad|od|hone)/i),ole=gi(/chrome/i)&&gi(/android/i),dD={capture:!1,passive:!1};function Kt(t,e,r){t.addEventListener(e,r,!Ri&&dD)}function zt(t,e,r){t.removeEventListener(e,r,!Ri&&dD)}function Lh(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function lle(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function aa(t,e,r,n){if(t){r=r||document;do{if(e!=null&&(e[0]===">"?t.parentNode===r&&Lh(t,e):Lh(t,e))||n&&t===r)return t;if(t===r)break}while(t=lle(t))}return null}var $S=/\s+/g;function Fr(t,e,r){if(t&&e)if(t.classList)t.classList[r?"add":"remove"](e);else{var n=(" "+t.className+" ").replace($S," ").replace(" "+e+" "," ");t.className=(n+(r?" "+e:"")).replace($S," ")}}function vt(t,e,r){var n=t&&t.style;if(n){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(r=t.currentStyle),e===void 0?r:r[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=r+(typeof r=="string"?"":"px")}}function Qo(t,e){var r="";if(typeof t=="string")r=t;else do{var n=vt(t,"transform");n&&n!=="none"&&(r=n+" "+r)}while(!e&&(t=t.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(r)}function fD(t,e,r){if(t){var n=t.getElementsByTagName(e),s=0,i=n.length;if(r)for(;s<i;s++)r(n[s],s);return n}return[]}function La(){var t=document.scrollingElement;return t||document.documentElement}function Pr(t,e,r,n,s){if(!(!t.getBoundingClientRect&&t!==window)){var i,a,o,l,c,u,f;if(t!==window&&t.parentNode&&t!==La()?(i=t.getBoundingClientRect(),a=i.top,o=i.left,l=i.bottom,c=i.right,u=i.height,f=i.width):(a=0,o=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||r)&&t!==window&&(s=s||t.parentNode,!Ri))do if(s&&s.getBoundingClientRect&&(vt(s,"transform")!=="none"||r&&vt(s,"position")!=="static")){var h=s.getBoundingClientRect();a-=h.top+parseInt(vt(s,"border-top-width")),o-=h.left+parseInt(vt(s,"border-left-width")),l=a+i.height,c=o+i.width;break}while(s=s.parentNode);if(n&&t!==window){var p=Qo(s||t),g=p&&p.a,y=p&&p.d;p&&(a/=y,o/=g,f/=g,u/=y,l=a+u,c=o+f)}return{top:a,left:o,bottom:l,right:c,width:f,height:u}}}function VS(t,e,r){for(var n=eo(t,!0),s=Pr(t)[e];n;){var i=Pr(n)[r],a=void 0;if(a=s>=i,!a)return n;if(n===La())break;n=eo(n,!1)}return!1}function Oc(t,e,r,n){for(var s=0,i=0,a=t.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==wt.ghost&&(n||a[i]!==wt.dragged)&&aa(a[i],r.draggable,t,!1)){if(s===e)return a[i];s++}i++}return null}function Nx(t,e){for(var r=t.lastElementChild;r&&(r===wt.ghost||vt(r,"display")==="none"||e&&!Lh(r,e));)r=r.previousElementSibling;return r||null}function $r(t,e){var r=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==wt.clone&&(!e||Lh(t,e))&&r++;return r}function HS(t){var e=0,r=0,n=La();if(t)do{var s=Qo(t),i=s.a,a=s.d;e+=t.scrollLeft*i,r+=t.scrollTop*a}while(t!==n&&(t=t.parentNode));return[e,r]}function cle(t,e){for(var r in t)if(t.hasOwnProperty(r)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t[r][n])return Number(r)}return-1}function eo(t,e){if(!t||!t.getBoundingClientRect)return La();var r=t,n=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var s=vt(r);if(r.clientWidth<r.scrollWidth&&(s.overflowX=="auto"||s.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(s.overflowY=="auto"||s.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return La();if(n||e)return r;n=!0}}while(r=r.parentNode);return La()}function ule(t,e){if(t&&e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function wg(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var ad;function hD(t,e){return function(){if(!ad){var r=arguments,n=this;r.length===1?t.call(n,r[0]):t.apply(n,r),ad=setTimeout(function(){ad=void 0},e)}}}function dle(){clearTimeout(ad),ad=void 0}function pD(t,e,r){t.scrollLeft+=e,t.scrollTop+=r}function Ox(t){var e=window.Polymer,r=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):r?r(t).clone(!0)[0]:t.cloneNode(!0)}function jS(t,e){vt(t,"position","absolute"),vt(t,"top",e.top),vt(t,"left",e.left),vt(t,"width",e.width),vt(t,"height",e.height)}function Cg(t){vt(t,"position",""),vt(t,"top",""),vt(t,"left",""),vt(t,"width",""),vt(t,"height","")}var Xn="Sortable"+new Date().getTime();function fle(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(s){if(!(vt(s,"display")==="none"||s===wt.ghost)){t.push({target:s,rect:Pr(s)});var i=Ha({},t[t.length-1].rect);if(s.thisAnimationDuration){var a=Qo(s,!0);a&&(i.top-=a.f,i.left-=a.e)}s.fromRect=i}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(cle(t,{target:n}),1)},animateAll:function(n){var s=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var i=!1,a=0;t.forEach(function(o){var l=0,c=o.target,u=c.fromRect,f=Pr(c),h=c.prevFromRect,p=c.prevToRect,g=o.rect,y=Qo(c,!0);y&&(f.top-=y.f,f.left-=y.e),c.toRect=f,c.thisAnimationDuration&&wg(h,f)&&!wg(u,f)&&(g.top-f.top)/(g.left-f.left)===(u.top-f.top)/(u.left-f.left)&&(l=ple(g,h,p,s.options)),wg(f,u)||(c.prevFromRect=u,c.prevToRect=f,l||(l=s.options.animation),s.animate(c,g,f,l)),l&&(i=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),i?e=setTimeout(function(){typeof n=="function"&&n()},a):typeof n=="function"&&n(),t=[]},animate:function(n,s,i,a){if(a){vt(n,"transition",""),vt(n,"transform","");var o=Qo(this.el),l=o&&o.a,c=o&&o.d,u=(s.left-i.left)/(l||1),f=(s.top-i.top)/(c||1);n.animatingX=!!u,n.animatingY=!!f,vt(n,"transform","translate3d("+u+"px,"+f+"px,0)"),this.forRepaintDummy=hle(n),vt(n,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),vt(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){vt(n,"transition",""),vt(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},a)}}}}function hle(t){return t.offsetWidth}function ple(t,e,r,n){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))*n.animation}var Ll=[],Ig={initializeByDefault:!0},vf={mount:function(e){for(var r in Ig)Ig.hasOwnProperty(r)&&!(r in e)&&(e[r]=Ig[r]);Ll.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ll.push(e)},pluginEvent:function(e,r,n){var s=this;this.eventCanceled=!1,n.cancel=function(){s.eventCanceled=!0};var i=e+"Global";Ll.forEach(function(a){r[a.pluginName]&&(r[a.pluginName][i]&&r[a.pluginName][i](Ha({sortable:r},n)),r.options[a.pluginName]&&r[a.pluginName][e]&&r[a.pluginName][e](Ha({sortable:r},n)))})},initializePlugins:function(e,r,n,s){Ll.forEach(function(o){var l=o.pluginName;if(!(!e.options[l]&&!o.initializeByDefault)){var c=new o(e,r,e.options);c.sortable=e,c.options=e.options,e[l]=c,qs(n,c.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);typeof a<"u"&&(e.options[i]=a)}},getEventProperties:function(e,r){var n={};return Ll.forEach(function(s){typeof s.eventProperties=="function"&&qs(n,s.eventProperties.call(r[s.pluginName],e))}),n},modifyOption:function(e,r,n){var s;return Ll.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[r]=="function"&&(s=i.optionListeners[r].call(e[i.pluginName],n))}),s}};function Cu(t){var e=t.sortable,r=t.rootEl,n=t.name,s=t.targetEl,i=t.cloneEl,a=t.toEl,o=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,f=t.newDraggableIndex,h=t.originalEvent,p=t.putSortable,g=t.extraEventProperties;if(e=e||r&&r[Xn],!!e){var y,_=e.options,x="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!Ri&&!gf?y=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(n,!0,!0)),y.to=a||r,y.from=o||r,y.item=s||r,y.clone=i,y.oldIndex=l,y.newIndex=c,y.oldDraggableIndex=u,y.newDraggableIndex=f,y.originalEvent=h,y.pullMode=p?p.lastPutMode:void 0;var b=Ha(Ha({},g),vf.getEventProperties(n,e));for(var v in b)y[v]=b[v];r&&r.dispatchEvent(y),_[x]&&_[x].call(e,y)}}var mle=["evt"],gs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=n.evt,i=ele(n,mle);vf.pluginEvent.bind(wt)(e,r,Ha({dragEl:nt,parentEl:Lr,ghostEl:Bt,rootEl:kr,nextEl:Oo,lastDownEl:M0,cloneEl:Br,cloneHidden:Yi,dragStarted:Iu,putSortable:wn,activeSortable:wt.active,originalEvent:s,oldIndex:Jl,oldDraggableIndex:id,newIndex:ks,newDraggableIndex:Ki,hideGhostForTarget:yD,unhideGhostForTarget:xD,cloneNowHidden:function(){Yi=!0},cloneNowShown:function(){Yi=!1},dispatchSortableEvent:function(o){is({sortable:r,name:o,originalEvent:s})}},i))};function is(t){Cu(Ha({putSortable:wn,cloneEl:Br,targetEl:nt,rootEl:kr,oldIndex:Jl,oldDraggableIndex:id,newIndex:ks,newDraggableIndex:Ki},t))}var nt,Lr,Bt,kr,Oo,M0,Br,Yi,Jl,ks,id,Ki,o0,wn,ql=!1,Bh=!1,Uh=[],Po,na,kg,Dg,GS,WS,Iu,Bl,od,ld=!1,l0=!1,L0,Hn,Pg=[],r1=!1,$h=[],Wp=typeof document<"u",c0=uD,zS=gf||Ri?"cssFloat":"float",gle=Wp&&!ole&&!uD&&"draggable"in document.createElement("div"),mD=function(){if(Wp){if(Ri)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),gD=function(e,r){var n=vt(e),s=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=Oc(e,0,r),a=Oc(e,1,r),o=i&&vt(i),l=a&&vt(a),c=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Pr(i).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Pr(a).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&o.float&&o.float!=="none"){var f=o.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return i&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||c>=s&&n[zS]==="none"||a&&n[zS]==="none"&&c+u>s)?"vertical":"horizontal"},vle=function(e,r,n){var s=n?e.left:e.top,i=n?e.right:e.bottom,a=n?e.width:e.height,o=n?r.left:r.top,l=n?r.right:r.bottom,c=n?r.width:r.height;return s===o||i===l||s+a/2===o+c/2},yle=function(e,r){var n;return Uh.some(function(s){var i=s[Xn].options.emptyInsertThreshold;if(!(!i||Nx(s))){var a=Pr(s),o=e>=a.left-i&&e<=a.right+i,l=r>=a.top-i&&r<=a.bottom+i;if(o&&l)return n=s}}),n},vD=function(e){function r(i,a){return function(o,l,c,u){var f=o.options.group.name&&l.options.group.name&&o.options.group.name===l.options.group.name;if(i==null&&(a||f))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return r(i(o,l,c,u),a)(o,l,c,u);var h=(a?o:l).options.group.name;return i===!0||typeof i=="string"&&i===h||i.join&&i.indexOf(h)>-1}}var n={},s=e.group;(!s||O0(s)!="object")&&(s={name:s}),n.name=s.name,n.checkPull=r(s.pull,!0),n.checkPut=r(s.put),n.revertClone=s.revertClone,e.group=n},yD=function(){!mD&&Bt&&vt(Bt,"display","none")},xD=function(){!mD&&Bt&&vt(Bt,"display","")};Wp&&document.addEventListener("click",function(t){if(Bh)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Bh=!1,!1},!0);var Ro=function(e){if(nt){e=e.touches?e.touches[0]:e;var r=yle(e.clientX,e.clientY);if(r){var n={};for(var s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);n.target=n.rootEl=r,n.preventDefault=void 0,n.stopPropagation=void 0,r[Xn]._onDragOver(n)}}},xle=function(e){nt&&nt.parentNode[Xn]._isOutsideThisEl(e.target)};function wt(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=qs({},e),t[Xn]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return gD(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:wt.supportPointer!==!1&&"PointerEvent"in window&&!sd,emptyInsertThreshold:5};vf.initializePlugins(this,t,r);for(var n in r)!(n in e)&&(e[n]=r[n]);vD(e);for(var s in this)s.charAt(0)==="_"&&typeof this[s]=="function"&&(this[s]=this[s].bind(this));this.nativeDraggable=e.forceFallback?!1:gle,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Kt(t,"pointerdown",this._onTapStart):(Kt(t,"mousedown",this._onTapStart),Kt(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Kt(t,"dragover",this),Kt(t,"dragenter",this)),Uh.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),qs(this,fle())}wt.prototype={constructor:wt,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Bl=null)},_getDirection:function(e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,e,r,nt):this.options.direction},_onTapStart:function(e){if(e.cancelable){var r=this,n=this.el,s=this.options,i=s.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(o||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=s.filter;if(Cle(n),!nt&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||s.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&sd&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=aa(l,s.draggable,n,!1),!(l&&l.animated)&&M0!==l)){if(Jl=$r(l),id=$r(l,s.draggable),typeof u=="function"){if(u.call(this,e,l,this)){is({sortable:r,rootEl:c,name:"filter",targetEl:l,toEl:n,fromEl:n}),gs("filter",r,{evt:e}),i&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(f){if(f=aa(c,f.trim(),n,!1),f)return is({sortable:r,rootEl:f,name:"filter",targetEl:l,fromEl:n,toEl:n}),gs("filter",r,{evt:e}),!0}),u)){i&&e.cancelable&&e.preventDefault();return}s.handle&&!aa(c,s.handle,n,!1)||this._prepareDragStart(e,o,l)}}},_prepareDragStart:function(e,r,n){var s=this,i=s.el,a=s.options,o=i.ownerDocument,l;if(n&&!nt&&n.parentNode===i){var c=Pr(n);if(kr=i,nt=n,Lr=nt.parentNode,Oo=nt.nextSibling,M0=n,o0=a.group,wt.dragged=nt,Po={target:nt,clientX:(r||e).clientX,clientY:(r||e).clientY},GS=Po.clientX-c.left,WS=Po.clientY-c.top,this._lastX=(r||e).clientX,this._lastY=(r||e).clientY,nt.style["will-change"]="all",l=function(){if(gs("delayEnded",s,{evt:e}),wt.eventCanceled){s._onDrop();return}s._disableDelayedDragEvents(),!US&&s.nativeDraggable&&(nt.draggable=!0),s._triggerDragStart(e,r),is({sortable:s,name:"choose",originalEvent:e}),Fr(nt,a.chosenClass,!0)},a.ignore.split(",").forEach(function(u){fD(nt,u.trim(),Rg)}),Kt(o,"dragover",Ro),Kt(o,"mousemove",Ro),Kt(o,"touchmove",Ro),Kt(o,"mouseup",s._onDrop),Kt(o,"touchend",s._onDrop),Kt(o,"touchcancel",s._onDrop),US&&this.nativeDraggable&&(this.options.touchStartThreshold=4,nt.draggable=!0),gs("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(gf||Ri))){if(wt.eventCanceled){this._onDrop();return}Kt(o,"mouseup",s._disableDelayedDrag),Kt(o,"touchend",s._disableDelayedDrag),Kt(o,"touchcancel",s._disableDelayedDrag),Kt(o,"mousemove",s._delayedDragTouchMoveHandler),Kt(o,"touchmove",s._delayedDragTouchMoveHandler),a.supportPointer&&Kt(o,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var r=e.touches?e.touches[0]:e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){nt&&Rg(nt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;zt(e,"mouseup",this._disableDelayedDrag),zt(e,"touchend",this._disableDelayedDrag),zt(e,"touchcancel",this._disableDelayedDrag),zt(e,"mousemove",this._delayedDragTouchMoveHandler),zt(e,"touchmove",this._delayedDragTouchMoveHandler),zt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,r){r=r||e.pointerType=="touch"&&e,!this.nativeDraggable||r?this.options.supportPointer?Kt(document,"pointermove",this._onTouchMove):r?Kt(document,"touchmove",this._onTouchMove):Kt(document,"mousemove",this._onTouchMove):(Kt(nt,"dragend",this),Kt(kr,"dragstart",this._onDragStart));try{document.selection?B0(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,r){if(ql=!1,kr&&nt){gs("dragStarted",this,{evt:r}),this.nativeDraggable&&Kt(document,"dragover",xle);var n=this.options;!e&&Fr(nt,n.dragClass,!1),Fr(nt,n.ghostClass,!0),wt.active=this,e&&this._appendGhost(),is({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(na){this._lastX=na.clientX,this._lastY=na.clientY,yD();for(var e=document.elementFromPoint(na.clientX,na.clientY),r=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(na.clientX,na.clientY),e!==r);)r=e;if(nt.parentNode[Xn]._isOutsideThisEl(e),r)do{if(r[Xn]){var n=void 0;if(n=r[Xn]._onDragOver({clientX:na.clientX,clientY:na.clientY,target:e,rootEl:r}),n&&!this.options.dragoverBubble)break}e=r}while(r=r.parentNode);xD()}},_onTouchMove:function(e){if(Po){var r=this.options,n=r.fallbackTolerance,s=r.fallbackOffset,i=e.touches?e.touches[0]:e,a=Bt&&Qo(Bt,!0),o=Bt&&a&&a.a,l=Bt&&a&&a.d,c=c0&&Hn&&HS(Hn),u=(i.clientX-Po.clientX+s.x)/(o||1)+(c?c[0]-Pg[0]:0)/(o||1),f=(i.clientY-Po.clientY+s.y)/(l||1)+(c?c[1]-Pg[1]:0)/(l||1);if(!wt.active&&!ql){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Bt){a?(a.e+=u-(kg||0),a.f+=f-(Dg||0)):a={a:1,b:0,c:0,d:1,e:u,f};var h="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");vt(Bt,"webkitTransform",h),vt(Bt,"mozTransform",h),vt(Bt,"msTransform",h),vt(Bt,"transform",h),kg=u,Dg=f,na=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Bt){var e=this.options.fallbackOnBody?document.body:kr,r=Pr(nt,!0,c0,!0,e),n=this.options;if(c0){for(Hn=e;vt(Hn,"position")==="static"&&vt(Hn,"transform")==="none"&&Hn!==document;)Hn=Hn.parentNode;Hn!==document.body&&Hn!==document.documentElement?(Hn===document&&(Hn=La()),r.top+=Hn.scrollTop,r.left+=Hn.scrollLeft):Hn=La(),Pg=HS(Hn)}Bt=nt.cloneNode(!0),Fr(Bt,n.ghostClass,!1),Fr(Bt,n.fallbackClass,!0),Fr(Bt,n.dragClass,!0),vt(Bt,"transition",""),vt(Bt,"transform",""),vt(Bt,"box-sizing","border-box"),vt(Bt,"margin",0),vt(Bt,"top",r.top),vt(Bt,"left",r.left),vt(Bt,"width",r.width),vt(Bt,"height",r.height),vt(Bt,"opacity","0.8"),vt(Bt,"position",c0?"absolute":"fixed"),vt(Bt,"zIndex","100000"),vt(Bt,"pointerEvents","none"),wt.ghost=Bt,e.appendChild(Bt),vt(Bt,"transform-origin",GS/parseInt(Bt.style.width)*100+"% "+WS/parseInt(Bt.style.height)*100+"%")}},_onDragStart:function(e,r){var n=this,s=e.dataTransfer,i=n.options;if(gs("dragStart",this,{evt:e}),wt.eventCanceled){this._onDrop();return}gs("setupClone",this),wt.eventCanceled||(Br=Ox(nt),Br.draggable=!1,Br.style["will-change"]="",this._hideClone(),Fr(Br,this.options.chosenClass,!1),wt.clone=Br),n.cloneId=B0(function(){gs("clone",n),!wt.eventCanceled&&(n.options.removeCloneOnHide||kr.insertBefore(Br,nt),n._hideClone(),is({sortable:n,name:"clone"}))}),!r&&Fr(nt,i.dragClass,!0),r?(Bh=!0,n._loopId=setInterval(n._emulateDragOver,50)):(zt(document,"mouseup",n._onDrop),zt(document,"touchend",n._onDrop),zt(document,"touchcancel",n._onDrop),s&&(s.effectAllowed="move",i.setData&&i.setData.call(n,s,nt)),Kt(document,"drop",n),vt(nt,"transform","translateZ(0)")),ql=!0,n._dragStartId=B0(n._dragStarted.bind(n,r,e)),Kt(document,"selectstart",n),Iu=!0,sd&&vt(document.body,"user-select","none")},_onDragOver:function(e){var r=this.el,n=e.target,s,i,a,o=this.options,l=o.group,c=wt.active,u=o0===l,f=o.sort,h=wn||c,p,g=this,y=!1;if(r1)return;function _(L,O){gs(L,g,Ha({evt:e,isOwner:u,axis:p?"vertical":"horizontal",revert:a,dragRect:s,targetRect:i,canSort:f,fromSortable:h,target:n,completed:b,onMove:function(z,U){return u0(kr,r,nt,s,z,Pr(z),e,U)},changed:v},O))}function x(){_("dragOverAnimationCapture"),g.captureAnimationState(),g!==h&&h.captureAnimationState()}function b(L){return _("dragOverCompleted",{insertion:L}),L&&(u?c._hideClone():c._showClone(g),g!==h&&(Fr(nt,wn?wn.options.ghostClass:c.options.ghostClass,!1),Fr(nt,o.ghostClass,!0)),wn!==g&&g!==wt.active?wn=g:g===wt.active&&wn&&(wn=null),h===g&&(g._ignoreWhileAnimating=n),g.animateAll(function(){_("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(n===nt&&!nt.animated||n===r&&!n.animated)&&(Bl=null),!o.dragoverBubble&&!e.rootEl&&n!==document&&(nt.parentNode[Xn]._isOutsideThisEl(e.target),!L&&Ro(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),y=!0}function v(){ks=$r(nt),Ki=$r(nt,o.draggable),is({sortable:g,name:"change",toEl:r,newIndex:ks,newDraggableIndex:Ki,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=aa(n,o.draggable,r,!0),_("dragOver"),wt.eventCanceled)return y;if(nt.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||g._ignoreWhileAnimating===n)return b(!1);if(Bh=!1,c&&!o.disabled&&(u?f||(a=Lr!==kr):wn===this||(this.lastPutMode=o0.checkPull(this,c,nt,e))&&l.checkPut(this,c,nt,e))){if(p=this._getDirection(e,n)==="vertical",s=Pr(nt),_("dragOverValid"),wt.eventCanceled)return y;if(a)return Lr=kr,x(),this._hideClone(),_("revert"),wt.eventCanceled||(Oo?kr.insertBefore(nt,Oo):kr.appendChild(nt)),b(!0);var T=Nx(r,o.draggable);if(!T||Sle(e,p,this)&&!T.animated){if(T===nt)return b(!1);if(T&&r===e.target&&(n=T),n&&(i=Pr(n)),u0(kr,r,nt,s,n,i,e,!!n)!==!1)return x(),r.appendChild(nt),Lr=r,v(),b(!0)}else if(T&&_le(e,p,this)){var D=Oc(r,0,o,!0);if(D===nt)return b(!1);if(n=D,i=Pr(n),u0(kr,r,nt,s,n,i,e,!1)!==!1)return x(),r.insertBefore(nt,D),Lr=r,v(),b(!0)}else if(n.parentNode===r){i=Pr(n);var k=0,S,E=nt.parentNode!==r,m=!vle(nt.animated&&nt.toRect||s,n.animated&&n.toRect||i,p),A=p?"top":"left",I=VS(n,"top","top")||VS(nt,"top","top"),C=I?I.scrollTop:void 0;Bl!==n&&(S=i[A],ld=!1,l0=!m&&o.invertSwap||E),k=Ale(e,n,i,p,m?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,l0,Bl===n);var F;if(k!==0){var W=$r(nt);do W-=k,F=Lr.children[W];while(F&&(vt(F,"display")==="none"||F===Bt))}if(k===0||F===n)return b(!1);Bl=n,od=k;var P=n.nextElementSibling,R=!1;R=k===1;var N=u0(kr,r,nt,s,n,i,e,R);if(N!==!1)return(N===1||N===-1)&&(R=N===1),r1=!0,setTimeout(ble,30),x(),R&&!P?r.appendChild(nt):n.parentNode.insertBefore(nt,R?P:n),I&&pD(I,0,C-I.scrollTop),Lr=nt.parentNode,S!==void 0&&!l0&&(L0=Math.abs(S-Pr(n)[A])),v(),b(!0)}if(r.contains(nt))return b(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){zt(document,"mousemove",this._onTouchMove),zt(document,"touchmove",this._onTouchMove),zt(document,"pointermove",this._onTouchMove),zt(document,"dragover",Ro),zt(document,"mousemove",Ro),zt(document,"touchmove",Ro)},_offUpEvents:function(){var e=this.el.ownerDocument;zt(e,"mouseup",this._onDrop),zt(e,"touchend",this._onDrop),zt(e,"pointerup",this._onDrop),zt(e,"touchcancel",this._onDrop),zt(document,"selectstart",this)},_onDrop:function(e){var r=this.el,n=this.options;if(ks=$r(nt),Ki=$r(nt,n.draggable),gs("drop",this,{evt:e}),Lr=nt&&nt.parentNode,ks=$r(nt),Ki=$r(nt,n.draggable),wt.eventCanceled){this._nulling();return}ql=!1,l0=!1,ld=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),n1(this.cloneId),n1(this._dragStartId),this.nativeDraggable&&(zt(document,"drop",this),zt(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),sd&&vt(document.body,"user-select",""),vt(nt,"transform",""),e&&(Iu&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Bt&&Bt.parentNode&&Bt.parentNode.removeChild(Bt),(kr===Lr||wn&&wn.lastPutMode!=="clone")&&Br&&Br.parentNode&&Br.parentNode.removeChild(Br),nt&&(this.nativeDraggable&&zt(nt,"dragend",this),Rg(nt),nt.style["will-change"]="",Iu&&!ql&&Fr(nt,wn?wn.options.ghostClass:this.options.ghostClass,!1),Fr(nt,this.options.chosenClass,!1),is({sortable:this,name:"unchoose",toEl:Lr,newIndex:null,newDraggableIndex:null,originalEvent:e}),kr!==Lr?(ks>=0&&(is({rootEl:Lr,name:"add",toEl:Lr,fromEl:kr,originalEvent:e}),is({sortable:this,name:"remove",toEl:Lr,originalEvent:e}),is({rootEl:Lr,name:"sort",toEl:Lr,fromEl:kr,originalEvent:e}),is({sortable:this,name:"sort",toEl:Lr,originalEvent:e})),wn&&wn.save()):ks!==Jl&&ks>=0&&(is({sortable:this,name:"update",toEl:Lr,originalEvent:e}),is({sortable:this,name:"sort",toEl:Lr,originalEvent:e})),wt.active&&((ks==null||ks===-1)&&(ks=Jl,Ki=id),is({sortable:this,name:"end",toEl:Lr,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){gs("nulling",this),kr=nt=Lr=Bt=Oo=Br=M0=Yi=Po=na=Iu=ks=Ki=Jl=id=Bl=od=wn=o0=wt.dragged=wt.ghost=wt.clone=wt.active=null,$h.forEach(function(e){e.checked=!0}),$h.length=kg=Dg=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":nt&&(this._onDragOver(e),Ele(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],r,n=this.el.children,s=0,i=n.length,a=this.options;s<i;s++)r=n[s],aa(r,a.draggable,this.el,!1)&&e.push(r.getAttribute(a.dataIdAttr)||wle(r));return e},sort:function(e,r){var n={},s=this.el;this.toArray().forEach(function(i,a){var o=s.children[a];aa(o,this.options.draggable,s,!1)&&(n[i]=o)},this),r&&this.captureAnimationState(),e.forEach(function(i){n[i]&&(s.removeChild(n[i]),s.appendChild(n[i]))}),r&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,r){return aa(e,r||this.options.draggable,this.el,!1)},option:function(e,r){var n=this.options;if(r===void 0)return n[e];var s=vf.modifyOption(this,e,r);typeof s<"u"?n[e]=s:n[e]=r,e==="group"&&vD(n)},destroy:function(){gs("destroy",this);var e=this.el;e[Xn]=null,zt(e,"mousedown",this._onTapStart),zt(e,"touchstart",this._onTapStart),zt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(zt(e,"dragover",this),zt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Uh.splice(Uh.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Yi){if(gs("hideClone",this),wt.eventCanceled)return;vt(Br,"display","none"),this.options.removeCloneOnHide&&Br.parentNode&&Br.parentNode.removeChild(Br),Yi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Yi){if(gs("showClone",this),wt.eventCanceled)return;nt.parentNode==kr&&!this.options.group.revertClone?kr.insertBefore(Br,nt):Oo?kr.insertBefore(Br,Oo):kr.appendChild(Br),this.options.group.revertClone&&this.animate(nt,Br),vt(Br,"display",""),Yi=!1}}};function Ele(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function u0(t,e,r,n,s,i,a,o){var l,c=t[Xn],u=c.options.onMove,f;return window.CustomEvent&&!Ri&&!gf?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=r,l.draggedRect=n,l.related=s||e,l.relatedRect=i||Pr(e),l.willInsertAfter=o,l.originalEvent=a,t.dispatchEvent(l),u&&(f=u.call(c,l,a)),f}function Rg(t){t.draggable=!1}function ble(){r1=!1}function _le(t,e,r){var n=Pr(Oc(r.el,0,r.options,!0)),s=10;return e?t.clientX<n.left-s||t.clientY<n.top&&t.clientX<n.right:t.clientY<n.top-s||t.clientY<n.bottom&&t.clientX<n.left}function Sle(t,e,r){var n=Pr(Nx(r.el,r.options.draggable)),s=10;return e?t.clientX>n.right+s||t.clientX<=n.right&&t.clientY>n.bottom&&t.clientX>=n.left:t.clientX>n.right&&t.clientY>n.top||t.clientX<=n.right&&t.clientY>n.bottom+s}function Ale(t,e,r,n,s,i,a,o){var l=n?t.clientY:t.clientX,c=n?r.height:r.width,u=n?r.top:r.left,f=n?r.bottom:r.right,h=!1;if(!a){if(o&&L0<c*s){if(!ld&&(od===1?l>u+c*i/2:l<f-c*i/2)&&(ld=!0),ld)h=!0;else if(od===1?l<u+L0:l>f-L0)return-od}else if(l>u+c*(1-s)/2&&l<f-c*(1-s)/2)return Tle(e)}return h=h||a,h&&(l<u+c*i/2||l>f-c*i/2)?l>u+c/2?1:-1:0}function Tle(t){return $r(nt)<$r(t)?1:-1}function wle(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,r=e.length,n=0;r--;)n+=e.charCodeAt(r);return n.toString(36)}function Cle(t){$h.length=0;for(var e=t.getElementsByTagName("input"),r=e.length;r--;){var n=e[r];n.checked&&$h.push(n)}}function B0(t){return setTimeout(t,0)}function n1(t){return clearTimeout(t)}Wp&&Kt(document,"touchmove",function(t){(wt.active||ql)&&t.cancelable&&t.preventDefault()});wt.utils={on:Kt,off:zt,css:vt,find:fD,is:function(e,r){return!!aa(e,r,e,!1)},extend:ule,throttle:hD,closest:aa,toggleClass:Fr,clone:Ox,index:$r,nextTick:B0,cancelNextTick:n1,detectDirection:gD,getChild:Oc};wt.get=function(t){return t[Xn]};wt.mount=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(wt.utils=Ha(Ha({},wt.utils),n.utils)),vf.mount(n)})};wt.create=function(t,e){return new wt(t,e)};wt.version=ile;var en=[],ku,s1,a1=!1,Fg,Ng,Vh,Du;function Ile(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(r){var n=r.originalEvent;this.sortable.nativeDraggable?Kt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Kt(document,"pointermove",this._handleFallbackAutoScroll):n.touches?Kt(document,"touchmove",this._handleFallbackAutoScroll):Kt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var n=r.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?zt(document,"dragover",this._handleAutoScroll):(zt(document,"pointermove",this._handleFallbackAutoScroll),zt(document,"touchmove",this._handleFallbackAutoScroll),zt(document,"mousemove",this._handleFallbackAutoScroll)),KS(),U0(),dle()},nulling:function(){Vh=s1=ku=a1=Du=Fg=Ng=null,en.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,n){var s=this,i=(r.touches?r.touches[0]:r).clientX,a=(r.touches?r.touches[0]:r).clientY,o=document.elementFromPoint(i,a);if(Vh=r,n||this.options.forceAutoScrollFallback||gf||Ri||sd){Og(r,this.options,o,n);var l=eo(o,!0);a1&&(!Du||i!==Fg||a!==Ng)&&(Du&&KS(),Du=setInterval(function(){var c=eo(document.elementFromPoint(i,a),!0);c!==l&&(l=c,U0()),Og(r,s.options,c,n)},10),Fg=i,Ng=a)}else{if(!this.options.bubbleScroll||eo(o,!0)===La()){U0();return}Og(r,this.options,eo(o,!1),!1)}}},qs(t,{pluginName:"scroll",initializeByDefault:!0})}function U0(){en.forEach(function(t){clearInterval(t.pid)}),en=[]}function KS(){clearInterval(Du)}var Og=hD(function(t,e,r,n){if(e.scroll){var s=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,l=La(),c=!1,u;s1!==r&&(s1=r,U0(),ku=e.scroll,u=e.scrollFn,ku===!0&&(ku=eo(r,!0)));var f=0,h=ku;do{var p=h,g=Pr(p),y=g.top,_=g.bottom,x=g.left,b=g.right,v=g.width,T=g.height,D=void 0,k=void 0,S=p.scrollWidth,E=p.scrollHeight,m=vt(p),A=p.scrollLeft,I=p.scrollTop;p===l?(D=v<S&&(m.overflowX==="auto"||m.overflowX==="scroll"||m.overflowX==="visible"),k=T<E&&(m.overflowY==="auto"||m.overflowY==="scroll"||m.overflowY==="visible")):(D=v<S&&(m.overflowX==="auto"||m.overflowX==="scroll"),k=T<E&&(m.overflowY==="auto"||m.overflowY==="scroll"));var C=D&&(Math.abs(b-s)<=a&&A+v<S)-(Math.abs(x-s)<=a&&!!A),F=k&&(Math.abs(_-i)<=a&&I+T<E)-(Math.abs(y-i)<=a&&!!I);if(!en[f])for(var W=0;W<=f;W++)en[W]||(en[W]={});(en[f].vx!=C||en[f].vy!=F||en[f].el!==p)&&(en[f].el=p,en[f].vx=C,en[f].vy=F,clearInterval(en[f].pid),(C!=0||F!=0)&&(c=!0,en[f].pid=setInterval((function(){n&&this.layer===0&&wt.active._onTouchMove(Vh);var P=en[this.layer].vy?en[this.layer].vy*o:0,R=en[this.layer].vx?en[this.layer].vx*o:0;typeof u=="function"&&u.call(wt.dragged.parentNode[Xn],R,P,t,Vh,en[this.layer].el)!=="continue"||pD(en[this.layer].el,R,P)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&h!==l&&(h=eo(h,!1)));a1=c}},30),ED=function(e){var r=e.originalEvent,n=e.putSortable,s=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(r){var c=n||i;o();var u=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,f=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:s,putSortable:n}))}};function Mx(){}Mx.prototype={startIndex:null,dragStart:function(e){var r=e.oldDraggableIndex;this.startIndex=r},onSpill:function(e){var r=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var s=Oc(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(r,s):this.sortable.el.appendChild(r),this.sortable.animateAll(),n&&n.animateAll()},drop:ED};qs(Mx,{pluginName:"revertOnSpill"});function Lx(){}Lx.prototype={onSpill:function(e){var r=e.dragEl,n=e.putSortable,s=n||this.sortable;s.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),s.animateAll()},drop:ED};qs(Lx,{pluginName:"removeOnSpill"});var Us;function kle(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(r){var n=r.dragEl;Us=n},dragOverValid:function(r){var n=r.completed,s=r.target,i=r.onMove,a=r.activeSortable,o=r.changed,l=r.cancel;if(a.options.swap){var c=this.sortable.el,u=this.options;if(s&&s!==c){var f=Us;i(s)!==!1?(Fr(s,u.swapClass,!0),Us=s):Us=null,f&&f!==Us&&Fr(f,u.swapClass,!1)}o(),n(!0),l()}},drop:function(r){var n=r.activeSortable,s=r.putSortable,i=r.dragEl,a=s||this.sortable,o=this.options;Us&&Fr(Us,o.swapClass,!1),Us&&(o.swap||s&&s.options.swap)&&i!==Us&&(a.captureAnimationState(),a!==n&&n.captureAnimationState(),Dle(i,Us),a.animateAll(),a!==n&&n.animateAll())},nulling:function(){Us=null}},qs(t,{pluginName:"swap",eventProperties:function(){return{swapItem:Us}}})}function Dle(t,e){var r=t.parentNode,n=e.parentNode,s,i;!r||!n||r.isEqualNode(e)||n.isEqualNode(t)||(s=$r(t),i=$r(e),r.isEqualNode(n)&&s<i&&i++,r.insertBefore(e,r.children[s]),n.insertBefore(t,n.children[i]))}var Nt=[],Is=[],hu,sa,pu=!1,vs=!1,Ul=!1,Er,mu,d0;function Ple(){function t(e){for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));e.options.supportPointer?Kt(document,"pointerup",this._deselectMultiDrag):(Kt(document,"mouseup",this._deselectMultiDrag),Kt(document,"touchend",this._deselectMultiDrag)),Kt(document,"keydown",this._checkKeyDown),Kt(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(s,i){var a="";Nt.length&&sa===e?Nt.forEach(function(o,l){a+=(l?", ":"")+o.textContent}):a=i.textContent,s.setData("Text",a)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(r){var n=r.dragEl;Er=n},delayEnded:function(){this.isMultiDrag=~Nt.indexOf(Er)},setupClone:function(r){var n=r.sortable,s=r.cancel;if(this.isMultiDrag){for(var i=0;i<Nt.length;i++)Is.push(Ox(Nt[i])),Is[i].sortableIndex=Nt[i].sortableIndex,Is[i].draggable=!1,Is[i].style["will-change"]="",Fr(Is[i],this.options.selectedClass,!1),Nt[i]===Er&&Fr(Is[i],this.options.chosenClass,!1);n._hideClone(),s()}},clone:function(r){var n=r.sortable,s=r.rootEl,i=r.dispatchSortableEvent,a=r.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Nt.length&&sa===n&&(qS(!0,s),i("clone"),a()))},showClone:function(r){var n=r.cloneNowShown,s=r.rootEl,i=r.cancel;this.isMultiDrag&&(qS(!1,s),Is.forEach(function(a){vt(a,"display","")}),n(),d0=!1,i())},hideClone:function(r){var n=this;r.sortable;var s=r.cloneNowHidden,i=r.cancel;this.isMultiDrag&&(Is.forEach(function(a){vt(a,"display","none"),n.options.removeCloneOnHide&&a.parentNode&&a.parentNode.removeChild(a)}),s(),d0=!0,i())},dragStartGlobal:function(r){r.sortable,!this.isMultiDrag&&sa&&sa.multiDrag._deselectMultiDrag(),Nt.forEach(function(n){n.sortableIndex=$r(n)}),Nt=Nt.sort(function(n,s){return n.sortableIndex-s.sortableIndex}),Ul=!0},dragStarted:function(r){var n=this,s=r.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){Nt.forEach(function(a){a!==Er&&vt(a,"position","absolute")});var i=Pr(Er,!1,!0,!0);Nt.forEach(function(a){a!==Er&&jS(a,i)}),vs=!0,pu=!0}s.animateAll(function(){vs=!1,pu=!1,n.options.animation&&Nt.forEach(function(a){Cg(a)}),n.options.sort&&f0()})}},dragOver:function(r){var n=r.target,s=r.completed,i=r.cancel;vs&&~Nt.indexOf(n)&&(s(!1),i())},revert:function(r){var n=r.fromSortable,s=r.rootEl,i=r.sortable,a=r.dragRect;Nt.length>1&&(Nt.forEach(function(o){i.addAnimationState({target:o,rect:vs?Pr(o):a}),Cg(o),o.fromRect=a,n.removeAnimationState(o)}),vs=!1,Rle(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(r){var n=r.sortable,s=r.isOwner,i=r.insertion,a=r.activeSortable,o=r.parentEl,l=r.putSortable,c=this.options;if(i){if(s&&a._hideClone(),pu=!1,c.animation&&Nt.length>1&&(vs||!s&&!a.options.sort&&!l)){var u=Pr(Er,!1,!0,!0);Nt.forEach(function(h){h!==Er&&(jS(h,u),o.appendChild(h))}),vs=!0}if(!s)if(vs||f0(),Nt.length>1){var f=d0;a._showClone(n),a.options.animation&&!d0&&f&&Is.forEach(function(h){a.addAnimationState({target:h,rect:mu}),h.fromRect=mu,h.thisAnimationDuration=null})}else a._showClone(n)}},dragOverAnimationCapture:function(r){var n=r.dragRect,s=r.isOwner,i=r.activeSortable;if(Nt.forEach(function(o){o.thisAnimationDuration=null}),i.options.animation&&!s&&i.multiDrag.isMultiDrag){mu=qs({},n);var a=Qo(Er,!0);mu.top-=a.f,mu.left-=a.e}},dragOverAnimationComplete:function(){vs&&(vs=!1,f0())},drop:function(r){var n=r.originalEvent,s=r.rootEl,i=r.parentEl,a=r.sortable,o=r.dispatchSortableEvent,l=r.oldIndex,c=r.putSortable,u=c||this.sortable;if(n){var f=this.options,h=i.children;if(!Ul)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Fr(Er,f.selectedClass,!~Nt.indexOf(Er)),~Nt.indexOf(Er))Nt.splice(Nt.indexOf(Er),1),hu=null,Cu({sortable:a,rootEl:s,name:"deselect",targetEl:Er});else{if(Nt.push(Er),Cu({sortable:a,rootEl:s,name:"select",targetEl:Er}),n.shiftKey&&hu&&a.el.contains(hu)){var p=$r(hu),g=$r(Er);if(~p&&~g&&p!==g){var y,_;for(g>p?(_=p,y=g):(_=g,y=p+1);_<y;_++)~Nt.indexOf(h[_])||(Fr(h[_],f.selectedClass,!0),Nt.push(h[_]),Cu({sortable:a,rootEl:s,name:"select",targetEl:h[_]}))}}else hu=Er;sa=u}if(Ul&&this.isMultiDrag){if(vs=!1,(i[Xn].options.sort||i!==s)&&Nt.length>1){var x=Pr(Er),b=$r(Er,":not(."+this.options.selectedClass+")");if(!pu&&f.animation&&(Er.thisAnimationDuration=null),u.captureAnimationState(),!pu&&(f.animation&&(Er.fromRect=x,Nt.forEach(function(T){if(T.thisAnimationDuration=null,T!==Er){var D=vs?Pr(T):x;T.fromRect=D,u.addAnimationState({target:T,rect:D})}})),f0(),Nt.forEach(function(T){h[b]?i.insertBefore(T,h[b]):i.appendChild(T),b++}),l===$r(Er))){var v=!1;Nt.forEach(function(T){if(T.sortableIndex!==$r(T)){v=!0;return}}),v&&o("update")}Nt.forEach(function(T){Cg(T)}),u.animateAll()}sa=u}(s===i||c&&c.lastPutMode!=="clone")&&Is.forEach(function(T){T.parentNode&&T.parentNode.removeChild(T)})}},nullingGlobal:function(){this.isMultiDrag=Ul=!1,Is.length=0},destroyGlobal:function(){this._deselectMultiDrag(),zt(document,"pointerup",this._deselectMultiDrag),zt(document,"mouseup",this._deselectMultiDrag),zt(document,"touchend",this._deselectMultiDrag),zt(document,"keydown",this._checkKeyDown),zt(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(r){if(!(typeof Ul<"u"&&Ul)&&sa===this.sortable&&!(r&&aa(r.target,this.options.draggable,this.sortable.el,!1))&&!(r&&r.button!==0))for(;Nt.length;){var n=Nt[0];Fr(n,this.options.selectedClass,!1),Nt.shift(),Cu({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:n})}},_checkKeyDown:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},qs(t,{pluginName:"multiDrag",utils:{select:function(r){var n=r.parentNode[Xn];!n||!n.options.multiDrag||~Nt.indexOf(r)||(sa&&sa!==n&&(sa.multiDrag._deselectMultiDrag(),sa=n),Fr(r,n.options.selectedClass,!0),Nt.push(r))},deselect:function(r){var n=r.parentNode[Xn],s=Nt.indexOf(r);!n||!n.options.multiDrag||!~s||(Fr(r,n.options.selectedClass,!1),Nt.splice(s,1))}},eventProperties:function(){var r=this,n=[],s=[];return Nt.forEach(function(i){n.push({multiDragElement:i,index:i.sortableIndex});var a;vs&&i!==Er?a=-1:vs?a=$r(i,":not(."+r.options.selectedClass+")"):a=$r(i),s.push({multiDragElement:i,index:a})}),{items:tle(Nt),clones:[].concat(Is),oldIndicies:n,newIndicies:s}},optionListeners:{multiDragKey:function(r){return r=r.toLowerCase(),r==="ctrl"?r="Control":r.length>1&&(r=r.charAt(0).toUpperCase()+r.substr(1)),r}}})}function Rle(t,e){Nt.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function qS(t,e){Is.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function f0(){Nt.forEach(function(t){t!==Er&&t.parentNode&&t.parentNode.removeChild(t)})}wt.mount(new Ile);wt.mount(Lx,Mx);const Fle=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:Ple,Sortable:wt,Swap:kle,default:wt},Symbol.toStringTag,{value:"Module"})),Nle=rx(Fle);(function(t,e){(function(n,s){t.exports=s(Qoe,Nle)})(typeof self<"u"?self:jt,function(r,n){return function(s){var i={};function a(o){if(i[o])return i[o].exports;var l=i[o]={i:o,l:!1,exports:{}};return s[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=s,a.c=i,a.d=function(o,l,c){a.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,l){if(l&1&&(o=a(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var u in o)a.d(c,u,(function(f){return o[f]}).bind(null,u));return c},a.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(l,"a",l),l},a.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},a.p="",a(a.s="fb15")}({"00ee":function(s,i,a){var o=a("b622"),l=o("toStringTag"),c={};c[l]="z",s.exports=String(c)==="[object z]"},"0366":function(s,i,a){var o=a("1c0b");s.exports=function(l,c,u){if(o(l),c===void 0)return l;switch(u){case 0:return function(){return l.call(c)};case 1:return function(f){return l.call(c,f)};case 2:return function(f,h){return l.call(c,f,h)};case 3:return function(f,h,p){return l.call(c,f,h,p)}}return function(){return l.apply(c,arguments)}}},"057f":function(s,i,a){var o=a("fc6a"),l=a("241c").f,c={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(h){try{return l(h)}catch{return u.slice()}};s.exports.f=function(p){return u&&c.call(p)=="[object Window]"?f(p):l(o(p))}},"06cf":function(s,i,a){var o=a("83ab"),l=a("d1e7"),c=a("5c6c"),u=a("fc6a"),f=a("c04e"),h=a("5135"),p=a("0cfb"),g=Object.getOwnPropertyDescriptor;i.f=o?g:function(_,x){if(_=u(_),x=f(x,!0),p)try{return g(_,x)}catch{}if(h(_,x))return c(!l.f.call(_,x),_[x])}},"0cfb":function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("cc12");s.exports=!o&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(s,i,a){var o=a("23e7"),l=a("d58f").left,c=a("a640"),u=a("ae40"),f=c("reduce"),h=u("reduce",{1:0});o({target:"Array",proto:!0,forced:!f||!h},{reduce:function(g){return l(this,g,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(s,i,a){var o=a("c6b6"),l=a("9263");s.exports=function(c,u){var f=c.exec;if(typeof f=="function"){var h=f.call(c,u);if(typeof h!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return h}if(o(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(c,u)}},"159b":function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("17c2"),u=a("9112");for(var f in l){var h=o[f],p=h&&h.prototype;if(p&&p.forEach!==c)try{u(p,"forEach",c)}catch{p.forEach=c}}},"17c2":function(s,i,a){var o=a("b727").forEach,l=a("a640"),c=a("ae40"),u=l("forEach"),f=c("forEach");s.exports=!u||!f?function(p){return o(this,p,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(s,i,a){var o=a("d066");s.exports=o("document","documentElement")},"1c0b":function(s,i){s.exports=function(a){if(typeof a!="function")throw TypeError(String(a)+" is not a function");return a}},"1c7e":function(s,i,a){var o=a("b622"),l=o("iterator"),c=!1;try{var u=0,f={next:function(){return{done:!!u++}},return:function(){c=!0}};f[l]=function(){return this},Array.from(f,function(){throw 2})}catch{}s.exports=function(h,p){if(!p&&!c)return!1;var g=!1;try{var y={};y[l]=function(){return{next:function(){return{done:g=!0}}}},h(y)}catch{}return g}},"1d80":function(s,i){s.exports=function(a){if(a==null)throw TypeError("Can't call method on "+a);return a}},"1dde":function(s,i,a){var o=a("d039"),l=a("b622"),c=a("2d00"),u=l("species");s.exports=function(f){return c>=51||!o(function(){var h=[],p=h.constructor={};return p[u]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},"23cb":function(s,i,a){var o=a("a691"),l=Math.max,c=Math.min;s.exports=function(u,f){var h=o(u);return h<0?l(h+f,0):c(h,f)}},"23e7":function(s,i,a){var o=a("da84"),l=a("06cf").f,c=a("9112"),u=a("6eeb"),f=a("ce4e"),h=a("e893"),p=a("94ca");s.exports=function(g,y){var _=g.target,x=g.global,b=g.stat,v,T,D,k,S,E;if(x?T=o:b?T=o[_]||f(_,{}):T=(o[_]||{}).prototype,T)for(D in y){if(S=y[D],g.noTargetGet?(E=l(T,D),k=E&&E.value):k=T[D],v=p(x?D:_+(b?".":"#")+D,g.forced),!v&&k!==void 0){if(typeof S==typeof k)continue;h(S,k)}(g.sham||k&&k.sham)&&c(S,"sham",!0),u(T,D,S,g)}}},"241c":function(s,i,a){var o=a("ca84"),l=a("7839"),c=l.concat("length","prototype");i.f=Object.getOwnPropertyNames||function(f){return o(f,c)}},"25f0":function(s,i,a){var o=a("6eeb"),l=a("825a"),c=a("d039"),u=a("ad6d"),f="toString",h=RegExp.prototype,p=h[f],g=c(function(){return p.call({source:"a",flags:"b"})!="/a/b"}),y=p.name!=f;(g||y)&&o(RegExp.prototype,f,function(){var x=l(this),b=String(x.source),v=x.flags,T=String(v===void 0&&x instanceof RegExp&&!("flags"in h)?u.call(x):v);return"/"+b+"/"+T},{unsafe:!0})},"2ca0":function(s,i,a){var o=a("23e7"),l=a("06cf").f,c=a("50c4"),u=a("5a34"),f=a("1d80"),h=a("ab13"),p=a("c430"),g="".startsWith,y=Math.min,_=h("startsWith"),x=!p&&!_&&!!function(){var b=l(String.prototype,"startsWith");return b&&!b.writable}();o({target:"String",proto:!0,forced:!x&&!_},{startsWith:function(v){var T=String(f(this));u(v);var D=c(y(arguments.length>1?arguments[1]:void 0,T.length)),k=String(v);return g?g.call(T,k,D):T.slice(D,D+k.length)===k}})},"2d00":function(s,i,a){var o=a("da84"),l=a("342f"),c=o.process,u=c&&c.versions,f=u&&u.v8,h,p;f?(h=f.split("."),p=h[0]+h[1]):l&&(h=l.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=l.match(/Chrome\/(\d+)/),h&&(p=h[1]))),s.exports=p&&+p},"342f":function(s,i,a){var o=a("d066");s.exports=o("navigator","userAgent")||""},"35a1":function(s,i,a){var o=a("f5df"),l=a("3f8c"),c=a("b622"),u=c("iterator");s.exports=function(f){if(f!=null)return f[u]||f["@@iterator"]||l[o(f)]}},"37e8":function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("825a"),u=a("df75");s.exports=o?Object.defineProperties:function(h,p){c(h);for(var g=u(p),y=g.length,_=0,x;y>_;)l.f(h,x=g[_++],p[x]);return h}},"3bbe":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype");return l}},"3ca3":function(s,i,a){var o=a("6547").charAt,l=a("69f3"),c=a("7dd0"),u="String Iterator",f=l.set,h=l.getterFor(u);c(String,"String",function(p){f(this,{type:u,string:String(p),index:0})},function(){var g=h(this),y=g.string,_=g.index,x;return _>=y.length?{value:void 0,done:!0}:(x=o(y,_),g.index+=x.length,{value:x,done:!1})})},"3f8c":function(s,i){s.exports={}},4160:function(s,i,a){var o=a("23e7"),l=a("17c2");o({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},"428f":function(s,i,a){var o=a("da84");s.exports=o},"44ad":function(s,i,a){var o=a("d039"),l=a("c6b6"),c="".split;s.exports=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return l(u)=="String"?c.call(u,""):Object(u)}:Object},"44d2":function(s,i,a){var o=a("b622"),l=a("7c73"),c=a("9bf2"),u=o("unscopables"),f=Array.prototype;f[u]==null&&c.f(f,u,{configurable:!0,value:l(null)}),s.exports=function(h){f[u][h]=!0}},"44e7":function(s,i,a){var o=a("861d"),l=a("c6b6"),c=a("b622"),u=c("match");s.exports=function(f){var h;return o(f)&&((h=f[u])!==void 0?!!h:l(f)=="RegExp")}},4930:function(s,i,a){var o=a("d039");s.exports=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())})},"4d64":function(s,i,a){var o=a("fc6a"),l=a("50c4"),c=a("23cb"),u=function(f){return function(h,p,g){var y=o(h),_=l(y.length),x=c(g,_),b;if(f&&p!=p){for(;_>x;)if(b=y[x++],b!=b)return!0}else for(;_>x;x++)if((f||x in y)&&y[x]===p)return f||x||0;return!f&&-1}};s.exports={includes:u(!0),indexOf:u(!1)}},"4de4":function(s,i,a){var o=a("23e7"),l=a("b727").filter,c=a("1dde"),u=a("ae40"),f=c("filter"),h=u("filter");o({target:"Array",proto:!0,forced:!f||!h},{filter:function(g){return l(this,g,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(s,i,a){var o=a("0366"),l=a("7b0b"),c=a("9bdd"),u=a("e95a"),f=a("50c4"),h=a("8418"),p=a("35a1");s.exports=function(y){var _=l(y),x=typeof this=="function"?this:Array,b=arguments.length,v=b>1?arguments[1]:void 0,T=v!==void 0,D=p(_),k=0,S,E,m,A,I,C;if(T&&(v=o(v,b>2?arguments[2]:void 0,2)),D!=null&&!(x==Array&&u(D)))for(A=D.call(_),I=A.next,E=new x;!(m=I.call(A)).done;k++)C=T?c(A,v,[m.value,k],!0):m.value,h(E,k,C);else for(S=f(_.length),E=new x(S);S>k;k++)C=T?v(_[k],k):_[k],h(E,k,C);return E.length=k,E}},"4fad":function(s,i,a){var o=a("23e7"),l=a("6f53").entries;o({target:"Object",stat:!0},{entries:function(u){return l(u)}})},"50c4":function(s,i,a){var o=a("a691"),l=Math.min;s.exports=function(c){return c>0?l(o(c),9007199254740991):0}},5135:function(s,i){var a={}.hasOwnProperty;s.exports=function(o,l){return a.call(o,l)}},5319:function(s,i,a){var o=a("d784"),l=a("825a"),c=a("7b0b"),u=a("50c4"),f=a("a691"),h=a("1d80"),p=a("8aa5"),g=a("14c3"),y=Math.max,_=Math.min,x=Math.floor,b=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g,T=function(D){return D===void 0?D:String(D)};o("replace",2,function(D,k,S,E){var m=E.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,A=E.REPLACE_KEEPS_$0,I=m?"$":"$0";return[function(W,P){var R=h(this),N=W==null?void 0:W[D];return N!==void 0?N.call(W,R,P):k.call(String(R),W,P)},function(F,W){if(!m&&A||typeof W=="string"&&W.indexOf(I)===-1){var P=S(k,F,this,W);if(P.done)return P.value}var R=l(F),N=String(this),L=typeof W=="function";L||(W=String(W));var O=R.global;if(O){var V=R.unicode;R.lastIndex=0}for(var z=[];;){var U=g(R,N);if(U===null||(z.push(U),!O))break;var G=String(U[0]);G===""&&(R.lastIndex=p(N,u(R.lastIndex),V))}for(var j="",ee=0,ae=0;ae<z.length;ae++){U=z[ae];for(var ne=String(U[0]),le=y(_(f(U.index),N.length),0),Z=[],J=1;J<U.length;J++)Z.push(T(U[J]));var ge=U.groups;if(L){var te=[ne].concat(Z,le,N);ge!==void 0&&te.push(ge);var K=String(W.apply(void 0,te))}else K=C(ne,N,le,Z,ge,W);le>=ee&&(j+=N.slice(ee,le)+K,ee=le+ne.length)}return j+N.slice(ee)}];function C(F,W,P,R,N,L){var O=P+F.length,V=R.length,z=v;return N!==void 0&&(N=c(N),z=b),k.call(L,z,function(U,G){var j;switch(G.charAt(0)){case"$":return"$";case"&":return F;case"`":return W.slice(0,P);case"'":return W.slice(O);case"<":j=N[G.slice(1,-1)];break;default:var ee=+G;if(ee===0)return U;if(ee>V){var ae=x(ee/10);return ae===0?U:ae<=V?R[ae-1]===void 0?G.charAt(1):R[ae-1]+G.charAt(1):U}j=R[ee-1]}return j===void 0?"":j})}})},5692:function(s,i,a){var o=a("c430"),l=a("c6cd");(s.exports=function(c,u){return l[c]||(l[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:o?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(s,i,a){var o=a("d066"),l=a("241c"),c=a("7418"),u=a("825a");s.exports=o("Reflect","ownKeys")||function(h){var p=l.f(u(h)),g=c.f;return g?p.concat(g(h)):p}},"5a34":function(s,i,a){var o=a("44e7");s.exports=function(l){if(o(l))throw TypeError("The method doesn't accept regular expressions");return l}},"5c6c":function(s,i){s.exports=function(a,o){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:o}}},"5db7":function(s,i,a){var o=a("23e7"),l=a("a2bf"),c=a("7b0b"),u=a("50c4"),f=a("1c0b"),h=a("65f0");o({target:"Array",proto:!0},{flatMap:function(g){var y=c(this),_=u(y.length),x;return f(g),x=h(y,0),x.length=l(x,y,y,_,0,1,g,arguments.length>1?arguments[1]:void 0),x}})},6547:function(s,i,a){var o=a("a691"),l=a("1d80"),c=function(u){return function(f,h){var p=String(l(f)),g=o(h),y=p.length,_,x;return g<0||g>=y?u?"":void 0:(_=p.charCodeAt(g),_<55296||_>56319||g+1===y||(x=p.charCodeAt(g+1))<56320||x>57343?u?p.charAt(g):_:u?p.slice(g,g+2):(_-55296<<10)+(x-56320)+65536)}};s.exports={codeAt:c(!1),charAt:c(!0)}},"65f0":function(s,i,a){var o=a("861d"),l=a("e8b5"),c=a("b622"),u=c("species");s.exports=function(f,h){var p;return l(f)&&(p=f.constructor,typeof p=="function"&&(p===Array||l(p.prototype))?p=void 0:o(p)&&(p=p[u],p===null&&(p=void 0))),new(p===void 0?Array:p)(h===0?0:h)}},"69f3":function(s,i,a){var o=a("7f9a"),l=a("da84"),c=a("861d"),u=a("9112"),f=a("5135"),h=a("f772"),p=a("d012"),g=l.WeakMap,y,_,x,b=function(m){return x(m)?_(m):y(m,{})},v=function(m){return function(A){var I;if(!c(A)||(I=_(A)).type!==m)throw TypeError("Incompatible receiver, "+m+" required");return I}};if(o){var T=new g,D=T.get,k=T.has,S=T.set;y=function(m,A){return S.call(T,m,A),A},_=function(m){return D.call(T,m)||{}},x=function(m){return k.call(T,m)}}else{var E=h("state");p[E]=!0,y=function(m,A){return u(m,E,A),A},_=function(m){return f(m,E)?m[E]:{}},x=function(m){return f(m,E)}}s.exports={set:y,get:_,has:x,enforce:b,getterFor:v}},"6eeb":function(s,i,a){var o=a("da84"),l=a("9112"),c=a("5135"),u=a("ce4e"),f=a("8925"),h=a("69f3"),p=h.get,g=h.enforce,y=String(String).split("String");(s.exports=function(_,x,b,v){var T=v?!!v.unsafe:!1,D=v?!!v.enumerable:!1,k=v?!!v.noTargetGet:!1;if(typeof b=="function"&&(typeof x=="string"&&!c(b,"name")&&l(b,"name",x),g(b).source=y.join(typeof x=="string"?x:"")),_===o){D?_[x]=b:u(x,b);return}else T?!k&&_[x]&&(D=!0):delete _[x];D?_[x]=b:l(_,x,b)})(Function.prototype,"toString",function(){return typeof this=="function"&&p(this).source||f(this)})},"6f53":function(s,i,a){var o=a("83ab"),l=a("df75"),c=a("fc6a"),u=a("d1e7").f,f=function(h){return function(p){for(var g=c(p),y=l(g),_=y.length,x=0,b=[],v;_>x;)v=y[x++],(!o||u.call(g,v))&&b.push(h?[v,g[v]]:g[v]);return b}};s.exports={entries:f(!0),values:f(!1)}},"73d9":function(s,i,a){var o=a("44d2");o("flatMap")},7418:function(s,i){i.f=Object.getOwnPropertySymbols},"746f":function(s,i,a){var o=a("428f"),l=a("5135"),c=a("e538"),u=a("9bf2").f;s.exports=function(f){var h=o.Symbol||(o.Symbol={});l(h,f)||u(h,f,{value:c.f(f)})}},7839:function(s,i){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(s,i,a){var o=a("1d80");s.exports=function(l){return Object(o(l))}},"7c73":function(s,i,a){var o=a("825a"),l=a("37e8"),c=a("7839"),u=a("d012"),f=a("1be4"),h=a("cc12"),p=a("f772"),g=">",y="<",_="prototype",x="script",b=p("IE_PROTO"),v=function(){},T=function(m){return y+x+g+m+y+"/"+x+g},D=function(m){m.write(T("")),m.close();var A=m.parentWindow.Object;return m=null,A},k=function(){var m=h("iframe"),A="java"+x+":",I;return m.style.display="none",f.appendChild(m),m.src=String(A),I=m.contentWindow.document,I.open(),I.write(T("document.F=Object")),I.close(),I.F},S,E=function(){try{S=document.domain&&new ActiveXObject("htmlfile")}catch{}E=S?D(S):k();for(var m=c.length;m--;)delete E[_][c[m]];return E()};u[b]=!0,s.exports=Object.create||function(A,I){var C;return A!==null?(v[_]=o(A),C=new v,v[_]=null,C[b]=A):C=E(),I===void 0?C:l(C,I)}},"7dd0":function(s,i,a){var o=a("23e7"),l=a("9ed3"),c=a("e163"),u=a("d2bb"),f=a("d44e"),h=a("9112"),p=a("6eeb"),g=a("b622"),y=a("c430"),_=a("3f8c"),x=a("ae93"),b=x.IteratorPrototype,v=x.BUGGY_SAFARI_ITERATORS,T=g("iterator"),D="keys",k="values",S="entries",E=function(){return this};s.exports=function(m,A,I,C,F,W,P){l(I,A,C);var R=function(ae){if(ae===F&&z)return z;if(!v&&ae in O)return O[ae];switch(ae){case D:return function(){return new I(this,ae)};case k:return function(){return new I(this,ae)};case S:return function(){return new I(this,ae)}}return function(){return new I(this)}},N=A+" Iterator",L=!1,O=m.prototype,V=O[T]||O["@@iterator"]||F&&O[F],z=!v&&V||R(F),U=A=="Array"&&O.entries||V,G,j,ee;if(U&&(G=c(U.call(new m)),b!==Object.prototype&&G.next&&(!y&&c(G)!==b&&(u?u(G,b):typeof G[T]!="function"&&h(G,T,E)),f(G,N,!0,!0),y&&(_[N]=E))),F==k&&V&&V.name!==k&&(L=!0,z=function(){return V.call(this)}),(!y||P)&&O[T]!==z&&h(O,T,z),_[A]=z,F)if(j={values:R(k),keys:W?z:R(D),entries:R(S)},P)for(ee in j)(v||L||!(ee in O))&&p(O,ee,j[ee]);else o({target:A,proto:!0,forced:v||L},j);return j}},"7f9a":function(s,i,a){var o=a("da84"),l=a("8925"),c=o.WeakMap;s.exports=typeof c=="function"&&/native code/.test(l(c))},"825a":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l))throw TypeError(String(l)+" is not an object");return l}},"83ab":function(s,i,a){var o=a("d039");s.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(s,i,a){var o=a("c04e"),l=a("9bf2"),c=a("5c6c");s.exports=function(u,f,h){var p=o(f);p in u?l.f(u,p,c(0,h)):u[p]=h}},"861d":function(s,i){s.exports=function(a){return typeof a=="object"?a!==null:typeof a=="function"}},8875:function(s,i,a){var o,l,c;(function(u,f){l=[],o=f,c=typeof o=="function"?o.apply(i,l):o,c!==void 0&&(s.exports=c)})(typeof self<"u"?self:this,function(){function u(){var f=Object.getOwnPropertyDescriptor(document,"currentScript");if(!f&&"currentScript"in document&&document.currentScript||f&&f.get!==u&&document.currentScript)return document.currentScript;try{throw new Error}catch(S){var h=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,p=/@([^@]*):(\d+):(\d+)\s*$/ig,g=h.exec(S.stack)||p.exec(S.stack),y=g&&g[1]||!1,_=g&&g[2]||!1,x=document.location.href.replace(document.location.hash,""),b,v,T,D=document.getElementsByTagName("script");y===x&&(b=document.documentElement.outerHTML,v=new RegExp("(?:[^\\n]+?\\n){0,"+(_-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),T=b.replace(v,"$1").trim());for(var k=0;k<D.length;k++)if(D[k].readyState==="interactive"||D[k].src===y||y===x&&D[k].innerHTML&&D[k].innerHTML.trim()===T)return D[k];return null}}return u})},8925:function(s,i,a){var o=a("c6cd"),l=Function.toString;typeof o.inspectSource!="function"&&(o.inspectSource=function(c){return l.call(c)}),s.exports=o.inspectSource},"8aa5":function(s,i,a){var o=a("6547").charAt;s.exports=function(l,c,u){return c+(u?o(l,c).length:1)}},"8bbf":function(s,i){s.exports=r},"90e3":function(s,i){var a=0,o=Math.random();s.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++a+o).toString(36)}},9112:function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("5c6c");s.exports=o?function(u,f,h){return l.f(u,f,c(1,h))}:function(u,f,h){return u[f]=h,u}},9263:function(s,i,a){var o=a("ad6d"),l=a("9f7f"),c=RegExp.prototype.exec,u=String.prototype.replace,f=c,h=function(){var _=/a/,x=/b*/g;return c.call(_,"a"),c.call(x,"a"),_.lastIndex!==0||x.lastIndex!==0}(),p=l.UNSUPPORTED_Y||l.BROKEN_CARET,g=/()??/.exec("")[1]!==void 0,y=h||g||p;y&&(f=function(x){var b=this,v,T,D,k,S=p&&b.sticky,E=o.call(b),m=b.source,A=0,I=x;return S&&(E=E.replace("y",""),E.indexOf("g")===-1&&(E+="g"),I=String(x).slice(b.lastIndex),b.lastIndex>0&&(!b.multiline||b.multiline&&x[b.lastIndex-1]!==`
`)&&(m="(?: "+m+")",I=" "+I,A++),T=new RegExp("^(?:"+m+")",E)),g&&(T=new RegExp("^"+m+"$(?!\\s)",E)),h&&(v=b.lastIndex),D=c.call(S?T:b,I),S?D?(D.input=D.input.slice(A),D[0]=D[0].slice(A),D.index=b.lastIndex,b.lastIndex+=D[0].length):b.lastIndex=0:h&&D&&(b.lastIndex=b.global?D.index+D[0].length:v),g&&D&&D.length>1&&u.call(D[0],T,function(){for(k=1;k<arguments.length-2;k++)arguments[k]===void 0&&(D[k]=void 0)}),D}),s.exports=f},"94ca":function(s,i,a){var o=a("d039"),l=/#|\.prototype\./,c=function(g,y){var _=f[u(g)];return _==p?!0:_==h?!1:typeof y=="function"?o(y):!!y},u=c.normalize=function(g){return String(g).replace(l,".").toLowerCase()},f=c.data={},h=c.NATIVE="N",p=c.POLYFILL="P";s.exports=c},"99af":function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("e8b5"),u=a("861d"),f=a("7b0b"),h=a("50c4"),p=a("8418"),g=a("65f0"),y=a("1dde"),_=a("b622"),x=a("2d00"),b=_("isConcatSpreadable"),v=9007199254740991,T="Maximum allowed index exceeded",D=x>=51||!l(function(){var m=[];return m[b]=!1,m.concat()[0]!==m}),k=y("concat"),S=function(m){if(!u(m))return!1;var A=m[b];return A!==void 0?!!A:c(m)},E=!D||!k;o({target:"Array",proto:!0,forced:E},{concat:function(A){var I=f(this),C=g(I,0),F=0,W,P,R,N,L;for(W=-1,R=arguments.length;W<R;W++)if(L=W===-1?I:arguments[W],S(L)){if(N=h(L.length),F+N>v)throw TypeError(T);for(P=0;P<N;P++,F++)P in L&&p(C,F,L[P])}else{if(F>=v)throw TypeError(T);p(C,F++,L)}return C.length=F,C}})},"9bdd":function(s,i,a){var o=a("825a");s.exports=function(l,c,u,f){try{return f?c(o(u)[0],u[1]):c(u)}catch(p){var h=l.return;throw h!==void 0&&o(h.call(l)),p}}},"9bf2":function(s,i,a){var o=a("83ab"),l=a("0cfb"),c=a("825a"),u=a("c04e"),f=Object.defineProperty;i.f=o?f:function(p,g,y){if(c(p),g=u(g,!0),c(y),l)try{return f(p,g,y)}catch{}if("get"in y||"set"in y)throw TypeError("Accessors not supported");return"value"in y&&(p[g]=y.value),p}},"9ed3":function(s,i,a){var o=a("ae93").IteratorPrototype,l=a("7c73"),c=a("5c6c"),u=a("d44e"),f=a("3f8c"),h=function(){return this};s.exports=function(p,g,y){var _=g+" Iterator";return p.prototype=l(o,{next:c(1,y)}),u(p,_,!1,!0),f[_]=h,p}},"9f7f":function(s,i,a){var o=a("d039");function l(c,u){return RegExp(c,u)}i.UNSUPPORTED_Y=o(function(){var c=l("a","y");return c.lastIndex=2,c.exec("abcd")!=null}),i.BROKEN_CARET=o(function(){var c=l("^r","gy");return c.lastIndex=2,c.exec("str")!=null})},a2bf:function(s,i,a){var o=a("e8b5"),l=a("50c4"),c=a("0366"),u=function(f,h,p,g,y,_,x,b){for(var v=y,T=0,D=x?c(x,b,3):!1,k;T<g;){if(T in p){if(k=D?D(p[T],T,h):p[T],_>0&&o(k))v=u(f,h,k,l(k.length),v,_-1)-1;else{if(v>=9007199254740991)throw TypeError("Exceed the acceptable array length");f[v]=k}v++}T++}return v};s.exports=u},a352:function(s,i){s.exports=n},a434:function(s,i,a){var o=a("23e7"),l=a("23cb"),c=a("a691"),u=a("50c4"),f=a("7b0b"),h=a("65f0"),p=a("8418"),g=a("1dde"),y=a("ae40"),_=g("splice"),x=y("splice",{ACCESSORS:!0,0:0,1:2}),b=Math.max,v=Math.min,T=9007199254740991,D="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!_||!x},{splice:function(S,E){var m=f(this),A=u(m.length),I=l(S,A),C=arguments.length,F,W,P,R,N,L;if(C===0?F=W=0:C===1?(F=0,W=A-I):(F=C-2,W=v(b(c(E),0),A-I)),A+F-W>T)throw TypeError(D);for(P=h(m,W),R=0;R<W;R++)N=I+R,N in m&&p(P,R,m[N]);if(P.length=W,F<W){for(R=I;R<A-W;R++)N=R+W,L=R+F,N in m?m[L]=m[N]:delete m[L];for(R=A;R>A-W+F;R--)delete m[R-1]}else if(F>W)for(R=A-W;R>I;R--)N=R+W-1,L=R+F-1,N in m?m[L]=m[N]:delete m[L];for(R=0;R<F;R++)m[R+I]=arguments[R+2];return m.length=A-W+F,P}})},a4d3:function(s,i,a){var o=a("23e7"),l=a("da84"),c=a("d066"),u=a("c430"),f=a("83ab"),h=a("4930"),p=a("fdbf"),g=a("d039"),y=a("5135"),_=a("e8b5"),x=a("861d"),b=a("825a"),v=a("7b0b"),T=a("fc6a"),D=a("c04e"),k=a("5c6c"),S=a("7c73"),E=a("df75"),m=a("241c"),A=a("057f"),I=a("7418"),C=a("06cf"),F=a("9bf2"),W=a("d1e7"),P=a("9112"),R=a("6eeb"),N=a("5692"),L=a("f772"),O=a("d012"),V=a("90e3"),z=a("b622"),U=a("e538"),G=a("746f"),j=a("d44e"),ee=a("69f3"),ae=a("b727").forEach,ne=L("hidden"),le="Symbol",Z="prototype",J=z("toPrimitive"),ge=ee.set,te=ee.getterFor(le),K=Object[Z],Y=l.Symbol,fe=c("JSON","stringify"),ye=C.f,ie=F.f,ue=A.f,Ee=W.f,Ce=N("symbols"),Pe=N("op-symbols"),Te=N("string-to-symbol-registry"),ze=N("symbol-to-string-registry"),Ie=N("wks"),be=l.QObject,Me=!be||!be[Z]||!be[Z].findChild,Ke=f&&g(function(){return S(ie({},"a",{get:function(){return ie(this,"a",{value:7}).a}})).a!=7})?function(pt,ct,mt){var Ct=ye(K,ct);Ct&&delete K[ct],ie(pt,ct,mt),Ct&&pt!==K&&ie(K,ct,Ct)}:ie,qe=function(pt,ct){var mt=Ce[pt]=S(Y[Z]);return ge(mt,{type:le,tag:pt,description:ct}),f||(mt.description=ct),mt},Se=p?function(pt){return typeof pt=="symbol"}:function(pt){return Object(pt)instanceof Y},xe=function(ct,mt,Ct){ct===K&&xe(Pe,mt,Ct),b(ct);var Rt=D(mt,!0);return b(Ct),y(Ce,Rt)?(Ct.enumerable?(y(ct,ne)&&ct[ne][Rt]&&(ct[ne][Rt]=!1),Ct=S(Ct,{enumerable:k(0,!1)})):(y(ct,ne)||ie(ct,ne,k(1,{})),ct[ne][Rt]=!0),Ke(ct,Rt,Ct)):ie(ct,Rt,Ct)},Ae=function(ct,mt){b(ct);var Ct=T(mt),Rt=E(Ct).concat(xt(Ct));return ae(Rt,function(mr){(!f||We.call(Ct,mr))&&xe(ct,mr,Ct[mr])}),ct},Le=function(ct,mt){return mt===void 0?S(ct):Ae(S(ct),mt)},We=function(ct){var mt=D(ct,!0),Ct=Ee.call(this,mt);return this===K&&y(Ce,mt)&&!y(Pe,mt)?!1:Ct||!y(this,mt)||!y(Ce,mt)||y(this,ne)&&this[ne][mt]?Ct:!0},$e=function(ct,mt){var Ct=T(ct),Rt=D(mt,!0);if(!(Ct===K&&y(Ce,Rt)&&!y(Pe,Rt))){var mr=ye(Ct,Rt);return mr&&y(Ce,Rt)&&!(y(Ct,ne)&&Ct[ne][Rt])&&(mr.enumerable=!0),mr}},dt=function(ct){var mt=ue(T(ct)),Ct=[];return ae(mt,function(Rt){!y(Ce,Rt)&&!y(O,Rt)&&Ct.push(Rt)}),Ct},xt=function(ct){var mt=ct===K,Ct=ue(mt?Pe:T(ct)),Rt=[];return ae(Ct,function(mr){y(Ce,mr)&&(!mt||y(K,mr))&&Rt.push(Ce[mr])}),Rt};if(h||(Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var ct=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),mt=V(ct),Ct=function(Rt){this===K&&Ct.call(Pe,Rt),y(this,ne)&&y(this[ne],mt)&&(this[ne][mt]=!1),Ke(this,mt,k(1,Rt))};return f&&Me&&Ke(K,mt,{configurable:!0,set:Ct}),qe(mt,ct)},R(Y[Z],"toString",function(){return te(this).tag}),R(Y,"withoutSetter",function(pt){return qe(V(pt),pt)}),W.f=We,F.f=xe,C.f=$e,m.f=A.f=dt,I.f=xt,U.f=function(pt){return qe(z(pt),pt)},f&&(ie(Y[Z],"description",{configurable:!0,get:function(){return te(this).description}}),u||R(K,"propertyIsEnumerable",We,{unsafe:!0}))),o({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:Y}),ae(E(Ie),function(pt){G(pt)}),o({target:le,stat:!0,forced:!h},{for:function(pt){var ct=String(pt);if(y(Te,ct))return Te[ct];var mt=Y(ct);return Te[ct]=mt,ze[mt]=ct,mt},keyFor:function(ct){if(!Se(ct))throw TypeError(ct+" is not a symbol");if(y(ze,ct))return ze[ct]},useSetter:function(){Me=!0},useSimple:function(){Me=!1}}),o({target:"Object",stat:!0,forced:!h,sham:!f},{create:Le,defineProperty:xe,defineProperties:Ae,getOwnPropertyDescriptor:$e}),o({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:dt,getOwnPropertySymbols:xt}),o({target:"Object",stat:!0,forced:g(function(){I.f(1)})},{getOwnPropertySymbols:function(ct){return I.f(v(ct))}}),fe){var Vt=!h||g(function(){var pt=Y();return fe([pt])!="[null]"||fe({a:pt})!="{}"||fe(Object(pt))!="{}"});o({target:"JSON",stat:!0,forced:Vt},{stringify:function(ct,mt,Ct){for(var Rt=[ct],mr=1,mn;arguments.length>mr;)Rt.push(arguments[mr++]);if(mn=mt,!(!x(mt)&&ct===void 0||Se(ct)))return _(mt)||(mt=function(Qs,ms){if(typeof mn=="function"&&(ms=mn.call(this,Qs,ms)),!Se(ms))return ms}),Rt[1]=mt,fe.apply(null,Rt)}})}Y[Z][J]||P(Y[Z],J,Y[Z].valueOf),j(Y,le),O[ne]=!0},a630:function(s,i,a){var o=a("23e7"),l=a("4df4"),c=a("1c7e"),u=!c(function(f){Array.from(f)});o({target:"Array",stat:!0,forced:u},{from:l})},a640:function(s,i,a){var o=a("d039");s.exports=function(l,c){var u=[][l];return!!u&&o(function(){u.call(null,c||function(){throw 1},1)})}},a691:function(s,i){var a=Math.ceil,o=Math.floor;s.exports=function(l){return isNaN(l=+l)?0:(l>0?o:a)(l)}},ab13:function(s,i,a){var o=a("b622"),l=o("match");s.exports=function(c){var u=/./;try{"/./"[c](u)}catch{try{return u[l]=!1,"/./"[c](u)}catch{}}return!1}},ac1f:function(s,i,a){var o=a("23e7"),l=a("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},ad6d:function(s,i,a){var o=a("825a");s.exports=function(){var l=o(this),c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),l.dotAll&&(c+="s"),l.unicode&&(c+="u"),l.sticky&&(c+="y"),c}},ae40:function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("5135"),u=Object.defineProperty,f={},h=function(p){throw p};s.exports=function(p,g){if(c(f,p))return f[p];g||(g={});var y=[][p],_=c(g,"ACCESSORS")?g.ACCESSORS:!1,x=c(g,0)?g[0]:h,b=c(g,1)?g[1]:void 0;return f[p]=!!y&&!l(function(){if(_&&!o)return!0;var v={length:-1};_?u(v,1,{enumerable:!0,get:h}):v[1]=1,y.call(v,x,b)})}},ae93:function(s,i,a){var o=a("e163"),l=a("9112"),c=a("5135"),u=a("b622"),f=a("c430"),h=u("iterator"),p=!1,g=function(){return this},y,_,x;[].keys&&(x=[].keys(),"next"in x?(_=o(o(x)),_!==Object.prototype&&(y=_)):p=!0),y==null&&(y={}),!f&&!c(y,h)&&l(y,h,g),s.exports={IteratorPrototype:y,BUGGY_SAFARI_ITERATORS:p}},b041:function(s,i,a){var o=a("00ee"),l=a("f5df");s.exports=o?{}.toString:function(){return"[object "+l(this)+"]"}},b0c0:function(s,i,a){var o=a("83ab"),l=a("9bf2").f,c=Function.prototype,u=c.toString,f=/^\s*function ([^ (]*)/,h="name";o&&!(h in c)&&l(c,h,{configurable:!0,get:function(){try{return u.call(this).match(f)[1]}catch{return""}}})},b622:function(s,i,a){var o=a("da84"),l=a("5692"),c=a("5135"),u=a("90e3"),f=a("4930"),h=a("fdbf"),p=l("wks"),g=o.Symbol,y=h?g:g&&g.withoutSetter||u;s.exports=function(_){return c(p,_)||(f&&c(g,_)?p[_]=g[_]:p[_]=y("Symbol."+_)),p[_]}},b64b:function(s,i,a){var o=a("23e7"),l=a("7b0b"),c=a("df75"),u=a("d039"),f=u(function(){c(1)});o({target:"Object",stat:!0,forced:f},{keys:function(p){return c(l(p))}})},b727:function(s,i,a){var o=a("0366"),l=a("44ad"),c=a("7b0b"),u=a("50c4"),f=a("65f0"),h=[].push,p=function(g){var y=g==1,_=g==2,x=g==3,b=g==4,v=g==6,T=g==5||v;return function(D,k,S,E){for(var m=c(D),A=l(m),I=o(k,S,3),C=u(A.length),F=0,W=E||f,P=y?W(D,C):_?W(D,0):void 0,R,N;C>F;F++)if((T||F in A)&&(R=A[F],N=I(R,F,m),g)){if(y)P[F]=N;else if(N)switch(g){case 3:return!0;case 5:return R;case 6:return F;case 2:h.call(P,R)}else if(b)return!1}return v?-1:x||b?b:P}};s.exports={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6)}},c04e:function(s,i,a){var o=a("861d");s.exports=function(l,c){if(!o(l))return l;var u,f;if(c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l))||typeof(u=l.valueOf)=="function"&&!o(f=u.call(l))||!c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l)))return f;throw TypeError("Can't convert object to primitive value")}},c430:function(s,i){s.exports=!1},c6b6:function(s,i){var a={}.toString;s.exports=function(o){return a.call(o).slice(8,-1)}},c6cd:function(s,i,a){var o=a("da84"),l=a("ce4e"),c="__core-js_shared__",u=o[c]||l(c,{});s.exports=u},c740:function(s,i,a){var o=a("23e7"),l=a("b727").findIndex,c=a("44d2"),u=a("ae40"),f="findIndex",h=!0,p=u(f);f in[]&&Array(1)[f](function(){h=!1}),o({target:"Array",proto:!0,forced:h||!p},{findIndex:function(y){return l(this,y,arguments.length>1?arguments[1]:void 0)}}),c(f)},c8ba:function(s,i){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}s.exports=a},c975:function(s,i,a){var o=a("23e7"),l=a("4d64").indexOf,c=a("a640"),u=a("ae40"),f=[].indexOf,h=!!f&&1/[1].indexOf(1,-0)<0,p=c("indexOf"),g=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:h||!p||!g},{indexOf:function(_){return h?f.apply(this,arguments)||0:l(this,_,arguments.length>1?arguments[1]:void 0)}})},ca84:function(s,i,a){var o=a("5135"),l=a("fc6a"),c=a("4d64").indexOf,u=a("d012");s.exports=function(f,h){var p=l(f),g=0,y=[],_;for(_ in p)!o(u,_)&&o(p,_)&&y.push(_);for(;h.length>g;)o(p,_=h[g++])&&(~c(y,_)||y.push(_));return y}},caad:function(s,i,a){var o=a("23e7"),l=a("4d64").includes,c=a("44d2"),u=a("ae40"),f=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!f},{includes:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}}),c("includes")},cc12:function(s,i,a){var o=a("da84"),l=a("861d"),c=o.document,u=l(c)&&l(c.createElement);s.exports=function(f){return u?c.createElement(f):{}}},ce4e:function(s,i,a){var o=a("da84"),l=a("9112");s.exports=function(c,u){try{l(o,c,u)}catch{o[c]=u}return u}},d012:function(s,i){s.exports={}},d039:function(s,i){s.exports=function(a){try{return!!a()}catch{return!0}}},d066:function(s,i,a){var o=a("428f"),l=a("da84"),c=function(u){return typeof u=="function"?u:void 0};s.exports=function(u,f){return arguments.length<2?c(o[u])||c(l[u]):o[u]&&o[u][f]||l[u]&&l[u][f]}},d1e7:function(s,i,a){var o={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c=l&&!o.call({1:2},1);i.f=c?function(f){var h=l(this,f);return!!h&&h.enumerable}:o},d28b:function(s,i,a){var o=a("746f");o("iterator")},d2bb:function(s,i,a){var o=a("825a"),l=a("3bbe");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,u={},f;try{f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,f.call(u,[]),c=u instanceof Array}catch{}return function(p,g){return o(p),l(g),c?f.call(p,g):p.__proto__=g,p}}():void 0)},d3b7:function(s,i,a){var o=a("00ee"),l=a("6eeb"),c=a("b041");o||l(Object.prototype,"toString",c,{unsafe:!0})},d44e:function(s,i,a){var o=a("9bf2").f,l=a("5135"),c=a("b622"),u=c("toStringTag");s.exports=function(f,h,p){f&&!l(f=p?f:f.prototype,u)&&o(f,u,{configurable:!0,value:h})}},d58f:function(s,i,a){var o=a("1c0b"),l=a("7b0b"),c=a("44ad"),u=a("50c4"),f=function(h){return function(p,g,y,_){o(g);var x=l(p),b=c(x),v=u(x.length),T=h?v-1:0,D=h?-1:1;if(y<2)for(;;){if(T in b){_=b[T],T+=D;break}if(T+=D,h?T<0:v<=T)throw TypeError("Reduce of empty array with no initial value")}for(;h?T>=0:v>T;T+=D)T in b&&(_=g(_,b[T],T,x));return _}};s.exports={left:f(!1),right:f(!0)}},d784:function(s,i,a){a("ac1f");var o=a("6eeb"),l=a("d039"),c=a("b622"),u=a("9263"),f=a("9112"),h=c("species"),p=!l(function(){var b=/./;return b.exec=function(){var v=[];return v.groups={a:"7"},v},"".replace(b,"$<a>")!=="7"}),g=function(){return"a".replace(/./,"$0")==="$0"}(),y=c("replace"),_=function(){return/./[y]?/./[y]("a","$0")==="":!1}(),x=!l(function(){var b=/(?:)/,v=b.exec;b.exec=function(){return v.apply(this,arguments)};var T="ab".split(b);return T.length!==2||T[0]!=="a"||T[1]!=="b"});s.exports=function(b,v,T,D){var k=c(b),S=!l(function(){var F={};return F[k]=function(){return 7},""[b](F)!=7}),E=S&&!l(function(){var F=!1,W=/a/;return b==="split"&&(W={},W.constructor={},W.constructor[h]=function(){return W},W.flags="",W[k]=/./[k]),W.exec=function(){return F=!0,null},W[k](""),!F});if(!S||!E||b==="replace"&&!(p&&g&&!_)||b==="split"&&!x){var m=/./[k],A=T(k,""[b],function(F,W,P,R,N){return W.exec===u?S&&!N?{done:!0,value:m.call(W,P,R)}:{done:!0,value:F.call(P,W,R)}:{done:!1}},{REPLACE_KEEPS_$0:g,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:_}),I=A[0],C=A[1];o(String.prototype,b,I),o(RegExp.prototype,k,v==2?function(F,W){return C.call(F,this,W)}:function(F){return C.call(F,this)})}D&&f(RegExp.prototype[k],"sham",!0)}},d81d:function(s,i,a){var o=a("23e7"),l=a("b727").map,c=a("1dde"),u=a("ae40"),f=c("map"),h=u("map");o({target:"Array",proto:!0,forced:!f||!h},{map:function(g){return l(this,g,arguments.length>1?arguments[1]:void 0)}})},da84:function(s,i,a){(function(o){var l=function(c){return c&&c.Math==Math&&c};s.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof o=="object"&&o)||Function("return this")()}).call(this,a("c8ba"))},dbb4:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("56ef"),u=a("fc6a"),f=a("06cf"),h=a("8418");o({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(g){for(var y=u(g),_=f.f,x=c(y),b={},v=0,T,D;x.length>v;)D=_(y,T=x[v++]),D!==void 0&&h(b,T,D);return b}})},dbf1:function(s,i,a){(function(o){a.d(i,"a",function(){return c});function l(){return typeof window<"u"?window.console:o.console}var c=l()}).call(this,a("c8ba"))},ddb0:function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("e260"),u=a("9112"),f=a("b622"),h=f("iterator"),p=f("toStringTag"),g=c.values;for(var y in l){var _=o[y],x=_&&_.prototype;if(x){if(x[h]!==g)try{u(x,h,g)}catch{x[h]=g}if(x[p]||u(x,p,y),l[y]){for(var b in c)if(x[b]!==c[b])try{u(x,b,c[b])}catch{x[b]=c[b]}}}}},df75:function(s,i,a){var o=a("ca84"),l=a("7839");s.exports=Object.keys||function(u){return o(u,l)}},e01a:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("da84"),u=a("5135"),f=a("861d"),h=a("9bf2").f,p=a("e893"),g=c.Symbol;if(l&&typeof g=="function"&&(!("description"in g.prototype)||g().description!==void 0)){var y={},_=function(){var k=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),S=this instanceof _?new g(k):k===void 0?g():g(k);return k===""&&(y[S]=!0),S};p(_,g);var x=_.prototype=g.prototype;x.constructor=_;var b=x.toString,v=String(g("test"))=="Symbol(test)",T=/^Symbol\((.*)\)[^)]+$/;h(x,"description",{configurable:!0,get:function(){var k=f(this)?this.valueOf():this,S=b.call(k);if(u(y,k))return"";var E=v?S.slice(7,-1):S.replace(T,"$1");return E===""?void 0:E}}),o({global:!0,forced:!0},{Symbol:_})}},e163:function(s,i,a){var o=a("5135"),l=a("7b0b"),c=a("f772"),u=a("e177"),f=c("IE_PROTO"),h=Object.prototype;s.exports=u?Object.getPrototypeOf:function(p){return p=l(p),o(p,f)?p[f]:typeof p.constructor=="function"&&p instanceof p.constructor?p.constructor.prototype:p instanceof Object?h:null}},e177:function(s,i,a){var o=a("d039");s.exports=!o(function(){function l(){}return l.prototype.constructor=null,Object.getPrototypeOf(new l)!==l.prototype})},e260:function(s,i,a){var o=a("fc6a"),l=a("44d2"),c=a("3f8c"),u=a("69f3"),f=a("7dd0"),h="Array Iterator",p=u.set,g=u.getterFor(h);s.exports=f(Array,"Array",function(y,_){p(this,{type:h,target:o(y),index:0,kind:_})},function(){var y=g(this),_=y.target,x=y.kind,b=y.index++;return!_||b>=_.length?(y.target=void 0,{value:void 0,done:!0}):x=="keys"?{value:b,done:!1}:x=="values"?{value:_[b],done:!1}:{value:[b,_[b]],done:!1}},"values"),c.Arguments=c.Array,l("keys"),l("values"),l("entries")},e439:function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("fc6a"),u=a("06cf").f,f=a("83ab"),h=l(function(){u(1)}),p=!f||h;o({target:"Object",stat:!0,forced:p,sham:!f},{getOwnPropertyDescriptor:function(y,_){return u(c(y),_)}})},e538:function(s,i,a){var o=a("b622");i.f=o},e893:function(s,i,a){var o=a("5135"),l=a("56ef"),c=a("06cf"),u=a("9bf2");s.exports=function(f,h){for(var p=l(h),g=u.f,y=c.f,_=0;_<p.length;_++){var x=p[_];o(f,x)||g(f,x,y(h,x))}}},e8b5:function(s,i,a){var o=a("c6b6");s.exports=Array.isArray||function(c){return o(c)=="Array"}},e95a:function(s,i,a){var o=a("b622"),l=a("3f8c"),c=o("iterator"),u=Array.prototype;s.exports=function(f){return f!==void 0&&(l.Array===f||u[c]===f)}},f5df:function(s,i,a){var o=a("00ee"),l=a("c6b6"),c=a("b622"),u=c("toStringTag"),f=l(function(){return arguments}())=="Arguments",h=function(p,g){try{return p[g]}catch{}};s.exports=o?l:function(p){var g,y,_;return p===void 0?"Undefined":p===null?"Null":typeof(y=h(g=Object(p),u))=="string"?y:f?l(g):(_=l(g))=="Object"&&typeof g.callee=="function"?"Arguments":_}},f772:function(s,i,a){var o=a("5692"),l=a("90e3"),c=o("keys");s.exports=function(u){return c[u]||(c[u]=l(u))}},fb15:function(s,i,a){if(a.r(i),typeof window<"u"){var o=window.document.currentScript;{var l=a("8875");o=l(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:l})}var c=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(a.p=c[1])}a("99af"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("a434"),a("159b"),a("a4d3"),a("e439"),a("dbb4"),a("b64b");function u(Se,xe,Ae){return xe in Se?Object.defineProperty(Se,xe,{value:Ae,enumerable:!0,configurable:!0,writable:!0}):Se[xe]=Ae,Se}function f(Se,xe){var Ae=Object.keys(Se);if(Object.getOwnPropertySymbols){var Le=Object.getOwnPropertySymbols(Se);xe&&(Le=Le.filter(function(We){return Object.getOwnPropertyDescriptor(Se,We).enumerable})),Ae.push.apply(Ae,Le)}return Ae}function h(Se){for(var xe=1;xe<arguments.length;xe++){var Ae=arguments[xe]!=null?arguments[xe]:{};xe%2?f(Object(Ae),!0).forEach(function(Le){u(Se,Le,Ae[Le])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Se,Object.getOwnPropertyDescriptors(Ae)):f(Object(Ae)).forEach(function(Le){Object.defineProperty(Se,Le,Object.getOwnPropertyDescriptor(Ae,Le))})}return Se}function p(Se){if(Array.isArray(Se))return Se}a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function g(Se,xe){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Se)))){var Ae=[],Le=!0,We=!1,$e=void 0;try{for(var dt=Se[Symbol.iterator](),xt;!(Le=(xt=dt.next()).done)&&(Ae.push(xt.value),!(xe&&Ae.length===xe));Le=!0);}catch(Vt){We=!0,$e=Vt}finally{try{!Le&&dt.return!=null&&dt.return()}finally{if(We)throw $e}}return Ae}}a("a630"),a("fb6a"),a("b0c0"),a("25f0");function y(Se,xe){(xe==null||xe>Se.length)&&(xe=Se.length);for(var Ae=0,Le=new Array(xe);Ae<xe;Ae++)Le[Ae]=Se[Ae];return Le}function _(Se,xe){if(Se){if(typeof Se=="string")return y(Se,xe);var Ae=Object.prototype.toString.call(Se).slice(8,-1);if(Ae==="Object"&&Se.constructor&&(Ae=Se.constructor.name),Ae==="Map"||Ae==="Set")return Array.from(Se);if(Ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ae))return y(Se,xe)}}function x(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b(Se,xe){return p(Se)||g(Se,xe)||_(Se,xe)||x()}function v(Se){if(Array.isArray(Se))return y(Se)}function T(Se){if(typeof Symbol<"u"&&Symbol.iterator in Object(Se))return Array.from(Se)}function D(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(Se){return v(Se)||T(Se)||_(Se)||D()}var S=a("a352"),E=a.n(S);function m(Se){Se.parentElement!==null&&Se.parentElement.removeChild(Se)}function A(Se,xe,Ae){var Le=Ae===0?Se.children[0]:Se.children[Ae-1].nextSibling;Se.insertBefore(xe,Le)}var I=a("dbf1");a("13d5"),a("4fad"),a("ac1f"),a("5319");function C(Se){var xe=Object.create(null);return function(Le){var We=xe[Le];return We||(xe[Le]=Se(Le))}}var F=/-(\w)/g,W=C(function(Se){return Se.replace(F,function(xe,Ae){return Ae.toUpperCase()})});a("5db7"),a("73d9");var P=["Start","Add","Remove","Update","End"],R=["Choose","Unchoose","Sort","Filter","Clone"],N=["Move"],L=[N,P,R].flatMap(function(Se){return Se}).map(function(Se){return"on".concat(Se)}),O={manage:N,manageAndEmit:P,emit:R};function V(Se){return L.indexOf(Se)!==-1}a("caad"),a("2ca0");var z=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function U(Se){return z.includes(Se)}function G(Se){return["transition-group","TransitionGroup"].includes(Se)}function j(Se){return["id","class","role","style"].includes(Se)||Se.startsWith("data-")||Se.startsWith("aria-")||Se.startsWith("on")}function ee(Se){return Se.reduce(function(xe,Ae){var Le=b(Ae,2),We=Le[0],$e=Le[1];return xe[We]=$e,xe},{})}function ae(Se){var xe=Se.$attrs,Ae=Se.componentData,Le=Ae===void 0?{}:Ae,We=ee(Object.entries(xe).filter(function($e){var dt=b($e,2),xt=dt[0];return dt[1],j(xt)}));return h(h({},We),Le)}function ne(Se){var xe=Se.$attrs,Ae=Se.callBackBuilder,Le=ee(le(xe));Object.entries(Ae).forEach(function($e){var dt=b($e,2),xt=dt[0],Vt=dt[1];O[xt].forEach(function(pt){Le["on".concat(pt)]=Vt(pt)})});var We="[data-draggable]".concat(Le.draggable||"");return h(h({},Le),{},{draggable:We})}function le(Se){return Object.entries(Se).filter(function(xe){var Ae=b(xe,2),Le=Ae[0];return Ae[1],!j(Le)}).map(function(xe){var Ae=b(xe,2),Le=Ae[0],We=Ae[1];return[W(Le),We]}).filter(function(xe){var Ae=b(xe,2),Le=Ae[0];return Ae[1],!V(Le)})}a("c740");function Z(Se,xe){if(!(Se instanceof xe))throw new TypeError("Cannot call a class as a function")}function J(Se,xe){for(var Ae=0;Ae<xe.length;Ae++){var Le=xe[Ae];Le.enumerable=Le.enumerable||!1,Le.configurable=!0,"value"in Le&&(Le.writable=!0),Object.defineProperty(Se,Le.key,Le)}}function ge(Se,xe,Ae){return xe&&J(Se.prototype,xe),Se}var te=function(xe){var Ae=xe.el;return Ae},K=function(xe,Ae){return xe.__draggable_context=Ae},Y=function(xe){return xe.__draggable_context},fe=function(){function Se(xe){var Ae=xe.nodes,Le=Ae.header,We=Ae.default,$e=Ae.footer,dt=xe.root,xt=xe.realList;Z(this,Se),this.defaultNodes=We,this.children=[].concat(k(Le),k(We),k($e)),this.externalComponent=dt.externalComponent,this.rootTransition=dt.transition,this.tag=dt.tag,this.realList=xt}return ge(Se,[{key:"render",value:function(Ae,Le){var We=this.tag,$e=this.children,dt=this._isRootComponent,xt=dt?{default:function(){return $e}}:$e;return Ae(We,Le,xt)}},{key:"updated",value:function(){var Ae=this.defaultNodes,Le=this.realList;Ae.forEach(function(We,$e){K(te(We),{element:Le[$e],index:$e})})}},{key:"getUnderlyingVm",value:function(Ae){return Y(Ae)}},{key:"getVmIndexFromDomIndex",value:function(Ae,Le){var We=this.defaultNodes,$e=We.length,dt=Le.children,xt=dt.item(Ae);if(xt===null)return $e;var Vt=Y(xt);if(Vt)return Vt.index;if($e===0)return 0;var pt=te(We[0]),ct=k(dt).findIndex(function(mt){return mt===pt});return Ae<ct?0:$e}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),Se}(),ye=a("8bbf");function ie(Se,xe){var Ae=Se[xe];return Ae?Ae():[]}function ue(Se){var xe=Se.$slots,Ae=Se.realList,Le=Se.getKey,We=Ae||[],$e=["header","footer"].map(function(mt){return ie(xe,mt)}),dt=b($e,2),xt=dt[0],Vt=dt[1],pt=xe.item;if(!pt)throw new Error("draggable element must have an item slot");var ct=We.flatMap(function(mt,Ct){return pt({element:mt,index:Ct}).map(function(Rt){return Rt.key=Le(mt),Rt.props=h(h({},Rt.props||{}),{},{"data-draggable":!0}),Rt})});if(ct.length!==We.length)throw new Error("Item slot must have only one child");return{header:xt,footer:Vt,default:ct}}function Ee(Se){var xe=G(Se),Ae=!U(Se)&&!xe;return{transition:xe,externalComponent:Ae,tag:Ae?Object(ye.resolveComponent)(Se):xe?ye.TransitionGroup:Se}}function Ce(Se){var xe=Se.$slots,Ae=Se.tag,Le=Se.realList,We=Se.getKey,$e=ue({$slots:xe,realList:Le,getKey:We}),dt=Ee(Ae);return new fe({nodes:$e,root:dt,realList:Le})}function Pe(Se,xe){var Ae=this;Object(ye.nextTick)(function(){return Ae.$emit(Se.toLowerCase(),xe)})}function Te(Se){var xe=this;return function(Ae,Le){if(xe.realList!==null)return xe["onDrag".concat(Se)](Ae,Le)}}function ze(Se){var xe=this,Ae=Te.call(this,Se);return function(Le,We){Ae.call(xe,Le,We),Pe.call(xe,Se,Le)}}var Ie=null,be={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(xe){return xe}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Me=["update:modelValue","change"].concat(k([].concat(k(O.manageAndEmit),k(O.emit)).map(function(Se){return Se.toLowerCase()}))),Ke=Object(ye.defineComponent)({name:"draggable",inheritAttrs:!1,props:be,emits:Me,data:function(){return{error:!1}},render:function(){try{this.error=!1;var xe=this.$slots,Ae=this.$attrs,Le=this.tag,We=this.componentData,$e=this.realList,dt=this.getKey,xt=Ce({$slots:xe,tag:Le,realList:$e,getKey:dt});this.componentStructure=xt;var Vt=ae({$attrs:Ae,componentData:We});return xt.render(ye.h,Vt)}catch(pt){return this.error=!0,Object(ye.h)("pre",{style:{color:"red"}},pt.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&I.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var xe=this;if(!this.error){var Ae=this.$attrs,Le=this.$el,We=this.componentStructure;We.updated();var $e=ne({$attrs:Ae,callBackBuilder:{manageAndEmit:function(Vt){return ze.call(xe,Vt)},emit:function(Vt){return Pe.bind(xe,Vt)},manage:function(Vt){return Te.call(xe,Vt)}}}),dt=Le.nodeType===1?Le:Le.parentElement;this._sortable=new E.a(dt,$e),this.targetDomElement=dt,dt.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var xe=this.list;return xe||this.modelValue},getKey:function(){var xe=this.itemKey;return typeof xe=="function"?xe:function(Ae){return Ae[xe]}}},watch:{$attrs:{handler:function(xe){var Ae=this._sortable;Ae&&le(xe).forEach(function(Le){var We=b(Le,2),$e=We[0],dt=We[1];Ae.option($e,dt)})},deep:!0}},methods:{getUnderlyingVm:function(xe){return this.componentStructure.getUnderlyingVm(xe)||null},getUnderlyingPotencialDraggableComponent:function(xe){return xe.__draggable_component__},emitChanges:function(xe){var Ae=this;Object(ye.nextTick)(function(){return Ae.$emit("change",xe)})},alterList:function(xe){if(this.list){xe(this.list);return}var Ae=k(this.modelValue);xe(Ae),this.$emit("update:modelValue",Ae)},spliceList:function(){var xe=arguments,Ae=function(We){return We.splice.apply(We,k(xe))};this.alterList(Ae)},updatePosition:function(xe,Ae){var Le=function($e){return $e.splice(Ae,0,$e.splice(xe,1)[0])};this.alterList(Le)},getRelatedContextFromMoveEvent:function(xe){var Ae=xe.to,Le=xe.related,We=this.getUnderlyingPotencialDraggableComponent(Ae);if(!We)return{component:We};var $e=We.realList,dt={list:$e,component:We};if(Ae!==Le&&$e){var xt=We.getUnderlyingVm(Le)||{};return h(h({},xt),dt)}return dt},getVmIndexFromDomIndex:function(xe){return this.componentStructure.getVmIndexFromDomIndex(xe,this.targetDomElement)},onDragStart:function(xe){this.context=this.getUnderlyingVm(xe.item),xe.item._underlying_vm_=this.clone(this.context.element),Ie=xe.item},onDragAdd:function(xe){var Ae=xe.item._underlying_vm_;if(Ae!==void 0){m(xe.item);var Le=this.getVmIndexFromDomIndex(xe.newIndex);this.spliceList(Le,0,Ae);var We={element:Ae,newIndex:Le};this.emitChanges({added:We})}},onDragRemove:function(xe){if(A(this.$el,xe.item,xe.oldIndex),xe.pullMode==="clone"){m(xe.clone);return}var Ae=this.context,Le=Ae.index,We=Ae.element;this.spliceList(Le,1);var $e={element:We,oldIndex:Le};this.emitChanges({removed:$e})},onDragUpdate:function(xe){m(xe.item),A(xe.from,xe.item,xe.oldIndex);var Ae=this.context.index,Le=this.getVmIndexFromDomIndex(xe.newIndex);this.updatePosition(Ae,Le);var We={element:this.context.element,oldIndex:Ae,newIndex:Le};this.emitChanges({moved:We})},computeFutureIndex:function(xe,Ae){if(!xe.element)return 0;var Le=k(Ae.to.children).filter(function(xt){return xt.style.display!=="none"}),We=Le.indexOf(Ae.related),$e=xe.component.getVmIndexFromDomIndex(We),dt=Le.indexOf(Ie)!==-1;return dt||!Ae.willInsertAfter?$e:$e+1},onDragMove:function(xe,Ae){var Le=this.move,We=this.realList;if(!Le||!We)return!0;var $e=this.getRelatedContextFromMoveEvent(xe),dt=this.computeFutureIndex($e,xe),xt=h(h({},this.context),{},{futureIndex:dt}),Vt=h(h({},xe),{},{relatedContext:$e,draggedContext:xt});return Le(Vt,Ae)},onDragEnd:function(){Ie=null}}}),qe=Ke;i.default=qe},fb6a:function(s,i,a){var o=a("23e7"),l=a("861d"),c=a("e8b5"),u=a("23cb"),f=a("50c4"),h=a("fc6a"),p=a("8418"),g=a("b622"),y=a("1dde"),_=a("ae40"),x=y("slice"),b=_("slice",{ACCESSORS:!0,0:0,1:2}),v=g("species"),T=[].slice,D=Math.max;o({target:"Array",proto:!0,forced:!x||!b},{slice:function(S,E){var m=h(this),A=f(m.length),I=u(S,A),C=u(E===void 0?A:E,A),F,W,P;if(c(m)&&(F=m.constructor,typeof F=="function"&&(F===Array||c(F.prototype))?F=void 0:l(F)&&(F=F[v],F===null&&(F=void 0)),F===Array||F===void 0))return T.call(m,I,C);for(W=new(F===void 0?Array:F)(D(C-I,0)),P=0;I<C;I++,P++)I in m&&p(W,P,m[I]);return W.length=P,W}})},fc6a:function(s,i,a){var o=a("44ad"),l=a("1d80");s.exports=function(c){return o(l(c))}},fdbc:function(s,i){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(s,i,a){var o=a("4930");s.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Yoe);const Ole={class:"assignment-dialog-modal"},Mle={class:"form-row"},Lle={key:0,class:"form-row"},Ble=["value"],Ule={key:1,class:"form-row"},$le=["value"],Vle={key:2,class:"form-row"},Hle={class:"form-row"},jle={class:"form-row"},Gle={class:"form-row"},Wle={class:"dialog-actions"},zle={__name:"AssignmentDialog",props:{teachers:Array,students:Array,assignment:Object},emits:["save","close"],setup(t,{emit:e}){const r=t,n=e,s=se("lunch"),i=se(""),a=se(""),o=se(""),l=se("12:00"),c=se("12:30"),u=se(""),f=se(""),h=se("");Ht(()=>r.assignment,_=>{_?(f.value=_.id||Date.now().toString(),h.value=_.blockId||f.value||`block-${Date.now()}`,s.value=_.type||"lunch",i.value=_.teacherId||"",a.value=_.studentId||"",o.value=_.type==="other"?_.label:"",l.value=_.start||"12:00",c.value=_.end||"12:30",u.value=_.note||""):(f.value=Date.now().toString(),h.value=`block-${f.value}`,s.value="lunch",i.value="",a.value="",o.value="",l.value="12:00",c.value="12:30",u.value="")},{immediate:!0});const p=_e(()=>(r.teachers||[]).sort((x,b)=>{const v=T=>{const D=T.name||T.email||T.id,k=D.split(" ");return k.length>1?k[k.length-1]:D};return v(x).localeCompare(v(b))})),g=_e(()=>{if(s.value==="lunch")return"Lunch";if(s.value==="break")return"Break";if(s.value==="class"){const _=r.teachers.find(x=>x.id===i.value);return _?_.name||_.email||_.id:""}if(s.value==="student"){const _=r.students.find(x=>x.id===a.value);return _?`${_.firstName} ${_.lastName}`:""}return s.value==="other"?o.value:""});function y(){!l.value||!c.value||s.value==="class"&&!i.value||s.value==="student"&&!a.value||s.value==="other"&&!o.value||n("save",{id:f.value,blockId:h.value,type:s.value,label:g.value,start:l.value,end:c.value,note:u.value,teacherId:i.value,studentId:a.value})}return(_,x)=>(M(),B("div",{class:"assignment-dialog-overlay",onClick:x[8]||(x[8]=Yr(b=>_.$emit("close"),["self"]))},[d("div",Ole,[x[20]||(x[20]=d("h2",null,"Add Assignment",-1)),d("form",{onSubmit:Yr(y,["prevent"])},[d("div",Mle,[x[10]||(x[10]=d("label",null,"Type:",-1)),Oe(d("select",{"onUpdate:modelValue":x[0]||(x[0]=b=>s.value=b)},x[9]||(x[9]=[En('<option value="lunch" data-v-25be9281>Lunch</option><option value="break" data-v-25be9281>Break</option><option value="class" data-v-25be9281>Class</option><option value="student" data-v-25be9281>Student</option><option value="other" data-v-25be9281>Other</option>',5)]),512),[[sr,s.value]])]),s.value==="class"?(M(),B("div",Lle,[x[12]||(x[12]=d("label",null,"Teacher:",-1)),Oe(d("select",{"onUpdate:modelValue":x[1]||(x[1]=b=>i.value=b)},[x[11]||(x[11]=d("option",{value:""},"Select teacher...",-1)),(M(!0),B(ke,null,He(p.value,b=>(M(),B("option",{key:b.id,value:b.id},Q(b.name||b.email||b.id),9,Ble))),128))],512),[[sr,i.value]])])):ve("",!0),s.value==="student"?(M(),B("div",Ule,[x[14]||(x[14]=d("label",null,"Student:",-1)),Oe(d("select",{"onUpdate:modelValue":x[2]||(x[2]=b=>a.value=b)},[x[13]||(x[13]=d("option",{value:""},"Select student...",-1)),(M(!0),B(ke,null,He(t.students,b=>(M(),B("option",{key:b.id,value:b.id},Q(b.firstName)+" "+Q(b.lastName),9,$le))),128))],512),[[sr,a.value]])])):ve("",!0),s.value==="other"?(M(),B("div",Vle,[x[15]||(x[15]=d("label",null,"Label:",-1)),Oe(d("input",{"onUpdate:modelValue":x[3]||(x[3]=b=>o.value=b),placeholder:"Custom label"},null,512),[[ht,o.value]])])):ve("",!0),d("div",Hle,[x[16]||(x[16]=d("label",null,"Start Time:",-1)),Oe(d("input",{"onUpdate:modelValue":x[4]||(x[4]=b=>l.value=b),type:"time",required:""},null,512),[[ht,l.value]])]),d("div",jle,[x[17]||(x[17]=d("label",null,"End Time:",-1)),Oe(d("input",{"onUpdate:modelValue":x[5]||(x[5]=b=>c.value=b),type:"time",required:""},null,512),[[ht,c.value]])]),d("div",Gle,[x[18]||(x[18]=d("label",null,"Note:",-1)),Oe(d("input",{"onUpdate:modelValue":x[6]||(x[6]=b=>u.value=b),placeholder:"Optional note"},null,512),[[ht,u.value]])]),d("div",Wle,[x[19]||(x[19]=d("button",{type:"submit",class:"btn btn-primary"},"Add",-1)),d("button",{type:"button",class:"btn btn-secondary",onClick:x[7]||(x[7]=b=>_.$emit("close"))},"Cancel")])],32)])]))}},Kle=St(zle,[["__scopeId","data-v-25be9281"]]),qle={class:"vertical-time-grid-wrapper"},Xle={class:"grid-block-label-time"},Yle=["title"],Qle=["title"],Jle=["onDragstart","onDrag","onDragend"],Zle={class:"assignment-content"},ece={class:"assignment-label-time"},tce={class:"assignment-time-label"},rce={class:"assignment-actions"},nce=["onClick"],sce=["onClick"],ace=["onMousedown"],XS=24,ice={__name:"VerticalTimeGrid",props:{assignments:Array,teachers:Array,students:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,blocks:Array},emits:["update:assignments","edit-assignment"],setup(t,{emit:e}){const r=t,n=e,s=se(null);se(!1);const i=se(r.assignments?r.assignments.map(R=>({...R})):[]);Ht(()=>r.assignments,R=>{i.value=R?R.map(N=>({...N})):[]},{immediate:!0});function a(R){const[N,L]=R.split(":").map(Number);return N*60+L}function o(R){const N=Math.floor(R/60),L=R%60;return`${N<10?"0":""}${N}:${L<10?"0":""}${L}`}const l=_e(()=>!r.blocks||r.blocks.length===0?"08:00":r.blocks.reduce((R,N)=>N.startTime<R?N.startTime:R,r.blocks[0].startTime)),c=_e(()=>!r.blocks||r.blocks.length===0?"16:00":r.blocks.reduce((R,N)=>N.endTime>R?N.endTime:R,r.blocks[0].endTime)),u=_e(()=>a(l.value)),f=_e(()=>a(c.value)),h=_e(()=>f.value-u.value),p=_e(()=>h.value*2.5+XS*2);_e(()=>{if(!r.blocks)return[];const R=[];return r.blocks.forEach(N=>{R.includes(N.startTime)||R.push(N.startTime),R.includes(N.endTime)||R.push(N.endTime)}),R.sort((N,L)=>a(N)-a(L))});function g(R){return(a(R)-u.value)*2.5+XS-10}function y(R,N){if(!R||!N)return!1;const L=a(R.startTime),O=a(R.endTime),V=a(N.startTime),z=a(N.endTime);return L<z&&O>V}function _(R){const N=[];for(let O=0;O<R.length;O++){const V=R[O];let z=null;for(let U=0;U<N.length;U++)if(N[U].ids.some(G=>y(V,R.find(j=>j.id===G)))){z=N[U];break}z?(z.ids.push(V.id),z.blocks.push(V)):N.push({ids:[V.id],blocks:[V]})}let L=!0;for(;L;){L=!1;for(let O=0;O<N.length;O++){for(let V=O+1;V<N.length;V++)if(N[O].ids.some(z=>N[V].ids.some(U=>y(R.find(G=>G.id===z),R.find(G=>G.id===U))))){N[O].ids=Array.from(new Set([...N[O].ids,...N[V].ids])),N[O].blocks=Array.from(new Set([...N[O].blocks,...N[V].blocks])),N.splice(V,1),L=!0;break}if(L)break}}return N.map(O=>{const V=O.blocks.sort((G,j)=>G.startTime.localeCompare(j.startTime)||G.id.localeCompare(j.id)),z=V.reduce((G,j)=>j.startTime<G?j.startTime:G,V[0].startTime),U=V.reduce((G,j)=>j.endTime>G?j.endTime:G,V[0].endTime);return{ids:O.ids,startTime:z,endTime:U}})}_e(()=>_(x.value));const x=_e(()=>(r.blocks||[]).map((R,N)=>({...R,id:R.id||`block-${N}`})));function b(R){const N=[];for(let V=0;V<R.length;V++){const z=R[V];let U=null;for(let G=0;G<N.length;G++)if(N[G].some(j=>y(z,R.find(ee=>ee.id===j)))){U=N[G];break}U?U.push(z.id):N.push([z.id])}let L=!0;for(;L;){L=!1;for(let V=0;V<N.length;V++){for(let z=V+1;z<N.length;z++)if(N[V].some(U=>N[z].some(G=>y(R.find(j=>j.id===U),R.find(j=>j.id===G))))){N[V]=Array.from(new Set([...N[V],...N[z]])),N.splice(z,1),L=!0;break}if(L)break}}const O={};for(const V of N){const z=V.map(U=>R.find(G=>G.id===U)).sort((U,G)=>U.startTime.localeCompare(G.startTime)||U.id.localeCompare(G.id));z.forEach((U,G)=>{O[U.id]={groupSize:z.length,colIndex:G}})}return O}function v(R,N){const L=b(x.value)[R.id]||{groupSize:1,colIndex:0},O=g(R.startTime),V=(a(R.endTime)-a(R.startTime))*2.5,z=100/L.groupSize;return{position:"absolute",left:z*L.colIndex+"%",width:z+"%",top:O+"px",height:V+"px",zIndex:1,opacity:.38,boxSizing:"border-box",overflow:"hidden"}}function T(R,N){const L=i.value.filter((Z,J)=>{if(Z.id===R.id)return!1;const ge=a(Z.start),te=a(Z.end),K=a(R.start),Y=a(R.end);return ge<Y&&te>K}),O=L.length+1,z=[R,...L].sort((Z,J)=>Z.start.localeCompare(J.start)||Z.id.localeCompare(J.id)).findIndex(Z=>Z.id===R.id),U=g(R.start),G=(a(R.end)-a(R.start))*2.5,j=Math.max(G,2.5),ee=73,ae=27,ne=ee/O;return{position:"absolute",left:ae+ne*z+"%",width:ne+"%",top:U+"px",height:j+"px",zIndex:2,minWidth:"80px",boxSizing:"border-box",padding:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",cursor:"grab",transition:"top 0.2s, height 0.2s"}}const D=se(null),k=se(0),S=se(0),E=se(null);function m(R,N){D.value=N,k.value=R.clientY,S.value=a(N.start),E.value="move",N.isDragging=!0,R.target.classList.add("background-dragging-div");const O=document.createElement("div");O.className="drag-preview-div",O.style.width="160px",O.style.height="40px",O.style.background="transparent",O.style.border="2px solid #007bff",O.style.position="absolute",O.style.top="-9999px",O.style.left="-9999px",document.body.appendChild(O),R.dataTransfer.setDragImage(O,80,20),R.dataTransfer.effectAllowed="move",R.dataTransfer.setData("text/plain",N.id)}function A(R,N){if(!D.value||R.clientY===0)return;const L=R.clientY-k.value,O=Math.round(L/2.5);if(E.value==="move"){let V=S.value+O,z=V+(a(N.end)-a(N.start));V=Math.max(u.value,Math.min(V,f.value-1)),z=Math.max(V+1,Math.min(z,f.value)),N.start=o(V),N.end=o(z)}}function I(R,N){D.value=null,E.value=null,N.isDragging=!1,n("update:assignments",i.value)}function C(R,N){D.value=N,k.value=R.clientY,S.value=a(N.end),E.value="resize",window.addEventListener("mousemove",F),window.addEventListener("mouseup",W)}function F(R){if(!D.value)return;const N=R.clientY-k.value;let L=S.value+Math.round(N/2.5);const O=a(D.value.start);L=Math.max(O+1,Math.min(L,f.value)),D.value.end=o(L)}function W(R){D.value=null,E.value=null,window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",W)}function P(R){const N=i.value.findIndex(L=>L.id===R);N!==-1&&(i.value.splice(N,1),n("update:assignments",i.value))}return(R,N)=>(M(),B("div",qle,[d("div",{class:"vertical-time-grid",ref_key:"timeGridRef",ref:s,style:Nr({position:"relative",height:p.value+"px"})},[(M(!0),B(ke,null,He(x.value,(L,O)=>(M(),B("div",{key:L.id,class:Ye(["grid-block-bg",L.type==="period"?"blocktype-period":"blocktype-"+(L.type||"period")]),style:Nr(v(L))},[d("div",Xle,[d("span",{class:"grid-block-label",title:L.name||(L.type==="period"?L.label||L.periodName||L.periodNumber||"Period":L.type?L.type.charAt(0).toUpperCase()+L.type.slice(1):"")},Q(L.name||(L.type==="period"?L.label||L.periodName||L.periodNumber||"Period":L.type?L.type.charAt(0).toUpperCase()+L.type.slice(1):"")),9,Yle),d("span",{class:"grid-block-time",title:L.startTime},Q(L.startTime),9,Qle)])],6))),128)),(M(!0),B(ke,null,He(i.value,(L,O)=>(M(),B("div",{key:L.id,class:Ye(["dialog-assignment-box",["type-"+(L.type||"other"),{dragging:L.isDragging}]]),style:Nr(T(L)),draggable:"true",onDragstart:V=>m(V,L),onDrag:V=>A(V,L),onDragend:V=>I(V,L)},[d("div",Zle,[d("div",ece,[d("span",tce,Q(L.start)+""+Q(L.end)+" "+Q(L.label),1)])]),d("div",rce,[d("button",{class:"edit-btn",onClick:V=>R.$emit("edit-assignment",L)},"",8,nce),d("button",{class:"delete-btn",onClick:V=>P(L.id)},"",8,sce)]),d("div",{class:"resize-handle",onMousedown:Yr(V=>C(V,L),["stop"]),title:"Drag to resize block"},null,40,ace)],46,Jle))),128))],4)]))}},oce=St(ice,[["__scopeId","data-v-8f5880e4"]]),lce={class:"dialog-header"},cce={class:"dialog-header-actions"},uce={class:"dialog-content"},dce={style:{display:"flex","align-items":"flex-start"}},fce={class:"dialog-actions"},hce=["disabled"],pce={key:0},mce={key:1},gce={__name:"AideScheduleEditDialog",props:{aideName:String,timeTicks:Array,isTickInAnyBlock:Function,aideAssignments:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,showAddAssignment:Boolean,addAssignment:Function,onImportAssignments:Function,onSave:Function,onClose:Function,saving:Boolean,blocks:Array,teachers:Array,students:Array},setup(t){const e=t,r=se([]),n=se(!1),s=se(null);Wt(()=>{console.log("DEBUG: AideScheduleEditDialog mounted, blocks:",e.blocks)}),Ht(()=>e.blocks,f=>{console.log("DEBUG: props.blocks in AideScheduleEditDialog",f)});function i(){e.onSave(r.value)}function a(){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],n.value=!0}function o(f){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],s.value={...f},n.value=!0}function l(f){if(s.value){const h=r.value.findIndex(p=>p.id===f.id);h!==-1&&(r.value[h]={...f}),s.value=null}else r.value=[...r.value,f];n.value=!1}function c(){s.value=null,n.value=!1}function u(f){console.log("handleUpdateAssignments called with:",f),r.value=f}return(f,h)=>(M(),B("div",{class:"dialog-overlay",onClick:h[4]||(h[4]=(...p)=>t.onClose&&t.onClose(...p))},[d("div",{class:"edit-dialog",onClick:h[3]||(h[3]=Yr(()=>{},["stop"]))},[d("div",lce,[d("h2",null,"Edit Schedule: "+Q(t.aideName),1),d("div",cce,[d("button",{onClick:h[0]||(h[0]=(...p)=>t.onImportAssignments&&t.onImportAssignments(...p)),class:"btn btn-secondary btn-import-assignments"},"Import Aide Assignments"),d("button",{onClick:a,class:"btn btn-primary btn-add-assignment"},"Add Assignment"),d("button",{onClick:h[1]||(h[1]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary close-btn"},"")])]),d("div",uce,[d("div",dce,[Re(oce,{timeTicks:t.timeTicks,isTickInAnyBlock:t.isTickInAnyBlock,assignments:r.value,getAssignmentBoxStyle:t.getAssignmentBoxStyle,onAssignmentDragStart:t.onAssignmentDragStart,onAssignmentDrag:t.onAssignmentDrag,onAssignmentDragEnd:t.onAssignmentDragEnd,onResizeStart:t.onResizeStart,blocks:t.blocks,onEditAssignment:o,"onUpdate:assignments":u},null,8,["timeTicks","isTickInAnyBlock","assignments","getAssignmentBoxStyle","onAssignmentDragStart","onAssignmentDrag","onAssignmentDragEnd","onResizeStart","blocks"])]),n.value?(M(),Qt(Kle,{key:0,teachers:t.teachers,students:t.students,assignment:s.value,onSave:l,onClose:c},null,8,["teachers","students","assignment"])):ve("",!0)]),d("div",fce,[d("button",{onClick:i,class:"btn btn-primary",disabled:t.saving},[t.saving?(M(),B("span",pce,"")):(M(),B("span",mce,"")),we(" "+Q(t.saving?"Saving...":"Save Schedule"),1)],8,hce),d("button",{onClick:h[2]||(h[2]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary"},"Cancel")])])]))}},vce={class:"master-schedule"},yce={key:0,class:"no-time-table"},xce={class:"no-data-message"},Ece={key:1,class:"schedule-graph-container"},bce={class:"timeline-header"},_ce={class:"block-time"},Sce={class:"block-name"},Ace={class:"block-time"},Tce={class:"aide-header"},wce={class:"aide-name"},Cce=["onClick"],Ice={class:"time-line-container"},kce={class:"time-blocks-background"},Dce={class:"assignment-bars"},Pce={class:"assignment-label"},Mg=30,Rce={__name:"AideScheduleMasterTable",props:{paraeducators:Array,blocks:Array,getAideTimeBlocks:Function,getAideName:Function,currentTimeTable:Object},emits:["editAideAssignment","gotoTimeTableConfig"],setup(t,{emit:e}){const r=t,n=se([]);function s(x){const b=r.getAideTimeBlocks(x).filter(v=>v.assignment).map(v=>({id:v.id,label:v.assignment,type:v.assignmentType,start:v.start||v.displayTime.split(" - ")[0],end:v.end||v.displayTime.split(" - ")[1]}));return i(b)}function i(x){if(x.length===0)return[];const b=[...x].sort((k,S)=>f(k.start)-f(S.start)),v=[];let T=[];for(const k of b)T.length===0?T=[k]:T.some(E=>f(k.start)<f(E.end)&&f(k.end)>f(E.start))?T.push(k):(v.push(T),T=[k]);T.length>0&&v.push(T);const D=[];for(const k of v)k.forEach((S,E)=>{S.overlapIndex=E,S.overlapCount=k.length,D.push(S)});return D}function a(x){if(!x.overlapCount||x.overlapCount<=1)return 10;const b=40;return(60-(x.overlapCount*b+(x.overlapCount-1)*2))/2+x.overlapIndex*(b+2)}function o(x){if(!r.blocks||r.blocks.length===0)return 0;const b=r.blocks[0],v=r.blocks[r.blocks.length-1],T=f(b.startTime),k=f(v.endTime)-T,E=(f(x)-T)/k*100;return Math.max(0,Math.min(95,E))}function l(x,b){if(!r.blocks||r.blocks.length===0)return 10;const v=r.blocks[0],T=r.blocks[r.blocks.length-1],D=f(v.startTime),S=f(T.endTime)-D,E=f(x),A=(f(b)-E)/S*100;return Math.max(5,Math.min(95,A))}function c(x){if(!r.blocks||r.blocks.length===0)return 0;const b=r.blocks[0],v=r.blocks[r.blocks.length-1],T=f(b.startTime),k=f(v.endTime)-T,E=(f(x)-T)/k*100;return Math.max(0,Math.min(95,E))}function u(x,b){if(!r.blocks||r.blocks.length===0)return 10;const v=r.blocks[0],T=r.blocks[r.blocks.length-1],D=f(v.startTime),S=f(T.endTime)-D,E=f(x),A=(f(b)-E)/S*100;return Math.max(5,Math.min(95,A))}function f(x){const[b,v]=x.split(":").map(Number);return b*60+v}function h(x){var v;const b=((v=x.name)==null?void 0:v.toLowerCase())||"";return b.includes("lunch")?"lunch":b.includes("break")||b.includes("recess")?"break":b.includes("period")||b.includes("class")?"period":"other"}function p(x){const b=[...x].sort((D,k)=>f(D.startTime)-f(k.startTime)),v=[];for(const D of b){let k=!1;for(let S=0;S<v.length;S++){const E=v[S];if(!E.some(A=>f(D.startTime)<f(A.endTime)&&f(D.endTime)>f(A.startTime))){E.push(D),D.overlapIndex=S,k=!0;break}}k||(D.overlapIndex=v.length,v.push([D]))}const T=v.length;return b.map(D=>({...D,overlapIndex:D.overlapIndex,overlapCount:T}))}const g=_e(()=>p(r.blocks||[])),y=_e(()=>Math.max(...g.value.map(x=>x.overlapCount||1),1)),_=_e(()=>y.value*Mg);return Ht(()=>r.aideAssignments,x=>{n.value=x?JSON.parse(JSON.stringify(x)):[]},{immediate:!0}),(x,b)=>(M(),B("div",vce,[b[4]||(b[4]=d("h2",null,"Master Schedule View",-1)),GA(x.$slots,"tab-bar",{},void 0,!0),!t.currentTimeTable||!t.currentTimeTable.schedule||t.currentTimeTable.schedule.length===0?(M(),B("div",yce,[d("div",xce,[b[1]||(b[1]=d("h3",null,"No Time Table Configured",-1)),b[2]||(b[2]=d("p",null,"You need to configure a time table first before you can create aide assignments.",-1)),d("button",{onClick:b[0]||(b[0]=v=>x.$emit("gotoTimeTableConfig")),class:"btn btn-primary"}," Go to Time Table Configuration ")])])):(M(),B("div",Ece,[d("div",bce,[b[3]||(b[3]=d("div",{class:"aide-name-header"},"Aide Name",-1)),d("div",{class:"timeline-container",style:Nr({height:_.value+"px"})},[d("div",{class:"time-blocks-header",style:Nr({height:_.value+"px"})},[(M(!0),B(ke,null,He(g.value,v=>(M(),B("div",{key:v.id+"-"+v.overlapIndex,class:Ye(["time-block-header",h(v)]),style:Nr({left:o(v.startTime)+"%",width:l(v.startTime,v.endTime)+"%",top:v.overlapIndex*Mg+"px",height:Mg+"px",zIndex:10})},[d("div",_ce,Q(v.startTime),1),d("div",Sce,Q(v.name||v.type),1),d("div",Ace,Q(v.endTime),1)],6))),128))],4)],4)]),(M(!0),B(ke,null,He(t.paraeducators,v=>(M(),B("div",{key:v.id,class:"aide-row"},[d("div",Tce,[d("span",wce,Q(t.getAideName(v.id)),1),d("button",{onClick:T=>x.$emit("editAideAssignment",v.id),class:"btn btn-small btn-primary edit-btn"}," Edit ",8,Cce)]),d("div",Ice,[d("div",kce,[(M(!0),B(ke,null,He(t.blocks,T=>(M(),B("div",{key:T.id,class:Ye(["time-block-bg",h(T)]),style:Nr({left:o(T.startTime)+"%",width:l(T.startTime,T.endTime)+"%"})},null,6))),128)),(M(!0),B(ke,null,He(t.blocks.slice(0,-1),(T,D)=>(M(),B("div",{key:`bg-gap-${T.id}`,class:"time-block-bg-gap",style:Nr({left:o(T.endTime)-.5+"%",width:"1%"})},null,4))),128))]),d("div",Dce,[(M(!0),B(ke,null,He(s(v.id),T=>(M(),B("div",{key:T.id,class:Ye(["master-assignment-bar",T.type]),style:Nr({left:c(T.start)+"%",width:u(T.start,T.end)+"%",top:a(T)+"px"})},[d("span",Pce,Q(T.label),1)],6))),128))])])]))),128))]))]))}},Fce=St(Rce,[["__scopeId","data-v-40c5158e"]]);function h0(t){return(t==null?void 0:t.schedule)||[]}function Nce(t){let e="23:59",r="00:00";for(const n of t)n.startTime&&n.startTime<e&&(e=n.startTime),n.endTime&&n.endTime>r&&(r=n.endTime);return{min:e,max:r}}function Oce(t){return _e(()=>{const{min:e,max:r}=Nce(t.value||t),[n,s]=e.split(":").map(Number),[i,a]=r.split(":").map(Number);let o=[],l=n,c=s;for(;l<i||l===i&&c<=a;){const f=l<10?`0${l}`:`${l}`,h=c<10?`0${c}`:`${c}`;o.push({time:`${f}:${h}`}),c+=5,c>=60&&(c=0,l++)}const u=(t.value||t).map(f=>f.startTime);for(const f of u)o.find(h=>h.time===f)||o.push({time:f});return o=Array.from(new Set(o.map(f=>f.time))).sort().map(f=>({time:f})),o})}function Mce(t,e){return e.some(r=>r.startTime<=t&&r.endTime>=t)}const Lce={class:"admin-aide-schedule-detailed"},Bce={class:"header"},Uce={class:"header-actions"},$ce=["disabled"],Vce={key:0},Hce={key:1},jce={class:"content"},Gce={key:0,class:"error-message"},Wce={key:1,class:"error-message"},zce={key:2,class:"loading"},Kce={key:3,class:"schedule-container"},qce={key:0,class:"time-table-tab-bar"},Xce=["onClick"],bD={__name:"AdminAideSchedule",setup(t){const e=ki(),r=Qr(),{userList:n,fetchUsers:s}=_a(),{students:i,fetchStudents:a}=Di(),{appSettings:o,loadAppSettings:l,saveAppSettings:c}=Ts(),{labels:u}=Eo(),{aideSchedule:f,loadAideSchedules:h,saveAideSchedule:p}=Xoe(),{aideAssignment:g}=ex(),y=se(!0),_=se(!1),x=se(null),b=se({}),v=se({}),T=se(null);se([]);const D=se({}),k=_e(()=>b.value&&Array.isArray(b.value.timeTables)&&b.value.timeTables.length>0?b.value.timeTables.map((ue,Ee)=>({id:ue.name?ue.name.toLowerCase().replace(/\s+/g,"-"):`tt-${Ee}`,label:ue.name||`Time Table ${Ee+1}`,...ue})):b.value&&b.value.schedule?[{id:"default",label:b.value.label||"Default Schedule",schedule:b.value.schedule}]:[]);Wt(async()=>{console.log("Loaded timeTableData:",b.value),console.log("Computed allTimeTables:",k.value),k.value.length>0&&!T.value&&(T.value=k.value[0].id,console.log("Set selectedTimeTable:",T.value)),await l(),o.value.timeTables&&Array.isArray(o.value.timeTables)?(b.value={timeTables:o.value.timeTables},console.log("Set timeTableData to timeTables array:",b.value)):o.value.schedule&&(b.value={schedule:o.value.schedule},console.log("Set timeTableData to single schedule:",b.value))}),Ht(k,ue=>{console.log("allTimeTables changed:",ue)}),Ht(T,ue=>{console.log("selectedTimeTable changed:",ue)});const S=_e(()=>{const ue=k.value.find(Ee=>Ee.id===T.value)||k.value[0];return console.log("currentTimeTable:",ue),ue}),E=_e(()=>h0(S.value)),m=Oce(E);function A(ue){return Mce(ue,E.value)}const I=_e(()=>{var Ee;const ue=(Ee=r.currentUser)==null?void 0:Ee.role;return["admin","school_admin","admin_504","sped_chair"].includes(ue)}),C=_e(()=>{var ue;return((ue=n.value)==null?void 0:ue.filter(Ee=>Ee.role==="paraeducator"))||[]}),F=_e(()=>{var ue;return((ue=n.value)==null?void 0:ue.filter(Ee=>["teacher","case_manager","sped_chair"].includes(Ee.role)).sort((Ee,Ce)=>{const Pe=Te=>{const ze=Te.name||Te.email||Te.id,Ie=ze.split(" ");return Ie.length>1?Ie[Ie.length-1]:ze};return Pe(Ee).localeCompare(Pe(Ce))}))||[]});_e(()=>u.value);function W(ue){if(!E.value)return[];console.log("DEBUG: getAideTimeBlocks called for aide:",ue),console.log("DEBUG: aideSchedule.value:",f.value),console.log("DEBUG: aideAssignment.value:",g.value);const Ce=(f.value[ue]||{}).schedule||{};console.log("DEBUG: aideScheduleData:",Ce);const Pe=Object.values(Ce).filter(Te=>Te.start&&Te.end&&Te.label).map(Te=>({id:Te.id||Te.blockId||`assignment-${Date.now()}`,assignment:Te.label,assignmentType:Te.type||"custom",displayTime:`${Te.start} - ${Te.end}`,start:Te.start,end:Te.end}));return console.log("DEBUG: individualAssignments:",Pe),Pe.length>0?Pe:(console.log("DEBUG: No individual assignments found, adding test data"),[{id:"test-1",assignment:"Test Class Assignment",assignmentType:"class",displayTime:"08:00 - 09:00",start:"08:00",end:"09:00"},{id:"test-2",assignment:"Test Student Assignment",assignmentType:"student",displayTime:"10:00 - 11:00",start:"10:00",end:"11:00"}])}function P(ue){const Ee=C.value.find(Ce=>Ce.id===ue);return Ee?Ee.name||Ee.email:"Unknown Aide"}function R(ue){x.value=ue,Z.value=!0}function N(){x.value=null}async function L(){try{_.value=!0;const Ee={...await l(),detailedAideSchedule:v.value};await c(Ee),console.log("Detailed aide schedule saved successfully")}catch(ue){console.error("Error saving detailed aide schedule:",ue)}finally{_.value=!1}}function O(){e.push("/admin")}async function V(){try{y.value=!0,await Promise.all([s(),a(),l()]);const ue=await er(et(Xe,"app_settings","global"));if(ue.exists()){const Ee=ue.data();v.value=Ee.detailedAideSchedule||{}}y.value=!1}catch(ue){console.error("Error loading aide schedule data:",ue),y.value=!1}}Wt(V);function z(ue,Ee){return ue.assignments&&ue.assignments[Ee]||""}function U(){var Te,ze;if(console.log("DEBUG: handleImportAssignments called"),console.log("DEBUG: editingAideId.value:",x.value),console.log("DEBUG: aideAssignment.value:",g.value),console.log("DEBUG: All aide IDs:",Object.keys(g.value)),console.log("DEBUG: All aide data:",Object.entries(g.value).map(([Ie,be])=>({id:Ie,keys:Object.keys(be)}))),!x.value||!g.value[x.value]){console.log("DEBUG: No aide data found"),alert("No aide assignment data found for this aide.");return}const ue=Y.value.length;if(ue>0&&!confirm(`WARNING: This will remove ${ue} current assignments and replace them with imported assignments.

Do you want to continue?`))return;const Ee=g.value[x.value];console.log("DEBUG: aideData:",Ee),console.log("DEBUG: aideData.classAssignment:",Ee.classAssignment),console.log("DEBUG: aideData.directAssignment:",Ee.directAssignment),console.log("DEBUG: Object.keys(aideData):",Object.keys(Ee)),console.log("DEBUG: aideData.schedule:",Ee.schedule),console.log("DEBUG: typeof aideData.schedule:",typeof Ee.schedule),console.log("DEBUG: Array.isArray(aideData.schedule):",Array.isArray(Ee.schedule));let Ce=0;Y.value=[];const Pe=h0(S.value);console.log("DEBUG: timeTableBlocks:",Pe),console.log("DEBUG: timeTableBlocks with period numbers:",Pe.map(Ie=>({name:Ie.name,periodNumber:Ie.periodNumber,type:Ie.type})));for(const Ie of Pe){console.log("DEBUG: Processing block:",Ie),console.log("DEBUG: Block periodNumber:",Ie.periodNumber),console.log("DEBUG: Block name:",Ie.name),console.log("DEBUG: Available classAssignment keys:",Object.keys(Ee.classAssignment||{}));let be=Ie.periodNumber;if(!be&&Ie.name){const qe=Ie.name.match(/Period\s*(\d+)/i);qe&&(be=qe[1],console.log("DEBUG: Extracted periodNumber from name:",be))}let Me="",Ke=[];if(be&&Ee.classAssignment&&Ee.classAssignment[be]){console.log("DEBUG: Found class assignment for periodNumber:",be);const qe=Array.isArray(Ee.classAssignment[be])?Ee.classAssignment[be]:[Ee.classAssignment[be]];Ke=qe.filter(Boolean).map(Se=>{const xe=F.value.find(Ae=>Ae.id===Se);return xe?xe.name||xe.email:"Unknown Teacher"}),Me=qe.filter(Boolean).map(Se=>`teacher:${Se}`).join(","),console.log("DEBUG: Created assignment for periodNumber:",Me)}if(!Me&&Ie.name&&Ee.classAssignment){console.log("DEBUG: Trying to match by block name:",Ie.name);const qe=Object.keys(Ee.classAssignment).find(Se=>Se.toLowerCase().trim()===Ie.name.toLowerCase().trim());if(qe){console.log("DEBUG: Found match by block name:",qe);const Se=Array.isArray(Ee.classAssignment[qe])?Ee.classAssignment[qe]:[Ee.classAssignment[qe]];Ke=Se.filter(Boolean).map(xe=>{const Ae=F.value.find(Le=>Le.id===xe);return Ae?Ae.name||Ae.email:"Unknown Teacher"}),Me=Se.filter(Boolean).map(xe=>`teacher:${xe}`).join(","),console.log("DEBUG: Created assignment for block name:",Me)}}if(Me){const qe=Ie.startTime,Se=G(Ie.startTime,30),xe=Me.split(",").map(Le=>Le.replace("teacher:","")).filter(Boolean),Ae={id:`imported-class-${Date.now()}-${Ce}`,label:Ke.join(", "),start:qe,end:Se,type:"class",blockId:`imported-block-${Ce}`,teacherId:xe[0]||"",note:xe.length>1?`Multiple teachers: ${Ke.join(", ")}`:""};console.log("DEBUG: Adding new assignment:",Ae),Y.value.push(Ae),Ce++}}if(console.log("DEBUG: Checking direct assignments..."),console.log("DEBUG: aideData.directAssignment:",Ee.directAssignment),console.log("DEBUG: typeof aideData.directAssignment:",typeof Ee.directAssignment),console.log("DEBUG: Array.isArray(aideData.directAssignment):",Array.isArray(Ee.directAssignment)),Ee.directAssignment){console.log("DEBUG: Found directAssignment:",Ee.directAssignment);const Ie=Array.isArray(Ee.directAssignment)?Ee.directAssignment:[Ee.directAssignment];console.log("DEBUG: directStudentIds:",Ie),console.log("DEBUG: students.value length:",(Te=i.value)==null?void 0:Te.length),console.log("DEBUG: students.value sample:",(ze=i.value)==null?void 0:ze.slice(0,3));for(const be of Ie)if(console.log("DEBUG: Processing studentId:",be),be&&be!==""){const Me=i.value.find(Ke=>Ke.id===be);if(console.log("DEBUG: Found student:",Me),Me){const Ke=`${at(Me,"firstName")} ${at(Me,"lastName")}`;console.log("DEBUG: Student name:",Ke);const qe=h0(S.value).find(Se=>Se.type==="period");if(console.log("DEBUG: First period block:",qe),qe){const Se=qe.startTime,xe=G(qe.startTime,30),Ae={id:`imported-direct-${Date.now()}-${Ce}`,label:Ke,start:Se,end:xe,type:"student",blockId:`imported-direct-block-${Ce}`,studentId:be};console.log("DEBUG: Adding direct assignment:",Ae),Y.value.push(Ae),Ce++}}}}else console.log("DEBUG: No directAssignment found");if(console.log("DEBUG: Final importedCount:",Ce),console.log("DEBUG: Final localAideAssignments:",Y.value),Ce>0){alert(`Successfully imported ${Ce} assignments with 30-minute time spans.

Types: Class assignments set to 'class', Direct assignments set to 'student'
Labels: Teacher names for class assignments, Student names for direct assignments
Duration: 30 minutes each`);const Ie=x.value,be=f.value[Ie]||{},Me={};Y.value.forEach(qe=>{const Se=qe.blockId||qe.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;Me[Se]={id:qe.id,blockId:Se,type:qe.type,label:qe.label,start:qe.start,end:qe.end,note:qe.note,teacherId:qe.teacherId,studentId:qe.studentId}});const Ke={...be,schedule:Me};p(Ie,Ke).then(()=>{h().then(()=>{N(),hl(()=>{R(Ie)})})})}else alert("No matching assignments found in the Aide Assignment data for this schedule.")}function G(ue,Ee){const[Ce,Pe]=ue.split(":").map(Number),Te=Ce*60+Pe+Ee,ze=Math.floor(Te/60),Ie=Te%60;return`${ze.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}`}Ht(()=>h0(S.value),ue=>{const Ee={};for(const Ce of ue){const Pe=z(Ce,x.value);Ee[Ce.id]=Pe?[{id:Pe,value:Pe}]:[]}D.value=Ee},{immediate:!0});function j(ue,Ee){J.value=Ee,ge.value=ue.clientY,te.value=m.value.findIndex(Ce=>Ce.time===Ee.start),K.value=0,ue.dataTransfer.effectAllowed="move",ue.dataTransfer.setData("text/plain",Ee.id)}function ee(ue,Ee){if(!J.value||ue.clientY===0)return;const Ce=ue.clientY-ge.value;K.value=Ce,Ee._dragOffset=Ce}function ae(ue,Ee){if(!J.value)return;const Ce=24,Pe=m.value.length;let Te=te.value+Math.round(K.value/Ce);Te=Math.max(0,Math.min(Pe-2,Te));const ze=m.value[Te].time,Ie=m.value.findIndex(Ke=>Ke.time===Ee.end)-te.value;let be=Te+Ie;be=Math.max(Te+1,Math.min(Pe-1,be));const Me=m.value[be].time;Ee.start=ze,Ee.end=Me,Ee._dragOffset=0,J.value=null,K.value=0}function ne(ue){const Ee=m.value.findIndex(Me=>Me.time===ue.start),Ce=m.value.findIndex(Me=>Me.time===ue.end),Pe=24;if(Ee===-1||Ce===-1)return{display:"none"};const Te=Ee*Pe+(ue._dragOffset||0),ze=Math.max((Ce-Ee)*Pe,Pe);let Ie,be;return ue.type==="class"?(Ie="#e8f4fd",be="#4a90e2"):ue.type==="student"?(Ie="#f0f8e8",be="#7cb342"):(Ie="#f5f5f5",be="#9e9e9e"),{position:"absolute",left:"20px",top:`${Te}px`,height:`${ze}px`,width:"200px",minHeight:"24px",background:Ie,borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",border:`2px solid ${be}`,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",cursor:"grab",zIndex:2,transition:J.value===ue?"none":"top 0.2s"}}function le(){const ue=E.value&&E.value.length>0?E.value[0].startTime:"08:00",Ee=E.value&&E.value.length>0?E.value[0].endTime:"08:30";Y.value.push({id:`custom:${Date.now()}`,label:"",start:ue,end:Ee,blockId:`block-${Date.now()}`})}const Z=se(!1);se(null);const J=se(null),ge=se(0),te=se(0),K=se(0),Y=se([]);Ht(x,ue=>{if(!ue){Y.value=[];return}const Ce=(f.value[ue]||{}).schedule||{};Y.value=Object.entries(Ce).map(([Pe,Te])=>({id:Pe+"-"+(ue||""),label:Te.label||"",start:Te.start,end:Te.end,blockId:Pe,type:Te.type||"lunch",teacherId:Te.teacherId||"",studentId:Te.studentId||"",note:Te.note||""}))},{immediate:!0});async function fe(ue){if(x.value)try{_.value=!0;const Ee=f.value[x.value]||{},Ce={};ue.forEach(Te=>{const ze=Te.blockId||Te.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;Ce[ze]={id:Te.id,blockId:ze,type:Te.type,label:Te.label,start:Te.start,end:Te.end,note:Te.note,teacherId:Te.teacherId,studentId:Te.studentId}});const Pe={...Ee,schedule:Ce};await p(x.value,Pe),await h(),N(),alert("Schedule saved!")}catch(Ee){alert("Failed to save schedule: "+Ee.message)}finally{_.value=!1}}Ht(()=>E,ue=>{console.log("DEBUG: blocks",ue)},{immediate:!0}),Ht(x,ue=>{ue&&(console.log("DEBUG: Opening edit dialog for aide",ue),console.log("DEBUG: blocks passed to dialog",E.value))});function ye(ue,Ee){console.log("Resize start:",Ee)}function ie(){le()}return(ue,Ee)=>(M(),B("div",Lce,[d("div",Bce,[Ee[4]||(Ee[4]=d("h1",null,"Aide Schedule Management",-1)),d("div",Uce,[d("button",{onClick:L,class:"btn btn-primary",disabled:_.value},[_.value?(M(),B("span",Vce,"")):(M(),B("span",Hce,"")),we(" "+Q(_.value?"Saving...":"Save Schedule"),1)],8,$ce),d("button",{onClick:O,class:"btn btn-secondary"},Ee[3]||(Ee[3]=[d("span",null,"",-1),we(" Back ")]))])]),d("div",jce,[q(r).currentUser?I.value?y.value?(M(),B("div",zce," Loading aide schedules... ")):(M(),B("div",Kce,[Re(Fce,{paraeducators:C.value,blocks:E.value,getAideTimeBlocks:W,getAideName:P,currentTimeTable:S.value,onEditAideAssignment:R,onGotoTimeTableConfig:Ee[2]||(Ee[2]=()=>q(e).push("/admin?tab=time-table"))},{"tab-bar":ep(()=>[k.value.length>1?(M(),B("div",qce,[(M(!0),B(ke,null,He(k.value,Ce=>(M(),B("div",{key:Ce.id,class:Ye(["tab-btn",{active:T.value===Ce.id}]),onClick:Pe=>T.value=Ce.id},Q(Ce.label),11,Xce))),128))])):ve("",!0)]),_:1},8,["paraeducators","blocks","currentTimeTable"]),x.value?(M(),Qt(gce,{key:0,aideName:P(x.value),timeTicks:q(m),isTickInAnyBlock:A,aideAssignments:Y.value,getAssignmentBoxStyle:ne,onAssignmentDragStart:j,onAssignmentDrag:ee,onAssignmentDragEnd:ae,onResizeStart:ye,showAddAssignment:Z.value,addAssignment:ie,onImportAssignments:U,onSave:fe,onClose:N,saving:_.value,blocks:E.value,teachers:F.value,students:q(i)},null,8,["aideName","timeTicks","aideAssignments","showAddAssignment","saving","blocks","teachers","students"])):ve("",!0)])):(M(),B("div",Wce,[Ee[7]||(Ee[7]=d("h2",null,"Access Denied",-1)),Ee[8]||(Ee[8]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:Ee[1]||(Ee[1]=Ce=>q(e).push("/")),class:"btn btn-primary"},"Go Home")])):(M(),B("div",Gce,[Ee[5]||(Ee[5]=d("h2",null,"Authentication Required",-1)),Ee[6]||(Ee[6]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:Ee[0]||(Ee[0]=Ce=>q(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},Yce={name:"AdminBackupRestore",setup(){const t=Qr(),e=se([{id:"users",name:"Users"},{id:"students",name:"Students"},{id:"app_settings",name:"App Settings"},{id:"aideSchedules",name:"Aide Schedules"},{id:"aideAssignments",name:"Aide Assignments"},{id:"feedbackForms",name:"Teacher Feedback Forms"},{id:"config",name:"Configuration"},{id:"backups",name:"Backups Metadata"}]),r=se(["users","students","app_settings"]),n=se(""),s=se(!1),i=se(!1),a=se(null),o=se(null),l=se([]),c=se(""),u=se("info"),f=As({overwrite:!1,validate:!0}),h=se(null),p=async()=>{var k,S,E;try{console.log(" DEBUG: Current user role:",(k=t.user)==null?void 0:k.role),console.log(" DEBUG: Current user:",t.user);const m=At(Xe,"backups"),A=lr(m,vn("createdAt","desc"),la(20)),I=await Gt(A);l.value=I.docs.map(C=>({id:C.id,...C.data()})),console.log(" DEBUG: Successfully loaded",l.value.length,"backups")}catch(m){console.error(" DEBUG: Error loading backups:",m),console.error(" DEBUG: Error details:",{code:m.code,message:m.message,userRole:(S=t.user)==null?void 0:S.role,userId:(E=t.user)==null?void 0:E.uid}),D("Error loading backups","error")}},g=async()=>{if(r.value.length===0){D("Please select at least one collection","error");return}s.value=!0,D("Creating backup...","info");try{const k={metadata:{version:"1.0",createdAt:new Date().toISOString(),createdBy:"admin",description:n.value||"Manual backup"},collections:{}};for(const m of r.value)if(m==="app_settings"){const A=et(Xe,"app_settings","global"),I=await er(A);k.collections[m]=I.exists()?I.data():{}}else{const A=At(Xe,m),I=await Gt(A);k.collections[m]=I.docs.map(C=>({id:C.id,...C.data()}))}const S=`backup_${Date.now()}`,E=et(Xe,"backups",S);await $t(E,{name:n.value||`Backup ${new Date().toLocaleDateString()}`,createdAt:new Date().toISOString(),collections:r.value,size:JSON.stringify(k).length,data:k}),n.value="",await p(),D("Backup created successfully!","success")}catch(k){console.error("Error creating backup:",k),D("Error creating backup: "+k.message,"error")}finally{s.value=!1}},y=k=>{const S=k.target.files[0];if(!S)return;a.value=S,o.value=null;const E=new FileReader;E.onload=m=>{try{const A=JSON.parse(m.target.result);A.metadata&&A.collections?(o.value=A,D("Backup file loaded successfully","success")):D("Invalid backup file format","error")}catch{D("Error parsing JSON file","error")}},E.readAsText(S)},_=async()=>{if(!a.value||!o.value){D("Please select a valid backup file","error");return}if(f.overwrite){if(!confirm("This will overwrite existing data. This action cannot be undone. Continue?"))return}else if(!confirm("This will add new data without overwriting existing records. Continue?"))return;i.value=!0,D("Restoring backup...","info");try{for(const[k,S]of Object.entries(o.value.collections))if(k==="app_settings"||k==="appSettings"){const E=et(Xe,"app_settings","global");await $t(E,S,{merge:!f.overwrite})}else{const E=At(Xe,k);if(Array.isArray(S))for(const m of S){const A=et(E,m.id);f.overwrite?await $t(A,m):await $t(A,m,{merge:!0})}}D("Backup restored successfully!","success"),a.value=null,o.value=null,h.value&&(h.value.value="")}catch(k){console.error("Error restoring backup:",k),D("Error restoring backup: "+k.message,"error")}finally{i.value=!1}},x=k=>{const S=JSON.stringify(k.data,null,2),E=new Blob([S],{type:"application/json"}),m=URL.createObjectURL(E),A=document.createElement("a");A.href=m,A.download=`${k.name||"backup"}.json`,A.target="_blank",A.rel="noopener noreferrer",document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(m)},b=async k=>{if(confirm("Are you sure you want to delete this backup?"))try{await mo(et(Xe,"backups",k)),await p(),D("Backup deleted successfully","success")}catch(E){console.error("Error deleting backup:",E),D("Error deleting backup","error")}},v=k=>{if(k===0)return"0 Bytes";const S=1024,E=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(k)/Math.log(S));return parseFloat((k/Math.pow(S,m)).toFixed(2))+" "+E[m]},T=k=>new Date(k).toLocaleString(),D=(k,S="info")=>{c.value=k,u.value=S,setTimeout(()=>{c.value=""},5e3)};return Wt(()=>{p()}),{collections:e,selectedCollections:r,backupName:n,isBackingUp:s,isRestoring:i,selectedFile:a,backupData:o,backups:l,statusMessage:c,statusType:u,restoreOptions:f,fileInput:h,createBackup:g,handleFileSelect:y,restoreBackup:_,downloadBackup:x,deleteBackup:b,formatFileSize:v,formatDate:T}}},Qce={class:"admin-backup-restore"},Jce={class:"content"},Zce={class:"section"},eue={class:"backup-options"},tue={class:"option-group"},rue={class:"checkbox-group"},nue=["value","disabled"],sue={class:"option-group"},aue=["disabled"],iue=["disabled"],oue={key:0},lue={key:1},cue={class:"section"},uue={class:"restore-options"},due={class:"file-upload"},fue=["disabled"],hue={key:0,class:"file-info"},pue={key:0,class:"option-group"},mue={class:"backup-info"},gue={class:"collection-name"},vue={class:"collection-count"},yue={key:1,class:"option-group"},xue={class:"checkbox-group"},Eue={class:"checkbox"},bue=["disabled"],_ue={class:"checkbox"},Sue=["disabled"],Aue=["disabled"],Tue={key:0},wue={key:1},Cue={class:"section"},Iue={key:0,class:"backup-list"},kue={class:"backup-info"},Due={class:"admin-action-btns"},Pue=["onClick"],Rue=["onClick"],Fue={key:1,class:"no-backups"};function Nue(t,e,r,n,s,i){return M(),B("div",Qce,[e[17]||(e[17]=d("h1",null," Admin Tools",-1)),e[18]||(e[18]=d("div",{class:"header"},[d("h1",null,"Backup & Restore"),d("p",null,"Manage database backups and restore data from JSON files")],-1)),d("div",Jce,[d("div",Zce,[e[9]||(e[9]=d("h2",null,"Create Backup",-1)),d("div",eue,[d("div",tue,[e[7]||(e[7]=d("label",null,"Collections to backup:",-1)),d("div",rue,[(M(!0),B(ke,null,He(n.collections,a=>(M(),B("label",{key:a.id,class:"checkbox"},[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>n.selectedCollections=o),value:a.id,disabled:n.isBackingUp},null,8,nue),[[_t,n.selectedCollections]]),we(" "+Q(a.name),1)]))),128))])]),d("div",sue,[e[8]||(e[8]=d("label",null,"Backup name (optional):",-1)),Oe(d("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>n.backupName=a),placeholder:"e.g., backup-2024-01-15",disabled:n.isBackingUp},null,8,aue),[[ht,n.backupName]])]),d("button",{onClick:e[2]||(e[2]=(...a)=>n.createBackup&&n.createBackup(...a)),disabled:n.isBackingUp||n.selectedCollections.length===0,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},[n.isBackingUp?(M(),B("span",oue,"Creating Backup...")):(M(),B("span",lue,"Create Backup"))],8,iue)])]),d("div",cue,[e[15]||(e[15]=d("h2",null,"Restore from Backup",-1)),d("div",uue,[d("div",due,[e[10]||(e[10]=d("label",null,"Select JSON backup file:",-1)),d("input",{type:"file",onChange:e[3]||(e[3]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a)),accept:".json",disabled:n.isRestoring,ref:"fileInput"},null,40,fue),n.selectedFile?(M(),B("p",hue," Selected: "+Q(n.selectedFile.name)+" ("+Q(n.formatFileSize(n.selectedFile.size))+") ",1)):ve("",!0)]),n.backupData?(M(),B("div",pue,[e[11]||(e[11]=d("label",null,"Collections in backup:",-1)),d("div",mue,[(M(!0),B(ke,null,He(n.backupData.collections,(a,o)=>(M(),B("div",{key:o,class:"collection-info"},[d("span",gue,Q(o)+":",1),d("span",vue,Q(Array.isArray(a)?a.length:"1")+" items",1)]))),128))])])):ve("",!0),n.backupData?(M(),B("div",yue,[e[14]||(e[14]=d("label",null,"Restore options:",-1)),d("div",xue,[d("label",Eue,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>n.restoreOptions.overwrite=a),disabled:n.isRestoring},null,8,bue),[[_t,n.restoreOptions.overwrite]]),e[12]||(e[12]=we(" Overwrite existing data "))]),d("label",_ue,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>n.restoreOptions.validate=a),disabled:n.isRestoring},null,8,Sue),[[_t,n.restoreOptions.validate]]),e[13]||(e[13]=we(" Validate data before restore "))])])])):ve("",!0),d("button",{onClick:e[6]||(e[6]=(...a)=>n.restoreBackup&&n.restoreBackup(...a)),disabled:n.isRestoring||!n.selectedFile||!n.backupData,class:"admin-action-btn warning",style:{"min-width":"140px","max-width":"140px"}},[n.isRestoring?(M(),B("span",Tue,"Restoring...")):(M(),B("span",wue,"Restore Backup"))],8,Aue)])]),d("div",Cue,[e[16]||(e[16]=d("h2",null,"Backup History",-1)),n.backups.length>0?(M(),B("div",Iue,[(M(!0),B(ke,null,He(n.backups,a=>(M(),B("div",{key:a.id,class:"backup-item"},[d("div",kue,[d("h3",null,Q(a.name||"Unnamed Backup"),1),d("p",null,"Created: "+Q(n.formatDate(a.createdAt)),1),d("p",null,"Size: "+Q(n.formatFileSize(a.size)),1),d("p",null,"Collections: "+Q(a.collections.join(", ")),1)]),d("div",Due,[d("button",{onClick:o=>n.downloadBackup(a),class:"admin-action-btn secondary"},"Download",8,Pue),d("button",{onClick:o=>n.deleteBackup(a.id),class:"admin-action-btn delete"},"Delete",8,Rue)])]))),128))])):(M(),B("p",Fue,"No backups found"))])]),n.statusMessage?(M(),B("div",{key:0,class:Ye(["status-message",n.statusType])},Q(n.statusMessage),3)):ve("",!0)])}const _D=St(Yce,[["render",Nue],["__scopeId","data-v-95273eef"]]),Oue={class:"admin-audit-logs"},Mue={class:"log-controls"},Lue={class:"log-filters"},Bue=["disabled"],Uue=["disabled"],$ue={class:"logs-container"},Vue={key:0,class:"loading-state"},Hue={key:1,class:"logs-table"},jue={class:"timestamp"},Gue={class:"log-type"},Wue={class:"user-info"},zue={class:"user-email"},Kue={class:"user-id"},que={class:"action"},Xue={class:"details"},Yue={class:"details-preview"},Que={class:"actions"},Jue=["onClick"],Zue={key:2,class:"no-logs"},ede={key:1,class:"pagination"},tde=["disabled"],rde={class:"page-info"},nde=["disabled"],sde={class:"dialog-content"},ade={class:"log-detail-section"},ide={class:"detail-grid"},ode={class:"detail-item"},lde={class:"detail-item"},cde={class:"detail-item"},ude={class:"detail-item"},dde={class:"detail-item"},fde={class:"detail-item"},hde={class:"detail-item"},pde={key:0,class:"log-detail-section"},mde={class:"detail-grid"},gde={key:0,class:"detail-item"},vde={key:1,class:"detail-item"},yde={key:2,class:"detail-item"},xde={key:1,class:"log-detail-section"},Ede={class:"details-content"},bde={key:2,class:"log-detail-section"},_de={class:"detail-grid"},Sde={key:0,class:"detail-item"},Ade={key:1,class:"detail-item"},p0=25,Tde={__name:"AdminAuditLogs",setup(t){const e=xo(),r=se([]),n=se(!1),s=se(""),i=se(!1),a=se(null),o=se("7"),l=se(""),c=se(""),u=se(""),f=se(1),h=_e(()=>{let I=r.value;if(l.value&&(I=I.filter(C=>C.type===l.value)),c.value&&(I=I.filter(C=>C.action===c.value)),u.value){const C=u.value.toLowerCase();I=I.filter(F=>F.userEmail&&F.userEmail.toLowerCase().includes(C)||F.action&&F.action.toLowerCase().includes(C)||F.details&&JSON.stringify(F.details).toLowerCase().includes(C)||F.studentId&&F.studentId.toLowerCase().includes(C))}return I}),p=_e(()=>{const I=(f.value-1)*p0,C=I+p0;return h.value.slice(I,C)}),g=_e(()=>Math.ceil(h.value.length/p0)),y=async()=>{n.value=!0,s.value="";try{const I=new Date;I.setDate(I.getDate()-parseInt(o.value));const C=lr(At(e,"auditLogs"),Ur("timestamp",">=",I),vn("timestamp","desc"),la(500)),F=await Gt(C);r.value=F.docs.map(W=>({id:W.id,...W.data()})),f.value=1,E(`Loaded ${r.value.length} audit logs`,!1)}catch(I){console.error("Error loading audit logs:",I),E("Error loading audit logs: "+I.message,!0)}finally{n.value=!1}},_=async()=>{try{const I=x(h.value),C=new Blob([I],{type:"text/csv"}),F=window.URL.createObjectURL(C),W=document.createElement("a");W.href=F,W.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,W.click(),window.URL.revokeObjectURL(F),E("Audit logs exported successfully",!1)}catch(I){console.error("Error exporting logs:",I),E("Error exporting logs: "+I.message,!0)}},x=I=>{const F=[["Timestamp","Type","User Email","User ID","Action","Details","Student ID","Session ID","IP Address"].join(",")];return I.forEach(W=>{const P=[T(W.timestamp),W.type||"",W.userEmail||W.performedByEmail||"",W.userId||W.performedBy||"",W.action||"",JSON.stringify(W.details||"").replace(/"/g,'""'),W.studentId||W.targetUserId||"",W.sessionId||"",W.ipAddress||""];F.push(P.map(R=>`"${R}"`).join(","))}),F.join(`
`)},b=I=>{a.value=I},v=()=>{a.value=null},T=I=>{if(!I)return"N/A";let C;return I.toDate?C=I.toDate():I instanceof Date?C=I:C=new Date(I),C.toLocaleString()},D=I=>({student_access:"Student Access",user_management:"User Management",system_access:"System Access",data_export:"Data Export",session_timeout:"Session Timeout"})[I]||I,k=I=>{if(I.details){const F=typeof I.details=="string"?I.details:JSON.stringify(I.details);return F.length>50?F.substring(0,50)+"...":F}const C=[];return I.studentId&&C.push(`Student: ${I.studentId}`),I.targetUserId&&C.push(`Target: ${I.targetUserId}`),I.exportType&&C.push(`Export: ${I.exportType}`),I.studentCount&&C.push(`Count: ${I.studentCount}`),C.join(", ")||"No additional details"},S=I=>{if(!I)return"No details available";if(typeof I=="string")try{const C=JSON.parse(I);return JSON.stringify(C,null,2)}catch{return I}return JSON.stringify(I,null,2)},E=(I,C=!1)=>{s.value=I,i.value=C,setTimeout(()=>{s.value="",i.value=!1},5e3)};let m=null;const A=()=>{m&&clearTimeout(m),m=setTimeout(()=>{f.value=1},300)};return Wt(()=>{y()}),(I,C)=>(M(),B("div",Oue,[C[29]||(C[29]=d("div",{class:"logs-header"},[d("h2",null," System Audit Logs"),d("p",{class:"logs-description"}," View and search system audit logs for security monitoring and compliance. ")],-1)),d("div",Mue,[d("div",Lue,[Oe(d("select",{"onUpdate:modelValue":C[0]||(C[0]=F=>o.value=F),onChange:y,class:"form-select"},C[7]||(C[7]=[d("option",{value:"1"},"Last 24 hours",-1),d("option",{value:"7"},"Last 7 days",-1),d("option",{value:"30"},"Last 30 days",-1),d("option",{value:"90"},"Last 90 days",-1)]),544),[[sr,o.value]]),Oe(d("select",{"onUpdate:modelValue":C[1]||(C[1]=F=>l.value=F),onChange:y,class:"form-select"},C[8]||(C[8]=[En('<option value="" data-v-aacc574e>All Log Types</option><option value="student_access" data-v-aacc574e>Student Access</option><option value="user_management" data-v-aacc574e>User Management</option><option value="system_access" data-v-aacc574e>System Access</option><option value="data_export" data-v-aacc574e>Data Export</option><option value="session_timeout" data-v-aacc574e>Session Timeout</option>',6)]),544),[[sr,l.value]]),Oe(d("select",{"onUpdate:modelValue":C[2]||(C[2]=F=>c.value=F),onChange:y,class:"form-select"},C[9]||(C[9]=[En('<option value="" data-v-aacc574e>All Actions</option><option value="login" data-v-aacc574e>Login</option><option value="logout" data-v-aacc574e>Logout</option><option value="create" data-v-aacc574e>Create</option><option value="edit" data-v-aacc574e>Edit</option><option value="delete" data-v-aacc574e>Delete</option><option value="view" data-v-aacc574e>View</option><option value="admin_panel_access" data-v-aacc574e>Admin Access</option>',8)]),544),[[sr,c.value]]),Oe(d("input",{"onUpdate:modelValue":C[3]||(C[3]=F=>u.value=F),onInput:A,type:"text",placeholder:"Search logs...",class:"form-input"},null,544),[[ht,u.value]]),d("button",{onClick:y,class:"btn btn-secondary",disabled:n.value},"  "+Q(n.value?"Loading...":"Refresh"),9,Bue),d("button",{onClick:_,class:"btn btn-primary",disabled:n.value},"  Export Logs ",8,Uue)])]),s.value?(M(),B("div",{key:0,class:Ye(["status-message",{error:i.value}])},Q(s.value),3)):ve("",!0),d("div",$ue,[n.value?(M(),B("div",Vue," Loading audit logs... ")):h.value.length>0?(M(),B("table",Hue,[C[10]||(C[10]=d("thead",null,[d("tr",null,[d("th",null,"Timestamp"),d("th",null,"Type"),d("th",null,"User"),d("th",null,"Action"),d("th",null,"Details"),d("th",null,"Actions")])],-1)),d("tbody",null,[(M(!0),B(ke,null,He(p.value,F=>(M(),B("tr",{key:F.id,class:"log-row"},[d("td",jue,Q(T(F.timestamp)),1),d("td",Gue,[d("span",{class:Ye(["type-badge",F.type])},Q(D(F.type)),3)]),d("td",Wue,[d("div",zue,Q(F.userEmail||"Unknown"),1),d("div",Kue,Q(F.userId||F.performedBy||"N/A"),1)]),d("td",que,Q(F.action||"N/A"),1),d("td",Xue,[d("div",Yue,Q(k(F)),1)]),d("td",Que,[d("button",{onClick:W=>b(F),class:"btn btn-sm btn-info",title:"View Details"},"  View ",8,Jue)])]))),128))])])):(M(),B("div",Zue,C[11]||(C[11]=[d("p",null,"No audit logs found for the selected criteria.",-1)])))]),h.value.length>p0?(M(),B("div",ede,[d("button",{onClick:C[4]||(C[4]=F=>f.value--),disabled:f.value===1,class:"btn btn-secondary"}," Previous ",8,tde),d("span",rde," Page "+Q(f.value)+" of "+Q(g.value)+" ("+Q(h.value.length)+" logs) ",1),d("button",{onClick:C[5]||(C[5]=F=>f.value++),disabled:f.value===g.value,class:"btn btn-secondary"}," Next ",8,nde)])):ve("",!0),a.value?(M(),B("div",{key:2,class:"log-dialog-overlay",onClick:v},[d("div",{class:"log-dialog",onClick:C[6]||(C[6]=Yr(()=>{},["stop"]))},[d("div",{class:"dialog-header"},[C[12]||(C[12]=d("h3",null," Audit Log Details",-1)),d("button",{onClick:v,class:"close-btn"},"")]),d("div",sde,[d("div",ade,[C[20]||(C[20]=d("h4",null,"Basic Information",-1)),d("div",ide,[d("div",ode,[C[13]||(C[13]=d("label",null,"Timestamp:",-1)),d("span",null,Q(T(a.value.timestamp)),1)]),d("div",lde,[C[14]||(C[14]=d("label",null,"Log Type:",-1)),d("span",{class:Ye(["type-badge",a.value.type])},Q(D(a.value.type)),3)]),d("div",cde,[C[15]||(C[15]=d("label",null,"Action:",-1)),d("span",null,Q(a.value.action||"N/A"),1)]),d("div",ude,[C[16]||(C[16]=d("label",null,"User Email:",-1)),d("span",null,Q(a.value.userEmail||a.value.performedByEmail||"Unknown"),1)]),d("div",dde,[C[17]||(C[17]=d("label",null,"User ID:",-1)),d("span",null,Q(a.value.userId||a.value.performedBy||"N/A"),1)]),d("div",fde,[C[18]||(C[18]=d("label",null,"Session ID:",-1)),d("span",null,Q(a.value.sessionId||"N/A"),1)]),d("div",hde,[C[19]||(C[19]=d("label",null,"IP Address:",-1)),d("span",null,Q(a.value.ipAddress||"N/A"),1)])])]),a.value.studentId||a.value.targetUserId?(M(),B("div",pde,[C[24]||(C[24]=d("h4",null,"Target Information",-1)),d("div",mde,[a.value.studentId?(M(),B("div",gde,[C[21]||(C[21]=d("label",null,"Student ID:",-1)),d("span",null,Q(a.value.studentId),1)])):ve("",!0),a.value.targetUserId?(M(),B("div",vde,[C[22]||(C[22]=d("label",null,"Target User ID:",-1)),d("span",null,Q(a.value.targetUserId),1)])):ve("",!0),a.value.studentIds?(M(),B("div",yde,[C[23]||(C[23]=d("label",null,"Student IDs:",-1)),d("span",null,Q(Array.isArray(a.value.studentIds)?a.value.studentIds.join(", "):a.value.studentIds),1)])):ve("",!0)])])):ve("",!0),a.value.details?(M(),B("div",xde,[C[25]||(C[25]=d("h4",null,"Additional Details",-1)),d("div",Ede,[d("pre",null,Q(S(a.value.details)),1)])])):ve("",!0),a.value.exportType||a.value.studentCount?(M(),B("div",bde,[C[28]||(C[28]=d("h4",null,"Export Information",-1)),d("div",_de,[a.value.exportType?(M(),B("div",Sde,[C[26]||(C[26]=d("label",null,"Export Type:",-1)),d("span",null,Q(a.value.exportType),1)])):ve("",!0),a.value.studentCount?(M(),B("div",Ade,[C[27]||(C[27]=d("label",null,"Student Count:",-1)),d("span",null,Q(a.value.studentCount),1)])):ve("",!0)])])):ve("",!0)]),d("div",{class:"dialog-actions"},[d("button",{onClick:v,class:"btn btn-secondary"},"Close")])])])):ve("",!0)]))}},wde=St(Tde,[["__scopeId","data-v-aacc574e"]]),Cde={class:"teacher-feedback-admin"},Ide={key:0,class:"status-message loading"},kde={key:1,class:"status-message success"},Dde={key:2,class:"status-message error"},Pde={class:"quick-actions"},Rde=["disabled"],Fde={class:"modal-body"},Nde={class:"form-group"},Ode={class:"form-group"},Mde={class:"form-group"},Lde={class:"form-group"},Bde={class:"modal-footer"},Ude=["disabled"],$de={key:0},Vde={key:1},Hde={class:"setup-section"},jde={key:0,class:"loading-state"},Gde={key:1,class:"status-card"},Wde={class:"status-header"},zde={class:"status-indicator"},Kde={key:0,class:"status-badge success"},qde={key:1,class:"status-badge info"},Xde={class:"status-details"},Yde={key:0},Qde={key:1},Jde={key:0},Zde={key:1,class:"info-note"},efe={key:0,class:"drive-actions"},tfe=["href"],rfe={key:2,class:"setup-options"},nfe={class:"setup-card"},sfe={class:"workspace-setup"},afe={class:"form-group"},ife=["disabled"],ofe=["disabled"],lfe={key:0},cfe={key:1},ufe={class:"forms-list"},dfe={key:0,class:"loading"},ffe={key:1,class:"empty-state"},hfe={key:2,class:"forms-grid"},pfe={class:"form-header"},mfe={class:"admin-action-btns"},gfe=["onClick"],vfe=["onClick"],yfe=["onClick"],xfe={class:"form-meta"},Efe={key:0},bfe=["href"],_fe={key:1},Sfe=["href"],Afe={key:2,class:"sheet-status pending"},Tfe={__name:"AdminTeacherFeedback",setup(t){const{isLoading:e,error:r,successMessage:n,formsLoading:s,activeForms:i,createFeedbackFormWithUserAuth:a,deleteFeedbackForm:o,clearMessages:l}=tx();_a();const c=Qr(),u=se(!1),f=se(""),h=se(""),p=se(""),g=se(""),y=se(null),_=se(!0),x=se(""),b=se("info"),v=se(""),T=se(!1),D=_e(()=>f.value.trim()&&p.value.trim()),k=async()=>{if(D.value)try{l();const{GoogleAuthProvider:P,signInWithPopup:R,getAuth:N}=await ua(async()=>{const{GoogleAuthProvider:j,signInWithPopup:ee,getAuth:ae}=await Promise.resolve().then(()=>j5);return{GoogleAuthProvider:j,signInWithPopup:ee,getAuth:ae}},void 0),L=N(),O=new P;O.addScope("https://www.googleapis.com/auth/drive.file"),O.addScope("https://www.googleapis.com/auth/spreadsheets");let V;try{V=await R(L,O)}catch(j){throw j.code==="auth/popup-closed-by-user"||j.message.includes("Cross-Origin-Opener-Policy")?new Error(" Authentication popup was blocked or closed. Please allow popups for this site and try again."):j}const U=P.credentialFromResult(V).accessToken;if(!U)throw new Error("Failed to get Google access token. Please try again.");console.log(" Got Google access token for feedback form creation");const G={title:f.value.trim(),description:h.value.trim(),formUrl:p.value.trim(),sheetTemplateUrl:g.value.trim(),createdBy:c.user.uid};await a(G,U),S()}catch(P){console.error("Error adding form:",P),P.code==="auth/popup-closed-by-user"?P.value=" Authentication cancelled. Please try again and allow Google Drive access.":P.code==="auth/popup-blocked"?P.value=" Popup blocked. Please allow popups for this site and try again.":P.message&&P.message.includes("Cross-Origin-Opener-Policy")?P.value=" Browser security policy blocked the authentication popup. Please try again or contact support.":P.value=P.message||"Failed to create feedback form"}},S=()=>{u.value=!1,f.value="",h.value="",p.value="",g.value="",l()},E=P=>{window.open(P.formUrl,"_blank","noopener,noreferrer")},m=async P=>{window.open(P.formUrl,"_blank","noopener,noreferrer")},A=async P=>{if(confirm(`Are you sure you want to delete "${P.title}"?`))try{await o(P.id)}catch(R){console.error("Error deleting form:",R)}},I=P=>P?(P.seconds?new Date(P.seconds*1e3):new Date(P)).toLocaleDateString():"N/A",C=async()=>{try{_.value=!0;const{getFunctions:P,httpsCallable:R}=await ua(async()=>{const{getFunctions:V,httpsCallable:z}=await Promise.resolve().then(()=>D0);return{getFunctions:V,httpsCallable:z}},void 0),N=P(),O=await R(N,"getUserSchool")();O.data.success&&O.data.school?y.value=O.data.school:await F()}catch(P){console.error("Error loading school info:",P),x.value="Error loading Google Drive settings",b.value="error"}finally{_.value=!1}},F=async()=>{try{const{getFunctions:P,httpsCallable:R}=await ua(async()=>{const{getFunctions:V,httpsCallable:z}=await Promise.resolve().then(()=>D0);return{getFunctions:V,httpsCallable:z}},void 0),N=P(),O=await R(N,"getOrCreateSchool")();O.data.success&&(y.value=O.data.school,O.data.school.isNew&&(x.value="Google Drive settings initialized! You can now create feedback forms.",b.value="success"))}catch(P){console.error("Error creating school:",P),x.value="Error initializing Google Drive settings: "+P.message,b.value="error"}},W=async()=>{if(v.value.trim()){T.value=!0,x.value="";try{const{getFunctions:P,httpsCallable:R}=await ua(async()=>{const{getFunctions:V,httpsCallable:z}=await Promise.resolve().then(()=>D0);return{getFunctions:V,httpsCallable:z}},void 0),N=P(),O=await R(N,"createSharedDrive")({schoolId:y.value.schoolId,driveName:v.value.trim()});if(O.data.requiresManualCreation){const V=O.data.instructions,z=O.data.serviceAccountEmail;x.value=`Google Workspace setup requires manual configuration:

1. ${V.join(`
2. `)}

Service Account Email: ${z}`,b.value="info"}else O.data.success?(x.value="Google Workspace setup completed successfully!",b.value="success",await C(),v.value=""):(x.value="Error setting up Google Workspace: "+O.data.error,b.value="error")}catch(P){console.error("Error setting up workspace:",P),x.value="Error setting up Google Workspace: "+P.message,b.value="error"}finally{T.value=!1}}};return Wt(async()=>{await C()}),(P,R)=>{var N;return M(),B("div",Cde,[R[35]||(R[35]=d("div",{class:"admin-header"},[d("h2",null,"Teacher Feedback Forms"),d("p",{class:"admin-description"}," Create and manage Google Forms for collecting teacher feedback on students. Each case manager will have their own response sheet automatically created when they first use the form. ")],-1)),q(e)?(M(),B("div",Ide," Processing... ")):ve("",!0),q(n)?(M(),B("div",kde,Q(q(n)),1)):ve("",!0),q(r)?(M(),B("div",Dde,Q(q(r)),1)):ve("",!0),d("div",Pde,[d("button",{onClick:R[0]||(R[0]=L=>u.value=!0),class:"primary-btn",disabled:q(e)},R[7]||(R[7]=[d("span",null,"",-1),we(" Add Form ")]),8,Rde)]),u.value?(M(),B("div",{key:3,class:"modal-overlay",onClick:S},[d("div",{class:"modal-content",onClick:R[5]||(R[5]=Yr(()=>{},["stop"]))},[d("div",{class:"modal-header"},[R[8]||(R[8]=d("h3",null,"Add Teacher Feedback Form",-1)),d("button",{onClick:S,class:"close-btn"},"")]),d("div",Fde,[d("div",Nde,[R[9]||(R[9]=d("label",null,"Form Title:",-1)),Oe(d("input",{type:"text","onUpdate:modelValue":R[1]||(R[1]=L=>f.value=L),placeholder:"Enter a descriptive title for this form",class:"form-input",required:""},null,512),[[ht,f.value]])]),d("div",Ode,[R[10]||(R[10]=d("label",null,"Form Description (optional):",-1)),Oe(d("textarea",{"onUpdate:modelValue":R[2]||(R[2]=L=>h.value=L),placeholder:"Brief description of what this form is for",class:"form-textarea",rows:"3"},null,512),[[ht,h.value]])]),d("div",Mde,[R[11]||(R[11]=d("label",null,"Google Form URL:",-1)),Oe(d("input",{type:"url","onUpdate:modelValue":R[3]||(R[3]=L=>p.value=L),placeholder:"https://docs.google.com/forms/d/your-form-id/viewform",class:"form-input",required:""},null,512),[[ht,p.value]]),R[12]||(R[12]=d("small",{class:"form-help"},"Paste the Google Form URL here (viewform link)",-1))]),d("div",Lde,[R[13]||(R[13]=d("label",null,"Google Sheet Template URL (optional):",-1)),Oe(d("input",{type:"url","onUpdate:modelValue":R[4]||(R[4]=L=>g.value=L),placeholder:"https://docs.google.com/spreadsheets/d/your-sheet-id/edit",class:"form-input"},null,512),[[ht,g.value]]),R[14]||(R[14]=d("small",{class:"form-help"},"Optional: Provide a Google Sheet template that case managers can duplicate for collecting responses",-1))]),R[15]||(R[15]=d("div",{class:"form-info"},[d("h4",null," Setup Instructions:"),d("ol",null,[d("li",null,"Create your Google Form manually with the questions you want"),d("li",null,'Make sure to enable "Collect email addresses" in form settings'),d("li",null,"Copy the form's view URL and paste it above"),d("li",null,'Click "Add Form" - a Google Sheet will be automatically created for responses')]),d("p",{class:"info-note"},[d("strong",null," Automatic:"),we(" A Google Sheet will be created immediately when you add the form. Each case manager will get their own copy of this sheet when they use the form. ")])],-1))]),d("div",Bde,[d("button",{onClick:S,class:"secondary-btn"},"Cancel"),d("button",{onClick:k,class:"primary-btn",disabled:!D.value||q(e)},[q(e)?(M(),B("span",$de,"Adding Form...")):(M(),B("span",Vde,"Add Form"))],8,Ude)])])])):ve("",!0),d("div",Hde,[R[25]||(R[25]=d("h3",null,"Google Drive Setup",-1)),R[26]||(R[26]=d("p",{class:"section-description"}," Configure how the system accesses Google Drive for creating feedback forms and response sheets. ",-1)),_.value?(M(),B("div",jde,R[16]||(R[16]=[d("p",null,"Loading Google Drive settings...",-1)]))):y.value?(M(),B("div",Gde,[d("div",Wde,[d("h4",null,Q(y.value.name||"Your School"),1),d("div",zde,[y.value.sharedDriveId?(M(),B("span",Kde,"  Google Workspace Mode ")):(M(),B("span",qde,"  Personal Google Drive Mode "))])]),d("div",Xde,[d("p",null,[R[17]||(R[17]=d("strong",null,"Current Mode:",-1)),y.value.sharedDriveId?(M(),B("span",Yde,"Google Workspace Shared Drive")):(M(),B("span",Qde,"Personal Google Drive"))]),y.value.sharedDriveId?(M(),B("p",Jde,[R[18]||(R[18]=d("strong",null,"Shared Drive:",-1)),we(" "+Q(y.value.sharedDriveName||"CaseManageVue Templates"),1)])):ve("",!0),y.value.sharedDriveId?ve("",!0):(M(),B("p",Zde,R[19]||(R[19]=[d("strong",null,"Note:",-1),we(" Files will be created in your personal Google Drive when you create forms. ")])))]),y.value.sharedDriveId?(M(),B("div",efe,[d("a",{href:`https://drive.google.com/drive/folders/${y.value.sharedDriveId}`,target:"_blank",class:"secondary-btn"},"  Open Shared Drive ",8,tfe)])):ve("",!0)])):ve("",!0),!_.value&&!((N=y.value)!=null&&N.sharedDriveId)?(M(),B("div",rfe,[R[24]||(R[24]=d("div",{class:"setup-card"},[d("h4",null," Personal Google Drive (Recommended for Testing)"),d("p",{class:"setup-description"}," Use your personal Google account to create forms and sheets. Files will be created in your personal Drive. "),d("div",{class:"setup-note"},[d("strong",null," Ready to use:"),we(" No additional setup required. When you create forms, you'll be prompted to sign in with your Google account. ")])],-1)),d("div",nfe,[R[22]||(R[22]=d("h4",null," Google Workspace (For Organizations)",-1)),R[23]||(R[23]=d("p",{class:"setup-description"}," Use a Google Workspace Shared Drive for organization-wide access and management. ",-1)),d("div",sfe,[d("div",afe,[R[20]||(R[20]=d("label",{for:"workspaceDriveName"},"Shared Drive Name:",-1)),Oe(d("input",{id:"workspaceDriveName","onUpdate:modelValue":R[6]||(R[6]=L=>v.value=L),type:"text",class:"form-input",placeholder:"e.g., CaseManageVue - School Name",disabled:T.value},null,8,ife),[[ht,v.value]])]),d("button",{onClick:W,class:"primary-btn",disabled:T.value||!v.value.trim()},[T.value?(M(),B("span",lfe," Setting up...")):(M(),B("span",cfe,"Setup Google Workspace"))],8,ofe),R[21]||(R[21]=d("div",{class:"workspace-note"},[d("strong",null,"Note:"),we(" This requires Google Workspace admin permissions and manual configuration. ")],-1))])])])):ve("",!0),x.value?(M(),B("div",{key:3,class:Ye(["alert",b.value])},Q(x.value),3)):ve("",!0)]),d("div",ufe,[R[34]||(R[34]=d("h3",null,"Feedback Forms",-1)),q(s)?(M(),B("div",dfe,"Loading forms...")):q(i).length===0?(M(),B("div",ffe,R[27]||(R[27]=[d("p",null,"No feedback forms added yet.",-1),d("p",null,'Click "Add Form" to get started.',-1)]))):(M(),B("div",hfe,[(M(!0),B(ke,null,He(q(i),L=>(M(),B("div",{key:L.id,class:"form-card"},[d("div",pfe,[d("h4",null,Q(L.title||"Untitled Form"),1),d("div",mfe,[d("button",{onClick:O=>E(L),class:"admin-action-btn info",title:"View Form"},"  ",8,gfe),d("button",{onClick:O=>m(L),class:"admin-action-btn edit",title:"Edit Form"},"  ",8,vfe),d("button",{onClick:O=>A(L),class:"admin-action-btn delete",title:"Delete Form"},"  ",8,yfe)])]),d("div",xfe,[d("p",null,[R[28]||(R[28]=d("strong",null,"Created:",-1)),we(" "+Q(I(L.createdAt)),1)]),L.description?(M(),B("p",Efe,[R[29]||(R[29]=d("strong",null,"Description:",-1)),we(" "+Q(L.description),1)])):ve("",!0),d("p",null,[R[30]||(R[30]=d("strong",null,"Form URL:",-1)),R[31]||(R[31]=we()),d("a",{href:L.formUrl,target:"_blank",class:"form-link"},"Open Form",8,bfe)]),L.spreadsheetUrl?(M(),B("p",_fe,[R[32]||(R[32]=d("strong",null,"Response Sheet:",-1)),d("a",{href:L.spreadsheetUrl,target:"_blank",class:"form-link"},"View Responses",8,Sfe),R[33]||(R[33]=d("span",{class:"sheet-status"}," Auto-created",-1))])):(M(),B("p",Afe," Sheet will be created when form is first used"))])]))),128))]))])])}}},wfe=St(Tfe,[["__scopeId","data-v-31360789"]]);function Cfe(t,e,r){const{getLabel:n}=Eo(),s=_e(()=>{var h;const f=((h=r.value)==null?void 0:h.numPeriods)||7;return Array.from({length:f},(p,g)=>({value:g.toString(),label:n(g+1),periodIndex:g}))}),i=_e(()=>{const f=new Set;return console.log(" Finding teachers from students:",t.value.length),t.value.forEach(h=>{var p,g,y,_,x;(p=h.aeries)!=null&&p.schedule&&Object.values(h.aeries.schedule).forEach(b=>{b&&b.teacherId&&(console.log(" Found teacher ID in aeries.schedule:",b.teacherId),f.add(String(b.teacherId)))}),(y=(g=h.app)==null?void 0:g.schedule)!=null&&y.periods&&Object.values(h.app.schedule.periods).forEach(b=>{b&&(console.log(" Found teacher ID in app.schedule.periods:",b),f.add(String(b)))});for(let b=1;b<=7;b++){const v=`period${b}TeacherId`,T=h[v]||((_=h.aeries)==null?void 0:_[v])||((x=h.app)==null?void 0:x[v]);T&&(console.log(" Found teacher ID in",v,":",T),f.add(String(T)))}}),console.log(" Unique teacher IDs found:",Array.from(f)),console.log(" Users available:",e.value.length),Array.from(f).map(h=>{let p=e.value.find(g=>g.id===h);return!p&&/^\d+$/.test(h)&&(p=e.value.find(g=>g.aeriesId===h)),{id:h,name:p?p.name||`${p.firstName} ${p.lastName}`:`Teacher ${h}`,actualUserId:p?p.id:null}}).sort((h,p)=>h.name.localeCompare(p.name))}),a=(f,h=[])=>{let p=-1;if(/^\d+$/.test(f))p=parseInt(f)-1;else if(f==="SH")p=6;else if(f.startsWith("Per")){const g=f.replace("Per","");/^\d+$/.test(g)&&(p=parseInt(g)-1)}return h.includes(p.toString())};return{availablePeriods:s,availableTeachers:i,getStudentsForTeachers:(f,h=[])=>{console.log(" CUSTOM TAB DEBUG: Filtering students for teachers:",f),console.log(" CUSTOM TAB DEBUG: Total students available:",t.value.length);const p=t.value.filter(g=>{var _,x,b,v,T,D,k,S,E,m,A,I,C,F,W,P,R,N,L,O,V,z,U;const y=((x=(_=g.app)==null?void 0:_.flags)==null?void 0:x.flag2)||((v=(b=g.app)==null?void 0:b.flags)==null?void 0:v.separateSetting)||g.separateSetting||g.flag2||!1;if(console.log(" CUSTOM TAB DEBUG: Student",(D=(T=g.app)==null?void 0:T.studentData)==null?void 0:D.firstName,"hasSeparateSetting:",y,"flags:",(k=g.app)==null?void 0:k.flags),!y)return!1;if(console.log(" CUSTOM TAB DEBUG: Checking schedules for student",(E=(S=g.app)==null?void 0:S.studentData)==null?void 0:E.firstName),console.log(" CUSTOM TAB DEBUG: Student schedule:",(m=g.app)==null?void 0:m.schedule),console.log(" CUSTOM TAB DEBUG: Student aeries schedule:",(A=g.aeries)==null?void 0:A.schedule),(I=g.aeries)!=null&&I.schedule){console.log(" CUSTOM TAB DEBUG: Checking aeries schedule for",(F=(C=g.app)==null?void 0:C.studentData)==null?void 0:F.firstName);const G=Object.entries(g.aeries.schedule);for(let j=0;j<G.length;j++){const[ee,ae]=G[j];if(console.log(" CUSTOM TAB DEBUG: Aeries period",ee,":",ae),ae&&ae.teacherId&&f.includes(String(ae.teacherId))&&(console.log(" CUSTOM TAB DEBUG: Found matching teacher in aeries schedule!"),!a(ee,h)))return!0}}if((W=g.app)!=null&&W.schedule&&typeof g.app.schedule=="object"){console.log(" CUSTOM TAB DEBUG: Checking app.schedule (direct) for",(R=(P=g.app)==null?void 0:P.studentData)==null?void 0:R.firstName);const G=Object.entries(g.app.schedule);for(let j=0;j<G.length;j++){const[ee,ae]=G[j],ne=typeof ae=="object"?ae.teacherId:ae;if(console.log(" CUSTOM TAB DEBUG: Direct schedule period",ee,":",ae,"actual teacher ID:",ne),ne&&f.includes(String(ne))&&(console.log(" CUSTOM TAB DEBUG: Found matching teacher in direct schedule!"),!a(ee,h)))return!0}}if((L=(N=g.app)==null?void 0:N.schedule)!=null&&L.periods){console.log(" CUSTOM TAB DEBUG: Checking app.schedule.periods for",(V=(O=g.app)==null?void 0:O.studentData)==null?void 0:V.firstName);const G=Object.entries(g.app.schedule.periods);for(let j=0;j<G.length;j++){const[ee,ae]=G[j];if(console.log(" CUSTOM TAB DEBUG: App schedule period",ee,":",ae),ae&&f.includes(String(ae))&&(console.log(" CUSTOM TAB DEBUG: Found matching teacher in app schedule!"),!a(ee,h)))return!0}}for(let G=0;G<7;G++){const j=`period${G+1}TeacherId`,ee=g[j]||((z=g.aeries)==null?void 0:z[j])||((U=g.app)==null?void 0:U[j]);if(ee&&f.includes(String(ee))&&!h.includes(G.toString()))return!0}return!1});return console.log(" CUSTOM TAB DEBUG: Filtered students result:",p.length,"students"),p},getStudentTeacherPeriods:(f,h,p=[])=>{var y,_,x,b,v;const g=[];if((y=f.aeries)!=null&&y.schedule){const T=Object.entries(f.aeries.schedule);for(let D=0;D<T.length;D++){const[k,S]=T[D];if(S&&S.teacherId&&h.includes(String(S.teacherId))&&!a(k,p)){let E=e.value.find(A=>A.id===String(S.teacherId));!E&&/^\d+$/.test(S.teacherId)&&(E=e.value.find(A=>A.aeriesId===String(S.teacherId)));const m=n(D+1);g.push({period:m,teacherName:E?E.name||`${E.firstName} ${E.lastName}`:`Teacher ${S.teacherId}`})}}}if((x=(_=f.app)==null?void 0:_.schedule)!=null&&x.periods){const T=Object.entries(f.app.schedule.periods);for(let D=0;D<T.length;D++){const[k,S]=T[D];if(S&&h.includes(String(S))&&!a(k,p)){const E=e.value.find(A=>A.id===String(S)),m=n(parseInt(k));g.push({period:m,teacherName:E?E.name||`${E.firstName} ${E.lastName}`:`Teacher ${S}`})}}}for(let T=0;T<7;T++){const D=`period${T+1}TeacherId`,k=f[D]||((b=f.aeries)==null?void 0:b[D])||((v=f.app)==null?void 0:v[D]);if(k&&h.includes(String(k))&&!p.includes(T.toString())){let S=e.value.find(m=>m.id===String(k));!S&&/^\d+$/.test(k)&&(S=e.value.find(m=>m.aeriesId===String(k)));const E=n(T+1);g.push({period:E,teacherName:S?S.name||`${S.firstName} ${S.lastName}`:`Teacher ${k}`})}}return g},generateCSV:()=>{const f=["Student ID","First Name","Last Name","Grade","Case Manager","Assessment Accommodations","Services"],h=t.value.map(g=>{var D,k,S,E,m;const y=at(g,"firstName")||"",_=at(g,"lastName")||"",x=at(g,"grade")||"",b=g.caseManagerId||((k=(D=g.app)==null?void 0:D.studentData)==null?void 0:k.caseManagerId)||"",v=((E=(S=g.app)==null?void 0:S.accommodations)==null?void 0:E.assessment)||[],T=((m=g.app)==null?void 0:m.classServices)||[];return[g.id||"",y,_,x,b,Array.isArray(v)?v.join("; "):v,Array.isArray(T)?T.map(A=>A.name||A).join("; "):T]});return[f,...h].map(g=>g.map(y=>`"${String(y).replace(/"/g,'""')}"`).join(",")).join(`
`)},downloadCSV:(f,h)=>{const p=new Blob([f],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a");g.href=URL.createObjectURL(p),g.download=h,g.click(),URL.revokeObjectURL(g.href)},isPeriodExcluded:a}}const Ife=()=>bt.app.options,SD=()=>{const t=Ife();return{apiKey:t.apiKey,clientId:`${t.messagingSenderId}-qe35vm8cv3jrdqhut23418a7ghfpafk5.apps.googleusercontent.com`,discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],scope:"https://www.googleapis.com/auth/spreadsheets",projectId:t.projectId,messagingSenderId:t.messagingSenderId}};console.log(" Google API Config loaded for project:",SD().projectId);const Lg="casemanage_linked_sheet_id",m0="Student Data",g0=SD(),tn={isInitialized:se(!1),tokenClient:se(null),accessToken:se(""),tokenResolve:null};function Bx(){const t=se(localStorage.getItem(Lg)||""),e=se(""),r=se(null),n=se("idle"),s=se(""),i=tn.isInitialized,a=tn.tokenClient,o=tn.accessToken,l=()=>new Promise((k,S)=>{var m,A,I;if((A=(m=window.google)==null?void 0:m.accounts)!=null&&A.oauth2&&((I=window.gapi)!=null&&I.client)&&a.value){console.log(" Google Auth already initialized, reusing existing token client"),k();return}const E=document.createElement("script");E.src="https://accounts.google.com/gsi/client",E.onload=()=>{a.value||(a.value=window.google.accounts.oauth2.initTokenClient({client_id:g0.clientId,scope:g0.scope,callback:F=>{F.access_token?(o.value=F.access_token,i.value=!0,window.gapi.client.setToken({access_token:F.access_token}),tn.tokenResolve&&(tn.tokenResolve(F),tn.tokenResolve=null)):(console.error("Failed to get access token"),tn.tokenResolve&&(tn.tokenResolve(null),tn.tokenResolve=null))}}));const C=document.createElement("script");C.src="https://apis.google.com/js/api.js",C.onload=()=>{window.gapi.load("client",async()=>{await window.gapi.client.init({apiKey:g0.apiKey,discoveryDocs:g0.discoveryDocs}),k()})},document.head.appendChild(C)},E.onerror=()=>S(new Error("Failed to load Google Identity Services")),document.head.appendChild(E)}),c=async()=>{if(!a.value)throw new Error("Google auth not initialized");if(o.value)try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:"1BxiMVs0XRA5nFMRigcZ_6g3D6P6dNTMhvBSm1x7kFNg"}),{access_token:o.value}}catch{console.log("Token expired, requesting new one"),o.value=""}return new Promise((k,S)=>{tn.tokenResolve=k;const E=setTimeout(()=>{tn.tokenResolve=null,S(new Error("Token request timed out"))},3e4),m=a.value.callback;a.value.callback=A=>{clearTimeout(E),a.value.callback=m,A.access_token?(o.value=A.access_token,i.value=!0,window.gapi.client.setToken({access_token:A.access_token}),tn.tokenResolve&&(tn.tokenResolve(A),tn.tokenResolve=null)):(console.error("Failed to get access token:",A),tn.tokenResolve&&(tn.tokenResolve(null),tn.tokenResolve=null))};try{a.value.requestAccessToken()}catch(A){clearTimeout(E),a.value.callback=m,S(A)}})},u=async(k,S=[])=>{var E;try{n.value="syncing",s.value="Creating new Google Sheet...",o.value||await c();const A=((E=uo().currentUser)==null?void 0:E.email)||"",I=await window.gapi.client.sheets.spreadsheets.create({properties:{title:`CaseManage Student Data - ${new Date().toLocaleDateString()}`,locale:"en_US",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},sheets:[{properties:{title:m0,gridProperties:{rowCount:1e3,columnCount:9,frozenRowCount:1}}}]}),C=I.result.spreadsheetId;t.value=C,e.value=`https://docs.google.com/spreadsheets/d/${C}`,localStorage.setItem(Lg,C),await f(k,S);const F=I.result.sheets[0].properties.sheetId;return await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:C,resource:{requests:[{repeatCell:{range:{sheetId:F,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:F,dimension:"COLUMNS",startIndex:0,endIndex:9}}},{addProtectedRange:{protectedRange:{range:{sheetId:F},description:`Read-only protection for ${m0}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),n.value="success",s.value="Sheet created and linked successfully!",r.value=new Date,window.open(e.value,"_blank"),{spreadsheetId:C,url:e.value}}catch(m){throw console.error("Error creating sheet:",m),n.value="error",s.value=`Failed to create sheet: ${m.message}`,m}},f=async(k,S=[])=>{if(!t.value)throw new Error("No linked sheet. Create a sheet first.");try{n.value="syncing",s.value="Updating Google Sheet...",o.value||await c();const E=k.filter(F=>{var P,R;return((R=(P=F.app)==null?void 0:P.flags)==null?void 0:R.flag1)||F.flag1||!1});console.log(" Google Sheets - Original students:",k.length),console.log(" Google Sheets - Filtered students (separate setting only):",E.length),console.log(" Google Sheets - Students data:",E),E&&E.length>0&&console.log(" Google Sheets - First student:",E[0]);const m=["Student ID","First Name","Last Name","Grade","Case Manager","Separate Setting","Assessment Accommodations","Services","Last Updated"],A=E.map(F=>{var W,P,R,N,L,O,V,z,U,G,j,ee;return console.log(" Processing student:",F.id,{firstName:F.firstName||((P=(W=F.app)==null?void 0:W.studentData)==null?void 0:P.firstName),lastName:F.lastName||((N=(R=F.app)==null?void 0:R.studentData)==null?void 0:N.lastName),grade:F.grade||((O=(L=F.app)==null?void 0:L.studentData)==null?void 0:O.grade)}),[F.id||"",F.firstName||((z=(V=F.app)==null?void 0:V.studentData)==null?void 0:z.firstName)||"",F.lastName||((G=(U=F.app)==null?void 0:U.studentData)==null?void 0:G.lastName)||"",F.grade||((ee=(j=F.app)==null?void 0:j.studentData)==null?void 0:ee.grade)||"",p(F,S)||"",_(F)||"",g(F,"assessment")||"",y(F)||"",new Date().toLocaleString()]}),I=[m,...A];console.log(" Google Sheets - Data to write:",I),await window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:t.value,range:`${m0}!A:Z`});const C=await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:t.value,range:`${m0}!A1`,valueInputOption:"RAW",resource:{values:I}});console.log(" Google Sheets - Update response:",C),n.value="success",s.value=`Updated ${A.length} students (separate setting only)`,r.value=new Date}catch(E){throw console.error("Error updating sheet:",E),n.value="error",s.value=`Failed to update: ${E.message}`,E.status===401&&(o.value="",await c()),E}},h=()=>{t.value="",e.value="",localStorage.removeItem(Lg),n.value="idle",s.value="",r.value=null},p=(k,S=[])=>{var A,I;const E=k.caseManagerId||((I=(A=k.app)==null?void 0:A.studentData)==null?void 0:I.caseManagerId)||k.casemanager_id;if(!E)return"Not Assigned";const m=S.find(C=>C.id===E);return m&&(m.name||`${m.firstName} ${m.lastName}`||m.email)||E},g=(k,S)=>{var m,A,I;const E=((A=(m=k.app)==null?void 0:m.accommodations)==null?void 0:A[S])||((I=k.accommodations)==null?void 0:I[S])||[];return Array.isArray(E)?E.join(", "):E},y=k=>{var E;const S=((E=k.app)==null?void 0:E.classServices)||k.classServices||[];return Array.isArray(S)?S.map(m=>m.name||m).join(", "):S},_=k=>{var E,m;return((m=(E=k.app)==null?void 0:E.flags)==null?void 0:m.flag1)||k.flag1||!1?"True":"False"},x=async()=>{if(!t.value)return!1;try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:t.value}),!0}catch(k){return k.status===404&&h(),!1}},b=async(k,S,E,m=[],A=[])=>{var I;if(!t.value)throw new Error("No linked sheet. Create a sheet first.");try{o.value||await c();const F=((I=uo().currentUser)==null?void 0:I.email)||"";console.log(" Creating custom tab:",k,"for teachers:",E,"excluding periods:",A);const P=(await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.value,resource:{requests:[{addSheet:{properties:{title:k,gridProperties:{rowCount:1e3,columnCount:12,frozenRowCount:1}}}}]}})).result.replies[0].addSheet.properties.sheetId;console.log(" Created sheet with ID:",P);const R=S.filter(V=>{var U,G;return((G=(U=V.app)==null?void 0:U.flags)==null?void 0:G.flag1)||V.flag1||!1});console.log(" Custom tab - Original students:",S.length),console.log(" Custom tab - Filtered students (separate setting only):",R.length);const N=["Student ID","First Name","Last Name","Grade","Case Manager","Period","Teacher","Subject","Separate Setting","Assessment Accommodations","Services","Last Updated"],L=[];R.forEach(V=>{const z=v(V,E,m,A);console.log(" Student:",V.id,"Periods found:",z.length,"Excluded periods:",A),z.forEach(U=>{console.log(" Adding row for period:",U.period,"teacher:",U.teacherName,"source:",U.source||"unknown")}),z.forEach(U=>{var G,j,ee,ae,ne,le;L.push([V.id||"",V.firstName||((j=(G=V.app)==null?void 0:G.studentData)==null?void 0:j.firstName)||"",V.lastName||((ae=(ee=V.app)==null?void 0:ee.studentData)==null?void 0:ae.lastName)||"",V.grade||((le=(ne=V.app)==null?void 0:ne.studentData)==null?void 0:le.grade)||"",p(V,m)||"",U.period||"",U.teacherName||"",U.subject||"",_(V)||"",g(V,"assessment")||"",y(V)||"",new Date().toLocaleString()])})});const O=[N,...L];return await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:t.value,range:`${k}!A1`,valueInputOption:"RAW",resource:{values:O}}),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.value,resource:{requests:[{repeatCell:{range:{sheetId:P,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:P,dimension:"COLUMNS",startIndex:0,endIndex:12}}},{addProtectedRange:{protectedRange:{range:{sheetId:P},description:`Read-only protection for ${k}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),console.log(" Custom tab created successfully with",L.length,"rows and read-only protection"),{sheetId:P,rowCount:L.length}}catch(C){throw console.error("Error creating custom tab:",C),C}},v=(k,S,E=[],m=[])=>{var C,F,W,P,R;const A=[];console.log(" getStudentPeriodsForTeachers for student:",k.id,"teacherIds:",S,"excludedPeriods:",m,"excludedPeriods array:",JSON.stringify(m));const I=N=>{let L=-1;if(/^\d+$/.test(N))L=parseInt(N)-1;else if(N==="SH")L=6;else if(N.startsWith("Per")){const O=N.replace("Per","");/^\d+$/.test(O)&&(L=parseInt(O)-1)}return console.log(" Period",N,"maps to index",L,"excluded?",m.includes(L.toString())),m.includes(L.toString())};if((C=k.aeries)!=null&&C.schedule){const N=Object.entries(k.aeries.schedule);console.log(" Aeries schedule entries:",N.length);for(let L=0;L<N.length;L++){const[O,V]=N[L],z=I(O);console.log(" Checking aeries period key:",O,"teacherId:",V==null?void 0:V.teacherId,"excluded?",z),V&&V.teacherId&&S.includes(String(V.teacherId))&&(z?console.log(" Excluding aeries period",O):(console.log(" Including aeries period",O),A.push({period:O.replace("period",""),teacherId:V.teacherId,teacherName:T(V.teacherId,E),subject:V.subject||"",source:"aeries"})))}}if((W=(F=k.app)==null?void 0:F.schedule)!=null&&W.periods){const N=Object.entries(k.app.schedule.periods);console.log(" App schedule entries:",N.length);for(let L=0;L<N.length;L++){const[O,V]=N[L],z=I(O);console.log(" Checking app period key:",O,"teacherId:",V,"excluded?",z),V&&S.includes(String(V))&&(z?console.log(" Excluding app period",O):(console.log(" Including app period",O),A.push({period:O,teacherId:V,teacherName:T(V,E),subject:"",source:"app"})))}}for(let N=0;N<7;N++){const L=`period${N+1}TeacherId`,O=k[L]||((P=k.aeries)==null?void 0:P[L])||((R=k.app)==null?void 0:R[L]);if(O&&S.includes(String(O))){const V=m.includes(N.toString());console.log(" Checking CSV period index",N,"field:",L,"teacherId:",O,"excluded?",V),V?console.log(" Excluding CSV period",N):(console.log(" Including CSV period",N),A.push({period:(N+1).toString(),teacherId:O,teacherName:T(O,E),subject:"",source:"csv"}))}}return console.log(" Final periods for student",k.id,":",A.length,A),A},T=(k,S=[])=>{let E=S.find(m=>m.id===k);return!E&&/^\d+$/.test(k)&&(E=S.find(m=>m.aeriesId===k)),E?E.name||`${E.firstName} ${E.lastName}`||`Teacher ${k}`:`Teacher ${k}`};return{isInitialized:i,linkedSheetId:t,linkedSheetUrl:e,lastSyncTime:r,syncStatus:n,syncMessage:s,initializeGoogleAuth:l,requestAccessToken:c,createLinkedSheet:u,updateSheetData:f,createCustomTab:b,deleteCustomTab:async k=>{if(!t.value)throw new Error("No linked sheet.");try{o.value||await c(),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.value,resource:{requests:[{deleteSheet:{sheetId:k}}]}}),console.log(" Deleted custom tab with sheet ID:",k)}catch(S){throw console.error("Error deleting custom tab:",S),S}},unlinkSheet:h,checkSheetConnection:x}}const kfe=Object.freeze(Object.defineProperty({__proto__:null,globalAuthState:tn,useGoogleSheetsRealtime:Bx},Symbol.toStringTag,{value:"Module"}));function Dfe(t,e,r){const{generateCSV:n,downloadCSV:s}=r,{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeGoogleAuth:u,createLinkedSheet:f,updateSheetData:h,createCustomTab:p,deleteCustomTab:g,unlinkSheet:y,checkSheetConnection:_}=Bx();let x=null,b=!1;const v=async()=>{try{const F=localStorage.getItem("casemanage_linked_sheet_id");F&&F.startsWith("1XSL0Sl7")&&(console.log("Clearing old sheet ID that was causing 403 errors"),localStorage.removeItem("casemanage_linked_sheet_id")),await u(),i.value&&await _()&&(tn.isInitialized.value&&tn.accessToken.value?(await S(),T()):console.log(" Google Auth not fully ready, skipping initial sync"))}catch(F){console.error("Failed to initialize Google Auth:",F)}};Ht(()=>t.value,(F,W)=>{F&&W&&F!==W&&(b=!0,console.log(" Student data changed, will sync on next interval")),F!=null&&F.length},{deep:!0});const T=()=>{x&&clearInterval(x),x=setInterval(async()=>{if(i.value&&b&&l.value!=="syncing")try{console.log(" Hourly auto-sync starting..."),await S(),b=!1,console.log(" Hourly auto-sync completed")}catch(F){console.error(" Hourly auto-sync failed:",F)}},36e5)},D=()=>{x&&clearInterval(x)},k=async()=>{try{await f(t.value,e.value),T()}catch(F){console.error("Failed to create linked sheet:",F),alert("Failed to create Google Sheet. Please make sure you are signed in to Google.")}},S=async()=>{if(!(!i.value||l.value==="syncing"))try{await h(t.value,e.value)}catch(F){console.error("Failed to sync sheet:",F),alert("Failed to sync sheet. Please try again.")}};return{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeIntegration:v,createLinkedGoogleSheet:k,syncNow:S,openGoogleSheet:()=>{a.value&&(window.open(a.value,"_blank","noopener,noreferrer")||(window.location.href=a.value))},unlinkSheet:y,createCustomTab:p,deleteCustomTab:g,createGoogleSheetWithData:()=>{const F=n();s(F,"student_data.csv"),window.open("https://sheets.new","_blank")},createBlankGoogleSheet:()=>{window.open("https://sheets.new","_blank")},exportToCSV:()=>{const F=n();s(F,"student_data_export.csv")},formatTime:F=>new Date(F).toLocaleString(),setupAutoSync:T,cleanupAutoSync:D}}function Pfe(t,e){const{getStudentsForTeachers:r}=t,{createCustomTab:n,deleteCustomTab:s}=e,i=se([]),a=se(!1),o=se(""),l=se([]),c=se([]),u=5,f=_e(()=>l.value.length===0?[]:r(l.value,c.value)),h=async _=>{if(!o.value.trim()||l.value.length===0){alert("Please enter a tab name and select at least one teacher");return}if(i.value.length>=u){alert(`Maximum of ${u} custom tabs allowed`);return}try{const x=r(l.value,c.value),b=await n(o.value.trim(),x,l.value,_,c.value),v={id:Date.now().toString(),name:o.value.trim(),teachers:[...l.value],studentCount:b.rowCount,sheetId:b.sheetId};i.value.push(v),g(),console.log("Custom tab added:",v),alert(`Custom tab "${v.name}" created successfully with ${b.rowCount} student entries!`)}catch(x){console.error("Failed to create custom tab:",x),alert("Failed to create custom tab in Google Sheet. Please try again.")}},p=async _=>{const x=i.value.find(b=>b.id===_);if(x&&confirm(`Are you sure you want to remove the "${x.name}" tab?`))try{x.sheetId&&await s(x.sheetId),i.value=i.value.filter(b=>b.id!==_),console.log("Custom tab removed:",_),alert(`Tab "${x.name}" removed successfully.`)}catch(b){console.error("Failed to delete custom tab:",b),alert("Failed to delete tab from Google Sheet. You may need to delete it manually."),i.value=i.value.filter(v=>v.id!==_)}},g=()=>{o.value="",l.value=[],c.value=[],a.value=!1};return{customTabs:i,showAddTabForm:a,newTabName:o,selectedTeachers:l,selectedExcludedPeriods:c,maxCustomTabs:u,filteredStudentsPreview:f,addCustomTab:h,removeCustomTab:p,resetForm:g,toggleAddTabForm:()=>{a.value=!a.value,a.value||g()}}}const Rfe={class:"sheets-section"},Ffe={key:0,class:"linked-sheet-status"},Nfe={class:"status-card success"},Ofe={class:"sync-info"},Mfe={key:0},Lfe={key:1,class:"syncing"},Bfe={key:2,class:"success"},Ufe={key:3,class:"error"},$fe={class:"sheet-actions"},Vfe=["disabled"],Hfe={key:1,class:"create-sheet-section"},jfe={class:"alternative-options"},Gfe={class:"button-group"},Wfe={__name:"GoogleSheetsConnector",props:{linkedSheetId:String,lastSyncTime:[String,Date],syncStatus:String,syncMessage:String},emits:["openGoogleSheet","syncNow","unlinkSheet","createLinkedGoogleSheet","createGoogleSheetWithData","createBlankGoogleSheet","exportToCSV"],setup(t){const e=r=>new Date(r).toLocaleString();return(r,n)=>(M(),B("div",Rfe,[n[12]||(n[12]=d("h4",null,"Google Sheets Integration",-1)),t.linkedSheetId?(M(),B("div",Ffe,[d("div",Nfe,[n[7]||(n[7]=d("h5",null," Linked Google Sheet",-1)),n[8]||(n[8]=d("p",null,"Your student data is synced to Google Sheets",-1)),d("button",{onClick:n[0]||(n[0]=s=>r.$emit("openGoogleSheet")),class:"sheet-link"}," Open Google Sheet  "),d("div",Ofe,[t.lastSyncTime?(M(),B("span",Mfe,"Last synced: "+Q(e(t.lastSyncTime)),1)):ve("",!0),t.syncStatus==="syncing"?(M(),B("span",Lfe," Syncing...")):t.syncStatus==="success"?(M(),B("span",Bfe," Synced")):t.syncStatus==="error"?(M(),B("span",Ufe," "+Q(t.syncMessage),1)):ve("",!0)]),n[9]||(n[9]=d("div",{class:"auto-sync-info"},[d("span",{class:"auto-sync-badge"},[d("span",{class:"pulse"}),we(" Auto-sync enabled ")]),d("p",{class:"auto-sync-description"}," Changes to student data, accommodations, and services are automatically synced to your Google Sheet. ")],-1)),d("div",$fe,[d("button",{onClick:n[1]||(n[1]=s=>r.$emit("syncNow")),disabled:t.syncStatus==="syncing",class:"btn-sync"}," Sync Now ",8,Vfe),d("button",{onClick:n[2]||(n[2]=s=>r.$emit("unlinkSheet")),class:"btn-unlink"}," Unlink Sheet ")])])])):(M(),B("div",Hfe,[n[10]||(n[10]=En('<h5 data-v-ec72cef0>Create a Linked Google Sheet</h5><p data-v-ec72cef0>Link your student data to a Google Sheet that automatically updates when changes are made.</p><div class="features-list" data-v-ec72cef0><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0></span><span data-v-ec72cef0>Auto-syncs when students are added or updated</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0></span><span data-v-ec72cef0>Updates accommodations and services in real-time</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0></span><span data-v-ec72cef0>Maintains a live connection to your data</span></div></div>',3)),d("button",{onClick:n[3]||(n[3]=s=>r.$emit("createLinkedGoogleSheet")),class:"btn-primary"},"  Create & Link Google Sheet ")])),d("div",jfe,[n[11]||(n[11]=d("h5",null,"Other Export Options",-1)),d("div",Gfe,[d("button",{onClick:n[4]||(n[4]=s=>r.$emit("createGoogleSheetWithData")),class:"btn-secondary"},"  Create Google Sheet with Data (One-time) "),d("button",{onClick:n[5]||(n[5]=s=>r.$emit("createBlankGoogleSheet")),class:"btn-secondary"},"  Create Blank Google Sheet "),d("button",{onClick:n[6]||(n[6]=s=>r.$emit("exportToCSV")),class:"btn-secondary"},"  Export to CSV Only ")])])]))}},zfe=St(Wfe,[["__scopeId","data-v-ec72cef0"]]),Kfe={class:"preview-section"},qfe={class:"preview-table"},Xfe={key:0},Yfe={key:0},Qfe={key:0,class:"preview-note"},Bg=5,Jfe={__name:"StudentPreview",props:{filteredStudents:{type:Array,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},setup(t){const e=t,r=_e(()=>e.filteredStudents.slice(0,Bg)),n=a=>{const o=at(a,"firstName")||"",l=at(a,"lastName")||"";return`${o} ${l}`.trim()},s=a=>at(a,"grade")||"",i=a=>e.getStudentTeacherPeriods(a,e.selectedTeachers,e.selectedExcludedPeriods);return(a,o)=>(M(),B("div",Kfe,[d("h6",null,"Preview ("+Q(t.filteredStudents.length)+" students)",1),d("div",qfe,[d("table",null,[o[0]||(o[0]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Period"),d("th",null,"Teacher")])],-1)),d("tbody",null,[(M(!0),B(ke,null,He(r.value,l=>(M(),B("tr",{key:l.id},[d("td",null,Q(n(l)),1),d("td",null,Q(s(l)),1),d("td",null,[(M(!0),B(ke,null,He(i(l),(c,u)=>(M(),B("span",{key:u},[we(Q(c.period),1),u<i(l).length-1?(M(),B("span",Xfe,", ")):ve("",!0)]))),128))]),d("td",null,[(M(!0),B(ke,null,He(i(l),(c,u)=>(M(),B("span",{key:u},[we(Q(c.teacherName),1),u<i(l).length-1?(M(),B("span",Yfe,", ")):ve("",!0)]))),128))])]))),128))])]),t.filteredStudents.length>Bg?(M(),B("p",Qfe," ... and "+Q(t.filteredStudents.length-Bg)+" more students ",1)):ve("",!0)])]))}},Zfe=St(Jfe,[["__scopeId","data-v-936b1ce9"]]),e0e={class:"custom-tabs-config"},t0e={class:"add-tab-controls"},r0e=["disabled"],n0e={key:0,class:"max-tabs-warning"},s0e={key:0,class:"add-tab-form"},a0e={class:"form-group"},i0e=["value"],o0e={class:"form-group"},l0e={class:"teacher-checkboxes"},c0e=["value","checked","onChange"],u0e={class:"form-group"},d0e={class:"period-checkboxes"},f0e=["value","checked","onChange"],h0e={class:"form-actions"},p0e={key:1,class:"existing-tabs"},m0e={class:"tab-teachers"},g0e=["onClick"],v0e={__name:"CustomTabManager",props:{customTabs:{type:Array,required:!0},showAddTabForm:{type:Boolean,required:!0},newTabName:{type:String,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},maxCustomTabs:{type:Number,required:!0},availableTeachers:{type:Array,required:!0},availablePeriods:{type:Array,required:!0},filteredStudentsPreview:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},emits:["toggleAddTabForm","update:newTabName","updateSelectedTeachers","updateSelectedExcludedPeriods","addCustomTab","removeCustomTab","resetForm"],setup(t){return(e,r)=>(M(),B("div",e0e,[r[8]||(r[8]=d("h5",null,"Custom Teacher Tabs",-1)),r[9]||(r[9]=d("p",null,"Create custom tabs with data filtered by specific teachers",-1)),d("div",t0e,[d("button",{onClick:r[0]||(r[0]=n=>e.$emit("toggleAddTabForm")),disabled:t.customTabs.length>=t.maxCustomTabs,class:"btn-primary"}," + Add Custom Tab ",8,r0e),t.customTabs.length>=t.maxCustomTabs?(M(),B("span",n0e," Maximum of "+Q(t.maxCustomTabs)+" custom tabs allowed ",1)):ve("",!0)]),t.showAddTabForm?(M(),B("div",s0e,[d("div",a0e,[r[4]||(r[4]=d("label",null,"Tab Name",-1)),d("input",{value:t.newTabName,onInput:r[1]||(r[1]=n=>e.$emit("update:newTabName",n.target.value)),type:"text",class:"form-input",placeholder:"e.g., Math Teachers",maxlength:"30"},null,40,i0e)]),d("div",o0e,[r[5]||(r[5]=d("label",null,"Select Teachers",-1)),d("div",l0e,[(M(!0),B(ke,null,He(t.availableTeachers,n=>(M(),B("label",{key:n.id,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.id,checked:t.selectedTeachers.includes(n.id),onChange:s=>e.$emit("updateSelectedTeachers",n.id,s.target.checked)},null,40,c0e),we(" "+Q(n.name),1)]))),128))])]),d("div",u0e,[r[6]||(r[6]=d("label",null,"Exclude Periods (Optional)",-1)),d("div",d0e,[(M(!0),B(ke,null,He(t.availablePeriods,n=>(M(),B("label",{key:n.value,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.value,checked:t.selectedExcludedPeriods.includes(n.value),onChange:s=>e.$emit("updateSelectedExcludedPeriods",n.value,s.target.checked)},null,40,f0e),we(" "+Q(n.label),1)]))),128))])]),t.selectedTeachers.length>0?(M(),Qt(Zfe,{key:0,"filtered-students":t.filteredStudentsPreview,"selected-teachers":t.selectedTeachers,"selected-excluded-periods":t.selectedExcludedPeriods,"get-student-teacher-periods":t.getStudentTeacherPeriods},null,8,["filtered-students","selected-teachers","selected-excluded-periods","get-student-teacher-periods"])):ve("",!0),d("div",h0e,[d("button",{onClick:r[2]||(r[2]=n=>e.$emit("addCustomTab")),class:"btn-primary"}," Create Tab "),d("button",{onClick:r[3]||(r[3]=n=>e.$emit("resetForm")),class:"btn-secondary"}," Cancel ")])])):ve("",!0),t.customTabs.length>0?(M(),B("div",p0e,[r[7]||(r[7]=d("h6",null,"Current Custom Tabs",-1)),(M(!0),B(ke,null,He(t.customTabs,n=>(M(),B("div",{key:n.id,class:"tab-item"},[d("div",null,[d("strong",null,Q(n.name),1),d("span",m0e,Q(n.teachers.length)+" teacher(s), "+Q(n.studentCount)+" students ",1)]),d("button",{onClick:s=>e.$emit("removeCustomTab",n.id),class:"btn-danger btn-small"}," Remove ",8,g0e)]))),128))])):ve("",!0)]))}},y0e=St(v0e,[["__scopeId","data-v-236484db"]]),x0e={class:"testing-links-container"},E0e={__name:"TestingLinks",setup(t){const{students:e,fetchStudents:r}=Di(),{userList:n,fetchUsers:s}=_a(),{appSettings:i,loadAppSettings:a}=Ts(),o=Cfe(e,n,i),{availablePeriods:l,availableTeachers:c,getStudentTeacherPeriods:u}=o,f=Dfe(e,n,o),{linkedSheetId:h,lastSyncTime:p,syncStatus:g,syncMessage:y,initializeIntegration:_,createLinkedGoogleSheet:x,syncNow:b,openGoogleSheet:v,unlinkSheet:T,createGoogleSheetWithData:D,createBlankGoogleSheet:k,exportToCSV:S,cleanupAutoSync:E}=f,m=Pfe(o,f),{customTabs:A,showAddTabForm:I,newTabName:C,selectedTeachers:F,selectedExcludedPeriods:W,maxCustomTabs:P,filteredStudentsPreview:R,addCustomTab:N,removeCustomTab:L,resetForm:O,toggleAddTabForm:V}=m,z=(j,ee)=>{if(ee)F.value.includes(j)||F.value.push(j);else{const ae=F.value.indexOf(j);ae>-1&&F.value.splice(ae,1)}},U=(j,ee)=>{if(ee)W.value.includes(j)||W.value.push(j);else{const ae=W.value.indexOf(j);ae>-1&&W.value.splice(ae,1)}},G=async()=>{await N(n.value)};return Wt(async()=>{try{await Promise.all([r(),s(),a()]),console.log("Students loaded:",e.value.length),console.log("Users loaded:",n.value.length),console.log("App settings loaded:",i.value),await _()}catch(j){console.error("Failed to initialize TestingLinks:",j)}}),ja(()=>{E()}),(j,ee)=>(M(),B("div",x0e,[ee[1]||(ee[1]=d("h3",null,"Testing Links & Google Sheets Integration",-1)),Re(zfe,{"linked-sheet-id":q(h),"last-sync-time":q(p),"sync-status":q(g),"sync-message":q(y),onOpenGoogleSheet:q(v),onSyncNow:q(b),onUnlinkSheet:q(T),onCreateLinkedGoogleSheet:q(x),onCreateGoogleSheetWithData:q(D),onCreateBlankGoogleSheet:q(k),onExportToCsv:q(S)},null,8,["linked-sheet-id","last-sync-time","sync-status","sync-message","onOpenGoogleSheet","onSyncNow","onUnlinkSheet","onCreateLinkedGoogleSheet","onCreateGoogleSheetWithData","onCreateBlankGoogleSheet","onExportToCsv"]),q(h)?(M(),Qt(y0e,{key:0,"custom-tabs":q(A),"show-add-tab-form":q(I),"new-tab-name":q(C),"selected-teachers":q(F),"selected-excluded-periods":q(W),"max-custom-tabs":q(P),"available-teachers":q(c),"available-periods":q(l),"filtered-students-preview":q(R),"get-student-teacher-periods":q(u),onToggleAddTabForm:q(V),"onUpdate:newTabName":ee[0]||(ee[0]=ae=>C.value=ae),onUpdateSelectedTeachers:z,onUpdateSelectedExcludedPeriods:U,onAddCustomTab:G,onRemoveCustomTab:q(L),onResetForm:q(O)},null,8,["custom-tabs","show-add-tab-form","new-tab-name","selected-teachers","selected-excluded-periods","max-custom-tabs","available-teachers","available-periods","filtered-students-preview","get-student-teacher-periods","onToggleAddTabForm","onRemoveCustomTab","onResetForm"])):ve("",!0)]))}},b0e=St(E0e,[["__scopeId","data-v-c213a5d7"]]),_0e={class:"admin-dashboard"},S0e={class:"stats-grid"},A0e={class:"stat-card primary"},T0e={class:"stat-icon"},w0e={class:"stat-content"},C0e={class:"stat-card iep"},I0e={class:"stat-icon"},k0e={class:"stat-content"},D0e={class:"stat-card plan-504"},P0e={class:"stat-icon"},R0e={class:"stat-content"},F0e={class:"stat-card users"},N0e={class:"stat-icon"},O0e={class:"stat-content"},M0e={class:"role-breakdown"},L0e={class:"role-stats-grid"},B0e={class:"role-icon"},U0e={class:"role-info"},$0e={class:"role-count"},V0e={class:"role-name"},H0e={class:"categories-grid"},j0e={class:"category-card"},G0e={class:"category-header"},W0e={class:"category-content"},z0e={class:"feature-list"},K0e={class:"feature-item"},q0e={class:"feature-icon"},X0e={class:"feature-item"},Y0e={class:"feature-icon"},Q0e={class:"feature-item"},J0e={class:"feature-icon"},Z0e={class:"category-card"},ehe={class:"category-header"},the={class:"category-content"},rhe={class:"feature-list"},nhe={class:"feature-item"},she={class:"feature-icon"},ahe={class:"feature-item"},ihe={class:"feature-icon"},ohe={class:"feature-item"},lhe={class:"feature-icon"},che={class:"category-card"},uhe={class:"category-header"},dhe={class:"category-content"},fhe={class:"feature-list"},hhe={class:"feature-item"},phe={class:"feature-icon"},mhe={class:"feature-item"},ghe={class:"feature-icon"},vhe={class:"feature-item"},yhe={class:"feature-icon"},xhe={class:"feature-item"},Ehe={class:"feature-icon"},bhe={class:"feature-item"},_he={class:"feature-icon"},She={class:"category-card"},Ahe={class:"category-header"},The={class:"category-content"},whe={class:"feature-list"},Che={class:"feature-item"},Ihe={class:"feature-icon"},khe={class:"feature-item"},Dhe={class:"feature-icon"},Phe={class:"feature-item"},Rhe={class:"feature-icon"},Fhe={class:"system-status"},Nhe={class:"status-grid"},Ohe={class:"status-card"},Mhe={class:"sync-status"},Lhe={class:"sync-item"},Bhe={key:0,class:"sync-time"},Uhe={class:"sync-item"},$he={class:"sync-time"},Vhe={class:"status-card"},Hhe={class:"user-activity"},jhe={class:"activity-item"},Ghe={class:"activity-count"},Whe={class:"activity-item"},zhe={class:"activity-count"},Khe={class:"status-card"},qhe={class:"health-indicators"},Xhe={class:"health-item"},Yhe={class:"health-status healthy"},Qhe={class:"health-item"},Jhe={class:"health-status healthy"},Zhe={class:"quick-actions"},epe={class:"actions-grid"},tpe={__name:"AdminDashboard",emits:["goToCategory","goToStudents"],setup(t){const{students:e,fetchStudents:r}=Di(),{userList:n,fetchUsers:s}=_a(),{linkedSheetId:i,lastSyncTime:a}=Bx(),o=se(12),l=se(8),c=se(!0),u=se("Connected"),f=_e(()=>{var b;return((b=e.value)==null?void 0:b.length)||0}),h=_e(()=>{var b;return((b=n.value)==null?void 0:b.length)||0}),p=_e(()=>{var b;return((b=e.value)==null?void 0:b.filter(v=>{var D,k;return(((k=(D=v.app)==null?void 0:D.studentData)==null?void 0:k.plan)||v.plan||"").toLowerCase()==="iep"}).length)||0}),g=_e(()=>{var b;return((b=e.value)==null?void 0:b.filter(v=>{var D,k;return(((k=(D=v.app)==null?void 0:D.studentData)==null?void 0:k.plan)||v.plan||"")==="504"}).length)||0}),y=_e(()=>{var T;const b={};(T=n.value)==null||T.forEach(D=>{const k=D.role||"unknown";b[k]||(b[k]=0),b[k]++});const v={admin:{name:"Administrators",icon:$v},school_admin:{name:"School Admins",icon:yB},teacher:{name:"Teachers",icon:YL},case_manager:{name:"Case Managers",icon:R0},paraeducator:{name:"Paraeducators",icon:km},service_provider:{name:"Service Providers",icon:u4},sped_chair:{name:"SPED Chairs",icon:QL},admin_504:{name:"504 Admins",icon:Uv},staff_view:{name:"Staff (View)",icon:zl},staff_edit:{name:"Staff (Edit)",icon:Vv}};return Object.entries(b).map(([D,k])=>{var S,E;return{name:((S=v[D])==null?void 0:S.name)||D.replace("_"," ").toUpperCase(),count:k,icon:((E=v[D])==null?void 0:E.icon)||zl}}).sort((D,k)=>k.count-D.count).slice(0,8)});_e(()=>i.value?1:0);const _=_e(()=>!!i.value),x=b=>b?new Date(b).toLocaleString():"Never";return Wt(async()=>{try{await Promise.all([r(),s()])}catch(b){console.error("Error loading dashboard data:",b)}}),(b,v)=>(M(),B("div",_0e,[d("div",S0e,[d("div",A0e,[d("div",T0e,[Re(q(zl),{size:32})]),d("div",w0e,[d("h3",null,Q(f.value),1),v[8]||(v[8]=d("p",null,"Total Students",-1))])]),d("div",C0e,[d("div",I0e,[Re(q(qu),{size:32})]),d("div",k0e,[d("h3",null,Q(p.value),1),v[9]||(v[9]=d("p",null,"IEP Students",-1))])]),d("div",D0e,[d("div",P0e,[Re(q(Uv),{size:32})]),d("div",R0e,[d("h3",null,Q(g.value),1),v[10]||(v[10]=d("p",null,"504 Plan Students",-1))])]),d("div",F0e,[d("div",N0e,[Re(q(R0),{size:32})]),d("div",O0e,[d("h3",null,Q(h.value),1),v[11]||(v[11]=d("p",null,"System Users",-1))])])]),d("div",M0e,[d("h2",null,[Re(q(d4),{size:20}),v[12]||(v[12]=we(" Staff Role Distribution"))]),d("div",L0e,[(M(!0),B(ke,null,He(y.value,T=>(M(),B("div",{class:"role-stat",key:T.name},[d("div",B0e,[(M(),Qt(T1(T.icon),{size:24}))]),d("div",U0e,[d("span",$0e,Q(T.count),1),d("span",V0e,Q(T.name),1)])]))),128))])]),d("div",H0e,[d("div",j0e,[d("div",G0e,[d("h2",null,[Re(q(zl),{size:18}),v[13]||(v[13]=we(" User & Student Management"))]),d("button",{onClick:v[0]||(v[0]=T=>b.$emit("goToCategory","users-students")),class:"category-btn"},[Re(q(Kf),{size:16}),v[14]||(v[14]=we(" Manage "))])]),d("div",W0e,[d("div",z0e,[d("div",K0e,[d("div",q0e,[Re(q(f4),{size:18})]),v[15]||(v[15]=d("div",null,[d("h4",null,"Add Users"),d("p",null,"Create new user accounts with role assignments")],-1))]),d("div",X0e,[d("div",Y0e,[Re(q(Vv),{size:18})]),v[16]||(v[16]=d("div",null,[d("h4",null,"Manage Users"),d("p",null,"Edit existing users, roles, and permissions")],-1))]),d("div",Q0e,[d("div",J0e,[Re(q(oB),{size:18})]),v[17]||(v[17]=d("div",null,[d("h4",null,"Student Administration"),d("p",null,"Comprehensive student data management")],-1))])])])]),d("div",Z0e,[d("div",ehe,[d("h2",null,[Re(q(km),{size:18}),v[18]||(v[18]=we(" Paraeducator Management"))]),d("button",{onClick:v[1]||(v[1]=T=>b.$emit("goToCategory","aide-management")),class:"category-btn"},[Re(q(Kf),{size:16}),v[19]||(v[19]=we(" Manage "))])]),d("div",the,[d("div",rhe,[d("div",nhe,[d("div",she,[Re(q(tB),{size:18})]),v[20]||(v[20]=d("div",null,[d("h4",null,"Aide Assignment"),d("p",null,"Assign paraeducators to students and periods")],-1))]),d("div",ahe,[d("div",ihe,[Re(q(JL),{size:18})]),v[21]||(v[21]=d("div",null,[d("h4",null,"Aide Schedule"),d("p",null,"Manage paraeducator schedules and assignments")],-1))]),d("div",ohe,[d("div",lhe,[Re(q(i4),{size:18})]),v[22]||(v[22]=d("div",null,[d("h4",null,"Time Table"),d("p",null,"Configure school periods and time slots")],-1))])])])]),d("div",che,[d("div",uhe,[d("h2",null,[Re(q(Gb),{size:18}),v[23]||(v[23]=we(" Data & Integration"))]),d("button",{onClick:v[2]||(v[2]=T=>b.$emit("goToCategory","data-integration")),class:"category-btn"},[Re(q(Kf),{size:16}),v[24]||(v[24]=we(" Manage "))])]),d("div",dhe,[d("div",fhe,[d("div",hhe,[d("div",phe,[Re(q(nB),{size:18})]),v[25]||(v[25]=d("div",null,[d("h4",null,"SEIS Import"),d("p",null,"Import student data from SEIS system")],-1))]),d("div",mhe,[d("div",ghe,[Re(q(uB),{size:18})]),v[26]||(v[26]=d("div",null,[d("h4",null,"Aeries API & Import"),d("p",null,"Connect to Aeries SIS for data synchronization")],-1))]),d("div",vhe,[d("div",yhe,[Re(q(EB),{size:18})]),v[27]||(v[27]=d("div",null,[d("h4",null,"Testing Links"),d("p",null,"Google Sheets integration and export tools")],-1))]),d("div",xhe,[d("div",Ehe,[Re(q(o4),{size:18})]),v[28]||(v[28]=d("div",null,[d("h4",null,"Teacher Feedback"),d("p",null,"Manage teacher feedback forms and responses")],-1))]),d("div",bhe,[d("div",_he,[Re(q(lB),{size:18})]),v[29]||(v[29]=d("div",null,[d("h4",null,"Backup & Restore"),d("p",null,"System backup and data restoration tools")],-1))])])])]),d("div",She,[d("div",Ahe,[d("h2",null,[Re(q(c4),{size:18}),v[30]||(v[30]=we(" System Configuration"))]),d("button",{onClick:v[3]||(v[3]=T=>b.$emit("goToCategory","system-config")),class:"category-btn"},[Re(q(Kf),{size:16}),v[31]||(v[31]=we(" Manage "))])]),d("div",The,[d("div",whe,[d("div",Che,[d("div",Ihe,[Re(q($v),{size:18})]),v[32]||(v[32]=d("div",null,[d("h4",null,"Permissions"),d("p",null,"Role-based access control and permissions matrix")],-1))]),d("div",khe,[d("div",Dhe,[Re(q(AB),{size:18})]),v[33]||(v[33]=d("div",null,[d("h4",null,"App Settings"),d("p",null,"Configure application settings and preferences")],-1))]),d("div",Phe,[d("div",Rhe,[Re(q(mB),{size:18})]),v[34]||(v[34]=d("div",null,[d("h4",null,"Theme Customization"),d("p",null,"Customize student page appearance and colors")],-1))])])])])]),d("div",Fhe,[d("h2",null,[Re(q(bB),{size:20}),v[35]||(v[35]=we(" System Status"))]),d("div",Nhe,[d("div",Ohe,[d("h3",null,[Re(q(vB),{size:18}),v[36]||(v[36]=we(" Data Sync Status"))]),d("div",Mhe,[d("div",Lhe,[d("span",{class:Ye(["sync-indicator",{active:_.value}])},null,2),v[37]||(v[37]=d("span",null,"Google Sheets",-1)),q(a)?(M(),B("span",Bhe,Q(x(q(a))),1)):ve("",!0)]),d("div",Uhe,[d("span",{class:Ye(["sync-indicator",{active:c.value}])},null,2),v[38]||(v[38]=d("span",null,"Aeries SIS",-1)),d("span",$he,Q(u.value),1)])])]),d("div",Vhe,[d("h3",null,[Re(q(qL),{size:18}),v[39]||(v[39]=we(" User Activity"))]),d("div",Hhe,[d("div",jhe,[v[40]||(v[40]=d("span",null,"Active Users Today",-1)),d("span",Ghe,Q(o.value),1)]),d("div",Whe,[v[41]||(v[41]=d("span",null,"Recent Logins",-1)),d("span",zhe,Q(l.value),1)])])]),d("div",Khe,[d("h3",null,[Re(q(pB),{size:18}),v[42]||(v[42]=we(" System Health"))]),d("div",qhe,[d("div",Xhe,[v[44]||(v[44]=d("span",null,"Database",-1)),d("span",Yhe,[Re(q(Sh),{size:16}),v[43]||(v[43]=we(" Healthy "))])]),d("div",Qhe,[v[46]||(v[46]=d("span",null,"Functions",-1)),d("span",Jhe,[Re(q(Sh),{size:16}),v[45]||(v[45]=we(" Operational "))])])])])])]),d("div",Zhe,[d("h2",null,[Re(q(TB),{size:20}),v[47]||(v[47]=we(" Quick Actions"))]),d("div",epe,[d("button",{onClick:v[4]||(v[4]=T=>b.$emit("goToStudents")),class:"admin-action-btn primary"},[Re(q(zl),{size:20}),v[48]||(v[48]=d("span",null,"View Students",-1))]),d("button",{onClick:v[5]||(v[5]=T=>b.$emit("goToCategory","users-students")),class:"admin-action-btn success"},[Re(q(R0),{size:20}),v[49]||(v[49]=d("span",null,"Manage Users",-1))]),d("button",{onClick:v[6]||(v[6]=T=>b.$emit("goToCategory","aide-management")),class:"admin-action-btn warning"},[Re(q(km),{size:20}),v[50]||(v[50]=d("span",null,"Paraeducators",-1))]),d("button",{onClick:v[7]||(v[7]=T=>b.$emit("goToCategory","data-integration")),class:"admin-action-btn info"},[Re(q(Gb),{size:20}),v[51]||(v[51]=d("span",null,"Data & Integration",-1))])])])]))}},rpe=St(tpe,[["__scopeId","data-v-b32b4e32"]]);var npe={};class spe{constructor(){this.encryptionKey="default-dev-key-replace-in-production",this.encryptionEnabled=!0,console.log(" IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled")}setEncryptionEnabled(e){this.encryptionEnabled=e,console.log(" IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled"),e||console.warn(" Warning: Encryption disabled in production environment")}encryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log(" Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.encryptField(i);this.setNestedValue(n,s,a)}}),n}decryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log(" Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.decryptField(i);this.setNestedValue(n,s,a)}}),n}encryptField(e){if(!this.encryptionEnabled)return e;try{const r=typeof e=="object"?JSON.stringify(e):String(e);return qi.AES.encrypt(r,this.encryptionKey).toString()}catch(r){return console.error("Encryption failed:",r),e}}decryptField(e){if(!this.encryptionEnabled)return e;try{const n=qi.AES.decrypt(e,this.encryptionKey).toString(qi.enc.Utf8);try{return JSON.parse(n)}catch{return n}}catch(r){return console.error("Decryption failed:",r),e}}getNestedValue(e,r){return r.split(".").reduce((n,s)=>n&&n[s],e)}setNestedValue(e,r,n){const s=r.split("."),i=s.pop(),a=s.reduce((o,l)=>o[l]=o[l]||{},e);return a[i]=n,e}async logAccess(e,r,n){var s,i;try{const a=et(At(Xe,"iepAccessLogs"));await $t(a,{studentId:e,userId:(s=bt.currentUser)==null?void 0:s.uid,userEmail:(i=bt.currentUser)==null?void 0:i.email,action:r,fields:n,timestamp:Pn(),userAgent:navigator.userAgent,encryptionEnabled:this.encryptionEnabled})}catch(a){console.error("Failed to log access:",a)}}async verifyAccess(e,r="read"){var n,s,i,a,o,l;if(!bt.currentUser)return!1;try{const u=(await er(et(Xe,"users",bt.currentUser.uid))).data();if(["admin","administrator","sped_chair"].includes(u.role))return!0;if(u.role==="case_manager"){const h=((i=(s=(n=(await er(et(Xe,"students",e))).data())==null?void 0:n.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===bt.currentUser.uid;return await this.logAccess(e,`access_attempt_${r}`,{success:h,role:"case_manager"}),h}if(u.role==="teacher"&&r==="read"){const h=((l=(o=(a=(await er(et(Xe,"students",e))).data())==null?void 0:a.app)==null?void 0:o.schedule)==null?void 0:l.periods)||{},p=Object.values(h).includes(bt.currentUser.uid);return await this.logAccess(e,`access_attempt_${r}`,{success:p,role:"teacher"}),p}return!1}catch(c){return console.error("Access verification failed:",c),!1}}async getAccessHistory(e){try{const r=lr(At(Xe,"iepAccessLogs"),Ur("studentId","==",e),Ur("timestamp",">=",new Date(Date.now()-2592e6)));return(await Gt(r)).docs.map(s=>({id:s.id,...s.data()}))}catch(r){return console.error("Failed to fetch access history:",r),[]}}maskSensitiveData(e){var n,s,i;const r=JSON.parse(JSON.stringify(e));return(n=r.app)!=null&&n.accommodations&&(r.app.accommodations={assessment:"[RESTRICTED]",instruction:"[RESTRICTED]"}),(i=(s=r.app)==null?void 0:s.schedule)!=null&&i.classServices&&(r.app.schedule.classServices=["[RESTRICTED]"]),r}isEncryptionEnabled(){return this.encryptionEnabled}isValueEncrypted(e){try{return typeof e!="string"?!1:(qi.AES.decrypt(e,this.encryptionKey).toString(qi.enc.Utf8),!0)}catch{return!1}}encryptGmailPassword(e){return this.encryptionEnabled?this.encryptField(e):(console.warn(" Warning: Encryption is disabled"),e)}decryptGmailPassword(e){return this.encryptionEnabled?this.decryptField(e):e}getEncryptionStatus(){const e="true",r=e!==void 0;return{enabled:this.encryptionEnabled,environment:"production",keyAvailable:!!this.encryptionKey,environmentVariable:npe.VUE_APP_ENABLE_ENCRYPTION,viteEncryptionValue:r?e:null,isViteSet:r,viteEncryptionEnabled:this.encryptionEnabled}}}const v0=new spe,ape={class:"debug-encryption"},ipe={class:"debug-header"},ope={class:"encryption-status"},lpe={class:"status-row"},cpe={class:"encryption-toggle"},upe=["checked"],dpe={key:0,class:"warning"},fpe={class:"status-details"},hpe={class:"status-row"},ppe={class:"status-value"},mpe={class:"status-row"},gpe={class:"status-value"},vpe={class:"status-row"},ype={class:"status-value"},xpe={key:0,class:"env-value-set"},Epe={class:"env-guidance"},bpe={key:0,class:"dev-guidance"},_pe={key:1,class:"prod-guidance"},Spe={key:1,class:"env-value-not-set"},Ape={class:"status-row"},Tpe={class:"status-value"},wpe={key:0,class:"debug-info"},Cpe={class:"field-name"},Ipe={class:"field-value"},kpe={class:"value-preview"},Dpe={__name:"DebugEncryption",props:{selectedStudent:{type:Object,default:null}},setup(t){const e=t,r=_e(()=>v0.getEncryptionStatus()),n=_e(()=>v0.isEncryptionEnabled()),s=_e(()=>r.value.environment),i=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],a=()=>{v0.setEncryptionEnabled(!n.value)},o=(u,f)=>f.split(".").reduce((h,p)=>h&&h[p],u),l=u=>{if(!e.selectedStudent)return!1;const f=o(e.selectedStudent,u);return f?v0.isValueEncrypted(f):!1},c=u=>{if(!e.selectedStudent)return"No data";const f=o(e.selectedStudent,u);if(!f)return"Empty";if(l(u))return f.substring(0,20)+"...";const h=typeof f=="object"?JSON.stringify(f):String(f);return h.length>40?h.substring(0,40)+"...":h};return(u,f)=>(M(),B("div",ape,[d("div",ipe,[f[0]||(f[0]=d("h3",null," IEP Encryption Control",-1)),d("div",{class:Ye(["environment-badge",s.value])},Q(s.value.toUpperCase()),3)]),d("div",ope,[d("div",lpe,[f[1]||(f[1]=d("div",{class:"status-label"},"Status:",-1)),d("div",{class:Ye(["status-value",{enabled:n.value}])},Q(n.value?" Enabled":" Disabled"),3)]),d("div",cpe,[d("label",null,[d("input",{type:"checkbox",checked:n.value,onChange:a},null,40,upe),f[2]||(f[2]=we(" Toggle Encryption "))]),s.value==="production"&&!n.value?(M(),B("div",dpe,"  Warning: Encryption disabled in production ")):ve("",!0)]),d("div",fpe,[d("div",hpe,[f[3]||(f[3]=d("div",{class:"status-label"},"Environment:",-1)),d("div",ppe,Q(s.value),1)]),d("div",mpe,[f[4]||(f[4]=d("div",{class:"status-label"},"Encryption Key:",-1)),d("div",gpe,Q(r.value.keyAvailable?" Available":" Missing"),1)]),d("div",vpe,[f[6]||(f[6]=d("div",{class:"status-label"},"VITE_ENABLE_ENCRYPTION:",-1)),d("div",ype,[r.value.isViteSet?(M(),B("div",xpe,[d("span",{class:Ye(["env-value",{"true-value":r.value.viteEncryptionValue==="true","false-value":r.value.viteEncryptionValue==="false"}])},Q(r.value.viteEncryptionValue),3),d("div",Epe,[r.value.viteEncryptionValue==="true"?(M(),B("span",bpe," Development mode")):r.value.viteEncryptionValue==="false"?(M(),B("span",_pe," Production mode")):ve("",!0)])])):(M(),B("div",Spe,f[5]||(f[5]=[d("span",{class:"not-set"},"Not set",-1),d("div",{class:"env-guidance"},[d("span",{class:"default-guidance"},"Defaults to enabled (secure)")],-1)])))])]),d("div",Ape,[f[7]||(f[7]=d("div",{class:"status-label"},"Legacy ENV:",-1)),d("div",Tpe,Q(r.value.environmentVariable||"Not set"),1)])])]),t.selectedStudent?(M(),B("div",wpe,[f[8]||(f[8]=d("h4",null,"Selected Student Data:",-1)),(M(),B(ke,null,He(i,h=>d("div",{class:"field-status",key:h},[d("div",Cpe,Q(h)+":",1),d("div",Ipe,[d("div",{class:Ye(["encryption-status",{encrypted:l(h)}])},Q(l(h)?" Encrypted":" Plain Text"),3),d("div",kpe,Q(c(h)),1)])])),64))])):ve("",!0)]))}},AD=St(Dpe,[["__scopeId","data-v-7902f511"]]),Ppe={class:"session-debug"},Rpe={class:"debug-info"},Fpe={class:"info-row"},Npe={class:"info-row"},Ope={class:"info-row"},Mpe={class:"info-row"},Lpe={key:0,class:"info-row"},Bpe={class:"countdown"},Upe={class:"debug-actions"},$pe={class:"timeout-setter"},Vpe={__name:"SessionTimeoutDebug",setup(t){const{isEnabled:e,timeoutMinutes:r,showWarning:n,warningCountdown:s,updateSettings:i,resetTimeout:a}=Jy(),o=Qr(),l=_e(()=>o.currentUser),c=se(!1),u=se(30),f=se(.17);Wt(()=>{c.value=e.value,u.value=r.value});const h=async()=>{!c.value&&!u.value&&(c.value=e.value,u.value=r.value),await i(!0,f.value),setTimeout(()=>{a()},100)},p=async()=>{await i(c.value,u.value),setTimeout(()=>{a()},100)},g=()=>{document.dispatchEvent(new Event("click"))},y=()=>{console.log(" Session Timeout Debug Info:"),console.log("- Enabled:",e.value),console.log("- Timeout Minutes:",r.value),console.log("- Warning Showing:",n.value),console.log("- Warning Countdown:",s.value),console.log("- User Logged In:",!!l.value),console.log("- Current User:",l.value)};return(_,x)=>(M(),B("div",Ppe,[d("h4",null,[Re(q($v),{size:16}),x[1]||(x[1]=we(" Session Timeout Debug"))]),d("div",Rpe,[d("div",Fpe,[x[2]||(x[2]=d("strong",null,"Timeout Enabled:",-1)),d("span",{class:Ye({"status-active":q(e),"status-inactive":!q(e)})},[q(e)?(M(),Qt(q(Sh),{key:0,size:14})):(M(),Qt(q(Im),{key:1,size:14})),we(" "+Q(q(e)?"YES":"NO"),1)],2)]),d("div",Npe,[x[3]||(x[3]=d("strong",null,"Timeout Minutes:",-1)),d("span",null,Q(q(r))+" minutes",1)]),d("div",Ope,[x[4]||(x[4]=d("strong",null,"User Logged In:",-1)),d("span",{class:Ye({"status-active":!!l.value,"status-inactive":!l.value})},[l.value?(M(),Qt(q(Sh),{key:0,size:14})):(M(),Qt(q(Im),{key:1,size:14})),we(" "+Q(l.value?"YES":"NO"),1)],2)]),d("div",Mpe,[x[5]||(x[5]=d("strong",null,"Warning Showing:",-1)),d("span",{class:Ye({"status-warning":q(n),"status-inactive":!q(n)})},[q(n)?(M(),Qt(q(_B),{key:0,size:14})):(M(),Qt(q(Im),{key:1,size:14})),we(" "+Q(q(n)?"YES":"NO"),1)],2)]),q(n)?(M(),B("div",Lpe,[x[6]||(x[6]=d("strong",null,"Countdown:",-1)),d("span",Bpe,Q(q(s))+"s",1)])):ve("",!0)]),d("div",Upe,[d("div",$pe,[d("label",null,[x[8]||(x[8]=we(" Set Test Timeout: ")),Oe(d("select",{"onUpdate:modelValue":x[0]||(x[0]=b=>f.value=b),class:"timeout-select"},x[7]||(x[7]=[En('<option value="0.05" data-v-76f71c90>3 seconds</option><option value="0.17" data-v-76f71c90>10 seconds</option><option value="0.5" data-v-76f71c90>30 seconds</option><option value="1" data-v-76f71c90>1 minute</option><option value="2" data-v-76f71c90>2 minutes</option><option value="5" data-v-76f71c90>5 minutes</option>',6)]),512),[[sr,f.value]])]),d("button",{onClick:h,class:"btn btn-warning"}," Apply Test Timeout ")]),d("div",{class:"admin-action-btns"},[d("button",{onClick:g,class:"admin-action-btn",style:{"min-width":"120px","max-width":"120px"}}," Trigger Activity "),d("button",{onClick:y,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Show Console Info "),d("button",{onClick:p,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Original ")])])]))}},Hpe=St(Vpe,[["__scopeId","data-v-76f71c90"]]),jpe={class:"security-control-center"},Gpe={class:"security-section"},Wpe={class:"security-section"},zpe={class:"setting-group"},Kpe={key:0,class:"setting-group"},qpe={class:"setting-group"},Xpe={class:"setting-group"},Ype={class:"security-section"},Qpe={class:"setting-group"},Jpe={class:"setting-group"},Zpe={class:"security-section"},eme={class:"ip-list"},tme={class:"ip-input"},rme={key:0,class:"ip-table"},nme=["onClick"],sme={key:1,class:"no-ips"},ame={class:"security-section"},ime={class:"alert-settings"},ome={class:"setting-group"},lme={class:"setting-group"},cme={class:"alert-emails"},ume={class:"email-input"},dme={key:0,class:"email-list"},fme=["onClick"],hme={__name:"SecurityControlCenter",props:{selectedStudent:{type:Object,default:null}},setup(t){const{isEnabled:e,timeoutMinutes:r,updateSettings:n}=Jy(),s=se(!1),i=se(!1),a=se(!0),o=se(!0),l=se([]),c=se(""),u=se({unusualAccess:!0,bulkExport:!0}),f=se([]),h=se(""),p=async()=>{try{await n(e.value,r.value)}catch(E){console.error("Failed to toggle session timeout:",E)}},g=async()=>{try{await n(e.value,r.value)}catch(E){console.error("Failed to update session timeout:",E)}},y=()=>{console.log("Password policy updated:",s.value)},_=()=>{console.log("MFA policy updated:",i.value)},x=()=>{console.log("Export policy updated:",a.value)},b=()=>{console.log("PDF policy updated:",o.value)},v=()=>{c.value&&!l.value.includes(c.value)&&(l.value.push(c.value),c.value="")},T=E=>{l.value=l.value.filter(m=>m!==E)},D=()=>{console.log("Alert settings updated:",u.value)},k=()=>{h.value&&!f.value.includes(h.value)&&(f.value.push(h.value),h.value="")},S=E=>{f.value=f.value.filter(m=>m!==E)};return(E,m)=>(M(),B("div",jpe,[d("div",Gpe,[m[10]||(m[10]=d("h3",null," IEP Data Encryption",-1)),Re(AD,{"selected-student":t.selectedStudent},null,8,["selected-student"])]),d("div",Wpe,[m[17]||(m[17]=d("h3",null," Session Security",-1)),Re(Hpe),d("div",zpe,[d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":m[0]||(m[0]=A=>Cr(e)?e.value=A:null),onChange:p},null,544),[[_t,q(e)]]),m[11]||(m[11]=we(" Enable Auto Logout Timer "))]),m[12]||(m[12]=d("div",{class:"setting-description"}," Automatically log out users after a period of inactivity ",-1))]),q(e)?(M(),B("div",Kpe,[d("label",null,[m[13]||(m[13]=we(" Auto Logout Timer (minutes): ")),Oe(d("input",{type:"number","onUpdate:modelValue":m[1]||(m[1]=A=>Cr(r)?r.value=A:null),min:"5",max:"120",onChange:g},null,544),[[ht,q(r)]])]),m[14]||(m[14]=d("div",{class:"setting-description"}," Users will be automatically logged out after this period of inactivity ",-1))])):ve("",!0),d("div",qpe,[d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":m[2]||(m[2]=A=>s.value=A),onChange:y},null,544),[[_t,s.value]]),m[15]||(m[15]=we(" Enforce Password Change Every 90 Days "))])]),d("div",Xpe,[d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":m[3]||(m[3]=A=>i.value=A),onChange:_},null,544),[[_t,i.value]]),m[16]||(m[16]=we(" Require Two-Factor Authentication for Admin Access "))])])]),d("div",Ype,[m[20]||(m[20]=d("h3",null," Data Access Controls",-1)),d("div",Qpe,[d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":m[4]||(m[4]=A=>a.value=A),onChange:x},null,544),[[_t,a.value]]),m[18]||(m[18]=we(" Restrict Data Export to Admins Only "))])]),d("div",Jpe,[d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":m[5]||(m[5]=A=>o.value=A),onChange:b},null,544),[[_t,o.value]]),m[19]||(m[19]=we(" Add Watermark to Exported PDFs "))])])]),d("div",Zpe,[m[21]||(m[21]=d("h3",null," IP Access Control",-1)),d("div",eme,[d("div",tme,[Oe(d("input",{type:"text","onUpdate:modelValue":m[6]||(m[6]=A=>c.value=A),placeholder:"Enter IP address or range"},null,512),[[ht,c.value]]),d("button",{onClick:v,class:"btn btn-primary"}," Add IP ")]),l.value.length?(M(),B("div",rme,[(M(!0),B(ke,null,He(l.value,A=>(M(),B("div",{key:A,class:"ip-row"},[d("span",null,Q(A),1),d("button",{onClick:I=>T(A),class:"btn btn-danger btn-sm"}," Remove ",8,nme)]))),128))])):(M(),B("div",sme," No IP restrictions configured "))])]),d("div",ame,[m[25]||(m[25]=d("h3",null," Security Alerts",-1)),d("div",ime,[d("div",ome,[d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":m[7]||(m[7]=A=>u.value.unusualAccess=A),onChange:D},null,544),[[_t,u.value.unusualAccess]]),m[22]||(m[22]=we(" Alert on Unusual Access Patterns "))])]),d("div",lme,[d("label",null,[Oe(d("input",{type:"checkbox","onUpdate:modelValue":m[8]||(m[8]=A=>u.value.bulkExport=A),onChange:D},null,544),[[_t,u.value.bulkExport]]),m[23]||(m[23]=we(" Alert on Bulk Data Exports "))])]),d("div",cme,[m[24]||(m[24]=d("h4",null,"Alert Recipients:",-1)),d("div",ume,[Oe(d("input",{type:"email","onUpdate:modelValue":m[9]||(m[9]=A=>h.value=A),placeholder:"Enter email address"},null,512),[[ht,h.value]]),d("button",{onClick:k,class:"btn btn-primary"}," Add ")]),f.value.length?(M(),B("div",dme,[(M(!0),B(ke,null,He(f.value,A=>(M(),B("div",{key:A,class:"email-row"},[d("span",null,Q(A),1),d("button",{onClick:I=>S(A),class:"btn btn-danger btn-sm"}," Remove ",8,fme)]))),128))])):ve("",!0)])])])]))}},pme=St(hme,[["__scopeId","data-v-1ecfe656"]]),mme={class:"card-header"},gme={class:"component-info"},vme={class:"component-name"},yme={class:"component-description"},xme={class:"card-body"},Eme={class:"status-details"},bme={class:"detail-row"},_me={key:0,class:"detail-row"},Sme={key:1,class:"detail-row"},Ame={class:"detail-value"},Tme={key:0,class:"errors-section"},wme={class:"errors-list"},Cme={class:"card-actions"},Ime=["disabled"],kme={key:1,class:"details-section"},Dme={class:"details-content"},Pme={class:"detail-item"},Rme={class:"detail-item"},Fme={key:0,class:"detail-item"},Nme={class:"detail-item"},Ome={key:0,class:"loading-overlay"},Mme={__name:"ComponentHealthCard",props:{component:{type:Object,required:!0}},emits:["test","toggle"],setup(t){const e=t,r=se(!1),n=se(!1);Ht(()=>e.component.status,(u,f)=>{f==="checking"&&u!=="checking"?n.value=!1:u==="checking"&&(n.value=!0)},{immediate:!0});const s=u=>{switch(u){case"operational":return"";case"degraded":return"";case"down":return"";case"disabled":return"";case"checking":return"";default:return""}},i=u=>{switch(u){case"operational":return"Healthy";case"degraded":return"Issues";case"down":return"Failed";case"disabled":return"Disabled";case"checking":return"Testing...";default:return"Unknown"}},a=u=>u<100?"latency-good":u<500?"latency-ok":"latency-poor",o=u=>u?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(u):"Never",l=u=>u?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(u):"Never",c=u=>u.toLowerCase().replace(/\s+/g,"-");return(u,f)=>(M(),B("div",{class:Ye(["health-card",[t.component.status,{disabled:!t.component.enabled}]])},[d("div",mme,[d("div",gme,[d("h4",vme,Q(t.component.name),1),d("p",yme,Q(t.component.description),1)]),d("div",{class:Ye(["status-indicator",t.component.status])},Q(s(t.component.status)),3)]),d("div",xme,[d("div",Eme,[d("div",bme,[f[3]||(f[3]=d("span",{class:"detail-label"},"Status:",-1)),d("span",{class:Ye(["detail-value",t.component.status])},Q(i(t.component.status)),3)]),t.component.latency!==null?(M(),B("div",_me,[f[4]||(f[4]=d("span",{class:"detail-label"},"Latency:",-1)),d("span",{class:Ye(["detail-value",a(t.component.latency)])},Q(t.component.latency)+"ms ",3)])):ve("",!0),t.component.lastCheck?(M(),B("div",Sme,[f[5]||(f[5]=d("span",{class:"detail-label"},"Last Check:",-1)),d("span",Ame,Q(o(t.component.lastCheck)),1)])):ve("",!0)]),t.component.errors&&t.component.errors.length?(M(),B("div",Tme,[f[6]||(f[6]=d("div",{class:"errors-header"}," Issues:",-1)),d("ul",wme,[(M(!0),B(ke,null,He(t.component.errors,h=>(M(),B("li",{key:h,class:"error-item"},Q(h),1))),128))])])):ve("",!0),d("div",Cme,[d("button",{onClick:f[0]||(f[0]=h=>u.$emit("test",t.component)),disabled:n.value,class:"btn btn-primary btn-sm"},Q(n.value?"":"")+" Test ",9,Ime),d("button",{onClick:f[1]||(f[1]=h=>u.$emit("toggle",t.component)),class:Ye(["btn btn-sm",t.component.enabled?"btn-warning":"btn-success"])},Q(t.component.enabled?" Disable":" Enable"),3),d("button",{onClick:f[2]||(f[2]=h=>r.value=!r.value),class:"btn btn-secondary btn-sm"},Q(r.value?" Less":" More"),1)]),r.value?(M(),B("div",kme,[d("div",Dme,[d("div",Pme,[f[7]||(f[7]=d("strong",null,"Test Function:",-1)),we(" "+Q(t.component.testFunction||"N/A"),1)]),d("div",Rme,[f[8]||(f[8]=d("strong",null,"Enabled:",-1)),we(" "+Q(t.component.enabled?"Yes":"No"),1)]),t.component.lastCheck?(M(),B("div",Fme,[f[9]||(f[9]=d("strong",null,"Last Test:",-1)),we(" "+Q(l(t.component.lastCheck)),1)])):ve("",!0),d("div",Nme,[f[10]||(f[10]=d("strong",null,"Component ID:",-1)),we(" "+Q(c(t.component.name)),1)])])])):ve("",!0)]),n.value?(M(),B("div",Ome,f[11]||(f[11]=[d("div",{class:"loading-spinner"},"",-1),d("div",{class:"loading-text"},"Testing component...",-1)]))):ve("",!0)],2))}},YS=St(Mme,[["__scopeId","data-v-18cc0437"]]),Lme={class:"health-dashboard"},Bme={class:"dashboard-header"},Ume={class:"header-controls"},$me=["disabled"],Vme={key:0,class:"last-update"},Hme={class:"status-overview"},jme={class:"status-icon"},Gme={class:"status-info"},Wme={class:"status-details"},zme={class:"component-categories"},Kme={class:"category-section"},qme={class:"components-grid"},Xme={class:"category-section"},Yme={class:"components-grid"},Qme={class:"quick-actions"},Jme={class:"admin-action-btns"},Zme=["disabled"],ege={class:"logs-section"},tge={class:"logs-container"},rge={class:"log-time"},nge={class:"log-component"},sge={class:"log-message"},age={key:0,class:"no-logs"},ige={class:"modal-header"},oge={class:"modal-content"},lge={__name:"ComponentHealthDashboard",setup(t){const e=se(!1),r=se(null),n=se(!1),s=se({}),i=se([]),a=se(!1),o=se([{name:"Firebase Auth",status:"operational",description:"User authentication service",lastCheck:new Date,enabled:!0,latency:150,errors:[]},{name:"Firestore Database",status:"operational",description:"Main database service",lastCheck:new Date,enabled:!0,latency:200,errors:[]},{name:"Firebase Storage",status:"operational",description:"File storage service",lastCheck:new Date,enabled:!0,latency:180,errors:[]},{name:"Cloud Functions",status:"operational",description:"Server-side functions",lastCheck:new Date,enabled:!0,latency:300,errors:[]}]),l=se([{name:"Session Timeout",status:"operational",description:"Automatic user logout system",lastCheck:new Date,enabled:!0,latency:50,errors:[]},{name:"IEP Encryption",status:"operational",description:"Sensitive data encryption",lastCheck:new Date,enabled:!0,latency:80,errors:[]},{name:"Access Control",status:"operational",description:"Role-based permissions",lastCheck:new Date,enabled:!0,latency:120,errors:[]},{name:"Audit Logging",status:"operational",description:"Activity tracking system",lastCheck:new Date,enabled:!0,latency:90,errors:[]}]),c=_e(()=>[...o.value,...l.value]),u=_e(()=>c.value.length),f=_e(()=>c.value.filter(E=>E.status==="operational").length),h=_e(()=>{const E=c.value.map(m=>m.status);return E.every(m=>m==="operational"||m==="disabled")?"operational":E.some(m=>m==="down"||m==="error")?"down":"degraded"}),p=E=>{switch(E){case"operational":return"";case"degraded":return"";case"down":return"";case"disabled":return"";default:return""}},g=E=>{switch(E){case"operational":return"All systems operational";case"degraded":return"Some issues detected";case"down":return"Critical issues found";case"checking":return"Running diagnostics...";default:return"Unknown status"}},y=E=>E?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(E):"",_=(E,m,A="info")=>{i.value.unshift({id:Date.now()+Math.random(),timestamp:new Date,component:E,message:m,type:A}),i.value.length>20&&(i.value=i.value.slice(0,20))},x=async E=>{_(E.name,"Starting component test...","info");try{const m=performance.now();await new Promise(C=>setTimeout(C,Math.random()*1e3+500));const A=Math.round(performance.now()-m),I=c.value.find(C=>C.name===E.name);I&&(I.status=Math.random()>.1?"operational":"degraded",I.latency=A,I.lastCheck=new Date,I.errors=I.status==="degraded"?["Minor performance issue detected"]:[]),_(E.name,`Test completed - ${I.status} (${A}ms)`,I.status==="operational"?"success":"warning"),s.value={component:E.name,data:{status:I.status,latency:`${A}ms`,timestamp:new Date().toISOString(),details:I.status==="operational"?"All checks passed successfully":"Minor performance issues detected"}},n.value=!0}catch(m){_(E.name,`Test failed: ${m.message}`,"error")}},b=E=>{const m=c.value.find(A=>A.name===E.name);m&&(m.enabled=!m.enabled,m.status=m.enabled?"operational":"disabled",_(E.name,`Component ${m.enabled?"enabled":"disabled"}`,"info"))},v=async()=>{if(!e.value){e.value=!0,r.value=new Date,_("System","Starting full system refresh...","info");try{const E=c.value.filter(m=>m.enabled).map(m=>x(m));await Promise.all(E),_("System","Full system refresh completed","success")}catch(E){_("System",`Refresh failed: ${E.message}`,"error")}finally{e.value=!1}}},T=async()=>{a.value=!0,_("System","Starting comprehensive system test...","info");try{await v(),_("System","Comprehensive system test completed","success")}catch(E){_("System",`System test failed: ${E.message}`,"error")}finally{a.value=!1}},D=()=>{const E={timestamp:new Date().toISOString(),overallStatus:h.value,components:c.value.map(C=>({name:C.name,status:C.status,enabled:C.enabled,latency:C.latency,lastCheck:C.lastCheck,errors:C.errors})),logs:i.value.slice(0,10)},m=new Blob([JSON.stringify(E,null,2)],{type:"application/json"}),A=URL.createObjectURL(m),I=document.createElement("a");I.href=A,I.download=`health-report-${Date.now()}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(A),_("System","Health report exported","info")},k=()=>{i.value=[]},S=()=>{n.value=!1,s.value={}};return Wt(()=>{_("System","Component Health Dashboard initialized","success")}),(E,m)=>(M(),B("div",Lme,[d("div",Bme,[m[1]||(m[1]=d("h2",null," Component Health Dashboard",-1)),d("div",Ume,[d("button",{onClick:v,disabled:e.value,class:"btn btn-primary"},Q(e.value?" Refreshing...":" Refresh All"),9,$me),r.value?(M(),B("span",Vme," Last update: "+Q(y(r.value)),1)):ve("",!0)])]),d("div",Hme,[d("div",{class:Ye(["status-card overall",h.value])},[d("div",jme,Q(p(h.value)),1),d("div",Gme,[m[2]||(m[2]=d("h3",null,"System Status",-1)),d("p",null,Q(g(h.value)),1),d("div",Wme,Q(f.value)+"/"+Q(u.value)+" components healthy ",1)])],2)]),d("div",zme,[d("div",Kme,[m[3]||(m[3]=d("h3",null," Core Services",-1)),d("div",qme,[(M(!0),B(ke,null,He(o.value,A=>(M(),Qt(YS,{key:A.name,component:A,onTest:x,onToggle:b},null,8,["component"]))),128))])]),d("div",Xme,[m[4]||(m[4]=d("h3",null," Authentication & Security",-1)),d("div",Yme,[(M(!0),B(ke,null,He(l.value,A=>(M(),Qt(YS,{key:A.name,component:A,onTest:x,onToggle:b},null,8,["component"]))),128))])])]),d("div",Qme,[m[5]||(m[5]=d("h3",null," Quick Tests",-1)),d("div",Jme,[d("button",{onClick:T,disabled:a.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},Q(a.value?" Testing...":" Full System Test"),9,Zme),d("button",{onClick:D,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},"  Export Report ")])]),d("div",ege,[d("div",{class:"logs-header"},[m[6]||(m[6]=d("h3",null," Component Activity Logs",-1)),d("div",{class:"log-controls"},[d("button",{onClick:k,class:"btn btn-sm btn-secondary"},"Clear")])]),d("div",tge,[(M(!0),B(ke,null,He(i.value,A=>(M(),B("div",{key:A.id,class:Ye(["log-entry",A.type])},[d("span",rge,Q(y(A.timestamp)),1),d("span",nge,Q(A.component),1),d("span",sge,Q(A.message),1)],2))),128)),i.value.length===0?(M(),B("div",age,' No activity logs yet. Click "Refresh All" to start monitoring. ')):ve("",!0)])]),n.value?(M(),B("div",{key:0,class:"test-modal-overlay",onClick:S},[d("div",{class:"test-modal",onClick:m[0]||(m[0]=Yr(()=>{},["stop"]))},[d("div",ige,[d("h3",null,Q(s.value.component)+" Test Results",1),d("button",{onClick:S,class:"btn btn-sm btn-secondary"},"")]),d("div",oge,[d("pre",null,Q(JSON.stringify(s.value.data,null,2)),1)])])])):ve("",!0)]))}},cge=St(lge,[["__scopeId","data-v-106cd980"]]),uge={class:"admin-permissions-matrix"},dge={class:"matrix-container"},fge={key:0,class:"loading-state"},hge={key:1,class:"permissions-table"},pge={key:0},mge={key:0,class:"permission-row"},gge={class:"page-info"},vge={class:"page-name"},yge={class:"page-category"},xge={class:"page-description"},Ege={class:"permission-cell"},bge=["checked","disabled","onChange"],_ge={class:"permission-cell"},Sge=["checked","disabled","onChange"],Age={class:"permission-cell"},Tge=["checked","disabled","onChange"],wge={class:"matrix-actions"},Cge={class:"bulk-actions"},Ige={class:"bulk-buttons"},kge={key:0,class:"save-status"},Dge={__name:"AdminPermissionsMatrix",setup(t){const e=se(null),r=se(!0),n=_e(()=>!r.value&&s.value.length>0&&Object.keys(i).length>0),s=se([{key:"dashboard",label:"Dashboard",category:"Dashboard",description:"Main admin overview and statistics"},{key:"usersAdd",label:"Add Users",category:"User Management",description:"Create new user accounts"},{key:"usersEdit",label:"Manage Users",category:"User Management",description:"Edit existing user accounts"},{key:"students",label:"Students",category:"Student Management",description:"View and manage student records"},{key:"addStudents",label:"Add Students",category:"Student Management",description:"Bulk import student data"},{key:"aide-assignment",label:"Aide Assignment",category:"Aide Management",description:"Assign aides to students"},{key:"aide-schedule",label:"Aide Schedule",category:"Aide Management",description:"Manage aide schedules"},{key:"time-table",label:"Time Table",category:"Aide Management",description:"Configure school time periods"},{key:"seis",label:"SEIS Import",category:"Data Integration",description:"Import SEIS student data"},{key:"aeries",label:"Aeries API & Import",category:"Data Integration",description:"Connect to Aeries SIS"},{key:"testing-links",label:"Testing Links",category:"Data Integration",description:"Google Sheets integration for testing"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"Data Integration",description:"Manage teacher feedback system"},{key:"backup-restore",label:"Backup & Restore",category:"Data Integration",description:"Database backup and restore"},{key:"settings",label:"App Settings",category:"Settings",description:"Global application settings"},{key:"delete-all-users",label:"Delete All Users",category:"Bulk Actions",description:"Mass deletion of user accounts (dangerous operation)"},{key:"delete-all-students",label:"Delete All Students",category:"Bulk Actions",description:"Mass deletion of student records (dangerous operation)"},{key:"permissions",label:"Admin Panel Permissions",category:"System",description:"User role and permission management"},{key:"audit-logs",label:"Audit Logs",category:"System",description:"View and search system audit logs"},{key:"iep-security",label:"IEP Security",category:"System",description:"IEP data encryption and security"},{key:"security",label:"Security Controls",category:"System",description:"Security monitoring and controls"},{key:"component-health",label:"Component Debug",category:"System",description:"Component health and debugging"},{key:"app-settings-testing",label:"App Settings Testing",category:"System",description:"App settings testing and debugging tools"}]),i=As({}),a={school_admin:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!0,settings:!0,"delete-all-users":!0,"delete-all-students":!0,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0},admin_504:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0},sped_chair:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0}},o=()=>{if(!s.value||s.value.length===0){console.warn("adminPages not initialized yet");return}s.value.forEach(_=>{_&&_.key&&(i[_.key]={school_admin:a.school_admin[_.key]||!1,admin_504:a.admin_504[_.key]||!1,sped_chair:a.sped_chair[_.key]||!1})})},l=async()=>{try{const _=et(Xe,"app_settings","admin_panel_permissions"),x=await er(_);if(x.exists()){const b=x.data();s.value.forEach(v=>{v&&v.key&&b[v.key]&&(i[v.key]={school_admin:b[v.key].school_admin??a.school_admin[v.key],admin_504:b[v.key].admin_504??a.admin_504[v.key],sped_chair:b[v.key].sped_chair??a.sped_chair[v.key]})}),y("Permissions loaded successfully","success")}else o(),y("Using default permissions","info")}catch(_){console.error("Error loading permissions:",_),y("Error loading permissions","error"),o()}finally{r.value=!1}},c=async()=>{try{const _=et(Xe,"app_settings","admin_panel_permissions");await $t(_,i),y("Permissions saved successfully","success")}catch(_){console.error("Error saving permissions:",_),y("Error saving permissions","error")}},u=async(_,x,b)=>{i[_]&&(i[_][x]=b,await c())},f=async _=>{s.value.forEach(x=>{x&&x.key&&i[x.key]&&(i[x.key][_]=!0)}),await c(),y(`All permissions granted to ${_}`,"success")},h=async()=>{s.value.forEach(_=>{_&&_.key&&i[_.key]&&(i[_.key].school_admin=!1,i[_.key].admin_504=!1,i[_.key].sped_chair=!1)}),await c(),y("All permissions revoked","warning")},p=async()=>{o(),await c(),y("Permissions reset to defaults","info")},g=(_,x)=>["permissions","iep-security","security","component-health"].includes(_)?!0:["delete-all-users","delete-all-students"].includes(_)?x!=="school_admin":x==="admin_504"?["settings"].includes(_):x==="sped_chair"?["settings"].includes(_):!1,y=(_,x)=>{e.value={message:_,type:x},setTimeout(()=>{e.value=null},3e3)};return Wt(async()=>{await l()}),(_,x)=>(M(),B("div",uge,[x[9]||(x[9]=d("div",{class:"matrix-header"},[d("h2",null," Admin Panel Permissions Matrix"),d("p",{class:"matrix-description"}," Control which admin panel pages different admin roles can access. Changes are saved automatically. ")],-1)),d("div",dge,[r.value?(M(),B("div",fge,x[3]||(x[3]=[d("p",null,"Loading permissions...",-1)]))):(M(),B("table",hge,[x[7]||(x[7]=d("thead",null,[d("tr",null,[d("th",{class:"page-column"},"Admin Panel Page"),d("th",{class:"role-column"},"School Admin"),d("th",{class:"role-column"},"504 Coordinator"),d("th",{class:"role-column"},"SPED Chair")])],-1)),n.value?(M(),B("tbody",pge,[(M(!0),B(ke,null,He(s.value,b=>(M(),B(ke,{key:(b==null?void 0:b.key)||"unknown"},[b&&b.key&&i[b.key]?(M(),B("tr",mge,[d("td",gge,[d("div",vge,Q(b.label),1),d("div",yge,Q(b.category),1),d("div",xge,Q(b.description),1)]),d("td",Ege,[d("label",{class:Ye(["permission-toggle",{disabled:g(b.key,"school_admin")}])},[d("input",{type:"checkbox",checked:i[b.key]&&i[b.key].school_admin,disabled:g(b.key,"school_admin"),onChange:v=>u(b.key,"school_admin",v.target.checked)},null,40,bge),x[4]||(x[4]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",_ge,[d("label",{class:Ye(["permission-toggle",{disabled:g(b.key,"admin_504")}])},[d("input",{type:"checkbox",checked:i[b.key]&&i[b.key].admin_504,disabled:g(b.key,"admin_504"),onChange:v=>u(b.key,"admin_504",v.target.checked)},null,40,Sge),x[5]||(x[5]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",Age,[d("label",{class:Ye(["permission-toggle",{disabled:g(b.key,"sped_chair")}])},[d("input",{type:"checkbox",checked:i[b.key]&&i[b.key].sped_chair,disabled:g(b.key,"sped_chair"),onChange:v=>u(b.key,"sped_chair",v.target.checked)},null,40,Tge),x[6]||(x[6]=d("span",{class:"toggle-slider"},null,-1))],2)])])):ve("",!0)],64))),128))])):ve("",!0)]))]),d("div",wge,[d("div",Cge,[x[8]||(x[8]=d("h3",null,"Bulk Actions",-1)),d("div",Ige,[d("button",{onClick:x[0]||(x[0]=b=>f("school_admin")),class:"btn btn-success"}," Grant All to School Admin "),d("button",{onClick:x[1]||(x[1]=b=>f("admin_504")),class:"btn btn-success"}," Grant All to 504 Coordinator "),d("button",{onClick:x[2]||(x[2]=b=>f("sped_chair")),class:"btn btn-success"}," Grant All to SPED Chair "),d("button",{onClick:h,class:"btn btn-warning"}," Revoke All Permissions "),d("button",{onClick:p,class:"btn btn-secondary"}," Reset to Defaults ")])])]),e.value?(M(),B("div",kge,[d("div",{class:Ye(["status-message",e.value.type])},Q(e.value.message),3)])):ve("",!0)]))}},Pge=St(Dge,[["__scopeId","data-v-be29f1ae"]]),Rge={class:"theme-manager"},Fge={key:0,class:"loading-state"},Nge={key:1,class:"error-state"},Oge={class:"error-message"},Mge={key:2,class:"theme-editor"},Lge={class:"default-themes"},Bge={class:"theme-presets"},Uge=["onClick"],$ge={class:"theme-preview-colors"},Vge={class:"theme-info"},Hge={class:"theme-actions"},jge=["disabled"],Gge=["disabled"],Wge={class:"theme-sections"},zge={class:"theme-section"},Kge={class:"enhanced-color-grid"},qge={class:"color-input"},Xge={class:"color-picker-wrapper"},Yge={class:"color-input"},Qge={class:"color-picker-wrapper"},Jge={class:"color-input"},Zge={class:"color-picker-wrapper"},eve={class:"color-input"},tve={class:"color-picker-wrapper"},rve={class:"color-input"},nve={class:"color-picker-wrapper"},sve={class:"color-input"},ave={class:"color-picker-wrapper"},ive={class:"theme-section"},ove={class:"typography-grid"},lve={class:"option-group"},cve={class:"option-group"},uve={class:"option-group"},dve={class:"theme-section"},fve={class:"style-options-grid"},hve={class:"option-group"},pve={class:"option-group"},mve={class:"option-group"},gve={class:"theme-section"},vve={class:"student-preview-container"},yve={class:"mockup-header"},xve={class:"mockup-table"},Eve={class:"mockup-table-row"},bve={class:"mockup-cell"},_ve={class:"mockup-table-row"},Sve={class:"mockup-cell"},Ave={__name:"ThemeManager",setup(t){const{currentTheme:e,loading:r,error:n,loadTheme:s,saveTheme:i,resetTheme:a,updateThemeProperty:o,DEFAULT_THEME:l}=p4(),c=[{name:"Professional Blue",description:"Clean, accessible blue theme for professional use",primaryColor:"#1976d2",primaryHover:"#1565c0",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#212529",textSecondary:"#495057",textMuted:"#6c757d",textInverse:"#ffffff",headerTextColor:"#1a202c",accentColor:"#e3f2fd",secondaryColor:"#6c757d",secondaryHover:"#545b62",successColor:"#28a745",warningColor:"#ffc107",errorColor:"#dc3545",infoColor:"#17a2b8",borderColor:"#dee2e6",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"standard",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Inter', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.5"},{name:"Educational Orange",description:"Warm, professional orange theme optimized for readability",primaryColor:"#e65100",primaryHover:"#bf360c",primaryLight:"#fff3e0",primaryDark:"#bf360c",bgPrimary:"#fafafa",bgSecondary:"#ffffff",bgTertiary:"#f5f5f5",textPrimary:"#212121",textSecondary:"#424242",textMuted:"#757575",textInverse:"#ffffff",headerTextColor:"#bf360c",accentColor:"#ffcc80",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#2e7d32",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#e0e0e0",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Source Sans Pro', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Accessible Green",description:"Professional green theme with excellent readability",primaryColor:"#2e7d32",primaryHover:"#1b5e20",primaryLight:"#e8f5e8",primaryDark:"#1b5e20",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#1b5e20",textSecondary:"#2e7d32",textMuted:"#558b2f",textInverse:"#ffffff",headerTextColor:"#1b5e20",accentColor:"#a5d6a7",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#4caf50",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#c8e6c9",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Open Sans', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Professional Dark",description:"High-contrast dark theme for reduced eye strain",primaryColor:"#bb86fc",primaryHover:"#9c27b0",primaryLight:"#f3e5f5",primaryDark:"#6a1b9a",bgPrimary:"#121212",bgSecondary:"#1e1e1e",bgTertiary:"#2d2d2d",textPrimary:"#ffffff",textSecondary:"#e0e0e0",textMuted:"#bdbdbd",textInverse:"#000000",headerTextColor:"#bb86fc",accentColor:"#424242",secondaryColor:"#616161",secondaryHover:"#424242",successColor:"#4caf50",warningColor:"#ff9800",errorColor:"#f44336",infoColor:"#2196f3",borderColor:"#424242",borderStyle:"rounded",shadowStyle:"medium",contrastLevel:"maximum",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Roboto', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Corporate Navy",description:"Professional navy blue theme for corporate environments",primaryColor:"#1565c0",primaryHover:"#0d47a1",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#0d47a1",textSecondary:"#1565c0",textMuted:"#1976d2",textInverse:"#ffffff",headerTextColor:"#0d47a1",accentColor:"#bbdefb",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#2e7d32",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#e1f5fe",borderStyle:"sharp",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"2px",borderRadiusMd:"4px",borderRadiusLg:"6px",borderRadiusXl:"8px",fontFamilyBase:"'Source Sans Pro', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.5"},{name:"High Contrast",description:"Maximum accessibility theme with high contrast ratios",primaryColor:"#000000",primaryHover:"#212121",primaryLight:"#f5f5f5",primaryDark:"#000000",bgPrimary:"#ffffff",bgSecondary:"#ffffff",bgTertiary:"#f8f9fa",textPrimary:"#000000",textSecondary:"#212121",textMuted:"#424242",textInverse:"#ffffff",headerTextColor:"#000000",accentColor:"#e0e0e0",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#1b5e20",warningColor:"#e65100",errorColor:"#b71c1c",infoColor:"#0d47a1",borderColor:"#000000",borderStyle:"sharp",shadowStyle:"bold",contrastLevel:"maximum",borderRadiusSm:"0px",borderRadiusMd:"2px",borderRadiusLg:"4px",borderRadiusXl:"6px",fontFamilyBase:"'Roboto', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1.125rem",lineHeight:"1.7"}],u=As({...l}),f=se(!1),h=se(""),p=se(!1),g=se(null);Ht(e,E=>{Object.assign(u,E)},{deep:!0});const y=(E,m=!1)=>{h.value=E,p.value=m,setTimeout(()=>{h.value="",p.value=!1},5e3)},_=async()=>{f.value=!0;try{await i(u),y("Theme saved successfully!")}catch(E){y("Error saving theme: "+E.message,!0)}finally{f.value=!1}},x=async()=>{if(confirm("Are you sure you want to reset the theme to defaults? This cannot be undone."))try{await a(),y("Theme reset to defaults")}catch(E){y("Error resetting theme: "+E.message,!0)}},b=E=>{Object.assign(u,E),Object.keys(E).forEach(m=>{m!=="name"&&m!=="description"&&o(m,E[m])}),y(`Applied ${E.name} theme`)},v=E=>E.primaryColor===u.primaryColor&&E.bgPrimary===u.bgPrimary&&E.textPrimary===u.textPrimary,T=E=>{const A={rounded:{sm:"4px",md:"6px",lg:"8px",xl:"12px"},sharp:{sm:"2px",md:"4px",lg:"6px",xl:"8px"},"extra-rounded":{sm:"8px",md:"12px",lg:"16px",xl:"20px"}}[E];A&&(o("borderRadiusSm",A.sm),o("borderRadiusMd",A.md),o("borderRadiusLg",A.lg),o("borderRadiusXl",A.xl))},D=E=>{const A={none:{sm:"none",md:"none",lg:"none",xl:"none"},subtle:{sm:"0 1px 2px rgba(0, 0, 0, 0.05)",md:"0 2px 4px rgba(0, 0, 0, 0.1)",lg:"0 4px 6px rgba(0, 0, 0, 0.1)",xl:"0 4px 20px rgba(0, 0, 0, 0.15)"},medium:{sm:"0 2px 4px rgba(0, 0, 0, 0.1)",md:"0 4px 8px rgba(0, 0, 0, 0.15)",lg:"0 6px 12px rgba(0, 0, 0, 0.2)",xl:"0 8px 24px rgba(0, 0, 0, 0.25)"},bold:{sm:"0 4px 8px rgba(0, 0, 0, 0.15)",md:"0 8px 16px rgba(0, 0, 0, 0.2)",lg:"0 12px 24px rgba(0, 0, 0, 0.25)",xl:"0 16px 32px rgba(0, 0, 0, 0.3)"}}[E];A&&(o("shadowSm",A.sm),o("shadowMd",A.md),o("shadowLg",A.lg),o("shadowXl",A.xl))},k=E=>{o("fontSizeBase",E);const m=parseFloat(E),A=E.replace(/[\d.]/g,"");o("fontSizeXs",`${(m*.75).toFixed(3)}${A}`),o("fontSizeSm",`${(m*.875).toFixed(3)}${A}`),o("fontSizeLg",`${(m*1.125).toFixed(3)}${A}`),o("fontSizeXl",`${(m*1.25).toFixed(3)}${A}`),o("fontSizeXxl",`${(m*1.5).toFixed(3)}${A}`)},S=E=>{o("contrastLevel",E),E==="high"?u.textPrimary.includes("#")&&(o("textPrimary","#000000"),o("textSecondary","#212121")):E==="maximum"&&(o("textPrimary","#000000"),o("textSecondary","#000000"),o("bgPrimary","#ffffff"),o("bgSecondary","#ffffff"))};return Wt(async()=>{try{await s()}catch(E){console.error("Error loading theme:",E)}}),(E,m)=>(M(),B("div",Rge,[m[72]||(m[72]=d("div",{class:"theme-header"},[d("h2",null," Student Page Theme Customization"),d("p",{class:"theme-description"}," Customize the visual appearance of the student page. Changes are applied in real-time and saved to the database. ")],-1)),q(r)?(M(),B("div",Fge,m[38]||(m[38]=[d("div",{class:"spinner"},null,-1),d("p",null,"Loading theme settings...",-1)]))):q(n)?(M(),B("div",Nge,[d("p",Oge,Q(q(n)),1),d("button",{onClick:m[0]||(m[0]=(...A)=>q(s)&&q(s)(...A)),class:"btn btn-primary"},"Retry")])):(M(),B("div",Mge,[d("div",Lge,[m[39]||(m[39]=d("h3",null," Quick Theme Selection",-1)),d("div",Bge,[(M(),B(ke,null,He(c,A=>d("div",{key:A.name,onClick:I=>b(A),class:Ye(["theme-preset",{active:v(A)}])},[d("div",$ge,[d("div",{class:"color-dot",style:Nr({backgroundColor:A.primaryColor})},null,4),d("div",{class:"color-dot",style:Nr({backgroundColor:A.bgPrimary})},null,4),d("div",{class:"color-dot",style:Nr({backgroundColor:A.textPrimary})},null,4)]),d("div",Vge,[d("h4",null,Q(A.name),1),d("p",null,Q(A.description),1)])],10,Uge)),64))])]),d("div",Hge,[d("button",{onClick:_,disabled:f.value,class:"btn btn-primary"},Q(f.value?" Saving...":" Save Theme"),9,jge),d("button",{onClick:x,disabled:f.value,class:"btn btn-warning"},"  Reset to Default ",8,Gge)]),h.value?(M(),B("div",{key:0,class:Ye(["status-message",{error:p.value,success:!p.value}])},Q(h.value),3)):ve("",!0),d("div",Wge,[d("section",zge,[m[46]||(m[46]=d("h3",null," Essential Student Page Colors",-1)),d("div",Kge,[d("div",qge,[m[40]||(m[40]=d("label",null,"Primary Color (Buttons & Links)",-1)),d("div",Xge,[Oe(d("input",{type:"color","onUpdate:modelValue":m[1]||(m[1]=A=>u.primaryColor=A),onInput:m[2]||(m[2]=A=>q(o)("primaryColor",A.target.value)),class:"color-picker"},null,544),[[ht,u.primaryColor]]),Oe(d("input",{type:"text","onUpdate:modelValue":m[3]||(m[3]=A=>u.primaryColor=A),onInput:m[4]||(m[4]=A=>q(o)("primaryColor",A.target.value)),class:"color-text",placeholder:"#1976d2"},null,544),[[ht,u.primaryColor]])])]),d("div",Yge,[m[41]||(m[41]=d("label",null,"Header Text Color",-1)),d("div",Qge,[Oe(d("input",{type:"color","onUpdate:modelValue":m[5]||(m[5]=A=>u.headerTextColor=A),onInput:m[6]||(m[6]=A=>q(o)("headerTextColor",A.target.value)),class:"color-picker"},null,544),[[ht,u.headerTextColor]]),Oe(d("input",{type:"text","onUpdate:modelValue":m[7]||(m[7]=A=>u.headerTextColor=A),onInput:m[8]||(m[8]=A=>q(o)("headerTextColor",A.target.value)),class:"color-text",placeholder:"#1a1a1a"},null,544),[[ht,u.headerTextColor]])])]),d("div",Jge,[m[42]||(m[42]=d("label",null,"Background Color",-1)),d("div",Zge,[Oe(d("input",{type:"color","onUpdate:modelValue":m[9]||(m[9]=A=>u.bgPrimary=A),onInput:m[10]||(m[10]=A=>q(o)("bgPrimary",A.target.value)),class:"color-picker"},null,544),[[ht,u.bgPrimary]]),Oe(d("input",{type:"text","onUpdate:modelValue":m[11]||(m[11]=A=>u.bgPrimary=A),onInput:m[12]||(m[12]=A=>q(o)("bgPrimary",A.target.value)),class:"color-text",placeholder:"#f4f6f9"},null,544),[[ht,u.bgPrimary]])])]),d("div",eve,[m[43]||(m[43]=d("label",null,"Text Color",-1)),d("div",tve,[Oe(d("input",{type:"color","onUpdate:modelValue":m[13]||(m[13]=A=>u.textPrimary=A),onInput:m[14]||(m[14]=A=>q(o)("textPrimary",A.target.value)),class:"color-picker"},null,544),[[ht,u.textPrimary]]),Oe(d("input",{type:"text","onUpdate:modelValue":m[15]||(m[15]=A=>u.textPrimary=A),onInput:m[16]||(m[16]=A=>q(o)("textPrimary",A.target.value)),class:"color-text",placeholder:"#333333"},null,544),[[ht,u.textPrimary]])])]),d("div",rve,[m[44]||(m[44]=d("label",null,"Accent Color (Service Pills)",-1)),d("div",nve,[Oe(d("input",{type:"color","onUpdate:modelValue":m[17]||(m[17]=A=>u.accentColor=A),onInput:m[18]||(m[18]=A=>q(o)("accentColor",A.target.value)),class:"color-picker"},null,544),[[ht,u.accentColor]]),Oe(d("input",{type:"text","onUpdate:modelValue":m[19]||(m[19]=A=>u.accentColor=A),onInput:m[20]||(m[20]=A=>q(o)("accentColor",A.target.value)),class:"color-text",placeholder:"#e3f2fd"},null,544),[[ht,u.accentColor]])])]),d("div",sve,[m[45]||(m[45]=d("label",null,"Card Background",-1)),d("div",ave,[Oe(d("input",{type:"color","onUpdate:modelValue":m[21]||(m[21]=A=>u.bgSecondary=A),onInput:m[22]||(m[22]=A=>q(o)("bgSecondary",A.target.value)),class:"color-picker"},null,544),[[ht,u.bgSecondary]]),Oe(d("input",{type:"text","onUpdate:modelValue":m[23]||(m[23]=A=>u.bgSecondary=A),onInput:m[24]||(m[24]=A=>q(o)("bgSecondary",A.target.value)),class:"color-text",placeholder:"#ffffff"},null,544),[[ht,u.bgSecondary]])])])])]),d("section",ive,[m[53]||(m[53]=d("h3",null," Typography & Readability",-1)),d("div",ove,[d("div",lve,[m[48]||(m[48]=d("label",null,"Font Family",-1)),Oe(d("select",{"onUpdate:modelValue":m[25]||(m[25]=A=>u.fontFamilyBase=A),onChange:m[26]||(m[26]=A=>q(o)("fontFamilyBase",A.target.value)),class:"style-select"},m[47]||(m[47]=[En('<option value="&#39;Inter&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Inter (Modern &amp; Clean)</option><option value="&#39;Roboto&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Roboto (Google Standard)</option><option value="&#39;Open Sans&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Open Sans (Friendly)</option><option value="&#39;Source Sans Pro&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Source Sans Pro (Professional)</option><option value="&#39;Lato&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Lato (Humanist)</option><option value="&#39;Nunito Sans&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Nunito Sans (Rounded)</option><option value="&#39;System UI&#39;, -apple-system, sans-serif" data-v-5e89749a>System Default</option>',7)]),544),[[sr,u.fontFamilyBase]])]),d("div",cve,[m[50]||(m[50]=d("label",null,"Base Font Size",-1)),Oe(d("select",{"onUpdate:modelValue":m[27]||(m[27]=A=>u.fontSizeBase=A),onChange:m[28]||(m[28]=A=>k(A.target.value)),class:"style-select"},m[49]||(m[49]=[d("option",{value:"0.875rem"},"Small (14px) - Compact",-1),d("option",{value:"1rem"},"Medium (16px) - Standard",-1),d("option",{value:"1.125rem"},"Large (18px) - Comfortable",-1),d("option",{value:"1.25rem"},"Extra Large (20px) - Accessible",-1)]),544),[[sr,u.fontSizeBase]])]),d("div",uve,[m[52]||(m[52]=d("label",null,"Line Height",-1)),Oe(d("select",{"onUpdate:modelValue":m[29]||(m[29]=A=>u.lineHeight=A),onChange:m[30]||(m[30]=A=>q(o)("lineHeight",A.target.value)),class:"style-select"},m[51]||(m[51]=[d("option",{value:"1.4"},"Compact (1.4)",-1),d("option",{value:"1.5"},"Standard (1.5)",-1),d("option",{value:"1.6"},"Comfortable (1.6)",-1),d("option",{value:"1.7"},"Spacious (1.7)",-1)]),544),[[sr,u.lineHeight]])])])]),d("section",dve,[m[60]||(m[60]=d("h3",null," Visual Style",-1)),d("div",fve,[d("div",hve,[m[55]||(m[55]=d("label",null,"Border Radius Style",-1)),Oe(d("select",{"onUpdate:modelValue":m[31]||(m[31]=A=>u.borderStyle=A),onChange:m[32]||(m[32]=A=>T(A.target.value)),class:"style-select"},m[54]||(m[54]=[d("option",{value:"rounded"},"Rounded (Modern)",-1),d("option",{value:"sharp"},"Sharp (Professional)",-1),d("option",{value:"extra-rounded"},"Extra Rounded (Friendly)",-1)]),544),[[sr,u.borderStyle]])]),d("div",pve,[m[57]||(m[57]=d("label",null,"Shadow Style",-1)),Oe(d("select",{"onUpdate:modelValue":m[33]||(m[33]=A=>u.shadowStyle=A),onChange:m[34]||(m[34]=A=>D(A.target.value)),class:"style-select"},m[56]||(m[56]=[d("option",{value:"subtle"},"Subtle",-1),d("option",{value:"medium"},"Medium",-1),d("option",{value:"bold"},"Bold",-1),d("option",{value:"none"},"No Shadows",-1)]),544),[[sr,u.shadowStyle]])]),d("div",mve,[m[59]||(m[59]=d("label",null,"Contrast Level",-1)),Oe(d("select",{"onUpdate:modelValue":m[35]||(m[35]=A=>u.contrastLevel=A),onChange:m[36]||(m[36]=A=>S(A.target.value)),class:"style-select"},m[58]||(m[58]=[d("option",{value:"standard"},"Standard Contrast",-1),d("option",{value:"high"},"High Contrast (Accessible)",-1),d("option",{value:"maximum"},"Maximum Contrast",-1)]),544),[[sr,u.contrastLevel]])])])]),d("section",gve,[m[71]||(m[71]=d("h3",null," Student Page Preview",-1)),d("div",vve,[d("div",{class:"student-page-mockup",style:Nr({fontFamily:u.fontFamilyBase,fontSize:u.fontSizeBase,lineHeight:u.lineHeight})},[d("div",yve,[d("h2",{style:Nr({color:u.headerTextColor||u.textPrimary,fontFamily:u.fontFamilyBase})},"Student Management",4),m[61]||(m[61]=En('<div class="mockup-search" data-v-5e89749a><input type="text" placeholder="Search students..." readonly data-v-5e89749a></div><div class="mockup-controls" data-v-5e89749a><button class="mockup-btn primary" data-v-5e89749a> Filters</button><select class="mockup-select" data-v-5e89749a><option data-v-5e89749a>First Name</option></select><div class="mockup-radio-group" data-v-5e89749a><label class="active" data-v-5e89749a>List</label><label data-v-5e89749a>Class</label></div></div>',2))]),d("div",xve,[m[70]||(m[70]=En('<div class="mockup-table-header" data-v-5e89749a><div class="mockup-cell" data-v-5e89749a>Student Name</div><div class="mockup-cell" data-v-5e89749a>Grade</div><div class="mockup-cell" data-v-5e89749a>Case Manager</div><div class="mockup-cell" data-v-5e89749a>Services</div><div class="mockup-cell" data-v-5e89749a>Actions</div></div>',1)),d("div",Eve,[m[62]||(m[62]=d("div",{class:"mockup-cell"},"John Smith",-1)),m[63]||(m[63]=d("div",{class:"mockup-cell"},"9th",-1)),m[64]||(m[64]=d("div",{class:"mockup-cell"},"Ms. Johnson",-1)),d("div",bve,[d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"Speech",4),d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"OT",4)]),m[65]||(m[65]=d("div",{class:"mockup-cell"},[d("button",{class:"mockup-btn primary small"},"Edit")],-1))]),d("div",_ve,[m[66]||(m[66]=d("div",{class:"mockup-cell"},"Jane Doe",-1)),m[67]||(m[67]=d("div",{class:"mockup-cell"},"10th",-1)),m[68]||(m[68]=d("div",{class:"mockup-cell"},"Mr. Wilson",-1)),d("div",Sve,[d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"Resource",4)]),m[69]||(m[69]=d("div",{class:"mockup-cell"},[d("button",{class:"mockup-btn primary small"},"Edit")],-1))])])],4)])])])])),d("input",{ref_key:"fileInput",ref:g,type:"file",accept:".json",style:{display:"none"},onChange:m[37]||(m[37]=(...A)=>E.handleFileImport&&E.handleFileImport(...A))},null,544)]))}},Tve=St(Ave,[["__scopeId","data-v-5e89749a"]]),wve={class:"secure-pdf-test"},Cve={class:"test-section"},Ive={class:"status-grid"},kve={class:"status-item"},Dve={class:"status-value"},Pve={class:"status-item"},Rve={class:"status-value"},Fve={class:"status-item"},Nve={class:"status-value"},Ove={class:"status-item"},Mve={class:"status-value"},Lve={class:"test-section"},Bve=["disabled"],Uve=["disabled"],$ve={class:"test-section"},Vve=["disabled"],Hve={key:0,class:"error-message"},jve={key:1,class:"success-message"},Gve={key:0,class:"test-section"},Wve=["disabled"],zve={key:0,class:"error-message"},Kve={key:1,class:"success-message"},qve={class:"test-section"},Xve=["disabled"],Yve={key:0,class:"error-message"},Qve={key:1,class:"success-message"},Jve={class:"test-section"},Zve=["disabled"],e1e={key:0,class:"error-message"},t1e={key:1,class:"success-message"},r1e={__name:"SecurePdfTest",setup(t){const e=se(null),r=se("test-student-123"),n=se(null),s=se(!1),i=se(!1),a=se(!1),o=se(null),l=se(null),c=se(!1),u=se(null),f=se(null),h=se("Checking..."),p=se("Checking..."),g=se("Checking..."),y=se("Checking..."),_=se(null),x=se(null),b=se(null),v=se(null),{uploadPdf:T,downloadPdf:D,isUploading:k,isDownloading:S}=ax();_e(()=>{var R,N,L;return((R=bt.currentUser)==null?void 0:R.role)||((L=(N=bt.currentUser)==null?void 0:N.claims)==null?void 0:L.role)||"unknown"});const E=R=>{const N=R.target.files[0];if(N){if(N.type!=="application/pdf"){alert("Please select a PDF file"),R.target.value="";return}e.value=N,x.value=null,_.value=null,o.value=null,l.value=null}},m=async()=>{var R,N;if(!r.value){alert("Please enter a student ID");return}try{s.value=!0;const L=bt.currentUser;if(L){const z=await L.getIdTokenResult();console.log(" User token result:",z),console.log(" User role from token:",z.claims.role)}const O=et(Xe,"students",r.value);(await er(O)).exists()?alert(" Test student already exists"):(await $t(O,{app:{studentData:{firstName:"Test",lastName:"Student",grade:"7",plan:"IEP",caseManagerId:((R=bt.currentUser)==null?void 0:R.uid)||"test-case-manager"},staffIds:[((N=bt.currentUser)==null?void 0:N.uid)||"test-user"],schedule:{periods:{},classServices:[]},providers:{},accommodations:{instruction:"",assessment:""},flags:{flag1:!1,flag2:!1}},createdAt:Pn()}),alert(" Test student created successfully!"))}catch(L){alert(` Error creating test student: ${L.message}`),console.error("Error creating test student:",L),L.message.includes("permissions")&&alert(" Admin permissions required. Try using an existing student ID instead.")}finally{s.value=!1}},A=async()=>{var R,N,L,O;try{i.value=!0;const V=At(Xe,"students"),z=lr(V,la(5)),U=await Gt(z);if(U.empty)alert(" No students found in database");else{const G=U.docs.map(ee=>({id:ee.id,...ee.data()}));console.log(" Available students:",G);const j=G[0];r.value=j.id,alert(` Found student: ${((N=(R=j.app)==null?void 0:R.studentData)==null?void 0:N.firstName)||"Unknown"} ${((O=(L=j.app)==null?void 0:L.studentData)==null?void 0:O.lastName)||"Student"} (ID: ${j.id})`)}}catch(V){alert(` Error finding student: ${V.message}`),console.error("Error finding student:",V)}finally{i.value=!1}},I=async()=>{if(!e.value||!r.value){alert("Please select a file and enter a student ID");return}try{x.value=null,_.value=null;const R=await T(e.value,r.value);_.value=R,console.log(" Test PDF uploaded successfully:",R)}catch(R){x.value=R.message,console.error(" Test PDF upload failed:",R)}},C=async()=>{if(!_.value||!r.value){alert("Please upload a PDF first");return}try{b.value=null,v.value=null,await D(_.value,r.value,"test-document.pdf"),v.value=!0,console.log(" Test PDF downloaded successfully")}catch(R){b.value=R.message,console.error(" Test PDF download failed:",R)}},F=async()=>{if(!e.value){alert("Please select a file first");return}try{a.value=!0,o.value=null,l.value=null;const R=bh(Dc,`public/test-${Date.now()}.pdf`);await OI(R,e.value),l.value=!0,console.log(" Direct upload successful")}catch(R){o.value=R.message,console.error(" Direct upload failed:",R)}finally{a.value=!1}},W=async()=>{if(!r.value){alert("Please enter a student ID first");return}try{c.value=!0,u.value=null,f.value=null;const{getFunctions:R,httpsCallable:N}=await ua(async()=>{const{getFunctions:G,httpsCallable:j}=await Promise.resolve().then(()=>D0);return{getFunctions:G,httpsCallable:j}},void 0),L=R(),O=N(L,"getStudentFileUrl"),V="test-document.pdf";console.log(` Testing cloud function with studentId: ${r.value}, fileName: ${V}`);const z=await O({studentId:r.value,fileName:V});console.log(" Cloud function result:",z.data),f.value=!0;const U=z.data.url;U&&!U.includes("token=")?console.log(" URL is private (no download token)"):console.warn(" URL may not be private")}catch(R){u.value=R.message,console.error(" Cloud function test failed:",R)}finally{c.value=!1}},P=async()=>{try{const R=N0.encryptionKey;h.value=R&&R!=="your-dev-key-here"?" Configured":" Using default key";try{const N=bh(Dc,"public/test-access");await LI(N),p.value=" Accessible"}catch(N){N.code==="storage/unauthorized"?p.value=" Limited access (expected)":p.value=" Access denied"}try{const N=et(Xe,"test","test");await er(N),g.value=" Accessible"}catch{g.value=" Access denied"}try{const N=bt.currentUser;if(N){const L=await N.getIdTokenResult();y.value=L.claims.role||"unknown",console.log(" User role detected:",y.value)}else y.value="not authenticated"}catch(N){y.value="error reading role",console.error("Error reading user role:",N)}}catch(R){console.error("Error checking system status:",R)}};return Wt(()=>{P()}),(R,N)=>(M(),B("div",wve,[N[16]||(N[16]=d("h2",null," Secure PDF System Test",-1)),d("div",Cve,[N[5]||(N[5]=d("h3",null,"System Status",-1)),d("div",Ive,[d("div",kve,[N[1]||(N[1]=d("span",{class:"status-label"},"Encryption Key:",-1)),d("span",Dve,Q(h.value),1)]),d("div",Pve,[N[2]||(N[2]=d("span",{class:"status-label"},"Storage Access:",-1)),d("span",Rve,Q(p.value),1)]),d("div",Fve,[N[3]||(N[3]=d("span",{class:"status-label"},"Firestore Access:",-1)),d("span",Nve,Q(g.value),1)]),d("div",Ove,[N[4]||(N[4]=d("span",{class:"status-label"},"User Role:",-1)),d("span",Mve,Q(y.value),1)])])]),d("div",Lve,[N[6]||(N[6]=d("h3",null,"Test Student ID",-1)),Oe(d("input",{"onUpdate:modelValue":N[0]||(N[0]=L=>r.value=L),placeholder:"Enter test student ID",class:"student-id-input"},null,512),[[ht,r.value]]),N[7]||(N[7]=d("p",{class:"help-text"},"Enter a student ID to test with. You can:",-1)),N[8]||(N[8]=d("ul",{class:"help-text"},[d("li",null,"Use an existing student ID from your database"),d("li",null,"Create a new test student (requires admin permissions)"),d("li",null,'Use "test-student-123" for testing')],-1)),d("button",{onClick:m,disabled:s.value,class:"btn btn-secondary"},Q(s.value?"Creating...":"Create Test Student"),9,Bve),d("button",{onClick:A,disabled:i.value,class:"btn btn-secondary"},Q(i.value?"Finding...":"Find Existing Student"),9,Uve)]),d("div",$ve,[N[9]||(N[9]=d("h3",null,"Upload Test PDF",-1)),d("input",{type:"file",accept:"application/pdf",onChange:E,ref_key:"fileInput",ref:n},null,544),d("button",{onClick:I,disabled:!e.value||q(k)},Q(q(k)?" Uploading...":" Upload PDF"),9,Vve),x.value?(M(),B("div",Hve,Q(x.value),1)):ve("",!0),_.value?(M(),B("div",jve,"  PDF uploaded successfully! Secure filename: "+Q(_.value),1)):ve("",!0)]),_.value?(M(),B("div",Gve,[N[10]||(N[10]=d("h3",null,"Download Test PDF",-1)),d("button",{onClick:C,disabled:q(S)},Q(q(S)?" Downloading...":" Download PDF"),9,Wve),b.value?(M(),B("div",zve,Q(b.value),1)):ve("",!0),v.value?(M(),B("div",Kve,"  PDF downloaded successfully! ")):ve("",!0)])):ve("",!0),d("div",qve,[N[11]||(N[11]=d("h3",null,"Alternative Test: Direct Storage Upload",-1)),N[12]||(N[12]=d("p",{class:"help-text"},"This test bypasses the secure PDF system and uploads directly to storage for comparison.",-1)),d("button",{onClick:F,disabled:!e.value||a.value},Q(a.value?" Uploading...":" Test Direct Upload"),9,Xve),o.value?(M(),B("div",Yve,Q(o.value),1)):ve("",!0),l.value?(M(),B("div",Qve,"  Direct upload successful! This confirms storage permissions are working. ")):ve("",!0)]),d("div",Jve,[N[14]||(N[14]=d("h3",null,"Test Cloud Function: Private URL Generation",-1)),N[15]||(N[15]=d("p",{class:"help-text"},"Test if the cloud function can generate private URLs for existing files.",-1)),d("button",{onClick:W,disabled:c.value},Q(c.value?" Testing...":" Test Cloud Function"),9,Zve),u.value?(M(),B("div",e1e,Q(u.value),1)):ve("",!0),f.value?(M(),B("div",t1e,N[13]||(N[13]=[we("  Cloud function working! Private URL generated successfully. "),d("br",null,null,-1),d("small",null,"URL expires in 5 minutes",-1)]))):ve("",!0)])]))}},n1e=St(r1e,[["__scopeId","data-v-4c041459"]]);async function s1e(){var t;console.log("Starting student ID migration...");try{const e=At(Xe,"students"),r=await Gt(e);console.log(`Found ${r.size} students to migrate`);let n=0,s=0;for(const i of r.docs){const a=i.data(),o=i.id;if(!/^\d+$/.test(o)){console.log(`Student ${o} already uses auto-generated ID, skipping`);continue}const l=o;try{const c=et(At(Xe,"students")),u={...a,app:{...a.app,studentData:{...(t=a.app)==null?void 0:t.studentData,ssid:l}},migratedFrom:o,migratedAt:new Date().toISOString()};await $t(c,u),await mo(et(Xe,"students",o)),console.log(` Migrated student ${o}  ${c.id}`),n++}catch(c){console.error(` Failed to migrate student ${o}:`,c),s++}}return console.log(`Migration complete: ${n} migrated, ${s} errors`),{migratedCount:n,errorCount:s}}catch(e){throw console.error("Migration failed:",e),e}}async function a1e(){var t,e;console.log("Verifying migration...");try{const r=At(Xe,"students"),n=await Gt(r);let s=0,i=0;for(const a of n.docs){const o=a.data(),l=a.id,c=(e=(t=o.app)==null?void 0:t.studentData)==null?void 0:e.ssid;c?(console.log(` Student ${l} has SSID: ${c}`),s++):(console.warn(` Student ${l} missing SSID in app data`),i++)}return console.log(`Verification complete: ${s} verified, ${i} issues`),{verifiedCount:s,issuesCount:i}}catch(r){throw console.error("Verification failed:",r),r}}async function i1e(){var s,i,a,o;console.log(" Starting period label migration...");const{getNumber:t}=Eo();let e=0,r=0,n=[];try{const l=At(Xe,"students"),c=await Gt(l);e=c.size,console.log(` Found ${e} students to check`);for(const u of c.docs)try{const f=u.data();let h=!1,p={};const g=((i=(s=f.app)==null?void 0:s.schedule)==null?void 0:i.periods)||f.schedule||{};if(Object.entries(g).forEach(([y,_])=>{if(isNaN(parseInt(y))){const x=t(y);if(x)p[x]=_,h=!0,console.log(` Converting "${y}"  ${x} for student ${u.id}`);else{const b=y.match(/^(?:period|per)(\d+)$/i);b?(p[parseInt(b[1])]=_,h=!0,console.log(` Converting "${y}"  ${b[1]} for student ${u.id}`)):(console.warn(` Could not convert period key "${y}" for student ${u.id}`),p[y]=_)}}else p[y]=_}),h){const y={};(o=(a=f.app)==null?void 0:a.schedule)!=null&&o.periods?y["app.schedule.periods"]=p:f.schedule&&(y.schedule=p),Object.keys(y).length>0&&(await Op(et(Xe,"students",u.id),y),r++,console.log(` Updated student ${u.id}`))}}catch(f){console.error(` Error processing student ${u.id}:`,f),n.push({studentId:u.id,error:f.message})}return console.log(" Migration completed!"),console.log(" Results:"),console.log(`   - Total students checked: ${e}`),console.log(`   - Students migrated: ${r}`),console.log(`   - Errors: ${n.length}`),n.length>0&&(console.warn(" Errors encountered:"),n.forEach(({studentId:u,error:f})=>{console.warn(`   - ${u}: ${f}`)})),{success:!0,totalStudents:e,migratedStudents:r,errors:n}}catch(l){return console.error(" Migration failed:",l),{success:!1,error:l.message,totalStudents:e,migratedStudents:r,errors:n}}}async function o1e(){var n,s;console.log(" Starting migration preview...");const{getNumber:t}=Eo();let e=0,r=[];try{const i=At(Xe,"students"),a=await Gt(i);e=a.size;for(const o of a.docs){const l=o.data(),c=((s=(n=l.app)==null?void 0:n.schedule)==null?void 0:s.periods)||l.schedule||{};let u=[];Object.keys(c).forEach(f=>{if(isNaN(parseInt(f))){const h=t(f);if(h)u.push({from:f,to:h});else{const p=f.match(/^(?:period|per)(\d+)$/i);p&&u.push({from:f,to:parseInt(p[1])})}}}),u.length>0&&r.push({id:o.id,name:`${l.firstName||""} ${l.lastName||""}`.trim(),changes:u})}return console.log(" Migration Preview Results:"),console.log(`   - Total students: ${e}`),console.log(`   - Students needing migration: ${r.length}`),r.length>0&&(console.log("   - Changes needed:"),r.forEach(o=>{console.log(`      ${o.name} (${o.id}):`),o.changes.forEach(l=>{console.log(`        "${l.from}"  ${l.to}`)})})),{totalStudents:e,studentsNeedingMigration:r,changesNeeded:r.length>0}}catch(i){return console.error(" Preview failed:",i),{error:i.message,totalStudents:0,studentsNeedingMigration:[],changesNeeded:!1}}}const l1e={class:"testing-view"},c1e={class:"test-section"},u1e={class:"status-grid"},d1e={class:"status-item"},f1e={class:"status-item"},h1e={class:"status-item"},p1e={key:0,class:"test-section"},m1e={class:"settings-display"},g1e={class:"setting-group"},v1e={class:"setting-values"},y1e={class:"setting-group"},x1e={class:"setting-values"},E1e={class:"setting-group"},b1e={class:"setting-values"},_1e={class:"setting-group"},S1e={class:"setting-values"},A1e={class:"test-section"},T1e={class:"admin-action-btns"},w1e=["disabled"],C1e=["disabled"],I1e={class:"test-section"},k1e={class:"integration-test"},D1e={key:0,class:"test-form-container"},P1e={class:"test-section"},R1e={class:"admin-action-btns"},F1e=["disabled"],N1e=["disabled"],O1e={key:0,class:"migration-result"},M1e={class:"test-section"},L1e={class:"period-migration-controls"},B1e=["disabled"],U1e=["disabled"],$1e={key:0,class:"migration-result"},V1e={class:"test-section"},H1e={class:"ssid-test-controls"},j1e=["disabled"],G1e={key:0,class:"ssid-test-result"},W1e={class:"test-section"},z1e={__name:"TestingView",setup(t){const{appSettings:e,loadAppSettings:r,resetAppSettings:n,loading:s,error:i}=Ts(),{labels:a}=Eo(),o=se(!1),l=se(!1),c=se(!1),u=se(null),f=se(!1),h=se(null),p=se(!1),g=se(null);Wt(async()=>{console.log("TestingView: Component mounted, checking app settings...")});const y=async()=>{try{await r(),console.log("TestingView: Settings reloaded successfully")}catch(E){console.error("TestingView: Error reloading settings:",E)}},_=async()=>{try{await n(),console.log("TestingView: Settings reset successfully")}catch(E){console.error("TestingView: Error resetting settings:",E)}},x=E=>{console.log("TestingView: Test student saved:",E),o.value=!1},b=async()=>{l.value=!0,u.value=null;try{const E=await s1e();u.value=E,console.log("Migration completed:",E)}catch(E){u.value={error:E.message},console.error("Migration failed:",E)}finally{l.value=!1}},v=async()=>{c.value=!0,u.value=null;try{const E=await a1e();u.value=E,console.log("Verification completed:",E)}catch(E){u.value={error:E.message},console.error("Verification failed:",E)}finally{c.value=!1}},T=async()=>{f.value=!0,h.value=null;try{const E=[{sourcedId:"123456789",givenName:"John",familyName:"Doe",specialEducation:"true"},{SSID:"987654321",FirstName:"Jane",LastName:"Smith",IEP:"Yes"},{ssid:"555666777",FirstName:"Bob",LastName:"Johnson",iep:"1"},{StateStudentID:"111222333",FirstName:"Alice",LastName:"Brown",504:"true"}],m={aeriesMapping:{},seisMapping:{},ssidExtraction:{},fieldMapping:{}};E.forEach((I,C)=>{const F={};Object.keys(I).forEach(W=>{F[W]=jv(W)}),m.aeriesMapping[`row_${C}`]=F}),E.forEach((I,C)=>{const F={};Object.keys(I).forEach(W=>{F[W]=Gv(W)}),m.seisMapping[`row_${C}`]=F}),E.forEach((I,C)=>{var W;const F=(W=I.sourcedId||I.SSID||I.ssid||I.StateStudentID||I.stateStudentId)==null?void 0:W.trim();m.ssidExtraction[`row_${C}`]={original:I,extractedSSID:F,success:!!F}});const A=["specialEducation","iep","IEP","plan504","504","disabilities","accommodations"];m.fieldMapping={aeries:A.map(I=>({field:I,mapped:jv(I)})),seis:A.map(I=>({field:I,mapped:Gv(I)}))},h.value={success:!0,message:"SSID resolution test completed successfully",results:m},console.log("SSID resolution test completed:",m)}catch(E){h.value={success:!1,error:E.message,message:"SSID resolution test failed"},console.error("SSID resolution test failed:",E)}finally{f.value=!1}},D=()=>{h.value=null},k=async()=>{p.value=!0,g.value=null;try{console.log("Starting period label migration preview...");const E=await o1e();E.error?g.value=`Preview failed: ${E.error}`:E.changesNeeded?g.value=`Preview completed: ${E.studentsNeedingMigration.length} students need migration (see console for details)`:g.value="No migration needed - all students already use numeric period keys"}catch(E){console.error("Period migration preview failed:",E),g.value=`Preview error: ${E.message}`}finally{p.value=!1}},S=async()=>{if(confirm("This will update period keys from labels to numbers for all students. Continue?")){p.value=!0,g.value=null;try{console.log("Starting period label migration...");const E=await i1e();E.success?(g.value=`Migration completed: ${E.migratedStudents}/${E.totalStudents} students updated`,E.errors.length>0&&(g.value+=` (${E.errors.length} errors - see console)`)):g.value=`Migration failed: ${E.error}`}catch(E){console.error("Period migration failed:",E),g.value=`Migration error: ${E.message}`}finally{p.value=!1}}};return(E,m)=>{var A,I,C,F,W,P;return M(),B("div",l1e,[m[21]||(m[21]=d("h2",null,"App Settings Testing",-1)),d("div",c1e,[m[5]||(m[5]=d("h3",null,"App Settings Status",-1)),d("div",u1e,[d("div",d1e,[m[2]||(m[2]=d("strong",null,"Loading:",-1)),we(" "+Q(q(s)?"Yes":"No"),1)]),d("div",f1e,[m[3]||(m[3]=d("strong",null,"Error:",-1)),we(" "+Q(q(i)||"None"),1)]),d("div",h1e,[m[4]||(m[4]=d("strong",null,"Loaded:",-1)),we(" "+Q(q(e)&&Object.keys(q(e)).length>0?"Yes":"No"),1)])])]),q(e)?(M(),B("div",p1e,[m[10]||(m[10]=d("h3",null,"Current Settings",-1)),d("div",m1e,[d("div",g1e,[d("h4",null,"Grades ("+Q(((A=q(e).grades)==null?void 0:A.length)||0)+")",1),d("div",v1e,Q(((I=q(e).grades)==null?void 0:I.join(", "))||"None configured"),1)]),d("div",y1e,[d("h4",null,"Class Services ("+Q(((C=q(e).classServices)==null?void 0:C.length)||0)+")",1),d("div",x1e,[(M(!0),B(ke,null,He(q(e).classServices,R=>{var N;return M(),B("div",{key:R.name,class:"service-item"},[d("strong",null,Q(R.name)+":",1),we(" "+Q(((N=R.enabledSubcategories)==null?void 0:N.join(", "))||"None enabled"),1)])}),128))])]),d("div",E1e,[d("h4",null,"Service Providers ("+Q(((F=q(e).serviceProviders)==null?void 0:F.length)||0)+")",1),d("div",b1e,Q(((W=q(e).serviceProviders)==null?void 0:W.join(", "))||"None configured"),1)]),d("div",_1e,[m[9]||(m[9]=d("h4",null,"Periods",-1)),d("div",S1e,[m[6]||(m[6]=d("strong",null,"Number:",-1)),we(" "+Q(q(e).numPeriods||0),1),m[7]||(m[7]=d("br",null,null,-1)),m[8]||(m[8]=d("strong",null,"Labels:",-1)),we(" "+Q(((P=q(a))==null?void 0:P.join(", "))||"None"),1)])])])])):ve("",!0),d("div",A1e,[m[11]||(m[11]=d("h3",null,"Test Actions",-1)),d("div",T1e,[d("button",{onClick:y,disabled:q(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},Q(q(s)?"Loading...":"Reload Settings"),9,w1e),d("button",{onClick:_,disabled:q(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Defaults ",8,C1e)])]),d("div",I1e,[m[13]||(m[13]=d("h3",null,"Component Integration Test",-1)),d("div",k1e,[m[12]||(m[12]=d("p",null,"This section tests if the StudentForm can access app settings:",-1)),d("button",{onClick:m[0]||(m[0]=R=>o.value=!o.value),class:"btn btn-primary"},Q(o.value?"Hide":"Show")+" Test Student Form ",1),o.value?(M(),B("div",D1e,[Re(ix,{users:{userRoles:{}},mode:"new",onClose:m[1]||(m[1]=R=>o.value=!1),onSaved:x})])):ve("",!0)])]),d("div",P1e,[m[15]||(m[15]=d("h3",null,"Migration Tools",-1)),d("div",R1e,[d("button",{onClick:b,disabled:l.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},Q(l.value?"Migrating...":"Migrate Student IDs"),9,F1e),d("button",{onClick:v,disabled:c.value,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},Q(c.value?"Verifying...":"Verify Migration"),9,N1e)]),u.value?(M(),B("div",O1e,[m[14]||(m[14]=d("h4",null,"Migration Result:",-1)),d("pre",null,Q(JSON.stringify(u.value,null,2)),1)])):ve("",!0)]),d("div",M1e,[m[17]||(m[17]=d("h3",null,"Period Label Migration",-1)),d("div",L1e,[d("button",{onClick:k,disabled:p.value,class:"btn btn-secondary"},Q(p.value?"Previewing...":"Preview Period Migration"),9,B1e),d("button",{onClick:S,disabled:p.value,class:"btn btn-warning"},Q(p.value?"Migrating...":"Run Period Migration"),9,U1e)]),g.value?(M(),B("div",$1e,[m[16]||(m[16]=d("h4",null,"Period Migration Result:",-1)),d("p",null,Q(g.value),1)])):ve("",!0)]),d("div",V1e,[m[19]||(m[19]=d("h3",null,"SSID Resolution Test",-1)),d("div",H1e,[d("button",{onClick:T,disabled:f.value,class:"btn btn-primary"},Q(f.value?"Testing...":"Test SSID Resolution"),9,j1e),d("button",{onClick:D,class:"btn btn-secondary"}," Clear Results ")]),h.value?(M(),B("div",G1e,[m[18]||(m[18]=d("h4",null,"SSID Resolution Test Result:",-1)),d("pre",null,Q(JSON.stringify(h.value,null,2)),1)])):ve("",!0)]),d("div",W1e,[m[20]||(m[20]=d("h3",null," Secure PDF System Test",-1)),Re(n1e)])])}}},K1e=St(z1e,[["__scopeId","data-v-16ace2fd"]]),Fo=se({}),gu=se(!1);function q1e(){const t=async()=>{try{const s=et(Xe,"app_settings","admin_panel_permissions"),i=await er(s);i.exists()?Fo.value=i.data():Fo.value=n(),gu.value=!0,console.log("Admin permissions loaded:",Fo.value)}catch(s){console.error("Error loading admin permissions:",s),Fo.value=n(),gu.value=!0}},e=(s,i)=>!gu.value||!Fo.value[s]?!1:i==="admin"?!0:Fo.value[s][i]===!0,r=(s,i)=>gu.value?s.filter(a=>i==="admin"?!0:e(a.key,i)):[],n=()=>({dashboard:{school_admin:!0,admin_504:!0,sped_chair:!0},usersAdd:{school_admin:!0,admin_504:!0,sped_chair:!1},usersEdit:{school_admin:!0,admin_504:!0,sped_chair:!0},students:{school_admin:!0,admin_504:!0,sped_chair:!0},addStudents:{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-assignment":{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-schedule":{school_admin:!0,admin_504:!0,sped_chair:!0},"time-table":{school_admin:!0,admin_504:!1,sped_chair:!0},seis:{school_admin:!0,admin_504:!0,sped_chair:!0},aeries:{school_admin:!0,admin_504:!0,sped_chair:!0},"testing-links":{school_admin:!0,admin_504:!1,sped_chair:!0},"teacher-feedback":{school_admin:!0,admin_504:!0,sped_chair:!0},"backup-restore":{school_admin:!0,admin_504:!1,sped_chair:!0},settings:{school_admin:!0,admin_504:!0,sped_chair:!0},permissions:{school_admin:!1,admin_504:!1,sped_chair:!1},"iep-security":{school_admin:!1,admin_504:!1,sped_chair:!1},security:{school_admin:!1,admin_504:!1,sped_chair:!1},"component-health":{school_admin:!1,admin_504:!1,sped_chair:!1}});return{adminPermissions:_e(()=>Fo.value),permissionsLoaded:_e(()=>gu.value),loadPermissions:t,hasPermission:e,getPermittedTabs:r}}const X1e={name:"AdminView",components:{TabBar:sz,UserAddForm:mz,UserTable:$z,AdminStudents:lK,StudentBulkImporter:dq,AdminPermissions:Gq,SeisImport:iX,AeriesImport:gX,AeriesAPIConnector:TY,AppSettings:DQ,AdminAideAssignment:I4,AdminTimeTable:cD,AdminAideSchedule:bD,AdminBackupRestore:_D,AdminAuditLogs:wde,AdminTeacherFeedback:wfe,TestingLinks:b0e,AdminDashboard:rpe,DebugEncryption:AD,SecurityControlCenter:pme,ComponentHealthDashboard:cge,AdminPermissionsMatrix:Pge,ThemeManager:Tve,TestingView:K1e},setup(){const t=ki(),e=vL(),r=se("dashboard"),n=se("dashboard"),{students:s,fetchStudents:i}=Di(),{users:a,fetchUsers:o}=_a(),l=Qr(),c=_e(()=>l.currentUser),{loadPermissions:u,getPermittedTabs:f,permissionsLoaded:h}=q1e();Wt(async()=>{try{await Promise.all([i(),o(),u()]),c.value&&await an.logSystemAccess("admin_panel_access",{userRole:c.value.role,accessTime:new Date().toISOString(),initialCategory:e.query.category||"dashboard"});const E=e.query.category;E&&b(E)}catch(E){console.error("Error loading data:",E)}});const p=[{key:"dashboard",label:"Dashboard",category:"dashboard"},{key:"usersAdd",label:"Add Users",category:"users-students"},{key:"usersEdit",label:"Manage Users",category:"users-students"},{key:"students",label:"Students",category:"users-students"},{key:"addStudents",label:"Add Students",category:"users-students"},{key:"aide-assignment",label:"Aide Assignment",category:"aide-management"},{key:"aide-schedule",label:"Aide Schedule",category:"aide-management",status:"not-working"},{key:"time-table",label:"Time Table",category:"aide-management"},{key:"seis",label:"SEIS Import",category:"data-integration",status:"not-active"},{key:"aeries",label:"Aeries API & Import",category:"data-integration",status:"not-active"},{key:"testing-links",label:"Testing Links",category:"data-integration"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"data-integration"},{key:"backup-restore",label:"Backup & Restore",category:"data-integration"},{key:"permissions",label:"Permissions",category:"system-config"},{key:"settings",label:"App Settings",category:"system-config"},{key:"theme",label:"Theme Customization",category:"system-config"},{key:"audit-logs",label:"Audit Logs",category:"monitoring"},{key:"security",label:"Security Controls",category:"monitoring"},{key:"component-health",label:"Component Debug",category:"monitoring"},{key:"app-settings-testing",label:"App Settings Testing",category:"monitoring"}],g=[{key:"admin-permissions",label:"Admin Panel Permissions",category:"monitoring"}],y=_e(()=>{var A;const E=(A=c.value)==null?void 0:A.role;if(!h.value)return[];let m=[...p];return E==="admin"&&(m=[...m,...g]),f(m,E)}),_=E=>y.value.filter(m=>m.category===E),x=E=>_(E).length>0,b=async E=>{n.value=E;const m=_(E);m.length>0&&(r.value=m[0].key),c.value&&await an.logSystemAccess("admin_category_access",{category:E,userRole:c.value.role,availableTabs:m.map(A=>A.key)})};return{activeTab:r,activeCategory:n,getTabsForCategory:_,categoryHasTabs:x,setActiveCategory:b,handleTabChange:async E=>{r.value=E,c.value&&await an.logSystemAccess("admin_tab_access",{tab:E,category:n.value,userRole:c.value.role})},goToStudents:()=>{t.push("/students")},goToDashboard:()=>{t.push("/admin/dashboard")},handleGoToCategory:E=>{b(E)},handleBulkImporterClose:()=>{r.value="students"},students:s,userMap:a,currentUser:c,permissionsLoaded:h}}},Y1e={class:"admin-header"},Q1e={class:"admin-nav"},J1e={class:"admin-actions"},Z1e={key:0,class:"sub-tab-container"},eye={class:"admin-section"},tye={key:0,class:"admin-section"},rye={key:1,class:"admin-section"},nye={key:2,class:"admin-section"},sye={key:3,class:"admin-section"},aye={key:4,class:"admin-section"},iye={key:5,class:"admin-section"},oye={key:6,class:"admin-section"},lye={key:7,class:"admin-section"},cye={key:8,class:"admin-section"},uye={key:9,class:"admin-section"},dye={key:10,class:"admin-section"},fye={key:11,class:"admin-section"},hye={key:12,class:"admin-section"},pye={key:13,class:"admin-section"},mye={key:14,class:"admin-section"},gye={key:15,class:"admin-section"},vye={key:16,class:"admin-section"},yye={key:17,class:"admin-section"},xye={key:18,class:"admin-section"},Eye={key:19,class:"admin-section"},bye={key:20,class:"admin-section"},_ye={key:21,class:"admin-section"};function Sye(t,e,r,n,s,i){const a=br("TabBar"),o=br("AdminDashboard"),l=br("UserAddForm"),c=br("UserTable"),u=br("AdminStudents"),f=br("StudentBulkImporter"),h=br("AdminPermissions"),p=br("AdminAideAssignment"),g=br("AdminAideSchedule"),y=br("AdminTimeTable"),_=br("SeisImport"),x=br("AeriesAPIConnector"),b=br("AeriesImport"),v=br("AppSettings"),T=br("ThemeManager"),D=br("TestingLinks"),k=br("AdminTeacherFeedback"),S=br("AdminBackupRestore"),E=br("AdminAuditLogs"),m=br("DebugEncryption"),A=br("SecurityControlCenter"),I=br("ComponentHealthDashboard"),C=br("AdminPermissionsMatrix"),F=br("TestingView");return M(),B("div",null,[d("div",Y1e,[e[8]||(e[8]=d("h1",null,"Admin Panel",-1)),d("div",Q1e,[n.categoryHasTabs("dashboard")?(M(),B("button",{key:0,onClick:e[0]||(e[0]=W=>n.setActiveCategory("dashboard")),class:Ye([{active:n.activeCategory==="dashboard"},"category-btn"])}," Dashboard ",2)):ve("",!0),n.categoryHasTabs("users-students")?(M(),B("button",{key:1,onClick:e[1]||(e[1]=W=>n.setActiveCategory("users-students")),class:Ye([{active:n.activeCategory==="users-students"},"category-btn"])}," User & Student ",2)):ve("",!0),n.categoryHasTabs("aide-management")?(M(),B("button",{key:2,onClick:e[2]||(e[2]=W=>n.setActiveCategory("aide-management")),class:Ye([{active:n.activeCategory==="aide-management"},"category-btn"])}," Paraprofessionals ",2)):ve("",!0),n.categoryHasTabs("data-integration")?(M(),B("button",{key:3,onClick:e[3]||(e[3]=W=>n.setActiveCategory("data-integration")),class:Ye([{active:n.activeCategory==="data-integration"},"category-btn"])}," Data & Integration ",2)):ve("",!0),n.categoryHasTabs("system-config")?(M(),B("button",{key:4,onClick:e[4]||(e[4]=W=>n.setActiveCategory("system-config")),class:Ye([{active:n.activeCategory==="system-config"},"category-btn"])}," Configuration ",2)):ve("",!0),n.categoryHasTabs("monitoring")?(M(),B("button",{key:5,onClick:e[5]||(e[5]=W=>n.setActiveCategory("monitoring")),class:Ye([{active:n.activeCategory==="monitoring"},"category-btn"])}," System ",2)):ve("",!0)]),d("div",J1e,[d("button",{onClick:e[6]||(e[6]=(...W)=>n.goToStudents&&n.goToStudents(...W)),class:"return-btn"},e[7]||(e[7]=[d("span",null,"",-1)]))])]),n.activeCategory?(M(),B("div",Z1e,[Re(a,{tabs:n.getTabsForCategory(n.activeCategory),"active-tab":n.activeTab,onTabChange:n.handleTabChange},null,8,["tabs","active-tab","onTabChange"])])):ve("",!0),d("div",eye,[n.activeTab==="dashboard"?(M(),B("div",tye,[Re(o,{onGoToCategory:n.handleGoToCategory,onGoToStudents:n.goToStudents},null,8,["onGoToCategory","onGoToStudents"])])):ve("",!0),n.activeTab==="usersAdd"?(M(),B("div",rye,[Re(l)])):ve("",!0),n.activeTab==="usersEdit"?(M(),B("div",nye,[Re(c)])):ve("",!0),n.activeTab==="students"?(M(),B("div",sye,[Re(u)])):ve("",!0),n.activeTab==="addStudents"?(M(),B("div",aye,[Re(f,{onClose:n.handleBulkImporterClose,onImported:t.handleStudentsImported},null,8,["onClose","onImported"])])):ve("",!0),n.activeTab==="permissions"?(M(),B("div",iye,[Re(h)])):ve("",!0),n.activeTab==="aide-assignment"?(M(),B("div",oye,[Re(p)])):ve("",!0),n.activeTab==="aide-schedule"?(M(),B("div",lye,[Re(g)])):ve("",!0),n.activeTab==="time-table"?(M(),B("div",cye,[Re(y)])):ve("",!0),n.activeTab==="seis"?(M(),B("div",uye,[Re(_)])):ve("",!0),n.activeTab==="aeries"?(M(),B("div",dye,[Re(x),e[9]||(e[9]=d("hr",{style:{margin:"2rem 0",border:"1px solid #ddd"}},null,-1)),Re(b)])):ve("",!0),n.activeTab==="settings"?(M(),B("div",fye,[Re(v)])):ve("",!0),n.activeTab==="theme"?(M(),B("div",hye,[Re(T)])):ve("",!0),n.activeTab==="testing-links"?(M(),B("div",pye,[Re(D,{students:n.students,userMap:n.userMap},null,8,["students","userMap"])])):ve("",!0),n.activeTab==="teacher-feedback"?(M(),B("div",mye,[Re(k)])):ve("",!0),n.activeTab==="backup-restore"?(M(),B("div",gye,[Re(S)])):ve("",!0),n.activeTab==="audit-logs"?(M(),B("div",vye,[Re(E)])):ve("",!0),n.activeTab==="iep-security"?(M(),B("div",yye,[e[10]||(e[10]=d("h2",null,"IEP Data Security",-1)),Re(m,{"selected-student":t.currentStudent},null,8,["selected-student"])])):ve("",!0),n.activeTab==="security"?(M(),B("div",xye,[Re(A,{"selected-student":t.currentStudent},null,8,["selected-student"])])):ve("",!0),n.activeTab==="component-health"?(M(),B("div",Eye,[Re(I)])):ve("",!0),n.activeTab==="admin-permissions"?(M(),B("div",bye,[Re(C)])):ve("",!0),n.activeTab==="app-settings-testing"?(M(),B("div",_ye,[Re(F)])):ve("",!0)])])}const Aye=St(X1e,[["render",Sye],["__scopeId","data-v-4b2c9f35"]]),Tye={class:"aide-schedule-view"},wye={class:"header"},Cye={class:"user-info"},Iye={class:"content"},kye={key:0,class:"error-message"},Dye={key:1,class:"error-message"},Pye={key:2,class:"loading"},Rye={key:3,class:"schedule-container"},Fye={class:"schedule-display"},Nye={class:"schedule-timeline"},Oye={class:"time-info"},Mye={class:"time"},Lye={class:"type-badge"},Bye={class:"assignment-info"},Uye={key:0},$ye={key:1,class:"no-assignment"},Vye={class:"schedule-editor"},Hye={class:"editor-content"},jye={class:"time-block-header"},Gye={class:"time"},Wye={class:"type-badge"},zye={class:"assignment-editor"},Kye=["onUpdate:modelValue"],qye=["value"],Xye=["value"],Yye={class:"editor-actions"},Qye=["disabled"],Jye={key:0},Zye={key:1},exe={__name:"AideScheduleView",setup(t){const e=ki(),r=Qr(),{userList:n,fetchUsers:s}=_a(),{students:i,fetchStudents:a}=Di(),{loadAppSettings:o,saveAppSettings:l}=Ts(),c=se(!0),u=se(!1),f=se({}),h=se({}),p=_e(()=>{var k;return((k=r.currentUser)==null?void 0:k.role)==="paraeducator"}),g=_e(()=>{var k;return(k=r.currentUser)==null?void 0:k.uid}),y=_e(()=>{var k;return((k=n.value)==null?void 0:k.filter(S=>["teacher","case_manager","sped_chair"].includes(S.role)).sort((S,E)=>{const m=A=>{const I=A.name||A.email||A.id,C=I.split(" ");return C.length>1?C[C.length-1]:I};return m(S).localeCompare(m(E))}))||[]});async function _(){var k;try{const S=await er(et(Xe,"app_settings","global"));if(S.exists()){const E=S.data();f.value=((k=E.timeTables)==null?void 0:k[0])||E.timeTable||{}}}catch(S){console.error("Error loading time table:",S)}}function x(){return f.value.schedule?f.value.schedule.map((k,S)=>({...k,id:k.id||`block-${S}`,assignments:h.value[k.id||`block-${S}`]||{}})):[]}function b(){return x().map(S=>{const E=S.assignments[g.value];let m="";if(E){if(E.startsWith("teacher:")){const A=E.replace("teacher:",""),I=y.value.find(C=>C.id===A);m=I?I.name||I.email:"Unknown Teacher"}else if(E.startsWith("student:")){const A=E.replace("student:",""),I=i.value.find(C=>C.id===A);m=I?`${at(I,"firstName")} ${at(I,"lastName")}`:"Unknown Student"}}return{...S,assignment:m}})}async function v(){try{u.value=!0;const k=await o(),S={...k.detailedAideSchedule};x().forEach(m=>{S[m.id]||(S[m.id]={}),S[m.id][g.value]=m.assignments[g.value]});const E={...k,detailedAideSchedule:S};await l(E),console.log("My schedule saved successfully")}catch(k){console.error("Error saving my schedule:",k)}finally{u.value=!1}}function T(){r.logout(),e.push("/login")}async function D(){try{c.value=!0,await Promise.all([s(),a(),o(),_()]);const k=await er(et(Xe,"app_settings","global"));if(k.exists()){const S=k.data();h.value=S.detailedAideSchedule||{}}c.value=!1}catch(k){console.error("Error loading aide schedule data:",k),c.value=!1}}return Wt(D),(k,S)=>{var E,m;return M(),B("div",Tye,[d("div",wye,[S[2]||(S[2]=d("h1",null,"My Schedule",-1)),d("div",Cye,[d("span",null,Q(((E=q(r).currentUser)==null?void 0:E.name)||((m=q(r).currentUser)==null?void 0:m.email)),1),d("button",{onClick:T,class:"btn btn-secondary"}," Logout ")])]),d("div",Iye,[q(r).currentUser?p.value?c.value?(M(),B("div",Pye," Loading your schedule... ")):(M(),B("div",Rye,[d("div",Fye,[S[7]||(S[7]=d("h2",null,"My Daily Schedule",-1)),d("div",Nye,[(M(!0),B(ke,null,He(b(),A=>(M(),B("div",{key:A.id,class:Ye(["time-block",A.type])},[d("div",Oye,[d("span",Mye,Q(A.startTime)+" - "+Q(A.endTime),1),d("span",Lye,Q(A.type),1)]),d("div",Bye,[A.assignment?(M(),B("span",Uye,Q(A.assignment),1)):(M(),B("span",$ye,"No Assignment"))])],2))),128))])]),d("div",Vye,[S[9]||(S[9]=d("h2",null,"Edit My Schedule",-1)),d("div",Hye,[(M(!0),B(ke,null,He(x(),A=>(M(),B("div",{key:A.id,class:"time-block-editor"},[d("div",jye,[d("span",Gye,Q(A.startTime)+" - "+Q(A.endTime),1),d("span",Wye,Q(A.type),1)]),d("div",zye,[Oe(d("select",{"onUpdate:modelValue":I=>A.assignments[g.value]=I,class:"assignment-select"},[S[8]||(S[8]=d("option",{value:""},"No Assignment",-1)),(M(!0),B(ke,null,He(y.value,I=>(M(),B("option",{key:I.id,value:`teacher:${I.id}`},Q(I.name||I.email),9,qye))),128)),(M(!0),B(ke,null,He(q(i),I=>(M(),B("option",{key:I.id,value:`student:${I.id}`},Q(q(at)(I,"firstName"))+" "+Q(q(at)(I,"lastName")),9,Xye))),128))],8,Kye),[[sr,A.assignments[g.value]]])])]))),128))]),d("div",Yye,[d("button",{onClick:v,class:"btn btn-primary",disabled:u.value},[u.value?(M(),B("span",Jye,"")):(M(),B("span",Zye,"")),we(" "+Q(u.value?"Saving...":"Save My Schedule"),1)],8,Qye)])])])):(M(),B("div",Dye,[S[5]||(S[5]=d("h2",null,"Access Denied",-1)),S[6]||(S[6]=d("p",null,"This page is only available to paraeducators.",-1)),d("button",{onClick:S[1]||(S[1]=A=>q(e).push("/")),class:"btn btn-primary"},"Go Home")])):(M(),B("div",kye,[S[3]||(S[3]=d("h2",null,"Authentication Required",-1)),S[4]||(S[4]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:S[0]||(S[0]=A=>q(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])])}}},txe=St(exe,[["__scopeId","data-v-a58f06ec"]]),rxe=t=>{t.beforeEach(async(e,r,n)=>{const s=Qr();if(e.path==="/login"||!e.meta.requiresAuth)return n();if(!s.isLoading&&s.currentUser&&s.currentUser.role)return e.meta.allowedRoles&&!e.meta.allowedRoles.includes(s.currentUser.role)?(console.log(" User role not allowed for route - redirecting to students"),n("/students")):n();let i=0;for(;s.isLoading&&i<100;)await new Promise(a=>setTimeout(a,50)),i++;if(s.isLoading)return console.log(" Auth loading timeout - redirecting to login"),n("/login");if(!s.currentUser)return console.log(" No authenticated user - redirecting to login"),n("/login");if(!s.currentUser.role)return console.log(" User has no role - redirecting to login"),n("/login");if(e.meta.allowedRoles&&!e.meta.allowedRoles.includes(s.currentUser.role))return console.log(" User role not allowed for route - redirecting to students"),n("/students");n()}),console.log("Router guards setup completed")},nxe=[{path:"/login",name:"Login",component:ZW},{path:"/",name:"Home",redirect:"/students"},{path:"/students",name:"Students",component:XW,meta:{requiresAuth:!0,allowedRoles:EL}},{path:"/admin",name:"Admin",component:Aye,meta:{requiresAuth:!0,allowedRoles:cu}},{path:"/admin/aide-assignment",name:"AdminAideAssignment",component:I4,meta:{requiresAuth:!0,allowedRoles:cu}},{path:"/admin/time-table",name:"AdminTimeTable",component:cD,meta:{requiresAuth:!0,allowedRoles:cu}},{path:"/admin/aide-schedule",name:"AdminAideSchedule",component:bD,meta:{requiresAuth:!0,allowedRoles:cu}},{path:"/admin/backup-restore",name:"AdminBackupRestore",component:_D,meta:{requiresAuth:!0,allowedRoles:cu}},{path:"/aide-schedule",name:"AideSchedule",component:txe,meta:{requiresAuth:!0,allowedRoles:["paraeducator"]}}],TD=mL({history:GM("/"),routes:nxe});rxe(TD);const Ux=th(UB),sxe=EF();Ux.use(TD);Ux.use(sxe);Ux.mount("#app");
//# sourceMappingURL=index-Dxgpi8eo.js.map
